import{b5 as O,b6 as R,g as D,r as n,R as V,k as C,m as M,o as l,p as a,b7 as I,q as d,s as j,a0 as B,b8 as $}from"./index-53e0d3f6.js";import{buffer as T}from"./geometryEngine-f8f9b56c.js";import"./geometryEngineBase-e1a33b0a.js";import"./hydrated-bb19bc58.js";let m=0,b,u,s,p;const P=()=>{u.cancel(),s&&s.remove(),p.removeAll()},q=async(e,c,i)=>{p=new O({listMode:"hide"}),e.map.add(p),u=new R({view:e,layer:p,defaultCreateOptions:{mode:"hybrid"}}),b=e.allLayerViews.find(t=>t.layer.title.includes("Property")&&t.layer.type==="feature");const r=e.map.allLayers.find(t=>t.title.includes("Property")&&t.type==="feature");return b=await e.whenLayerView(r),u.watch("activeTool",t=>{i(t)}),u.on("create",async t=>{if((t.state==="start"||t.state==="cancel")&&(p.graphics.removeAll(),s&&s.remove()),t.state==="complete"&&(m>0?c(x(m,t.graphic)):c(t.graphic.geometry),u.create(t.tool),s&&s.remove(),p.graphics.removeAll()),t.state==="active")if(m===0){const o=await w(e,t.graphic.geometry);s&&s.remove(),s=o}else{const o=x(m,t.graphic);u.layer.removeAll();const g={type:"simple-fill",color:[255,255,0,.2],style:"solid"};u.layer.add(new D({geometry:o,symbol:g}));const y=await w(e,o);s&&s.remove(),s=y}}),u},x=(e,c)=>T(c.geometry,e,"feet"),w=async(e,c)=>{const i=await b.queryFeatures({geometry:c,outSpatialReference:e.spatialReference});return b.highlight(i.features)},H=(e,c)=>{e.target.value===""?m=0:m=parseInt(e.target.value),c(m)},h=(e,c)=>{e.create(c)},N=(e,c,i)=>{i(T(e.geometry,c,"feet"))},z={title:"Property Select Tips",tips:[{title:"Long Press to Select",text:"You can now select a property by long pressing on a property on the map.  This can be done at any time, even without having the property select tool active."}]},F=e=>{const c=n.useRef(!1),[i,r]=n.useState(!1),[t,o]=n.useState(""),[g,y]=n.useState(0),[f,S]=n.useState(),[k,E]=n.useState(void 0);n.useEffect(()=>(c.current||(c.current=!0,q(e.view,e.geometrySet,o).then(v=>S(v))),()=>{f&&f.destroy()}),[]),n.useEffect(()=>{E(e.selectedProperty)},[e.selectedProperty]),n.useEffect(()=>{f&&e.toolDismissed&&(f.cancel(),o(""))},[e.toolDismissed]),n.useEffect(()=>{r(e.isActive),e.isActive||P()},[e.isActive]);const L=n.useCallback(v=>{e.toolDismissed(),P()},[]),A=n.useCallback(v=>{e.showTips(z)},[]);return{isActive:i,selectedTool:t,setSelectedTool:o,sketchVm:f,distance:g,setDistance:y,selectedProperty:k,toolDismissed:L,tipsClicked:A}},Y=e=>{const{isActive:c,selectedTool:i,setSelectedTool:r,sketchVm:t,distance:o,setDistance:g,selectedProperty:y,toolDismissed:f,tipsClicked:S}=F(e);return C(M,{id:"select-panel",heading:"Select","data-panel":"select",hidden:!c,closed:c?void 0:!0,closable:!0,onCalcitePanelClose:f,children:[l(a,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:S}),l(a,{id:"collapseTool",icon:"chevron-up",text:"",slot:"header-actions-end",onClick:I}),l(d,{closeOnClick:!0,label:"Show Tip",referenceElement:"tip",children:"Show Tip"}),l(d,{closeOnClick:!0,label:"Collapse",referenceElement:"collapseTool",children:"Collapse"}),C("div",{id:"select-tools",children:[C("div",{className:"select-container",children:[l(a,{id:"selectPoint",scale:"m",icon:"pin",text:"Point",active:i==="point"?!0:void 0,onClick:()=>{r("point"),t&&h(t,"point")}}),l(d,{closeOnClick:!0,label:"Select by Point",referenceElement:"selectPoint",children:"Select by Point"}),l(a,{id:"selectLine",scale:"m",icon:"line",text:"Line",active:i==="line"?!0:void 0,onClick:()=>{r("line"),t&&h(t,"polyline")}}),l(d,{closeOnClick:!0,label:"Select by Line",referenceElement:"selectLine",children:"Select by Line"}),l(a,{id:"selectPolygon",scale:"m",icon:"polygon",text:"Polygon",active:i==="polygon"?!0:void 0,onClick:()=>{r("polygon"),t&&h(t,"polygon")}}),l(d,{closeOnClick:!0,label:"Select by Rectangle",referenceElement:"selectRectangle",children:"Select by Rectangle"}),l(a,{id:"selectRectangle",scale:"m",icon:"rectangle",text:"Rectangle",active:i==="rectangle"?!0:void 0,onClick:()=>{r("rectangle"),t&&h(t,"rectangle")}}),l(d,{closeOnClick:!0,label:"Select by Circle",referenceElement:"selectCircle",children:"Select by Circle"}),l(a,{id:"selectCircle",scale:"m",icon:"circle",text:"Circle",active:i==="circle"?!0:void 0,onClick:()=>{r("circle"),t&&h(t,"circle")}}),l(d,{closeOnClick:!0,label:"Select by Polygon",referenceElement:"selectPolygon",children:"Select by Polygon"}),l(a,{id:"selectMultipoint",scale:"m",icon:"pins",text:"Multi-Point",active:i==="multipoint"?!0:void 0,onClick:()=>{r("multipoint"),t&&h(t,"multipoint")}}),l(d,{closeOnClick:!0,label:"Select by Multi-Point",referenceElement:"selectMultipoint",children:"Select by Multi-point"}),l(a,{id:"clearSelection",scale:"m",icon:"trash",text:"Clear",onClick:()=>{e.geometrySet(void 0)}}),l(d,{closeOnClick:!0,label:"Clear Selection",referenceElement:"clearSelection",children:"Clear selection"})]}),C("div",{className:"buffer-container",children:[C(j,{children:["Buffer Distance",l(B,{type:"number",suffixText:"feet",step:50,min:0,max:5280,value:o.toString(),clearable:!0,onCalciteInputChange:k=>H(k,g)})]}),l($,{disabled:y===void 0?!0:void 0,hidden:o<=0,width:"full",onClick:()=>N(y,o,e.geometrySet),children:"Buffer Property"})]})]})]})},U=V.memo(Y);export{Y as Select,U as default};
