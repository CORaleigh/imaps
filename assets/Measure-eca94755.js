import{e as s,y as r,b9 as W,ba as A,a as T,L as E,N as I,W as k,z as M,A as D,bb as O,_ as m,r as d,R as x,k as y,m as P,o as n,p as h,b7 as R,q as g}from"./index-3baec1e8.js";import{i as V}from"./getDefaultUnitForView-cf866a68.js";const $={title:"Measure Tips",tips:[{title:"Coordinate Search",text:"The coordinate search has been moved to the lower left corner of the map"}]},F={readOnly:!0,get(){return V(this.view)}};let c=class extends E{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){this._overrideIfSome("areaUnit",e)}get linearUnit(){return this.defaultUnit}set linearUnit(e){this._overrideIfSome("linearUnit",e)}get state(){const{activeViewModel:e}=this;return e?e.state:"disabled"}};s([r({type:["area","distance","direct-line"]})],c.prototype,"activeTool",void 0),s([r()],c.prototype,"activeViewModel",void 0),s([r({type:W})],c.prototype,"areaUnit",null),s([r(F)],c.prototype,"defaultUnit",void 0),s([r({type:A})],c.prototype,"linearUnit",null),s([r({readOnly:!0})],c.prototype,"state",null),s([r()],c.prototype,"view",void 0),c=s([T("esri.widgets.Measurement.MeasurementViewModel")],c);const b=c,U={base:"esri-measurement",widgetIcon:"esri-icon-measure"};function L(e){return(e==null?void 0:e.declaredClass)==="esri.widgets.AreaMeasurement2D"||(e==null?void 0:e.declaredClass)==="esri.widgets.AreaMeasurement3D"}let l=class extends k{constructor(e,i){super(e,i),this._widgets=new Map,this.activeWidget=null,this.iconClass=U.widgetIcon,this.messages=null,this.viewModel=new b}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then(e=>{this._set("activeWidget",e)}),this.addHandles([M(()=>[this.view,this.activeTool],async()=>{this._set("activeWidget",await this._getActiveWidget())}),M(()=>this.activeWidget,(e,i)=>{this.viewModel.set("activeViewModel",e?e.viewModel:null),i&&(i.visible=!1)}),M(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])}destroy(){this._destroyWidgets()}get activeTool(){return this.viewModel.activeTool}set activeTool(e){this.viewModel.activeTool=e}get areaUnit(){return this.viewModel.areaUnit}set areaUnit(e){this.viewModel.areaUnit=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get linearUnit(){return this.viewModel.linearUnit}set linearUnit(e){this.viewModel.linearUnit=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{activeWidget:e}=this,i=e&&!e.destroyed?e.render():null;return D("div",{class:U.base},i)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){const{activeViewModel:e}=this.viewModel;e&&O(e.start())}async _createWidget(e){const{areaUnit:i,linearUnit:t,view:a}=this;switch(e){case"area":{const{type:o}=a;switch(o){case"2d":return new(await m(()=>import("./AreaMeasurement2D-ee564a52.js"),["assets/AreaMeasurement2D-ee564a52.js","assets/index-3baec1e8.js","assets/index-0be7f32f.css","assets/analysisThemeUtils-008eb356.js","assets/colorUtils-3e96d895.js","assets/geometryEngine-29c8d8d1.js","assets/geometryEngineBase-e1a33b0a.js","assets/hydrated-aab91bce.js","assets/Draw-8f74de5a.js","assets/SnappingVisualizer2D-12606f78.js","assets/enums-55085e26.js","assets/settings-6ccf7b66.js","assets/SnappingContext-1315d9e2.js","assets/PointSnappingHint-9521c0f8.js","assets/plane-2064a861.js","assets/sphere-53166273.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/SnappingOperation-637889a7.js","assets/drawSurfaces-51a47f59.js","assets/quat-8214689a.js","assets/SnappingDragPipelineStep-5c33e2b0.js","assets/hydratedFeatures-cfdd4b72.js","assets/drawUtils-049f8883.js","assets/GraphicManipulator-a585ad64.js","assets/drapedUtils-96af76cf.js","assets/InteractiveToolViewModel-a487f2a2.js","assets/getDefaultUnitForView-cf866a68.js"])).default({view:a,unit:i,uiStrings:this._createUIStringsForWidget(e)});case"3d":return new(await m(()=>import("./AreaMeasurement3D-98a3684c.js"),["assets/AreaMeasurement3D-98a3684c.js","assets/index-3baec1e8.js","assets/index-0be7f32f.css","assets/Analysis-3cf50faa.js","assets/InteractiveAnalysisViewModel-3532e1ee.js","assets/geometryEngineBase-e1a33b0a.js","assets/SnappingDragPipelineStep-5c33e2b0.js","assets/hydratedFeatures-cfdd4b72.js","assets/drawUtils-049f8883.js","assets/SnappingContext-1315d9e2.js","assets/PointSnappingHint-9521c0f8.js","assets/plane-2064a861.js","assets/sphere-53166273.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/InteractiveToolViewModel-a487f2a2.js","assets/dragEventPipeline3D-e649083f.js","assets/vec4f32-0d1b2306.js","assets/Octree-5d19936f.js","assets/Util-4c7aae16.js","assets/lineSegment-7ee47e84.js","assets/NativeLineMaterial-0e346a9a.js","assets/interfaces-736d93d7.js","assets/basicInterfaces-04e01328.js","assets/enums-64ab819c.js","assets/VertexArrayObject-741e2cbe.js","assets/Texture-fc8c3a1e.js","assets/VertexColor.glsl-26856ca1.js","assets/requestImageUtils-341a8009.js","assets/OrderIndependentTransparency-92d1201d.js","assets/triangle-ade77c5f.js","assets/Indices-b87ac192.js","assets/VertexAttribute-15d1866a.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/quat-8214689a.js","assets/vec3f32-ad1dc57f.js","assets/BufferView-1e8da966.js","assets/VertexElementDescriptor-2925c6af.js","assets/NestedMap-1b5db22e.js","assets/InterleavedLayout-6fac11d9.js","assets/types-e1c0a5bf.js","assets/boundedPlane-c7cf001f.js","assets/glUtil-7a9be557.js","assets/DoubleArray-c2d9647b.js","assets/floatRGBA-8334d045.js","assets/analysisThemeUtils-008eb356.js","assets/colorUtils-3e96d895.js","assets/SnappingOperation-637889a7.js","assets/getDefaultUnitForView-cf866a68.js"])).default({view:a,unit:i,uiStrings:this._createUIStringsForWidget(e)});default:return null}}case"distance":{const{type:o}=a;return o==="2d"?new(await m(()=>import("./DistanceMeasurement2D-281775f0.js"),["assets/DistanceMeasurement2D-281775f0.js","assets/index-3baec1e8.js","assets/index-0be7f32f.css","assets/analysisThemeUtils-008eb356.js","assets/colorUtils-3e96d895.js","assets/geometryEngine-29c8d8d1.js","assets/geometryEngineBase-e1a33b0a.js","assets/hydrated-aab91bce.js","assets/Draw-8f74de5a.js","assets/SnappingVisualizer2D-12606f78.js","assets/enums-55085e26.js","assets/settings-6ccf7b66.js","assets/SnappingContext-1315d9e2.js","assets/PointSnappingHint-9521c0f8.js","assets/plane-2064a861.js","assets/sphere-53166273.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/SnappingOperation-637889a7.js","assets/drawSurfaces-51a47f59.js","assets/quat-8214689a.js","assets/SnappingDragPipelineStep-5c33e2b0.js","assets/hydratedFeatures-cfdd4b72.js","assets/drawUtils-049f8883.js","assets/GraphicManipulator-a585ad64.js","assets/drapedUtils-96af76cf.js","assets/InteractiveToolViewModel-a487f2a2.js","assets/getDefaultUnitForView-cf866a68.js"])).default({view:a,unit:t,uiStrings:this._createUIStringsForWidget(e)}):null}case"direct-line":{const{type:o}=a;return o==="3d"?new(await m(()=>import("./DirectLineMeasurement3D-ceed41b0.js"),["assets/DirectLineMeasurement3D-ceed41b0.js","assets/index-3baec1e8.js","assets/index-0be7f32f.css","assets/Analysis-3cf50faa.js","assets/InteractiveAnalysisViewModel-3532e1ee.js","assets/geometryEngineBase-e1a33b0a.js","assets/SnappingDragPipelineStep-5c33e2b0.js","assets/hydratedFeatures-cfdd4b72.js","assets/drawUtils-049f8883.js","assets/SnappingContext-1315d9e2.js","assets/PointSnappingHint-9521c0f8.js","assets/plane-2064a861.js","assets/sphere-53166273.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/InteractiveToolViewModel-a487f2a2.js","assets/dragEventPipeline3D-e649083f.js","assets/vec4f32-0d1b2306.js","assets/Octree-5d19936f.js","assets/Util-4c7aae16.js","assets/lineSegment-7ee47e84.js","assets/NativeLineMaterial-0e346a9a.js","assets/interfaces-736d93d7.js","assets/basicInterfaces-04e01328.js","assets/enums-64ab819c.js","assets/VertexArrayObject-741e2cbe.js","assets/Texture-fc8c3a1e.js","assets/VertexColor.glsl-26856ca1.js","assets/requestImageUtils-341a8009.js","assets/OrderIndependentTransparency-92d1201d.js","assets/triangle-ade77c5f.js","assets/Indices-b87ac192.js","assets/VertexAttribute-15d1866a.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/quat-8214689a.js","assets/vec3f32-ad1dc57f.js","assets/BufferView-1e8da966.js","assets/VertexElementDescriptor-2925c6af.js","assets/NestedMap-1b5db22e.js","assets/InterleavedLayout-6fac11d9.js","assets/types-e1c0a5bf.js","assets/boundedPlane-c7cf001f.js","assets/glUtil-7a9be557.js","assets/DoubleArray-c2d9647b.js","assets/floatRGBA-8334d045.js","assets/analysisThemeUtils-008eb356.js","assets/colorUtils-3e96d895.js","assets/getDefaultUnitForView-cf866a68.js"])).default({view:a,unit:t,uiStrings:this._createUIStringsForWidget(e)}):null}default:return null}}_destroyWidgets(){this._widgets.forEach(e=>e.destroy()),this._widgets.clear()}async _getActiveWidget(){const{activeTool:e,view:i}=this;if(!i||!e)return null;let t=null;if(this._widgets.has(e))t=this._widgets.get(e),t.visible=!0;else{if(t=await this._createWidget(e),!t)return null;await t.viewModel.start(),this._widgets.set(e,t)}return t}_createUIStringsForWidget(e){if(!this.uiStrings)return null;const i=e+"-"+this.view.type;return this.uiStrings[i]}_updateSubWidgetProperties(){this._widgets.forEach((e,i)=>{const{areaUnit:t,linearUnit:a}=this;e.unit=L(e)?t:a,e.uiStrings=this._createUIStringsForWidget(i)})}};s([r()],l.prototype,"activeTool",null),s([r({readOnly:!0})],l.prototype,"activeWidget",void 0),s([r()],l.prototype,"areaUnit",null),s([r()],l.prototype,"iconClass",void 0),s([r()],l.prototype,"label",null),s([r()],l.prototype,"linearUnit",null),s([r(),I("esri/widgets/Measurement/t9n/Measurement")],l.prototype,"messages",void 0),s([r()],l.prototype,"uiStrings",void 0),s([r()],l.prototype,"view",null),s([r({type:b})],l.prototype,"viewModel",void 0),l=s([T("esri.widgets.Measurement")],l);const j=l,z=(e,i)=>new j({view:i,container:e,areaUnit:"imperial",linearUnit:"imperial"}),N=e=>{const i=d.useRef(),t=d.useRef(!1),[a,o]=d.useState(""),[v,_]=d.useState(!1),u=d.useRef();d.useEffect(()=>{if(!t.current){t.current=!0;const p=z(i.current,e.view);u.current=p,p.watch("activeTool",f=>{f&&o(f||"")})}return()=>{}},[]),d.useEffect(()=>{_(e.isActive),e.isActive||(u.current.activeTool=null),v&&u.current&&(u.current.activeTool=a)},[e.isActive]);const w=d.useCallback(p=>{e.toolDismissed(),u.current.activeTool=null},[]),C=d.useCallback(p=>{e.showTips($)},[]);return{measureRef:i,measurement:u,selectedTool:a,setSelectedTool:o,isActive:v,toolDismissed:w,tipsClicked:C}},S=e=>{const{measureRef:i,measurement:t,selectedTool:a,setSelectedTool:o,isActive:v,toolDismissed:_,tipsClicked:u}=N(e);return y(P,{id:"measure-panel",heading:"Measure","data-panel":"measure",hidden:!v,closed:v?void 0:!0,closable:!0,onCalcitePanelClose:_,children:[n(h,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:u}),n(h,{id:"collapseTool",icon:"chevron-up",text:"",slot:"header-actions-end",onClick:R}),n(g,{label:"Show Tip",referenceElement:"tip",closeOnClick:!0,children:"Show Tip"}),n(g,{label:"Collapse",referenceElement:"collapseTool",closeOnClick:!0,children:"Collapse"}),y("div",{id:"measure-tools",children:[y("div",{className:"measure-container",children:[n(g,{closeOnClick:!0,label:"Distance",referenceElement:"measureDistance",children:"Distance"}),n(h,{id:"measureDistance",icon:"measure-line",text:"Distance",active:a==="distance"?!0:void 0,onClick:()=>{o("distance");debugger;t.current&&(t.current.activeTool="distance")}}),n(g,{closeOnClick:!0,label:"Area",referenceElement:"measureArea",children:"Area"}),n(h,{id:"measureArea",icon:"measure-area",text:"Area",active:a==="area"?!0:void 0,onClick:()=>{o("area"),t.current&&(t.current.activeTool="area")}}),n(g,{closeOnClick:!0,label:"Clear",referenceElement:"clearMeasure",children:"Clear"}),n(h,{id:"clearMeasure",icon:"trash",text:"Clear",onClick:()=>{var w;t.current&&((w=t.current)==null||w.clear(),o(""))}})]}),n("div",{ref:i}),n("section",{hidden:a!==""?!0:void 0,className:"measurement-hint",children:n("p",{children:"Select line or distance measurement tool"})})]})]})},q=x.memo(S),G=Object.freeze(Object.defineProperty({__proto__:null,Measure:S,default:q},Symbol.toStringTag,{value:"Module"}));export{G as M,F as e};
