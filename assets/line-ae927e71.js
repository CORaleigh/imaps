import{J as g,at as E,c3 as A,f2 as C,a2 as D,fo as b,fp as N,cG as I,g3 as F,aC as y,cK as U}from"./index-3baec1e8.js";import{w as v,x as L,q as f}from"./VertexColor.glsl-26856ca1.js";import{n as m,a as R}from"./DoubleArray-c2d9647b.js";import{a9 as x,c as P,N as B}from"./NativeLineMaterial-0e346a9a.js";import{O as u}from"./VertexAttribute-15d1866a.js";import{f as O,l as S}from"./triangulationUtils-d81b4f45.js";const i={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},Z={dash:i.dash,"dash-dot":[...i.dash,...i.dot],dot:i.dot,"long-dash":i["long-dash"],"long-dash-dot":[...i["long-dash"],...i.dot],"long-dash-dot-dot":[...i["long-dash"],...i.dot,...i.dot],none:null,"short-dash":i["short-dash"],"short-dash-dot":[...i["short-dash"],...i["short-dot"]],"short-dash-dot-dot":[...i["short-dash"],...i["short-dot"],...i["short-dot"]],"short-dot":i["short-dot"],solid:null},_=8;function H(t,o=2){return E(t)?t:{pattern:t.slice(),pixelRatio:o}}function at(t,o=2){return{pattern:[t,t],pixelRatio:o}}function et(t){return g(t)&&t.type==="style"?j(t.style):null}function j(t){return g(t)?H(Z[t],_):null}function rt(t,o,a=null){const s=[],n=[],c=o.mapPositions;z(o,n,s);const e=n[0][1].data,r=s[0][1].length,l=new Array(r).fill(0);return G(o,n,s,l),Y(o,n,s,l),M(o,n,s,l),W(o,n,s,l),q(o,n,s,l),J(o,n,s,l),K(o,n,s,e),new v(t,n,s,c,L.Line,a)}function z(t,o,a){const{attributeData:{position:s},removeDuplicateStartEnd:n}=t,c=$(s)&&n,e=s.length/3-(c?1:0),r=new Array(2*(e-1)),l=c?s.slice(0,s.length-3):s;let h=0;for(let p=0;p<e-1;p++)r[h++]=p,r[h++]=p+1;o.push([u.POSITION,new f(l,3,c)]),a.push([u.POSITION,r])}function G(t,o,a,s){if(g(t.attributeData.colorFeature))return;const n=t.attributeData.color;o.push([u.COLOR,new f(A(n,C),4)]),a.push([u.COLOR,s])}function M(t,o,a,s){if(!g(t.attributeData.normal))return;const n=t.attributeData.normal;o.push([u.NORMAL,new f(n,3)]),a.push([u.NORMAL,s])}function W(t,o,a,s){const n=t.attributeData.colorFeature;E(n)||(o.push([u.COLORFEATUREATTRIBUTE,new f([n],1,!0)]),a.push([u.COLOR,s]))}function Y(t,o,a,s){if(g(t.attributeData.sizeFeature))return;const n=t.attributeData.size;o.push([u.SIZE,new f([A(n,1)],1,!0)]),a.push([u.SIZE,s])}function q(t,o,a,s){const n=t.attributeData.sizeFeature;E(n)||(o.push([u.SIZEFEATUREATTRIBUTE,new f([n],1,!0)]),a.push([u.SIZEFEATUREATTRIBUTE,s]))}function J(t,o,a,s){const n=t.attributeData.opacityFeature;E(n)||(o.push([u.OPACITYFEATUREATTRIBUTE,new f([n],1,!0)]),a.push([u.OPACITYFEATUREATTRIBUTE,s]))}function K(t,o,a,s){if(E(t.overlayInfo)||t.overlayInfo.renderCoordsHelper.viewingMode!==D.Global||!t.overlayInfo.spatialReference.isGeographic)return;const n=m(s.length),c=b(t.overlayInfo.spatialReference);for(let d=0;d<n.length;d+=3)N(s,d,n,d,c);const e=s.length/3,r=x(e+1);let l=k,h=Q,p=0,T=0;I(l,n[T++],n[T++],n[T++]),r[0]=0;for(let d=1;d<e+1;++d)d===e&&(T=0),I(h,n[T++],n[T++],n[T++]),p+=F(l,h),r[d]=p,[l,h]=[h,l];o.push([u.DISTANCETOSTART,new f(r,1,!0)]),a.push([u.DISTANCETOSTART,a[0][1]])}function $(t){const o=t.length;return t[0]===t[o-3]&&t[1]===t[o-2]&&t[2]===t[o-1]}const k=y(),Q=y();function it(t,o,a,s){const n=t.type==="polygon"?O.CCW_IS_HOLE:O.NONE,c=t.type==="polygon"?t.rings:t.paths,{position:e,outlines:r}=S(c,!!t.hasZ,n),l=m(e.length),h=P(e,t.spatialReference,0,l,0,e,0,e.length/3,o,a,s),p=h!=null;return{lines:p?w(r,e,l):[],projectionSuccess:p,sampledElevation:h}}function lt(t,o){const a=t.type==="polygon"?O.CCW_IS_HOLE:O.NONE,s=t.type==="polygon"?t.rings:t.paths,{position:n,outlines:c}=S(s,!1,a),e=U(n,t.spatialReference,0,n,o,0,n.length/3);for(let r=2;r<n.length;r+=3)n[r]=B;return{lines:e?w(c,n):[],projectionSuccess:e}}function w(t,o,a=null){const s=new Array;for(const{index:n,count:c}of t){if(c<=1)continue;const e=3*n,r=3*c;s.push({position:R(o,3*n,3*c),mapPositions:g(a)?R(a,e,r):void 0})}return s}export{et as a,rt as b,lt as c,it as p,at as r};
