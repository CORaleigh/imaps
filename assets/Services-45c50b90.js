import{r as u,C as y,o as g,Y as b,k as d,hu as v,hv as h,hw as S,a1 as A}from"./index-3baec1e8.js";import{geodesicBuffer as E}from"./geometryEngine-29c8d8d1.js";import"./geometryEngineBase-e1a33b0a.js";import"./hydrated-aab91bce.js";const w=e=>{const t=u.useRef(null);return u.useEffect(()=>{e.feature&&new y({container:t.current,graphic:e.feature})},[e.feature]),g("div",{ref:t})},x=async e=>{const t=new b({portalItem:{id:"95092428774c4b1fb6a3b6f5fed9fbc4"}});return await t.load(),t.allLayers.filter(r=>e.includes(r.title)).toArray()},m=(e,t,s,r,a)=>{e==null||e.forEach(o=>{o.type==="feature"&&a.push(o.queryFeatures({geometry:E(t.geometry,-5,9002),outFields:["*"],returnGeometry:!0}))});const i=[];if(a.length)return Promise.all(a).then(o=>{o.forEach(n=>{n.features.length&&n.features.forEach(f=>{i.push(f)})}),r(!1),s(i)})},C=(e,t,s,r,a,i)=>{requestAnimationFrame(async()=>{if(e.target.hasAttribute("expanded")){i(!0),a([]);const o=e.target.getAttribute("item-title"),n=t.find(c=>c.group.title===o),f=[];if(n){let c=s==null?void 0:s.map.allLayers.filter(l=>n.group.layers.includes(l.title));if(c.length!==n.group.layers.length){const l=await x(n.group.layers);m(l,r,a,i,f)}else m(c.toArray(),r,a,i,f)}}})},q=e=>{const[t,s]=u.useState(),[r,a]=u.useState(),[i,o]=u.useState([]),[n,f]=u.useState(!1);return u.useEffect(()=>{e.view&&s(e.view),e.graphic&&a(e.graphic)},[]),d(v,{selectionMode:"single",children:[h.map(c=>d(S,{"item-title":c.group.title,heading:c.group.title,onClick:l=>{t&&r&&C(l,h,t,r,o,f)},children:[i.map((l,p)=>g(w,{feature:l},p)),i.length===0&&g("div",{children:"No information available."})]},c.group.title)),g(A,{loading:!0,hidden:n?void 0:!0})]})};export{q as Services,q as default};
