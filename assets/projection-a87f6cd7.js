import{aS as Y,cK as R,ed as _,eT as g,f4 as M,jU as O,ap as $,ch as j,l4 as x,am as U,an as W,aC as h,at as d,eO as S,l5 as V}from"./index-53e0d3f6.js";import{e as b}from"./mat3f64-221ce671.js";import{e as k}from"./mat4f64-65d35099.js";import{c as C}from"./spatialReferenceEllipsoidUtils-3b8ad13e.js";import{i as c,T as s}from"./BufferView-abbd0a70.js";import{t as w,r as v,o as B}from"./vec33-70b5bdb4.js";const A=Y.getLogger("esri.geometry.support.meshUtils.normalProjection");function I(r,e,o,a,t){return l(a)?(F(i.TO_PCPF,c.fromTypedArray(r),s.fromTypedArray(e),s.fromTypedArray(o),a,c.fromTypedArray(t)),t):(A.error("Cannot convert spatial reference to PCPF"),t)}function J(r,e,o,a,t){return l(a)?(F(i.FROM_PCPF,c.fromTypedArray(r),s.fromTypedArray(e),s.fromTypedArray(o),a,c.fromTypedArray(t)),t):(A.error("Cannot convert to spatial reference from PCPF"),t)}function Q(r,e,o){return R(r,e,0,o,C(e),0,r.length/3),o}function X(r,e,o){return R(r,C(o),0,e,o,0,r.length/3),e}function rr(r,e,o){if(d(r))return e;const a=s.fromTypedArray(r),t=s.fromTypedArray(e);return w(t,a,o),e}function er(r,e,o){if(d(r))return e;S(n,o);const a=c.fromTypedArray(r),t=c.fromTypedArray(e);return v(t,a,n),V(n)||B(t,t),e}function tr(r,e,o){if(d(r))return e;S(n,o);const a=c.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),t=c.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT);if(v(t,a,n),V(n)||B(t,t),r!==e)for(let f=3;f<r.length;f+=4)e[f]=r[f];return e}function or(r,e,o,a,t){if(!l(a))return A.error("Cannot convert spatial reference to PCPF"),t;F(i.TO_PCPF,c.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),s.fromTypedArray(e),s.fromTypedArray(o),a,c.fromTypedArray(t,4*Float32Array.BYTES_PER_ELEMENT));for(let f=3;f<r.length;f+=4)t[f]=r[f];return t}function ar(r,e,o,a,t){if(!l(a))return A.error("Cannot convert to spatial reference from PCPF"),t;F(i.FROM_PCPF,c.fromTypedArray(r,16),s.fromTypedArray(e),s.fromTypedArray(o),a,c.fromTypedArray(t,16));for(let f=3;f<r.length;f+=4)t[f]=r[f];return t}function F(r,e,o,a,t,f){if(!e)return;const E=o.count,T=C(t);if(L(t))for(let y=0;y<E;y++)a.getVec(y,p),e.getVec(y,m),_(T,p,P,T),g(n,P),r===i.FROM_PCPF&&M(n,n),O(m,m,n),f.setVec(y,m);else for(let y=0;y<E;y++){a.getVec(y,p),e.getVec(y,m),_(T,p,P,T),g(n,P);const N=$(o.get(y,1));let u=Math.cos(N);r===i.TO_PCPF&&(u=1/u),n[0]*=u,n[1]*=u,n[2]*=u,n[3]*=u,n[4]*=u,n[5]*=u,r===i.FROM_PCPF&&M(n,n),O(m,m,n),j(m,m),f.setVec(y,m)}return f}function l(r){return L(r)||z(r)}function L(r){return r.isWGS84||x(r)||U(r)||W(r)}function z(r){return r.isWebMercator}var i;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(i||(i={}));const p=h(),m=h(),P=k(),n=b();export{ar as L,Q as M,rr as O,X as R,tr as V,J as h,I as j,or as k,er as v};
