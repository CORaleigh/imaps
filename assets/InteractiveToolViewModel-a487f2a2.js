import{e as o,y as i,a as h,L as n,x as v,aS as d,z as p,U as u,J as r,a7 as c,at as l,aY as w,cv as g}from"./index-3baec1e8.js";let s=class extends n{constructor(t){super(t),this.tool=null,this._baseHandles=new v,this._loggedUnsupportedErrorOnce=!1,this.logger=d.getLogger(this.declaredClass),t&&t.visible!=null&&(this.visible=t.visible)}initialize(){this._baseHandles.add(p(()=>({ready:r(this.view)&&this.view.ready,supported:this.supported}),({ready:t,supported:e})=>{!t||e||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)},u))}destroy(){this.removeTool(),this.view=null,this._baseHandles=c(this._baseHandles)}get active(){return r(this.tool)&&this.tool.active}get disabled(){return l(this.view)||!this.view.ready||!this.supported}get supported(){return l(this.view)||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(t){if(t===this.view)return;this.removeTool(),this._set("view",t);const e="tools";this._baseHandles.remove(e),l(t)||this._baseHandles.add(t.tools.on("after-remove",a=>{a.item===this.tool&&this._set("tool",null)}),e)}set visible(t){this._set("visible",t),r(this.tool)&&(this.tool.visible=t)}createTool(t={interactive:!1}){if(this.removeTool(),l(this.view)||!this.view.ready||!this.supported)return;const e=this.constructTool();e.created?(this._set("tool",e),this.view.tools.add(e)):t.interactive?(this._set("tool",e),this.view.addAndActivateTool(e),w(()=>e.created,()=>{e.active&&r(this.view)&&(this.view.activeTool=null)},{initial:!0,once:!0})):e.destroy()}removeTool(){const t=this.tool;if(l(t))return;const e=g(this.view,a=>a.tools);r(e)?e.remove(t):t.destroy(),this._set("tool",null)}logError(...t){this.logger.error(...t)}};o([i({constructOnly:!0})],s.prototype,"tool",void 0),o([i()],s.prototype,"active",null),o([i()],s.prototype,"disabled",null),o([i()],s.prototype,"supported",null),o([i({value:null})],s.prototype,"view",null),o([i({type:Boolean,value:!0})],s.prototype,"visible",null),s=o([h("esri.widgets.support.InteractiveToolViewModel")],s);export{s as v};
