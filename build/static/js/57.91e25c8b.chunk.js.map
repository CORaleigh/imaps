{"version":3,"sources":["../node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/BaseTileRenderer.js","../node_modules/@arcgis/core/views/2d/engine/BitmapTile.js","../node_modules/@arcgis/core/views/2d/engine/BitmapTileContainer.js","../node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/support/HeatmapSource.js","../node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/HeatmapTileRenderer.js","../node_modules/@arcgis/core/views/2d/engine/webgl/TileContainer.js","../node_modules/@arcgis/core/views/2d/engine/ImageryBitmapSource.js","../node_modules/@arcgis/core/views/2d/engine/Bitmap.js","../node_modules/@arcgis/core/renderers/support/heatmapUtils.js"],"names":["i","e","tiles","Map","this","clear","layer","layerView","tileInfoView","isUpdating","t","createTile","once","notifyChange","set","id","forEach","delete","key","disposeTile","isReady","requestUpdate","s","prototype","o","r","bitmap","coordScale","ready","destroy","beforeRender","afterRender","stencilRef","transforms","dvs","stage","n","children","some","blendFunction","_tileInfoView","getTileBounds","tileInfo","size","registerRenderPass","name","brushes","target","map","drawPhase","MAP","visible","gradient","height","width","intensities","minPixelIntensity","maxPixelIntensity","_intensityInfo","featuresView","attributeView","initialize","requestRender","_container","getTileCoords","resolution","getTileResolution","renderer","type","_gradient","toJSON","source","invalidateTexture","Promise","resolve","addChild","removeAllChildren","removeChild","get","tileKey","intensityInfo","matrix","console","error","a","level","row","col","sortChildren","setStencilReference","state","requiredLevel","getClosestInfoForScale","scale","displayLevel","scaleToZoom","DEBUG","HIGHLIGHT","getStencilTarget","has","setTransform","pixelBlock","extent","originalPixelBlock","filter","l","getAsRGBA","h","createImageData","data","putImageData","renderedRasterPixels","Uint8Array","buffer","x","pixelFormat","internalFormat","dataType","wrapMode","_","requestRenderOnSourceChangedEnabled","_textureInvalidated","_height","pixelRatio","rotation","_source","_width","y","bind","_texture","dispose","sourceWidth","sourceHeight","HTMLImageElement","naturalHeight","naturalWidth","updateTexture","toScreenNoRotation","u","d","c","Math","PI","displayViewMat3","mips","descriptor","hasMipmap","generateMipmap","setSamplingMode","samplingMode","context","bindTexture","resize","getRenderedRasterPixels","setData","document","createElement","render","getContext","clearRect","createLinearGradient","colorStops","ratio","color","addColorStop","max","fillStyle","fillRect","getImageData","blurRadius","fieldOffset","field","Float64Array","f","round","Number","NEGATIVE_INFINITY","m","readAttribute","g","Set","getCursor","next","getObjectId","add","readLegacyPointGeometry","M","min","b","canvas","Uint8ClampedArray","Uint32Array","length","floor","exp","sqrt"],"mappings":"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","file":"static/js/57.91e25c8b.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import{HandleOwner as s}from\"../../../../../core/HandleOwner.js\";let i=class extends s{constructor(e){super(e),this.tiles=new Map}destroy(){this.tiles.clear(),this.layer=this.layerView=this.tileInfoView=this.tiles=null}get updating(){return this.isUpdating()}acquireTile(e){const t=this.createTile(e);return t.once(\"isReady\",(()=>this.notifyChange(\"updating\"))),this.tiles.set(e.id,t),t}forceAttributeTextureUpload(){}forEachTile(e){this.tiles.forEach(e)}releaseTile(e){this.tiles.delete(e.key.id),this.disposeTile(e)}isUpdating(){let e=!0;return this.tiles.forEach((t=>{e=e&&t.isReady})),!e}setHighlight(){}invalidateLabels(){}requestUpdate(){this.layerView.requestUpdate()}};e([t()],i.prototype,\"layer\",void 0),e([t()],i.prototype,\"layerView\",void 0),e([t()],i.prototype,\"tileInfoView\",void 0),e([t()],i.prototype,\"updating\",null),i=e([r(\"esri.views.2d.layers.features.tileRenderers.BaseTileRenderer\")],i);var o=i;export default o;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{TiledDisplayObject as t}from\"./webgl/TiledDisplayObject.js\";import{Bitmap as e}from\"./Bitmap.js\";class s extends t{constructor(t,s,r,i=null){super(t,s,r,r),this.bitmap=new e(i,\"standard\",!1),this.bitmap.coordScale=r,this.bitmap.once(\"isReady\",(()=>this.ready()))}destroy(){super.destroy(),this.bitmap.destroy()}beforeRender(t){super.beforeRender(t),this.bitmap.beforeRender(t)}afterRender(t){super.afterRender(t),this.bitmap.afterRender(t)}set stencilRef(t){this.bitmap.stencilRef=t}get stencilRef(){return this.bitmap.stencilRef}setTransform(t,e){super.setTransform(t,e),this.bitmap.transforms.dvs=this.transforms.dvs}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap&&(this.bitmap.stage=null)}}export{s as BitmapTile};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../../../geometry/support/aaBoundingRect.js\";import{WGLDrawPhase as r}from\"./webgl/enums.js\";import{brushes as s}from\"./brushes.js\";import t from\"./webgl/TileContainer.js\";import{BitmapTile as i}from\"./BitmapTile.js\";class n extends t{get requiresDedicatedFBO(){return this.children.some((e=>\"additive\"===e.bitmap.blendFunction))}createTile(r){const s=this._tileInfoView.getTileBounds(e(),r);return new i(r,s,this._tileInfoView.tileInfo.size)}destroyTile(){}prepareRenderPasses(e){const t=e.registerRenderPass({name:\"bitmap (tile)\",brushes:[s.bitmap],target:()=>this.children.map((e=>e.bitmap)),drawPhase:r.MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===r.MAP&&super.doRender(e)}}export{n as BitmapTileContainer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{drawHeatmap as t}from\"../../../../../../renderers/support/heatmapUtils.js\";class i{constructor(){this.gradient=null,this.height=512,this.width=512}render(i){t(i,512,this.intensities,this.gradient,this.minPixelIntensity,this.maxPixelIntensity)}}export{i as HeatmapSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import{generateGradient as i}from\"../../../../../renderers/support/heatmapUtils.js\";import{BitmapTileContainer as r}from\"../../../engine/BitmapTileContainer.js\";import s from\"./BaseTileRenderer.js\";import{HeatmapSource as n}from\"./support/HeatmapSource.js\";let o=class extends s{constructor(e){super(e),this._intensityInfo={minPixelIntensity:0,maxPixelIntensity:0},this.featuresView={attributeView:{initialize:()=>{},requestUpdate:()=>{}},requestRender:()=>{}},this._container=new r(e.tileInfoView)}createTile(e){const t=this._container.createTile(e);return this.tileInfoView.getTileCoords(t.bitmap,e),t.bitmap.resolution=this.tileInfoView.getTileResolution(e),t}onConfigUpdate(){const e=this.layer.renderer;if(\"heatmap\"===e.type){const{minPixelIntensity:t,maxPixelIntensity:r}=e;this._intensityInfo.minPixelIntensity=t,this._intensityInfo.maxPixelIntensity=r,this._gradient=i(e.toJSON()),this.tiles.forEach((e=>{const i=e.bitmap.source;i&&(i.minPixelIntensity=t,i.maxPixelIntensity=r,i.gradient=this._gradient,e.bitmap.invalidateTexture())}))}}hitTest(){return Promise.resolve([])}install(e){e.addChild(this._container)}uninstall(e){this._container.removeAllChildren(),e.removeChild(this._container)}disposeTile(e){this._container.removeChild(e),e.destroy()}supportsRenderer(e){return e&&\"heatmap\"===e.type}onTileData(e){const t=this.tiles.get(e.tileKey);if(!t)return;const i=e.intensityInfo,{minPixelIntensity:r,maxPixelIntensity:s}=this._intensityInfo,o=t.bitmap.source||new n;o.intensities=i&&i.matrix||null,o.minPixelIntensity=r,o.maxPixelIntensity=s,o.gradient=this._gradient,t.bitmap.source=o,this._container.addChild(t),this.requestUpdate()}onTileError(e){console.error(e)}lockGPUUploads(){}unlockGPUUploads(){}};o=e([t(\"esri.views.2d.layers.features.tileRenderers.HeatmapTileRenderer\")],o);var a=o;export default a;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"./enums.js\";import r from\"./brushes/WGLBrushInfo.js\";import s from\"./brushes/WGLBrushStencil.js\";import t from\"./WGLContainer.js\";const n=(e,r)=>e.key.level-r.key.level!=0?e.key.level-r.key.level:e.key.row-r.key.row!=0?e.key.row-r.key.row:e.key.col-r.key.col;class i extends t{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(n),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:r}=e;return{...super.createRenderParams(e),requiredLevel:this._tileInfoView.getClosestInfoForScale(r.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(r.scale)}}prepareRenderPasses(t){const n=t.registerRenderPass({name:\"stencil\",brushes:[s],drawPhase:e.DEBUG|e.MAP|e.HIGHLIGHT,target:()=>this.getStencilTarget()}),i=t.registerRenderPass({name:\"tileInfo\",brushes:[r],drawPhase:e.DEBUG,target:()=>this.children,has:\"esri-tiles-debug\"});return[...super.prepareRenderPasses(t),n,i]}getStencilTarget(){return this.children}updateTransforms(e){for(const r of this.children){const s=this._tileInfoView.getTileResolution(r.key);r.setTransform(e,s)}}setStencilReference(){let e=1;for(const r of this.children)r.stencilRef=e++}}export default i;export{n as sortByLevel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nclass e{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return this.pixelBlock?this.pixelBlock.width:0}get height(){return this.pixelBlock?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if(!t)return;const i=this.filter({pixelBlock:t}),l=i.pixelBlock.getAsRGBA(),h=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);h.data.set(l),e.putImageData(h,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}export default e;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../core/has.js\";import{i as t,a as e,r as i,j as s,m as r}from\"../../../chunks/mat3.js\";import{c as h}from\"../../../chunks/mat3f32.js\";import{f as n}from\"../../../chunks/vec2f32.js\";import\"../../../chunks/builtins.js\";import\"../../webgl/checkWebGLError.js\";import o from\"../../webgl/Texture.js\";import\"../../webgl/FramebufferObject.js\";import{DisplayObject as u}from\"./DisplayObject.js\";import a from\"./ImageryBitmapSource.js\";function d(t){return t&&\"render\"in t}function c(t){return t&&!(\"render\"in t)}function l(t){const e=document.createElement(\"canvas\");return e.width=t.width,e.height=t.height,t.render(e.getContext(\"2d\")),e}function x(t,e,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return e&&i&&(s.width=e,s.height=i),new o(t,s)}class _ extends u{constructor(t=null,e,i=!0){super(),this.requestRenderOnSourceChangedEnabled=i,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.transforms={dvs:h()},this.blendFunction=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){this._source=t,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}setTransform(h){const o=t(this.transforms.dvs),[u,a]=h.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/h.resolution,c=d*this.width,l=d*this.height,x=Math.PI*this.rotation/180;e(o,o,n(u,a)),e(o,o,n(c/2,l/2)),i(o,o,-x),e(o,o,n(-c/2,-l/2)),s(o,o,n(c,l)),r(this.transforms.dvs,h.displayViewMat3,o)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind({context:t},e){this._texture&&t.bindTexture(this._texture,e)}updateTexture({context:t}){var e;if(!this.stage)return null==(e=this._texture)||e.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=x(t,this.sourceWidth,this.sourceHeight):this._texture=x(t));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),d(i))if(i instanceof a){const t=i.getRenderedRasterPixels();this._texture.setData(t.renderedRasterPixels)}else this._texture.setData(l(i));else c(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}export{_ as Bitmap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport t from\"../../core/global.js\";import{clamp as e}from\"../../core/mathUtils.js\";const n=(()=>{if(!(\"document\"in t))return()=>null;const e=document.createElement(\"canvas\"),n=e.getContext(\"2d\"),r=512;return e.height=r,e.width=1,t=>{n.clearRect(0,0,1,e.height);const r=n.createLinearGradient(0,0,0,e.height);for(const{ratio:e,color:n}of t.colorStops)r.addColorStop(Math.max(e,.001),`rgba(${n[0]}, ${n[1]}, ${n[2]}, ${n[3]})`);return n.fillStyle=r,n.fillRect(0,0,1,e.height),n.getImageData(0,0,1,e.height).data}})();function r(t,e,n,r){const{blurRadius:o,fieldOffset:a,field:i}=e,u=new Float64Array(n*r),l=f(o),s=Math.round(3*o);let h,d=Number.NEGATIVE_INFINITY;const m=c(i,a);for(const{geometry:f,attributes:c}of t){const t=f.x-s,e=f.y-s,o=Math.max(0,t),a=Math.max(0,e),i=Math.min(r,f.y+s),g=Math.min(n,f.x+s),y=+m(c);for(let r=a;r<i;r++){const a=l[r-e];for(let e=o;e<g;e++){const o=l[e-t];h=u[r*n+e]+=a*o*y,h>d&&(d=h)}}}return{matrix:u.buffer,max:d}}function o(t,e,n,r){const{blurRadius:o,fieldOffset:a,field:i}=e,c=new Float64Array(n*r),l=f(o),s=Math.round(3*o);let h,d=Number.NEGATIVE_INFINITY;const m=u(i,a),g=new Set;for(const f of t){const t=f.getCursor();for(;t.next();){const e=t.getObjectId();if(g.has(e))continue;g.add(e);const o=t.readLegacyPointGeometry(),a=128;if(o.x<-a||o.x>=n+a||o.y<-a||o.y>r+a)continue;const i=+m(t),f=Math.round(o.x)-s,u=Math.round(o.y)-s,y=Math.max(0,f),M=Math.max(0,u),x=Math.min(r,Math.round(o.y)+s),b=Math.min(n,Math.round(o.x)+s);for(let t=M;t<x;t++){const e=l[t-u];for(let r=y;r<b;r++){const o=l[r-f];h=c[t*n+r]+=e*o*i,h>d&&(d=h)}}}}return{matrix:c.buffer,max:d}}function a(t,e,n,r,o,a){t.canvas.width=t.canvas.height=e,t.clearRect(0,0,e,e);const f=t.getImageData(0,0,e,e);n&&r&&f.data.set(new Uint8ClampedArray(i(e,n,r,o,a))),t.putImageData(f,0,0)}function i(t,n,r,o,a){const i=new Uint32Array(t*t),f=\"buffer\"in n?n:new Float64Array(n),c=\"buffer\"in r?new Uint32Array(r.buffer):new Uint32Array(new Uint8Array(r).buffer),u=c.length/(a-o);for(let l=0;l<f.length;l++){const t=f[l],n=Math.floor((t-o)*u);i[l]=c[e(n,0,c.length-1)]}return i.buffer}function f(t){const e=Math.round(3*t),n=2*t*t,r=new Float64Array(2*e+1);for(let o=0;o<=r.length;o++)r[o]=Math.exp(-((o-e)**2)/n)/Math.sqrt(2*Math.PI)*(t/2);return r}function c(t,e){return\"function\"==typeof t?t:t?\"string\"==typeof e?e=>-1*+e[t]:n=>+n[t]+e:()=>1}function u(t,e){return null!=t?\"string\"==typeof e?e=>-1*+e.readAttribute(t):n=>+n.readAttribute(t)+e:t=>1}export{r as calculateHeatmapIntensityInfo,o as calculateHeatmapIntensityInfoReaders,i as createHeatmapImageData,f as createKernel,c as createValueFunction,u as createValueFunctionCursor,a as drawHeatmap,n as generateGradient};\n"],"sourceRoot":""}