(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[7],{1044:function(e,t,i){"use strict";var r=i(2),n=i(3),a=i(6),s=i(46),o=i(37),c=i(26),h=i(13),u=i(253),l=i(82),d=i(110),f=i(58),b=i(92),v=i(34),p=i(83),j=i(232),_=i(55),y=i(79),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(r.a)(this,e),this._viewUp=Object(c.e)(),this._viewForward=Object(c.e)(),this._viewRight=Object(c.e)(),this._ray=_.f.createWrapper(),this._viewport=Object(b.d)(0,0,1,1),this._padding=Object(b.d)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Object(f.e)(1,1e3),this._viewDirty=!0,this._viewMatrix=Object(d.b)(),this._projectionDirty=!0,this._projectionMatrix=Object(d.b)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=Object(d.b)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=Object(d.b)(),this._frustumDirty=!0,this._frustum=_.c.create(),this._fullViewport=Object(b.c)(),this.pixelRatio=1,this.relativeElevation=0,this._eye=Object(a.k)(t)?Object(c.d)(t):Object(c.e)(),this._center=Object(a.k)(i)?Object(c.d)(i):Object(c.e)(),this._up=Object(a.k)(n)?Object(c.d)(n):Object(c.g)(0,0,1)}return Object(n.a)(e,[{key:"eye",get:function(){return this._eye},set:function(e){this._compareAndSetView(e,this._eye)}},{key:"center",get:function(){return this._center},set:function(e){this._compareAndSetView(e,this._center)}},{key:"ray",get:function(){return this._ray.origin=this.eye,this._ray.direction||(this._ray.direction=Object(c.e)()),Object(h.i)(this._ray.direction,this.center,this.eye),this._ray}},{key:"up",get:function(){return this._up},set:function(e){this._compareAndSetView(e,this._up)}},{key:"viewMatrix",get:function(){return this._ensureViewClean(),this._viewMatrix},set:function(e){Object(l.c)(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"viewForward",get:function(){return this._ensureViewClean(),this._viewForward}},{key:"viewUp",get:function(){return this._ensureViewClean(),this._viewUp}},{key:"viewRight",get:function(){return this._ensureViewClean(),this._viewRight}},{key:"nearFar",get:function(){return this._nearFar}},{key:"near",get:function(){return this._nearFar[0]},set:function(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"far",get:function(){return this._nearFar[1]},set:function(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewport",get:function(){return this._viewport},set:function(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}},{key:"x",get:function(){return this._viewport[0]},set:function(e){e+=this._padding[3],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"y",get:function(){return this._viewport[1]},set:function(e){e+=this._padding[2],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"width",get:function(){return this._viewport[2]},set:function(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"height",get:function(){return this._viewport[3]},set:function(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"fullWidth",get:function(){return this._viewport[2]+this._padding[1]+this._padding[3]},set:function(e){this.width=e-(this._padding[1]+this._padding[3])}},{key:"fullHeight",get:function(){return this._viewport[3]+this._padding[0]+this._padding[2]},set:function(e){this.height=e-(this._padding[0]+this._padding[2])}},{key:"fullViewport",get:function(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}},{key:"aspect",get:function(){return this.width/this.height}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding[0]===e[0]&&this._padding[1]===e[1]&&this._padding[2]===e[2]&&this._padding[3]===e[3]||(this._viewport[0]+=e[3]-this._padding[3],this._viewport[1]+=e[2]-this._padding[2],this._viewport[2]-=e[1]+e[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=e[0]+e[2]-(this._padding[0]+this._padding[2]),Object(p.c)(this._padding,e),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}},{key:"viewProjectionMatrix",get:function(){return this._viewProjectionDirty&&(Object(l.l)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}},{key:"projectionMatrix",get:function(){if(this._projectionDirty){var e=this.width,t=this.height,i=this.near*Math.tan(this.fovY/2),r=i*this.aspect;Object(l.h)(this._projectionMatrix,-r*(1+2*this._padding[3]/e),r*(1+2*this._padding[1]/e),-i*(1+2*this._padding[2]/t),i*(1+2*this._padding[0]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix},set:function(e){Object(l.c)(this._projectionMatrix,e),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fov",get:function(){return this._fov},set:function(e){this._fov=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovX",get:function(){return Object(y.b)(this._fov,this.width,this.height)},set:function(e){this._fov=Object(y.d)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"fovY",get:function(){return Object(y.c)(this._fov,this.width,this.height)},set:function(e){this._fov=Object(y.e)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}},{key:"distance",get:function(){return Object(h.n)(this._center,this._eye)}},{key:"frustum",get:function(){return this._recomputeFrustum(),this._frustum}},{key:"viewInverseTransposeMatrix",get:function(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(Object(l.a)(this._viewInverseTransposeMatrix,this.viewMatrix),Object(l.b)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}},{key:"depthNDCToWorld",value:function(e){var t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}},{key:"perRenderPixelRatio",get:function(){return Math.tan(this.fovX/2)/(this.width/2)}},{key:"perScreenPixelRatio",get:function(){return this.perRenderPixelRatio*this.pixelRatio}},{key:"aboveGround",get:function(){return this.relativeElevation&&this.relativeElevation>=0}},{key:"copyFrom",value:function(e){var t=e;return Object(h.j)(this._eye,t._eye),Object(h.j)(this._center,t._center),Object(h.j)(this._up,t._up),Object(p.c)(this._viewport,t._viewport),Object(p.c)(this._padding,t._padding),Object(v.c)(this._nearFar,t._nearFar),this._fov=t._fov,this.relativeElevation=e.relativeElevation,this._viewDirty=t._viewDirty,this._viewDirty||(Object(l.c)(this._viewMatrix,t._viewMatrix),Object(h.j)(this._viewRight,t._viewRight),Object(h.j)(this._viewUp,t._viewUp),Object(h.j)(this._viewForward,t._viewForward)),t._projectionDirty?this._projectionDirty=!0:(Object(l.c)(this._projectionMatrix,t._projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(_.c.copy(t._frustum,this._frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Object(l.c)(this._viewInverseTransposeMatrix,t._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Object(p.c)(this._fullViewport,t._fullViewport),this.pixelRatio=e.pixelRatio,this}},{key:"copyViewFrom",value:function(e){this.eye=e.eye,this.center=e.center,this.up=e.up}},{key:"clone",value:function(){return(new e).copyFrom(this)}},{key:"equals",value:function(e){return Object(h.p)(this._eye,e._eye)&&Object(h.p)(this._center,e._center)&&Object(h.p)(this._up,e._up)&&Object(p.g)(this._viewport,e._viewport)&&Object(p.g)(this._padding,e._padding)&&Object(v.k)(this._nearFar,e._nearFar)&&this._fov===e._fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}},{key:"almostEquals",value:function(e){if(this.pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;var t=5e-4;Object(h.u)(w,e.eye,e.center),Object(h.u)(k,this._eye,this._center);var i=Object(h.g)(w,k),r=Object(h.x)(w),n=Object(h.x)(k);return i*i>=(1-1e-10)*r*n&&Object(h.y)(e.eye,this._eye)<Math.max(r,n)*t*t&&Object(p.i)(e.padding,this._padding)<.5&&Object(p.i)(e.viewport,this._viewport)<.5}},{key:"markViewDirty",value:function(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}},{key:"computeRenderPixelSizeAt",value:function(e){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(e))}},{key:"computeRenderPixelSizeAtDist",value:function(e){return e*this.perRenderPixelRatio}},{key:"computeScreenPixelSizeAt",value:function(e){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(e))}},{key:"viewDirectionDistance",value:function(e){return Math.abs(Object(j.c)(this.viewForward,Object(h.i)(w,e,this._eye)))}},{key:"computeScreenPixelSizeAtDist",value:function(e){return e*this.perScreenPixelRatio}},{key:"computeDistanceFromRadius",value:function(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}},{key:"getScreenCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(o.g)();return e[0]=(this.padding[3]+this.width/2)/this.pixelRatio,e[1]=(this.padding[0]+this.height/2)/this.pixelRatio,e}},{key:"getRenderCenter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return e||(e=Object(o.e)()),e[0]=this.padding[3]+this.width*t,e[1]=this.padding[2]+this.height*i,e.length>2&&(e[2]=.5),e}},{key:"setGLViewport",value:function(e){var t=this.viewport,i=this.padding;e.setViewport(t[0]-i[3],t[1]-i[2],t[2]+i[1]+i[3],t[3]+i[0]+i[2])}},{key:"applyProjection",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==O&&Object(h.j)(O,e),O[3]=1,i&&(t[2]=-O[2]),Object(p.m)(O,O,this.projectionMatrix),Object(h.d)(O,O,1/Math.abs(O[3]));var r=this.fullViewport;return t[0]=Object(s.l)(0,r[0]+r[2],.5+.5*O[0]),t[1]=Object(s.l)(0,r[1]+r[3],.5+.5*O[1]),i||(t[2]=.5*(O[2]+1)),t}},{key:"projectToScreen",value:function(e,t){return this.projectToRenderScreen(e,S),this.renderToScreen(S,t)}},{key:"projectToRenderScreen",value:function(e,t){if(O[0]=e[0],O[1]=e[1],O[2]=e[2],O[3]=1,Object(p.m)(O,O,this.viewProjectionMatrix),0===O[3])return null;Object(h.d)(O,O,1/Math.abs(O[3]));var i=this.fullViewport;return"x"in t?(t.x=Object(s.l)(0,i[0]+i[2],.5+.5*O[0]),t.y=Object(s.l)(0,i[1]+i[3],.5+.5*O[1])):(t[0]=Object(s.l)(0,i[0]+i[2],.5+.5*O[0]),t[1]=Object(s.l)(0,i[1]+i[3],.5+.5*O[1]),t.length>2&&(t[2]=.5*(O[2]+1))),t}},{key:"unprojectFromScreen",value:function(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,S),t)}},{key:"unprojectFromRenderScreen",value:function(e,t){if(Object(l.l)(m,this.projectionMatrix,this.viewMatrix),!Object(l.a)(m,m))return null;var i=this.fullViewport;return O[0]=2*(e[0]-i[0])/i[2]-1,O[1]=2*(e[1]-i[1])/i[3]-1,O[2]=2*e[2]-1,O[3]=1,Object(p.m)(O,O,m),0===O[3]?null:(t[0]=O[0]/O[3],t[1]=O[1]/O[3],t[2]=O[2]/O[3],t)}},{key:"constrainWindowSize",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=e*this.pixelRatio,a=t*this.pixelRatio,s=Math.max(n-i*r/2,0),o=Math.max(this.fullHeight-a-i/2,0),c=-Math.min(n-i*r/2,0),h=-Math.min(this.fullHeight-a-i/2,0);return[s,o,i*r-c- -Math.min(this.fullWidth-n-i*r/2,0),i-h- -Math.min(a-i/2,0)]}},{key:"computeUp",value:function(e){1===e?this.computeUpGlobal():this.computeUpLocal()}},{key:"screenToRender",value:function(e,t){var i=e[0]*this.pixelRatio,r=this.fullHeight-e[1]*this.pixelRatio;return t[0]=i,t[1]=r,t}},{key:"renderToScreen",value:function(e,t){var i=e[0]/this.pixelRatio,r=(this.fullHeight-e[1])/this.pixelRatio;return t[0]=i,t[1]=r,t}},{key:"computeUpGlobal",value:function(){Object(h.i)(w,this.center,this.eye);var e=Object(h.o)(this.center);e<1?(Object(h.v)(this.up,0,0,1),this.markViewDirty()):Math.abs(Object(h.g)(w,this.center))>.9999*Object(h.o)(w)*e||(Object(h.f)(this.up,w,this.center),Object(h.f)(this.up,this.up,w),Object(h.q)(this.up,this.up),this.markViewDirty())}},{key:"computeUpLocal",value:function(){Object(u.d)(w,this.eye,this.center),Math.abs(w[2])<=.9999&&(Object(h.d)(w,w,w[2]),Object(h.v)(this.up,-w[0],-w[1],1-w[2]),Object(h.q)(this.up,this.up),this.markViewDirty())}},{key:"_compareAndSetView",value:function(e,t){Object(h.p)(e,t)||(Object(h.j)(t,e),this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0)}},{key:"_recomputeFrustum",value:function(){this._frustumDirty&&(_.c.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}},{key:"_ensureViewClean",value:function(){this._viewDirty&&(Object(l.k)(this._viewMatrix,this._eye,this._center,this._up),Object(h.v)(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Object(h.v)(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Object(h.v)(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}]),e}(),O=Object(b.c)(),m=Object(d.b)(),w=Object(c.e)(),k=Object(c.e)(),S=Object(o.e)();t.a=g},1048:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r,n,a=i(33),s=i(35);!function(e){e.builder=function(e,t){e.vertex.uniforms.add("camPos","vec3").add("perScreenPixelRatio","float").add("screenSize","float"),e.vertex.code.add(Object(s.a)(r||(r=Object(a.a)(["\n    float computeRenderPixelSizeAt( vec3 pWorld ){\n      vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\n      float viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\n      return viewDirectionDistance*perScreenPixelRatio;\n    }\n\n    vec3 screenSizeScaling(vec3 position, vec3 anchor){\n      return position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n    }\n  "]))))},e.bindPassUniforms=function(e,t,i){e.setUniform1f("perScreenPixelRatio",i.camera.perScreenPixelRatio),e.setUniform1f("screenSize",t.screenSize)}}(n||(n={}))},1049:function(e,t,i){"use strict";i.d(t,"a",(function(){return w})),i.d(t,"b",(function(){return m}));var r,n,a,s,o,c,h,u,l,d=i(33),f=i(35),b=i(541),v=i(246),p=i(354),j=i(201),_=i(298),y=i(248),g=i(296),O=i(1048);function m(e){var t=new v.a;return t.include(b.a,{linearDepth:!1}),t.include(O.a.builder,{}),t.include(j.a,e),t.fragment.include(p.a),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.fragment.uniforms.add("color","vec4"),t.attributes.add("position","vec3"),t.varyings.add("vWorldPosition","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add("offset","vec3"),e.shadingEnabled&&(t.vertex.uniforms.add("viewNormal","mat4"),t.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),t.attributes.add("normal","vec3"),t.varyings.add("vViewNormal","vec3")),t.vertex.code.add(Object(f.a)(r||(r=Object(d.a)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&t.vertex.code.add(Object(f.a)(n||(n=Object(d.a)(["\n      vec3 worldNormal = normal;\n      vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;\n    "])))),t.vertex.code.add(Object(f.a)(a||(a=Object(d.a)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),e.multipassTerrainEnabled&&(t.fragment.include(_.a),t.include(g.b,e)),t.fragment.code.add(Object(f.a)(s||(s=Object(d.a)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?t.fragment.code.add(Object(f.a)(o||(o=Object(d.a)(["\n      vec3 viewNormalNorm = normalize(vViewNormal);\n      float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\n      vec4 finalColor = mix(color, shadedColor, shadingFactor);\n    "])))):t.fragment.code.add(Object(f.a)(c||(c=Object(d.a)(["\n      vec4 finalColor = color;\n    "])))),t.fragment.code.add(Object(f.a)(h||(h=Object(d.a)(["\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),f.a.float(y.c),7===e.output?Object(f.a)(u||(u=Object(d.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(f.a)(l||(l=Object(d.a)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}var w=Object.freeze({__proto__:null,build:m})},1050:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i(15),n=i(2),a=i(3),s=(i(14),i(6)),o=i(26),c=i(13),h=i(110),u=i(55),l=i(227),d=i(960),f=1e-5,b=function(){function e(t){Object(n.a)(this,e),this.options=new d.a,this.results=new d.c,this.transform=new d.d,this.performanceInfo={queryDuration:0,numObjectsTested:0},this.tolerance=f,this.verticalOffset=null,this._ray={origin:Object(o.e)(),direction:Object(o.e)()},this._rayEndPoint=Object(o.e)(),this._rayStartPointTransformed=Object(o.e)(),this._rayEndPointTransformed=Object(o.e)(),this.viewingMode=null==t?1:t}return Object(a.a)(e,[{key:"ray",get:function(){return this._ray}},{key:"rayBeginPoint",get:function(){return this._ray.origin}},{key:"rayEndPoint",get:function(){return this._rayEndPoint}},{key:"reset",value:function(e,t){this.resetWithRay(u.f.fromPoints(e,t,this._ray))}},{key:"resetWithRay",value:function(e){e!==this._ray&&u.f.copy(e,this._ray),0!==this.options.verticalOffset?2===this.viewingMode?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,Object(c.e)(this._rayEndPoint,this._ray.origin,this._ray.direction),this._numObjectsTested=0,this.results.init(this._ray)}},{key:"intersect",value:function(e,t,i,n,a,o){var c=this;this.point=t,this.camera=i,this.filterPredicate=a,this.tolerance=null==n?f:n;var h=Object(d.f)(this.verticalOffset),u=o?function(e){o(e)&&c.intersectObject(e)}:function(e){c.intersectObject(e)};if(e&&e.length>0){var l,b=Object(r.a)(e);try{for(b.s();!(l=b.n()).done;){var v=l.value,p=v.getSpatialQueryAccelerator&&v.getSpatialQueryAccelerator();Object(s.k)(p)?(Object(s.k)(h)?p.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,u,h):p.forEachAlongRay(this._ray.origin,this._ray.direction,u),this.options.selectionMode&&this.options.hud&&p.forEachDegenerateObject(u)):v.getObjects().forAll((function(e){return u(e)}))}}catch(j){b.e(j)}finally{b.f()}}this.sortResults()}},{key:"intersectObject",value:function(e){var t=this;this._numObjectsTested++;var i=e.geometryRecords;if(i){var n,a,o=e.id,u=e.transformation,f=Object(d.f)(this.verticalOffset),b=Object(r.a)(i);try{var v=function(){var i=a.value,r=i.geometry,b=i.material,v=i.instanceParameters;if(Object(l.d)(v))return"continue";n=r.id,t.transform.setAndInvalidateLazyTransforms(u,i.getShaderTransformation()),Object(c.l)(t._rayStartPointTransformed,t._ray.origin,t.transform.inverse),Object(c.l)(t._rayEndPointTransformed,t._rayEndPoint,t.transform.inverse);var p=t.transform.transform;Object(s.k)(f)&&(f.objectTransform=t.transform),b.intersect(r,v,t.transform.transform,t,t._rayStartPointTransformed,t._rayEndPointTransformed,(function(i,r,a,c,u,l){if(i>=0){if(Object(s.k)(t.filterPredicate)&&!t.filterPredicate(t._ray.origin,t._rayEndPoint,i))return;var f="Object3D ".concat(o);if(u)return void((null==t.results.hud.dist||i<t.results.hud.dist)&&t.results.hud.set(e,f,i,r,h.a,c,l,n,a));var b=function(t){return t.set(e,f,i,r,p,c,null,n,a)};if((null==t.results.min.drapedLayerOrder||c>=t.results.min.drapedLayerOrder)&&(null==t.results.min.dist||i<t.results.min.dist)&&b(t.results.min),0!==t.options.store&&(null==t.results.max.drapedLayerOrder||c<t.results.max.drapedLayerOrder)&&(null==t.results.max.dist||i>t.results.max.dist)&&b(t.results.max),2===t.options.store){var v=new d.b(t._ray);b(v),t.results.all.push(v)}}}),i.shaderTransformation)};for(b.s();!(a=b.n()).done;)v()}catch(p){b.e(p)}finally{b.f()}}}},{key:"sortResults",value:function(){this.results.all.sort((function(e,t){return e.dist!==t.dist?e.dist-t.dist:e.drapedLayerOrder!==t.drapedLayerOrder?(void 0!==e.drapedLayerOrder?e.drapedLayerOrder:Number.MAX_VALUE)-(void 0!==t.drapedLayerOrder?t.drapedLayerOrder:Number.MAX_VALUE):(void 0!==t.drapedLayerGraphicOrder?t.drapedLayerGraphicOrder:Number.MIN_VALUE)-(void 0!==e.drapedLayerGraphicOrder?e.drapedLayerGraphicOrder:Number.MIN_VALUE)}))}}]),e}();b.DEFAULT_TOLERANCE=f},1121:function(e,t,i){"use strict";i.d(t,"a",(function(){return A}));var r=i(10),n=i(2),a=i(3),s=i(4),o=i(5),c=i(26),h=i(13),u=i(115),l=i(161),d=i(255),f=i(79),b=i(360),v=i(195),p=i(277),j=i(311),_=i(0),y=i(92),g=i(249),O=i(252),m=i(66),w=i(247),k=i(109),S=i(223),x=i(201),T=i(154),D=i(296),R=i(1048),P=i(1049),E=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(){return Object(n.a)(this,i),t.apply(this,arguments)}return Object(a.a)(i,[{key:"initializeProgram",value:function(e){var t=i.shader.get(),r=this.configuration,n=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:r.screenSizeEnabled,shadingEnabled:r.shadingEnabled,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new w.a(e.rctx,n.generateSource("vertex"),n.generateSource("fragment"),M)}},{key:"bindPass",value:function(e,t,i){var r=this.configuration,n=r.screenSizeEnabled,a=r.shadingEnabled,s=t.color,o=t.shadingTint,c=t.shadingDirection;S.a.bindProjectionMatrix(this.program,i.camera.projectionMatrix),this.program.setUniform4fv("color",s),i.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",i.camera.nearFar),this.program.setUniform2fv("inverseViewport",i.inverseViewport),Object(D.a)(this.program,e,i)),a&&(this.program.setUniform4fv("shadedColor",this.blendColor(z,o,s)),this.program.setUniform3fv("shadingDirection",c),this.program.setUniformMatrix4fv("viewNormal",i.camera.viewInverseTransposeMatrix)),n&&R.a.bindPassUniforms(this.program,t,i)}},{key:"blendColor",value:function(e,t,i){var r=1-t[3],n=t[3]+i[3]*r;return 0===n?(e[3]=n,e):(e[0]=(t[0]*t[3]+i[0]*i[3]*r)/n,e[1]=(t[1]*t[3]+i[1]*i[3]*r)/n,e[2]=(t[2]*t[3]+i[2]*i[3]*r)/n,e[3]=i[3],e)}},{key:"bindDraw",value:function(e){S.a.bindView(this.program,e),S.a.bindCamPosition(this.program,e.origin,e.camera.viewInverseTransposeMatrix),x.a.bindUniformsWithOrigin(this.program,this.configuration,e)}},{key:"setPipelineState",value:function(e){var t=this.configuration,i=3===e,r=2===e;return Object(k.d)({blending:0!==t.output&&7!==t.output||!t.transparent?null:i?T.f:Object(T.a)(e),culling:function(e){return 0!==e&&{face:1===e?1028:1029,mode:2305}}(t.cullFace),depthTest:{func:r?513:t.shadingEnabled?515:513},depthWrite:i?t.writeDepth&&k.c:Object(T.c)(e),colorWrite:k.b,polygonOffset:i||r?null:T.d})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),i}(O.a);E.shader=new g.a(P.a,(function(){return i.e(240).then(i.bind(null,1220))}));var L=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).output=0,e.cullFace=0,e.slicePlaneEnabled=!1,e.transparent=!1,e.writeDepth=!0,e.screenSizeEnabled=!0,e.shadingEnabled=!0,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!0,e}return i}(m.a);Object(_.a)([Object(m.b)({count:8})],L.prototype,"output",void 0),Object(_.a)([Object(m.b)({count:3})],L.prototype,"cullFace",void 0),Object(_.a)([Object(m.b)()],L.prototype,"slicePlaneEnabled",void 0),Object(_.a)([Object(m.b)()],L.prototype,"transparent",void 0),Object(_.a)([Object(m.b)()],L.prototype,"writeDepth",void 0),Object(_.a)([Object(m.b)()],L.prototype,"screenSizeEnabled",void 0),Object(_.a)([Object(m.b)()],L.prototype,"shadingEnabled",void 0),Object(_.a)([Object(m.b)({count:4})],L.prototype,"transparencyPassType",void 0),Object(_.a)([Object(m.b)()],L.prototype,"multipassTerrainEnabled",void 0),Object(_.a)([Object(m.b)()],L.prototype,"cullAboveGround",void 0);var M={position:0,normal:1,offset:2},z=Object(y.c)(),A=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e,I)).supportsEdges=!0,r.techniqueConfig=new L,r._vertexAttributeLocations=M,r}return Object(a.a)(i,[{key:"getTechniqueConfig",value:function(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.screenSizeEnabled=this.params.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.params.shadingEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}},{key:"getPassParameters",value:function(){return this.params}},{key:"intersect",value:function(e,t,i,r,n,a,s){var o=this;if(this.params.screenSizeEnabled){var c=e.vertexAttributes.get("offset"),u={applyToVertex:function(e,t,i,n){var a=Object(h.v)(C,c.data[3*n+0],c.data[3*n+1],c.data[3*n+2]),s=Object(h.v)(q,e,t,i);return Object(h.d)(a,a,o.params.screenSize*r.camera.computeRenderPixelSizeAt(a)),Object(h.e)(s,s,a),[s[0],s[1],s[2]]},applyToAabb:function(e){var t=Object(l.b)(e,C);return Object(l.p)(e,o.params.screenSize*r.camera.computeRenderPixelSizeAt(t))}};Object(v.e)(e,t,r,n,a,u,s)}else Object(v.e)(e,t,r,n,a,void 0,s)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output||4===e.output?new F(e):void 0}},{key:"createBufferWriter",value:function(){return new V(this.params.screenSizeEnabled)}}]),i}(p.a),F=function(e){Object(s.a)(i,e);var t=Object(o.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e)).updateParameters(),r}return Object(a.a)(i,[{key:"updateParameters",value:function(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(E,this.material.getTechniqueConfig(this.output,e),this.technique)}},{key:"beginSlot",value:function(e){if(4===this.output)return 3===e;var t=3;return this.technique.configuration.transparent&&(t=this.technique.configuration.writeDepth?5:8),e===t}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}}]),i}(b.a),I=Object(r.a)({color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:Object(h.q)(Object(c.e)(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0},p.b),V=function(){function e(t){Object(n.a)(this,e),this.screenSizeEnabled=t;var i=Object(d.a)().vec3f("position").vec3f("normal");this.screenSizeEnabled&&i.vec3f("offset"),this.vertexBufferLayout=i}return Object(a.a)(e,[{key:"allocate",value:function(e){return this.vertexBufferLayout.createBuffer(e)}},{key:"elementCount",value:function(e){return e.indices.get("position").length}},{key:"write",value:function(e,t,i,r){if(Object(j.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,i,r),this.screenSizeEnabled){if(!t.vertexAttributes.has("offset"))throw new Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");var n=t.vertexAttributes.get("offset"),a=t.indices.get("offset");Object(f.a)(3===n.size);var s=i.getField("offset",u.u);if(!s)throw new Error("unable to acquire view for offset");Object(j.e)(a,n.data,e.invTranspTransformation,s,r)}}}]),e}(),C=Object(c.e)(),q=Object(c.e)()},916:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var r=i(15),n=i(2),a=i(3),s=i(183),o=i(6),c=i(86),h=i(43),u=(i(78),i(70)),l=i(46),d=i(37),f=i(26),b=i(13),v=i(220),p=i(82),j=i(105),_=i(130),y=i(278),g=i(110),O=i(145),m=i(34),w=i(391),k=i(53),S=i(55),x=i(444),T=i(1044),D=i(405),R=i(451),P=function(){function e(t){for(var i in Object(n.a)(this,e),this.idHint=0,this.camera=new T.a,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=Object(g.b)(),this._worldFrame=null,this._renderLocation=Object(f.e)(),this._renderLocationDirty=!0,this._location=new h.a({x:0,y:0,z:0}),this._elevationAlignedLocation=new h.a,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new u.a.EventEmitter,this._screenLocation={screenPointArray:Object(d.g)(),renderScreenPointArray:Object(d.e)(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=t.view.spatialReference,t)this[i]=t[i];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}return Object(a.a)(e,[{key:"destroy",value:function(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}},{key:"renderObjects",get:function(){return this._renderObjects},set:function(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}},{key:"available",get:function(){return this._available},set:function(e){e!==this._available&&(this._available=e,this._updateEngineObject())}},{key:"disableDisplay",value:function(){var e=this;return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:Object(c.d)((function(){e._noDisplayCount--,0===e._noDisplayCount&&e._updateEngineObject()}))}}},{key:"radius",get:function(){return this._radius},set:function(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}},{key:"worldSized",get:function(){return this._worldSized},set:function(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}},{key:"modelTransform",get:function(){return this._modelTransform},set:function(e){E(e)&&(this._screenLocationDirty=!0),Object(p.c)(this._modelTransform,e),this._updateEngineObject()}},{key:"renderLocation",get:function(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=Object(g.b)()),function(e,t,i){switch(e.viewingMode){case"local":return Object(p.i)(i),!0;case"global":var r=Object(v.e)(e.renderCoordsHelper.spatialReference);Object(_.t)(t,0,C,0,r.radius),Object(_.c)(Object(l.f)(C[1]),Object(l.f)(C[0]),i)}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation},set:function(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}},{key:"location",get:function(){return this._location},set:function(e){Object(D.a)(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"elevationAlignedLocation",get:function(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation},set:function(e){Object(D.a)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}},{key:"_updateElevationAlignedLocation",value:function(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;var e=Object(o.k)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}},{key:"grabbableForEvent",value:function(){return!0}},{key:"grabbing",get:function(){return this._grabbing},set:function(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"hovering",get:function(){return this._hovering},set:function(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}},{key:"selected",get:function(){return this._selected},set:function(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,this._updateEngineObject())}},{key:"updateStateEnabled",value:function(e,t){t?this.state|=e:this.state&=~e}},{key:"_setFocused",value:function(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}},{key:"focused",get:function(){return this._focused}},{key:"screenLocation",get:function(){return this.ensureScreenLocation(),this._screenLocation}},{key:"ensureScreenLocation",value:function(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,E(this._modelTransform)){var t=this._calculateModelTransformOffset(W);e=Object(b.e)(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}},{key:"applyObjectTransform",get:function(){return this._applyObjectTransform},set:function(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"intersectionDistance",value:function(e,t){if(!this.available)return null;var i=Object(d.j)(e,L),n=this._getCollisionRadius(t),a=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(Object(m.j)(this.screenLocation.screenPointArray,i)<n*n)return this.screenLocation.renderScreenPointArray[2]+a;break;case"line":var c=this.collisionType.paths,h=this._getWorldToScreenObjectScale(),u=this._calculateObjectTransform(h,I),l=n*this.screenLocation.pixelSize,v=S.f.fromScreen(this.camera,i,z);if(Object(o.j)(v))return null;var p,j=Object(r.a)(c);try{for(j.s();!(p=j.n()).done;){var _=p.value;if(0!==_.length)for(var y=Object(b.l)(C,_[0],u),g=1;g<_.length;g++){var w=Object(b.l)(q,_[g],u),x=S.d.closestRayDistance2(S.d.fromPoints(y,w,M),v);if(null!=x&&x<l*l){var T=Object(b.e)(k.d.get(),y,w);Object(b.d)(T,T,.5);var D=Object(d.a)(k.d.get());return this.camera.projectToRenderScreen(T,D),D[2]+a}Object(b.j)(y,w)}}}catch(je){j.e(je)}finally{j.f()}break;case"disc":var R,P=this.collisionType.direction,E=null!=(R=this.collisionType.offset)?R:f.b,F=this._getWorldToScreenObjectScale(),W=this._calculateObjectTransform(F,I),H=n*this.screenLocation.pixelSize,B=S.f.fromScreen(this.camera,i,z);if(Object(o.j)(B))return null;var X=Object(O.d)(A,W),Y=Object(b.w)(G,P,X),J=Object(b.l)(N,E,W);S.e.fromPositionAndNormal(J,Y,V);var Q=U;if(S.e.intersectRay(V,B,Q)&&Object(b.k)(Q,J)<H*H)return this.screenLocation.renderScreenPointArray[2]+a;break;case"ribbon":var K=this.collisionType,Z=K.paths,$=K.direction,ee=this._getWorldToScreenObjectScale(),te=this._calculateObjectTransform(ee,I),ie=n*this.camera.computeScreenPixelSizeAt(this.renderLocation),re=S.f.fromScreen(this.camera,i,z);if(Object(o.j)(re))return null;var ne=Object(O.d)(A,te),ae=Object(b.w)(G,$,ne),se=this._calculateModelTransformPosition(N);S.e.fromPositionAndNormal(se,ae,V);var oe=U;if(!S.e.intersectRay(V,re,oe))break;var ce,he=Object(r.a)(Z);try{for(he.s();!(ce=he.n()).done;){var ue=ce.value;if(0!==ue.length)for(var le=Object(b.l)(C,ue[0],te),de=1;de<ue.length;de++){var fe=Object(b.l)(q,ue[de],te),be=S.d.distance2(S.d.fromPoints(le,fe,M),oe);if(null!=be&&be<ie*ie){var ve=Object(b.e)(k.d.get(),le,fe);Object(b.d)(ve,ve,.5);var pe=Object(d.a)(k.d.get());return this.camera.projectToRenderScreen(ve,pe),pe[2]+a}Object(b.j)(le,fe)}}}catch(je){he.e(je)}finally{he.f()}break;default:Object(s.a)(this.collisionType)}return null}},{key:"attach",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}};if(this.view._stage){var i=t.manipulator3D;if(Object(o.j)(i.engineLayerId)){var r=new R.a({isPickable:!1});this.view._stage.add(r),i.engineLayerId=r.id,this._engineLayer=r}else null!=(e=this.view._stage)&&e.getObject&&(this._engineLayer=this.view._stage.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,Object(o.j)(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),Object(_.b)(this._location.spatialReference,this.view.spatialReference)||(this.location=new h.a({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}}},{key:"detach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}},t=e.manipulator3D;t.engineLayerReferences--;var i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}},{key:"onViewChange",value:function(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}},{key:"onElevationChange",value:function(e){Object(_.n)(this.location,H,e.spatialReference),Object(j.f)(e.extent,H)&&(this.location=this._location)}},{key:"_evaluateElevationAlignment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.location;if(Object(o.j)(this.elevationInfo))return!1;var t=null,i=0,r=Object(o.r)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=Object(o.r)(Object(w.a)(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=Object(o.r)(Object(w.a)(this.view.elevationProvider,e,"ground"),0)+r;break;case"relative-to-scene":i=Object(o.r)(Object(w.a)(this.view.elevationProvider,e,"scene"),0)+r;break;case"absolute-height":i=r}return(i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}},{key:"_updateEngineObject",value:function(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=I;if(!0===this.autoScaleRenderObjects){var i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);var n,a=this._ensureEngineResources().objectsByState,s=(this.focused?2:1)|(this.selected?8:4),c=this._noDisplayCount>0,h=Object(r.a)(a);try{for(h.s();!(n=h.n()).done;){var u=n.value,l=u.stateMask,d=u.objects;if(c){var f,b=Object(r.a)(d);try{for(b.s();!(f=b.n()).done;){f.value.setVisible(!1)}}catch(m){b.e(m)}finally{b.f()}}else{var v=!(0!=(15&l))||(s&l)==(15&l),p=!(0!=(65520&l))||(this.state&l)==(65520&l);if(v&&p){var j,_=Object(r.a)(d);try{for(_.s();!(j=_.n()).done;){var y=j.value;y.setVisible(!0),y.transformation=t}}catch(m){_.e(m)}finally{_.f()}}else{var g,O=Object(r.a)(d);try{for(O.s();!(g=O.n()).done;){g.value.setVisible(!1)}}catch(m){O.e(m)}finally{O.f()}}}}}catch(m){h.e(m)}finally{h.f()}Object(o.k)(this._engineLayer)&&this._engineLayer.commit()}else this._removeResourcesFromStage()}},{key:"_ensureEngineResources",value:function(){if(Object(o.j)(this._engineResources)){var e=Object(o.q)(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((function(e){var r=e.material;i.has(r)||(t.push(r),i.add(r))}));var r=new Map;this._renderObjects.forEach((function(e){var t=new x.a({castShadow:!1});!function(e,t){var i=t.geometry,r=t.material,n=t.transform;Array.isArray(i)?i.forEach((function(t){return e.addGeometry(t,r,n)})):e.addGeometry(i,r,n)}(t,e);var i=e.stateMask||0,n=r.get(i)||[];n.push(t),r.set(i,n)}));var n=[];r.forEach((function(e,t){return n.push({stateMask:t,objects:e})})),this._engineResources={objectsByState:n,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}},{key:"_addResourcesToStage",value:function(){var e=this;if(!this._engineResourcesAddedToStage&&!Object(o.j)(this._engineResources)){var t=this._engineResources,i=t.objectsByState,r=t.layer;t.materials.forEach((function(t){var i=Object(o.q)(e._materialIdReferences),r=i.get(t.id)||0;0===r&&e.view._stage.add(t),i.set(t.id,r+1)})),i.forEach((function(t){return t.objects.forEach((function(t){r.add(t),e.view._stage.add(t)}))})),this._engineResourcesAddedToStage=!0}}},{key:"_removeResourcesFromStage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._engineResourcesAddedToStage&&!Object(o.j)(this._engineResources)){var i=this._engineResources,r=i.objectsByState,n=i.layer,a=i.materials;r.forEach((function(t){var i=t.objects;n.removeMany(i),e.view._stage.removeMany(i)})),a.forEach((function(t){var i=Object(o.q)(e._materialIdReferences),r=i.get(t.id);1===r?(e.view._stage.remove(t),i.delete(t.id)):i.set(t.id,r-1)})),t&&this.view._stage.remove(n),this._engineResourcesAddedToStage=!1}}},{key:"_getCollisionRadius",value:function(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}},{key:"_getFocusedSize",value:function(e,t){return e*(t?this.focusMultiplier:1)}},{key:"_getWorldToScreenObjectScale",value:function(){return this._worldSized?1:this.screenLocation.pixelSize}},{key:"_calculateModelTransformPosition",value:function(e){var t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,F);return Object(b.v)(e,i[12],i[13],i[14])}},{key:"_calculateModelTransformOffset",value:function(e){var t=this._calculateModelTransformPosition(e);return Object(b.i)(e,t,this.renderLocation)}},{key:"_calculateObjectTransform",value:function(e,t){return Object(p.d)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&Object(p.l)(t,t,this._worldFrame),Object(p.l)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,Object(o.k)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}},{key:"test",get:function(){var e=!1;if(Object(o.k)(this._engineResources))for(var t in this._engineResources.objectsByState){var i,n=this._engineResources.objectsByState[t],a=Object(r.a)(n.objects);try{for(a.s();!(i=a.n()).done;){if(i.value.isVisible){e=!0;break}}}catch(s){a.e(s)}finally{a.f()}if(e)break}return{areAnyResourcesVisible:e}}}]),e}();function E(e){return 0!==e[12]||0!==e[13]||0!==e[14]}var L=Object(d.g)(),M=S.d.create(),z=S.f.create(),A=Object(y.a)(),F=Object(g.b)(),I=Object(g.b)(),V=S.e.create(),C=Object(f.e)(),q=Object(f.e)(),U=Object(f.e)(),G=Object(f.e)(),N=Object(f.e)(),W=Object(f.e)(),H=new h.a({x:0,y:0,z:0,spatialReference:null})},917:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return w})),i.d(t,"c",(function(){return _})),i.d(t,"d",(function(){return g})),i.d(t,"e",(function(){return y})),i.d(t,"f",(function(){return p})),i.d(t,"g",(function(){return O}));var r=i(10),n=i(6),a=i(46),s=i(37),o=i(26),c=i(13),h=i(130),u=i(149),l=i(53),d=i(55),f=i(960),b=i(1050),v=i(331);function p(e,t){var i=Object(o.e)(),a=Object(o.e)(),c=!1;return function(o){if("start"===o.action){var h=Object(s.j)(o.screenStart,Object(s.c)(l.c.get())),u=d.f.fromScreen(e.state.camera,h,x);Object(n.k)(u)&&(c=d.e.intersectRay(t,u,i))}if(!c)return null;var f=Object(s.j)(o.screenEnd,Object(s.c)(l.c.get())),b=d.f.fromScreen(e.state.camera,f,x);return Object(n.j)(b)?null:d.e.intersectRay(t,b,a)?Object(r.a)(Object(r.a)({},o),{},{renderStart:i,renderEnd:a,plane:t,ray:b}):null}}function j(e,t,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=null;return function(u){if("start"===u.action&&(c=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(s.g)(u.screenStart.x,u.screenStart.y),t,i,o),Object(n.k)(c)&&Object(n.k)(a)&&!Object(h.n)(c,c,a)))return null;if(Object(n.j)(c))return null;var l=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(s.g)(u.screenEnd.x,u.screenEnd.y),t,i,o);return Object(n.k)(l)?Object(n.k)(a)&&!Object(h.n)(l,l,a)?null:Object(r.a)(Object(r.a)({},u),{},{mapStart:c,mapEnd:l}):null}}function _(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return j(e,i,Object(u.f)(t,e,i),r,n)}function y(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return _(e,i,Object(u.d)(t),r,n)}function g(e,t,i,r){var a=t.toMap(e.screenStart,{include:[i]});return Object(n.k)(a)?y(t,i,a,r):null}function O(e,t,i){var s=null,h=new v.a;return h.next(p(e,function(e,t){var i=k,r=S,n=d.e.create();e.renderCoordsHelper.worldUpAtPosition(t,i);var a=Object(c.f)(n,i,Object(c.i)(r,t,e.state.camera.eye));return Object(c.f)(a,a,i),d.e.fromPositionAndNormal(t,a,n)}(e,t))).next(function(e,t){var i=Object(o.e)(),r=Object(c.o)(t);e.renderCoordsHelper.worldUpAtPosition(t,i);var n=Object(o.e)(),s=Object(o.e)(),h=function(n){return Object(c.i)(n,n,t),d.h.projectPoint(i,n,n),"global"===e.viewingMode&&Object(c.o)(n)*Object(a.r)(Object(c.g)(i,n))<.001-r&&Object(c.i)(n,Object(c.d)(n,i,.001),t),Object(c.e)(n,n,t),n};return function(e){return e.renderStart=h(Object(c.j)(n,e.renderStart)),e.renderEnd=h(Object(c.j)(s,e.renderEnd)),e}}(e,t)).next(function(e,t){var i=e.renderCoordsHelper;return function(e){var a=i.fromRenderCoords(e.renderStart,t),s=i.fromRenderCoords(e.renderEnd,t);return Object(n.k)(a)&&Object(n.k)(s)?Object(r.a)(Object(r.a)({},e),{},{mapStart:a,mapEnd:s}):null}}(e,i)).next((function(e){e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,s=e})),function(e){return s=null,h.execute(e),s}}function m(e){var t=null;return function(i){switch(i.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":Object(n.k)(t)&&(t.remove(),t=null)}return i}}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=new b.a(e.state.mode);i.options.selectionMode=!0,i.options.store=0;var a,c=Object(s.g)(),h={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},u=Object(o.e)(),l=Object(n.r)(t,e.spatialReference),d=function(t){e.map.ground&&e.map.ground.opacity<1?h.exclude.add(f.e):h.exclude.delete(f.e),e.sceneIntersectionHelper.intersectIntersectorScreen(Object(s.j)(t,c),i,h);var r,n=i.results.min;if(n.getIntersectionPoint(u))r="TerrainRenderer"===n.intersector?0:1;else{if(!i.results.ground.getIntersectionPoint(u))return null;r=0}return{location:e.renderCoordsHelper.fromRenderCoords(u,l),surfaceType:r}};return function(e){if("start"===e.action){var t=d(e.screenStart);a=Object(n.k)(t)?t.location:null}if(Object(n.j)(a))return null;var i=d(e.screenEnd);return Object(n.k)(i)&&Object(n.k)(i.location)?Object(r.a)(Object(r.a)({},e),{},{mapStart:a,mapEnd:i.location,surfaceType:i.surfaceType}):null}}var k=Object(o.e)(),S=Object(o.e)(),x=d.f.create()},923:function(e,t,i){"use strict";i.d(t,"a",(function(){return j})),i.d(t,"b",(function(){return _})),i.d(t,"c",(function(){return b})),i.d(t,"d",(function(){return v})),i.d(t,"e",(function(){return p})),i.d(t,"f",(function(){return y})),i.d(t,"g",(function(){return g}));var r=i(6),n=i(13),a=i(82),s=i(92),o=i(53),c=i(274),h=i(405),u=i(592),l=i(553),d=i(916),f=i(1121);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=Object(s.d)(e[0],e[1],e[2],e.length>3?e[3]:1),r=e[3]<1;return new f.a({color:i,transparent:r,writeDepth:!0,cullFace:2,renderOccluded:t})}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=Object(s.d)(e[0],e[1],e[2],4===e.length?e[3]:1);return new l.a({color:i,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function p(e,t,i){return new d.a({view:e,renderObjects:[{geometry:c.a.createSphereGeometry(1,32,32),material:b(Object(s.d)(t[0],t[1],t[2],null!=i?i:1))}]})}function j(e,t,i,r){var s=Object(n.i)(o.d.get(),e,i),c=_(s,Object(n.f)(o.d.get(),r,s),i,o.a.get());Object(a.a)(c,c);var h=Object(n.l)(o.d.get(),t,c);return Math.atan2(h[1],h[0])}function _(e,t,i,r){var a=Object(n.q)(o.d.get(),e),s=Object(n.q)(o.d.get(),t),c=Object(n.f)(o.d.get(),a,s);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=0,r[4]=s[0],r[5]=s[1],r[6]=s[2],r[7]=0,r[8]=c[0],r[9]=c[1],r[10]=c[2],r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function y(e,t){var i=e.getViewForGraphic(t);return Object(r.k)(i)&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(t,e.spatialReference):null}function g(e,t,i){var n=y(e,i);Object(r.k)(n)?t.elevationAlignedLocation=n:function(e,t){if(Object(r.j)(t))return;var i=Object(u.a)(t);Object(r.j)(i)||(e.location=Object(h.b)(i))}(t,i.geometry)}},960:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return k})),i.d(t,"c",(function(){return w})),i.d(t,"d",(function(){return O})),i.d(t,"e",(function(){return E})),i.d(t,"f",(function(){return P}));var r=i(3),n=i(2),a=i(6),s=i(26),o=i(13),c=i(82),h=i(278),u=i(110),l=i(307),d=i(92),f=i(145),b=i(83),v=i(514),p=i(76),j=i(310),_=(i(585),i(55)),y=i(444);var g=function e(){Object(n.a)(this,e),this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2},O=function(){function e(){Object(n.a)(this,e),this._transform=Object(u.b)(),this._transformInverse=new m({value:this._transform},c.a,u.b),this._transformInverseTranspose=new m(this._transformInverse,c.b,u.b),this._transformTranspose=new m({value:this._transform},c.b,u.b),this._transformInverseRotation=new m({value:this._transform},f.b,h.a)}return Object(r.a)(e,[{key:"invalidateLazyTransforms",value:function(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}},{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}},{key:"setTransformMatrix",value:function(e){Object(c.c)(this._transform,e)}},{key:"multiplyTransform",value:function(e){Object(c.l)(this._transform,this._transform,e)}},{key:"set",value:function(e){Object(c.c)(this._transform,e),this.invalidateLazyTransforms()}},{key:"setAndInvalidateLazyTransforms",value:function(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()}}]),e}(),m=function(){function e(t,i,r){Object(n.a)(this,e),this.original=t,this.update=i,this.dirty=!0,this.transform=r()}return Object(r.a)(e,[{key:"invalidate",value:function(){this.dirty=!0}},{key:"value",get:function(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}]),e}(),w=function(){function e(){Object(n.a)(this,e),this.min=new k,this.max=new k,this.hud=new k,this.ground=new k}return Object(r.a)(e,[{key:"init",value:function(e){this.min.init(e),this.max.init(e),this.hud.init(e),this.ground.init(e),this.all=[]}}]),e}(),k=function(){function e(t){Object(n.a)(this,e),this.normal=Object(s.e)(),this.transformation=Object(u.b)(),this._ray=_.f.create(),this.init(t)}return Object(r.a)(e,[{key:"ray",get:function(){return this._ray}},{key:"hasIntersectionPoint",get:function(){return null!=this.dist}},{key:"distanceInRenderSpace",get:function(){if(null!=this.dist)return Object(o.d)(L,this.ray.direction,this.dist),Object(o.o)(L)}},{key:"getIntersectionPoint",value:function(e){return!!this.hasIntersectionPoint&&(Object(o.d)(L,this.ray.direction,this.dist),Object(o.e)(e,this.ray.origin,L),!0)}},{key:"getTransformedNormal",value:function(e){return Object(o.j)(M,this.normal),M[3]=0,Object(b.m)(M,M,this.transformation),Object(o.j)(e,M),Object(o.q)(e,e),e}},{key:"init",value:function(e){this.dist=void 0,this.target=void 0,this.name=void 0,this.drapedLayerOrder=void 0,this.drapedLayerGraphicOrder=void 0,this.center=null,this.geometryId=null,this.triangleNr=null,this.intersector="Stage",e?_.f.copy(e,this._ray):this._ray=_.f.create()}},{key:"set",value:function(e,t,i,r,n,a,h,u,l,d){e instanceof y.a&&(e={type:"stage",obj:e}),this.dist=i,Object(o.j)(this.normal,r),Object(c.c)(this.transformation,n),this.target=e,this.name=t,this.drapedLayerOrder=a,this.center=h?Object(s.d)(h):null,this.geometryId=u,this.triangleNr=l,this.drapedLayerGraphicOrder=d}},{key:"copyFrom",value:function(e){_.f.copy(e._ray,this._ray),this.dist=e.dist,this.target=e.target,this.name=e.name,this.drapedLayerOrder=e.drapedLayerOrder,this.center=e.center?Object(s.d)(e.center):null,this.geometryId=e.geometryId,this.triangleNr=e.triangleNr,this.intersector=e.intersector,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Object(o.j)(this.normal,e.normal),Object(c.c)(this.transformation,e.transformation)}},{key:"toOwner",value:function(e){if(!this.target)return null;switch(this.target.type){case"stage":return S(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e,t){var i=e.metadata.layerUid;return null!=i?t.map.findLayerByUid(i):null}(this.target,e);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return S(this.target.metadata,e);case"TerrainRenderer":return e.map&&e.map.ground}}return null}},{key:"toGraphic",value:function(e){if(!this.target)return null;switch(this.target.type){case"stage":return x(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e){return e.metadata.createGraphic()}(this.target);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return x(this.target.metadata,e)}}return null}}]),e}();function S(e,t){return Object(a.j)(e)||null==e.layerUid?null:Object(a.k)(t.graphicsView)&&e.layerUid===t.graphicsView.graphics3d.layer.id?t.graphics:t.map.findLayerByUid(e.layerUid)}function x(e,t){if(Object(a.j)(e))return null;var i=S(e,t);if(Object(a.j)(i))return null;if(i===t.graphics)return Object(a.k)(t.graphicsView)?Object(a.q)(t.graphicsView.getGraphicFromGraphicUid(e.graphicUid)):null;var r,n,s=t.allLayerViews.find((function(e){return e.layer===i}));return s?(n=e,!(r=s)||r.suspended?null:"getGraphicFromIntersectorMetadata"in r&&n?r.getGraphicFromIntersectorMetadata(n):"getGraphicFromGraphicUid"in r&&null!=n.graphicUid?r.getGraphicFromGraphicUid(n.graphicUid):null):null}var T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(n.a)(this,e),this.offset=t,this.tmpVertex=Object(s.e)()}return Object(r.a)(e,[{key:"applyToVertex",value:function(e,t,i){var r=e+this.localOrigin[0],n=t+this.localOrigin[1],a=i+this.localOrigin[2],s=this.offset/Math.sqrt(r*r+n*n+a*a);return this.tmpVertex[0]=e+r*s,this.tmpVertex[1]=t+n*s,this.tmpVertex[2]=i+a*s,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0]+this.localOrigin[0],i=e[1]+this.localOrigin[1],r=e[2]+this.localOrigin[2],n=e[3]+this.localOrigin[0],a=e[4]+this.localOrigin[1],s=e[5]+this.localOrigin[2],o=this.offset/Math.sqrt(t*t+i*i+r*r);e[0]+=t*o,e[1]+=i*o,e[2]+=r*o;var c=this.offset/Math.sqrt(n*n+a*a+s*s);return e[3]+=n*c,e[4]+=a*c,e[5]+=s*c,e}}]),e}(),D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(n.a)(this,e),this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(s.e)(),this.mbs=Object(d.c)(),this.obb={center:Object(s.e)(),halfSize:Object(p.b)(),quaternion:null}}return Object(r.a)(e,[{key:"localOrigin",set:function(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"applyToVertex",value:function(e,t,i){var r=e,n=t,a=i+this.componentLocalOriginLength,s=this.offset/Math.sqrt(r*r+n*n+a*a);return this.tmpVertex[0]=e+r*s,this.tmpVertex[1]=t+n*s,this.tmpVertex[2]=i+a*s,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0],i=e[1],r=e[2]+this.componentLocalOriginLength,n=e[3],a=e[4],s=e[5]+this.componentLocalOriginLength,o=this.offset/Math.sqrt(t*t+i*i+r*r);e[0]+=t*o,e[1]+=i*o,e[2]+=r*o;var c=this.offset/Math.sqrt(n*n+a*a+s*s);return e[3]+=n*c,e[4]+=a*c,e[5]+=s*c,e}},{key:"applyToMbs",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.mbs[0]=e[0]+e[0]*i,this.mbs[1]=e[1]+e[1]*i,this.mbs[2]=e[2]+e[2]*i,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}},{key:"applyToObb",value:function(e){var t=e.center,i=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*i,this.obb.center[1]=t[1]+t[1]*i,this.obb.center[2]=t[2]+t[2]*i,Object(o.t)(this.obb.halfSize,e.halfSize,e.quaternion),Object(o.e)(this.obb.halfSize,this.obb.halfSize,e.center);var r=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*r,this.obb.halfSize[1]+=this.obb.halfSize[1]*r,this.obb.halfSize[2]+=this.obb.halfSize[2]*r,Object(o.i)(this.obb.halfSize,this.obb.halfSize,e.center),Object(v.a)(z,e.quaternion),Object(o.t)(this.obb.halfSize,this.obb.halfSize,z),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}}]),e}(),R=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(n.a)(this,e),this.offset=t,this.sphere=Object(j.b)(),this.tmpVertex=Object(s.e)()}return Object(r.a)(e,[{key:"applyToVertex",value:function(e,t,i){var r=this.objectTransform.transform,n=r[0]*e+r[4]*t+r[8]*i+r[12],a=r[1]*e+r[5]*t+r[9]*i+r[13],s=r[2]*e+r[6]*t+r[10]*i+r[14],o=this.offset/Math.sqrt(n*n+a*a+s*s);n+=n*o,a+=a*o,s+=s*o;var c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*n+c[4]*a+c[8]*s+c[12],this.tmpVertex[1]=c[1]*n+c[5]*a+c[9]*s+c[13],this.tmpVertex[2]=c[2]*n+c[6]*a+c[10]*s+c[14],this.tmpVertex}},{key:"applyToMinMax",value:function(e,t){var i=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*i,e[1]+=e[1]*i,e[2]+=e[2]*i;var r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r}},{key:"applyToAabb",value:function(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var i=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*i,e[4]+=e[4]*i,e[5]+=e[5]*i,e}},{key:"applyToBoundingSphere",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),i=this.offset/t;return this.sphere[0]=e[0]+e[0]*i,this.sphere[1]=e[1]+e[1]*i,this.sphere[2]=e[2]+e[2]*i,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}}]),e}());function P(e){return Object(a.k)(e)?(R.offset=e,R):null}new D;new T;var E="terrain",L=(Object(s.e)(),Object(s.e)()),M=Object(d.c)(),z=Object(l.a)()}}]);
//# sourceMappingURL=7.39bb1084.chunk.js.map