{"version":3,"sources":["../node_modules/@arcgis/core/identity/IdentityForm.js","../../index.js","../../src/index.js","../node_modules/@arcgis/core/identity/IdentityModal.js","../node_modules/@arcgis/core/identity/OAuthCredential.js","../node_modules/@arcgis/core/identity/OAuthInfo.js","../node_modules/@arcgis/core/identity/ServerInfo.js","../node_modules/@arcgis/core/identity/IdentityManagerBase.js","../node_modules/@arcgis/core/identity/IdentityManager.js"],"names":["l","a","s","e","_usernameInputNode","_passwordInputNode","messages","signingIn","server","resource","error","oAuthPrompt","this","t","i","u","d","n","class","r","oAuthInfo","info","test","lblItem","c","lblUser","value","required","autocomplete","spellcheck","type","bind","afterCreate","o","m","lblPwd","h","classes","disabled","lblSigning","lblOk","lblCancel","onclick","_cancel","b","details","httpStatus","invalidUser","noAuthService","onsubmit","_submit","_set","emit","preventDefault","username","password","prototype","candidateSelectors","candidateSelector","matches","Element","getCandidates","candidates","Array","el","includeContainer","getTabindex","tabindexAttr","parseInt","node","isNaN","isContentEditable","sortOrderedTabbables","isInput","isNonTabbableRadio","isRadio","radioScope","queryRadios","name","window","radioSet","err","console","checked","nodes","getCheckedRadio","isTabbableRadio","isNodeMatchingSelectorFocusable","isHiddenInput","getComputedStyle","nodeUnderDetails","isHidden","child","isDetailsWithSummary","isNodeMatchingSelectorTabbable","focusableCandidateSelector","isFocusable","Error","activeFocusTraps","trapQueue","activateTrap","activeTrap","trapIndex","deactivateTrap","delay","setTimeout","fn","findIndex","idx","arr","valueOrHandler","params","createFocusTrap","doc","config","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","state","containers","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","active","paused","containersContain","container","getNodeForOption","optionValue","getInitialFocusNode","firstTabbableGroup","updateTabbableNodes","tabbableNodes","regularTabbables","orderedTabbables","options","candidate","candidateTabindex","documentOrder","tabIndex","tabbable","firstTabbableNode","lastTabbableNode","tryFocus","preventScroll","isSelectableInput","checkPointerDown","trap","returnFocus","checkFocusIn","targetContained","checkKey","isEscapeEvent","isTabEvent","destinationNode","startOfGroupIndex","destinationGroupIndex","lastOfGroupIndex","checkTab","checkClick","addListeners","activeFocusDelay","capture","passive","removeListeners","activate","onActivate","activateOptions","deactivate","clearTimeout","onDeactivate","deactivateOptions","pause","unpause","updateContainerElements","elementsAsArray","concat","containerElements","filter","element","document","createElement","content","open","_close","body","appendChild","own","watch","_toggleFocusTrap","_destroyFocusTrap","id","title","close","p","role","_createFocusTrap","_renderContent","_focusTrap","requestAnimationFrame","initialFocus","cancelAnimationFrame","innerHTML","render","HTMLElement","_attachToNode","readOnly","aliasOf","storage","appId","expires","ssl","token","userId","_init","Date","now","minTimeUntilExpiration","_load","authNamespace","portalUrl","setItem","JSON","stringify","log","replace","FormData","append","navigator","sendBeacon","XMLHttpRequest","send","_oAuthCred","getItem","parse","declaredClass","expiration","forceLogin","forceUserId","locale","popup","popupCallbackUrl","popupWindowFeatures","preserveUrlHash","fromJSON","toJSON","json","write","adminTokenServiceUrl","currentVersion","hasPortal","hasServer","owningSystemUrl","owningTenant","shortLivedTokenValidity","tokenServiceUrl","webTierAuth","R","host","P","some","C","D","localStorage","sessionStorage","j","_portalConfig","esriGeowConfig","serverInfos","oAuthInfos","credentials","_soReqs","_xoReqs","_portals","defaultOAuthInfo","defaultTokenValidity","dialog","formConstructor","y","tokenValidity","normalizeWebTierAuth","_appUrlObj","location","href","_busy","_rejectOnPersistedPageShow","_oAuthHash","_gwTokenUrl","_agsRest","_agsPortal","_agsAdmin","_adminSvcs","_gwDomains","regex","customBaseUrl","_legacyFed","_regexSDirUrl","_regexServerType","_gwUser","_gwItem","_gwGroup","_rePortalTokenSvc","_createDefaultOAuthInfo","_hasTestedIfAppIsOnPortal","_getOAuthHash","addEventListener","_pageShowHandler","findServerInfo","forEach","push","findOAuthInfo","splice","indexOf","_sanitizeUrl","_isServerRsrc","O","_getServerInstanceRoot","_getTokenSvcUrl","registerServers","_findCredential","Object","assign","q","scope","resources","emitTokenChange","refreshServerTokens","map","length","T","registerOAuthInfos","_hasSameServerInstance","_getIdenticalSvcIdx","prompt","v","signal","S","abort","reject","w","promise","_isAdminResource","findCredential","destroy","resolve","_restInfoPms","_selfReq","origin","selfDfd","_getPortalSelf","_enqueue","_isRESTService","_","f","g","toLowerCase","isAdmin","serverUrl","customParameters","scheme","uri","port","query","request","referer","client","method","authMode","useProxy","_useProxy","ioArgs","withCredentials","A","then","data","validity","checkAppAccess","credential","getCredential","_doPortalSignIn","force","client_id","valid","viewOnlyUserTypeApp","catch","viewOnly","_oAuthDfd","clearInterval","_oAuthIntervalId","_oAuthOnHashHandle","remove","charAt","substring","error_description","sinfo_","oinfo_","access_token","Number","expires_in","persist","save","_oAuthRedirectFunc","_protocolFunc","getResourceName","U","on","generateToken","oAuthWin_","closed","resUrl_","oAuthPopupConfirmation","_doOAuthSignIn","slice","_postMessageAuthHandle","endsWith","source","postMessage","message","hash","hasOwnProperty","persisted","isBusy","_errbackFunc","_addResource","_removeResource","_isIdProvider","_isPortalDomain","String","search","substr","_normalizeAGOLorgDomain","proxyUrl","path","_getSuffix","restBaseUrl","_isIdenticalService","adminUrl","_getOrigin","headers","Promise","allSSL","portalMode","supportsOAuth","protocol","trim","resourceUrl","serverInfo","options_","admin_","refresh_","focus","_doSignIn","creationTime","shift","_findOAuthInfo","parent","x","isValid","_pendingDfd","_exchangeToken","oAuthState","oAuthSignIn","_getPlatformSelf","_checkProtocol","signIn","user","portalToken","tokenExpiration","parseFloat","_generateOAuthInfo","accountId","redirect_uri","clone","urlKey","top","response_type","force_login","prepopulatedusername","redirectToUserOrgUrl","setInterval","setOAuthResponseHash","detail","authorizeParams","authorizeUrl","I","tokenRefreshBuffer","k","_enqueued","refreshToken","_refreshTimer","_startRefreshTimer","EventedAccessor"],"mappings":"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","file":"static/js/200.7a624495.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{substitute as r}from\"../intl/substitute.js\";import{storeNode as o}from\"../widgets/support/widgetUtils.js\";import{messageBundle as i}from\"../widgets/support/decorators/messageBundle.js\";import{j as n}from\"../chunks/index.js\";import u from\"../widgets/Widget.js\";const l={base:\"esri-identity-form\",group:\"esri-identity-form__group\",label:\"esri-identity-form__label\",footer:\"esri-identity-form__footer\",esriInput:\"esri-input\",esriButton:\"esri-button\",esriButtonSecondary:\"esri-button--secondary\"},p=\"ArcGIS Online\";let a=class extends u{constructor(s,e){super(s,e),this._usernameInputNode=null,this._passwordInputNode=null,this.messages=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){const{error:s,server:e,resource:t,signingIn:i,oAuthPrompt:u,messages:a}=this,d=n(\"div\",{class:l.group},r(u?a.oAuthInfo:a.info,{server:/\\.arcgis\\.com/i.test(e)?p:e,resource:`(${t||a.lblItem})`})),c=u?null:n(\"div\",{class:l.group},n(\"label\",{class:l.label},a.lblUser,n(\"input\",{value:\"\",required:!0,autocomplete:\"off\",spellcheck:!1,type:\"text\",bind:this,afterCreate:o,\"data-node-ref\":\"_usernameInputNode\",class:l.esriInput}))),m=u?null:n(\"div\",{class:l.group},n(\"label\",{class:l.label},a.lblPwd,n(\"input\",{value:\"\",required:!0,type:\"password\",bind:this,afterCreate:o,\"data-node-ref\":\"_passwordInputNode\",class:l.esriInput}))),h=n(\"div\",{class:this.classes(l.group,l.footer)},n(\"input\",{type:\"submit\",disabled:!!i,value:i?a.lblSigning:a.lblOk,class:l.esriButton}),n(\"input\",{type:\"button\",value:a.lblCancel,bind:this,onclick:this._cancel,class:this.classes(l.esriButton,l.esriButtonSecondary)})),b=s?n(\"div\",null,s.details&&s.details.httpStatus?a.invalidUser:a.noAuthService):null;return n(\"form\",{class:l.base,bind:this,onsubmit:this._submit},d,b,c,m,h)}_cancel(){this._set(\"signingIn\",!1),this._usernameInputNode&&(this._usernameInputNode.value=\"\"),this._passwordInputNode&&(this._passwordInputNode.value=\"\"),this.emit(\"cancel\")}_submit(s){s.preventDefault(),this._set(\"signingIn\",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value};this.emit(\"submit\",e)}};s([e(),i(\"esri/identity/t9n/identity\")],a.prototype,\"messages\",void 0),s([e()],a.prototype,\"signingIn\",void 0),s([e()],a.prototype,\"server\",void 0),s([e()],a.prototype,\"resource\",void 0),s([e()],a.prototype,\"error\",void 0),s([e()],a.prototype,\"oAuthPrompt\",void 0),a=s([t(\"esri.identity.IdentityForm\")],a);var d=a;export default d;\n","import { tabbable, isFocusable } from 'tabbable';\n\nlet activeFocusDelay;\n\nconst activeFocusTraps = (function () {\n  const trapQueue = [];\n  return {\n    activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        const activeTrap = trapQueue[trapQueue.length - 1];\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      const trapIndex = trapQueue.indexOf(trap);\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n\n    deactivateTrap(trap) {\n      const trapIndex = trapQueue.indexOf(trap);\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    },\n  };\n})();\n\nconst isSelectableInput = function (node) {\n  return (\n    node.tagName &&\n    node.tagName.toLowerCase() === 'input' &&\n    typeof node.select === 'function'\n  );\n};\n\nconst isEscapeEvent = function (e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nconst isTabEvent = function (e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nconst delay = function (fn) {\n  return setTimeout(fn, 0);\n};\n\n// Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\nconst findIndex = function (arr, fn) {\n  let idx = -1;\n\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n\n  return idx;\n};\n\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\nconst valueOrHandler = function (value, ...params) {\n  return typeof value === 'function' ? value(...params) : value;\n};\n\nconst createFocusTrap = function (elements, userOptions) {\n  const doc = document;\n\n  const config = {\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true,\n    ...userOptions,\n  };\n\n  const state = {\n    // @type {Array<HTMLElement>}\n    containers: [],\n\n    // list of objects identifying the first and last tabbable nodes in all containers/groups in\n    //  the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}\n    tabbableGroups: [],\n\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false,\n  };\n\n  let trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  const containersContain = function (element) {\n    return state.containers.some((container) => container.contains(element));\n  };\n\n  const getNodeForOption = function (optionName) {\n    const optionValue = config[optionName];\n    if (!optionValue) {\n      return null;\n    }\n\n    let node = optionValue;\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue);\n      if (!node) {\n        throw new Error(`\\`${optionName}\\` refers to no known node`);\n      }\n    }\n\n    if (typeof optionValue === 'function') {\n      node = optionValue();\n      if (!node) {\n        throw new Error(`\\`${optionName}\\` did not return a node`);\n      }\n    }\n\n    return node;\n  };\n\n  const getInitialFocusNode = function () {\n    let node;\n\n    if (getNodeForOption('initialFocus') !== null) {\n      node = getNodeForOption('initialFocus');\n    } else if (containersContain(doc.activeElement)) {\n      node = doc.activeElement;\n    } else {\n      const firstTabbableGroup = state.tabbableGroups[0];\n      const firstTabbableNode =\n        firstTabbableGroup && firstTabbableGroup.firstTabbableNode;\n      node = firstTabbableNode || getNodeForOption('fallbackFocus');\n    }\n\n    if (!node) {\n      throw new Error(\n        'Your focus-trap needs to have at least one focusable element'\n      );\n    }\n\n    return node;\n  };\n\n  const updateTabbableNodes = function () {\n    state.tabbableGroups = state.containers\n      .map((container) => {\n        const tabbableNodes = tabbable(container);\n\n        if (tabbableNodes.length > 0) {\n          return {\n            container,\n            firstTabbableNode: tabbableNodes[0],\n            lastTabbableNode: tabbableNodes[tabbableNodes.length - 1],\n          };\n        }\n\n        return undefined;\n      })\n      .filter((group) => !!group); // remove groups with no tabbable nodes\n\n    // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n    if (\n      state.tabbableGroups.length <= 0 &&\n      !getNodeForOption('fallbackFocus')\n    ) {\n      throw new Error(\n        'Your focus-trap must have at least one container with at least one tabbable node in it at all times'\n      );\n    }\n  };\n\n  const tryFocus = function (node) {\n    if (node === doc.activeElement) {\n      return;\n    }\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({ preventScroll: !!config.preventScroll });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  const getReturnFocusNode = function (previousActiveElement) {\n    const node = getNodeForOption('setReturnFocus');\n\n    return node ? node : previousActiveElement;\n  };\n\n  // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n  const checkPointerDown = function (e) {\n    if (containersContain(e.target)) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(e.target),\n      });\n      return;\n    }\n\n    // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    }\n\n    // otherwise, prevent the click\n    e.preventDefault();\n  };\n\n  // In case focus escapes the trap for some strange reason, pull it back in.\n  const checkFocusIn = function (e) {\n    const targetContained = containersContain(e.target);\n    // In Firefox when you Tab out of an iframe the Document is briefly focused.\n    if (targetContained || e.target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = e.target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  };\n\n  // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n  const checkTab = function (e) {\n    updateTabbableNodes();\n\n    let destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      const containerIndex = findIndex(state.tabbableGroups, ({ container }) =>\n        container.contains(e.target)\n      );\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode =\n            state.tabbableGroups[state.tabbableGroups.length - 1]\n              .lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n        const startOfGroupIndex = findIndex(\n          state.tabbableGroups,\n          ({ firstTabbableNode }) => e.target === firstTabbableNode\n        );\n\n        if (startOfGroupIndex >= 0) {\n          const destinationGroupIndex =\n            startOfGroupIndex === 0\n              ? state.tabbableGroups.length - 1\n              : startOfGroupIndex - 1;\n\n          const destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n        const lastOfGroupIndex = findIndex(\n          state.tabbableGroups,\n          ({ lastTabbableNode }) => e.target === lastTabbableNode\n        );\n\n        if (lastOfGroupIndex >= 0) {\n          const destinationGroupIndex =\n            lastOfGroupIndex === state.tabbableGroups.length - 1\n              ? 0\n              : lastOfGroupIndex + 1;\n\n          const destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    }\n  };\n\n  const checkKey = function (e) {\n    if (config.escapeDeactivates !== false && isEscapeEvent(e)) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  const checkClick = function (e) {\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    if (containersContain(e.target)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  };\n\n  //\n  // EVENT LISTENERS\n  //\n\n  const addListeners = function () {\n    if (!state.active) {\n      return;\n    }\n\n    // There can be only one listening focus trap at a time\n    activeFocusTraps.activateTrap(trap);\n\n    // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n    activeFocusDelay = config.delayInitialFocus\n      ? delay(function () {\n          tryFocus(getInitialFocusNode());\n        })\n      : tryFocus(getInitialFocusNode());\n\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false,\n    });\n\n    return trap;\n  };\n\n  const removeListeners = function () {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n\n    return trap;\n  };\n\n  //\n  // TRAP DEFINITION\n  //\n\n  trap = {\n    activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      updateTabbableNodes();\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      const onActivate =\n        activateOptions && activateOptions.onActivate\n          ? activateOptions.onActivate\n          : config.onActivate;\n      if (onActivate) {\n        onActivate();\n      }\n\n      addListeners();\n      return this;\n    },\n\n    deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      clearTimeout(activeFocusDelay);\n\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n\n      activeFocusTraps.deactivateTrap(trap);\n\n      const onDeactivate =\n        deactivateOptions && deactivateOptions.onDeactivate !== undefined\n          ? deactivateOptions.onDeactivate\n          : config.onDeactivate;\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      const returnFocus =\n        deactivateOptions && deactivateOptions.returnFocus !== undefined\n          ? deactivateOptions.returnFocus\n          : config.returnFocusOnDeactivate;\n\n      if (returnFocus) {\n        delay(function () {\n          tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n        });\n      }\n\n      return this;\n    },\n\n    pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n\n      return this;\n    },\n\n    unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n\n      return this;\n    },\n\n    updateContainerElements(containerElements) {\n      const elementsAsArray = [].concat(containerElements).filter(Boolean);\n\n      state.containers = elementsAsArray.map((element) =>\n        typeof element === 'string' ? doc.querySelector(element) : element\n      );\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    },\n  };\n\n  // initialize container elements\n  trap.updateContainerElements(elements);\n\n  return trap;\n};\n\nexport { createFocusTrap };\n","const candidateSelectors = [\n  'input',\n  'select',\n  'textarea',\n  'a[href]',\n  'button',\n  '[tabindex]',\n  'audio[controls]',\n  'video[controls]',\n  '[contenteditable]:not([contenteditable=\"false\"])',\n  'details>summary:first-of-type',\n  'details',\n];\nconst candidateSelector = /* #__PURE__ */ candidateSelectors.join(',');\n\nconst matches =\n  typeof Element === 'undefined'\n    ? function () {}\n    : Element.prototype.matches ||\n      Element.prototype.msMatchesSelector ||\n      Element.prototype.webkitMatchesSelector;\n\nconst getCandidates = function (el, includeContainer, filter) {\n  let candidates = Array.prototype.slice.apply(\n    el.querySelectorAll(candidateSelector)\n  );\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\nconst isContentEditable = function (node) {\n  return node.contentEditable === 'true';\n};\n\nconst getTabindex = function (node) {\n  const tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) {\n    return tabindexAttr;\n  }\n\n  // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n  if (isContentEditable(node)) {\n    return 0;\n  }\n\n  // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n  //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n  //  yet they are still part of the regular tab order; in FF, they get a default\n  //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n  //  order, consider their tab index to be 0.\n  if (\n    (node.nodeName === 'AUDIO' ||\n      node.nodeName === 'VIDEO' ||\n      node.nodeName === 'DETAILS') &&\n    node.getAttribute('tabindex') === null\n  ) {\n    return 0;\n  }\n\n  return node.tabIndex;\n};\n\nconst sortOrderedTabbables = function (a, b) {\n  return a.tabIndex === b.tabIndex\n    ? a.documentOrder - b.documentOrder\n    : a.tabIndex - b.tabIndex;\n};\n\nconst isInput = function (node) {\n  return node.tagName === 'INPUT';\n};\n\nconst isHiddenInput = function (node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nconst isDetailsWithSummary = function (node) {\n  const r =\n    node.tagName === 'DETAILS' &&\n    Array.prototype.slice\n      .apply(node.children)\n      .some((child) => child.tagName === 'SUMMARY');\n  return r;\n};\n\nconst getCheckedRadio = function (nodes, form) {\n  for (let i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nconst isTabbableRadio = function (node) {\n  if (!node.name) {\n    return true;\n  }\n  const radioScope = node.form || node.ownerDocument;\n\n  const queryRadios = function (name) {\n    return radioScope.querySelectorAll(\n      'input[type=\"radio\"][name=\"' + name + '\"]'\n    );\n  };\n\n  let radioSet;\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.CSS !== 'undefined' &&\n    typeof window.CSS.escape === 'function'\n  ) {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s',\n        err.message\n      );\n      return false;\n    }\n  }\n\n  const checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nconst isRadio = function (node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nconst isNonTabbableRadio = function (node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nconst isHidden = function (node) {\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  const isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  const nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n\n  while (node) {\n    if (getComputedStyle(node).display === 'none') {\n      return true;\n    }\n    node = node.parentElement;\n  }\n\n  return false;\n};\n\nconst isNodeMatchingSelectorFocusable = function (node) {\n  if (\n    node.disabled ||\n    isHiddenInput(node) ||\n    isHidden(node) ||\n    /* For a details element with a summary, the summary element gets the focused  */\n    isDetailsWithSummary(node)\n  ) {\n    return false;\n  }\n  return true;\n};\n\nconst isNodeMatchingSelectorTabbable = function (node) {\n  if (\n    !isNodeMatchingSelectorFocusable(node) ||\n    isNonTabbableRadio(node) ||\n    getTabindex(node) < 0\n  ) {\n    return false;\n  }\n  return true;\n};\n\nconst tabbable = function (el, options) {\n  options = options || {};\n\n  const regularTabbables = [];\n  const orderedTabbables = [];\n\n  const candidates = getCandidates(\n    el,\n    options.includeContainer,\n    isNodeMatchingSelectorTabbable\n  );\n\n  candidates.forEach(function (candidate, i) {\n    const candidateTabindex = getTabindex(candidate);\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate,\n      });\n    }\n  });\n\n  const tabbableNodes = orderedTabbables\n    .sort(sortOrderedTabbables)\n    .map((a) => a.node)\n    .concat(regularTabbables);\n\n  return tabbableNodes;\n};\n\nconst focusable = function (el, options) {\n  options = options || {};\n\n  const candidates = getCandidates(\n    el,\n    options.includeContainer,\n    isNodeMatchingSelectorFocusable\n  );\n\n  return candidates;\n};\n\nconst isTabbable = function (node) {\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorTabbable(node);\n};\n\nconst focusableCandidateSelector = /* #__PURE__ */ candidateSelectors\n  .concat('iframe')\n  .join(',');\n\nconst isFocusable = function (node) {\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorFocusable(node);\n};\n\nexport { tabbable, focusable, isTabbable, isFocusable };\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{makeHandle as e}from\"../core/handleUtils.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{messageBundle as i}from\"../widgets/support/decorators/messageBundle.js\";import{j as r}from\"../chunks/index.js\";import{isWidget as n}from\"../widgets/support/widget.js\";import a from\"../widgets/Widget.js\";import{createFocusTrap as c}from\"focus-trap\";const l={base:\"esri-identity-modal\",open:\"esri-identity-modal--open\",closed:\"esri-identity-modal--closed\",title:\"esri-identity-modal__title\",dialog:\"esri-identity-modal__dialog\",content:\"esri-identity-modal__content\",closeButton:\"esri-identity-modal__close-button\",iconClose:\"esri-icon-close\"};let d=class extends a{constructor(t,e){super(t,e),this.container=document.createElement(\"div\"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch(\"open\",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,n=e&&!!o,a={[l.open]:n,[l.closed]:!n},c=r(\"button\",{class:l.closeButton,\"aria-label\":i.close,title:i.close,bind:this,onclick:this._close},r(\"span\",{\"aria-hidden\":\"true\",class:l.iconClose})),d=`${t}_title`,p=`${t}_content`,u=s?r(\"h1\",{id:d,class:l.title},s):null,m=n?r(\"div\",{bind:this,class:l.dialog,role:\"dialog\",\"aria-labelledby\":d,\"aria-describedby\":p,afterCreate:this._createFocusTrap},c,u,this._renderContent(p)):null;return r(\"div\",{tabIndex:-1,class:this.classes(l.base,a)},m)}_destroyFocusTrap(){var t;null==(t=this._focusTrap)||t.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=c(t,{initialFocus:\"input\",onDeactivate:this._close}),this._toggleFocusTrap()}));this.own(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return\"string\"==typeof e?r(\"div\",{class:l.content,id:t,innerHTML:e}):n(e)?r(\"div\",{class:l.content,id:t},e.render()):e instanceof HTMLElement?r(\"div\",{class:l.content,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([o({readOnly:!0})],d.prototype,\"container\",void 0),t([o()],d.prototype,\"content\",void 0),t([o()],d.prototype,\"open\",void 0),t([o(),i(\"esri/t9n/common\")],d.prototype,\"messages\",void 0),t([o({aliasOf:\"messages.auth.signIn\"})],d.prototype,\"title\",void 0),d=t([s(\"esri.identity.IdentityModal\")],d);var p=d;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nconst t=\"esriJSAPIOAuth\";class s{constructor(t,s){this.oAuthInfo=null,this.storage=null,this.appId=null,this.expires=null,this.ssl=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=s,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.token&&this.userId){const s=Date.now();if(this.expires>s){(this.expires-s)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return;const s=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let o=s[e.authNamespace];o||(o=s[e.authNamespace]={}),o[e.portalUrl]={appId:this.appId=e.appId,expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}destroy(){const s=this._load(),e=this.oAuthInfo;if(e&&e.appId&&e.portalUrl&&this.token&&this.expires>Date.now()){const t=e.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/rest/oauth2/revokeToken\",s=new FormData;if(s.append(\"f\",\"json\"),s.append(\"auth_token\",this.token),s.append(\"client_id\",e.appId),s.append(\"token_type_hint\",\"access_token\"),\"function\"==typeof navigator.sendBeacon)navigator.sendBeacon(t,s);else{const e=new XMLHttpRequest;e.open(\"POST\",t),e.send(s)}}if(e&&e.authNamespace&&e.portalUrl&&this.storage){const o=s[e.authNamespace];if(o){delete o[e.portalUrl];try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),s=this.oAuthInfo;if(s&&s.authNamespace&&s.portalUrl){let e=t[s.authNamespace];e&&(e=e[s.portalUrl],e&&(this.appId=e.appId,this.expires=e.expires,this.ssl=e.ssl,this.token=e.token,this.userId=e.userId))}}_load(){let s={};if(this.storage){const i=this.storage.getItem(t);if(i)try{s=JSON.parse(i)}catch(e){console.log(e)}}return s}}s.prototype.declaredClass=\"esri.identity.OAuthCredential\";export default s;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as r}from\"../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{JSONSupport as e}from\"../core/JSONSupport.js\";var p;let s=p=class extends e{constructor(o){super(o),this._oAuthCred=null,this.appId=null,this.authNamespace=\"/\",this.expiration=20160,this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl=\"oauth-callback.html\",this.popupWindowFeatures=\"height=490,width=800,resizable,scrollbars,status\",this.portalUrl=\"https://www.arcgis.com\",this.preserveUrlHash=!1,this.userId=null}clone(){return p.fromJSON(this.toJSON())}};o([r({json:{write:!0}})],s.prototype,\"appId\",void 0),o([r({json:{write:!0}})],s.prototype,\"authNamespace\",void 0),o([r({json:{write:!0}})],s.prototype,\"expiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceLogin\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceUserId\",void 0),o([r({json:{write:!0}})],s.prototype,\"locale\",void 0),o([r({json:{write:!0}})],s.prototype,\"minTimeUntilExpiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"popup\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupCallbackUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupWindowFeatures\",void 0),o([r({json:{write:!0}})],s.prototype,\"portalUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"preserveUrlHash\",void 0),o([r({json:{write:!0}})],s.prototype,\"userId\",void 0),s=p=o([t(\"esri.identity.OAuthInfo\")],s);var i=s;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{JSONSupport as t}from\"../core/JSONSupport.js\";let s=class extends t{constructor(r){super(r),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};r([o({json:{write:!0}})],s.prototype,\"adminTokenServiceUrl\",void 0),r([o({json:{write:!0}})],s.prototype,\"currentVersion\",void 0),r([o({json:{write:!0}})],s.prototype,\"hasPortal\",void 0),r([o({json:{write:!0}})],s.prototype,\"hasServer\",void 0),r([o({json:{write:!0}})],s.prototype,\"owningSystemUrl\",void 0),r([o({json:{write:!0}})],s.prototype,\"owningTenant\",void 0),r([o({json:{write:!0}})],s.prototype,\"server\",void 0),r([o({json:{write:!0}})],s.prototype,\"shortLivedTokenValidity\",void 0),r([o({json:{write:!0}})],s.prototype,\"tokenServiceUrl\",void 0),r([o({json:{write:!0}})],s.prototype,\"webTierAuth\",void 0),s=r([e(\"esri.identity.ServerInfo\")],s);var i=s;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../core/global.js\";import\"../core/has.js\";import{fixJson as s}from\"../core/lang.js\";import{getDeepValue as r}from\"../core/object.js\";import i from\"../config.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as n}from\"../core/accessorSupport/decorators/subclass.js\";import a from\"../core/Error.js\";import{urlToObject as h,hasSameOrigin as l,Url as c,queryToObject as d,normalize as u,getProxyRule as p,makeAbsolute as _,objectToQuery as f}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{on as g}from\"../core/events.js\";import{createAbortController as m,createResolver as v,onAbort as S,isAborted as w}from\"../core/promiseUtils.js\";import I from\"../core/Evented.js\";import{id as k}from\"../kernel.js\";import A from\"../request.js\";import y from\"./IdentityForm.js\";import U from\"./IdentityModal.js\";import x from\"./OAuthCredential.js\";import T from\"./OAuthInfo.js\";import O from\"./ServerInfo.js\";const R={},b=e=>{const t=new c(e.owningSystemUrl).host,s=new c(e.server).host,r=/.+\\.arcgis\\.com$/i;return r.test(t)&&r.test(s)},P=(e,t)=>!!(b(e)&&t&&t.some((t=>t.test(e.server))));let C=null,D=null;try{C=window.localStorage,D=window.sessionStorage}catch{}let j=class extends I{constructor(){super(),this._portalConfig=t.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this.defaultOAuthInfo=null,this.defaultTokenValidity=60,this.dialog=null,this.formConstructor=y,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appUrlObj=h(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthHash=null,this._gwTokenUrl=\"/sharing/rest/generateToken\",this._agsRest=\"/rest/services\",this._agsPortal=/\\/sharing(\\/|$)/i,this._agsAdmin=/(https?:\\/\\/[^\\/]+\\/[^\\/]+)\\/admin\\/?(\\/.*)?$/i,this._adminSvcs=/\\/rest\\/admin\\/services(\\/|$)/i,this._gwDomains=[{regex:/^https?:\\/\\/www\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:dev|[a-z\\d-]+\\.mapsdev)\\.arcgis\\.com/i,customBaseUrl:\"mapsdev.arcgis.com\",tokenServiceUrl:\"https://dev.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:devext|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,customBaseUrl:\"mapsdevext.arcgis.com\",tokenServiceUrl:\"https://devext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:qaext|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i,customBaseUrl:\"mapsqa.arcgis.com\",tokenServiceUrl:\"https://qaext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/[a-z\\d-]+\\.maps\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"}],this._legacyFed=[],this._regexSDirUrl=/http.+\\/rest\\/services\\/?/gi,this._regexServerType=/(\\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\\/users\\/([^\\/]+)\\/?.*/i,this._gwItem=/http.+\\/items\\/([^\\/]+)\\/?.*/i,this._gwGroup=/http.+\\/groups\\/([^\\/]+)\\/?.*/i,this._rePortalTokenSvc=/\\/sharing(\\/rest)?\\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthHash(),window.addEventListener(\"pageshow\",(e=>{this._pageShowHandler(e)}))}registerServers(e){const t=this.serverInfos;t?(e=e.filter((e=>!this.findServerInfo(e.server))),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach((e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)}))}registerOAuthInfos(e){const t=this.oAuthInfos;if(t){for(const s of e){const e=this.findOAuthInfo(s.portalUrl);e&&t.splice(t.indexOf(e),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};const t=this._sanitizeUrl(e.server),s=this._isServerRsrc(t);let r,i=this.findServerInfo(t),o=!0;i||(i=new O,i.server=this._getServerInstanceRoot(t),s?i.hasServer=!0:(i.tokenServiceUrl=this._getTokenSvcUrl(t),i.hasPortal=!0),this.registerServers([i])),r=this._findCredential(t),r?(delete e.server,Object.assign(r,e),o=!1):(r=new q({userId:e.userId,server:i.server,token:e.token,expires:e.expires,ssl:e.ssl,scope:s?\"server\":\"portal\"}),r.resources=[t],this.credentials.push(r)),r.emitTokenChange(!1),o||r.refreshServerTokens()}toJSON(){return s({serverInfos:this.serverInfos.map((e=>e.toJSON())),oAuthInfos:this.oAuthInfos.map((e=>e.toJSON())),credentials:this.credentials.map((e=>e.toJSON()))})}initialize(e){if(!e)return;\"string\"==typeof e&&(e=JSON.parse(e));const t=e.serverInfos,s=e.oAuthInfos,r=e.credentials;if(t){const e=[];t.forEach((t=>{t.server&&t.tokenServiceUrl&&e.push(t.declaredClass?t:new O(t))})),e.length&&this.registerServers(e)}if(s){const e=[];s.forEach((t=>{t.appId&&e.push(t.declaredClass?t:new T(t))})),e.length&&this.registerOAuthInfos(e)}r&&r.forEach((e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new q(e)).emitTokenChange(),this.credentials.push(e))}))}findServerInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.serverInfos)if(this._hasSameServerInstance(s.server,e)){t=s;break}return t}findOAuthInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.oAuthInfos)if(this._hasSameServerInstance(s.portalUrl,e)){t=s;break}return t}findCredential(e,t){let s;e=this._sanitizeUrl(e);const r=this._isServerRsrc(e)?\"server\":\"portal\";if(t){for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&t===i.userId&&i.scope===r){s=i;break}}else for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&-1!==this._getIdenticalSvcIdx(e,i)&&i.scope===r){s=i;break}return s}getCredential(e,t){let s,r,i=!0;t&&(s=!!t.token,r=t.error,i=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);const o=m(),n=v();if(t.signal&&S(t.signal,(()=>{o.abort()})),S(o,(()=>{n.reject(new a(\"identity-manager:user-aborted\",\"ABORTED\"))})),w(o))return n.promise;t.signal=o.signal;const h=this._isAdminResource(e),c=s?this.findCredential(e):null;let d;if(c&&r&&r.details&&498===r.details.httpStatus)c.destroy();else if(c)return d=new a(\"identity-manager:not-authorized\",\"You are currently signed in as: '\"+c.userId+\"'. You do not have access to this resource: \"+e,{error:r}),n.reject(d),n.promise;const u=this._findCredential(e,t);if(u)return n.resolve(u),n.promise;let p=this.findServerInfo(e);if(p)!p.hasServer&&this._isServerRsrc(e)&&(p._restInfoPms=this._getTokenSvcUrl(e),p.hasServer=!0);else{const t=this._getTokenSvcUrl(e);if(!t)return d=new a(\"identity-manager:unknown-resource\",\"Unknown resource - could not find token service endpoint.\"),n.reject(d),n.promise;p=new O,p.server=this._getServerInstanceRoot(e),\"string\"==typeof t?(p.tokenServiceUrl=t,p.hasPortal=!0):(p._restInfoPms=t,p.hasServer=!0),this.registerServers([p])}return p.hasPortal&&void 0===p._selfReq&&(i||l(p.tokenServiceUrl,window.location.origin)||this._gwDomains.some((e=>e.tokenServiceUrl===p.tokenServiceUrl)))&&(p._selfReq={owningTenant:t&&t.owningTenant,selfDfd:this._getPortalSelf(p.tokenServiceUrl.replace(this._rePortalTokenSvc,\"/sharing/rest/portals/self\"),e)}),this._enqueue(e,p,t,n,h)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"\")||\"\":this._gwUser.test(e)&&e.replace(this._gwUser,\"$1\")||this._gwItem.test(e)&&e.replace(this._gwItem,\"$1\")||this._gwGroup.test(e)&&e.replace(this._gwGroup,\"$1\")||\"\"}generateToken(e,t,s){const r=this._rePortalTokenSvc.test(e.tokenServiceUrl),i=new c(window.location.href.toLowerCase()),o=e.shortLivedTokenValidity;let n,h,d,u,p,_,f,g;t&&(g=this.tokenValidity||o||this.defaultTokenValidity,g>o&&o>0&&(g=o)),s&&(n=s.isAdmin,h=s.serverUrl,d=s.token,_=s.signal,f=s.ssl,e.customParameters=s.customParameters),n?u=e.adminTokenServiceUrl:(u=e.tokenServiceUrl,p=new c(u.toLowerCase()),e.webTierAuth&&s&&s.serverUrl&&!f&&\"http\"===i.scheme&&(l(i.uri,u,!0)||\"https\"===p.scheme&&i.host===p.host&&\"7080\"===i.port&&\"7443\"===p.port)&&(u=u.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\")));const m={query:{request:\"getToken\",username:null==t?void 0:t.username,password:null==t?void 0:t.password,serverUrl:h,token:d,expiration:g,referer:n||r?window.location.host:null,client:n?\"referer\":null,f:\"json\",...e.customParameters},method:\"post\",authMode:\"anonymous\",useProxy:this._useProxy(e,s),signal:_,...null==s?void 0:s.ioArgs};r||(m.withCredentials=!1);return A(u,m).then((s=>{const r=s.data;if(!r||!r.token)return new a(\"identity-manager:authentication-failed\",\"Unable to generate token\");const i=e.server;return R[i]||(R[i]={}),t&&(R[i][t.username]=t.password),r.validity=g,r}))}isBusy(){return!!this._busy}checkSignInStatus(e){return this.checkAppAccess(e,\"\").then((e=>e.credential))}checkAppAccess(e,t,s){let r=!1;return this.getCredential(e,{prompt:!1}).then((i=>{let o;const n={f:\"json\"};if(\"portal\"===i.scope)if(t&&(this._doPortalSignIn(e)||s&&s.force))o=i.server+\"/sharing/rest/oauth2/validateAppAccess\",n.client_id=t;else{if(!i.token)return{credential:i};o=i.server+\"/sharing/rest\"}else{if(!i.token)return{credential:i};o=i.server+\"/rest/services\"}return i.token&&(n.token=i.token),A(o,{query:n,authMode:\"anonymous\"}).then((e=>{if(!1===e.data.valid)throw new a(\"identity-manager:not-authorized\",`You are currently signed in as: '${i.userId}'.`,e.data);return r=!!e.data.viewOnlyUserTypeApp,{credential:i}})).catch((e=>{if(\"identity-manager:not-authorized\"===e.name)throw e;const t=e.details&&e.details.httpStatus;if(498===t)throw i.destroy(),new a(\"identity-manager:not-authenticated\",\"User is not signed in.\");if(400===t)throw new a(\"identity-manager:invalid-request\");return{credential:i}}))})).then((e=>({credential:e.credential,viewOnly:r})))}setOAuthResponseHash(e){var t;const s=this._oAuthDfd;if(this._oAuthDfd=null,!s||!e)return;clearInterval(this._oAuthIntervalId),null==(t=this._oAuthOnHashHandle)||t.remove(),\"#\"===e.charAt(0)&&(e=e.substring(1));const r=d(e);if(r.error){const e=\"access_denied\"===r.error,t=new a(e?\"identity-manager:user-aborted\":\"identity-manager:authentication-failed\",e?\"ABORTED\":\"OAuth: \"+r.error+\" - \"+r.error_description);s.reject(t)}else{const e=s.sinfo_,t=s.oinfo_,i=t._oAuthCred,o=new q({userId:r.username,server:e.server,token:r.access_token,expires:Date.now()+1e3*Number(r.expires_in),ssl:\"true\"===r.ssl,_oAuthCred:i});t.userId=o.userId,i.storage=r.persist?C:D,i.token=o.token,i.expires=o.expires,i.userId=o.userId,i.ssl=o.ssl,i.save(),s.resolve(o)}}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,s={}){const r=v(),i=()=>{var e,t,s,r,i;null==(e=h)||e.remove(),null==(t=l)||t.remove(),null==(s=c)||s.remove(),null==(r=n)||r.destroy(),null==(i=this.dialog)||i.destroy(),this.dialog=n=h=l=c=null},o=()=>{i(),this._oAuthDfd=null,r.reject(new a(\"identity-manager:user-aborted\",\"ABORTED\"))};s.signal&&S(s.signal,(()=>{o()}));let n=new this.formConstructor;n.resource=this.getResourceName(e),n.server=t.server,this.dialog=new U,this.dialog.content=n,this.dialog.open=!0,this.emit(\"dialog-create\");let h=n.on(\"cancel\",o),l=this.dialog.watch(\"open\",o),c=n.on(\"submit\",(e=>{this.generateToken(t,e,{isAdmin:s.isAdmin,signal:s.signal}).then((o=>{i();const n=new q({userId:e.username,server:t.server,token:o.token,expires:null!=o.expires?Number(o.expires):null,ssl:!!o.ssl,isAdmin:s.isAdmin,validity:o.validity});r.resolve(n)})).catch((e=>{n.error=e,n.signingIn=!1}))}));return r.promise}oAuthSignIn(e,t,s,r){this._oAuthDfd=v();const i=this._oAuthDfd;null!=r&&r.signal&&S(r.signal,(()=>{const e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&h()})),i.resUrl_=e,i.sinfo_=t,i.oinfo_=s;const o=!r||!1!==r.oAuthPopupConfirmation;if(!s.popup||!o)return this._doOAuthSignIn(e,t,s),i.promise;const n=new this.formConstructor;n.oAuthPrompt=!0,n.server=t.server,this.dialog=new U,this.dialog.content=n,this.dialog.open=!0,this.emit(\"dialog-create\");const h=()=>{u(),this._oAuthDfd=null,i.reject(new a(\"identity-manager:user-aborted\",\"ABORTED\"))},l=n.on(\"cancel\",h),c=this.dialog.watch(\"open\",h),d=n.on(\"submit\",(()=>{u(),this._doOAuthSignIn(e,t,s)})),u=()=>{l.remove(),c.remove(),d.remove(),n.destroy(),this.dialog.destroy(),this.dialog=null};return i.promise}destroyCredentials(){if(this.credentials){this.credentials.slice().forEach((e=>{e.destroy()}))}this.emit(\"credentials-destroy\")}enablePostMessageAuth(e=\"https://www.arcgis.com/sharing/rest\"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=g(window,\"message\",(t=>{var s;if((t.origin===window.location.origin||t.origin.endsWith(\".arcgis.com\"))&&\"arcgis:auth:requestCredential\"===(null==(s=t.data)?void 0:s.type)){const s=t.source;this.getCredential(e).then((e=>{s.postMessage({type:\"arcgis:auth:credential\",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)})).catch((e=>{s.postMessage({type:\"arcgis:auth:error\",error:{name:e.name,message:e.message}},t.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthHash(){let e=window.location.hash;if(e){\"#\"===e.charAt(0)&&(e=e.substring(1));const t=d(e);let s=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty(\"username\"))try{t.state=JSON.parse(t.state),\"object\"==typeof t.state&&t.state.portalUrl&&(this._oAuthHash=t,s=!0)}catch{}else t.error&&t.error_description&&(console.log(\"IdentityManager OAuth Error: \",t.error,\" - \",t.error_description),\"access_denied\"===t.error&&(s=!0));s&&(window.location.hash=\"object\"==typeof t.state&&t.state.hash||\"\")}}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const e=new a(\"identity-manager:user-aborted\",\"ABORTED\");this._errbackFunc(e)}}_findCredential(e,t){let s,r,i,o,n=-1;const a=t&&t.token,h=t&&t.resource,l=this._isServerRsrc(e)?\"server\":\"portal\",c=this.credentials.filter((t=>this._hasSameServerInstance(t.server,e)&&t.scope===l));if(e=h||e,c.length)if(1===c.length){if(s=c[0],o=this.findServerInfo(s.server),r=o&&o.owningSystemUrl,i=r&&this.findCredential(r,s.userId),n=this._getIdenticalSvcIdx(e,s),!a)return-1===n&&s.resources.push(e),this._addResource(e,i),s;-1!==n&&(s.resources.splice(n,1),this._removeResource(e,i))}else{let t,s;if(c.some((a=>(s=this._getIdenticalSvcIdx(e,a),-1!==s&&(t=a,o=this.findServerInfo(t.server),r=o&&o.owningSystemUrl,i=r&&this.findCredential(r,t.userId),n=s,!0)))),a)t&&(t.resources.splice(n,1),this._removeResource(e,i));else if(t)return this._addResource(e,i),t}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t)for(const s of this.oAuthInfos)if(this._isIdProvider(s.portalUrl,e)){t=s;break}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let s=-1;t&&(s=this._getIdenticalSvcIdx(e,t),s>-1&&t.resources.splice(s,1))}_useProxy(e,t){return t&&t.isAdmin&&!l(e.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(e.tokenServiceUrl)&&\"10.1\"===String(e.currentVersion)&&!l(e.tokenServiceUrl,window.location.href)}_getOrigin(e){const t=new c(e);return t.scheme+\"://\"+t.host+(null!=t.port?\":\"+t.port:\"\")}_getServerInstanceRoot(e){const t=e.toLowerCase();let s=t.indexOf(this._agsRest);return-1===s&&this._isAdminResource(e)&&(s=this._agsAdmin.test(e)?e.replace(this._agsAdmin,\"$1\").length:e.search(this._adminSvcs)),-1===s&&(s=t.indexOf(\"/sharing\")),-1===s&&\"/\"===t.substr(-1)&&(s=t.length-1),s>-1?e.substring(0,s):e}_hasSameServerInstance(e,t){return\"/\"===e.substr(-1)&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=this._normalizeAGOLorgDomain(e),t=this._normalizeAGOLorgDomain(t),(e=e.substr(e.indexOf(\":\")))===(t=t.substr(t.indexOf(\":\")))}_normalizeAGOLorgDomain(e){const t=/^https?:\\/\\/(?:cdn|[a-z\\d-]+\\.maps)\\.arcgis\\.com/i,s=/^https?:\\/\\/(?:cdndev|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,r=/^https?:\\/\\/(?:cdnqa|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i;return t.test(e)?e=e.replace(t,\"https://www.arcgis.com\"):s.test(e)?e=e.replace(s,\"https://devext.arcgis.com\"):r.test(e)&&(e=e.replace(r,\"https://qaext.arcgis.com\")),e}_sanitizeUrl(e){const t=(i.request.proxyUrl||\"\").toLowerCase(),s=t?e.toLowerCase().indexOf(t+\"?\"):-1;return-1!==s&&(e=e.substring(s+t.length+1)),e=u(e),h(e).path}_isRESTService(e){return e.indexOf(this._agsRest)>-1}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let s;if(this._isRESTService(e)&&this._isRESTService(t)){const r=this._getSuffix(e).toLowerCase(),i=this._getSuffix(t).toLowerCase();if(s=r===i,!s){const e=/(.*)\\/(MapServer|FeatureServer).*/gi;s=r.replace(e,\"$1\")===i.replace(e,\"$1\")}}else this._isAdminResource(e)&&this._isAdminResource(t)?s=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(s=!0);return s}_isPortalDomain(e){const t=new c(e.toLowerCase()),s=this._portalConfig;let r=this._gwDomains.some((e=>e.regex.test(t.uri)));return!r&&s&&(r=this._hasSameServerInstance(this._getServerInstanceRoot(s.restBaseUrl),t.uri)),r||i.portalUrl&&(r=l(t,i.portalUrl,!0)),r||(r=this._portals.some((e=>this._hasSameServerInstance(e,t.uri)))),r=r||this._agsPortal.test(t.path),r}_isIdProvider(e,t){let s=-1,r=-1;this._gwDomains.forEach(((i,o)=>{-1===s&&i.regex.test(e)&&(s=o),-1===r&&i.regex.test(t)&&(r=o)}));let i=!1;if(s>-1&&r>-1&&(0===s||4===s?0!==r&&4!==r||(i=!0):1===s?1!==r&&2!==r||(i=!0):2===s?2===r&&(i=!0):3===s&&3===r&&(i=!0)),!i){const s=this.findServerInfo(t),r=s&&s.owningSystemUrl;r&&b(s)&&this._isPortalDomain(r)&&this._isIdProvider(e,r)&&(i=!0)}return i}_getIdenticalSvcIdx(e,t){let s=-1;for(let r=0;r<t.resources.length;r++){const i=t.resources[r];if(this._isIdenticalService(e,i)){s=r;break}}return s}_getSuffix(e){return e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"$1\")}_getTokenSvcUrl(e){let t,s,r;if(this._isRESTService(e)||this._isAdminResource(e)){const r=this._getServerInstanceRoot(e);return t=r+\"/admin/generateToken\",s=A(e=r+\"/rest/info\",{query:{f:\"json\"}}).then((e=>e.data)),{adminUrl:t,promise:s}}if(this._isPortalDomain(e)){let t=\"\";if(this._gwDomains.some((s=>(s.regex.test(e)&&(t=s.tokenServiceUrl),!!t))),t||this._portals.some((s=>(this._hasSameServerInstance(s,e)&&(t=s+this._gwTokenUrl),!!t))),t||(r=e.toLowerCase().indexOf(\"/sharing\"),-1!==r&&(t=e.substring(0,r)+this._gwTokenUrl)),t||(t=this._getOrigin(e)+this._gwTokenUrl),t){const s=new c(e).port;/^http:\\/\\//i.test(e)&&\"7080\"===s&&(t=t.replace(/:7080/i,\":7443\")),t=t.replace(/http:/i,\"https:\")}return t}if(-1!==e.toLowerCase().indexOf(\"premium.arcgisonline.com\"))return\"https://premium.arcgisonline.com/server/tokens\"}_exchangeToken(e,t,s){return A(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:\"anonymous\",method:\"post\",query:{f:\"json\",client_id:t,token:s}}).then((e=>e.data.token))}_getPlatformSelf(e,t){return A(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:\"anonymous\",headers:{\"X-Esri-Auth-Client-Id\":t,\"X-Esri-Auth-Redirect-Uri\":window.location.href.replace(/#.*$/,\"\")},method:\"post\",query:{f:\"json\"},withCredentials:!0}).then((e=>e.data))}_getPortalSelf(e,t){let s;if(this._gwDomains.some((t=>(t.regex.test(e)&&(s=t.customBaseUrl),!!s))),s)return Promise.resolve({allSSL:!0,currentVersion:\"4.4\",customBaseUrl:s,portalMode:\"multitenant\",supportsOAuth:!0});\"https:\"===window.location.protocol?e=e.replace(/^http:/i,\"https:\").replace(/:7080/i,\":7443\"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\"));return A(e,{query:{f:\"json\"},authMode:\"anonymous\",withCredentials:!0}).then((e=>e.data))}_doPortalSignIn(e){const t=this._portalConfig,s=window.location.href,r=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(s)||!(r?r.hasPortal||r.owningSystemUrl&&this._isPortalDomain(r.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(s,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||l(s,e,!0)))}_checkProtocol(e,t,s,r){let i=!0;const o=r?t.adminTokenServiceUrl:t.tokenServiceUrl;if(0===o.trim().toLowerCase().indexOf(\"https:\")&&0!==window.location.href.toLowerCase().indexOf(\"https:\")&&p(o)&&(i=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}),!i)){s(new a(\"identity-manager:aborted\",\"Aborted the Sign-In process to avoid sending password over insecure connection.\"))}return i}_enqueue(e,t,s,r,i,o){return r||(r=v()),r.resUrl_=e,r.sinfo_=t,r.options_=s,r.admin_=i,r.refresh_=o,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(r)):this._xoReqs.push(r):this._doSignIn(r),r.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;const t=t=>{const s=e.options_&&e.options_.resource,r=e.resUrl_,i=e.refresh_;let o=!1;-1===this.credentials.indexOf(t)&&(i&&-1!==this.credentials.indexOf(i)?(i.userId=t.userId,i.token=t.token,i.expires=t.expires,i.validity=t.validity,i.ssl=t.ssl,i.creationTime=t.creationTime,o=!0,t=i):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.push(s||r),t.scope=this._isServerRsrc(r)?\"server\":\"portal\",t.emitTokenChange();const n=this._soReqs,a={};this._soReqs=[],n.forEach((e=>{if(!this._isIdenticalService(r,e.resUrl_)){const s=this._getSuffix(e.resUrl_);a[s]||(a[s]=!0,t.resources.push(e.resUrl_))}})),e.resolve(t),n.forEach((e=>{this._hasSameServerInstance(this._getServerInstanceRoot(r),e.resUrl_)?e.resolve(t):this._soReqs.push(e)})),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,o||this.emit(\"credential-create\",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},s=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=(r,i,o,n)=>{var h,c;const d=e.sinfo_,u=!e.options_||!1!==e.options_.prompt,p=d.hasPortal&&this._findOAuthInfo(e.resUrl_);let _,f;if(r)t(new q({userId:r,server:d.server,token:o||null,expires:null!=n?Number(n):null,ssl:!!i}));else if(window!==window.parent&&null!=(h=this._appUrlObj.query)&&h[\"arcgis-auth-origin\"]&&null!=(c=this._appUrlObj.query)&&c[\"arcgis-auth-portal\"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query[\"arcgis-auth-portal\"]),e.resUrl_)){var m;window.parent.postMessage({type:\"arcgis:auth:requestCredential\"},this._appUrlObj.query[\"arcgis-auth-origin\"]);const r=g(window,\"message\",(e=>{e.source===window.parent&&e.data&&(\"arcgis:auth:credential\"===e.data.type?(r.remove(),t(new q(e.data.credential))):\"arcgis:auth:error\"===e.data.type&&(r.remove(),s(a.fromJSON(e.data.error))))}));S(null==(m=e.options_)?void 0:m.signal,(()=>{r.remove()}))}else if(p){let r=p._oAuthCred;if(!r){const e=new x(p,C),t=new x(p,D);e.isValid()&&t.isValid()?e.expires>t.expires?(r=e,t.destroy()):(r=t,e.destroy()):r=e.isValid()?e:t,p._oAuthCred=r}if(r.isValid())_=new q({userId:r.userId,server:d.server,token:r.token,expires:r.expires,ssl:r.ssl,_oAuthCred:r}),p.appId!==r.appId&&this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._exchangeToken(_.server,p.appId,_.token).then((e=>{_.token=e,r.token=e,r.save(),t(_)})).catch((()=>{t(_)})):t(_);else if(this._oAuthHash&&this._hasSameServerInstance(p.portalUrl,this._oAuthHash.state.portalUrl)){const e=this._oAuthHash;_=new q({userId:e.username,server:d.server,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:\"true\"===e.ssl,oAuthState:e.state,_oAuthCred:r}),p.userId=_.userId,r.storage=e.persist?C:D,r.token=_.token,r.expires=_.expires,r.userId=_.userId,r.ssl=_.ssl,r.save(),this._oAuthHash=null,t(_)}else{const r=()=>{u?e._pendingDfd=this.oAuthSignIn(e.resUrl_,d,p,e.options_).then(t,s):(f=new a(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(f))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(d.server,p.appId).then((({portalUrl:e,token:s,username:i})=>{!e||l(e,window.location.origin,!0)?(_=new q({server:d.server,userId:i,token:s}),t(_)):r()})).catch(r):r()}}else if(u){if(this._checkProtocol(e.resUrl_,d,s,e.admin_)){let r=e.options_;e.admin_&&(r=r||{},r.isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,d,r).then(t,s)}}else f=new a(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(f)},o=()=>{const r=e.sinfo_,i=r.owningSystemUrl,o=e.options_;let n,a,h,l;if(o&&(n=o.token,a=o.error,h=o.prompt),l=this._findCredential(i,{token:n,resource:e.resUrl_}),!l)for(const e of this.credentials)if(this._isIdProvider(i,e.server)){l=e;break}if(l){const i=this.findCredential(e.resUrl_,l.userId);if(i)t(i);else if(P(r,this._legacyFed)){const e=l.toJSON();e.server=r.server,e.resources=null,t(new q(e))}else{(e._pendingDfd=this.generateToken(this.findServerInfo(l.server),null,{serverUrl:e.resUrl_,token:l.token,signal:e.options_.signal,ssl:l.ssl})).then((s=>{t(new q({userId:l.userId,server:r.server,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:e.admin_,validity:s.validity}))}),s)}}else{this._busy=null,n&&(e.options_.token=null);(e._pendingDfd=this.getCredential(i.replace(/\\/?$/,\"/sharing\"),{resource:e.resUrl_,owningTenant:r.owningTenant,signal:e.options_.signal,token:n,error:a,prompt:h})).then((()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)}),(e=>{s(e)}))}};this._errbackFunc=s;const n=e.sinfo_.owningSystemUrl,h=this._isServerRsrc(e.resUrl_),c=e.sinfo_._restInfoPms;c?c.promise.then((t=>{const s=e.sinfo_;if(s._restInfoPms){s.adminTokenServiceUrl=s._restInfoPms.adminUrl,s._restInfoPms=null,s.tokenServiceUrl=r(\"authInfo.tokenServicesUrl\",t)||r(\"authInfo.tokenServiceUrl\",t)||r(\"tokenServiceUrl\",t),s.shortLivedTokenValidity=r(\"authInfo.shortLivedTokenValidity\",t),s.currentVersion=t.currentVersion,s.owningTenant=t.owningTenant;const e=s.owningSystemUrl=t.owningSystemUrl;e&&this._portals.push(e)}h&&s.owningSystemUrl?o():i()}),(()=>{e.sinfo_._restInfoPms=null;const t=new a(\"identity-manager:server-identification-failed\",\"Unknown resource - could not find token service endpoint.\");s(t)})):h&&n?o():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then((t=>{const s={};let r,i,o,n;return t&&(r=t.user&&t.user.username,s.username=r,s.allSSL=t.allSSL,i=t.supportsOAuth,o=t.currentVersion,\"multitenant\"===t.portalMode&&(n=t.customBaseUrl)),e.sinfo_.webTierAuth=!!r,r&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:s.allSSL}).catch((()=>null)).then((e=>(s.portalToken=e&&e.token,s.tokenExpiration=e&&e.expires,s))):!r&&i&&parseFloat(o)>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:n,owningTenant:e.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>s)):s})).catch((()=>null)).then((t=>{e.sinfo_._selfReq=null,t?i(t.username,t.allSSL,t.portalToken,t.tokenExpiration):i()})):i()}_generateOAuthInfo(e){let t,s,r=e.portalUrl;const i=e.customBaseUrl,o=e.owningTenant,n=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(n){s=window.location.href;let e=s.indexOf(\"?\");e>-1&&(s=s.slice(0,e)),e=s.search(/\\/(apps|home)\\//),s=e>-1?s.slice(0,e):null}return n&&s?(this._hasTestedIfAppIsOnPortal=!0,t=A(s+\"/sharing/rest\",{query:{f:\"json\"}}).then((()=>{this.defaultOAuthInfo=new T({appId:\"arcgisonline\",popupCallbackUrl:s+\"/home/oauth-callback.html\"})}))):t=Promise.resolve(),t.then((()=>{if(this.defaultOAuthInfo)return r=r.replace(/^http:/i,\"https:\"),A(r+\"/sharing/rest/oauth2/validateRedirectUri\",{query:{accountId:o,client_id:this.defaultOAuthInfo.appId,redirect_uri:_(this.defaultOAuthInfo.popupCallbackUrl),f:\"json\"}}).then((e=>{if(e.data.valid){const t=this.defaultOAuthInfo.clone();e.data.urlKey&&i?t.portalUrl=\"https://\"+e.data.urlKey.toLowerCase()+\".\"+i:t.portalUrl=r,t.popup=window!==window.top||!(l(r,window.location.origin)||this._gwDomains.some((e=>e.regex.test(r)&&e.regex.test(window.location.origin)))),this.oAuthInfos.push(t)}}))}))}_doOAuthSignIn(e,s,r){const i={portalUrl:r.portalUrl};!r.popup&&r.preserveUrlHash&&window.location.hash&&(i.hash=window.location.hash);const o={client_id:r.appId,response_type:\"token\",state:JSON.stringify(i),expiration:r.expiration,locale:r.locale,redirect_uri:r.popup?_(r.popupCallbackUrl):window.location.href.replace(/#.*$/,\"\")};r.forceLogin&&(o.force_login=!0),r.forceUserId&&r.userId&&(o.prepopulatedusername=r.userId),!r.popup&&this._doPortalSignIn(e)&&(o.redirectToUserOrgUrl=!0);const n=r.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/oauth2/authorize\",h=n+\"?\"+f(o);if(r.popup){const e=window.open(h,\"esriJSAPIOAuth\",r.popupWindowFeatures);if(e)e.focus(),this._oAuthDfd.oAuthWin_=e,this._oAuthIntervalId=setInterval((()=>{if(e.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnHashHandle.remove();const e=this._oAuthDfd;if(e){const t=new a(\"identity-manager:user-aborted\",\"ABORTED\");e.reject(t)}}}),500),this._oAuthOnHashHandle=g(t,\"arcgis:auth:hash\",(e=>{this.setOAuthResponseHash(e.detail)}));else{const e=new a(\"identity-manager:popup-blocked\",\"ABORTED\");this._oAuthDfd.reject(e)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:n,resourceUrl:e,serverInfo:s,oAuthInfo:r}):window.location.href=h}};j=e([n(\"esri.identity.IdentityManagerBase\")],j);let q=class extends I.EventedAccessor{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e&&e._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const e=k.findServerInfo(this.server),t=e&&e.owningSystemUrl,s=!!t&&\"server\"===this.scope,r=s&&P(e,k._legacyFed),i=e.webTierAuth,o=i&&k.normalizeWebTierAuth,n=R[this.server],a=n&&n[this.userId];let h,l=this.resources&&this.resources[0],c=s&&k.findServerInfo(t),d={username:this.userId,password:a};if(i&&!o)return;s&&!c&&k.serverInfos.some((e=>(k._isIdProvider(t,e.server)&&(c=e),!!c)));const u=c&&k.findCredential(c.server,this.userId);if(!s||u){if(!r){if(s)h={serverUrl:l,token:u&&u.token,ssl:u&&u.ssl};else if(o)d=null,h={ssl:this.ssl};else{if(!a){let t;return l&&(l=k._sanitizeUrl(l),this._enqueued=1,t=k._enqueue(l,e,null,null,this.isAdmin,this),t.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),t}this.isAdmin&&(h={isAdmin:!0})}return k.generateToken(s?c:e,s?null:d,h).then((e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}u.refreshToken()}}refreshServerTokens(){\"portal\"===this.scope&&k.credentials.forEach((e=>{const t=k.findServerInfo(e.server),s=t&&t.owningSystemUrl;e!==this&&e.userId===this.userId&&s&&\"server\"===e.scope&&(k._hasSameServerInstance(this.server,s)||k._isIdProvider(s,this.server))&&(P(t,k._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())}))}emitTokenChange(e){clearTimeout(this._refreshTimer);const t=this.server&&k.findServerInfo(this.server),s=t&&t.owningSystemUrl,r=s&&k.findServerInfo(s);!1===e||s&&\"portal\"!==this.scope&&(!r||!r.webTierAuth||k.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit(\"token-change\")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const e=k.credentials.indexOf(this);e>-1&&k.credentials.splice(e,1),this.emitTokenChange(),this.emit(\"destroy\")}toJSON(){const e=s({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);const e=6e4*this.tokenRefreshBuffer,t=2**31-1;let s=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();s<0?s=0:s>t&&(s=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),s>e?s-e:s)}};e([o()],q.prototype,\"creationTime\",void 0),e([o()],q.prototype,\"expires\",void 0),e([o()],q.prototype,\"isAdmin\",void 0),e([o()],q.prototype,\"oAuthState\",void 0),e([o()],q.prototype,\"resources\",void 0),e([o()],q.prototype,\"scope\",void 0),e([o()],q.prototype,\"server\",void 0),e([o()],q.prototype,\"ssl\",void 0),e([o()],q.prototype,\"token\",void 0),e([o()],q.prototype,\"tokenRefreshBuffer\",void 0),e([o()],q.prototype,\"userId\",void 0),e([o()],q.prototype,\"validity\",void 0),q=e([n(\"esri.identity.Credential\")],q);export{q as Credential,j as IdentityManagerBase};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";import{setId as r}from\"../kernel.js\";import{IdentityManagerBase as t}from\"./IdentityManagerBase.js\";let o=class extends t{};o=s([e(\"esri.identity.IdentityManager\")],o);const a=new o;r(a);export default a;\n"],"sourceRoot":""}