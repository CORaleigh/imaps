(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[101],{1237:function(e,t,i){"use strict";i.r(t);var n=i(2),a=i(3),r=i(30),s=i(28),o=i(4),l=i(5),c=i(0),u=(i(14),i(12)),d=(i(17),i(1)),h=i(27),b=i(8),p=(i(11),i(18),i(19),i(24)),v=i(62),m=(i(51),i(77)),O=i(64),j=i(9),f=i(60),_=i(7),y=i.n(_),g=i(16),w=i(6),k=i(49),P=i(25);function L(e){return M.apply(this,arguments)}function M(){return(M=Object(g.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return T.apply(this,arguments)}function T(){return(T=Object(g.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in V))switch(t){case"DirectLineMeasurement3D":V[t]=Promise.all([Promise.all([i.e(6),i.e(66)]).then(i.bind(null,1246)),i.e(94).then(i.bind(null,1225))]).then((function(e){return{viewConstructor:e[0].DirectLineMeasurement3DView,controllerConstructor:e[1].DirectLineMeasurement3DController}}))}return e.abrupt("return",V[t]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V={},C=i(561),S=i(940),x=i(43),U=(i(78),i(87)),R=i(405),A=i(331),H=i(545),z=i(917),q=i(39),E=i(31),I=i(15),G=i(603),F=i(524),W=function(){function e(t,i){var a=this;for(var r in Object(n.a)(this,e),this.owner=i,this.properties={},this.afterDispatchHandle=null,t){var s=t[r],o=new G.a(s,null,null,2,2);this.properties[r]={pool:o,acquired:[]}}this.afterDispatchHandle=Object(F.a)((function(){return a.release()}))}return Object(a.a)(e,[{key:"destroy",value:function(){for(var e in this.afterDispatchHandle&&(this.afterDispatchHandle.remove(),this.afterDispatchHandle=null),this.properties){var t,i=this.properties[e],n=Object(I.a)(i.acquired);try{for(n.s();!(t=n.n()).done;){var a=t.value;Object(F.b)(a)||i.pool.release(a)}}catch(r){n.e(r)}finally{n.f()}i.pool.destroy(),i.pool=null,i.acquired=null}this.properties=null,this.owner=null}},{key:"get",value:function(e){var t=this.owner._get(e),i=this.properties[e],n=i.pool.acquire();for(i.acquired.push(n);n===t;)i.acquired.push(n),n=i.pool.acquire();return n}},{key:"release",value:function(){for(var e in this.properties){var t,i=this.properties[e],n=0,a=Object(I.a)(i.acquired);try{for(a.s();!(t=a.n()).done;){var r=t.value;Object(F.b)(r)?i.acquired[n++]=r:i.pool.release(r)}}catch(s){a.e(s)}finally{a.f()}i.acquired.length=n}}}]),e}(),N=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).type="DirectLineMeasurement3D",e.visible=!0,e.settings=new B,e.measurement=null,e}return Object(a.a)(i,[{key:"destroy",value:function(){this.settings.destroy()}},{key:"startPoint",set:function(e){this.measurement=null,this._set("startPoint",Object(w.k)(e)?e.clone():null)}},{key:"endPoint",set:function(e){this.measurement=null,this._set("endPoint",Object(w.k)(e)?e.clone():null)}}]),i}(E.a);Object(c.a)([Object(d.b)()],N.prototype,"type",void 0),Object(c.a)([Object(d.b)()],N.prototype,"visible",void 0),Object(c.a)([Object(d.b)()],N.prototype,"settings",void 0),Object(c.a)([Object(d.b)({value:null})],N.prototype,"startPoint",null),Object(c.a)([Object(d.b)({value:null})],N.prototype,"endPoint",null),Object(c.a)([Object(d.b)()],N.prototype,"measurement",void 0),N=Object(c.a)([Object(b.a)("esri.views.3d.interactive.graphics.DirectLineMeasurement3D.DirectLineMeasurement3D")],N);var B=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).unit="metric",e}return i}(E.a);Object(c.a)([Object(d.b)({value:"metric"})],B.prototype,"unit",void 0),B=Object(c.a)([Object(b.a)("esri.views.3d.interactive.graphics.directLineMeasurement3D.Settings")],B);var J=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments))._handles=new k.a,e._propertiesPool=new W({startPoint:x.a,endPoint:x.a},Object(q.a)(e)),e.model=new N,e.cursorPoint=null,e.state="initial",e.active=!1,e.geodesicMeasurementDistanceThreshold=1e5,e}return Object(a.a)(i,[{key:"initialize",value:function(){this.sceneView.analyses.add(this.model),this.reset()}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null,this.sceneView.analyses.remove(this.model),this._propertiesPool.destroy(),this._propertiesPool=null,this.model.destroy()}},{key:"startPointSurfaceLocation",set:function(e){this._set("startPointSurfaceLocation",e)}},{key:"endPointSurfaceLocation",set:function(e){this._set("endPointSurfaceLocation",e)}},{key:"measurementSurfaceLocation",get:function(){var e=this.startPointSurfaceLocation,t=this.endPointSurfaceLocation;return null==e||null==t||"above-the-surface"===e&&"below-the-surface"===t||"below-the-surface"===e&&"above-the-surface"===t||"on-the-surface"===e&&"on-the-surface"===t?"camera-dependent":"above-the-surface"===e||"above-the-surface"===t?"above-the-surface":"below-the-surface"}},{key:"validMeasurement",get:function(){return Object(w.k)(this.model.startPoint)&&Object(w.k)(this.model.endPoint)}},{key:"isMeasuring",get:function(){return!!this.startPoint}},{key:"geodesicDistanceExceeded",get:function(){return Object(w.k)(this.model.measurement)&&this.model.measurement.horizontalDistance&&this.model.measurement.horizontalDistance.value>this.geodesicMeasurementDistanceThreshold}},{key:"reset",value:function(){this.clearMeasurement()}},{key:"clearMeasurement",value:function(){this.state="initial",this.startPoint=null,this.endPoint=null,this.cursorPoint=null,this._clearOverride("measurementSurfaceLocation")}},{key:"finishMeasurement",value:function(){if(!this._isOverridden("measurementSurfaceLocation")){var e=this.measurementSurfaceLocation,t="camera-dependent"===e?this.sceneView.state.camera.aboveGround?"above-the-surface":"below-the-surface":e;this._override("measurementSurfaceLocation",t)}this.state="measured"}}]),i}(E.a);Object(c.a)([Object(d.b)()],J.prototype,"messages",void 0),Object(c.a)([Object(d.b)({constructOnly:!0})],J.prototype,"sceneView",void 0),Object(c.a)([Object(d.b)()],J.prototype,"model",void 0),Object(c.a)([Object(h.a)("model.startPoint")],J.prototype,"startPoint",void 0),Object(c.a)([Object(d.b)({value:null})],J.prototype,"startPointSurfaceLocation",null),Object(c.a)([Object(h.a)("model.endPoint")],J.prototype,"endPoint",void 0),Object(c.a)([Object(d.b)({value:null})],J.prototype,"endPointSurfaceLocation",null),Object(c.a)([Object(d.b)()],J.prototype,"measurementSurfaceLocation",null),Object(c.a)([Object(d.b)()],J.prototype,"cursorPoint",void 0),Object(c.a)([Object(d.b)()],J.prototype,"state",void 0),Object(c.a)([Object(h.a)("model.settings.unit")],J.prototype,"unit",void 0),Object(c.a)([Object(d.b)()],J.prototype,"active",void 0),Object(c.a)([Object(d.b)({readOnly:!0})],J.prototype,"validMeasurement",null),Object(c.a)([Object(d.b)({readOnly:!0})],J.prototype,"isMeasuring",null),Object(c.a)([Object(d.b)()],J.prototype,"geodesicMeasurementDistanceThreshold",void 0),Object(c.a)([Object(d.b)({readOnly:!0})],J.prototype,"geodesicDistanceExceeded",null);var K,Q,X,Y=J=Object(c.a)([Object(b.a)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DModel")],J),Z=i(10),$=i(37),ee=i(26),te=i(391),ie=i(55),ne=i(1050),ae=i(552),re=i(923),se=i(941),oe={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5},le=K=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,{model:e.model}))._state="pending",a._visible=!1,a._laserLine=null,a._handles=new k.a,a._listenerHandles=null,a._cursorPosition=Object(ee.e)(),a._startPosition=Object(ee.e)(),a._endPosition=Object(ee.e)(),a._lastDraggedHandle=null,a.dataObjectView=null,a._view=e.model.sceneView,a._params=e.params?Object(se.a)(oe,e.params):Object(se.a)(oe,{}),a._intersector=new ne.a(a._view.state.mode),a._intersector.options.store=0,a}return Object(a.a)(i,[{key:"initialize",value:function(){var e=this,t=this.model.model,i=this._view.getAnalysisView(t);Object(w.k)(i)?this._initialize(i):this._view.whenAnalysisView(t).then((function(t){return e._initialize(t)}))}},{key:"_initialize",value:function(e){switch(this._state){case"pending":break;case"destroyed":return}this._set("dataObjectView",e),this._laserLine=new ae.a({view:this._view,attached:!0}),this._initializeListeners(),this._state="ready"}},{key:"destroy",value:function(){switch(this._state){case"pending":return void(this._state="destroyed");case"ready":break;case"destroyed":default:return}this.hide(),this._destroyListeners(),this._handles.destroy(),this._handles=null,this._laserLine.destroy(),this._laserLine=null,this._state="destroyed"}},{key:"requiresCursorPoint",get:function(){return"initial"===this.model.state&&this.model.active}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.show():this.hide()}},{key:"viewMode",get:function(){var e=this.dataObjectView;if(!Object(w.k)(e))return Q.None;switch(e.viewMode){default:case"none":return Q.None;case"segment":return Q.Direct;case"segment-and-triangle":return Q.Triangle;case"segment-and-projection":return Q.ProjectedGeodesic}}},{key:"testData",get:function(){var e=this._laserLine.testData;return Object(Z.a)(Object(Z.a)({},Object(w.k)(this.dataObjectView)?this.dataObjectView.testData:{labels:{direct:null,horizontal:null,vertical:null},stripeLength:1}),{},{laserLineRenderer:{heightManifoldEnabled:!!Object(w.k)(e)&&e.heightManifoldEnabled,heightManifoldTarget:Object(w.k)(e)?e.heightManifoldTarget:null,pointDistanceEnabled:!!Object(w.k)(e)&&e.pointDistanceEnabled,pointDistanceOrigin:Object(w.k)(e)?e.pointDistanceOrigin:null,pointDistanceTarget:Object(w.k)(e)?e.pointDistanceTarget:null,lineVerticalPlaneEnabled:!!Object(w.k)(e)&&e.lineVerticalPlaneEnabled}})}},{key:"directLabelText",get:function(){return Object(w.k)(this.dataObjectView)?this.dataObjectView.segmentLabel.text:null}},{key:"horizontalLabelText",get:function(){return Object(w.k)(this.dataObjectView)?this.dataObjectView.horizontalLabel.text:null}},{key:"verticalLabelText",get:function(){return Object(w.k)(this.dataObjectView)?this.dataObjectView.verticalLabel.text:null}},{key:"createManipulators",value:function(){var e=this,t=function(){var t=Object(re.e)(e._view,e._params.handleColor,e._params.handleOpacity);return t.available=!1,t.radius=e._params.handleRadius,t},i=t(),n=t();this.model.startPoint&&(i.location=Object(w.q)(this.model.startPoint),i.available=!0),this.model.endPoint&&(n.location=Object(w.q)(this.model.endPoint),n.available=!0);var a=function(){var t=e._lastDraggedHandle;i.grabbing&&!n.grabbing&&(t="start"),n.grabbing&&!i.grabbing&&(t="end"),i.grabbing||n.grabbing||(t=null);var a=t!==e._lastDraggedHandle;e._lastDraggedHandle=t,a&&e.visible&&e._updateLaserLine()};return this._handles.add([i.events.on("grab-changed",(function(){a()})),n.events.on("grab-changed",(function(){a()}))]),{start:i,end:n}}},{key:"show",value:function(){switch(this._state){case"ready":this._visible||(this._visible=!0,this.model.model.visible=!0,this._laserLine.style={innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,glowFalloff:this._params.laserLineGlowFalloff,globalAlpha:this._params.laserLineGlobalAlpha},this._laserLine.visible=!0,this._updateCursorPosition(),this._updateStartPosition(),this._updateEndPosition(),this._updateLaserLine());break;case"pending":this._visible=!0;break;case"destroyed":default:return}}},{key:"hide",value:function(){switch(this._state){case"ready":this._visible&&(this._visible=!1,this.model.model.visible=!1,this._laserLine.visible=!1,this._view.cursor=null);break;case"pending":this._visible=!1;break;case"destroyed":default:return}}},{key:"pick",value:function(e){var t=this._view.spatialReference,i=Object($.j)(e.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(i,this._intersector);var n=this._intersector.results.min,a=Object(ee.e)();if(!n.getIntersectionPoint(a))return new K.PickResult;var r=this._view.renderCoordsHelper.fromRenderCoords(a,t);if(Object(w.j)(r))return new K.PickResult;var s="TerrainRenderer"===n.intersector?"ground":"feature";return new K.PickResult(s,a,r)}},{key:"getElevation",value:function(e){return this._view.basemapTerrain.ready?Object(w.r)(Object(te.a)(this._view.elevationProvider,e),0):0}},{key:"overlappingHandles",value:function(e,t){return Object(se.c)(e,t,this._view)<=this._params.handleRadius}},{key:"_updateCursorPosition",value:function(){this.model.cursorPoint&&this._view.renderCoordsHelper.toRenderCoords(this.model.cursorPoint,this._cursorPosition)}},{key:"_updateStartPosition",value:function(){Object(w.k)(this.model.startPoint)&&this._view.renderCoordsHelper.toRenderCoords(this.model.startPoint,this._startPosition)}},{key:"_updateEndPosition",value:function(){Object(w.k)(this.model.endPoint)&&this._view.renderCoordsHelper.toRenderCoords(this.model.endPoint,this._endPosition)}},{key:"_getFocusPosition",value:function(){var e=this.model,t=this.viewMode===Q.Direct&&Object(w.k)(this.dataObjectView)&&"euclidean"===this.dataObjectView.visualizedMeasurement;switch(e.state){case"drawing":return t?this._startPosition:e.endPoint?this._endPosition:this._startPosition;case"editing":return t?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return e.cursorPoint?this._cursorPosition:null}}},{key:"_getFocusSpherePosition",value:function(){return"drawing"===this.model.state||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition}},{key:"_updateLaserLine",value:function(){var e=this.model,t=this._getFocusPosition(),i=this.viewMode,n=this.dataObjectView,a=this._params.laserLineEnabled&&!!t&&"measured"!==e.state&&e.active;if(a&&Object(w.k)(n)){var r="euclidean"===n.actualVisualizedMeasurement;this._laserLine.heightManifoldTarget=r?t:null;var s=a&&!!e.startPoint&&"geodesic"===n.actualVisualizedMeasurement;this._laserLine.pointDistanceLine=s?{origin:this._getFocusSpherePosition(),target:t}:null;var o=a&&i===Q.Triangle;this._laserLine.lineVerticalPlaneSegment=o?ie.d.fromPoints(this._startPosition,this._endPosition,ce):null}else this._laserLine.heightManifoldTarget=null,this._laserLine.pointDistanceLine=null,this._laserLine.lineVerticalPlaneSegment=null}},{key:"_initializeListeners",value:function(){var e=this;this._listenerHandles=new k.a,this._listenerHandles.add([this.model.watch("state",(function(t){Object(w.c)(e.dataObjectView,(function(e){e.allowVisualElementsOrientationChange="measured"!==t})),e._visible&&e._updateLaserLine()}),!0),this.model.watch("measurementMode",(function(){e._visible&&e._updateLaserLine()}),!0),this.model.watch("cursorPoint",(function(){e._updateCursorPosition(),e._visible&&e._updateLaserLine()}),!0),this.model.model.watch("startPoint",(function(){e._updateStartPosition(),e._visible&&e._updateLaserLine()}),!0),this.model.model.watch("endPoint",(function(){e._updateEndPosition(),e._visible&&e._updateLaserLine()}),!0),this.model.watch("active",(function(){e._visible&&e._updateLaserLine()}),!0)])}},{key:"_destroyListeners",value:function(){this._listenerHandles.destroy(),this._listenerHandles=null}}]),i}(E.a);Object(c.a)([Object(d.b)({readOnly:!0})],le.prototype,"dataObjectView",void 0),Object(c.a)([Object(d.b)({constructOnly:!0})],le.prototype,"model",void 0),Object(c.a)([Object(d.b)()],le.prototype,"directLabelText",null),Object(c.a)([Object(d.b)()],le.prototype,"horizontalLabelText",null),Object(c.a)([Object(d.b)()],le.prototype,"verticalLabelText",null),function(e){e.PickRequest=function e(){Object(n.a)(this,e)};e.PickResult=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(n.a)(this,e),this.type=t,this.scenePoint=i,this.mapPoint=a}}((le=K=Object(c.a)([Object(b.a)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],le))||(le={})),(X=Q||(Q={}))[X.Triangle=0]="Triangle",X[X.ProjectedGeodesic=1]="ProjectedGeodesic",X[X.Direct=2]="Direct",X[X.None=3]="None";var ce=ie.d.create(),ue=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e))._handles=new k.a,a._cachedPickRequest=new le.PickRequest,a._cachedPickResult=new le.PickResult,a._isAnyPointerDown=!1,a.deferCreation=!0,a.startManipulator=null,a.endManipulator=null,a.model=new Y({sceneView:e.view}),a}return Object(a.a)(i,[{key:"initialize",value:function(){var e=this,t=new le({model:this.model});this._set("directLineMeasurementView",t);var i=Object(P.a)(this,"state",(function(t){"ready"!==t&&e.create(),"measured"===t&&e.complete()}),!0);this._handles.add(i);var n=this.directLineMeasurementView.createManipulators(),a=n.start,r=n.end,s=function(t,i,n){return Object(A.e)(t,(function(t,a,r){var s=Object(z.a)(t);a.next(s).next(Object(z.b)(e.view)).next((function(e){return"start"!==e.action?e:null})).next((function(a){var r=Object(R.a)(a.mapEnd,de);e.model[i]=r,t.location=r,e.model[n]=e._surfaceLocation(r,a.surfaceType)})),r.next(s).next(Object(A.k)(e.model,[i,n])).next((function(){t.location=Object(w.q)(e.model[i])}))}))};this._handles.add([s(a,"startPoint","startPointSurfaceLocation"),s(r,"endPoint","endPointSurfaceLocation")]),[a,r].forEach((function(t){e._handles.add([t.events.on("grab-changed",(function(){var t=a.grabbing||r.grabbing;t&&"measured"===e.model.state&&(e.model.state="editing"),t||(e.model.finishMeasurement(),"editing"===e.model.state&&(e.model.state="measured"))}))])})),this.manipulators.add(a),this.manipulators.add(r),this.startManipulator=a,this.endManipulator=r}},{key:"destroy",value:function(){this.directLineMeasurementView.destroy(),this._set("directLineMeasurementView",null),this.model.destroy(),this._set("model",null),this._handles.destroy(),this._handles=null}},{key:"state",get:function(){var e;return null!=(e=this.model)&&e.isMeasuring?"measured"===this.model.state?"measured":"measuring":"ready"}},{key:"creating",get:function(){return"initial"===this.model.state||"drawing"===this.model.state}},{key:"isSupported",get:function(){return"3d"===this.get("view.type")}},{key:"cursor",get:function(){var e;return null==(e=this.model)||!e.active||"drawing"!==this.model.state&&"initial"!==this.model.state?null:"crosshair"}},{key:"activate",value:function(){this.model.active=!0}},{key:"deactivate",value:function(){this.model.active=!1}},{key:"onDetach",value:function(){this.model.reset()}},{key:"onShow",value:function(){this.directLineMeasurementView.show(),this._updateManipulatorVisibility()}},{key:"onHide",value:function(){this.directLineMeasurementView.hide()}},{key:"onInputEvent",value:function(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"pointer-down":this._handlePointerDown();break;case"pointer-up":this._handlePointerUp()}this._updateManipulatorVisibility()}},{key:"_handlePointerMove",value:function(e){this._clearCachedPickRequest();var t=Object(U.a)(e);"mouse"===e.pointerType&&(this._hoverAt(t),"drawing"===this.model.state&&(this.endManipulator.events.emit("drag",{action:"update",start:t,screenPoint:t}),e.stopPropagation()))}},{key:"_handlePointerDown",value:function(){this._isAnyPointerDown=!0}},{key:"_handlePointerUp",value:function(){this._isAnyPointerDown=!1}},{key:"_handleImmediateClick",value:function(e){if(this._clearCachedPickRequest(),function(e){return"mouse"!==e.pointerType||0===e.button}(e)){var t=Object(U.a)(e),i=e.pointerType,n=!1;if(this.model.active)switch(this.model.state){case"initial":this.startManipulator.events.emit("drag",{action:"start",pointerType:i,start:t,screenPoint:t}),this.startManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),this.model.startPoint&&(this.startManipulator.interactive=!1,this.endManipulator.interactive=!1,this.model.state="drawing",this.endManipulator.events.emit("drag",{action:"start",pointerType:i,start:t,screenPoint:t}),n=!0);break;case"drawing":this.endManipulator.events.emit("drag",{action:"update",start:t,screenPoint:t}),null!=this.model.endPoint&&(this.endManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),this.startManipulator.interactive=!0,this.endManipulator.interactive=!0,this.model.finishMeasurement(),n=!0)}n&&e.stopPropagation(),"mouse"===e.pointerType&&this._hoverAt(t)}}},{key:"_hoverAt",value:function(e){var t=this._isAnyPointerDown&&"drawing"!==this.model.state&&"editing"!==this.model.state;if(this.directLineMeasurementView.requiresCursorPoint&&!t){var i=this._pick(e);i.mapPoint&&(this.model.cursorPoint=i.mapPoint)}else this.model.cursorPoint=null}},{key:"_pick",value:function(e){var t=this._cachedPickRequest.screenPoint;return t&&t.x===e.x&&t.y===e.y||(this._cachedPickRequest.screenPoint=e,this._cachedPickResult=this.directLineMeasurementView.pick(this._cachedPickRequest)),this._cachedPickResult}},{key:"_clearCachedPickRequest",value:function(){this._cachedPickRequest.screenPoint=null}},{key:"_surfaceLocation",value:function(e,t){return 0===t?"on-the-surface":e.z>=this.directLineMeasurementView.getElevation(e)?"above-the-surface":"below-the-surface"}},{key:"_updateManipulatorVisibility",value:function(){this.startManipulator.available=null!=this.model.startPoint,this.endManipulator.available=null!=this.model.endPoint}}]),i}(H.a);Object(c.a)([Object(d.b)({readOnly:!0})],ue.prototype,"state",null),Object(c.a)([Object(d.b)({readOnly:!0})],ue.prototype,"creating",null),Object(c.a)([Object(d.b)({readOnly:!0})],ue.prototype,"isSupported",null),Object(c.a)([Object(d.b)({readOnly:!0})],ue.prototype,"cursor",null),Object(c.a)([Object(d.b)({constructOnly:!0})],ue.prototype,"model",void 0),Object(c.a)([Object(d.b)({constructOnly:!0})],ue.prototype,"directLineMeasurementView",void 0),Object(c.a)([Object(h.a)("model.mode")],ue.prototype,"mode",void 0),Object(c.a)([Object(h.a)("model.unit")],ue.prototype,"unit",void 0),Object(c.a)([Object(h.a)("model.validMeasurement")],ue.prototype,"validMeasurement",void 0),ue=Object(c.a)([Object(b.a)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],ue);var de=new x.a,he=ue,be=u.a.getLogger("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel"),pe=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(n.a)(this,i),(a=t.call(this,e)).supportedViewType="3d",a._handles=new k.a,a._userUnitOptions=null,a._userUnit=null,a}return Object(a.a)(i,[{key:"initialize",value:function(){var e=this;this._handles.add([Object(P.a)(this,"unit",(function(t){e.tool&&(e.tool.model.unit=t)}))])}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null}},{key:"state",get:function(){return this.isDisabled?"disabled":this.tool?this.tool.state:"ready"}},{key:"measurement",get:function(){if(!this.tool)return null;var e=this.tool.model,t=this.tool.directLineMeasurementView.dataObjectView;if(Object(w.j)(t))return{mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}};var i=t.actualVisualizedMeasurement,n=this.tool.directLineMeasurementView,a=Object(w.k)(e.model.measurement)?"available":"unavailable";switch(i){case"euclidean":return{mode:i,directDistance:{text:n.directLabelText,state:a},horizontalDistance:{text:n.horizontalLabelText,state:a},verticalDistance:{text:n.verticalLabelText,state:a}};case"geodesic":return{mode:i,directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:n.directLabelText,state:a},verticalDistance:{text:n.verticalLabelText,state:a}}}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)},set:function(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}},{key:"start",value:function(){return this.createTool()}},{key:"clear",value:function(){this.removeTool()}},{key:"createToolParams",value:function(){var e=this;return{toolConstructor:he,constructorArguments:function(){return{unit:e.unit}}}}},{key:"logUnsupportedError",value:function(){be.error("DirectLineMeasurement3D widget is not implemented for MapView")}},{key:"logError",value:function(){be.error.apply(be,arguments)}},{key:"_findSelectableUnit",value:function(e,t){var i=this.unitOptions;return-1!==i.indexOf(e)?e:t?this._findSelectableUnit(t):i[0]}},{key:"_filteredOrAllUnits",value:function(e){if(!e)return v.q.slice();var t=e.filter((function(e){return-1!==v.q.indexOf(e)}));return 0===t.length?v.q.slice():t}}],[{key:"preload",value:function(){var e=Object(g.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",L("DirectLineMeasurement3D"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),i}(S.a);Object(c.a)([Object(d.b)({readOnly:!0})],pe.prototype,"state",null),Object(c.a)([Object(d.b)({readOnly:!0})],pe.prototype,"measurement",null),Object(c.a)([Object(d.b)()],pe.prototype,"tool",void 0),Object(c.a)([Object(d.b)(C.a)],pe.prototype,"defaultUnit",void 0),Object(c.a)([Object(d.b)()],pe.prototype,"unitOptions",null),Object(c.a)([Object(d.b)()],pe.prototype,"unit",null);var ve=pe=Object(c.a)([Object(b.a)("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],pe),me="esri-direct-line-measurement-3d",Oe={buttonDisabled:"esri-button--disabled",base:"".concat(me," esri-widget esri-widget--panel"),container:"".concat(me,"__container"),hint:"".concat(me,"__hint"),hintText:"".concat(me,"__hint-text"),panelError:"".concat(me,"__panel--error"),measurement:"".concat(me,"__measurement"),measurementItem:"".concat(me,"__measurement-item"),measurementItemDisabled:"".concat(me,"__measurement-item--disabled"),measurementItemTitle:"".concat(me,"__measurement-item-title"),measurementItemValue:"".concat(me,"__measurement-item-value"),settings:"".concat(me,"__settings"),units:"".concat(me,"__units"),unitsLabel:"".concat(me,"__units-label"),unitsSelect:"".concat(me,"__units-select esri-select"),unitsSelectWrapper:"".concat(me,"__units-select-wrapper"),actionSection:"".concat(me,"__actions"),newMeasurementButton:"".concat(me,"__clear-button esri-button esri-button--primary"),widgetIcon:"esri-icon-measure-line"},je=function(e){Object(o.a)(i,e);var t=Object(l.a)(i);function i(e,a){var r;return Object(n.a)(this,i),(r=t.call(this,e,a)).view=null,r.visible=null,r.iconClass=Oe.widgetIcon,r.label=void 0,r.messages=null,r.messagesUnits=null,r.viewModel=new ve,r.unitOptions=null,r.unit=null,r}return Object(a.a)(i,[{key:"render",value:function(){var e=this,t=this.viewModel,i=t.isSupported,n=t.active,a=t.state,r=t.measurement,s=t.unit,o="disabled"===a,l="ready"===a,c="measuring"===a||"measured"===a,u=this.messages,d=this.messagesUnits,h=n&&l?Object(j.a)("section",{key:"esri-direct-line-measurement-3d__hint",class:Oe.hint},Object(j.a)("p",{class:Oe.hintText},u.hint)):null,b=i?null:Object(j.a)("section",{key:"esri-direct-line-measurement-3d__unsupported",class:Oe.panelError},Object(j.a)("p",null,u.unsupported)),p=function(t,i,n){switch(i.state){case"available":return Object(j.a)("div",{key:"".concat(n,"-enabled"),class:Oe.measurementItem},Object(j.a)("span",{class:Oe.measurementItemTitle},t),Object(j.a)("span",{class:Oe.measurementItemValue},i.text));case"unavailable":return Object(j.a)("div",{key:"".concat(n,"-disabled"),class:e.classes(Oe.measurementItem,Oe.measurementItemDisabled)},Object(j.a)("span",{class:Oe.measurementItemTitle},t))}},m=c?Object(j.a)("section",{key:"esri-direct-line-measurement-3d__measurement",class:Oe.measurement},p(u.direct,r.directDistance,"direct"),p(u.horizontal,r.horizontalDistance,"horizontal"),p(u.vertical,r.verticalDistance,"vertical")):null,O="".concat(this.id,"__units"),f=Object(j.a)("label",{class:Oe.unitsLabel,for:O},u.unit),_=Object(j.a)("div",{class:Oe.unitsSelectWrapper},Object(j.a)("select",{class:Oe.unitsSelect,id:O,onchange:this._changeUnit,bind:this,value:s},this.viewModel.unitOptions.map((function(e){var t;return Object(j.a)("option",{key:e,value:e},Object(v.l)(e)?d.systems[e]:null==(t=d.units[e])?void 0:t.pluralCapitalized)})))),y=Object(j.a)("section",{key:"esri-direct-line-measurement-3d__units",class:Oe.units},f,_),g=c?Object(j.a)("div",{key:"settings",class:Oe.settings},y):null,w=!i||n&&!c?null:Object(j.a)("div",{class:Oe.actionSection},Object(j.a)("button",{disabled:o,class:this.classes(Oe.newMeasurementButton,o&&Oe.buttonDisabled),bind:this,onclick:this._newMeasurement,type:"button"},u.newMeasurement)),k=this.visible?Object(j.a)("div",{class:Oe.container},b,h,g,m,w):null;return Object(j.a)("div",{key:this,class:Oe.base,role:"presentation"},k)}},{key:"_newMeasurement",value:function(){Object(p.l)(this.viewModel.start())}},{key:"_changeUnit",value:function(e){var t=e.target,i=t.options[t.selectedIndex];i&&(this.unit=i.value)}},{key:"beforeFirstRender",value:function(){var e=this;return ve.preload().then((function(){return Object(r.a)(Object(s.a)(i.prototype),"beforeFirstRender",e).call(e)}))}}]),i}(f.a);Object(c.a)([Object(h.a)("viewModel.view")],je.prototype,"view",void 0),Object(c.a)([Object(h.a)("viewModel.visible")],je.prototype,"visible",void 0),Object(c.a)([Object(h.a)("viewModel.active")],je.prototype,"active",void 0),Object(c.a)([Object(d.b)()],je.prototype,"iconClass",void 0),Object(c.a)([Object(d.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],je.prototype,"label",void 0),Object(c.a)([Object(d.b)(),Object(O.a)("esri/widgets/DirectLineMeasurement3D/t9n/DirectLineMeasurement3D")],je.prototype,"messages",void 0),Object(c.a)([Object(d.b)(),Object(O.a)("esri/core/t9n/Units")],je.prototype,"messagesUnits",void 0),Object(c.a)([Object(d.b)({type:ve})],je.prototype,"viewModel",void 0),Object(c.a)([Object(h.a)("viewModel.unitOptions")],je.prototype,"unitOptions",void 0),Object(c.a)([Object(h.a)("viewModel.unit")],je.prototype,"unit",void 0),Object(c.a)([Object(m.a)()],je.prototype,"_newMeasurement",null),Object(c.a)([Object(m.a)()],je.prototype,"_changeUnit",null);var fe=je=Object(c.a)([Object(b.a)("esri.widgets.DirectLineMeasurement3D")],je);t.default=fe},940:function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i(7),a=i.n(n),r=i(10),s=i(16),o=i(15),l=i(2),c=i(3),u=i(4),d=i(5),h=i(0),b=(i(14),i(12),i(17),i(1)),p=i(8),v=i(20),m=(i(11),i(18),i(19),i(31)),O=i(49),j=i(25),f=i(197),_=function(e){Object(u.a)(i,e);var t=Object(d.a)(i);function i(e){var n;return Object(l.a)(this,i),(n=t.call(this,e)).tool=null,n._baseHandles=new O.a,n._loggedUnsupportedErrorOnce=!1,n._creationAbortController=null,e&&null!=e.visible&&(n.visible=e.visible),n}return Object(c.a)(i,[{key:"initialize",value:function(){var e=this;this._baseHandles.add(Object(j.a)(this,["view.ready","isSupported"],(function(){e.view&&e.view.ready&&!e.isSupported?e._loggedUnsupportedErrorOnce||(e.logUnsupportedError(),e._loggedUnsupportedErrorOnce=!0):e._loggedUnsupportedErrorOnce=!1})))}},{key:"destroy",value:function(){this.removeTool(),this.view=null,this._baseHandles.destroy(),this._baseHandles=null}},{key:"isSupported",get:function(){return!this.view||this.view.type===this.supportedViewType}},{key:"view",get:function(){return this._get("view")},set:function(e){var t=this;if(e!==this.view){this.removeTool(),this._set("view",e);var i="tools";this._baseHandles.remove(i),e&&this._baseHandles.add(e.tools.on("change",(function(e){if(t.tool){var i,n=Object(o.a)(e.removed);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(t.tool===a){a.destroyed||a.destroy(),t._set("tool",null);break}}}catch(r){n.e(r)}finally{n.f()}}})),i)}}},{key:"visible",set:function(e){this._set("visible",e),this.tool&&(this.tool.visible=e),!e&&this._creationAbortController&&(this._creationAbortController.abort(),this._creationAbortController=null)}},{key:"active",get:function(){return null!=this._creationAbortController||null!=this.tool&&this.tool.active}},{key:"isDisabled",get:function(){return!this.view||!this.view.ready||!this.isSupported}},{key:"creatingTool",get:function(){return!!this._creationAbortController}},{key:"createTool",value:function(){var e=Object(s.a)(a.a.mark((function e(){var t,i,n,s,o,l,c=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.removeTool(),this.isSupported){e.next=2;break}return e.abrupt("return",Promise.reject(new v.a("tool:create","The view does not support the tool")));case 2:return t=this.createToolParams(),i=function(){var e=Object(f.b)(t.constructorArguments);return Object(r.a)({visible:c.visible},e)},n=new AbortController,s=n.signal,this._creationAbortController=n,o=function(){n===c._creationAbortController&&(c._creationAbortController=null)},e.prev=5,e.next=8,this.view.createTool(t.toolConstructor,i,{signal:s});case 8:l=e.sent,this._set("tool",l),o(),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(5),o(),e.t0;case 15:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"removeTool",value:function(){this._creationAbortController&&this._creationAbortController.abort(),this._creationAbortController=null;var e=this.tool;e&&(this.view&&this.view.tools&&this.view.tools.remove(e),e.destroyed||e.destroy(),this._set("tool",null))}}]),i}(m.a);Object(h.a)([Object(b.b)({constructOnly:!0})],_.prototype,"tool",void 0),Object(h.a)([Object(b.b)()],_.prototype,"isSupported",null),Object(h.a)([Object(b.b)({value:null})],_.prototype,"view",null),Object(h.a)([Object(b.b)({type:Boolean,value:!0})],_.prototype,"visible",null),Object(h.a)([Object(b.b)()],_.prototype,"active",null),Object(h.a)([Object(b.b)()],_.prototype,"isDisabled",null),Object(h.a)([Object(b.b)()],_.prototype,"_creationAbortController",void 0),Object(h.a)([Object(b.b)({readOnly:!0})],_.prototype,"creatingTool",null),_=Object(h.a)([Object(p.a)("esri.widgets.support.InteractiveToolViewModel")],_)},941:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return p})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return h}));var n=i(10),a=i(21),r=i(37),s=i(26),o=i(13),l=(i(82),i(34));Object(s.e)();function c(e,t){return Object(n.a)(Object(n.a)({},e),Object(a.a)(t))}function u(e,t,i,n){for(;e.length<t;)e.push(i());if(n)for(;e.length>t;)n(e.pop());else e.length=t}function d(e,t){if(Object(o.v)(t,0,0,0),e.length>0){for(var i=0;i<e.length;++i)Object(o.e)(t,t,e[i]);Object(o.d)(t,t,1/e.length)}}function h(e,t,i,n){n.projectToRenderScreen(e,O),n.projectToRenderScreen(t,f),Object(l.d)(i,_,j),Object(l.e)(i,i)}function b(e,t,i){var n=i.state.camera;i.renderCoordsHelper.toRenderCoords(e,v),n.projectToRenderScreen(v,m),i.state.camera.renderToScreen(m,t)}function p(e,t,i){return b(e,y,i),b(t,g,i),Object(l.i)(y,g)}var v=Object(s.e)(),m=Object(r.e)(),O=Object(r.e)(),j=O,f=Object(r.e)(),_=f,y=(Object(r.g)(),Object(r.g)()),g=Object(r.g)()}}]);
//# sourceMappingURL=101.a020c398.chunk.js.map