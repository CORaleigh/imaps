{"version":3,"sources":["../node_modules/@arcgis/core/views/2d/layers/features/FeatureStore2D.js","../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFIndirect.js","../node_modules/@arcgis/core/views/2d/arcade/callExpressionWithCursor.js","../node_modules/@arcgis/core/views/2d/layers/features/Store2D.js","../node_modules/@arcgis/core/core/CircularArray.js"],"names":["h","t","e","c","I","u","getObjectId","getAttributes","readAttributes","getAttribute","readAttribute","cloneWithGeometry","getGeometry","readHydratedGeometry","getCentroid","readCentroid","l","s","featureAdapter","events","a","_featureSetsByInstance","Map","_objectIdToDisplayId","_spatialIndexInvalid","_indexSearchCache","r","_index","n","minX","_storage","getXMin","minY","getYMin","maxX","getXMax","maxY","getYMax","mode","featureCount","vertexCount","this","forEach","releaseDisplayId","clear","has","addOrUpdate","attachStorage","getCursor","next","getDisplayId","setComputedAttributes","scale","set","instance","_insertFeature","emit","_rebuildIndex","id","find","tileId","readers","i","_searchIndex","bounds","getInstanceId","get","push","d","from","enqueue","getIndex","createDisplayId","setDisplayId","setInstanceId","delete","removeAtIndex","isEmpty","_lookupFeature","_getFeatureSet","setIndex","lookupFeatureByDisplayId","readGeometry","unsetAttributeData","search","setBounds","load","o","createInstance","_currentIndex","_reader","_indices","length","copy","_nextIndex","_passesFilter","_getExists","setArcadeSpatialReference","geometryType","hasFeatures","exceededTransferLimit","hasZ","hasM","getStorage","getComputedNumericAtIndex","setComputedNumericAtIndex","getComputedStringAtIndex","setComputedStringAtIndex","transform","extent","hasFilter","joinAttributes","readArcadeFeature","geometry","hasField","setField","keys","castToText","getQuantizationTransform","getAttributeHash","getGroupId","setGroupId","getXHydrate","getYHydrate","getX","getY","readLegacyFeature","readOptimizedFeature","readLegacyPointGeometry","readLegacyGeometry","readLegacyCentroid","readGeometryArea","readUnquantizedGeometry","Error","referencesGeometry","evaluate","$feature","getLogger","warn","_canCacheExpressionValue","_sourceInfo","_bitsets","computed","getBitset","createBitset","_schema","console","debug","targets","name","attributes","p","type","_createArcadeComputedField","_createLabelArcadeComputedField","Promise","all","_computedFields","some","expression","referencesScale","_statisticFields","_evaluateField","resultType","fieldIndex","spatialReference","fieldsIndex","valueExpression","fields","createLabelFunction","label","builder","$view","Number","POSITIVE_INFINITY","size","_start","maxSize","_buffer","isFinite","Array","dequeue"],"mappings":"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","file":"static/js/31.7e78ddb9.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{isNone as t,isSome as e,unwrap as s}from\"../../../../core/maybe.js\";import a from\"../../../../core/Evented.js\";import r from\"../../../../core/CircularArray.js\";import{fromRect as i}from\"../../../../geometry/support/aaBoundingBox.js\";import{r as n}from\"../../../../chunks/rbush.js\";import{Store2D as o}from\"./Store2D.js\";import{FeatureSetReaderIndirect as d}from\"./support/FeatureSetReaderPBFIndirect.js\";function h(t,e){return t<<16|e}function c(t){return(4294901760&t)>>>16}function I(t){return 65535&t}const u={getObjectId:t=>t.getObjectId(),getAttributes:t=>t.readAttributes(),getAttribute:(t,e)=>t.readAttribute(e),cloneWithGeometry:(t,e)=>t,getGeometry:t=>t.readHydratedGeometry(),getCentroid:(t,e)=>t.readCentroid()};class l extends o{constructor(t,e,s){super(t,e),this.featureAdapter=u,this.events=new a,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new r(50),this._index=n(9,(t=>({minX:this._storage.getXMin(t),minY:this._storage.getYMin(t),maxX:this._storage.getXMax(t),maxY:this._storage.getYMax(t)}))),this._storage=e,this.mode=s}get storeStatistics(){return{featureCount:0,vertexCount:0}}clear(){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach((t=>this._storage.releaseDisplayId(t))),this._objectIdToDisplayId.clear(),this._featureSetsByInstance.clear()}hasInstance(t){return this._featureSetsByInstance.has(t)}onTileData(e,s){if(t(s.addOrUpdate))return s;if(s.addOrUpdate.attachStorage(this._storage),\"snapshot\"===this.mode){const t=s.addOrUpdate.getCursor();for(;t.next();){const s=t.getDisplayId();this.setComputedAttributes(this._storage,t,s,e.scale)}return s}this._featureSetsByInstance.set(s.addOrUpdate.instance,s.addOrUpdate);const a=s.addOrUpdate.getCursor();for(;a.next();)this._insertFeature(a,e.scale);return this._spatialIndexInvalid=!0,this.events.emit(\"changed\"),s}search(t){this._rebuildIndex();const s=t.id,a=this._indexSearchCache.find((t=>t.tileId===s));if(e(a))return a.readers;const r=new Map,i=this._searchIndex(t.bounds),n=[];for(const e of i){const t=this._storage.getInstanceId(e),s=c(t),a=I(t);r.has(s)||r.set(s,[]);r.get(s).push(a)}return r.forEach(((t,e)=>{const s=this._featureSetsByInstance.get(e);n.push(d.from(s,t))})),this._indexSearchCache.enqueue({tileId:s,readers:n}),n}insert(t){const e=t.getCursor(),s=this._storage;for(;e.next();){const t=h(e.instance,e.getIndex()),a=this._storage.createDisplayId(),r=e.getObjectId();e.setDisplayId(a),s.setInstanceId(a,t),this._objectIdToDisplayId.set(r,a)}this._featureSetsByInstance.set(t.instance,t),this._spatialIndexInvalid=!0}remove(t){const e=this._objectIdToDisplayId.get(t);if(!e)return;const s=this._storage.getInstanceId(e),a=I(s),r=c(s),i=this._featureSetsByInstance.get(r);this._objectIdToDisplayId.delete(t),this._storage.releaseDisplayId(e),i.removeAtIndex(a),i.isEmpty&&this._featureSetsByInstance.delete(r),this._spatialIndexInvalid=!0}forEach(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=this._lookupFeature(s);t(a)}))}forEachUnsafe(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=c(s),r=I(s),i=this._getFeatureSet(a);i.setIndex(r),t(i)}))}forEachInBounds(t,e){const a=this._searchIndex(t);for(const r of a){const t=this.lookupFeatureByDisplayId(r,this._storage);e(s(t))}}forEachBounds(t,e,s){this._rebuildIndex();const a=[0,0,0,0];for(const r of t){if(!r.readGeometry())continue;const t=r.getDisplayId();a[0]=this._storage.getXMin(t),a[1]=this._storage.getYMin(t),a[2]=this._storage.getXMax(t),a[3]=this._storage.getYMax(t),e(i(s,a))}}sweepFeatures(t,e,s){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach(((a,r)=>{t.has(a)||(e.releaseDisplayId(a),s.unsetAttributeData(a),this._objectIdToDisplayId.delete(r))})),this.events.emit(\"changed\")}sweepFeatureSets(t){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach(((e,s)=>{t.has(s)||this._featureSetsByInstance.delete(s)}))}lookupObjectId(e,s){const a=this.lookupFeatureByDisplayId(e,s);return t(a)?null:a.getObjectId()}lookupDisplayId(t){return this._objectIdToDisplayId.get(t)}lookupFeatureByDisplayId(t,e){const s=e.getInstanceId(t);return this._lookupFeature(s)}lookupByDisplayIdUnsafe(t){const e=this._storage.getInstanceId(t),s=c(e),a=I(e),r=this._getFeatureSet(s);return r?(r.setIndex(a),r):null}_insertFeature(t,e){const s=this._storage,a=t.getObjectId(),r=h(t.instance,t.getIndex());s.getInstanceId(t.getDisplayId());let i=this._objectIdToDisplayId.get(a);i||(i=s.createDisplayId(),this._objectIdToDisplayId.set(a,i),this._spatialIndexInvalid=!0),t.setDisplayId(i),s.setInstanceId(i,r),this.setComputedAttributes(s,t,i,e)}_searchIndex(t){this._rebuildIndex();const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this._index.search(e)}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const t=[];\"snapshot\"===this.mode?this._featureSetsByInstance.forEach((e=>{const s=e.getCursor();for(;s.next();){const e=s.getDisplayId();this._storage.setBounds(e,s)&&t.push(e)}})):this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e);this._storage.setBounds(e,this._lookupFeature(s))&&t.push(e)})),this._index.clear(),this._index.load(t),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(t){const e=c(t),s=I(t),a=this._getFeatureSet(e);if(!a)return null;const r=a.getCursor();return r.setIndex(s),r}_getFeatureSet(t){return this._featureSetsByInstance.get(t)}}export{l as FeatureStore2D,u as featureAdapter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{FeatureSetReader as e}from\"./FeatureSetReader.js\";class r extends e{constructor(r,t){super(e.createInstance()),this._currentIndex=-1,this._reader=r,this._indices=t}static from(e,t){return new r(e.copy(),t)}get hasNext(){return this._currentIndex+1<this._indices.length}getApproximateSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new r(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e}next(){for(;this._nextIndex()&&!this._reader._passesFilter()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(e){this._reader.setArcadeSpatialReference(e)}attachStorage(e){this._reader.attachStorage(e)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}getStorage(){return this._reader.getStorage()}getComputedNumeric(e){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(e,r){return this._reader.setComputedNumericAtIndex(r,0)}getComputedString(e){return this._reader.getComputedStringAtIndex(0)}setComputedString(e,r){return this._reader.setComputedStringAtIndex(0,r)}getComputedNumericAtIndex(e){return this._reader.getComputedNumericAtIndex(e)}setComputedNumericAtIndex(e,r){this._reader.setComputedNumericAtIndex(e,r)}getComputedStringAtIndex(e){return this._reader.getComputedStringAtIndex(e)}setComputedStringAtIndex(e,r){return this._reader.setComputedStringAtIndex(e,r)}transform(e,r,t,d){const a=this.copy();return a._reader=this._reader.transform(e,r,t,d),a}extent(e,r,t,d){const a=this.copy();return a._reader=this._reader.extent(e,r,t,d),a}hasFilter(){return this._reader.hasFilter()}readAttribute(e,r=!1){return this._reader.readAttribute(e,r)}readAttributes(){return this._reader.readAttributes()}joinAttributes(e){return this._reader.joinAttributes(e)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this.readAttribute(e,!0)}hasField(e){return this._reader.hasField(e)}setField(e,r){return this._reader.setField(e,r)}keys(){return this._reader.keys()}castToText(){return this._reader.castToText()}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}getGroupId(){return this._reader.getGroupId()}setGroupId(e){return this._reader.setGroupId(e)}getXHydrate(){return this._reader.getXHydrate()}getYHydrate(){return this._reader.getYHydrate()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_passesFilter(){return this._reader._passesFilter()}_readAttribute(e,r){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}_readAttributes(){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}}export{r as FeatureSetReaderIndirect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Logger.js\";function r(r,a,t){r.referencesGeometry();const n=a.readArcadeFeature();try{return r.evaluate({...t,$feature:n})}catch(o){return e.getLogger(\"esri.views.2d.support.arcadeOnDemand\").warn(\"Feature arcade evaluation failed:\",o),null}}export default r;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/has.js\";import{isNone as s}from\"../../../../core/maybe.js\";import{createRendererExpression as t}from\"../../../../support/arcadeOnDemand.js\";import{diff as i,hasDiff as a}from\"../../../../core/accessorSupport/diffUtils.js\";import r from\"../../arcade/callExpressionWithCursor.js\";const c=import(\"../../../../layers/support/labelFormatUtils.js\");class o{constructor(e,s){this._canCacheExpressionValue=!1,this._sourceInfo=e,this._bitsets={computed:s.getBitset(s.createBitset())}}invalidate(){this._bitsets.computed.clear()}async updateSchema(t,r){const c=i(this._schema,r);if(this._schema=r,!r||s(c)||!a(c,\"attributes\"))return;e(\"esri-2d-update-debug\")&&console.debug(\"Applying Update - Store:\",c),this._bitsets.computed.clear(),t.targets[r.name]=!0;const o=r.attributes,n=[],p=[];for(const e in o){const s=o[e];switch(s.type){case\"field\":break;case\"expression\":n.push(this._createArcadeComputedField(s));break;case\"label-expression\":n.push(this._createLabelArcadeComputedField(s));break;case\"statistic\":p.push(s)}}this._computedFields=await Promise.all(n),this._canCacheExpressionValue=!this._computedFields.some((e=>\"expression\"===e.type&&e.expression.referencesScale())),this._statisticFields=p}setComputedAttributes(e,s,t,i){const a=this._bitsets.computed;if(!this._canCacheExpressionValue||!a.has(t)){a.set(t);for(const a of this._computedFields){const r=this._evaluateField(s,a,i);switch(a.resultType){case\"numeric\":e.setComputedNumericAtIndex(t,a.fieldIndex,r);break;case\"string\":e.setComputedStringAtIndex(t,a.fieldIndex,r)}}}}async _createArcadeComputedField(e){const s=this._sourceInfo.spatialReference,i=this._sourceInfo.fieldsIndex;return{...e,expression:await t(e.valueExpression,s,i)}}async _createLabelArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fields,{createLabelFunction:i}=await c,a=await i(e.label,t,s);return{...e,builder:a}}_evaluateField(e,s,t){switch(s.type){case\"label-expression\":{const t=e.readArcadeFeature();return s.builder.evaluate(t)||\"\"}case\"expression\":{const{expression:i}=s;return r(i,e,{$view:{scale:t}})}}}}export{o as Store2D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"./maybe.js\";class s{constructor(t=Number.POSITIVE_INFINITY){this.size=0,this._start=0,this.maxSize=t,this._buffer=isFinite(t)?new Array(t):[]}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const s=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,s}return isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=t:this._buffer[this._start+this.size++]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}find(s){if(0===this.size)return null;for(const i of this._buffer)if(t(i)&&s(i))return i;return null}clear(s){let i=this.dequeue();for(;t(i);)s&&s(i),i=this.dequeue()}}export default s;\n"],"sourceRoot":""}