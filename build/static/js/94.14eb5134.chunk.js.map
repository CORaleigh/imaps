{"version":3,"sources":["../node_modules/@arcgis/core/views/3d/interactive/measurementTools/support/UnitNormalizer.js","../node_modules/@arcgis/core/views/3d/interactive/graphics/DirectLineMeasurement3D/DirectLineMeasurement3DController.js","../node_modules/@arcgis/core/core/Quantity.js"],"names":["t","e","this","spatialReference","_spatialReference","_updateNormalizationFactors","_metersPerDistanceUnit","_metersPerElevationUnit","_squareMetersPerAreaUnit","y","_tempStartPosition","m","_tempEndPosition","_tempCornerPosition","_unitNormalizer","M","_handles","p","add","f","view","_initialize","d","s","u","j","_sphericalPCPF","i","_","dataObject","watch","_updateMeasurement","startPoint","endPoint","measurement","_euclideanDistances","r","_exactGeodesicDistanceAndAngle","horizontal","value","directDistance","direct","horizontalDistance","verticalDistance","vertical","geodesicDistance","distance","geodesicAngle","angle","z","clone","o","a","n","c","g","l","Math","abs","h","normalizeDistance","paths","isGeographic","w","v","isWebMercator","P","_fallbackGeodesicAngle","_fallbackGeodesicDistance","metersPerDegree","b","k","A","sin","cos","D","prototype","measure","unit","toUnit"],"mappings":"4HAI+EA,E,WAAE,aAAmB,IAAPC,EAAO,uDAAL,KAAK,oBAACC,KAAKC,iBAAiBF,E,kDAAE,WAAuB,OAAOC,KAAKE,mB,IAAkB,SAAqBH,GAAGA,IAAIC,KAAKE,oBAAoBF,KAAKE,kBAAkBH,EAAEC,KAAKG,iC,+BAA+B,SAAkBJ,GAAG,OAAOA,EAAEC,KAAKI,yB,gCAAuB,SAAmBL,GAAG,OAAOA,EAAEC,KAAKK,0B,2BAAwB,SAAcN,GAAG,OAAOA,EAAEC,KAAKM,2B,yCAAyB,WAA8BN,KAAKI,uBAAuBL,YAAEC,KAAKE,kBAAkB,GAAGF,KAAKK,wBAAwBN,YAAEC,KAAKE,kBAAkB,GAAGF,KAAKM,yBAAyBN,KAAKI,uBAAuBJ,KAAKI,2B,KAAuCN,O,gUCAw2BS,EAAC,kDAAiB,WAAYR,GAAE,kCAAC,cAAMA,IAAQS,mBAAmBC,cAAI,EAAKC,iBAAiBD,cAAI,EAAKE,oBAAoBF,cAAI,EAAKG,gBAAgB,IAAIC,IAAE,EAAKC,SAAS,IAAIC,IAA1I,EAA/B,8CAA2K,WAAY,WAACf,KAAKc,SAASE,IAAIC,YAAEjB,KAAKkB,KAAK,SAAS,kBAAI,EAAKC,iBAAe,MAAvP,yBAA4P,WAAa,WAAOpB,EAAEC,KAAKkB,KAAKjB,iBAAiBH,EAAEsB,YAAErB,GAAGsB,EAAEvB,IAAIwB,IAAEC,IAAEzB,EAAEE,KAAKwB,eAAeH,EAAE,IAAMI,EAAEC,YAAE3B,EAAEsB,GAAGrB,KAAKY,gBAAgBX,iBAAiBwB,EAAEJ,EAAEtB,EAAEC,KAAKc,SAASE,IAAI,CAAChB,KAAK2B,WAAWC,MAAM,cAAc,kBAAI,EAAKC,wBAAsB,GAAI7B,KAAK2B,WAAWC,MAAM,YAAY,kBAAI,EAAKC,wBAAsB,GAAI7B,KAAK2B,WAAWC,MAAM,YAAY,kBAAI,EAAKC,wBAAsB,IAAK,SAAS7B,KAAK6B,uBAApoB,gCAAypB,WAAqB,IAAM9B,EAAEC,KAAK2B,WAAWG,WAAWT,EAAErB,KAAK2B,WAAWI,SAAS,GAAGjC,YAAEC,IAAID,YAAEuB,GAAerB,KAAK2B,WAAWK,YAAY,SAAtD,CAA4D,IAAMP,EAAEzB,KAAKiC,oBAAoBlC,EAAEsB,GAAGa,EAAElC,KAAKmC,+BAA+BpC,EAAEsB,EAAEI,EAAEW,WAAWC,OAAOrC,KAAK2B,WAAWK,YAAY,CAACM,eAAeb,EAAEc,OAAOC,mBAAmBf,EAAEW,WAAWK,iBAAiBhB,EAAEiB,SAASC,iBAAiBT,EAAEU,SAASC,cAAcX,EAAEY,UAAziC,iCAAgjC,SAAoB/C,EAAED,GAAE,WAACC,EAAEgD,EAAEjD,EAAEiD,IAAIhD,EAAE,CAACA,EAAEA,EAAED,GAAG,IAAI,IAAMuB,EAAEtB,EAAEiD,QAAQ3B,EAAE0B,EAAEjD,EAAEiD,EAAE,IAAMtB,EAAEzB,KAAKQ,mBAAmB0B,EAAElC,KAAKU,iBAAiBuC,EAAEjD,KAAKW,oBAAoBuC,EAAElD,KAAKkB,KAAKjB,iBAAiBkD,EAAEnD,KAAKwB,eAAe4B,EAAE1B,YAAEwB,EAAEC,GAAGA,EAAED,EAAEG,YAAEtD,EAAE0B,EAAE2B,GAAGC,YAAEvD,EAAEoC,EAAEkB,GAAGC,YAAEhC,EAAE4B,EAAEG,GAAG,IAAM3C,EAAE6C,YAAE7B,EAAES,GAAGnB,EAAEuC,YAAEL,EAAEf,GAAGd,EAAEmC,KAAKC,IAAI1D,EAAEiD,EAAEhD,EAAEgD,GAAGU,EAAE,SAAA1D,GAAC,OAAE,EAAKa,gBAAgB8C,kBAAkB3D,IAAGuB,EAAEmC,EAAEhD,GAAGc,EAAEkC,EAAE1C,GAAGE,EAAEwC,EAAErC,GAAG,MAAM,CAACmB,OAAO,IAAIQ,IAAEzB,EAAE,UAAUc,WAAW,IAAIW,IAAExB,EAAE,UAAUmB,SAAS,IAAIK,IAAE9B,EAAE,aAAv+C,4CAAk/C,SAA+BlB,EAAED,EAAEuB,GAAS,IAAAI,EAAE1B,EAAEE,iBAAiBiC,EAAE,IAAIe,IAAE,CAACU,MAAM,CAAC5D,EAAED,GAAGG,iBAAiBwB,IAAIyB,EAAEzB,EAAEmC,cAAcC,YAAEpC,GAAGqC,YAAE,CAAC5B,GAAG,UAAU,GAAGT,EAAEsC,cAAcC,yBAAE9B,EAAE,eAAU,EAAvI,EAAmKgB,EAAE,CAACN,SAASM,EAAEJ,MAAM9C,KAAKiE,uBAAuBf,EAAEzB,IAAIzB,KAAKkE,0BAA0BnE,EAAED,EAAEuB,GAApG8B,EAAxJ,EAA+IP,SAAiBQ,EAAhK,EAA0JN,MAAqG,MAAM,CAACF,SAAS,IAAIG,IAAEI,EAAE,UAAUL,MAAM,IAAIC,IAAEK,EAAE,cAA70D,oCAAy1D,SAAuBrD,EAAED,GAAG,OAAOC,EAAE0D,YAAE3D,GAAGqE,kBAAn4D,uCAAm5D,SAA0BpE,EAAED,EAAEuB,GAAG,GAAG+C,YAAErE,EAAEsE,GAAG,CAACD,YAAEtE,EAAEwE,GAAG,IAAMvE,EAAEqD,YAAEiB,EAAE,IAAIhD,EAAE+B,YAAEiB,EAAE,IAAI5C,EAAE2B,YAAEkB,EAAE,IAAIpC,EAAEkB,YAAEkB,EAAE,IAAIrB,EAAEM,KAAKC,IAAI/B,EAAE1B,GAAGU,EAAE0C,YAAEI,KAAKgB,IAAIlD,GAAGkC,KAAKgB,IAAIrC,GAAGqB,KAAKiB,IAAInD,GAAGkC,KAAKiB,IAAItC,GAAGqB,KAAKiB,IAAIvB,IAAIK,EAAEJ,YAAEzC,GAAGM,EAAE,CAAC6B,SAAS,GAAG,OAAO6B,YAAE1D,EAAE,CAACsD,EAAE,GAAGA,EAAE,IAAI,CAACC,EAAE,GAAGA,EAAE,KAAK,CAAC1B,SAAS7B,EAAE6B,SAASE,MAAMQ,GAAI,IAAMxD,EAAEC,EAAEE,iBAAiBwB,EAAEJ,EAAE,MAAM,CAACuB,SAASnB,EAAEqB,MAAM9C,KAAKiE,uBAAuBxC,EAAE3B,QAAnvE,GAAeoC,KAA2uEnC,YAAE,CAACsB,eAAKd,EAAEmE,UAAU,YAAO,GAAQ3E,YAAE,CAACsB,eAAKd,EAAEmE,UAAU,kBAAa,GAAQnE,EAAER,YAAE,CAAC0B,YAAE,iGAAiGlB,GAAG,IAAM8D,EAAE5D,cAAI6D,EAAE7D,e,2DCAn4HV,E,WAAE,WAAY0B,EAAEJ,GAAE,oBAACrB,KAAK2E,QAAQ7E,YAAEuB,GAAGrB,KAAKqC,MAAMZ,EAAEzB,KAAK4E,KAAKvD,E,4CAAE,WAAiB,OAAOI,YAAEzB,KAAK4E,Q,oBAAM,SAAO9E,GAAG,OAAO,IAAIC,EAAEsB,YAAErB,KAAKqC,MAAMrC,KAAK4E,KAAK9E,GAAGA,K,wBAAG,WAAa,OAAOE,KAAK6E,OAAO1B,YAAEnD,KAAK4E,W,KAAuB7E","file":"static/js/94.14eb5134.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{getMetersPerUnitForSR as e}from\"../../../../../core/unitUtils.js\";class t{constructor(e=null){this.spatialReference=e}get spatialReference(){return this._spatialReference}set spatialReference(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}normalizeDistance(e){return e*this._metersPerDistanceUnit}normalizeElevation(e){return e*this._metersPerElevationUnit}normalizeArea(e){return e*this._squareMetersPerAreaUnit}_updateNormalizationFactors(){this._metersPerDistanceUnit=e(this._spatialReference,1),this._metersPerElevationUnit=e(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}}export default t;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import{isNone as t}from\"../../../../../core/maybe.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{property as s}from\"../../../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../../core/urlUtils.js\";import\"../../../../../core/uuid.js\";import\"../../../../../portal/support/resourceExtension.js\";import r from\"../../../../../core/Accessor.js\";import o from\"../../../../../geometry/Polyline.js\";import{rad2deg as a,acosClamped as n,deg2rad as c}from\"../../../../../core/mathUtils.js\";import{c as m}from\"../../../../../chunks/vec3f64.js\";import{k as l}from\"../../../../../chunks/vec3.js\";import p from\"../../../../../core/Handles.js\";import{getSphericalPCPF as d,getReferenceEllipsoid as h,SphericalECEFSpatialReference as u,WGS84ECEFSpatialReference as j}from\"../../../../../geometry/projectionEllipsoid.js\";import{whenOnce as f}from\"../../../../../core/watchUtils.js\";import{canProjectWithoutEngine as _,projectPointToVector as g,projectPointToWGS84ComparableLonLat as b}from\"../../../../../geometry/projection.js\";import z from\"../../../../../core/Quantity.js\";import{isSupported as w,geodesicLengths as v,inverseGeodeticSolver as D}from\"../../../../../geometry/support/geodesicUtils.js\";import{geodesicLength as P}from\"../../../../../geometry/geometryEngine.js\";import M from\"../../measurementTools/support/UnitNormalizer.js\";let y=class extends r{constructor(e){super(e),this._tempStartPosition=m(),this._tempEndPosition=m(),this._tempCornerPosition=m(),this._unitNormalizer=new M,this._handles=new p}initialize(){this._handles.add(f(this.view,\"ready\",(()=>this._initialize()),!0))}_initialize(){const e=this.view.spatialReference,t=d(e),s=t===u?j:t;this._sphericalPCPF=s;const i=_(e,s);this._unitNormalizer.spatialReference=i?s:e,this._handles.add([this.dataObject.watch(\"startPoint\",(()=>this._updateMeasurement()),!0),this.dataObject.watch(\"endPoint\",(()=>this._updateMeasurement()),!0),this.dataObject.watch(\"settings\",(()=>this._updateMeasurement()),!0)],\"model\"),this._updateMeasurement()}_updateMeasurement(){const e=this.dataObject.startPoint,s=this.dataObject.endPoint;if(t(e)||t(s))return void(this.dataObject.measurement=null);const i=this._euclideanDistances(e,s),r=this._exactGeodesicDistanceAndAngle(e,s,i.horizontal.value);this.dataObject.measurement={directDistance:i.direct,horizontalDistance:i.horizontal,verticalDistance:i.vertical,geodesicDistance:r.distance,geodesicAngle:r.angle}}_euclideanDistances(e,t){e.z>t.z&&(e=[e,e=t][0]);const s=e.clone();s.z=t.z;const i=this._tempStartPosition,r=this._tempEndPosition,o=this._tempCornerPosition,a=this.view.spatialReference,n=this._sphericalPCPF,c=_(a,n)?n:a;g(e,i,c),g(t,r,c),g(s,o,c);const m=l(i,r),p=l(o,r),d=Math.abs(t.z-e.z),h=e=>this._unitNormalizer.normalizeDistance(e),u=h(m),j=h(p),f=h(d);return{direct:new z(u,\"meters\"),horizontal:new z(j,\"meters\"),vertical:new z(f,\"meters\")}}_exactGeodesicDistanceAndAngle(e,t,s){const i=e.spatialReference,r=new o({paths:[e,t],spatialReference:i}),a=i.isGeographic&&w(i)?v([r],\"meters\")[0]:i.isWebMercator?P(r,\"meters\"):void 0,{distance:n,angle:c}=a?{distance:a,angle:this._fallbackGeodesicAngle(a,i)}:this._fallbackGeodesicDistance(e,t,s);return{distance:new z(n,\"meters\"),angle:new z(c,\"degrees\")}}_fallbackGeodesicAngle(e,t){return e/h(t).metersPerDegree}_fallbackGeodesicDistance(e,t,s){if(b(e,k)){b(t,A);const e=c(k[0]),s=c(k[1]),i=c(A[0]),r=c(A[1]),o=Math.abs(i-e),m=n(Math.sin(s)*Math.sin(r)+Math.cos(s)*Math.cos(r)*Math.cos(o)),l=a(m),p={distance:0};return D(p,[k[0],k[1]],[A[0],A[1]]),{distance:p.distance,angle:l}}{const t=e.spatialReference,i=s;return{distance:i,angle:this._fallbackGeodesicAngle(i,t)}}}};e([s()],y.prototype,\"view\",void 0),e([s()],y.prototype,\"dataObject\",void 0),y=e([i(\"esri.views.3d.interactive.graphics.DirectLineMeasurement3D.DirectLineMeasurement3DController\")],y);const k=m(),A=m();export{y as DirectLineMeasurement3DController};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{measureForUnit as t,isBaseUnit as i,convertUnit as s,baseUnitForUnit as n}from\"./unitUtils.js\";class e{constructor(i,s){this.measure=t(s),this.value=i,this.unit=s}get isBaseUnit(){return i(this.unit)}toUnit(t){return new e(s(this.value,this.unit,t),t)}toBaseUnit(){return this.toUnit(n(this.unit))}}export default e;\n"],"sourceRoot":""}