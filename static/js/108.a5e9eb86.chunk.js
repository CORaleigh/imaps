(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[108,50,58,187,240],{118:function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return x})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return _})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return S})),n.d(t,"n",(function(){return d})),n.d(t,"o",(function(){return h})),n.d(t,"p",(function(){return p})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return c})),n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return w})),n.d(t,"u",(function(){return T})),n.d(t,"v",(function(){return l})),n.d(t,"w",(function(){return b}));n(82),n(116);var r=n(85),i=n(101);function s(e=M){return[e[0],e[1],e[2],e[3]]}function o(e){return[e[0],e[1],e[2],e[3]]}function a(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function c(e,t,n,r,i=s()){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function u(e,t=s()){return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function l(e,t){return new i.a({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function h(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function d(e,t,n){if(Object(r.j)(t))a(n,e);else if("length"in t)F(t)?(n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.max(e[2],t[2]),n[3]=Math.max(e[3],t[3])):2!==t.length&&3!==t.length||(n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n[2]=Math.max(e[2],t[0]),n[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":n[0]=Math.min(e[0],t.xmin),n[1]=Math.min(e[1],t.ymin),n[2]=Math.max(e[2],t.xmax),n[3]=Math.max(e[3],t.ymax);break;case"point":n[0]=Math.min(e[0],t.x),n[1]=Math.min(e[1],t.y),n[2]=Math.max(e[2],t.x),n[3]=Math.max(e[3],t.y)}}function p(e,t,n=e){const r=t.length;let i=e[0],s=e[1],o=e[2],a=e[3];for(let c=0;c<r;c++){const e=t[c];i=Math.min(i,e[0]),s=Math.min(s,e[1]),o=Math.max(o,e[0]),a=Math.max(a,e[1])}return n[0]=i,n[1]=s,n[2]=o,n[3]=a,n}function f(e){for(let t=0;t<4;t++)if(!isFinite(e[t]))return!1;return!0}function b(e){return Object(r.j)(e)||e[0]>=e[2]?0:e[2]-e[0]}function m(e){return e[1]>=e[3]?0:e[3]-e[1]}function g(e){return b(e)*m(e)}function y(e,t=[0,0]){return t[0]=(e[0]+e[2])/2,t[1]=(e[1]+e[3])/2,t}function j(e,t){return v(e,t[0],t[1])}function O(e,t){return v(e,t.x,t.y)}function v(e,t,n){return t>=e[0]&&n>=e[1]&&t<=e[2]&&n<=e[3]}function _(e,t,n){return t[0]>=e[0]-n&&t[1]>=e[1]-n&&t[0]<=e[2]+n&&t[1]<=e[3]+n}function w(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function x(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function T(e,t,n,r=e){return r[0]=e[0]+t,r[1]=e[1]+n,r[2]=e[2]+t,r[3]=e[3]+n,r}function S(e){return e?a(e,I):s(I)}function F(e){return null!=e&&4===e.length}const I=[1/0,1/0,-1/0,-1/0],M=[0,0,0,0]},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,i=n(79),s=n(86),o=n(85),a=n(169),c=n(81),u=(n(84),n(82),n(83),n(93)),l=n(80),h=n(92);let d=r=class extends s.a{constructor(e){super(e),this.end=null,this.start=null}static get allTime(){return p}static get empty(){return f}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?e.getTime():null}get isAllTime(){return this.equals(r.allTime)}get isEmpty(){return this.equals(r.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?e.getTime():null}clone(){return new r({end:this.end,start:this.start})}equals(e){if(!e)return!1;const t=Object(o.k)(this.start)?this.start.getTime():this.start,n=Object(o.k)(this.end)?this.end.getTime():this.end,r=Object(o.k)(e.start)?e.start.getTime():e.start,i=Object(o.k)(e.end)?e.end.getTime():e.end;return t===r&&n===i}expandTo(e){if(this.isEmpty||this.isAllTime)return this.clone();const t=Object(o.b)(this.start,(t=>Object(a.c)(t,e))),n=Object(o.b)(this.end,(t=>Object(a.b)(Object(a.c)(t,e),1,e)));return new r({start:t,end:n})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return r.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=Object(o.n)(this.start,-1/0,(e=>e.getTime())),n=Object(o.n)(this.end,1/0,(e=>e.getTime())),i=Object(o.n)(e.start,-1/0,(e=>e.getTime())),s=Object(o.n)(e.end,1/0,(e=>e.getTime()));let a,c;if(i>=t&&i<=n?a=i:t>=i&&t<=s&&(a=t),n>=i&&n<=s?c=n:s>=t&&s<=n&&(c=s),!isNaN(a)&&!isNaN(c)){const e=new r;return e.start=a===-1/0?null:new Date(a),e.end=c===1/0?null:new Date(c),e}return r.empty}offset(e,t){if(this.isEmpty||this.isAllTime)return this.clone();const n=new r,{start:i,end:s}=this;return Object(o.k)(i)&&(n.start=Object(a.b)(i,e,t)),Object(o.k)(s)&&(n.end=Object(a.b)(s,e,t)),n}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return p.clone();const t=Object(o.k)(this.start)&&Object(o.k)(e.start)?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,n=Object(o.k)(this.end)&&Object(o.k)(e.end)?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new r({start:t,end:n})}};Object(i.a)([Object(c.b)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0),Object(i.a)([Object(u.a)("end")],d.prototype,"readEnd",null),Object(i.a)([Object(h.a)("end")],d.prototype,"writeEnd",null),Object(i.a)([Object(c.b)({readOnly:!0,json:{read:!1}})],d.prototype,"isAllTime",null),Object(i.a)([Object(c.b)({readOnly:!0,json:{read:!1}})],d.prototype,"isEmpty",null),Object(i.a)([Object(c.b)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0),Object(i.a)([Object(u.a)("start")],d.prototype,"readStart",null),Object(i.a)([Object(h.a)("start")],d.prototype,"writeStart",null),d=r=Object(i.a)([Object(l.a)("esri.TimeExtent")],d);const p=new d,f=new d({start:void 0,end:void 0}),b=d},123:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(79),i=n(90),s=n(86),o=n(81),a=(n(84),n(82),n(83),n(95)),c=n(80);const u=new i.a({inherited:"inherited",codedValue:"coded-value",range:"range"});let l=class extends s.a{constructor(e){super(e),this.name=null,this.type=null}};Object(r.a)([Object(o.b)({type:String,json:{write:!0}})],l.prototype,"name",void 0),Object(r.a)([Object(a.a)(u)],l.prototype,"type",void 0),l=Object(r.a)([Object(c.a)("esri.layers.support.Domain")],l);const h=l},134:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n(79),i=n(100),s=n(124),o=n(81),a=n(80),c=n(277);const u=e=>{let t=class extends e{destroy(){var e,t;this.destroyed||(null==(e=this._get("handles"))||e.destroy(),null==(t=this._get("updatingHandles"))||t.destroy())}get handles(){return this._get("handles")||new s.a}get updatingHandles(){return this._get("updatingHandles")||new c.a}};return Object(r.a)([Object(o.b)({readOnly:!0})],t.prototype,"handles",null),Object(r.a)([Object(o.b)({readOnly:!0})],t.prototype,"updatingHandles",null),t=Object(r.a)([Object(a.a)("esri.core.HandleOwner")],t),t};let l=class extends(u(i.a)){};l=Object(r.a)([Object(a.a)("esri.core.HandleOwner")],l)},145:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r,i=n(79),s=n(99),o=n(121),a=n(90),c=n(86),u=n(89),l=n(85),h=n(81),d=n(104),p=n(95),f=n(80),b=n(92),m=n(83),g=n(97),y=n(214),j=n(357),O=n(318),v=n(96),_=n(113);const w=new a.a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),x=new a.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let T=r=class extends c.a{constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}static from(e){return Object(m.d)(r,e)}castDatumTransformation(e){return"number"==typeof e||"object"==typeof e?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){const n={};for(const t in e){const r=e[t];Array.isArray(r)?n[t]=r.map((e=>e instanceof Date?e.getTime():e)):r instanceof Date?n[t]=r.getTime():n[t]=r}t.parameterValues=n}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new r(Object(u.a)({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:Object(l.k)(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};T.MAX_MAX_RECORD_COUNT_FACTOR=5,Object(i.a)([Object(h.b)({json:{write:!0}})],T.prototype,"aggregateIds",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{write:!0}})],T.prototype,"cacheHint",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"compactGeometryEnabled",void 0),Object(i.a)([Object(h.b)({json:{write:!0}})],T.prototype,"datumTransformation",void 0),Object(i.a)([Object(d.a)("datumTransformation")],T.prototype,"castDatumTransformation",null),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"defaultSpatialReferenceEnabled",void 0),Object(i.a)([Object(h.b)({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],T.prototype,"distance",void 0),Object(i.a)([Object(h.b)({type:y.a,json:{write:!0}})],T.prototype,"dynamicDataSource",void 0),Object(i.a)([Object(h.b)({type:String,json:{write:!0}})],T.prototype,"formatOf3DObjects",void 0),Object(i.a)([Object(h.b)({type:String,json:{write:!0}})],T.prototype,"gdbVersion",void 0),Object(i.a)([Object(h.b)({types:s.a,json:{read:g.a,write:!0}})],T.prototype,"geometry",void 0),Object(i.a)([Object(h.b)({type:Number,json:{write:!0}})],T.prototype,"geometryPrecision",void 0),Object(i.a)([Object(h.b)({type:[String],json:{write:!0}})],T.prototype,"groupByFieldsForStatistics",void 0),Object(i.a)([Object(h.b)({type:String,json:{write:!0}})],T.prototype,"having",void 0),Object(i.a)([Object(h.b)({type:Date})],T.prototype,"historicMoment",void 0),Object(i.a)([Object(b.a)("historicMoment")],T.prototype,"writeHistoricMoment",null),Object(i.a)([Object(h.b)({type:Number,json:{write:!0}})],T.prototype,"maxAllowableOffset",void 0),Object(i.a)([Object(h.b)({type:Number,cast:e=>e<1?1:e>r.MAX_MAX_RECORD_COUNT_FACTOR?r.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],T.prototype,"maxRecordCountFactor",void 0),Object(i.a)([Object(h.b)({type:["xyFootprint"],json:{write:!0}})],T.prototype,"multipatchOption",void 0),Object(i.a)([Object(h.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],T.prototype,"num",void 0),Object(i.a)([Object(h.b)({json:{write:!0}})],T.prototype,"objectIds",void 0),Object(i.a)([Object(h.b)({type:[String],json:{write:!0}})],T.prototype,"orderByFields",void 0),Object(i.a)([Object(h.b)({type:[String],json:{write:!0}})],T.prototype,"outFields",void 0),Object(i.a)([Object(h.b)({type:v.a,json:{name:"outSR",write:!0}})],T.prototype,"outSpatialReference",void 0),Object(i.a)([Object(h.b)({type:[O.a],json:{write:{enabled:!0,overridePolicy(){return{enabled:Object(l.k)(this.outStatistics)&&this.outStatistics.length>0}}}}})],T.prototype,"outStatistics",void 0),Object(i.a)([Object(h.b)({json:{write:!0}})],T.prototype,"parameterValues",void 0),Object(i.a)([Object(b.a)("parameterValues")],T.prototype,"writeParameterValues",null),Object(i.a)([Object(h.b)({type:_.a,json:{write:!0}})],T.prototype,"pixelSize",void 0),Object(i.a)([Object(h.b)({type:j.a,json:{write:!0}})],T.prototype,"quantizationParameters",void 0),Object(i.a)([Object(h.b)({type:[Object],json:{write:!0}})],T.prototype,"rangeValues",void 0),Object(i.a)([Object(h.b)({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],T.prototype,"relationParameter",void 0),Object(i.a)([Object(h.b)({type:String,json:{write:!0}})],T.prototype,"resultType",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnCentroid",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnDistinctValues",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!0,write:!0}})],T.prototype,"returnExceededLimitFeatures",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{write:!0}})],T.prototype,"returnGeometry",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnQueryGeometry",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"returnM",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],T.prototype,"returnZ",void 0),Object(i.a)([Object(h.b)({type:v.a,json:{write:!0}})],T.prototype,"sourceSpatialReference",void 0),Object(i.a)([Object(p.a)(w,{ignoreUnknown:!1,name:"spatialRel"})],T.prototype,"spatialRelationship",void 0),Object(i.a)([Object(h.b)({type:Number,json:{read:{source:"resultOffset"}}})],T.prototype,"start",void 0),Object(i.a)([Object(b.a)("start"),Object(b.a)("num")],T.prototype,"writeStart",null),Object(i.a)([Object(h.b)({type:String,json:{write:!0}})],T.prototype,"sqlFormat",void 0),Object(i.a)([Object(h.b)({type:String,json:{write:!0}})],T.prototype,"text",void 0),Object(i.a)([Object(h.b)({type:o.a,json:{write:!0}})],T.prototype,"timeExtent",void 0),Object(i.a)([Object(h.b)({type:Boolean,json:{default:!1,write:!0}})],T.prototype,"timeReferenceUnknownClient",void 0),Object(i.a)([Object(p.a)(x,{ignoreUnknown:!1}),Object(h.b)({json:{write:{overridePolicy(e){return{enabled:e&&this.distance>0}}}}})],T.prototype,"units",void 0),Object(i.a)([Object(h.b)({type:String,json:{write:{overridePolicy(e){return{enabled:null!=e||this.start>0}}}}})],T.prototype,"where",void 0),Object(i.a)([Object(b.a)("where")],T.prototype,"writeWhere",null),T=r=Object(i.a)([Object(f.a)("esri.rest.support.Query")],T);const S=T},147:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return a})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return x})),n.d(t,"l",(function(){return T})),n.d(t,"m",(function(){return l})),n.d(t,"n",(function(){return F})),n.d(t,"o",(function(){return b})),n.d(t,"p",(function(){return R})),n.d(t,"q",(function(){return S})),n.d(t,"r",(function(){return f})),n.d(t,"s",(function(){return o})),n.d(t,"t",(function(){return c})),n.d(t,"u",(function(){return y})),n.d(t,"v",(function(){return E})),n.d(t,"w",(function(){return M})),n.d(t,"x",(function(){return O}));var r=n(109),i=n(189);function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(e,t,n,r,i,s,o,a,c,u,l,h,d,p,f,b,m){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a,e[7]=c,e[8]=u,e[9]=l,e[10]=h,e[11]=d,e[12]=p,e[13]=f,e[14]=b,e[15]=m,e}function a(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function c(e,t){if(e===t){const n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function u(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],c=t[6],u=t[7],l=t[8],h=t[9],d=t[10],p=t[11],f=t[12],b=t[13],m=t[14],g=t[15],y=n*a-r*o,j=n*c-i*o,O=n*u-s*o,v=r*c-i*a,_=r*u-s*a,w=i*u-s*c,x=l*b-h*f,T=l*m-d*f,S=l*g-p*f,F=h*m-d*b,I=h*g-p*b,M=d*g-p*m;let E=y*M-j*I+O*F+v*S-_*T+w*x;return E?(E=1/E,e[0]=(a*M-c*I+u*F)*E,e[1]=(i*I-r*M-s*F)*E,e[2]=(b*w-m*_+g*v)*E,e[3]=(d*_-h*w-p*v)*E,e[4]=(c*S-o*M-u*T)*E,e[5]=(n*M-i*S+s*T)*E,e[6]=(m*O-f*w-g*j)*E,e[7]=(l*w-d*O+p*j)*E,e[8]=(o*I-a*S+u*x)*E,e[9]=(r*S-n*I-s*x)*E,e[10]=(f*_-b*O+g*y)*E,e[11]=(h*O-l*_-p*y)*E,e[12]=(a*T-o*F-c*x)*E,e[13]=(n*F-r*T+i*x)*E,e[14]=(b*j-f*v-m*y)*E,e[15]=(l*v-h*j+d*y)*E,e):null}function l(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],c=t[5],u=t[6],l=t[7],h=t[8],d=t[9],p=t[10],f=t[11],b=t[12],m=t[13],g=t[14],y=t[15];let j=n[0],O=n[1],v=n[2],_=n[3];return e[0]=j*r+O*a+v*h+_*b,e[1]=j*i+O*c+v*d+_*m,e[2]=j*s+O*u+v*p+_*g,e[3]=j*o+O*l+v*f+_*y,j=n[4],O=n[5],v=n[6],_=n[7],e[4]=j*r+O*a+v*h+_*b,e[5]=j*i+O*c+v*d+_*m,e[6]=j*s+O*u+v*p+_*g,e[7]=j*o+O*l+v*f+_*y,j=n[8],O=n[9],v=n[10],_=n[11],e[8]=j*r+O*a+v*h+_*b,e[9]=j*i+O*c+v*d+_*m,e[10]=j*s+O*u+v*p+_*g,e[11]=j*o+O*l+v*f+_*y,j=n[12],O=n[13],v=n[14],_=n[15],e[12]=j*r+O*a+v*h+_*b,e[13]=j*i+O*c+v*d+_*m,e[14]=j*s+O*u+v*p+_*g,e[15]=j*o+O*l+v*f+_*y,e}function h(e,t,n){const r=n[0],i=n[1],s=n[2];let o,a,c,u,l,h,d,p,f,b,m,g;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(o=t[0],a=t[1],c=t[2],u=t[3],l=t[4],h=t[5],d=t[6],p=t[7],f=t[8],b=t[9],m=t[10],g=t[11],e[0]=o,e[1]=a,e[2]=c,e[3]=u,e[4]=l,e[5]=h,e[6]=d,e[7]=p,e[8]=f,e[9]=b,e[10]=m,e[11]=g,e[12]=o*r+l*i+f*s+t[12],e[13]=a*r+h*i+b*s+t[13],e[14]=c*r+d*i+m*s+t[14],e[15]=u*r+p*i+g*s+t[15]),e}function d(e,t,n){const r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function p(e,t,n,r){let s,o,a,c,u,l,h,d,p,f,b,m,g,y,j,O,v,_,w,x,T,S,F,I,M=r[0],E=r[1],R=r[2],N=Math.sqrt(M*M+E*E+R*R);return N<i.a?null:(N=1/N,M*=N,E*=N,R*=N,s=Math.sin(n),o=Math.cos(n),a=1-o,c=t[0],u=t[1],l=t[2],h=t[3],d=t[4],p=t[5],f=t[6],b=t[7],m=t[8],g=t[9],y=t[10],j=t[11],O=M*M*a+o,v=E*M*a+R*s,_=R*M*a-E*s,w=M*E*a-R*s,x=E*E*a+o,T=R*E*a+M*s,S=M*R*a+E*s,F=E*R*a-M*s,I=R*R*a+o,e[0]=c*O+d*v+m*_,e[1]=u*O+p*v+g*_,e[2]=l*O+f*v+y*_,e[3]=h*O+b*v+j*_,e[4]=c*w+d*x+m*T,e[5]=u*w+p*x+g*T,e[6]=l*w+f*x+y*T,e[7]=h*w+b*x+j*T,e[8]=c*S+d*F+m*I,e[9]=u*S+p*F+g*I,e[10]=l*S+f*F+y*I,e[11]=h*S+b*F+j*I,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function f(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],a=t[6],c=t[7],u=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+u*r,e[5]=o*i+l*r,e[6]=a*i+h*r,e[7]=c*i+d*r,e[8]=u*i-s*r,e[9]=l*i-o*r,e[10]=h*i-a*r,e[11]=d*i-c*r,e}function b(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],c=t[3],u=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-u*r,e[1]=o*i-l*r,e[2]=a*i-h*r,e[3]=c*i-d*r,e[8]=s*r+u*i,e[9]=o*r+l*i,e[10]=a*r+h*i,e[11]=c*r+d*i,e}function m(e,t,n){const r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],a=t[2],c=t[3],u=t[4],l=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+u*r,e[1]=o*i+l*r,e[2]=a*i+h*r,e[3]=c*i+d*r,e[4]=u*i-s*r,e[5]=l*i-o*r,e[6]=h*i-a*r,e[7]=d*i-c*r,e}function g(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function y(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function j(e,t,n){let r,s,o,a=n[0],c=n[1],u=n[2],l=Math.sqrt(a*a+c*c+u*u);return l<i.a?null:(l=1/l,a*=l,c*=l,u*=l,r=Math.sin(t),s=Math.cos(t),o=1-s,e[0]=a*a*o+s,e[1]=c*a*o+u*r,e[2]=u*a*o-c*r,e[3]=0,e[4]=a*c*o-u*r,e[5]=c*c*o+s,e[6]=u*c*o+a*r,e[7]=0,e[8]=a*u*o+c*r,e[9]=c*u*o-a*r,e[10]=u*u*o+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function O(e,t){const n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function v(e,t){const n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(e,t,n){const r=t[0],i=t[1],s=t[2],o=t[3],a=r+r,c=i+i,u=s+s,l=r*a,h=r*c,d=r*u,p=i*c,f=i*u,b=s*u,m=o*a,g=o*c,y=o*u;return e[0]=1-(p+b),e[1]=h+y,e[2]=d-g,e[3]=0,e[4]=h-y,e[5]=1-(l+b),e[6]=f+m,e[7]=0,e[8]=d+g,e[9]=f-m,e[10]=1-(l+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}const w=Object(r.f)();function x(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,a=r+r,c=i+i,u=n*o,l=r*o,h=r*a,d=i*o,p=i*a,f=i*c,b=s*o,m=s*a,g=s*c;return e[0]=1-h-f,e[1]=l+g,e[2]=d-m,e[3]=0,e[4]=l-g,e[5]=1-u-f,e[6]=p+b,e[7]=0,e[8]=d+m,e[9]=p-b,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function T(e,t,n,r,i,s,o){const a=1/(n-t),c=1/(i-r),u=1/(s-o);return e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*c,e[6]=0,e[7]=0,e[8]=(n+t)*a,e[9]=(i+r)*c,e[10]=(o+s)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*u,e[15]=0,e}function S(e,t,n,r,i,s,o){const a=1/(t-n),c=1/(r-i),u=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*a,e[13]=(i+r)*c,e[14]=(o+s)*u,e[15]=1,e}function F(e,t,n,r){let s,o,c,u,l,h,d,p,f,b;const m=t[0],g=t[1],y=t[2],j=r[0],O=r[1],v=r[2],_=n[0],w=n[1],x=n[2];return Math.abs(m-_)<i.a&&Math.abs(g-w)<i.a&&Math.abs(y-x)<i.a?a(e):(d=m-_,p=g-w,f=y-x,b=1/Math.sqrt(d*d+p*p+f*f),d*=b,p*=b,f*=b,s=O*f-v*p,o=v*d-j*f,c=j*p-O*d,b=Math.sqrt(s*s+o*o+c*c),b?(b=1/b,s*=b,o*=b,c*=b):(s=0,o=0,c=0),u=p*c-f*o,l=f*s-d*c,h=d*o-p*s,b=Math.sqrt(u*u+l*l+h*h),b?(b=1/b,u*=b,l*=b,h*=b):(u=0,l=0,h=0),e[0]=s,e[1]=u,e[2]=d,e[3]=0,e[4]=o,e[5]=l,e[6]=p,e[7]=0,e[8]=c,e[9]=h,e[10]=f,e[11]=0,e[12]=-(s*m+o*g+c*y),e[13]=-(u*m+l*g+h*y),e[14]=-(d*m+p*g+f*y),e[15]=1,e)}function I(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function M(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function E(e,t){if(e===t)return!0;const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],u=e[6],l=e[7],h=e[8],d=e[9],p=e[10],f=e[11],b=e[12],m=e[13],g=e[14],y=e[15],j=t[0],O=t[1],v=t[2],_=t[3],w=t[4],x=t[5],T=t[6],S=t[7],F=t[8],I=t[9],M=t[10],E=t[11],R=t[12],N=t[13],k=t[14],C=t[15];return Math.abs(n-j)<=i.a*Math.max(1,Math.abs(n),Math.abs(j))&&Math.abs(r-O)<=i.a*Math.max(1,Math.abs(r),Math.abs(O))&&Math.abs(s-v)<=i.a*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(o-_)<=i.a*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-w)<=i.a*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(c-x)<=i.a*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(u-T)<=i.a*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(l-S)<=i.a*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(h-F)<=i.a*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(d-I)<=i.a*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(p-M)<=i.a*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(f-E)<=i.a*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(b-R)<=i.a*Math.max(1,Math.abs(b),Math.abs(R))&&Math.abs(m-N)<=i.a*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(g-k)<=i.a*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-C)<=i.a*Math.max(1,Math.abs(y),Math.abs(C))}function R(e){const t=i.a,n=e[0],r=e[1],s=e[2],o=e[4],a=e[5],c=e[6],u=e[8],l=e[9],h=e[10];return Math.abs(1-(n*n+o*o+u*u))<=t&&Math.abs(1-(r*r+a*a+l*l))<=t&&Math.abs(1-(s*s+c*c+h*h))<=t}const N=l,k=I;Object.freeze({__proto__:null,copy:s,set:o,identity:a,transpose:c,invert:u,adjoint:function(e,t){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],c=t[6],u=t[7],l=t[8],h=t[9],d=t[10],p=t[11],f=t[12],b=t[13],m=t[14],g=t[15];return e[0]=a*(d*g-p*m)-h*(c*g-u*m)+b*(c*p-u*d),e[1]=-(r*(d*g-p*m)-h*(i*g-s*m)+b*(i*p-s*d)),e[2]=r*(c*g-u*m)-a*(i*g-s*m)+b*(i*u-s*c),e[3]=-(r*(c*p-u*d)-a*(i*p-s*d)+h*(i*u-s*c)),e[4]=-(o*(d*g-p*m)-l*(c*g-u*m)+f*(c*p-u*d)),e[5]=n*(d*g-p*m)-l*(i*g-s*m)+f*(i*p-s*d),e[6]=-(n*(c*g-u*m)-o*(i*g-s*m)+f*(i*u-s*c)),e[7]=n*(c*p-u*d)-o*(i*p-s*d)+l*(i*u-s*c),e[8]=o*(h*g-p*b)-l*(a*g-u*b)+f*(a*p-u*h),e[9]=-(n*(h*g-p*b)-l*(r*g-s*b)+f*(r*p-s*h)),e[10]=n*(a*g-u*b)-o*(r*g-s*b)+f*(r*u-s*a),e[11]=-(n*(a*p-u*h)-o*(r*p-s*h)+l*(r*u-s*a)),e[12]=-(o*(h*m-d*b)-l*(a*m-c*b)+f*(a*d-c*h)),e[13]=n*(h*m-d*b)-l*(r*m-i*b)+f*(r*d-i*h),e[14]=-(n*(a*m-c*b)-o*(r*m-i*b)+f*(r*c-i*a)),e[15]=n*(a*d-c*h)-o*(r*d-i*h)+l*(r*c-i*a),e},determinant:function(e){const t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],c=e[7],u=e[8],l=e[9],h=e[10],d=e[11],p=e[12],f=e[13],b=e[14],m=e[15];return(t*o-n*s)*(h*m-d*b)-(t*a-r*s)*(l*m-d*f)+(t*c-i*s)*(l*b-h*f)+(n*a-r*o)*(u*m-d*p)-(n*c-i*o)*(u*b-h*p)+(r*c-i*a)*(u*f-l*p)},multiply:l,translate:h,scale:d,rotate:p,rotateX:f,rotateY:b,rotateZ:m,fromTranslation:g,fromScaling:y,fromRotation:j,fromXRotation:O,fromYRotation:function(e,t){const n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromZRotation:v,fromRotationTranslation:_,fromQuat2:function(e,t){const n=w,r=-t[0],i=-t[1],s=-t[2],o=t[3],a=t[4],c=t[5],u=t[6],l=t[7],h=r*r+i*i+s*s+o*o;return h>0?(n[0]=2*(a*o+l*r+c*s-u*i)/h,n[1]=2*(c*o+l*i+u*r-a*s)/h,n[2]=2*(u*o+l*s+a*i-c*r)/h):(n[0]=2*(a*o+l*r+c*s-u*i),n[1]=2*(c*o+l*i+u*r-a*s),n[2]=2*(u*o+l*s+a*i-c*r)),_(e,t,n),e},getTranslation:function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},getScaling:function(e,t){const n=t[0],r=t[1],i=t[2],s=t[4],o=t[5],a=t[6],c=t[8],u=t[9],l=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(s*s+o*o+a*a),e[2]=Math.sqrt(c*c+u*u+l*l),e},getRotation:function(e,t){const n=t[0]+t[5]+t[10];let r=0;return n>0?(r=2*Math.sqrt(n+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e},fromRotationTranslationScale:function(e,t,n,r){const i=t[0],s=t[1],o=t[2],a=t[3],c=i+i,u=s+s,l=o+o,h=i*c,d=i*u,p=i*l,f=s*u,b=s*l,m=o*l,g=a*c,y=a*u,j=a*l,O=r[0],v=r[1],_=r[2];return e[0]=(1-(f+m))*O,e[1]=(d+j)*O,e[2]=(p-y)*O,e[3]=0,e[4]=(d-j)*v,e[5]=(1-(h+m))*v,e[6]=(b+g)*v,e[7]=0,e[8]=(p+y)*_,e[9]=(b-g)*_,e[10]=(1-(h+f))*_,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},fromRotationTranslationScaleOrigin:function(e,t,n,r,i){const s=t[0],o=t[1],a=t[2],c=t[3],u=s+s,l=o+o,h=a+a,d=s*u,p=s*l,f=s*h,b=o*l,m=o*h,g=a*h,y=c*u,j=c*l,O=c*h,v=r[0],_=r[1],w=r[2],x=i[0],T=i[1],S=i[2],F=(1-(b+g))*v,I=(p+O)*v,M=(f-j)*v,E=(p-O)*_,R=(1-(d+g))*_,N=(m+y)*_,k=(f+j)*w,C=(m-y)*w,A=(1-(d+b))*w;return e[0]=F,e[1]=I,e[2]=M,e[3]=0,e[4]=E,e[5]=R,e[6]=N,e[7]=0,e[8]=k,e[9]=C,e[10]=A,e[11]=0,e[12]=n[0]+x-(F*x+E*T+k*S),e[13]=n[1]+T-(I*x+R*T+C*S),e[14]=n[2]+S-(M*x+N*T+A*S),e[15]=1,e},fromQuat:x,frustum:T,perspective:function(e,t,n,r,i){const s=1/Math.tan(t/2);let o;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(r-i),e[10]=(i+r)*o,e[14]=2*i*r*o):(e[10]=-1,e[14]=-2*r),e},perspectiveFromFieldOfView:function(e,t,n,r){const i=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+a),u=2/(i+s);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(o-a)*c*.5,e[9]=(i-s)*u*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e},ortho:S,lookAt:F,targetTo:function(e,t,n,r){const i=t[0],s=t[1],o=t[2],a=r[0],c=r[1],u=r[2];let l=i-n[0],h=s-n[1],d=o-n[2],p=l*l+h*h+d*d;p>0&&(p=1/Math.sqrt(p),l*=p,h*=p,d*=p);let f=c*d-u*h,b=u*l-a*d,m=a*h-c*l;return p=f*f+b*b+m*m,p>0&&(p=1/Math.sqrt(p),f*=p,b*=p,m*=p),e[0]=f,e[1]=b,e[2]=m,e[3]=0,e[4]=h*m-d*b,e[5]=d*f-l*m,e[6]=l*b-h*f,e[7]=0,e[8]=l,e[9]=h,e[10]=d,e[11]=0,e[12]=i,e[13]=s,e[14]=o,e[15]=1,e},str:function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},frob:function(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2+e[9]**2+e[10]**2+e[11]**2+e[12]**2+e[13]**2+e[14]**2+e[15]**2)},add:function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e},subtract:I,multiplyScalar:function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e},multiplyScalarAndAdd:function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e},exactEquals:M,equals:E,isOrthoNormal:R,mul:N,sub:k})},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,i=n(79),s=n(90),o=n(86),a=n(81),c=(n(84),n(82),n(83)),u=n(95),l=n(93),h=n(80),d=n(209),p=n(268);const f=new s.a({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let b=r=class extends o.a{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(e,{description:t}){let n;try{n=JSON.parse(t)}catch(r){}return n?n.value:null}readValueType(e,{description:t}){let n;try{n=JSON.parse(t)}catch(r){}return n?f.fromJSON(n.fieldValueType):null}clone(){return new r({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],b.prototype,"alias",void 0),Object(i.a)([Object(a.b)({type:[String,Number],json:{write:{allowNull:!0}}})],b.prototype,"defaultValue",void 0),Object(i.a)([Object(a.b)()],b.prototype,"description",void 0),Object(i.a)([Object(l.a)("description")],b.prototype,"readDescription",null),Object(i.a)([Object(a.b)({types:d.b,json:{read:{reader:d.a},write:!0}})],b.prototype,"domain",void 0),Object(i.a)([Object(a.b)({type:Boolean,json:{write:!0}})],b.prototype,"editable",void 0),Object(i.a)([Object(a.b)({type:c.a,json:{write:!0}})],b.prototype,"length",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],b.prototype,"name",void 0),Object(i.a)([Object(a.b)({type:Boolean,json:{write:!0}})],b.prototype,"nullable",void 0),Object(i.a)([Object(u.a)(p.a)],b.prototype,"type",void 0),Object(i.a)([Object(a.b)()],b.prototype,"valueType",void 0),Object(i.a)([Object(l.a)("valueType",["description"])],b.prototype,"readValueType",null),b=r=Object(i.a)([Object(h.a)("esri.layers.support.Field")],b);const m=b},160:function(e,t,n){"use strict";n.d(t,"a",(function(){return H})),n.d(t,"b",(function(){return K})),n.d(t,"c",(function(){return Z})),n.d(t,"d",(function(){return W})),n.d(t,"e",(function(){return Y})),n.d(t,"f",(function(){return U})),n.d(t,"g",(function(){return G})),n.d(t,"h",(function(){return z})),n.d(t,"i",(function(){return J})),n.d(t,"j",(function(){return $})),n.d(t,"k",(function(){return Q})),n.d(t,"l",(function(){return k})),n.d(t,"m",(function(){return _})),n.d(t,"n",(function(){return V})),n.d(t,"o",(function(){return P})),n.d(t,"p",(function(){return he})),n.d(t,"q",(function(){return re})),n.d(t,"r",(function(){return oe})),n.d(t,"s",(function(){return le})),n.d(t,"t",(function(){return te})),n.d(t,"u",(function(){return ne})),n.d(t,"v",(function(){return y})),n.d(t,"w",(function(){return j})),n.d(t,"x",(function(){return ce})),n.d(t,"y",(function(){return ee})),n.d(t,"z",(function(){return ae}));var r=n(88),i=n(87),s=n(85),o=n(97),a=n(262),c=n(332),u=n(168);function l(e,t){return e?t?4:3:t?3:2}const h=i.a.getLogger("esri.layers.graphics.featureConversionUtils"),d={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},p=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s},f=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s,e[n+2]=t[r+2]},b=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s,e[n+2]=t[r+3]},m=(e,t,n,r,i,s)=>{e[n]=i,e[n+1]=s,e[n+2]=t[r+2],e[n+3]=t[r+3]};function g(e,t,n,r){if(e){if(n)return t&&r?m:f;if(t&&r)return b}else if(t&&r)return f;return p}function y({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function j({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function O({scale:e,translate:t},n){return n*e[0]+t[0]}function v({scale:e,translate:t},n){return t[1]-n*e[1]}function _(e,t,n){return e?t?n?M(e):T(e):n?F(e):w(e):null}function w(e){const t=e.coords;return{x:t[0],y:t[1]}}function x(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function T(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function S(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function F(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function I(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function M(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function E(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function R(e,t){return e&&t?E:e?S:t?I:x}function N(e,t,n,r,i){const s=R(n,r);for(const o of t){const{geometry:t,attributes:n}=o;let r;t&&(r=s(new u.a,t)),e.push(new a.a(r,n,null,n[i]))}return e}function k(e,t,n){if(Object(s.j)(e))return null;const r=l(t,n),i=[];for(let s=0;s<e.coords.length;s+=r){const t=[];for(let n=0;n<r;n++)t.push(e.coords[s+n]);i.push(t)}return t?n?{points:i,hasZ:t,hasM:n}:{points:i,hasZ:t}:n?{points:i,hasM:n}:{points:i}}function C(e,t,n,r,i){const s=l(n,r);for(const o of t){const t=o.geometry,n=o.attributes;let r;t&&(r=A(new u.a,t,s)),e.push(new a.a(r,n,null,n[i]))}return e}function A(e,t,n=l(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const r=e.coords;let i=0;for(const s of t.points)for(let e=0;e<n;e++)r[i++]=s[e];return e}function P(e,t,n){if(!e)return null;const r=l(t,n),{coords:i,lengths:s}=e,o=[];let a=0;for(const c of s){const e=[];for(let t=0;t<c;t++){const t=[];for(let e=0;e<r;e++)t.push(i[a++]);e.push(t)}o.push(e)}return t?n?{paths:o,hasZ:t,hasM:n}:{paths:o,hasZ:t}:n?{paths:o,hasM:n}:{paths:o}}function D(e,t,n,r,i){const s=l(n,r);for(const o of t){const t=o.geometry,n=o.attributes;let r;t&&(r=z(new u.a,t,s)),e.push(new a.a(r,n,null,n[i]))}return e}function z(e,t,n=l(t.hasZ,t.hasM)){const{lengths:r,coords:i}=e;let s=0;for(const o of t.paths){for(const e of o)for(let t=0;t<n;t++)i[s++]=e[t];r.push(o.length)}return e}function V(e,t,n){if(!e)return null;const r=l(t,n),{coords:i,lengths:s}=e,o=[];let a=0;for(const c of s){const e=[];for(let t=0;t<c;t++){const t=[];for(let e=0;e<r;e++)t.push(i[a++]);e.push(t)}o.push(e)}return t?n?{rings:o,hasZ:t,hasM:n}:{rings:o,hasZ:t}:n?{rings:o,hasM:n}:{rings:o}}function q(e,t,n,r,i){for(const o of t){const t=o.geometry,c=o.centroid,l=o.attributes;let h;t&&(h=G(new u.a,t,n,r)),Object(s.k)(c)?e.push(new a.a(h,l,x(new u.a,c),l[i])):e.push(new a.a(h,l,null,l[i]))}return e}function G(e,t,n=t.hasZ,r=t.hasM){return U(e,t.rings,n,r),e}function U(e,t,n,r){const i=l(n,r),{lengths:s,coords:o}=e;let a=0;s.length=o.length=0;for(const c of t){for(const e of c)for(let t=0;t<i;t++)o[a++]=e[t];s.push(c.length)}return e}const L=[],B=[];function H(e,t,n,r,i){L[0]=e;const[s]=Z(B,L,t,n,r,i);return L.length=B.length=0,s}function Z(e,t,n,i,s,o){if(e.length=0,!n){for(const n of t){const t=n.attributes[o];e.push(new a.a(null,n.attributes,null,t))}return e}switch(n){case"esriGeometryPoint":return N(e,t,i,s,o);case"esriGeometryMultipoint":return C(e,t,i,s,o);case"esriGeometryPolyline":return D(e,t,i,s,o);case"esriGeometryPolygon":return q(e,t,i,s,o);default:h.error("convertToFeatureSet:unknown-geometry",new r.a(`Unable to parse unknown geometry type '${n}'`)),e.length=0}return e}function Y(e,t,n,i,s,o){const a=e.length;switch(n){case"esriGeometryPoint":N(e,t,i,s,o);break;case"esriGeometryMultipoint":C(e,t,i,s,o);break;case"esriGeometryPolyline":D(e,t,i,s,o);break;case"esriGeometryPolygon":q(e,t,i,s,o);break;default:h.error("convertToFeatureSet:unknown-geometry",new r.a(`Unable to parse unknown geometry type '${n}'`))}for(let r=0;r<t.length;r++)e[r+a].geometryType=n,e[r+a].insertAfter=t[r].insertAfter,e[r+a].groupId=t[r].groupId;return e}function J(e,t,n,r){B[0]=e,X(L,B,t,n,r);const i=L[0];return L.length=B.length=0,i}function W(e,t,n){if(Object(s.j)(e))return null;const i=new u.a;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==n&&(n=e.hasM),Object(o.f)(e)?R(null!=t?t:null!=e.z,null!=n?n:null!=e.m)(i,e):Object(o.g)(e)?G(i,e,t,n):Object(o.h)(e)?z(i,e,l(t,n)):Object(o.e)(e)?A(i,e,l(t,n)):void h.error("convertFromGeometry:unknown-geometry",new r.a(`Unable to parse unknown geometry type '${e}'`))}function Q(e,t,n,i){const o=e&&("coords"in e?e:e.geometry);if(Object(s.j)(o))return null;switch(t){case"esriGeometryPoint":{let e=w;return n&&i?e=M:n?e=T:i&&(e=F),e(o)}case"esriGeometryMultipoint":return k(o,n,i);case"esriGeometryPolyline":return P(o,n,i);case"esriGeometryPolygon":return V(o,n,i);default:return void h.error("convertToGeometry:unknown-geometry",new r.a(`Unable to parse unknown geometry type '${t}'`))}}function X(e,t,n,i,o){if(e.length=0,Object(s.j)(n))return function(e,t){for(const n of t)e.push({attributes:n.attributes});return e}(e,t);switch(n){case"esriGeometryPoint":return function(e,t,n,r){let i=w;n&&r?i=M:n?i=T:r&&(i=F);for(const o of t){const{geometry:t,attributes:n}=o,r=Object(s.k)(t)?i(t):null;e.push({attributes:n,geometry:r})}return e}(e,t,i,o);case"esriGeometryMultipoint":return function(e,t,n,r){for(const i of t){const{geometry:t,attributes:s}=i;let o;t&&(o=k(t,n,r)),e.push({attributes:s,geometry:o})}return e}(e,t,i,o);case"esriGeometryPolyline":return function(e,t,n,r){for(const i of t){const{geometry:t,attributes:o}=i;let a;Object(s.k)(t)&&(a=P(t,n,r)),e.push({attributes:o,geometry:a})}return e}(e,t,i,o);case"esriGeometryPolygon":return function(e,t,n,r){for(const i of t){const{geometry:t,attributes:o,centroid:a}=i;let c;if(Object(s.k)(t)&&(c=V(t,n,r)),Object(s.k)(a)){const t=w(a);e.push({attributes:o,centroid:t,geometry:c})}else e.push({attributes:o,geometry:c})}return e}(e,t,i,o);default:h.error("convertToFeatureSet:unknown-geometry",new r.a(`Unable to parse unknown geometry type '${n}'`))}return e}function $(e){const{objectIdFieldName:t,spatialReference:n,transform:r,fields:i,hasM:s,hasZ:o,features:a,geometryType:c,exceededTransferLimit:u,uniqueIdField:l,queryGeometry:h,queryGeometryType:d}=e,p={features:X([],a,c,o,s),fields:i,geometryType:c,objectIdFieldName:t,spatialReference:n,uniqueIdField:l,queryGeometry:Q(h,d,!1,!1)};return r&&(p.transform=r),u&&(p.exceededTransferLimit=u),s&&(p.hasM=s),o&&(p.hasZ=o),p}function K(e,t){const n=new c.a,{hasM:i,hasZ:s,features:o,objectIdFieldName:a,spatialReference:u,geometryType:l,exceededTransferLimit:d,transform:p,fields:f}=e;return f&&(n.fields=f),n.geometryType=l,n.objectIdFieldName=a||t,n.spatialReference=u,n.objectIdFieldName?(o&&Z(n.features,o,l,s,i,n.objectIdFieldName),d&&(n.exceededTransferLimit=d),i&&(n.hasM=i),s&&(n.hasZ=s),p&&(n.transform=p),n):(h.error(new r.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function ee(e){const{transform:t,features:n,hasM:r,hasZ:i}=e;if(!t)return e;for(const o of n)Object(s.k)(o.geometry)&&ae(o.geometry,o.geometry,r,i,t),Object(s.k)(o.centroid)&&ae(o.centroid,o.centroid,r,i,t);return e.transform=null,e}function te(e,t){const{geometryType:n,features:r,hasM:i,hasZ:s}=t;if(!e)return t;for(let o=0;o<r.length;o++){const t=r[o],a=t.weakClone();a.geometry=new u.a,ne(a.geometry,t.geometry,i,s,n,e),t.centroid&&(a.centroid=new u.a,ne(a.centroid,t.centroid,i,s,"esriGeometryPoint",e)),r[o]=a}return t.transform=e,t}function ne(e,t,n,r,i,o,a=n,c=r){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),Object(s.j)(t)||!t.coords.length)return null;const u=d[i],{coords:h,lengths:p}=t,f=l(n,r),b=l(n&&a,r&&c),m=g(n,r,a,c);if(!p.length)return m(e.coords,h,0,0,y(o,h[0]),j(o,h[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=f,e;let O,v,_,w,x=0,T=0,S=T;for(const s of p){if(s<u)continue;let t=0;T=S,_=O=y(o,h[x]),w=v=j(o,h[x+1]),m(e.coords,h,T,x,_,w),t++,x+=f,T+=b;for(let n=1;n<s;n++,x+=f)_=y(o,h[x]),w=j(o,h[x+1]),_===O&&w===v||(m(e.coords,h,T,x,_-O,w-v),T+=b,t++,O=_,v=w);t>=u&&(e.lengths.push(t),S=T)}return e.coords.length=S,e.coords.length?e:null}function re(e,t,n,r,i,s,o=n,a=r){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const c=d[i],{coords:u,lengths:h}=t,p=l(n,r),f=l(n&&o,r&&a),b=g(n,r,o,a);if(!h.length)return b(e.coords,u,0,0,u[0],u[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=p,e;let m=0;const y=s*s;for(const l of h){if(l<c){m+=l*p;continue}const t=e.coords.length/f,n=m,r=m+(l-1)*p;b(e.coords,u,e.coords.length,n,u[n],u[n+1]),se(e.coords,u,p,y,b,n,r),b(e.coords,u,e.coords.length,r,u[r],u[r+1]);const i=e.coords.length/f-t;i>=c?e.lengths.push(i):e.coords.length=t*f,m+=l*p}return e.coords.length?e:null}function ie(e,t,n,r){const i=e[t],s=e[t+1],o=e[n],a=e[n+1],c=e[r],u=e[r+1];let l=o,h=a,d=c-l,p=u-h;if(0!==d||0!==p){const e=((i-l)*d+(s-h)*p)/(d*d+p*p);e>1?(l=c,h=u):e>0&&(l+=d*e,h+=p*e)}return d=i-l,p=s-h,d*d+p*p}function se(e,t,n,r,i,s,o){let a,c=r,u=0;for(let l=s+n;l<o;l+=n)a=ie(t,l,s,o),a>c&&(u=l,c=a);c>r&&(u-s>n&&se(e,t,n,r,i,s,u),i(e,t,e.length,u,t[u],t[u+1]),o-u>n&&se(e,t,n,r,i,u,o))}function oe(e,t,n,r){if(Object(s.j)(t)||!t.coords||!t.coords.length)return null;const i=l(n,r);let o=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=i){const n=e[t],r=e[t+1];o=Math.min(o,n),c=Math.max(c,n),a=Math.min(a,r),u=Math.max(u,r)}}return e[0]=o,e[1]=a,e[2]=c,e[3]=u,e}function ae(e,t,n,r,i){const{coords:s,lengths:o}=t,a=n?r?m:f:r?f:p,c=l(n,r);if(!s.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!o.length)return a(e.coords,s,0,0,O(i,s[0]),v(i,s[1])),e!==t&&(e.lengths.length=0,e.coords.length=c),e;const[u,h]=i.scale;let d=0;for(let l=0;l<o.length;l++){const t=o[l];e.lengths[l]=t;let n=O(i,s[d]),r=v(i,s[d+1]);a(e.coords,s,d,d,n,r),d+=c;for(let i=1;i<t;i++,d+=c)n+=s[d]*u,r-=s[d+1]*h,a(e.coords,s,d,d,n,r)}return e!==t&&(e.lengths.length=o.length,e.coords.length=s.length),e}function ce(e,t,n,r,i,s){const o=l(n,r),a=g(n,r,i,s),c=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let u=0;u<c.length;u+=o)a(e.coords,c,e.coords.length,u,c[u],c[u+1]);return e}function ue(e,t,n,r){let i=0,s=e[r*t],o=e[r*(t+1)];for(let a=1;a<n;a++){const n=s+e[r*(t+a)],c=o+e[r*(t+a)+1],u=(n-s)*(c+o);s=n,o=c,i+=u}return.5*i}function le(e,t){const{coords:n,lengths:r}=e;let i=0,s=0;for(let o=0;o<r.length;o++)s+=ue(n,i,r[o],t),i+=o;return Math.abs(s)}function he(e,t){if(Object(s.j)(e))return null;const n=e.clone(),r=e.coords,i=e.lengths;let o=0;for(let s=0;s<i.length;s++){const e=i[s];let a=r[t*o],c=r[t*o+1];for(let i=1;i<e;i++){const e=a+r[t*(o+i)],s=c+r[t*(o+i)+1];n.coords[t*(o+i)]=e,n.coords[t*(o+i)+1]=s,a=e,c=s}o+=e}return n}},168:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e=[],t=[],n=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=n}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const r=this.lengths[n];for(let n=0;n<r;n++)e(this.coords[2*(n+t)],this.coords[2*(n+t)+1]);t+=r}}clone(e){return e?(e.set(this.coords),new r(this.lengths.slice(),e,this.hasIndeterminateRingOrder)):new r(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}},169:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o}));n(82);const r={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},i={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function s(e,t,n){const r=new Date(e.getTime());if(t&&n){const e=i[n],{getter:s,setter:o,multiplier:a}=e;if("months"===n){const e=function(e,t){const n=new Date(e,t+1,1);return n.setDate(0),n.getDate()}(r.getFullYear(),r.getMonth()+t);r.getDate()>e&&r.setDate(e)}r[o](r[s]()+t*a)}return r}function o(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return new Date}}function a(e,t,n){return 0===e?0:e*r[t]/r[n]}},172:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r,i=n(79),s=n(89),o=n(81),a=(n(83),n(95)),c=n(80),u=n(86);n(84),n(82);let l=r=class extends u.a{constructor(e){super(e),this.name=null,this.code=null}clone(){return new r({name:this.name,code:this.code})}};Object(i.a)([Object(o.b)({type:String,json:{write:!0}})],l.prototype,"name",void 0),Object(i.a)([Object(o.b)({type:[String,Number],json:{write:!0}})],l.prototype,"code",void 0),l=r=Object(i.a)([Object(c.a)("esri.layers.support.CodedValue")],l);const h=l;var d,p=n(123);let f=d=class extends p.a{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const n=String(e);this.codedValues.some((e=>(String(e.code)===n&&(t=e.name),!!t)))}return t}clone(){return new d({codedValues:Object(s.a)(this.codedValues),name:this.name})}};Object(i.a)([Object(o.b)({type:[h],json:{write:!0}})],f.prototype,"codedValues",void 0),Object(i.a)([Object(a.a)({codedValue:"coded-value"})],f.prototype,"type",void 0),f=d=Object(i.a)([Object(c.a)("esri.layers.support.CodedValueDomain")],f);const b=f},174:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,i=n(79),s=(n(87),n(83),n(84),n(82),n(171),n(95)),o=n(80),a=n(123);let c=r=class extends a.a{constructor(e){super(e),this.type="inherited"}clone(){return new r}};Object(i.a)([Object(s.a)({inherited:"inherited"})],c.prototype,"type",void 0),c=r=Object(i.a)([Object(o.a)("esri.layers.support.InheritedDomain")],c);const u=c},175:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,i=n(79),s=n(81),o=(n(84),n(82),n(83),n(95)),a=n(80),c=n(123);let u=r=class extends c.a{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new r({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};Object(i.a)([Object(s.b)({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,n){t[n]=[this.minValue||0,e]}}}})],u.prototype,"maxValue",void 0),Object(i.a)([Object(s.b)({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[0]},write:{target:"range",writer(e,t,n){t[n]=[e,this.maxValue||0]}}}})],u.prototype,"minValue",void 0),Object(i.a)([Object(o.a)({range:"range"})],u.prototype,"type",void 0),u=r=Object(i.a)([Object(a.a)("esri.layers.support.RangeDomain")],u);const l=u},194:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(90);const i=Object(r.b)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},204:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},209:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));n(82);var r=n(172),i=n(123),s=n(174),o=n(175);const a={key:"type",base:i.a,typeMap:{range:o.a,"coded-value":r.a,inherited:s.a}};function c(e){if(!e||!e.type)return null;switch(e.type){case"range":return o.a.fromJSON(e);case"codedValue":return r.a.fromJSON(e);case"inherited":return s.a.fromJSON(e)}return null}},214:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r,i=n(79),s=n(90),o=n(86),a=n(81),c=(n(84),n(82),n(104)),u=n(95),l=n(93),h=n(80),d=n(83),p=n(179),f=n(154),b=n(354),m=(n(99),n(96)),g=n(205);let y=r=class extends o.a{constructor(e){super(e),this.type="query-table"}clone(){var e;const{workspaceId:t,query:n,oidFields:i,spatialReference:s,geometryType:o}=this,a={workspaceId:t,query:n,oidFields:i,spatialReference:null!=(e=null==s?void 0:s.clone())?e:void 0,geometryType:o};return new r(a)}};var j;Object(i.a)([Object(u.a)({queryTable:"query-table"})],y.prototype,"type",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],y.prototype,"workspaceId",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],y.prototype,"query",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],y.prototype,"oidFields",void 0),Object(i.a)([Object(a.b)({type:m.a,json:{write:!0}})],y.prototype,"spatialReference",void 0),Object(i.a)([Object(u.a)(g.a)],y.prototype,"geometryType",void 0),y=r=Object(i.a)([Object(h.a)("esri.layers.support.source.QueryTableDataSource")],y);let O=j=class extends o.a{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new j({workspaceId:e,dataSourceName:t})}};var v;Object(i.a)([Object(u.a)({raster:"raster"})],O.prototype,"type",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],O.prototype,"dataSourceName",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],O.prototype,"workspaceId",void 0),O=j=Object(i.a)([Object(h.a)("esri.layers.support.source.RasterDataSource")],O);let _=v=class extends o.a{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:n}=this;return new v({workspaceId:e,gdbVersion:t,dataSourceName:n})}};var w,x;Object(i.a)([Object(u.a)({table:"table"})],_.prototype,"type",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],_.prototype,"workspaceId",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],_.prototype,"gdbVersion",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],_.prototype,"dataSourceName",void 0),_=v=Object(i.a)([Object(h.a)("esri.layers.support.source.TableDataSource")],_);const T=Object(s.b)()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let S=w=class extends o.a{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,n){return I()(e,t,n)}castLeftTableSource(e){return Object(d.k)(E(),e)}readRightTableSource(e,t,n){return I()(e,t,n)}castRightTableSource(e){return Object(d.k)(E(),e)}clone(){var e,t;const{leftTableKey:n,rightTableKey:r,leftTableSource:i,rightTableSource:s,joinType:o}=this,a={leftTableKey:n,rightTableKey:r,leftTableSource:null!=(e=null==i?void 0:i.clone())?e:void 0,rightTableSource:null!=(t=null==s?void 0:s.clone())?t:void 0,joinType:o};return new w(a)}};Object(i.a)([Object(u.a)({joinTable:"join-table"})],S.prototype,"type",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],S.prototype,"leftTableKey",void 0),Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],S.prototype,"rightTableKey",void 0),Object(i.a)([Object(a.b)({json:{write:!0}})],S.prototype,"leftTableSource",void 0),Object(i.a)([Object(l.a)("leftTableSource")],S.prototype,"readLeftTableSource",null),Object(i.a)([Object(c.a)("leftTableSource")],S.prototype,"castLeftTableSource",null),Object(i.a)([Object(a.b)({json:{write:!0}})],S.prototype,"rightTableSource",void 0),Object(i.a)([Object(l.a)("rightTableSource")],S.prototype,"readRightTableSource",null),Object(i.a)([Object(c.a)("rightTableSource")],S.prototype,"castRightTableSource",null),Object(i.a)([Object(u.a)(T)],S.prototype,"joinType",void 0),S=w=Object(i.a)([Object(h.a)("esri.layers.support.source.JoinTableDataSource")],S);let F=null;function I(){return F||(F=Object(p.b)({types:E()})),F}let M=null;function E(){return M||(M={key:"type",base:null,typeMap:{"data-layer":N,"map-layer":b.a}}),M}const R={key:"type",base:null,typeMap:{"join-table":S,"query-table":y,raster:O,table:_}};let N=x=class extends o.a{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:t}=this;return new x({fields:e,dataSource:t})}};Object(i.a)([Object(u.a)({dataLayer:"data-layer"})],N.prototype,"type",void 0),Object(i.a)([Object(a.b)({type:[f.a],json:{write:!0}})],N.prototype,"fields",void 0),Object(i.a)([Object(a.b)({types:R,json:{write:!0}})],N.prototype,"dataSource",void 0),N=x=Object(i.a)([Object(h.a)("esri.layers.support.source.DataLayerSource")],N),N.from=Object(d.m)(N)},218:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}));var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{};function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function s(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}}).call(this,n(204))},223:function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return A})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return I})),n.d(t,"i",(function(){return k})),n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"o",(function(){return E})),n.d(t,"p",(function(){return o})),n.d(t,"q",(function(){return x})),n.d(t,"r",(function(){return v})),n.d(t,"s",(function(){return N})),n.d(t,"t",(function(){return j})),n.d(t,"u",(function(){return _})),n.d(t,"v",(function(){return w})),n.d(t,"w",(function(){return F})),n.d(t,"x",(function(){return S})),n.d(t,"y",(function(){return T})),n.d(t,"z",(function(){return y})),n.d(t,"A",(function(){return M}));var r=n(85),i=(n(101),n(118));function s(e=A){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function o(e,t,n,r,i,o,a=s()){return a[0]=e,a[1]=t,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a}function a(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function c(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function u(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function l(e,t,n=0,r=t.length/3){let i=e[0],s=e[1],o=e[2],a=e[3],c=e[4],u=e[5];for(let l=0;l<r;l++)i=Math.min(i,t[n+3*l]),s=Math.min(s,t[n+3*l+1]),o=Math.min(o,t[n+3*l+2]),a=Math.max(a,t[n+3*l]),c=Math.max(c,t[n+3*l+1]),u=Math.max(u,t[n+3*l+2]);e[0]=i,e[1]=s,e[2]=o,e[3]=a,e[4]=c,e[5]=u}function h(e,t,n){const r=t.length;let i=e[0],s=e[1],o=e[2],a=e[3],c=e[4],u=e[5];if(n)for(let l=0;l<r;l++){const e=t[l];i=Math.min(i,e[0]),s=Math.min(s,e[1]),o=Math.min(o,e[2]),a=Math.max(a,e[0]),c=Math.max(c,e[1]),u=Math.max(u,e[2])}else for(let l=0;l<r;l++){const e=t[l];i=Math.min(i,e[0]),s=Math.min(s,e[1]),a=Math.max(a,e[0]),c=Math.max(c,e[1])}e[0]=i,e[1]=s,e[2]=o,e[3]=a,e[4]=c,e[5]=u}function d(e){for(let t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function p(e){return e[0]>=e[3]?0:e[3]-e[0]}function f(e){return e[1]>=e[4]?0:e[4]-e[1]}function b(e){return e[2]>=e[5]?0:e[5]-e[2]}function m(e){const t=p(e),n=b(e),r=f(e);return Math.sqrt(t*t+n*n+r*r)}function g(e,t=[0,0,0]){return t[0]=e[0]+p(e)/2,t[1]=e[1]+f(e)/2,t[2]=e[2]+b(e)/2,t}function y(e,t=[0,0,0]){return t[0]=p(e),t[1]=f(e),t[2]=b(e),t}function j(e){return Math.max(p(e),b(e),f(e))}function O(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function v(e,t){return!!Object(r.j)(t)||function(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}(e,t)}function _(e,t,n,r,i=e){return i[0]=e[0]+t,i[1]=e[1]+n,i[2]=e[2]+r,i[3]=e[3]+t,i[4]=e[4]+n,i[5]=e[5]+r,i}function w(e,t,n=e){const r=e[0]+p(e)/2,i=e[1]+f(e)/2,s=e[2]+b(e)/2;return n[0]=r+(e[0]-r)*t,n[1]=i+(e[1]-i)*t,n[2]=s+(e[2]-s)*t,n[3]=r+(e[3]-r)*t,n[4]=i+(e[4]-i)*t,n[5]=s+(e[5]-s)*t,n}function x(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function T(e,t,n=e){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n!==e&&(n[3]=e[3],n[4]=e[4],n[5]=e[5]),n}function S(e,t,n=e){return n[3]=t[0],n[4]=t[1],n[5]=t[2],n!==e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2]),e}function F(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function I(e){return e?F(e,C):s(C)}function M(e,t){return t||(t=Object(i.l)()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function E(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function R(e){return 6===e.length}function N(e){return 0===p(e)&&0===f(e)&&0===b(e)}function k(e,t,n){if(Object(r.j)(e)||Object(r.j)(t))return e===t;if(!R(e)||!R(t))return!1;if(n){for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const C=[1/0,1/0,1/0,-1/0,-1/0,-1/0],A=[0,0,0,0,0,0];s()},229:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return j}));var r=n(153),i=n(88),s=n(87),o=n(85),a=n(135),c=n(140),u=n(247),l=n(110),h=n(182),d=(n(99),n(103)),p=n(98),f=n(97);async function b(e,t,n){const r="string"==typeof e?Object(p.M)(e):e,i=t[0].spatialReference,s=Object(f.c)(t[0]),o={...n,query:{...r.query,f:"json",sr:i.wkid?i.wkid:JSON.stringify(i),geometries:JSON.stringify((a=t,{geometryType:Object(f.c)(a[0]),geometries:a.map((e=>e.toJSON()))}))}};var a;return function(e,t,n){const r=Object(f.b)(t);return e.map((e=>{const t=r.fromJSON(e);return t.spatialReference=n,t}))}((await Object(d.default)(r.path+"/simplify",o)).data,s,i)}const m=s.a.getLogger("esri.geometry.support.normalizeUtils");function g(e){return"polygon"===e[0].type}function y(e){return"polyline"===e[0].type}function j(e,t){if(!(e instanceof c.a||e instanceof a.a)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw m.error(e),new i.a(e)}const n=Object(u.b)(e),r=[];for(const i of n){const e=[];r.push(e),e.push([i[0][0],i[0][1]]);for(let n=0;n<i.length-1;n++){const r=i[n][0],s=i[n][1],o=i[n+1][0],a=i[n+1][1],c=Math.sqrt((o-r)*(o-r)+(a-s)*(a-s)),u=(a-s)/c,l=(o-r)/c,h=c/t;if(h>1){for(let a=1;a<=h-1;a++){const n=a*t,i=l*n+r,o=u*n+s;e.push([i,o])}const n=(c+Math.floor(h-1)*t)/2,i=l*n+r,o=u*n+s;e.push([i,o])}e.push([o,a])}}return function(e){return"polygon"===e.type}(e)?new a.a({rings:r,spatialReference:e.spatialReference}):new c.a({paths:r,spatialReference:e.spatialReference})}function O(e,t,n){if(t){const t=j(e,1e6);e=Object(h.e)(t,!0)}return n&&(e=Object(u.e)(e,n)),e}function v(e,t,n){if(Array.isArray(e)){const r=e[0];if(r>t){const n=Object(u.d)(r,t);e[0]=r+n*(-2*t)}else if(r<n){const t=Object(u.d)(r,n);e[0]=r+t*(-2*n)}}else{const r=e.x;if(r>t){const n=Object(u.d)(r,t);e=e.clone().offset(n*(-2*t),0)}else if(r<n){const t=Object(u.d)(r,n);e=e.clone().offset(t*(-2*n),0)}}return e}async function _(e,t,n){var i;if(!Array.isArray(e))return _([e],t);const s=null!=(i=null==t?void 0:t.url)?i:r.a.geometryServiceUrl;let m,j,w,x,T,S,F,I,M=0;const E=[],R=[];for(const r of e)if(Object(o.j)(r))R.push(r);else if(m||(m=r.spatialReference,j=Object(l.e)(m),w=m.isWebMercator,S=w?102100:4326,x=u.a[S].maxX,T=u.a[S].minX,F=u.a[S].plus180Line,I=u.a[S].minus180Line),j)if("mesh"===r.type)R.push(r);else if("point"===r.type)R.push(v(r.clone(),x,T));else if("multipoint"===r.type){const e=r.clone();e.points=e.points.map((e=>v(e,x,T))),R.push(e)}else if("extent"===r.type){const e=r.clone()._normalize(!1,!1,j);R.push(e.rings?new a.a(e):e)}else if(r.extent){const e=r.extent,t=Object(u.d)(e.xmin,T)*(2*x);let n=0===t?r.clone():Object(u.e)(r.clone(),t);e.offset(t,0),e.intersects(F)&&e.xmax!==x?(M=e.xmax>M?e.xmax:M,n=O(n,w),E.push(n),R.push("cut")):e.intersects(I)&&e.xmin!==T?(M=e.xmax*(2*x)>M?e.xmax*(2*x):M,n=O(n,w,360),E.push(n),R.push("cut")):R.push(n)}else R.push(r.clone());else R.push(r);let N=Object(u.d)(M,x),k=-90;const C=N,A=new c.a;for(;N>0;){const e=360*N-180;A.addPath([[e,k],[e,-1*k]]),k*=-1,N--}if(E.length>0&&C>0){const t=function(e,t){let n=-1;for(let r=0;r<t.cutIndexes.length;r++){const i=t.cutIndexes[r],s=t.geometries[r],o=Object(u.b)(s);for(let e=0;e<o.length;e++){const t=o[e];t.some((n=>{if(n[0]<180)return!0;{let n=0;for(let e=0;e<t.length;e++){const r=t[e][0];n=r>n?r:n}n=Number(n.toFixed(9));const r=-360*Object(u.d)(n,180);for(let i=0;i<t.length;i++){const t=s.getPoint(e,i);s.setPoint(e,i,t.clone().offset(r,0))}return!0}}))}if(i===n){if(g(e))for(const t of Object(u.b)(s))e[i]=e[i].addRing(t);else if(y(e))for(const t of Object(u.b)(s))e[i]=e[i].addPath(t)}else n=i,e[i]=s}return e}(E,await async function(e,t,n,r){const i="string"==typeof e?Object(p.M)(e):e,s=t[0].spatialReference,o={...r,query:{...i.query,f:"json",sr:JSON.stringify(s),target:JSON.stringify({geometryType:Object(f.c)(t[0]),geometries:t}),cutter:JSON.stringify(n)}},a=await Object(d.default)(i.path+"/cut",o),{cutIndexes:c,geometries:u=[]}=a.data;return{cutIndexes:c,geometries:u.map((e=>{const t=Object(f.a)(e);return t.spatialReference=s,t}))}}(s,E,A,n)),r=[],i=[];for(let n=0;n<R.length;n++){const s=R[n];if("cut"!==s)i.push(s);else{const s=t.shift(),a=e[n];Object(o.k)(a)&&"polygon"===a.type&&a.rings&&a.rings.length>1&&s.rings.length>=a.rings.length?(r.push(s),i.push("simplify")):i.push(w?Object(h.b)(s):s)}}if(!r.length)return i;const a=await b(s,r,n),c=[];for(let e=0;e<i.length;e++){const t=i[e];"simplify"!==t?c.push(t):c.push(w?Object(h.b)(a.shift()):a.shift())}return c}const P=[];for(let r=0;r<R.length;r++){const e=R[r];if("cut"!==e)P.push(e);else{const e=E.shift();P.push(!0===w?Object(h.b)(e):e)}}return Promise.resolve(P)}function w(e,t){const n=Object(l.e)(t);if(n){const[t,r]=n.valid,i=r-t;if(e<t)for(;e<t;)e+=i;if(e>r)for(;e>r;)e-=i}return e}},242:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,i=n(79),s=n(86),o=n(169),a=n(81),c=(n(84),n(82),n(83),n(80)),u=n(194);let l=r=class extends s.a{constructor(e){super(e),this.value=0,this.unit="milliseconds"}toMilliseconds(){return Object(o.a)(this.value,this.unit,"milliseconds")}clone(){return new r({value:this.value,unit:this.unit})}};Object(i.a)([Object(a.b)({type:Number,json:{write:!0},nonNullable:!0})],l.prototype,"value",void 0),Object(i.a)([Object(a.b)({type:u.a.apiValues,json:{type:u.a.jsonValues,read:u.a.read,write:u.a.write},nonNullable:!0})],l.prototype,"unit",void 0),l=r=Object(i.a)([Object(c.a)("esri.TimeInterval")],l);const h=l},243:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return o}));var r=n(85),i=n(212);const s=-3;var o,a;(a=o||(o={}))[a.ALL=0]="ALL",a[a.SOME=1]="SOME";class c{constructor(e,t,n){this._namespace=e,this._storage=t,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",n&&(this._storage.registerRemoveFunc(this._namespace,n),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(e,t,n,r=0){this._storage.put(this._namespace+e,t,n,r)}get(e){const t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}pop(e){const t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,n){this._storage.updateSize(this._namespace+e,t,n)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class u{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new i.a,this._users=new i.a}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}put(e,t,n,r){const i=this._db.get(e);if(i&&(this._size-=i.size,this._db.delete(e),i.entry!==t&&this._notifyRemove(e,i.entry,o.ALL)),n>this._maxSize)return void this._notifyRemove(e,t,o.ALL);if(void 0===t)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return void console.warn("Refusing to cache entry with invalid size "+n);const a=1+Math.max(r,s)-s;this._db.set(e,{entry:t,size:n,lifetime:a,lives:a}),this._size+=n,this._checkSizeLimit()}updateSize(e,t,n){const i=this._db.get(e);if(i&&i.entry===t){for(this._size-=i.size;n>this._maxSize;){const i=this._notifyRemove(e,t,o.SOME);if(!(Object(r.k)(i)&&i>0))return void this._db.delete(e);n=i}i.size=n,this._size+=n,this._checkSizeLimit()}}pop(e){const t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}get(e){const t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}getStats(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},n=new Array;this._db.forEach(((e,r)=>{const i=e.lifetime;n[i]=(n[i]||0)+e.size,this._users.forAll((n=>{const i=n.namespace;if(r.startsWith(i)){const n=t[i]||0;t[i]=n+e.size}}))}));const r={};this._users.forAll((e=>{const n=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){const i=t[n]||0;t[n]=i,r[n]=Math.round(100*e.hitRate)+"%"}else r[n]="0%"}));const i=Object.keys(t);i.sort(((e,n)=>t[n]-t[e])),i.forEach((n=>e[n]=Math.round(t[n]/2**20)+"MB / "+r[n]));for(let o=n.length-1;o>=0;--o){const t=n[o];t&&(e["Priority "+(o+s-1)]=Math.round(t/this.size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){this._db.forEach(((t,n)=>{n.startsWith(e)&&(this._size-=t.size,this._db.delete(n),this._notifyRemove(n,t.entry,o.ALL))}))}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,o.ALL))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,n){let r;return this._removeFuncs.some((i=>{if(e.startsWith(i[0])){const e=i[1](t,n);return"number"==typeof e&&(r=e),!0}return!1})),r}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[e,t]of this._db){if(this._db.delete(e),t.lives<=1){this._size-=t.size;const n=this._notifyRemove(e,t.entry,o.SOME);Object(r.k)(n)&&n>0&&(this._size+=n,t.lives=t.lifetime,t.size=n,this._db.set(e,t))}else--t.lives,this._db.set(e,t);if(this._size<=.9*this.maxSize)return}}}},247:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c}));var r=n(140),i=n(96),s=n(97);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new r.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator}),minus180Line:new r.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new r.a({paths:[[[180,-180],[180,180]]],spatialReference:i.a.WGS84}),minus180Line:new r.a({paths:[[[-180,-180],[-180,180]]],spatialReference:i.a.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function c(e,t){const n=u(e);for(const r of n)for(const e of r)e[0]+=t;return e}function u(e){return Object(s.g)(e)?e.rings:e.paths}function l(e){const t=(null==e?void 0:e.isWebMercator)?102100:4326;return[o[t].minX,o[t].maxX]}},249:function(e,t,n){"use strict";n.r(t),n.d(t,"encodeGeometry",(function(){return d})),n.d(t,"executeQuery",(function(){return f})),n.d(t,"executeQueryForCount",(function(){return y})),n.d(t,"executeQueryForExtent",(function(){return j})),n.d(t,"executeQueryForIds",(function(){return g})),n.d(t,"executeQueryPBF",(function(){return b})),n.d(t,"executeQueryPBFBuffer",(function(){return m})),n.d(t,"queryToQueryStringParameters",(function(){return p})),n.d(t,"runQuery",(function(){return O}));var r=n(103),i=n(85),s=n(98),o=n(97),a=n(229),c=n(325),u=n(486),l=n(304);const h="Layer does not support extent calculation.";function d(e,t){if(t&&"extent"===e.type)return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&"point"===e.type)return`${e.x},${e.y}`;const n=e.toJSON();return delete n.spatialReference,JSON.stringify(n)}function p(e,t){const n=e.geometry,r=e.toJSON();delete r.compactGeometryEnabled,delete r.defaultSpatialReferenceEnabled;const s=r,a=e.outSpatialReference;let c,u;if(Object(i.k)(n)&&(c=n.spatialReference,u=n.spatialReference.wkid||JSON.stringify(n.spatialReference),s.geometryType=Object(o.c)(n),s.geometry=d(n,e.compactGeometryEnabled),s.inSR=u),r.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=r.groupByFieldsForStatistics.join(",")),r.objectIds&&(s.objectIds=r.objectIds.join(",")),r.orderByFields&&(s.orderByFields=r.orderByFields.join(",")),!r.outFields||!r.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete s.outFields:-1!==r.outFields.indexOf("*")?s.outFields="*":s.outFields=r.outFields.join(","),r.outSR?s.outSR=r.outSR.wkid||JSON.stringify(r.outSR):n&&(r.returnGeometry||r.returnCentroid)&&(s.outSR=s.inSR),r.returnGeometry&&delete r.returnGeometry,r.outStatistics&&(s.outStatistics=JSON.stringify(r.outStatistics)),r.pixelSize&&(s.pixelSize=JSON.stringify(r.pixelSize)),r.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&Object(i.k)(c)&&Object(i.k)(e.quantizationParameters)&&Object(i.k)(e.quantizationParameters.extent)&&c.equals(e.quantizationParameters.extent.spatialReference)&&delete r.quantizationParameters.extent.spatialReference,s.quantizationParameters=JSON.stringify(r.quantizationParameters)),r.parameterValues&&(s.parameterValues=JSON.stringify(r.parameterValues)),r.rangeValues&&(s.rangeValues=JSON.stringify(r.rangeValues)),r.dynamicDataSource&&(s.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r.timeExtent){const e=r.timeExtent,{start:t,end:n}=e;null==t&&null==n||(s.time=t===n?t:`${null==t?"null":t},${null==n?"null":n}`),delete r.timeExtent}return e.defaultSpatialReferenceEnabled&&Object(i.k)(c)&&Object(i.k)(a)&&c.equals(a)&&(s.defaultSR=s.inSR,delete s.inSR,delete s.outSR),s}async function f(e,t,n,r){const s=Object(i.k)(t.timeExtent)&&t.timeExtent.isEmpty?{data:{features:[]}}:await O(e,t,"json",r);return Object(l.a)(t,n,s.data),s}async function b(e,t,n,r){if(Object(i.k)(t.timeExtent)&&t.timeExtent.isEmpty)return Promise.resolve({data:n.createFeatureResult()});const s=await m(e,t,r),o=s;return o.data=Object(u.a)(s.data,n),o}function m(e,t,n){return O(e,t,"pbf",n)}function g(e,t,n){return Object(i.k)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):O(e,t,"json",n,{returnIdsOnly:!0})}function y(e,t,n){return Object(i.k)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):O(e,t,"json",n,{returnIdsOnly:!0,returnCountOnly:!0})}function j(e,t,n){return Object(i.k)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):O(e,t,"json",n,{returnExtentOnly:!0,returnCountOnly:!0}).then((e=>{const t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(h);if(t.hasOwnProperty("count"))throw new Error(h);return e}))}function O(e,t,n,o={},u={}){const l="string"==typeof e?Object(s.M)(e):e,h=t.geometry?[t.geometry]:[];return o.responseType="pbf"===n?"array-buffer":"json",Object(a.a)(h,null,o).then((e=>{const a=e&&e[0];Object(i.k)(a)&&((t=t.clone()).geometry=a);const h=Object(c.a)({...l.query,f:n,...u,...p(t,u)});return Object(r.default)(Object(s.B)(l.path,"query"),{...o,query:{...h,...o.query}})}))}},252:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(106);function i(e){return"oid"===e.type||"esriFieldTypeOID"===e.type}function s(e){return"global-id"===e.type||"esriFieldTypeGlobalID"===e.type}class o{constructor(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!e)return;const t=[];for(const o of e){const e=o&&o.name;if(e){const c=a(e);this._fieldsMap.set(e,o),this._fieldsMap.set(c,o),t.push(c),"date"===(n=o).type||"esriFieldTypeDate"===n.type?(this.dateFields.push(o),this._dateFieldsSet.add(o)):Object(r.u)(o)&&(this._numericFieldsSet.add(o),this.numericFields.push(o)),i(o)||s(o)||(o.editable=null==o.editable||!!o.editable,o.nullable=null==o.nullable||!!o.nullable)}}var n;t.sort(),this.uid=t.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)i(e)||s(e)||e.nullable||void 0!==Object(r.r)(e)||this._requiredFields.push(e)}return this._requiredFields}has(e){return null!=this.get(e)}get(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(a(e)):void 0}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){const t=this.get(e);if(t)return t.name}}function a(e){return e.toLowerCase().trim()}},262:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n(85);class i{constructor(e=null,t={},n,r){this.geometry=e,this.attributes=t,this.centroid=n,this.objectId=r,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const e=new i(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}function s(e){return!(Object(r.j)(e.geometry)||!e.geometry.coords||!e.geometry.coords.length)}class o extends i{}},268:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=new(n(90).a)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},274:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(85),i=n(114),s=n(110);function o(e,t,n){if(Object(r.j)(t)||Object(r.j)(n)||n.vcsWkid||Object(s.d)(t,n))return null;const o=Object(i.f)(t)/Object(i.f)(n);if(1===o)return null;switch(e){case"point":case"esriGeometryPoint":return e=>function(e,t){e&&null!=e.z&&(e.z*=t)}(e,o);case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(const n of e.paths)for(const e of n)e.length>2&&(e[2]*=t)}(e,o);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(const n of e.rings)for(const e of n)e.length>2&&(e[2]*=t)}(e,o);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(const n of e.points)n.length>2&&(n[2]*=t)}(e,o);case"extent":case"esriGeometryExtent":return e=>function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,o);default:return null}}},276:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r,i=n(79),s=n(121),o=n(242),a=n(86),c=n(89),u=n(85),l=n(81),h=(n(83),n(93)),d=n(80),p=n(92);n(84),n(82);let f=r=class extends a.a{constructor(e){super(e),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}clone(){const{respectsDaylightSaving:e,timezone:t}=this;return new r({respectsDaylightSaving:e,timezone:t})}};Object(i.a)([Object(l.b)({type:Boolean,json:{write:!0}})],f.prototype,"respectsDaylightSaving",void 0),Object(i.a)([Object(h.a)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],f.prototype,"readRespectsDaylightSaving",null),Object(i.a)([Object(l.b)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],f.prototype,"timezone",void 0),f=r=Object(i.a)([Object(d.a)("esri.layers.support.TimeReference")],f);const b=f;var m,g=n(194);let y=m=class extends a.a{constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;const n=new Date(t.timeExtent[0]),r=new Date(t.timeExtent[1]);return new s.a({start:n,end:r})}writeFullTimeExtent(e,t){e&&Object(u.k)(e.start)&&Object(u.k)(e.end)?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?new o.a({value:t.timeInterval,unit:g.a.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new o.a({value:t.defaultTimeInterval,unit:g.a.fromJSON(t.defaultTimeIntervalUnits)}):null}writeInterval(e,t){if(e){const n=e.toJSON();t.timeInterval=n.value,t.timeIntervalUnits=n.unit}else t.timeInterval=null,t.timeIntervalUnits=null}clone(){const{cumulative:e,endField:t,hasLiveData:n,interval:r,startField:i,timeReference:s,fullTimeExtent:o,trackIdField:a,useTime:u}=this;return new m({cumulative:e,endField:t,hasLiveData:n,interval:r,startField:i,timeReference:Object(c.a)(s),fullTimeExtent:Object(c.a)(o),trackIdField:a,useTime:u})}};Object(i.a)([Object(l.b)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],y.prototype,"cumulative",void 0),Object(i.a)([Object(l.b)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],y.prototype,"endField",void 0),Object(i.a)([Object(l.b)({type:s.a,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"fullTimeExtent",void 0),Object(i.a)([Object(h.a)("fullTimeExtent",["timeExtent"])],y.prototype,"readFullTimeExtent",null),Object(i.a)([Object(p.a)("fullTimeExtent")],y.prototype,"writeFullTimeExtent",null),Object(i.a)([Object(l.b)({type:Boolean,json:{write:!0}})],y.prototype,"hasLiveData",void 0),Object(i.a)([Object(l.b)({type:o.a,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"interval",void 0),Object(i.a)([Object(h.a)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],y.prototype,"readInterval",null),Object(i.a)([Object(p.a)("interval")],y.prototype,"writeInterval",null),Object(i.a)([Object(l.b)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],y.prototype,"startField",void 0),Object(i.a)([Object(l.b)({type:b,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"timeReference",void 0),Object(i.a)([Object(l.b)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],y.prototype,"trackIdField",void 0),Object(i.a)([Object(l.b)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],y.prototype,"useTime",void 0),y=m=Object(i.a)([Object(d.a)("esri.layers.support.TimeInfo")],y);const j=y},277:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(79),i=n(100),s=n(124),o=n(85),a=n(144),c=n(234),u=n(81),l=n(80);let h=class extends i.a{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new s.a,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(e,t,n={}){return this._installWatch(e,t,n,a.e)}addWhen(e,t,n={}){return this._installWatch(e,t,n,a.f)}addOnCollectionChange(e,t,{initial:n=!1}={}){const r=++this.handleId;return this.handles.add([Object(a.b)(e,"after-changes",this._createSyncUpdatingCallback(),a.c),Object(a.b)(e,"change",t,{onListenerAdd:n?e=>t({added:e.toArray(),removed:[]}):void 0})],r),{remove:()=>this.handles.remove(r)}}addPromise(e){if(Object(o.j)(e))return e;const t=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(d)||this._set("updating",!1))}},t),this.pendingPromises.add(e),this._set("updating",!0);const n=()=>this.handles.remove(t);return e.then(n,n),e}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}_installWatch(e,t,n={},r){const i=++this.handleId;n.sync||this._installSyncUpdatingWatch(e,i);const s=r(e,t,n);return this.handles.add(s,i),{remove:()=>this.handles.remove(i)}}_installSyncUpdatingWatch(e,t){const n=this._createSyncUpdatingCallback(),r=Object(a.e)(e,n,{sync:!0,equals:()=>!1});return this.handles.add(r,t),r}_createSyncUpdatingCallback(){return()=>{this.handles.remove(d),++this.scheduleHandleId;const e=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add(Object(c.b)((()=>{e===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove(d))})),d)}}};Object(r.a)([Object(u.b)({readOnly:!0})],h.prototype,"updating",void 0),h=Object(r.a)([Object(l.a)("esri.views.support.WatchUpdatingTracking")],h);const d=-42;var p,f;(f=p||(p={}))[f.NONE=0]="NONE",f[f.SYNC=1]="SYNC",f[f.INIT=2]="INIT"},298:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c}));var r=n(85),i=n(91);function s(e,t,n){return Object(i.i)(e.map(((e,r)=>t.apply(n,[e,r]))))}function o(e,t,n){return Object(i.i)(e.map(((e,r)=>t.apply(n,[e,r])))).then((e=>e.map((e=>e.value))))}function a(e){return Object(r.j)(e)?Object(i.r)():e.then((e=>({ok:!0,value:e}))).catch((e=>({ok:!1,error:e})))}function c(e){return e.then((e=>({ok:!0,value:e}))).catch((e=>(Object(i.s)(e),{ok:!1,error:e})))}},304:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(85),i=n(274);function s(e,t,n){if(!n||!n.features||!n.hasZ)return;const s=Object(i.a)(n.geometryType,t,e.outSpatialReference);if(!Object(r.j)(s))for(const r of n.features)s(r.geometry)}},318:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,i=n(79),s=n(90),o=n(86),a=n(89),c=n(81),u=(n(83),n(80)),l=n(92);const h=new s.a({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let d=r=class extends o.a{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(t.statisticParameters=Object(a.a)(e))}clone(){return new r({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Object(a.a)(this.statisticParameters)})}};Object(i.a)([Object(c.b)({type:Number,json:{write:!0}})],d.prototype,"maxPointCount",void 0),Object(i.a)([Object(c.b)({type:Number,json:{write:!0}})],d.prototype,"maxRecordCount",void 0),Object(i.a)([Object(c.b)({type:Number,json:{write:!0}})],d.prototype,"maxVertexCount",void 0),Object(i.a)([Object(c.b)({type:String,json:{write:!0}})],d.prototype,"onStatisticField",void 0),Object(i.a)([Object(c.b)({type:String,json:{write:!0}})],d.prototype,"outStatisticFieldName",void 0),Object(i.a)([Object(c.b)({type:String,json:{read:{source:"statisticType",reader:h.read},write:{target:"statisticType",writer:h.write}}})],d.prototype,"statisticType",void 0),Object(i.a)([Object(c.b)({type:Object})],d.prototype,"statisticParameters",void 0),Object(i.a)([Object(l.a)("statisticParameters")],d.prototype,"writeStatisticParameters",null),d=r=Object(i.a)([Object(u.a)("esri.rest.support.StatisticDefinition")],d);const p=d},325:function(e,t,n){"use strict";function r(e){const t={};for(const n in e){if("declaredClass"===n)continue;const i=e[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){t[n]=[];for(let e=0;e<i.length;e++)t[n][e]=r(i[e])}else"object"==typeof i?i.toJSON&&(t[n]=JSON.stringify(i)):t[n]=i}return t}n.d(t,"a",(function(){return r}))},328:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return x}));var r=n(85),i=n(97);const s=(e,t,n)=>[t,n],o=(e,t,n)=>[t,n,e[2]],a=(e,t,n)=>[t,n,e[2],e[3]];function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:Object(r.k)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function u({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function l({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function h(e,t,n){const r=[];let i,s,o,a;for(let c=0;c<n.length;c++){const h=n[c];c>0?(o=u(e,h[0]),a=l(e,h[1]),o===i&&a===s||(r.push(t(h,o-i,a-s)),i=o,s=a)):(i=u(e,h[0]),s=l(e,h[1]),r.push(t(h,i,s)))}return r.length>0?r:null}function d({scale:e,translate:t},n){return n*e[0]+t[0]}function p({scale:e,translate:t},n){return t[1]-n*e[1]}function f(e,t,n){const r=new Array(n.length);if(!n.length)return r;const[i,s]=e.scale;let o=d(e,n[0][0]),a=p(e,n[0][1]);r[0]=t(n[0],o,a);for(let c=1;c<n.length;c++){const e=n[c];o+=e[0]*i,a-=e[1]*s,r[c]=t(e,o,a)}return r}function b(e,t,n){const r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=f(e,t,n[i]);return r}function m(e,t,n,r,i){return t.points=function(e,t,n,r){return h(e,n?r?a:o:r?o:s,t)}(e,n.points,r,i),t}function g(e,t,n,r,i){return t.x=u(e,n.x),t.y=l(e,n.y),t!==n&&(r&&(t.z=n.z),i&&(t.m=n.m)),t}function y(e,t,n,r,i){const c=function(e,t,n,r){const i=[],c=n?r?a:o:r?o:s;for(let s=0;s<t.length;s++){const n=h(e,c,t[s]);n&&n.length>=3&&i.push(n)}return i.length?i:null}(e,n.rings,r,i);return c?(t.rings=c,t):null}function j(e,t,n,r,i){const c=function(e,t,n,r){const i=[],c=n?r?a:o:r?o:s;for(let s=0;s<t.length;s++){const n=h(e,c,t[s]);n&&n.length>=2&&i.push(n)}return i.length?i:null}(e,n.paths,r,i);return c?(t.paths=c,t):null}function O(e,t){return e&&t?Object(i.f)(t)?g(e,{},t,!1,!1):Object(i.h)(t)?j(e,{},t,!1,!1):Object(i.g)(t)?y(e,{},t,!1,!1):Object(i.e)(t)?m(e,{},t,!1,!1):Object(i.d)(t)?function(e,t,n,r,i){return t.xmin=u(e,n.xmin),t.ymin=l(e,n.ymin),t.xmax=u(e,n.xmax),t.ymax=l(e,n.ymax),t!==n&&(r&&(t.zmin=n.zmin,t.zmax=n.zmax),i&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}(e,{},t,!1,!1):null:null}function v(e,t,n,i,c){return Object(r.k)(n)&&(t.points=function(e,t,n,r){return f(e,n?r?a:o:r?o:s,t)}(e,n.points,i,c)),t}function _(e,t,n,i,s){return Object(r.j)(n)||(t.x=d(e,n.x),t.y=p(e,n.y),t!==n&&(i&&(t.z=n.z),s&&(t.m=n.m))),t}function w(e,t,n,i,c){return Object(r.k)(n)&&(t.rings=function(e,t,n,r){return b(e,n?r?a:o:r?o:s,t)}(e,n.rings,i,c)),t}function x(e,t,n,i,c){return Object(r.k)(n)&&(t.paths=function(e,t,n,r){return b(e,n?r?a:o:r?o:s,t)}(e,n.paths,i,c)),t}},332:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new r;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},354:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,i=n(79),s=n(86),o=n(81),a=(n(84),n(82),n(83)),c=n(95),u=n(80);let l=r=class extends s.a{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new r({mapLayerId:e,gdbVersion:t})}};Object(i.a)([Object(c.a)({mapLayer:"map-layer"})],l.prototype,"type",void 0),Object(i.a)([Object(o.b)({type:a.a,json:{write:!0}})],l.prototype,"mapLayerId",void 0),Object(i.a)([Object(o.b)({type:String,json:{write:!0}})],l.prototype,"gdbVersion",void 0),l=r=Object(i.a)([Object(u.a)("esri.layers.support.source.MapLayerSource")],l)},357:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,i=n(79),s=(n(99),n(90)),o=n(86),a=n(89),c=n(81),u=(n(83),n(80)),l=n(101);const h=new s.a({upperLeft:"upper-left",lowerLeft:"lower-left"});let d=r=class extends o.a{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new r(Object(a.a)({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};Object(i.a)([Object(c.b)({type:l.a,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],d.prototype,"extent",void 0),Object(i.a)([Object(c.b)({type:["view","edit"],json:{write:!0}})],d.prototype,"mode",void 0),Object(i.a)([Object(c.b)({type:String,json:{read:h.read,write:h.write}})],d.prototype,"originPosition",void 0),Object(i.a)([Object(c.b)({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],d.prototype,"tolerance",void 0),d=r=Object(i.a)([Object(u.a)("esri.rest.support.QuantizationParameters")],d);const p=d},364:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return g}));var r=n(85),i=n(187),s=n(432),o=n(110),a=n(182);const c=[0,0];function u(e,t){if(!t)return null;if("x"in t){const n={x:0,y:0};return[n.x,n.y]=e(t.x,t.y,c),null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=e(t.xmin,t.ymin,c),[n.xmax,n.ymax]=e(t.xmax,t.ymax,c),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n}return"rings"in t?{rings:l(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:l(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:h(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function l(e,t){const n=[];for(const r of e)n.push(h(r,t));return n}function h(e,t){const n=[];for(const r of e){const e=t(r[0],r[1],[0,0]);n.push(e),r.length>2&&e.push(r[2]),r.length>3&&e.push(r[3])}return n}async function d(e,t){if(!t)return;const n=Array.isArray(e)?e.map((e=>Object(r.k)(e.geometry)&&e.geometry.spatialReference)):[e];await Object(i.f)(n.map((e=>({source:e,dest:t}))))}const p=u.bind(null,a.c),f=u.bind(null,a.g);function b(e,t,n){if(!e)return e;if(n||(n=t,t=e.spatialReference),!Object(o.l)(t)||!Object(o.l)(n)||Object(o.d)(t,n))return e;if(Object(a.a)(t,n)){const t=Object(o.p)(n)?p(e):f(e);return t.spatialReference=n,t}return Object(i.m)(s.a,[e],t,n,null)[0]}const m=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,n){if(!e||!e.length||!t||!n||Object(o.d)(t,n))return e;const r={geometries:e,inSpatialReference:t,outSpatialReference:n,resolve:null};return this._jobs.push(r),new Promise((e=>{r.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:n,outSpatialReference:r,resolve:c}=e;Object(a.a)(n,r)?Object(o.p)(r)?c(t.map(p)):c(t.map(f)):c(Object(i.m)(s.a,t,n,r,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function g(e,t,n){return m.push(e,t,n)}},409:function(e,t,n){"use strict";function r(e){return 32+e.length}function i(e){if(!e)return 0;let t=32;for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];switch(typeof i){case"string":t+=r(i);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function s(e,t){return 32+e.length*t}var o;n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(o||(o={}))},432:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){const r=new i(e.getPointX(t),e.getPointY(t),n),s=e.hasZ(t),o=e.hasM(t);return s&&(r.z=e.getPointZ(t)),o&&(r.m=e.getPointM(t)),r},exportPolygon:function(e,t,n){return new s(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new o(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new a(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){const r=e.hasZ(t),i=e.hasM(t),s=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(r){const n=e.getZExtent(t);s.zmin=n.vmin,s.zmax=n.vmax}if(i){const n=e.getMExtent(t);s.mmin=n.vmin,s.mmax=n.vmax}return s}};class i{constructor(e,t,n){this.x=e,this.y=t,this.spatialReference=n,this.z=void 0,this.m=void 0}}class s{constructor(e,t,n,r){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class o{constructor(e,t,n,r){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class a{constructor(e,t,n,r){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),r&&(this.hasM=r)}}class c{constructor(e,t,n,r,i){this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=r,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},440:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r,i=n(79),s=n(90),o=n(86),a=n(85),c=n(114),u=n(81),l=(n(84),n(82),n(83)),h=n(93),d=n(80),p=n(92),f=n(113),b=n(96),m=n(118),g=n(110),y=n(182),j=n(572);const O=new s.a({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let v=r=class extends o.a{constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null}static create(e={}){const{resolutionFactor:t=1,scales:n,size:i=256,spatialReference:s=b.a.WebMercator,numLODs:o=24}=e;if(!Object(g.l)(s)){const e=[];if(n)for(let t=0;t<n.length;t++){const r=n[t];e.push({level:t,scale:r,resolution:r})}else{let t=5e-4;for(let n=o-1;n>=0;n--)e.unshift({level:n,scale:t,resolution:t}),t*=2}return new r({dpi:96,lods:e,origin:new f.a(0,0,s),size:[i,i],spatialReference:s})}const a=Object(g.e)(s),u=e.origin?new f.a({x:e.origin.x,y:e.origin.y,spatialReference:s}):new f.a(a?{x:a.origin[0],y:a.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),l=1/(39.37*Object(c.e)(s)*96),h=[];if(n)for(let r=0;r<n.length;r++){const e=n[r],t=e*l;h.push({level:r,scale:e,resolution:t})}else{let e=Object(g.h)(s)?512/i*591657527.5917094:256/i*591657527.591555;const n=Math.ceil(o/t);h.push({level:0,scale:e,resolution:e*l});for(let r=1;r<n;r++){const n=e/2**t,i=n*l;h.push({level:r,scale:n,resolution:i}),e=n}}return new r({dpi:96,lods:h,origin:u,size:[i,i],spatialReference:s})}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const n=Object(g.e)(e);return e.isWrappable&&Math.abs(n.origin[0]-t.x)<=n.dx}return!1}readOrigin(e,t){return f.a.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,n=0;const r=[];this._levelToLOD={},e&&(t=-1/0,n=1/0,e.forEach((e=>{r.push(e.scale),t=e.scale>t?e.scale:t,n=e.scale<n?e.scale:n,this._levelToLOD[e.level]=e}))),this._set("scales",r),this._set("minScale",t),this._set("maxScale",n),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];{const n=Math.floor(e),r=n+1;return t[n]/(t[n]/t[r])**(e-n)}}scaleToZoom(e){const t=this.scales,n=t.length-1;let r=0;for(;r<n;r++){const n=t[r],i=t[r+1];if(n<=e)return r;if(i===e)return r+1;if(n>e&&i<e)return r+Math.log(n/e)/Math.log(n/i)}return r}snapScale(e,t=.95){const n=this.scaleToZoom(e);return n%Math.floor(n)>=t?this.zoomToScale(Math.ceil(n)):this.zoomToScale(Math.floor(n))}tileAt(e,t,n,r){const i=this.lodAt(e);if(!i)return null;let s,o;if("number"==typeof t)s=t,o=n;else if(Object(g.d)(t.spatialReference,this.spatialReference))s=t.x,o=t.y,r=n;else{const e=Object(y.d)(t,this.spatialReference);if(Object(a.j)(e))return null;s=e.x,o=e.y,r=n}const c=i.resolution*this.size[0],u=i.resolution*this.size[1];return r||(r={id:null,level:0,row:0,col:0,extent:Object(m.l)()}),r.level=e,r.row=Math.floor((this.origin.y-o)/u+.001),r.col=Math.floor((s-this.origin.x)/c+.001),this.updateTileInfo(r),r}updateTileInfo(e,t=r.ExtrapolateOptions.NONE){let n=this.lodAt(e.level);if(!n&&t===r.ExtrapolateOptions.POWER_OF_TWO){const t=this.lods[this.lods.length-1];t.level<e.level&&(n=t)}if(!n)return;const i=e.level-n.level,s=n.resolution*this.size[0]/2**i,o=n.resolution*this.size[1]/2**i;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=Object(m.l)()),e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*o,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+o}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const{resolution:n}=this.lodAt(t.level),r=n*this.size[0],i=n*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+r,e[3]=e[1]+i,e}lodAt(e){return this._levelToLOD&&this._levelToLOD[e]||null}clone(){return r.fromJSON(this.write({}))}getOrCreateCompatible(e,t){if(256===this.size[0]&&256===this.size[1])return 256===e?this:null;const n=[],i=this.lods.length;for(let r=0;r<i;r++){const e=this.lods[r],i=e.resolution*t;n.push(new j.a({level:e.level,scale:e.scale,resolution:i}))}return new r({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:n})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let n=0;n<e.length;n++){const r=e[n];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r}}};Object(i.a)([Object(u.b)({type:Number,json:{write:!0}})],v.prototype,"compressionQuality",void 0),Object(i.a)([Object(u.b)({type:Number,json:{write:!0}})],v.prototype,"dpi",void 0),Object(i.a)([Object(u.b)({type:String,json:{read:O.read,write:O.write,origins:{"web-scene":{read:!1,write:!1}}}})],v.prototype,"format",void 0),Object(i.a)([Object(u.b)({readOnly:!0})],v.prototype,"isWrappable",null),Object(i.a)([Object(u.b)({type:f.a,json:{write:!0}})],v.prototype,"origin",void 0),Object(i.a)([Object(h.a)("origin")],v.prototype,"readOrigin",null),Object(i.a)([Object(u.b)({type:[j.a],value:null,json:{write:!0}})],v.prototype,"lods",null),Object(i.a)([Object(u.b)({readOnly:!0})],v.prototype,"minScale",void 0),Object(i.a)([Object(u.b)({readOnly:!0})],v.prototype,"maxScale",void 0),Object(i.a)([Object(u.b)({readOnly:!0})],v.prototype,"scales",void 0),Object(i.a)([Object(u.b)({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],v.prototype,"size",void 0),Object(i.a)([Object(h.a)("size",["rows","cols"])],v.prototype,"readSize",null),Object(i.a)([Object(p.a)("size",{cols:{type:l.a},rows:{type:l.a}})],v.prototype,"writeSize",null),Object(i.a)([Object(u.b)({type:b.a,json:{write:!0}})],v.prototype,"spatialReference",void 0),v=r=Object(i.a)([Object(d.a)("esri.layers.support.TileInfo")],v),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}(v||(v={}));const _=v},441:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,i,s=n(82),o=n(211);(i=r||(r={}))[i.varint=0]="varint",i[i.fixed64=1]="fixed64",i[i.delimited=2]="delimited",i[i.fixed32=5]="fixed32",i[i.unknown=99]="unknown";const a=4294967296,c=new TextDecoder("utf-8"),u=Object(s.a)("safari")||Object(s.a)("ios")?6:Object(s.a)("ff")?12:32;class l{constructor(e,t,n=0,i=(e?e.byteLength:0)){this._tag=0,this._dataType=r.unknown,this._init(e,t,n,i)}_init(e,t,n,r){this._data=e,this._dataView=t,this._pos=n,this._end=r}clone(){return new l(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;const t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const e=this.getUInt32();return e>>>1^-(1&e)|0}getSInt64(){return this._decodeSVarint()}getBool(){const e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){const e=this._dataView,t=this._pos,n=e.getUint32(t,!0)+e.getUint32(t+4,!0)*a;return this._skip(8),n}getSFixed64(){const e=this._dataView,t=this._pos,n=e.getUint32(t,!0)+e.getInt32(t+4,!0)*a;return this._skip(8),n}getDouble(){const e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){const e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){const e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){const e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){const e=this._getLength(),t=this._pos,n=this._toString(this._data,t,t+e);return this._skip(e),n}getBytes(){const e=this._getLength(),t=this._pos,n=this._toBytes(this._data,t,t+e);return this._skip(e),n}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,n,r){const i=this.getMessage(),s=e(i,t,n,r);return i.release(),s}processMessage(e){const t=this.getMessage(),n=e(t);return t.release(),n}getMessage(){const e=this._getLength(),t=l.pool.acquire();return t._init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){l.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case r.varint:this._decodeVarint();break;case r.fixed64:this._skip(8);break;case r.delimited:this._skip(this._getLength());break;case r.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){const e=this._data;let t,n=this._pos,r=0;if(this._end-n>=10)do{if(t=e[n++],r|=127&t,0==(128&t))break;if(t=e[n++],r|=(127&t)<<7,0==(128&t))break;if(t=e[n++],r|=(127&t)<<14,0==(128&t))break;if(t=e[n++],r|=(127&t)<<21,0==(128&t))break;if(t=e[n++],r+=268435456*(127&t),0==(128&t))break;if(t=e[n++],r+=34359738368*(127&t),0==(128&t))break;if(t=e[n++],r+=4398046511104*(127&t),0==(128&t))break;if(t=e[n++],r+=562949953421312*(127&t),0==(128&t))break;if(t=e[n++],r+=72057594037927940*(127&t),0==(128&t))break;if(t=e[n++],r+=0x8000000000000000*(127&t),0==(128&t))break;throw new Error("Varint too long!")}while(0);else{let i=1;for(;n!==this._end&&(t=e[n],0!=(128&t));)++n,r+=(127&t)*i,i*=128;if(n===this._end)throw new Error("Varint overrun!");++n,r+=t*i}return this._pos=n,r}_decodeSVarint(){const e=this._decodeVarint();return e%2?-(e+1)/2:e/2}_getLength(){if(this._dataType!==r.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,n){if((n=Math.min(this._end,n))-t>u){const r=e.subarray(t,n);return c.decode(r)}let r="",i="";for(let s=t;s<n;++s){const t=e[s];128&t?i+="%"+t.toString(16):(r+=decodeURIComponent(i)+String.fromCharCode(t),i="")}return i.length&&(r+=decodeURIComponent(i)),r}_toBytes(e,t,n){return n=Math.min(this._end,n),new Uint8Array(e.buffer,t,n-t)}}l.pool=new o.a(l,null,(e=>{e._data=null,e._dataView=null}))},451:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(243);class i{constructor(e,t){this._storage=new r.c,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t){this._storage.put(e,t,1,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}},460:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(85);function i(e,t){return e?t?4:3:t?3:2}function s(e,t,n,s,c){if(Object(r.j)(t)||!t.lengths.length)return null;const u="upperLeft"===(null==c?void 0:c.originPosition)?-1:1;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const l=e.coords,h=[],d=n?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:p,coords:f}=t,b=i(n,s);let m=0;for(const r of p){const e=o(d,f,m,r,n,s,u);e&&h.push(e),m+=r*b}if(h.sort(((e,t)=>{let r=u*e[2]-u*t[2];return 0===r&&n&&(r=e[4]-t[4]),r})),h.length){let e=6*h[0][2];l[0]=h[0][0]/e,l[1]=h[0][1]/e,n&&(e=6*h[0][4],l[2]=0!==e?h[0][3]/e:0),(l[0]<d[0]||l[0]>d[1]||l[1]<d[2]||l[1]>d[3]||n&&(l[2]<d[4]||l[2]>d[5]))&&(l.length=0)}if(!l.length){const e=t.lengths[0]?a(f,0,p[0],n,s):null;if(!e)return null;l[0]=e[0],l[1]=e[1],n&&e.length>2&&(l[2]=e[2])}return e}function o(e,t,n,r,s,o,a=1){const c=i(s,o);let u=n,l=n+c,h=0,d=0,p=0,f=0,b=0;for(let i=0,g=r-1;i<g;i++,u+=c,l+=c){const n=t[u],r=t[u+1],i=t[u+2],o=t[l],a=t[l+1],c=t[l+2];let m=n*a-o*r;f+=m,h+=(n+o)*m,d+=(r+a)*m,s&&(m=n*c-o*i,p+=(i+c)*m,b+=m),n<e[0]&&(e[0]=n),n>e[1]&&(e[1]=n),r<e[2]&&(e[2]=r),r>e[3]&&(e[3]=r),s&&(i<e[4]&&(e[4]=i),i>e[5]&&(e[5]=i))}if(f*a>0&&(f*=-1),b*a>0&&(b*=-1),!f)return null;const m=[h,d,.5*f];return s&&(m[3]=p,m[4]=.5*b),m}function a(e,t,n,r,s){const o=i(r,s);let a=t,d=t+o,p=0,f=0,b=0,m=0;for(let i=0,g=n-1;i<g;i++,a+=o,d+=o){const t=e[a],n=e[a+1],i=e[a+2],s=e[d],o=e[d+1],g=e[d+2],y=r?u(t,n,i,s,o,g):c(t,n,s,o);if(y)if(p+=y,r){const e=h(t,n,i,s,o,g);f+=y*e[0],b+=y*e[1],m+=y*e[2]}else{const e=l(t,n,s,o);f+=y*e[0],b+=y*e[1]}}return p>0?r?[f/p,b/p,m/p]:[f/p,b/p]:n>0?r?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function c(e,t,n,r){const i=n-e,s=r-t;return Math.sqrt(i*i+s*s)}function u(e,t,n,r,i,s){const o=r-e,a=i-t,c=s-n;return Math.sqrt(o*o+a*a+c*c)}function l(e,t,n,r){return[e+.5*(n-e),t+.5*(r-t)]}function h(e,t,n,r,i,s){return[e+.5*(r-e),t+.5*(i-t),n+.5*(s-n)]}},469:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(114),i=n(110),s=n(262),o=n(332),a=n(168);const c=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class u{constructor(e){this.options=e,this.geometryTypes=c,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new o.a}prepareFeatures(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}finishFeatureResult(e){if(!e||!e.features||!e.hasZ||!this.options.sourceSpatialReference||!e.spatialReference||Object(i.d)(e.spatialReference,this.options.sourceSpatialReference)||e.spatialReference.vcsWkid)return;const t=Object(r.f)(this.options.sourceSpatialReference)/Object(r.f)(e.spatialReference);if(1!==t)for(const n of e.features){if(!Object(s.c)(n))continue;const e=n.geometry.coords;for(let n=2;n<e.length;n+=3)e[n]*=t}}addFeature(e,t){e.features.push(t)}createFeature(){return new s.a}createSpatialReference(){return{wkid:0}}createGeometry(){return new a.a}addField(e,t){e.fields.push(t)}allocateCoordinates(e){e.coords.length=e.lengths.reduce(((e,t)=>e+t),0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(e,t){e.coords[this._coordinatePtr++]=t}addCoordinatePoint(e,t){e.coords.push(t)}addLength(e,t){e.lengths.push(t)}addQueryGeometry(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}createPointGeometry(){return new a.a}}},482:function(e,t,n){"use strict";n.d(t,"a",(function(){return M})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return x}));var r=n(88),i=n(85),s=n(441),o=n(168),a=n(469);const c=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],u=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],l=["upperLeft","lowerLeft"];function h(e){return e>=c.length?null:c[e]}function d(e){return e>=u.length?null:u[e]}function p(e){return e>=l.length?null:l[e]}function f(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function b(e,t,n){const r=t.createPointGeometry(n);for(;e.next();)switch(e.tag()){case 3:{const n=e.getUInt32(),i=e.pos()+n;let s=0;for(;e.pos()<i;)t.addCoordinatePoint(r,e.getSInt64(),s++);break}default:e.skip()}return r}function m(e,t,n){const r=t.createGeometry(n),i=2+(n.hasZ?1:0)+(n.hasM?1:0);for(;e.next();)switch(e.tag()){case 2:{const n=e.getUInt32(),i=e.pos()+n;let s=0;for(;e.pos()<i;)t.addLength(r,e.getUInt32(),s++);break}case 3:{const n=e.getUInt32(),s=e.pos()+n;let o=0;for(t.allocateCoordinates(r);e.pos()<s;)t.addCoordinate(r,e.getSInt64(),o),o++,o===i&&(o=0);break}default:e.skip()}return r}function g(e){const t=new o.a;let n="esriGeometryPoint";for(;e.next();)switch(e.tag()){case 2:{const n=e.getUInt32(),r=e.pos()+n;for(;e.pos()<r;)t.lengths.push(e.getUInt32());break}case 3:{const n=e.getUInt32(),r=e.pos()+n;for(;e.pos()<r;)t.coords.push(e.getSInt64());break}case 1:n=a.a[e.getEnum()];break;default:e.skip()}return{queryGeometry:t,queryGeometryType:n}}function y(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function j(e){const t={type:h(0)};for(;e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=h(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=d(e.getEnum());break;default:e.skip();break;case 6:t.defaultValue=e.getString()}return t}function O(e){const t={};for(;e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip()}return t}function v(e,t,n,r){const i=t.createFeature(n);let s=0;for(;e.next();)switch(e.tag()){case 1:{const t=r[s++].name;i.attributes[t]=e.processMessage(y);break}case 2:i.geometry=e.processMessageWithArgs(m,t,n);break;case 4:i.centroid=e.processMessageWithArgs(b,t,n);break;default:e.skip()}return i}function _(e){const t=[1,1,1,1];for(;e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function w(e){const t=[0,0,0,0];for(;e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function x(e){const t={originPosition:p(0)};for(;e.next();)switch(e.tag()){case 1:t.originPosition=p(e.getEnum());break;case 2:t.scale=e.processMessage(_);break;case 3:t.translate=e.processMessage(w);break;default:e.skip()}return t}function T(e){const t={};for(;e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function S(e,t){const n=t.createSpatialReference();for(;e.next();)switch(e.tag()){case 1:n.wkid=e.getUInt32();break;case 5:n.wkt=e.getString();break;case 2:n.latestWkid=e.getUInt32();break;case 3:n.vcsWkid=e.getUInt32();break;case 4:n.latestVcsWkid=e.getUInt32();break;default:e.skip()}return n}function F(e,t){const n=t.createFeatureResult();n.geometryType=f(t,0);let r=!1;for(;e.next();)switch(e.tag()){case 1:n.objectIdFieldName=e.getString();break;case 3:n.globalIdFieldName=e.getString();break;case 4:n.geohashFieldName=e.getString();break;case 5:n.geometryProperties=e.processMessage(T);break;case 7:n.geometryType=f(t,e.getEnum());break;case 8:n.spatialReference=e.processMessageWithArgs(S,t);break;case 10:n.hasZ=e.getBool();break;case 11:n.hasM=e.getBool();break;case 12:n.transform=e.processMessage(x);break;case 9:{const t=e.getBool();n.exceededTransferLimit=t;break}case 13:t.addField(n,e.processMessage(j));break;case 15:r||(t.prepareFeatures(n),r=!0),t.addFeature(n,e.processMessageWithArgs(v,t,n,n.fields));break;case 2:n.uniqueIdField=e.processMessage(O);break;default:e.skip()}return t.finishFeatureResult(n),n}function I(e,t){const n={};let r=null;for(;e.next();)switch(e.tag()){case 4:r=e.processMessageWithArgs(g);break;case 1:n.featureResult=e.processMessageWithArgs(F,t);break;default:e.skip()}return Object(i.k)(r)&&n.featureResult&&t.addQueryGeometry(n,r),n}function M(e,t){try{const n=2,r=new s.a(new Uint8Array(e),new DataView(e)),i={};for(;r.next();)r.tag()===n?i.queryResult=r.processMessageWithArgs(I,t):r.skip();return i}catch(n){throw new r.a("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:n})}}},486:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(482);function i(e,t){const n=Object(r.a)(e,t),i=n.queryResult.featureResult,s=n.queryResult.queryGeometry,o=n.queryResult.queryGeometryType;if(i&&i.features&&i.features.length&&i.objectIdFieldName){const e=i.objectIdFieldName;for(const t of i.features)t.attributes&&(t.objectId=t.attributes[e])}return i&&(i.queryGeometry=s,i.queryGeometryType=o),i}},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return l}));var r=n(88),i=n(451),s=n(285);const o=new class{constructor(e,t){this._cache=new i.a(e),this._invalidCache=new i.a(t)}get(e,t){const n=`${t.uid}:${e}`,r=this._cache.get(n);if(r)return r;if(void 0!==this._invalidCache.get(n))return null;try{const r=s.WhereClause.create(e,t);return this._cache.put(n,r),r}catch{return this._invalidCache.put(n,null),null}}}(50,500),a="feature-store:unsupported-query",c=" as ",u=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function l(e,t){if(!t)return!0;const n=o.get(t,e);if(!n)throw new r.a(a,"invalid SQL expression",{where:t});if(!n.isStandardized)throw new r.a(a,"where clause is not standard",{where:t});return p(e,n.fieldNames,"where clause contains missing fields"),!0}function h(e,t,n){if(!t)return!0;const i=o.get(t,e);if(!i)throw new r.a(a,"invalid SQL expression",{having:t});if(!i.isAggregate)throw new r.a(a,"having does not contain a valid aggregate function",{having:t});const s=i.fieldNames;if(p(e,s,"having contains missing fields"),!i.getExpressions().every((t=>{const{aggregateType:r,field:i}=t,s=e.has(i)&&e.get(i).name;return n.some((t=>{const{onStatisticField:n,statisticType:i}=t;return(e.has(n)&&e.get(n).name)===s&&i.toLowerCase().trim()===r}))})))throw new r.a(a,"expressions in having should also exist in outStatistics",{having:t});return!0}function d(e,t){return e?o.get(e,t):null}function p(e,t,n,i=!0){const s=[];for(const c of t)if("*"!==c&&!e.has(c))if(i){const t=f(c);try{const n=d(t,e);if(!n)throw new r.a(a,"invalid SQL expression",{where:t});if(!n.isStandardized)throw new r.a(a,"expression is not standard",{clause:n});p(e,n.fieldNames,"expression contains missing fields")}catch(o){const e=o&&o.details;if(e&&(e.clause||e.where))throw o;e&&e.missingFields?s.push(...e.missingFields):s.push(c)}}else s.push(c);if(s.length)throw new r.a(a,n,{missingFields:s})}function f(e){return e.split(c)[0]}function b(e){return e.split(c)[1]}function m(e,t){const n=t.get(e);return!!n&&!u.has(n.type)}},572:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r,i=n(79),s=n(86),o=n(81),a=(n(84),n(82),n(83)),c=n(80);let u=r=class extends s.a{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new r({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};Object(i.a)([Object(o.b)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],u.prototype,"cols",void 0),Object(i.a)([Object(o.b)({type:a.a,json:{write:!0}})],u.prototype,"level",void 0),Object(i.a)([Object(o.b)({type:String,json:{write:!0}})],u.prototype,"levelValue",void 0),Object(i.a)([Object(o.b)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],u.prototype,"origin",void 0),Object(i.a)([Object(o.b)({type:Number,json:{write:!0}})],u.prototype,"resolution",void 0),Object(i.a)([Object(o.b)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],u.prototype,"rows",void 0),Object(i.a)([Object(o.b)({type:Number,json:{write:!0}})],u.prototype,"scale",void 0),u=r=Object(i.a)([Object(c.a)("esri.layers.support.LOD")],u);const l=u},588:function(e,t,n){"use strict";n.r(t),n.d(t,"FeatureServiceSnappingSourceWorker",(function(){return K})),n.d(t,"default",(function(){return ee}));var r=n(79),i=n(138),s=n(124),o=n(85),a=n(91),c=n(136),u=n(81),l=n(84),h=(n(82),n(83),n(80)),d=n(96),p=n(934),f=n(848),b=n(440),m=n(276),g=n(145),y=n(100);let j=class extends y.a{constructor(){super(...arguments),this.updating=!1,this.pending=[]}push(e,t){this.pending.push({promise:e,callback:t}),1===this.pending.length&&this._process()}_process(){if(!this.pending.length)return void(this.updating=!1);this.updating=!0;const e=this.pending[0];e.promise.then((t=>e.callback(t))).catch((()=>{})).then((()=>{this.pending.shift(),this._process()}))}};Object(r.a)([Object(u.b)()],j.prototype,"updating",void 0),j=Object(r.a)([Object(h.a)("esri.core.AsyncSequence")],j);var O,v,_=n(134),w=n(183),x=n(87),T=n(144),S=n(101),F=n(118),I=n(160),M=n(469),E=n(249),R=n(298);class N{constructor(e,t){this.data=e,this.resolution=t,this.state={type:O.CREATED},this.alive=!0}process(e){switch(this.state.type){case O.CREATED:return this.state=this._gotoFetchCount(this.state,e),this.state.task.promise.then(e.resume,e.resume);case O.FETCH_COUNT:break;case O.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,e),this.state.task.promise.then(e.resume,e.resume);case O.FETCH_FEATURES:break;case O.FETCHED_FEATURES:this.state=this._goToDone(this.state,e);case O.DONE:}return null}get debugInfo(){return{data:this.data,featureCount:this.featureCount,state:this.stateToString}}get featureCount(){switch(this.state.type){case O.CREATED:case O.FETCH_COUNT:return 0;case O.FETCHED_COUNT:return this.state.featureCount;case O.FETCH_FEATURES:return this.state.previous.featureCount;case O.FETCHED_FEATURES:return this.state.features.length;case O.DONE:return this.state.previous.features.length}}get stateToString(){switch(this.state.type){case O.CREATED:return"created";case O.FETCH_COUNT:return"fetch-count";case O.FETCHED_COUNT:return"fetched-count";case O.FETCH_FEATURES:return"fetch-features";case O.FETCHED_FEATURES:return"fetched-features";case O.DONE:return"done"}}_gotoFetchCount(e,t){return{type:O.FETCH_COUNT,previous:e,task:Object(a.g)((async e=>{const n=await Object(R.d)(t.fetchCount(this,e));this.state.type===O.FETCH_COUNT&&(this.state=this._gotoFetchedCount(this.state,n.ok?n.value:1/0))}))}}_gotoFetchedCount(e,t){return{type:O.FETCHED_COUNT,featureCount:t,previous:e}}_gotoFetchFeatures(e,t){return{type:O.FETCH_FEATURES,previous:e,task:Object(a.g)((async n=>{const r=await Object(R.d)(t.fetchFeatures(this,e.featureCount,n));this.state.type===O.FETCH_FEATURES&&(this.state=this._gotoFetchedFeatures(this.state,r.ok?r.value:[]))}))}}_gotoFetchedFeatures(e,t){return{type:O.FETCHED_FEATURES,previous:e,features:t}}_goToDone(e,t){return t.finish(this,e.features),{type:O.DONE,previous:e}}reset(){const e=this.state;switch(this.state={type:O.CREATED},e.type){case O.CREATED:case O.FETCHED_COUNT:case O.FETCHED_FEATURES:case O.DONE:break;case O.FETCH_COUNT:case O.FETCH_FEATURES:e.task.abort()}}intersects(e){return!(!Object(o.j)(e)&&this.data.extent)||(Object(F.q)(e,k),Object(F.t)(this.data.extent,k))}}(v=O||(O={}))[v.CREATED=0]="CREATED",v[v.FETCH_COUNT=1]="FETCH_COUNT",v[v.FETCHED_COUNT=2]="FETCHED_COUNT",v[v.FETCH_FEATURES=3]="FETCH_FEATURES",v[v.FETCHED_FEATURES=4]="FETCHED_FEATURES",v[v.DONE=5]="DONE";const k=Object(F.l)(),C=x.a.getLogger("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher");let A=class extends _.a{constructor(e){super(e),this.tilesOfInterest=[],this.availability=0,this.pendingTiles=new Map,this.pendingEdits=new j,this.pendingEditsAbortController=new AbortController}get minimumVerticesPerFeature(){var e;switch(null==(e=this.store)?void 0:e.featureStore.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":return 1;case"esriGeometryPolygon":return 4;case"esriGeometryPolyline":return 2}}set filter(e){const t=this._get("filter"),n=this._filterProperties(e);JSON.stringify(t)!==JSON.stringify(n)&&this._set("filter",n)}set customParameters(e){const t=this._get("customParameters");JSON.stringify(t)!==JSON.stringify(e)&&this._set("customParameters",e)}get configuration(){return{filter:this.filter,customParameters:this.customParameters,tileInfo:this.tileInfo,tileSize:this.tileSize}}set tileInfo(e){const t=this._get("tileInfo");t!==e&&(Object(o.k)(e)&&Object(o.k)(t)&&JSON.stringify(e)===JSON.stringify(t)||(this._set("tileInfo",e),this.store.tileInfo=e))}set tileSize(e){this._get("tileSize")!==e&&this._set("tileSize",e)}get updating(){return this.updatingHandles.updating||this.pendingEdits.updating}initialize(){this._initializeFetchExtent(),this.updatingHandles.add((()=>this.configuration),(()=>this.refresh())),this.updatingHandles.add((()=>this.tilesOfInterest),((e,t)=>{Object(l.c)(e,t,(({id:e},{id:t})=>e===t))||this._process()}),T.c)}destroy(){this.pendingTiles.forEach((e=>this._deletePendingTile(e))),this.pendingTiles.clear(),this.store.destroy(),this.tilesOfInterest.length=0,this.pendingEditsAbortController.abort(),this.pendingEditsAbortController=null}refresh(){this.store.refresh(),this.pendingTiles.forEach((e=>this._deletePendingTile(e))),this._process()}applyEdits(e){this.pendingEdits.push(e,(async e=>{if(0===e.addedFeatures.length&&0===e.updatedFeatures.length&&0===e.deletedFeatures.length)return;for(const[,n]of this.pendingTiles)n.reset();const t={...e,deletedFeatures:e.deletedFeatures.map((({objectId:e,globalId:t})=>e&&-1!==e?e:this._lookupObjectIdByGlobalId(t)))};await this.updatingHandles.addPromise(this.store.processEdits(t,((e,t)=>this._queryFeaturesById(e,t)),this.pendingEditsAbortController.signal)),this._processPendingTiles()}))}_initializeFetchExtent(){if(!this.capabilities.query.supportsExtent)return;const e=Object(a.g)((async e=>{try{var t;const n=await Object(E.executeQueryForExtent)(this.url,new g.a({where:"1=1",outSpatialReference:this.spatialReference,cacheHint:!!this.capabilities.query.supportsCacheHint||void 0}),{query:this.configuration.customParameters,signal:e});this.store.extent=S.a.fromJSON(null==(t=n.data)?void 0:t.extent)}catch(n){Object(a.s)(n),C.warn("Failed to fetch data extent",n)}}));this.updatingHandles.addPromise(e.promise.then((()=>this._process()))),this.handles.add(Object(w.c)((()=>e.abort())))}get debugInfo(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this.pendingTiles.values()).map((e=>e.debugInfo)),storedTiles:this.store.debugInfo}}_process(){this._markTilesNotAlive(),this._createPendingTiles(),this._deletePendingTiles(),this._processPendingTiles()}_markTilesNotAlive(){for(const[,e]of this.pendingTiles)e.alive=!1}_createPendingTiles(){const e=this._collectMissingTilesInfo();if(this._setAvailability(Object(o.j)(e)?1:e.coveredArea/e.fullArea),!Object(o.j)(e))for(const{data:t,resolution:n}of e.missingTiles){const e=this.pendingTiles.get(t.id);e?(e.resolution=n,e.alive=!0):this._createPendingTile(t,n)}}_collectMissingTilesInfo(){let e=null;for(let t=this.tilesOfInterest.length-1;t>=0;t--){const n=this.tilesOfInterest[t],r=this.store.process(n,((e,t)=>this._verifyTileComplexity(e,t)));Object(o.j)(e)?e=r:e.prepend(r)}return e}_deletePendingTiles(){for(const[,e]of this.pendingTiles)e.alive||this._deletePendingTile(e)}_processPendingTiles(){const e={fetchCount:(e,t)=>this._fetchCount(e,t),fetchFeatures:(e,t,n)=>this._fetchFeatures(e,t,n),finish:(e,t)=>this._finishPendingTile(e,t),resume:()=>this._processPendingTiles()};if(this._ensureFetchAllCounts(e))for(const[,t]of this.pendingTiles)this._verifyTileComplexity(this.store.getFeatureCount(t.data),t.resolution)&&this.updatingHandles.addPromise(t.process(e))}_verifyTileComplexity(e,t){return this._verifyVertexComplexity(e)&&this._verifyFeatureDensity(e,t)}_verifyVertexComplexity(e){return e*this.minimumVerticesPerFeature<z}_verifyFeatureDensity(e,t){if(Object(o.j)(this.tileInfo))return!1;const n=this.tileSize*t;return e*(V/(n*n))<q}_ensureFetchAllCounts(e){let t=!0;for(const[,n]of this.pendingTiles)n.state.type<O.FETCHED_COUNT&&this.updatingHandles.addPromise(n.process(e)),n.state.type<=O.FETCH_COUNT&&(t=!1);return t}_finishPendingTile(e,t){this.store.add(e.data,t),this._deletePendingTile(e),this._updateAvailability()}_updateAvailability(){const e=this._collectMissingTilesInfo();this._setAvailability(Object(o.j)(e)?1:e.coveredArea/e.fullArea)}_setAvailability(e){this._set("availability",e)}_createPendingTile(e,t){const n=new N(e,t);return this.pendingTiles.set(e.id,n),n}_deletePendingTile(e){e.reset(),this.pendingTiles.delete(e.data.id)}async _fetchCount(e,t){return this.store.fetchCount(e.data,this.url,this._createCountQuery(e),{query:this.customParameters,timeout:D,signal:t})}async _fetchFeatures(e,t,n){let r,i=0,s=0,a=t;for(;;){const c=this._createFeaturesQuery(e),u=this._setPagingParameters(c,i,a),{features:l,exceededTransferLimit:h}=await this._queryFeatures(c,n);if(u&&(i+=Object(o.s)(c.num)),s+=l.length,r=r?r.concat(l):l,a=t-s,!u||!h||a<=0)return r}}_filterProperties(e){return Object(o.j)(e)?{where:"1=1",gdbVersion:void 0,timeExtent:void 0}:{where:e.where||"1=1",timeExtent:e.timeExtent,gdbVersion:e.gdbVersion}}_lookupObjectIdByGlobalId(e){const t=this.globalIdField,n=this.objectIdField;if(Object(o.j)(t))throw new Error("Expected globalIdField to be defined");let r=null;if(this.store.featureStore.forEach((i=>{var s;e===i.attributes[t]&&(r=null!=(s=i.objectId)?s:i.attributes[n])})),Object(o.j)(r))throw new Error(`Expected to find a feature with globalId ${e}`);return r}_queryFeaturesById(e,t){const n=this._createFeaturesQuery(null);return n.objectIds=e,this._queryFeatures(n,t)}_queryFeatures(e,t){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(e,t):this._queryFeaturesJSON(e,t)}async _queryFeaturesPBF(e,t){const{sourceSpatialReference:n}=this,{data:r}=await Object(E.executeQueryPBF)(this.url,e,new M.b({sourceSpatialReference:n}),{query:this.configuration.customParameters,timeout:D,signal:t});return Object(I.y)(r)}async _queryFeaturesJSON(e,t){const{sourceSpatialReference:n}=this,{data:r}=await Object(E.executeQuery)(this.url,e,n,{query:this.configuration.customParameters,timeout:D,signal:t});return Object(I.b)(r,this.objectIdField)}_createCountQuery(e){const t=this._createBaseQuery(e);return this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0),t}_createFeaturesQuery(e){const t=this._createBaseQuery(e);return t.outFields=this.globalIdField?[this.globalIdField,this.objectIdField]:[this.objectIdField],t.returnGeometry=!0,Object(o.k)(e)&&(this.capabilities.query.supportsResultType?t.resultType="tile":this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0)),t}_createBaseQuery(e){const t=new g.a({returnZ:!1,returnM:!1,geometry:Object(o.k)(this.tileInfo)&&Object(o.k)(e)?Object(F.v)(e.data.extent,this.tileInfo.spatialReference):void 0}),n=this.configuration.filter;return Object(o.k)(n)&&(t.where=n.where,t.gdbVersion=n.gdbVersion,t.timeExtent=n.timeExtent),t.outSpatialReference=this.spatialReference,t}_setPagingParameters(e,t,n){if(!this.capabilities.query.supportsPagination)return!1;const{supportsMaxRecordCountFactor:r,supportsCacheHint:i,tileMaxRecordCount:s,maxRecordCount:o,supportsResultType:a}=this.capabilities.query,c=r?g.a.MAX_MAX_RECORD_COUNT_FACTOR:1,u=c*((a||i)&&s?s:o||P);return e.start=t,r?(e.maxRecordCountFactor=Math.min(c,Math.ceil(n/u)),e.num=Math.min(n,e.maxRecordCountFactor*u)):e.num=Math.min(n,u),!0}};Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"url",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"objectIdField",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"globalIdField",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"capabilities",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"sourceSpatialReference",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"spatialReference",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],A.prototype,"store",void 0),Object(r.a)([Object(u.b)({readOnly:!0})],A.prototype,"minimumVerticesPerFeature",null),Object(r.a)([Object(u.b)()],A.prototype,"filter",null),Object(r.a)([Object(u.b)()],A.prototype,"customParameters",null),Object(r.a)([Object(u.b)({readOnly:!0})],A.prototype,"configuration",null),Object(r.a)([Object(u.b)()],A.prototype,"tileInfo",null),Object(r.a)([Object(u.b)()],A.prototype,"tileSize",null),Object(r.a)([Object(u.b)()],A.prototype,"tilesOfInterest",void 0),Object(r.a)([Object(u.b)({readOnly:!0})],A.prototype,"updating",null),Object(r.a)([Object(u.b)({readOnly:!0})],A.prototype,"availability",void 0),A=Object(r.a)([Object(h.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],A);const P=2e3,D=6e5,z=1e6,V=25,q=1;var G=n(409),U=n(1215);class L{constructor(){this._store=new Map,this._byteSize=0}set(e,t){this.delete(e),this._store.set(e,t),this._byteSize+=t.byteSize}delete(e){const t=this._store.get(e);return!!this._store.delete(e)&&(this._byteSize-=t.byteSize,!0)}get(e){return this._used(e),this._store.get(e)}has(e){return this._used(e),this._store.has(e)}clear(){this._store.clear()}applyByteSizeLimit(e,t){for(const[n,r]of this._store){if(this._byteSize<=e)break;this.delete(n),t(r)}}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}_used(e){const t=this._store.get(e);t&&(this._store.delete(e),this._store.set(e,t))}}let B=class extends y.a{constructor(e){super(e),this.tileInfo=null,this.extent=null,this.maximumByteSize=10*G.a.MEGABYTES,this.tileBounds=new U.a,this.tiles=new L,this.refCounts=new Map,this.tileFeatureCounts=new Map,this.tmpBoundingRect=Object(F.l)()}add(e,t){const n=[];for(const r of t)this._referenceFeature(r.objectId)===Q.ADDED&&n.push(r);this._addTileStorage(e,new Set(t.map((({objectId:e})=>e))),function(e){return e.reduce(((e,t)=>e+function(e){return 32+function(e){if(Object(o.j)(e))return 0;const t=Object(G.c)(e.lengths,4);return 32+Object(G.c)(e.coords,8)+t}(e.geometry)+Object(G.b)(e.attributes)}(t)),0)}(t)),this.featureStore.addMany(n),this.tiles.applyByteSizeLimit(this.maximumByteSize,(e=>this._removeTileStorage(e)))}destroy(){this.clear(),this.tileFeatureCounts.clear()}clear(){this.featureStore.clear(),this.tileBounds.clear(),this.tiles.clear(),this.refCounts.clear()}refresh(){this.clear(),this.tileFeatureCounts.clear()}processEdits(e,t,n){return this._processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)),this._processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures),t,n)}_addTileStorage(e,t,n){this.tiles.set(e.id,new H(e,t,n)),this.tileBounds.set(e.id,e.extent),this.tileFeatureCounts.set(e.id,t.size)}_remove({id:e}){const t=this.tiles.get(e);t&&this._removeTileStorage(t)}_removeTileStorage(e){const t=[];for(const r of e.objectIds)this._unreferenceFeature(r)===Q.REMOVED&&t.push(r);this.featureStore.removeManyById(t);const n=e.data.id;this.tiles.delete(n),this.tileBounds.delete(n)}_processEditsDelete(e){this.featureStore.removeManyById(e);for(const[,t]of this.tiles){for(const n of e)t.objectIds.delete(n);this.tileFeatureCounts.set(t.data.id,t.objectIds.size)}for(const t of e)this.refCounts.delete(t)}async _processEditsRefetch(e,t,n){const r=(await t(e,n)).features,{hasZ:i,hasM:s}=this.featureStore;for(const a of r){const e=Object(I.r)(this.tmpBoundingRect,a.geometry,i,s);Object(o.j)(e)||this.tileBounds.forEachInBounds(e,(e=>{const t=this.tiles.get(e);this.featureStore.add(a),t.objectIds.has(a.objectId)||(t.objectIds.add(a.objectId),this._referenceFeature(a.objectId),this.tileFeatureCounts.set(t.data.id,t.objectIds.size))}))}}process(e,t=(()=>!0)){if(Object(o.j)(this.tileInfo)||!e.extent||Object(o.k)(this.extent)&&!Object(F.t)(Object(F.q)(this.extent,this.tmpBoundingRect),e.extent))return new Y(e);if(this.tiles.has(e.id))return new Y(e);const n=this._createTileTree(e,this.tileInfo);return this._simplify(n,t,null,0,1),this._collectMissingTiles(e,n,this.tileInfo)}get debugInfo(){return Array.from(this.tiles.values()).map((({data:e})=>({data:e,featureCount:this.tileFeatureCounts.get(e.id)||0})))}getFeatureCount(e){const t=this.tileFeatureCounts.get(e.id);return null!=t?t:0}async fetchCount(e,t,n,r){const i=this.tileFeatureCounts.get(e.id);if(null!=i)return i;const s=await Object(E.executeQueryForCount)(t,n,r);return this.tileFeatureCounts.set(e.id,s.data.count),s.data.count}_createTileTree(e,t){const n=new Z(e.level,e.row,e.col);return t.updateTileInfo(n,b.a.ExtrapolateOptions.POWER_OF_TWO),this.tileBounds.forEachInBounds(e.extent,(r=>{const i=this.tiles.get(r).data;this._tilesAreRelated(e,i)&&this._populateChildren(n,i,t,this.tileFeatureCounts.get(i.id)||0)})),n}_tilesAreRelated(e,t){if(!e||!t)return!1;if(e.level===t.level)return e.row===t.row&&e.col===t.col;const n=e.level<t.level,r=n?e:t,i=n?t:e,s=1<<i.level-r.level;return Math.floor(i.row/s)===r.row&&Math.floor(i.col/s)===r.col}_populateChildren(e,t,n,r){const i=t.level-e.level-1;if(i<0)return void(e.isLeaf=!0);const s=t.row>>i,a=t.col>>i,c=e.row<<1,u=a-(e.col<<1)+(s-c<<1),l=e.children[u];if(Object(o.k)(l))this._populateChildren(l,t,n,r);else{const i=new Z(e.level+1,s,a);n.updateTileInfo(i,b.a.ExtrapolateOptions.POWER_OF_TWO),e.children[u]=i,this._populateChildren(i,t,n,r)}}_simplify(e,t,n,r,i){const s=i*i;if(e.isLeaf)return t(this.getFeatureCount(e),i)?0:(this._remove(e),Object(o.k)(n)&&(n.children[r]=null),s);const a=i/2,c=a*a;let u=0;for(let l=0;l<e.children.length;l++){const n=e.children[l];u+=Object(o.k)(n)?this._simplify(n,t,e,l,a):c}return 0===u?this._mergeChildren(e):1-u/s<W&&(this._purge(e),Object(o.k)(n)&&(n.children[r]=null),u=s),u}_mergeChildren(e){const t=new Set;let n=0;this._forEachLeaf(e,(e=>{const r=this.tiles.get(e.id);if(r){n+=r.byteSize;for(const e of r.objectIds)t.has(e)||(t.add(e),this._referenceFeature(e));this._remove(e)}})),this._addTileStorage(e,t,n),e.isLeaf=!0,e.children[0]=e.children[1]=e.children[2]=e.children[3]=null,this.tileFeatureCounts.set(e.id,t.size)}_forEachLeaf(e,t){for(const n of e.children)Object(o.j)(n)||(n.isLeaf?t(n):this._forEachLeaf(n,t))}_purge(e){if(!Object(o.j)(e))if(e.isLeaf)this._remove(e);else for(let t=0;t<e.children.length;t++){const n=e.children[t];this._purge(n),e.children[t]=null}}_collectMissingTiles(e,t,n){const r=new J(n,e,this.extent);return this._collectMissingTilesRecurse(t,r,1),r.info}_collectMissingTilesRecurse(e,t,n){if(e.isLeaf)return;if(!e.hasChildren)return void t.addMissing(e.level,e.row,e.col,n);const r=n/2;for(let i=0;i<e.children.length;i++){const n=e.children[i];Object(o.j)(n)?t.addMissing(e.level+1,(e.row<<1)+((2&i)>>1),(e.col<<1)+(1&i),r):this._collectMissingTilesRecurse(n,t,r)}}_referenceFeature(e){const t=(this.refCounts.get(e)||0)+1;return this.refCounts.set(e,t),1===t?Q.ADDED:Q.UNCHANGED}_unreferenceFeature(e){const t=(this.refCounts.get(e)||0)-1;return 0===t?(this.refCounts.delete(e),Q.REMOVED):(t>0&&this.refCounts.set(e,t),Q.UNCHANGED)}get test(){return{tiles:Array.from(this.tiles.values()).map((e=>`${e.data.id}:[${Array.from(e.objectIds)}]`)),featureReferences:Array.from(this.refCounts.keys()).map((e=>`${e}:${this.refCounts.get(e)}`))}}};Object(r.a)([Object(u.b)({constructOnly:!0})],B.prototype,"featureStore",void 0),Object(r.a)([Object(u.b)()],B.prototype,"tileInfo",void 0),Object(r.a)([Object(u.b)()],B.prototype,"extent",void 0),Object(r.a)([Object(u.b)()],B.prototype,"maximumByteSize",void 0),B=Object(r.a)([Object(h.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],B);class H{constructor(e,t,n){this.data=e,this.objectIds=t,this.byteSize=n}}class Z{constructor(e,t,n){this.level=e,this.row=t,this.col=n,this.isLeaf=!1,this.extent=null,this.children=[null,null,null,null]}get hasChildren(){return!this.isLeaf&&(Object(o.k)(this.children[0])||Object(o.k)(this.children[1])||Object(o.k)(this.children[2])||Object(o.k)(this.children[3]))}}class Y{constructor(e,t=[]){this.missingTiles=t,this.fullArea=0,this.coveredArea=0,this.fullArea=Object(F.c)(e.extent),this.coveredArea=this.fullArea}prepend(e){this.missingTiles=e.missingTiles.concat(this.missingTiles),this.coveredArea+=e.coveredArea,this.fullArea+=e.fullArea}}class J{constructor(e,t,n){this.tileInfo=e,this.extent=null,this.info=new Y(t),Object(o.k)(n)&&(this.extent=Object(F.q)(n))}addMissing(e,t,n,r){const i={id:null,level:e,row:t,col:n};this.tileInfo.updateTileInfo(i,b.a.ExtrapolateOptions.POWER_OF_TWO),!Object(o.k)(i.extent)||Object(o.k)(this.extent)&&!Object(F.t)(this.extent,i.extent)||(this.info.missingTiles.push({data:i,resolution:r}),this.info.coveredArea-=Object(F.c)(i.extent))}}const W=.18751;var Q,X;(X=Q||(Q={}))[X.ADDED=0]="ADDED",X[X.REMOVED=1]="REMOVED",X[X.UNCHANGED=2]="UNCHANGED";var $=n(277);let K=class extends i.a.EventedAccessor{constructor(){super(...arguments),this.isInitializing=!0,this.whenSetup=Object(a.e)(),this.handles=new s.a,this.updatingHandles=new $.a,this.pendingApplyEdits=new Map}get updating(){return this.featureFetcher.updating||this.isInitializing||this.updatingHandles.updating}destroy(){this.featureFetcher.destroy(),this.queryEngine.destroy(),this.featureStore.clear(),this.handles.destroy()}async setup(e){const{geometryType:t,objectIdField:n,timeInfo:r,fields:i}=e.serviceInfo;return this.featureStore=new p.a({...e.serviceInfo,hasZ:!1,hasM:!1}),this.queryEngine=new f.a({spatialReference:e.spatialReference,featureStore:this.featureStore,geometryType:t,fields:i,hasZ:!1,hasM:!1,objectIdField:n,timeInfo:r?m.a.fromJSON(r):null}),this.featureFetcher=new A({store:new B({featureStore:this.featureStore}),url:e.serviceInfo.url,objectIdField:e.serviceInfo.objectIdField,globalIdField:e.serviceInfo.globalIdField,capabilities:e.serviceInfo.capabilities,spatialReference:d.a.fromJSON(e.spatialReference),sourceSpatialReference:d.a.fromJSON(e.serviceInfo.spatialReference)}),this.handles.add([this.featureFetcher.watch("availability",(e=>this.emit("notify-availability",{availability:e})),!0),this.watch("updating",(()=>this._notifyUpdating()))]),this.whenSetup.resolve(),this.isInitializing=!1,this.configure(e.configuration)}async configure(e){return await this.updatingHandles.addPromise(this.whenSetup.promise),this._updateFeatureFetcherConfiguration(e),{result:{}}}async fetchCandidates(e,t){return await this.whenSetup.promise,Object(a.t)(t),{result:await this.queryEngine.executeQueryForSnapping({point:e.point,distance:e.distance,types:e.types,query:Object(o.k)(e.filter)?e.filter:{where:"1=1"}},Object(o.k)(t)?t.signal:null)}}async updateTiles(e,t){return await this.updatingHandles.addPromise(this.whenSetup.promise),Object(a.t)(t),this.featureFetcher.tileSize=e.tileSize,this.featureFetcher.tilesOfInterest=e.tiles,this.featureFetcher.tileInfo=Object(o.k)(e.tileInfo)?b.a.fromJSON(e.tileInfo):null,{result:{}}}async refresh(e,t){return await this.updatingHandles.addPromise(this.whenSetup.promise),Object(a.t)(t),this.featureFetcher.refresh(),{result:{}}}async whenNotUpdating(e,t){return await this.updatingHandles.addPromise(this.whenSetup.promise),Object(a.t)(t),await Object(a.x)(Object(c.i)(this,"updating"),t),{result:{}}}async getDebugInfo(e,t){return Object(a.t)(t),{result:this.featureFetcher.debugInfo}}async beginApplyEdits(e,t){this.updatingHandles.addPromise(this.whenSetup.promise),Object(a.t)(t);const n=Object(a.e)();return this.pendingApplyEdits.set(e.id,n),this.featureFetcher.applyEdits(n.promise),this.updatingHandles.addPromise(n.promise),{result:{}}}async endApplyEdits(e,t){const n=this.pendingApplyEdits.get(e.id);return n&&n.resolve(e.edits),Object(a.t)(t),{result:{}}}_updateFeatureFetcherConfiguration(e){this.featureFetcher.filter=Object(o.k)(e.filter)?g.a.fromJSON(e.filter):null,this.featureFetcher.customParameters=e.customParameters}_notifyUpdating(){this.emit("notify-updating",{updating:this.updating})}};function ee(){return new K}Object(r.a)([Object(u.b)({readOnly:!0})],K.prototype,"updating",null),Object(r.a)([Object(u.b)()],K.prototype,"isInitializing",void 0),K=Object(r.a)([Object(h.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],K)},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return j}));var r=n(90),i=n(85),s=n(114),o=n(400),a=n(97),c=n(229),u=n(110),l=(n(460),n(160)),h=n(168),d=n(364);const p=new r.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),f=Object.freeze({}),b=new h.a,m=new h.a,g=new h.a,y={esriGeometryPoint:l.m,esriGeometryPolyline:l.o,esriGeometryPolygon:l.n,esriGeometryMultipoint:l.l};function j(e,t,n,r=e.hasZ,s=e.hasM){if(Object(i.j)(t))return null;const o=e.hasZ&&r,a=e.hasM&&s;if(n){const i=Object(l.u)(g,t,e.hasZ,e.hasM,"esriGeometryPoint",n,r,s);return Object(l.m)(i,o,a)}return Object(l.m)(t,o,a)}function O(e,t,n,r,s,o,a=t,c=n){const u=t&&a,h=n&&c,d=Object(i.k)(r)?"coords"in r?r:r.geometry:null;if(Object(i.j)(d))return null;if(s){let r=Object(l.q)(m,d,t,n,e,s,a,c);return o&&(r=Object(l.u)(g,r,u,h,e,o)),y[e](r,u,h)}if(o){const r=Object(l.u)(g,d,t,n,e,o,a,c);return y[e](r,u,h)}return Object(l.x)(b,d,t,n,a,c),y[e](b,u,h)}async function v(e,t,n){const{outFields:r,orderByFields:i,groupByFieldsForStatistics:s,outStatistics:o}=e;if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(i)for(let a=0;a<i.length;a++)i[a]=i[a].trim();if(s)for(let a=0;a<s.length;a++)s[a]=s[a].trim();if(o)for(let a=0;a<o.length;a++)o[a].onStatisticField&&(o[a].onStatisticField=o[a].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),_(e,t,n)}async function _(e,t,r){if(!e)return null;let{where:l}=e;if(e.where=l=l&&l.trim(),(!l||/^1 *= *1$/.test(l)||t&&t===l)&&(e.where=null),!e.geometry)return e;let h=await async function(e){const{geometry:t,distance:r,units:i}=e;if(null==r||"vertexAttributes"in t)return t;const o=t.spatialReference,a=i?p.fromJSON(i):Object(s.g)(o),c=o&&(Object(u.h)(o)||Object(u.p)(o))?t:await Object(d.a)(o,u.b).then((()=>Object(d.b)(t,u.b)));return(await async function(){return(await Promise.all([n.e(6),n.e(20)]).then(n.bind(null,559))).geodesicBuffer}())(c.spatialReference,c,r,a)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;h=Object(o.a)(h),h.spatialReference=t}e.geometry=h,await Object(d.a)(h.spatialReference,r);const b=(await Object(c.a)(Object(a.a)(h)))[0];if(Object(i.j)(b))throw f;const m=b.toJSON(),g=await Object(d.b)(m,m.spatialReference,r);if(!g)throw f;return g.spatialReference=r,e.geometry=g,e}function w(e){return e&&x in e?JSON.parse(JSON.stringify(e,T)):e}const x="_geVersion",T=(e,t)=>e!==x?t:void 0},634:function(e,t,n){"use strict";function r(e,t){if(!e)return null;const n=t.featureAdapter,{startTimeField:r,endTimeField:i}=e;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(r&&i)t.forEach((e=>{const t=n.getAttribute(e,r),a=n.getAttribute(e,i);null==t||isNaN(t)||(s=Math.min(s,t)),null==a||isNaN(a)||(o=Math.max(o,a))}));else{const e=r||i;t.forEach((t=>{const r=n.getAttribute(t,e);null==r||isNaN(r)||(s=Math.min(s,r),o=Math.max(o,r))}))}return{start:s,end:o}}function i(e,t,n){if(!t||!e)return null;const{startTimeField:r,endTimeField:i}=e;if(!r&&!i)return null;const{start:s,end:o}=t;return null===s&&null===o?null:void 0===s&&void 0===o?()=>!1:r&&i?function(e,t,n,r,i){return null!=r&&null!=i?s=>{const o=e.getAttribute(s,t),a=e.getAttribute(s,n);return(null==o||o<=i)&&(null==a||a>=r)}:null!=r?t=>{const i=e.getAttribute(t,n);return null==i||i>=r}:null!=i?n=>{const r=e.getAttribute(n,t);return null==r||r<=i}:void 0}(n,r,i,s,o):function(e,t,n,r){return null!=n&&null!=r&&n===r?r=>e.getAttribute(r,t)===n:null!=n&&null!=r?i=>{const s=e.getAttribute(i,t);return s>=n&&s<=r}:null!=n?r=>e.getAttribute(r,t)>=n:null!=r?n=>e.getAttribute(n,t)<=r:void 0}(n,r||i,s,o)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},775:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return j}));var r=n(85),i=n(438),s=n(400),o=n(328),a=n(110),c=n(160),u=n(561),l=n(616);class h{constructor(e,t,n){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=n,this.featureAdapter=t;const r=e.outFields;if(r&&-1===r.indexOf("*")){this.outFields=r;let e=0;for(const t of r){const r=Object(u.b)(t),i=this.fieldsIndex.get(r),s=i?null:Object(u.c)(r,n),o=i?i.name:Object(u.a)(t)||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:o,clause:s})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,n){const r=n?n.name:t;let i=null;return this._fieldDataCache.has(r)?i=this._fieldDataCache.get(r).clause:n||(i=Object(u.c)(t,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:i})),n?this.featureAdapter.getAttribute(e,r):i.calculateValue(e,this.featureAdapter)}getNormalizedValue(e,t){const n=t.normalizationType,r=t.normalizationTotal;let i=this.getFieldValue(e,t.field,t.fieldInfo);if(n&&Number.isFinite(i)){const s=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);i=Object(l.i)(i,n,s,r)}return i}getExpressionValue(e,t,n){const r={attributes:this.featureAdapter.getAttributes(e)},i=n.createExecContext(r,t.viewInfo);return n.executeFunction(t.compiledFunc,i)}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:Object(u.c)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:Object(u.c)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const n={};for(const r of t){const{alias:t,clause:i}=this._fieldDataCache.get(r);n[t]=i?i.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return n}_processAttributesForDistinctValues(e){if(Object(r.j)(e)||!this.returnDistinctValues)return e;const t=this.outFields,n=[];if(t)for(const r of t){const{alias:t}=this._fieldDataCache.get(r);n.push(e[t])}else for(const r in e)n.push(e[r]);const i=`${(t||["*"]).join(",")}=${n.join(",")}`;let s=this._returnDistinctMap.get(i)||0;return this._returnDistinctMap.set(i,++s),s>1?null:e}}var d,p,f=n(364),b=n(634),m=n(600),g=n(106),y=n(130);class j{constructor(e,t,n){this.items=e,this.queryGeometry=t,this.definitionExpression=n.definitionExpression,this.geometryType=n.geometryType,this.hasM=n.hasM,this.hasZ=n.hasZ,this.objectIdField=n.objectIdField,this.spatialReference=n.spatialReference,this.fieldsIndex=n.fieldsIndex,this.timeInfo=n.timeInfo,this.featureAdapter=n.featureAdapter,this.aggregateAdapter=n.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(e){const t=new h(e,this.featureAdapter,this.fieldsIndex);if(!e.outStatistics)return t.countDistinctValues(this.items);const{groupByFieldsForStatistics:n,having:r}=e;if(!(null==n?void 0:n.length))return 1;const i=new Map,s=new Map,o=new Set,a=e.outStatistics;for(const c of a){const{statisticType:e}=c,a="exceedslimit"!==e?c.onStatisticField:void 0;if(!s.has(a)){const e=[];for(const r of n){const n=this._getAttributeValues(t,r,i);e.push(n)}s.set(a,this._calculateUniqueValues(e,t.returnDistinctValues))}const u=s.get(a);for(const n in u){const{data:e,items:i}=u[n],s=e.join(",");r&&!t.validateItems(i,r)||o.add(s)}}return o.size}async createQueryResponse(e){let t;return t=e.outStatistics?e.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(e):await this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(Object(a.l)(e.outSR)&&!Object(a.d)(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=Object(m.b)({spatialReference:e.outSR,...Object(f.b)(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR)}):t.queryGeometry=Object(m.b)({spatialReference:e.outSR,...this.queryGeometry})),t}createSnappingResponse(e,t){const n=this.featureAdapter,i=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:s,y:o}=e.point,a="number"==typeof e.distance?e.distance:e.distance.x,c="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},l="esriGeometryPolygon"===this.geometryType,h=this._getPointCreator(e.point,this.spatialReference,t);for(const p of this.items){const t=n.getGeometry(p);if(Object(r.j)(t))continue;const{coords:f,lengths:b}=t;if(e.types&d.EDGE){let e=0;for(let t=0;t<b.length;t++){const r=b[t];for(let t=0;t<r;t++,e+=i){const l=f[e],d=f[e+1];if(t!==r-1){const t=f[e+i],r=f[e+i+1],{x:b,y:m}=O(s,o,l,d,t,r),g=(s-b)/a,y=(o-m)/c,j=g*g+y*y;j<=1&&u.candidates.push({type:"edge",objectId:n.getObjectId(p),distance:Math.sqrt(j),target:h(b,m),start:h(l,d),end:h(t,r)})}}}}if(e.types&d.VERTEX){const e=l?f.length-i:f.length;for(let t=0;t<e;t+=i){const e=f[t],r=f[t+1],i=(s-e)/a,l=(o-r)/c,d=i*i+l*l;d<=1&&u.candidates.push({type:"vertex",objectId:n.getObjectId(p),distance:Math.sqrt(d),target:h(e,r)})}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}_getPointCreator(e,t,n){const i=Object(r.k)(n)&&!Object(a.d)(t,n)?e=>Object(f.b)(e,t,n):e=>e;return null!=e.z&&null!=e.m?(t,n)=>i({x:t,y:n,z:e.z,m:e.m}):null!=e.z?(t,n)=>i({x:t,y:n,z:e.z}):null!=e.m?(t,n)=>i({x:t,y:n,m:e.m}):(e,t)=>i({x:e,y:t})}executeAttributesQuery(e){const t=Object(u.c)(e.where,this.fieldsIndex);if(!t)return Promise.resolve(this);if(t.isStandardized){let n=0;const r=[];for(const e of this.items)t.testFeature(e,this.featureAdapter)&&(r[n++]=e);const i=new j(r,this.queryGeometry,this);return i.definitionExpression=e.where,Promise.resolve(i)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(e){if(!e.aggregateIds||!e.aggregateIds.length||Object(r.j)(this.aggregateAdapter))return Promise.resolve(this);const t=new Set;for(const r of e.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach((e=>t.add(e)));const n=this.featureAdapter.getObjectId;return Promise.resolve(new j(this.items.filter((e=>t.has(n(e)))),this.queryGeometry,this))}executeObjectIdsQuery(e){if(!e.objectIds||!e.objectIds.length)return Promise.resolve(this);const t=new Set(e.objectIds),n=this.featureAdapter.getObjectId;return Promise.resolve(new j(this.items.filter((e=>t.has(n(e)))),this.queryGeometry,this))}executeTimeQuery(e){const t=Object(b.b)(this.timeInfo,e.timeExtent,this.featureAdapter);if(!Object(r.k)(t))return Promise.resolve(this);const n=this.items.filter(t);return Promise.resolve(new j(n,this.queryGeometry,this))}filterLatest(){const{trackIdField:e,startTimeField:t,endTimeField:n}=this.timeInfo,r=n||t,i=new Map,s=this.featureAdapter.getAttribute;for(const a of this.items){const t=s(a,e),n=s(a,r),o=i.get(t);(!o||n>s(o,r))&&i.set(t,a)}const o=Array.from(i.values());return Promise.resolve(new j(o,this.queryGeometry,this))}async project(e){if(!e||Object(a.d)(this.spatialReference,e))return this;const t=this.featureAdapter,n=(await Object(f.c)(this.items.map((e=>Object(m.c)(this.geometryType,this.hasZ,this.hasM,t.getGeometry(e)))),this.spatialReference,e)).map(((e,n)=>t.cloneWithGeometry(this.items[n],Object(c.d)(e,this.hasZ,this.hasM))));return new j(n,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:e,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})}async createSummaryStatisticsResponse(e,t){const{field:n,valueExpression:r,normalizationField:i,normalizationType:s,normalizationTotal:o,minValue:a,maxValue:c,scale:u}=t,h=this.fieldsIndex.isDateField(n),d=await this._getDataValues(e,{field:n,valueExpression:r,normalizationField:i,normalizationType:s,normalizationTotal:o,scale:u}),p=Object(l.j)({normalizationType:s,normalizationField:i,minValue:a,maxValue:c}),f=this.fieldsIndex.get(n),b={value:.5,fieldType:null==f?void 0:f.type},m=Object(g.v)(f)?Object(l.e)({values:d,supportsNullCount:p,percentileParams:b}):Object(l.d)({values:d,minValue:a,maxValue:c,useSampleStdDev:!s,supportsNullCount:p,percentileParams:b});return Object(l.k)(m,h)}async createUniqueValuesResponse(e,t){const{field:n,valueExpression:r,domain:i,returnAllCodedValues:s,scale:o}=t,a=await this._getDataValues(e,{field:n,valueExpression:r,scale:o}),c=Object(l.f)(a);return Object(l.g)(c,i,s)}async createClassBreaksResponse(e,t){const{field:n,valueExpression:r,normalizationField:i,normalizationType:s,normalizationTotal:o,classificationMethod:a,standardDeviationInterval:c,minValue:u,maxValue:h,numClasses:d,scale:p}=t,f=await this._getDataValues(e,{field:n,valueExpression:r,normalizationField:i,normalizationType:s,normalizationTotal:o,scale:p}),b=Object(l.a)(f,{field:n,normalizationField:i,normalizationType:s,normalizationTotal:o,classificationMethod:a,standardDeviationInterval:c,minValue:u,maxValue:h,numClasses:d});return Object(l.l)(b,a)}async createHistogramResponse(e,t){const{field:n,valueExpression:r,normalizationField:i,normalizationType:s,normalizationTotal:o,classificationMethod:a,standardDeviationInterval:c,minValue:u,maxValue:h,numBins:d,scale:p}=t,f=await this._getDataValues(e,{field:n,valueExpression:r,normalizationField:i,normalizationType:s,normalizationTotal:o,scale:p});return Object(l.b)(f,{field:n,normalizationField:i,normalizationType:s,normalizationTotal:o,classificationMethod:a,standardDeviationInterval:c,minValue:u,maxValue:h,numBins:d})}_sortFeatures(e,t,n){if(e.length>1&&t&&t.length)for(const r of t.reverse()){const t=r.split(" "),i=t[0],s=this.fieldsIndex.get(i),o=t[1]&&"desc"===t[1].toLowerCase(),a=Object(l.h)(null==s?void 0:s.type,o);e.sort(((e,t)=>{const r=n(e,i,s),o=n(t,i,s);return a(r,o)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:n,hasM:r,hasZ:i,objectIdField:s,spatialReference:a}=this,{outFields:c,outSR:u,quantizationParameters:l,resultRecordCount:h,resultOffset:d,returnZ:p,returnM:f}=e,b=null!=h&&t.length>(d||0)+h,g=c&&(c.includes("*")?[...this.fieldsIndex.fields]:c.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:b,features:this._createFeatures(e,t),fields:g,geometryType:n,hasM:r&&f,hasZ:i&&p,objectIdFieldName:s,spatialReference:Object(m.b)(u||a),transform:l&&Object(o.c)(l)||null}}_createFeatures(e,t){const n=new h(e,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:i}=this,{orderByFields:s,quantizationParameters:a,returnGeometry:c,returnCentroid:u,maxAllowableOffset:l,resultOffset:d,resultRecordCount:p,returnZ:f=!1,returnM:b=!1}=e,g=i&&f,y=r&&b;let j=[],O=0;const v=[...t];if(this._sortFeatures(v,s,((e,t,r)=>n.getFieldValue(e,t,r))),c||u){const e=Object(o.c)(a);if(c&&!u)for(const t of v)j[O++]={attributes:n.getAttributes(t),geometry:Object(m.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),l,e,g,y)};else if(!c&&u)for(const t of v)j[O++]={attributes:n.getAttributes(t),centroid:Object(m.f)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of v)j[O++]={attributes:n.getAttributes(t),centroid:Object(m.f)(this,this.featureAdapter.getCentroid(t,this),e),geometry:Object(m.c)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),l,e,g,y)}}else for(const o of v){const e=n.getAttributes(o);e&&(j[O++]={attributes:e})}const _=d||0;if(null!=p){const e=_+p;j=j.slice(_,Math.min(j.length,e))}return j}_createExceedsLimitQueryResponse(e){let t=!1,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const r of e.outStatistics)if("exceedslimit"===r.statisticType){n=null!=r.maxPointCount?r.maxPointCount:Number.POSITIVE_INFINITY,i=null!=r.maxRecordCount?r.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=r.maxVertexCount?r.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>n;else if(this.items.length>i)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter;t=this.items.reduce(((e,t)=>{const i=n.getGeometry(t);return e+(Object(r.k)(i)&&i.coords.length||0)}),0)/e>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},n=[],r=new Map,i=new Map,s=new Map,o=new Map,a=new h(e,this.featureAdapter,this.fieldsIndex),c=e.outStatistics,{groupByFieldsForStatistics:u,having:l,orderByFields:d}=e,p=u&&u.length,f=!!p,b=f&&u[0],m=f&&!this.fieldsIndex.get(b);for(const h of c){const{outStatisticFieldName:e,statisticType:c}=h,d=h,g="exceedslimit"!==c?h.onStatisticField:void 0,y="percentile_disc"===c||"percentile_cont"===c,j="EnvelopeAggregate"===c||"CentroidAggregate"===c||"ConvexHullAggregate"===c,O=f&&1===p&&(g===b||m)&&"count"===c;if(f){if(!s.has(g)){const e=[];for(const t of u){const n=this._getAttributeValues(a,t,r);e.push(n)}s.set(g,this._calculateUniqueValues(e,a.returnDistinctValues))}const t=s.get(g);for(const n in t){const{count:i,data:s,items:c,itemPositions:h}=t[n],p=s.join(",");if(!l||a.validateItems(c,l)){const t=o.get(p)||{attributes:{}};if(j){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:n}=await this._getAggregateGeometry(d,c);t.aggregateGeometries[n]=e}else{let n=null;if(O)n=i;else{const e=this._getAttributeValues(a,g,r),t=h.map((t=>e[t]));n=y&&"statisticParameters"in d?this._getPercentileValue(d,t):this._getStatisticValue(d,t,null,a.returnDistinctValues)}t.attributes[e]=n}u.forEach(((e,n)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${n+1}`]=s[n])),o.set(p,t)}}}else if(j){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:n}=await this._getAggregateGeometry(d,this.items);t.aggregateGeometries[n]=e}else{const n=this._getAttributeValues(a,g,r);t.attributes[e]=y&&"statisticParameters"in d?this._getPercentileValue(d,n):this._getStatisticValue(d,n,i,a.returnDistinctValues)}n.push({name:e,alias:e,type:"esriFieldTypeDouble"})}const g=f?Array.from(o.values()):[t];return this._sortFeatures(g,d,((e,t)=>e.attributes[t])),{fields:n,features:g}}async _getAggregateGeometry(e,t){const r=await Promise.all([n.e(6),n.e(20)]).then(n.bind(null,559)),{statisticType:o,outStatisticFieldName:a}=e,{featureAdapter:c,spatialReference:u,geometryType:l,hasZ:h,hasM:d}=this,p=t.map((e=>Object(m.c)(l,h,d,c.getGeometry(e)))),f=r.convexHull(u,p,!0)[0],b={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===o){const e=f?Object(s.b)(f):Object(s.a)(r.union(u,p));b.aggregateGeometries={...e,spatialReference:u},b.outStatisticFieldName=a||"extent"}else if("CentroidAggregate"===o){const e=f?Object(i.b)(f):Object(i.a)(Object(s.a)(r.union(u,p)));b.aggregateGeometries={x:e[0],y:e[1],spatialReference:u},b.outStatisticFieldName=a||"centroid"}else"ConvexHullAggregate"===o&&(b.aggregateGeometries=f,b.outStatisticFieldName=a||"convexHull");return b}_getStatisticValue(e,t,n,r){const{onStatisticField:i,statisticType:s}=e;let o=null;return o=null!=n&&n.has(i)?n.get(i):Object(g.v)(this.fieldsIndex.get(i))?Object(l.e)({values:t,returnDistinct:r}):Object(l.d)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),n&&n.set(i,o),o["var"===s?"variance":s]}_getPercentileValue(e,t){const{onStatisticField:n,statisticParameters:r,statisticType:i}=e,{value:s,orderBy:o}=r,a=this.fieldsIndex.get(n),c={value:s,orderBy:o,fieldType:null==a?void 0:a.type,isDiscrete:"percentile_disc"===i};return Object(l.c)(t,c)}_getAttributeValues(e,t,n){if(n.has(t))return n.get(t);const r=this.fieldsIndex.get(t),i=this.items.map((n=>e.getFieldValue(n,t,r)));return n.set(t,i),i}_getAttributeNormalizedValues(e,t){return this.items.map((n=>e.getNormalizedValue(n,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,n){const{arcadeUtils:r}=await Object(y.e)(),i=r.createFunction(t),s=n&&r.getViewInfo(n);return this.items.map((t=>e.getExpressionValue(t,{compiledFunc:i,viewInfo:s},r)))}_calculateUniqueValues(e,t){const n={},r=this.items,i=r.length;for(let s=0;s<i;s++){const i=r[s],o=[];for(const t of e)o.push(t[s]);const a=o.join(",");t?null==n[a]&&(n[a]={count:1,data:o,items:[i],itemPositions:[s]}):null==n[a]?n[a]={count:1,data:o,items:[i],itemPositions:[s]}:(n[a].count++,n[a].items.push(i),n[a].itemPositions.push(s))}return n}async _getDataValues(e,t){const n=new h(e,this.featureAdapter,this.fieldsIndex),{valueExpression:r,field:i,normalizationField:s,normalizationType:o,normalizationTotal:a,scale:c}=t,u=r?{viewingMode:"map",scale:c,spatialReference:e.outSR||this.spatialReference}:null;return r?this._getAttributeExpressionValues(n,r,u):this._getAttributeNormalizedValues(n,{field:i,normalizationField:s,normalizationType:o,normalizationTotal:a})}}function O(e,t,n,r,i,s){const o=i-n,a=s-r,c=o*o+a*a,u=(e-n)*o+(t-r)*a,l=Math.min(1,Math.max(0,u/c));return{x:n+o*l,y:r+a*l}}(p=d||(d={}))[p.NONE=0]="NONE",p[p.EDGE=1]="EDGE",p[p.VERTEX=2]="VERTEX"}}]);
//# sourceMappingURL=108.a5e9eb86.chunk.js.map