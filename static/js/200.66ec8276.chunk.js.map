{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/GraphicsSnappingSource.js","../node_modules/@arcgis/core/geometry/support/normalizeUtilsSync.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"],"names":["O","f","p","constructor","e","super","this","availability","sources","multipoint","point","polygon","polyline","loadedWkids","Set","loadedWkts","pendingAdds","updatingHandles","updating","layerSource","layer","destroy","t","length","task","abort","mapSources","destroySource","initialize","handles","add","on","onGraphicUpdate","addOnCollectionChange","graphics","onGraphicsChanged","addMany","toArray","fetchCandidates","r","s","a","queryEngine","executeQueryForSnapping","coordinateHelper","toPoint","d","toJSON","distance","types","query","filter","createQuery","where","then","candidates","flat","map","k","S","refresh","property","remove","graphic","removed","added","Map","o","geometry","needsInitializeProjection","spatialReference","push","set","uid","createPendingAdd","n","u","source","dest","signal","markLoadedSpatialReferences","addPromise","promise","i","wkid","wkt","visible","type","c","fromExtent","ensureSource","createOptimizedFeature","featureStore","has","h","m","j","y","g","b","createSource","l","w","geometryType","hasZ","hasM","v","fields","name","alias","objectIdField","scheduler","view","resourceController","removeFromSource","delete","size","removeById","constructOnly","prototype","readOnly","J","isWebMercator","I","maxX","minX","plus180Line","minus180Line","N","points","x","M","xmin","ymin","xmax","ymax","cut","valid","frameId","extent","frameIds","rings","Array","isArray","Math","ceil","abs","closed","minPts","paths","constraint","edgeStart","edgeEnd","start","end","targetPoint","fromPoint","target","objectId"],"mappings":"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","file":"static/js/200.66ec8276.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import\"../../../../core/has.js\";import{isSome as t,isNone as r}from\"../../../../core/maybe.js\";import\"../../../../core/Logger.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../core/urlUtils.js\";import\"../../../../core/uuid.js\";import\"../../../../portal/support/resourceExtension.js\";import{removeUnordered as i}from\"../../../../core/arrayUtils.js\";import{eachAlwaysValues as a,createTask as n}from\"../../../../core/promiseUtils.js\";import p from\"../../../../core/Accessor.js\";import d from\"../../../../geometry/Point.js\";import c from\"../../../../geometry/Polygon.js\";import{featureGeometryTypeKebabDictionary as l}from\"../../../../geometry/support/typeUtils.js\";import{initializeProjection as u,canProjectWithoutEngine as h,project as m}from\"../../../../geometry/projection.js\";import y from\"../../../../layers/graphics/OptimizedFeature.js\";import{convertFromGeometry as g}from\"../../../../layers/graphics/featureConversionUtils.js\";import{HandleOwnerMixin as f}from\"../../../../core/HandleOwner.js\";import{sortCandidatesInPlace as S}from\"../snappingUtils.js\";import{normalizeCentralMeridianSync as j}from\"../../../../geometry/support/normalizeUtilsSync.js\";import w from\"../../../../layers/graphics/data/FeatureStore.js\";import v from\"../../../../layers/graphics/data/QueryEngine.js\";import{convertSnappingCandidate as k}from\"./queryEngineUtils.js\";let O=class extends(f(p)){constructor(e){super(e),this.availability=1,this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){const e=this.pendingAdds;this.pendingAdds.length=0;for(const t of e)t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on(\"graphic-update\",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}async fetchCandidates(e,r){const s=(await a(this.mapSources((s=>s.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.toPoint(e.point,new d).toJSON(),distance:e.distance,types:e.types,query:t(e.filter)?e.filter.createQuery().toJSON():{where:\"1=1\"}},r).then((({candidates:e})=>e)))))).flat().map((t=>k(t,e.coordinateHelper)));return S(e.point,s),{candidates:s}}refresh(){}onGraphicUpdate(e){switch(e.property){case\"geometry\":case\"visible\":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(const t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){const t=[],s=new Map;for(const o of e)r(o.geometry)||(this.needsInitializeProjection(o.geometry.spatialReference)?(t.push(o.geometry.spatialReference),s.set(o.uid,o)):this.add(o));this.createPendingAdd(t,s)}createPendingAdd(e,t){if(!e.length)return;const r=n((async r=>{await u(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:r}),this.markLoadedSpatialReferences(e);for(const[,e]of t)this.add(e)}));this.updatingHandles.addPromise(r.promise);const s={task:r,graphics:t},o=()=>i(this.pendingAdds,s);r.promise.then(o,o),this.pendingAdds.push(s)}markLoadedSpatialReferences(e){for(const t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if(r(e.geometry)||!e.visible)return;let s=e.geometry;if(\"mesh\"===s.type)return;\"extent\"===s.type&&(s=c.fromExtent(s));const o=this.ensureSource(s.type);if(r(o))return;const i=this.createOptimizedFeature(e.uid,s);t(i)&&o.featureStore.add(i)}needsInitializeProjection(e){return(null==e.wkid||!this.loadedWkids.has(e.wkid))&&((null==e.wkt||!this.loadedWkts.has(e.wkt))&&!h(e,this.spatialReference))}createOptimizedFeature(e,t){const r=m(j(t),this.spatialReference);return r?new y(g(r,!1,!1),{[b]:e},null,e):null}ensureSource(e){const r=this.sources[e];if(t(r))return r;const s=this.createSource(e);return this.sources[e]=s,s}createSource(e){const r=l.toJSON(e),s=new w({geometryType:r,hasZ:!1,hasM:!1});return{featureStore:s,queryEngine:new v({featureStore:s,fields:[{name:b,type:\"esriFieldTypeOID\",alias:b}],geometryType:r,hasM:!1,hasZ:!1,objectIdField:b,spatialReference:this.spatialReference,scheduler:t(this.view)&&\"3d\"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){this.mapSources((t=>this.removeFromSource(t,e)));for(const t of this.pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){const r=t.uid;e.featureStore.has(r)&&e.featureStore.removeById(t.uid)}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){const{point:r,polygon:s,polyline:o,multipoint:i}=this.sources,a=[];return t(r)&&a.push(e(r)),t(s)&&a.push(e(s)),t(o)&&a.push(e(o)),t(i)&&a.push(e(i)),a}};e([s({constructOnly:!0})],O.prototype,\"spatialReference\",void 0),e([s({constructOnly:!0})],O.prototype,\"layerSource\",void 0),e([s({constructOnly:!0})],O.prototype,\"view\",void 0),e([s({readOnly:!0})],O.prototype,\"updating\",null),e([s({readOnly:!0})],O.prototype,\"availability\",void 0),O=e([o(\"esri.views.interactive.snapping.featureSources.GraphicsSnappingSource\")],O);const b=\"OBJECTID\";export{O as GraphicsSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{getInfo as n}from\"./spatialReferenceUtils.js\";import{extentIntersectsPolyline as t}from\"./intersects.js\";import{getBoundsXY as i}from\"./boundsUtils.js\";import{isPoint as m,isMultipoint as s,isExtent as e,isPolygon as x,isPolyline as o}from\"./jsonUtils.js\";import{create as r}from\"./aaBoundingRect.js\";import{cutParams as a,getGeometryParts as f,offsetMagnitude as c}from\"./normalizeUtilsCommon.js\";function l(r){if(!r)return null;if(\"mesh\"===r.type)return r.toJSON();let f=null;const l=r.spatialReference,h=n(l);if(!h)return r.toJSON();const d=l.isWebMercator?102100:4326,I=a[d].maxX,g=a[d].minX,b=a[d].plus180Line,v=a[d].minus180Line;let J;const N=r.toJSON();if(m(N))J=y(N,I,g);else if(s(N))N.points=N.points.map((n=>y(n,I,g))),J=N;else if(e(N))J=p(N,h);else if(x(N)||o(N)){const n=M;i(n,N);const m={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},s=c(m.xmin,g)*(2*I),e=0===s?N:u(N,s);m.xmin+=s,m.xmax+=s,t(m,b)&&m.xmax!==I||t(m,v)&&m.xmin!==g?f=e:J=e}else J=r.toJSON();if(null!==f){return(new j).cut(f,I)}return J}function u(n,t){const i=f(n);for(const m of i)for(const n of m)n[0]+=t;return n}function p(n,t){if(!t)return n;const i=h(n,t).map((n=>n.extent));return i.length<2?i[0]||n:i.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:i.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}function y(n,t,i){if(Array.isArray(n)){const m=n[0];if(m>t){const i=c(m,t);n[0]=m+i*(-2*t)}else if(m<i){const t=c(m,i);n[0]=m+t*(-2*i)}}else{const m=n.x;if(m>t){const i=c(m,t);n.x+=i*(-2*t)}else if(m<i){const t=c(m,i);n.x+=t*(-2*i)}}return n}function h(n,t){const i=[],{ymin:m,ymax:s}=n,e=n.xmax-n.xmin,x=n.xmin,o=n.xmax;let r;const[a,f]=t.valid;r=d(n.xmin,t);const c=r.x,l=r.frameId;r=d(n.xmax,t);const u=r.x,p=r.frameId,y=c===u&&e>0;if(e>2*f){const n={xmin:x<o?c:u,ymin:m,xmax:f,ymax:s},t={xmin:a,ymin:m,xmax:x<o?u:c,ymax:s},e={xmin:0,ymin:m,xmax:f,ymax:s},r={xmin:a,ymin:m,xmax:0,ymax:s},y=[],h=[];I(n,e)&&y.push(l),I(n,r)&&h.push(l),I(t,e)&&y.push(p),I(t,r)&&h.push(p);for(let i=l+1;i<p;i++)y.push(i),h.push(i);i.push({extent:n,frameIds:[l]},{extent:t,frameIds:[p]},{extent:e,frameIds:y},{extent:r,frameIds:h})}else c>u||y?i.push({extent:{xmin:c,ymin:m,xmax:f,ymax:s},frameIds:[l]},{extent:{xmin:a,ymin:m,xmax:u,ymax:s},frameIds:[p]}):i.push({extent:{xmin:c,ymin:m,xmax:u,ymax:s},frameIds:[l]});return i}function d(n,t){const[i,m]=t.valid,s=2*m;let e,x=0;return n>m?(e=Math.ceil(Math.abs(n-m)/s),n-=e*s,x=e):n<i&&(e=Math.ceil(Math.abs(n-i)/s),n+=e*s,x=-e),{x:n,frameId:x}}function I(n,t){const{xmin:i,ymin:m,xmax:s,ymax:e}=t;return g(n,i,m)&&g(n,i,e)&&g(n,s,e)&&g(n,s,m)}function g(n,t,i){return t>=n.xmin&&t<=n.xmax&&i>=n.ymin&&i<=n.ymax}class j{cut(n,t){let i;if(n.rings)this.closed=!0,i=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,i=n.paths,this.minPts=2}const m=i.length,s=-2*t;for(let e=0;e<m;e++){const n=i[e];if(n&&n.length>=this.minPts){const t=[];for(const i of n)t.push([i[0]+s,i[1]]);i.push(t)}}return this.closed?n.rings=i:n.paths=i,n}}const M=r();export{l as normalizeCentralMeridianSync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{LineSnappingHint as t}from\"../hints/LineSnappingHint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{LineConstraint as r}from\"../SnappingConstraint.js\";class e extends n{constructor(t){super({...t,constraint:new r(t.coordinateHelper,t.edgeStart,t.edgeEnd)})}get hints(){return[new t(1,this.constraint.start,this.constraint.end)]}}export{e as EdgeSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{PointSnappingHint as t}from\"../hints/PointSnappingHint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointConstraint as r}from\"../SnappingConstraint.js\";class i extends n{constructor(t){super({...t,constraint:new r(t.coordinateHelper,t.targetPoint)})}get hints(){return[new t(this.targetPoint)]}}export{i as VertexSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{EdgeSnappingCandidate as e}from\"../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as t}from\"../candidates/VertexSnappingCandidate.js\";function r(r,n){switch(r.type){case\"edge\":return new e({coordinateHelper:n,edgeStart:n.fromPoint(r.start),edgeEnd:n.fromPoint(r.end),targetPoint:n.fromPoint(r.target),objectId:r.objectId});case\"vertex\":return new t({coordinateHelper:n,targetPoint:n.fromPoint(r.target),objectId:r.objectId})}}export{r as convertSnappingCandidate};\n"],"sourceRoot":""}