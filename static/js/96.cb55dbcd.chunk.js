(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[96],{67435:e=>{function l(e){return Promise.resolve().then((()=>{var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}))}l.keys=()=>[],l.resolve=l,l.id=67435,e.exports=l},47992:(e,l,t)=>{"use strict";t.r(l),t.d(l,{Sketch:()=>L,default:()=>I});var i=t(72791),n=(t(30818),t(51995)),o=t(93655),c=t(16455);const a=new(t(77748).Z)({labelExpressionInfo:{expression:"$feature.label"},symbol:{type:"text",color:"black",haloSize:1,haloColor:"white"}});new c.default({source:[],fields:[{type:"oid",name:"OBJECTID"},{type:"string",name:"label"}],objectIdField:"OBJECTID",geometryType:"point",listMode:"hide",legendEnabled:!1,id:"sketch-points",renderer:{type:"simple",symbol:{type:"simple-marker",color:[255,255,255,1]}},labelingInfo:[a]}),new c.default({source:[],fields:[{type:"oid",name:"OBJECTID"},{type:"string",name:"label"}],objectIdField:"OBJECTID",geometryType:"polyline",legendEnabled:!1,listMode:"hide",id:"sketch-lines",labelingInfo:[a]}),new c.default({source:[],fields:[{type:"oid",name:"OBJECTID"},{type:"string",name:"label"}],objectIdField:"OBJECTID",geometryType:"polygon",listMode:"hide",legendEnabled:!1,id:"sketch-polygons",renderer:{type:"simple",symbol:{type:"simple-fill",color:[255,255,255,.5],outline:{type:"simple-line",color:[255,255,255,1]}}},labelingInfo:[a]}),new o.Z({listMode:"hide",opacity:0});var r=t(80184);const s=e=>{const[l,t]=(0,i.useState)(null),n=(0,i.useRef)(null),o=(0,i.useRef)({pointSize:10,pointFillEnabled:!0,pointFillColor:"#FF0000",pointOutlineColor:"#000000",pointFillOpacity:.5,pointOutlineOpacity:1,pointOutlineWidth:1,lineOutlineOpacity:1,lineWidth:2,lineColor:"#FF0000",polygonFillEnabled:!0,polygonFillOpacity:.5,polygonOutlineOpacity:1,polygonOutlineWidth:2,polygonOutlineColor:"#000000",polygonFillColor:"#FF0000",fontSize:12,fontFamily:"Arial",fontWeight:"normal",fontStyle:"normal",fontColor:"#000000",haloColor:"#FFFFFF"}),c=l=>{const t=l.target.getAttribute("name");t&&(o.current={...o.current,[t]:parseFloat(l.target.value)},requestAnimationFrame((()=>{e.settingsChanged(o.current)})))},a=l=>{const t=l.target.getAttribute("name");t&&(o.current={...o.current,[t]:l.target.value},requestAnimationFrame((()=>{e.settingsChanged(o.current)})))},s=l=>{const t=l.target.getAttribute("name");t&&(o.current={...o.current,[t]:l.detail.switched},requestAnimationFrame((()=>{e.settingsChanged(o.current)})))};return(0,i.useEffect)((()=>(t(e.geometryType),requestAnimationFrame((()=>{var e,l,t;null===(e=n.current)||void 0===e||e.querySelectorAll("calcite-slider").forEach((e=>{e.addEventListener("calciteSliderChange",c)})),null===(l=n.current)||void 0===l||l.querySelectorAll("calcite-color-picker").forEach((e=>{e.addEventListener("calciteColorPickerChange",a)})),null===(t=n.current)||void 0===t||t.querySelectorAll("calcite-switch").forEach((e=>{e.addEventListener("calciteSwitchChange",s)}))})),()=>{var e,l,t;null===(e=n.current)||void 0===e||e.querySelectorAll("calcite-slider").forEach((e=>{e.removeEventListener("calciteSliderChange",c)})),null===(l=n.current)||void 0===l||l.querySelectorAll("calcite-slider").forEach((e=>{e.removeEventListener("calciteColorPickerChange",a)})),null===(t=n.current)||void 0===t||t.querySelectorAll("calcite-switch").forEach((e=>{e.addEventListener("calciteSwitchChange",s)}))})),[e.geometryType]),(0,r.jsxs)("div",{ref:n,className:"panel",children:["point"===l?(0,r.jsxs)("div",{children:[(0,r.jsx)("calcite-block",{heading:"Symbol",open:!0,collapsible:!0,children:(0,r.jsx)("calcite-block-section",{text:"Size",children:(0,r.jsx)("calcite-slider",{min:"0",max:"30",value:o.current.pointSize,step:"0.1",label:"Size","label-handles":"",ticks:"0","page-step":"5",name:"pointSize",snap:""})})},"point-symbol"),(0,r.jsxs)("calcite-block",{heading:"Fill",open:!0,collapsible:!0,children:[(0,r.jsx)("calcite-label",{layout:"inline-space-between",class:"sc-calcite-label-h sc-calcite-label-s",dir:"ltr",alignment:"start",status:"idle",scale:"m","calcite-hydrated":"",children:(0,r.jsxs)("label",{className:"sc-calcite-label-h sc-calcite-label-s sc-calcite-label",children:["Enable fill",(0,r.jsx)("calcite-switch",{name:"pointFillEnabled",value:"enabled",switched:o.current.pointFillEnabled,bind:void 0,"aria-checked":"true",dir:"ltr",tabindex:"0",scale:"m","calcite-hydrated":""})]})}),o.current.pointFillEnabled?(0,r.jsxs)("div",{children:[(0,r.jsx)("calcite-block-section",{text:"Color",children:(0,r.jsx)("calcite-color-picker",{dir:"ltr","hide-channels":"","hide-saved":"",scale:"m",value:o.current.pointFillColor,appearance:"default",name:"pointFillColor","calcite-hydrated":"",id:"pointFill"})},"point-fill-color"),(0,r.jsx)("calcite-block-section",{text:"Fill transparency",children:(0,r.jsx)("calcite-slider",{min:"0",max:"1",value:o.current.pointFillOpacity,bind:void 0,step:"0.1",label:"Opacity","label-handles":"",ticks:"0","page-step":"5",name:"fill-opacity",id:"pointFillOpacity",snap:""})},"point-fill-transparency")," "]}):""]},"point-fill"),(0,r.jsxs)("calcite-block",{heading:"Outline",open:!0,collapsible:!0,children:[(0,r.jsx)("calcite-block-section",{text:"Color",children:(0,r.jsx)("calcite-color-picker",{dir:"ltr","hide-channels":"","hide-saved":"",scale:"m",value:o.current.pointOutlineColor,appearance:"default",name:"pointOutlineColor","calcite-hydrated":""})}),(0,r.jsx)("calcite-block-section",{text:"Outline transparency",children:(0,r.jsx)("calcite-slider",{min:"0",max:"1",value:o.current.pointOutlineOpacity,bind:void 0,step:"0.1",label:"Opacity","label-handles":"",ticks:"0","page-step":"5",name:"pointOutlineOpacity",snap:""})}),(0,r.jsx)("calcite-block-section",{text:"Stroke",children:(0,r.jsx)("calcite-slider",{min:"0",max:"10",value:o.current.pointOutlineWidth,step:"0.1",label:"Width","label-handles":"",ticks:"0","page-step":"5",name:"pointOutlineWidth",snap:""})})]},"outline")]}):"","polyline"===l?(0,r.jsx)("div",{children:(0,r.jsxs)("calcite-block",{heading:"Line",open:!0,collapsible:!0,children:[(0,r.jsx)("calcite-block-section",{text:"Color",children:(0,r.jsx)("calcite-color-picker",{dir:"ltr","hide-channels":"","hide-saved":"",scale:"m",value:o.current.lineColor,appearance:"default",name:"lineColor","calcite-hydrated":""})}),(0,r.jsx)("calcite-block-section",{text:"Line transparency",children:(0,r.jsx)("calcite-slider",{min:"0",max:"1",value:o.current.lineOutlineOpacity,bind:void 0,step:"0.1",label:"Opacity","label-handles":"",ticks:"0","page-step":"5",name:"lineOutlineOpacity",snap:""})}),(0,r.jsx)("calcite-block-section",{text:"Stroke",children:(0,r.jsx)("calcite-slider",{min:"0",max:"10",value:o.current.lineWidth,bind:void 0,step:"0.1",label:"Width","label-handles":"",ticks:"0","page-step":"5",name:"lineWidth",snap:""})})]},"line")}):"","polygon"===l?(0,r.jsxs)("div",{children:[(0,r.jsxs)("calcite-block",{heading:"Fill",open:!0,collapsible:!0,children:[(0,r.jsx)("calcite-label",{layout:"inline-space-between",class:"sc-calcite-label-h sc-calcite-label-s",dir:"ltr",alignment:"start",status:"idle",scale:"m","calcite-hydrated":"",children:(0,r.jsxs)("label",{className:"sc-calcite-label-h sc-calcite-label-s sc-calcite-label",children:["Enable fill",(0,r.jsx)("calcite-switch",{name:"polygonFillEnabled",value:"enabled",switched:o.current.polygonFillEnabled,bind:void 0,"aria-checked":"true",dir:"ltr",tabindex:"0",scale:"m","calcite-hydrated":""})]})}),o.current.polygonFillEnabled?(0,r.jsxs)("div",{children:[(0,r.jsx)("calcite-block-section",{text:"Color",children:(0,r.jsx)("calcite-color-picker",{dir:"ltr","hide-channels":"","hide-saved":"",scale:"m",value:o.current.polygonFillColor,appearance:"default",name:"polygonFillColor","calcite-hydrated":""})},"polygon-fill-color"),(0,r.jsx)("calcite-block-section",{text:"Fill transparency",children:(0,r.jsx)("calcite-slider",{min:"0",max:"1",value:o.current.polygonFillOpacity,bind:void 0,step:"0.1",label:"Opacity","label-handles":"",ticks:"0","page-step":"5",name:"polygonFillOpacity",snap:""})},"polygon-fill-transparency")]}):""]},"polygon-fill"),(0,r.jsxs)("calcite-block",{heading:"Outline",open:!0,collapsible:!0,children:[(0,r.jsx)("calcite-block-section",{text:"Color",children:(0,r.jsx)("calcite-color-picker",{dir:"ltr","hide-channels":"","hide-saved":"",scale:"m",value:o.current.polygonOutlineColor,appearance:"default",name:"polygonOutlineColor","calcite-hydrated":""})}),(0,r.jsx)("calcite-block-section",{text:"Outline transparency",children:(0,r.jsx)("calcite-slider",{min:"0",max:"1",value:o.current.polygonOutlineOpacity,bind:void 0,step:"0.1",label:"Opacity","label-handles":"",ticks:"0","page-step":"5",name:"polygonOutlineOpacity",snap:""})}),(0,r.jsx)("calcite-block-section",{text:"Stroke",children:(0,r.jsx)("calcite-slider",{min:"0",max:"10",value:o.current.polygonOutlineWidth,bind:void 0,step:"0.1",label:"Width","label-handles":"",ticks:"0","page-step":"5",name:"polygonOutlineWidth",snap:""})})]},"outline")]}):"","text"===l?(0,r.jsx)("div",{children:(0,r.jsxs)("calcite-block",{heading:"Symbol",open:!0,collapsible:!0,children:[(0,r.jsx)("calcite-block-section",{text:"Font Size",open:!0,children:(0,r.jsx)("calcite-slider",{min:"6",max:"30",value:o.current.fontSize,step:"1",label:"Size","label-handles":"",ticks:"0","page-step":"5",name:"fontSize",snap:""})}),(0,r.jsx)("calcite-block-section",{text:"Font Color",open:!0,children:(0,r.jsxs)("calcite-label",{children:["Font Color",(0,r.jsx)("calcite-color-picker",{dir:"ltr","hide-channels":"","hide-saved":"",scale:"m",value:o.current.fontColor,appearance:"default",name:"fontColor","calcite-hydrated":"",id:"fontColor"})]})},"font-color")]},"text-symbol")}):""]})};var d=t(52639),p=t(33513),u=t(15067),h=t(58009),y=t(16072),b=t(61459),m=t(16851);let g,x,v,f,O=0;const k=new y.Z({size:10,color:new n.Z([255,0,0,1]),style:"circle",outline:new m.Z({color:new n.Z([0,0,0,1]),width:1})}),C=new m.Z({color:new n.Z([255,0,0,1]),width:2}),j=new b.Z({color:new n.Z([255,0,0,.5]),style:"solid",outline:new m.Z({color:new n.Z([255,0,0,1]),width:2})}),F=new h.Z({text:"",color:[0,0,0],haloColor:[255,255,255],haloSize:2,font:{family:"Arial Unicode MS",size:14}}),w=new p.default({listMode:"hide"}),E=w.pointLayer,S=w.polylineLayer,A=w.polygonLayer,T=w.textLayer,Z=(e,l)=>{"point"===l&&(e=>{k.color=n.Z.fromHex(e.pointFillColor),e.pointFillEnabled?k.color.a=e.pointFillOpacity:k.color.a=0,k.outline.color=n.Z.fromHex(e.pointOutlineColor),k.outline.color.a=e.pointOutlineOpacity,k.outline.width=e.pointOutlineWidth,k.size=e.pointSize})(e),"polygon"===l&&(e=>{e.polygonFillEnabled?j.style="solid":j.style="none",j.color=n.Z.fromHex(e.polygonFillColor),j.color.a=e.polygonFillOpacity,j.outline.color=n.Z.fromHex(e.polygonOutlineColor),j.outline.color.a=e.polygonOutlineOpacity,j.outline.width=e.polygonOutlineWidth})(e),"polyline"===l&&(e=>{C.color=n.Z.fromHex(e.lineColor),C.color.a=e.lineOutlineOpacity,C.width=e.lineWidth})(e),"text"===l&&(e=>{F.color=n.Z.fromHex(e.fontColor),F.haloColor=n.Z.fromHex(e.haloColor),F.font.size=e.fontSize})(e)},z=e=>{if("complete"===e.state)switch(e.tool){case"point":O++;const l=document.querySelector(".sketchTools calcite-action[active]");if("Point"==(null===l||void 0===l?void 0:l.getAttribute("text"))){E.remove(e.graphic);const l=new d.Z({geometry:e.graphic.geometry,symbol:k.clone(),attributes:{title:"point map note #"+O}});E.add(l)}else{if("Text"!=(null===l||void 0===l?void 0:l.getAttribute("text"))){console.log("point logic error occurred");break}{O++,T.remove(e.graphic);const l=new d.Z({geometry:e.graphic.geometry,symbol:F.clone(),attributes:{title:"text map note #"+O}});T.add(l)}}break;case"polyline":O++,S.remove(e.graphic);const t=new d.Z({geometry:e.graphic.geometry,symbol:C.clone(),attributes:{title:"polyline map note #"+O}});S.add(t);break;case"polygon":O++,A.remove(e.graphic);const i=new d.Z({geometry:e.graphic.geometry,symbol:j.clone(),attributes:{title:"polygon map note #"+O}});A.add(i);break;default:console.log("geometry type not found: ",e)}},W=(e,l)=>{const t=new u.Z({view:l,layer:e,updateOnGraphicClick:!0,defaultCreateOptions:{mode:"hybrid"}});return t.on("create",z),t},L=e=>{const l=(0,i.useRef)(null),t=(0,i.useRef)(null),n=(0,i.useRef)(null),o=(0,i.useRef)(null),c=(0,i.useRef)(null),a=(0,i.useRef)(null),d=(0,i.useRef)(),[p,u]=(0,i.useState)([]),h=(0,i.useRef)([]),y=(0,i.useRef)([]),[b,m]=(0,i.useState)(null),O=e=>{if("cancel"===e.state&&C(""),"complete"===e.state){const e=[n,o,c,a].find((e=>{var l;return null===(l=e.current)||void 0===l?void 0:l.active}));(null===e||void 0===e?void 0:e.current)===n.current&&C("point"),(null===e||void 0===e?void 0:e.current)===o.current&&C("polyline"),(null===e||void 0===e?void 0:e.current)===c.current&&C("polygon"),(null===e||void 0===e?void 0:e.current)===a.current&&C("text")}},k=(l,t)=>{[f,g,x,v].forEach((e=>{e.cancel()})),t.create(l),e.toolActivated(t)},C=e=>{let l=[];"point"===e&&(k(e,g),l=[c,o,a],n.current&&(n.current.active=!0)),"polyline"===e&&(k(e,x),l=[n,c,a],o.current&&(o.current.active=!0)),"polygon"===e&&(k(e,v),l=[n,o,a],c.current&&(c.current.active=!0)),"text"===e&&(k("point",f),l=[n,o,c],a.current&&(a.current.active=!0)),""===e&&(l=[n,o,c,a],l.forEach((e=>{e.current&&(e.current.active=!1)}))),m(e)},j=(e,l)=>{e.cancel(),m(null),l.active=!1,l.blur(),g.view.popup.autoOpenEnabled=!0};return(0,i.useEffect)((()=>{var l;return(l=e.view).map.add(w),g=W(E,l),x=W(S,l),v=W(A,l),f=W(T,l),d.current={pointSize:10,pointFillEnabled:!0,pointFillColor:"#FF0000",pointOutlineColor:"#000000",pointFillOpacity:.5,pointOutlineOpacity:1,pointOutlineWidth:1,lineOutlineOpacity:1,lineWidth:2,lineColor:"#FF0000",polygonFillEnabled:!0,polygonFillOpacity:.5,polygonOutlineOpacity:1,polygonOutlineWidth:2,polygonOutlineColor:"#000000",polygonFillColor:"#FF0000",fontSize:12,fontFamily:"Arial",fontWeight:"normal",fontStyle:"normal",fontColor:"#000000",haloColor:"#FFFFFF"},[g,x,v,f].forEach((e=>{y.current.push(null===e||void 0===e?void 0:e.on("create",O)),y.current.push(null===e||void 0===e?void 0:e.on("create",O)),y.current.push(null===e||void 0===e?void 0:e.watch("activeTool",(e=>{}))),y.current.push(null===e||void 0===e?void 0:e.on("update",(e=>{("start"===e.state&&0===h.current.length||"active"===e.state)&&(u([...e.graphics]),h.current=[...e.graphics]),"complete"===e.state&&e.graphics.forEach((e=>{const l=h.current.indexOf(e);u([...p,...p.slice(l)]),h.current=[...p,...p.slice(l)]}))})))})),()=>{y.current.forEach((e=>{e.remove()}))}}),[]),(0,r.jsxs)("div",{className:"panel",ref:l,children:[(0,r.jsxs)("calcite-tooltip-manager",{children:[(0,r.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"pointAction",placement:"bottom",children:"Select graphics"}),(0,r.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"pointAction",placement:"bottom",children:"Sketch a point"}),(0,r.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"lineAction",placement:"bottom",children:"Sketch a line"}),(0,r.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"polygonAction",placement:"bottom",children:"Sketch a polygon"}),(0,r.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"textAction",placement:"bottom",children:"Add text label"}),(0,r.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"clearAction",placement:"bottom",children:"Clear all sketch graphics"}),(0,r.jsxs)("div",{className:"sketchTools",children:[(0,r.jsx)("calcite-action",{text:"Select",icon:"cursor",id:"selectAction",onClick:()=>{m(null),[n,o,c,a].forEach((e=>{m(null),e.current&&(e.current.active=!1)})),null===g||void 0===g||g.cancel(),null===x||void 0===x||x.cancel(),null===v||void 0===v||v.cancel(),null===f||void 0===f||f.cancel(),g.view.popup.autoOpenEnabled=!0}}),(0,r.jsx)("calcite-action",{ref:n,text:"Point",icon:"pins",id:"pointAction",onClick:e=>{e.target.active?j(g,e.target):C("point")}}),(0,r.jsx)("calcite-action",{ref:o,text:"Line",icon:"line",id:"lineAction",onClick:e=>{e.target.active?j(x,e.target):C("polyline")}}),(0,r.jsx)("calcite-action",{ref:c,text:"Polygon",icon:"freehand-area",id:"polygonAction",onClick:e=>{e.target.active?j(v,e.target):C("polygon")}}),(0,r.jsx)("calcite-action",{ref:a,text:"Text",icon:"speech-bubble",id:"textAction",onClick:e=>{e.target.active?j(v,e.target):C("text")}}),(0,r.jsx)("calcite-action",{text:"Clear",icon:"trash",id:"clearAction",onClick:()=>{m(null),[n,o,c,a].forEach((e=>{e.current&&(e.current.active=!1)})),null===g||void 0===g||g.layer.graphics.removeAll(),null===x||void 0===x||x.layer.graphics.removeAll(),null===v||void 0===v||v.layer.graphics.removeAll(),null===f||void 0===f||f.layer.graphics.removeAll()}}),(0,r.jsx)("calcite-action",{text:"Undo",icon:"undo",id:"undoAction",onClick:()=>{var e,l,t,i;null!==(e=n.current)&&void 0!==e&&e.active&&g.undo(),null!==(l=o.current)&&void 0!==l&&l.active&&x.undo(),null!==(t=c.current)&&void 0!==t&&t.active&&v.undo(),null!==(i=a.current)&&void 0!==i&&i.active&&f.undo()}})]})]}),(null===p||void 0===p?void 0:p.length)>0&&(0,r.jsx)("calcite-action",{icon:"trash","text-enabled":!0,text:`Delete ${p.length} selected graphic${p.length>1?"s":""} `,onClick:()=>{[g,x,v,f].forEach((e=>{null===e||void 0===e||e.delete(),u([])}))}}),"text"===b&&(0,r.jsxs)("calcite-label",{children:["Text Label",(0,r.jsx)("calcite-input",{ref:t,id:"labelInput",placeholder:"Label",type:"textarea",value:F.text,onInput:e=>{F.text=e.target.value}})]}),(0,r.jsx)(s,{settingsChanged:e=>{b&&(Z(e,b),e.current={...e})},geometryType:b})]})},I=L}}]);
//# sourceMappingURL=96.cb55dbcd.chunk.js.map