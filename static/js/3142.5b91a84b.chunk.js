"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[3142],{33513:(e,t,i)=>{i.r(t),i.d(t,{default:()=>A});var s=i(27366),n=(i(59486),i(52639)),o=(i(51508),i(40281)),l=i(10064),r=i(84652),a=i(92026),c=i(97642),d=i(18202),p=i(51370),h=i(49861),u=(i(25243),i(38511)),y=i(69912),g=i(31201),_=i(79803),v=i(50689),m=i(92975),b=i(16455),w=i(93655),f=i(30651),C=i(25820),S=i(6693),O=i(6061),M=i(29598),L=i(56811),T=i(83040),I=i(61459),k=i(16851),E=i(16072),N=i(58009),x=i(78952),F=i(53866);function V(e){return e.layers.some((e=>null!=e.layerDefinition.visibilityField))}const Z=new T.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),P=new T.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0});let B=class extends w.Z{constructor(e){super(e),this.visibilityMode="inherited"}initialize(){for(const e of this.graphics)e.sourceLayer=this.layer;this.graphics.on("after-add",(e=>{e.item.sourceLayer=this.layer})),this.graphics.on("after-remove",(e=>{e.item.sourceLayer=null}))}get sublayers(){return this.graphics}};(0,s._)([(0,h.Cb)({readOnly:!0})],B.prototype,"sublayers",null),(0,s._)([(0,h.Cb)()],B.prototype,"layer",void 0),(0,s._)([(0,h.Cb)()],B.prototype,"layerId",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],B.prototype,"visibilityMode",void 0),B=(0,s._)([(0,y.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],B);const G=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",id:"polygonLayer",layerId:0,title:"Polygons",identifyingSymbol:(new I.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",id:"polylineLayer",layerId:1,title:"Polylines",identifyingSymbol:(new k.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",id:"multipointLayer",layerId:2,title:"Multipoints",identifyingSymbol:(new E.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"pointLayer",layerId:3,title:"Points",identifyingSymbol:(new E.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"textLayer",layerId:4,title:"Text",identifyingSymbol:(new N.Z).toJSON()}];let R=class extends((0,S.h)((0,L.M)((0,O.q)((0,M.I)((0,c.R)(f.Z)))))){constructor(e){super(e),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.minScale=0,this.maxScale=0,this.spatialReference=x.Z.WGS84,this.sublayers=new o.Z(G.map((e=>new B({id:e.id,layerId:e.layerId,title:e.title,layer:this})))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(e,t,i){return{operations:{supportsMapNotesEditing:!V(t)&&"portal-item"!==i?.origin}}}readFeatureCollections(e,t,i){if(!V(t))return null;const s=t.layers.map((e=>{const t=new b.default;return t.read(e,i),t}));return new o.Z({items:s})}readLegacyfeatureCollectionJSON(e,t){return V(t)?(0,r.d9)(t.featureCollection):null}readFullExtent(e,t){if(!t.layers.length||t.layers.every((e=>!e.layerDefinition.extent)))return new F.Z({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:x.Z.WGS84});const i=x.Z.fromJSON(t.layers[0].layerDefinition.spatialReference);return t.layers.reduce(((e,t)=>{const i=t.layerDefinition.extent;return i?F.Z.fromJSON(i).union(e):e}),new F.Z({spatialReference:i}))}readMinScale(e,t){for(const i of t.layers)if(null!=i.layerDefinition.minScale)return i.layerDefinition.minScale;return 0}readMaxScale(e,t){for(const i of t.layers)if(null!=i.layerDefinition.maxScale)return i.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(e,t){return t.layers.length?x.Z.fromJSON(t.layers[0].layerDefinition.spatialReference):x.Z.WGS84}readSublayers(e,t,i){if(V(t))return null;const s=[];let l=t.layers.reduce(((e,t)=>Math.max(e,t.layerDefinition.id??-1)),-1)+1;for(const{layerDefinition:o,featureSet:r}of t.layers){const e=o.geometryType??r.geometryType,t=o.id??l++,i=G.find((t=>e===t.geometryTypeJSON&&o.drawingInfo?.renderer?.symbol?.type===t.identifyingSymbol.type));if(i){const e=new B({id:i.id,title:o.name,layerId:t,layer:this,graphics:r.features.map((e=>{let{geometry:t,symbol:i,attributes:s,popupInfo:o}=e;return n.Z.fromJSON({attributes:s,geometry:t,symbol:i,popupTemplate:o})}))});s.push(e)}}return new o.Z(s)}writeSublayers(e,t,i,s){const{minScale:n,maxScale:o}=this;if((0,a.Wi)(e))return;const r=e.some((e=>e.graphics.length>0));if(!this.capabilities.operations.supportsMapNotesEditing)return void(r&&s?.messages?.push(new l.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer")));const c=[];let p=this.spatialReference.toJSON();e:for(const l of e)for(const e of l.graphics)if((0,a.pC)(e.geometry)){p=e.geometry.spatialReference.toJSON();break e}for(const l of G){const t=e.find((e=>l.id===e.id));this._writeMapNoteSublayer(c,t,l,n,o,p,s)}(0,d.RB)("featureCollection.layers",c,t)}get textLayer(){return this._findSublayer("textLayer")}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}read(e,t){"featureCollection"in e&&(e=(0,r.d9)(e),Object.assign(e,e.featureCollection)),super.read(e,t)}async beforeSave(){if((0,a.Wi)(this.sublayers))return;let e=null;const t=[];for(const s of this.sublayers)for(const i of s.graphics)if((0,a.pC)(i.geometry)){const s=i.geometry;e?(0,m.fS)(s.spatialReference,e)||((0,_.Up)(s.spatialReference,e)||(0,_.kR)()||await(0,_.zD)(),i.geometry=(0,_.iV)(s,e)):e=s.spatialReference,t.push(i)}const i=await(0,v.aX)(t.map((e=>e.geometry)));t.forEach(((e,t)=>e.geometry=i[t]))}_findSublayer(e){return(0,a.Wi)(this.sublayers)?null:this.sublayers?.find((t=>t.id===e))??null}_writeMapNoteSublayer(e,t,i,s,n,o,l){const c=[];if(!(0,a.Wi)(t)){for(const e of t.graphics)this._writeMapNote(c,e,i.geometryType,l);this._normalizeObjectIds(c,Z),e.push({layerDefinition:{name:t.title,drawingInfo:{renderer:{type:"simple",symbol:(0,r.d9)(i.identifyingSymbol)}},id:t.layerId,geometryType:i.geometryTypeJSON,minScale:s,maxScale:n,objectIdField:"OBJECTID",fields:[Z.toJSON(),P.toJSON()],spatialReference:o},featureSet:{features:c,geometryType:i.geometryTypeJSON}})}}_writeMapNote(e,t,i,s){if((0,a.Wi)(t))return;const{geometry:n,symbol:o,popupTemplate:l}=t;if((0,a.Wi)(n))return;if(n.type!==i)return void s?.messages?.push(new p.Z("map-notes-layer:invalid-geometry-type",`Geometry "${n.type}" cannot be saved in "${i}" layer`,{graphic:t}));if((0,a.Wi)(o))return void s?.messages?.push(new p.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:t}));const r={attributes:{...t.attributes},geometry:n.toJSON(),symbol:o.toJSON()};(0,a.pC)(l)&&(r.popupInfo=l.toJSON()),e.push(r)}_normalizeObjectIds(e,t){const i=t.name;let s=(0,C.S)(i,e)+1;const n=new Set;for(const o of e){o.attributes||(o.attributes={});const{attributes:e}=o;(null==e[i]||n.has(e[i]))&&(e[i]=s++),n.add(e[i])}}};(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"capabilities",void 0),(0,s._)([(0,u.r)(["portal-item","web-map"],"capabilities",["layers"])],R.prototype,"readCapabilities",null),(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"featureCollections",void 0),(0,s._)([(0,u.r)(["web-map","portal-item"],"featureCollections",["layers"])],R.prototype,"readFeatureCollections",null),(0,s._)([(0,h.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],R.prototype,"featureCollectionJSON",void 0),(0,s._)([(0,u.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],R.prototype,"readLegacyfeatureCollectionJSON",null),(0,s._)([(0,h.Cb)({readOnly:!0,json:{read:!1,write:{enabled:!0,ignoreOrigin:!0}}})],R.prototype,"featureCollectionType",void 0),(0,s._)([(0,h.Cb)({json:{write:!1}})],R.prototype,"fullExtent",void 0),(0,s._)([(0,u.r)(["web-map","portal-item"],"fullExtent",["layers"])],R.prototype,"readFullExtent",null),(0,s._)([(0,h.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],R.prototype,"legendEnabled",void 0),(0,s._)([(0,h.Cb)({type:["show","hide"]})],R.prototype,"listMode",void 0),(0,s._)([(0,h.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],R.prototype,"minScale",void 0),(0,s._)([(0,u.r)(["web-map","portal-item"],"minScale",["layers"])],R.prototype,"readMinScale",null),(0,s._)([(0,h.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],R.prototype,"maxScale",void 0),(0,s._)([(0,u.r)(["web-map","portal-item"],"maxScale",["layers"])],R.prototype,"readMaxScale",null),(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"multipointLayer",null),(0,s._)([(0,h.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],R.prototype,"operationalLayerType",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"pointLayer",null),(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"polygonLayer",null),(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"polylineLayer",null),(0,s._)([(0,h.Cb)({type:x.Z})],R.prototype,"spatialReference",void 0),(0,s._)([(0,u.r)(["web-map","portal-item"],"spatialReference",["layers"])],R.prototype,"readSpatialReference",null),(0,s._)([(0,h.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],R.prototype,"sublayers",void 0),(0,s._)([(0,u.r)("web-map","sublayers",["layers"])],R.prototype,"readSublayers",null),(0,s._)([(0,g.c)("web-map","sublayers")],R.prototype,"writeSublayers",null),(0,s._)([(0,h.Cb)({readOnly:!0})],R.prototype,"textLayer",null),(0,s._)([(0,h.Cb)()],R.prototype,"title",void 0),(0,s._)([(0,h.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"type",void 0),R=(0,s._)([(0,y.j)("esri.layers.MapNotesLayer")],R);const A=R},25820:(e,t,i)=>{i.d(t,{S:()=>n,X:()=>s});const s=1;function n(e,t){let i=0;for(const s of t){const t=s.attributes?.[e];"number"==typeof t&&isFinite(t)&&(i=Math.max(i,t))}return i}},69735:(e,t,i)=>{i.d(t,{Z:()=>w});var s=i(27366),n=i(40281),o=i(91505),l=i(100),r=i(94172),a=i(49861),c=(i(63780),i(93169),i(25243),i(69912)),d=i(95781),p=i(9309);const h="view",u="view-layers",y="map-layers",g="layer-views",_="layer-list-mode",v="children",m=n.Z.ofType(d.Z);let b=class extends o.Z.EventedAccessor{constructor(e){super(e),this._handles=new l.Z,this.listItemCreatedFunction=null,this.operationalItems=new m,this.view=null}initialize(){this._handles.add([(0,r.YP)((()=>[this.view,this.view?.ready]),(()=>this._viewHandles()),r.nn),(0,r.YP)((()=>this.listItemCreatedFunction),(()=>this._listItemCreatedFunctionChanged()))],h)}destroy(){this._handles.destroy(),this._handles=null,this.view=null,this.operationalItems.removeAll()}get state(){const e=this.get("view");return this.get("view.ready")?"ready":e?"loading":"disabled"}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,s){const n=e?.layer;if(!n)return;const o=this.view?.map?.layers,l=t?(0,p.Hh)(t):o,r=i?(0,p.Hh)(i):o;if(!l||!r)return;const{operationalItems:a}=this,c=t?.children||a,d=i?.children||a,h=r.length-s;e.parent=i||null,c.includes(e)&&c.remove(e),l.includes(n)&&l.remove(n),d.includes(e)||d.add(e,h),r.includes(n)||r.add(n,h)}_createLayerViewHandles(e){const{_handles:t}=this;t.remove(g),this._compileList(),e&&t.add(e.on("change",(()=>this._compileList())),g)}_createMapLayerHandles(e){const{_handles:t}=this;t.remove(y),this._compileList(),e&&t.add(e.on("change",(()=>this._compileList())),y)}_createListItem(e){const{view:t,listItemCreatedFunction:i}=this;return new d.Z({layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){const{_handles:e,operationalItems:t}=this;t.forEach((t=>{e.remove(`${v}-${t.uid}`)})),t.removeAll()}_getViewableLayers(e){if(e)return e.filter((e=>"hide"!==(0,p.aV)(e)))}_watchLayersListMode(e){const{_handles:t}=this;t.remove(_),e&&e.forEach((e=>{"listMode"in e&&t.add((0,r.YP)((()=>e.listMode),(()=>this._compileList())),_)}))}_compileList(){const e=this.get("view.map.layers");this._watchLayersListMode(e);const t=this._getViewableLayers(e);t&&t.length?(this._createNewItems(t),this._removeItems(t),this._sortItems(t)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach((e=>{t.find((t=>t.layer===e))||t.add(this._createListItem(e))}))}_removeItems(e){const{_handles:t,operationalItems:i}=this,s=[];i.forEach((i=>{i&&e&&e.includes(i.layer)||(t.remove(`${v}-${i.uid}`),s.push(i))})),i.removeMany(s)}_sortItems(e){const{operationalItems:t}=this;t.sort(((t,i)=>{const s=e.indexOf(t.layer),n=e.indexOf(i.layer);return s>n?-1:s<n?1:0}))}_listItemCreatedFunctionChanged(){this._removeAllItems(),this._compileList()}_viewHandles(){const{_handles:e,view:t}=this;e.remove([y,g,u]),this._compileList(),t&&t.ready&&e.add([(0,r.YP)((()=>this.view?.map?.allLayers),(e=>this._createMapLayerHandles(e)),r.nn),(0,r.YP)((()=>this.view?.allLayerViews),(e=>this._createLayerViewHandles(e)),r.nn)],u)}};(0,s._)([(0,a.Cb)()],b.prototype,"listItemCreatedFunction",void 0),(0,s._)([(0,a.Cb)({type:m})],b.prototype,"operationalItems",void 0),(0,s._)([(0,a.Cb)({readOnly:!0})],b.prototype,"state",null),(0,s._)([(0,a.Cb)()],b.prototype,"view",void 0),b=(0,s._)([(0,c.j)("esri.widgets.LayerList.LayerListViewModel")],b);const w=b},95781:(e,t,i)=>{i.d(t,{Z:()=>G});var s,n=i(27366),o=i(85015),l=i(40281),r=i(41691),a=i(79056),c=i(94172),d=i(8025),p=(i(63780),i(93169),i(89125)),h=i(49861),u=i(69912),y=i(57976),g=i(6945);i(25243);let _=s=class extends y.Z{constructor(e){super(e),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new s({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};(0,n._)([(0,h.Cb)()],_.prototype,"displayValueEnabled",void 0),(0,n._)([(0,h.Cb)()],_.prototype,"max",void 0),(0,n._)([(0,h.Cb)()],_.prototype,"min",void 0),(0,n._)([(0,h.Cb)()],_.prototype,"step",void 0),(0,n._)([(0,h.Cb)()],_.prototype,"value",void 0),_=s=(0,n._)([(0,u.j)("esri.support.Action.ActionSlider")],_);const v=_;var m=i(9676),b=i(100),w=i(69407),f=i(9309),C=i(53963),S=i(67005);const O="esri-layer-list-panel",M="esri-layer-list-panel__content",L="esri-layer-list-panel__content--legend",T="esri-layer-list-panel__content--string",I="esri-layer-list-panel__content--html-element",k="esri-layer-list-panel__content--widget";let E=class extends((0,a.IG)(w.Z)){constructor(e,t){super(e,t),this._legend=null,this._handles=new b.Z,this.content=null,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.own([(0,c.YP)((()=>this.content),(e=>this._createLegend(e)),c.nn)])}destroy(){const{_legend:e}=this;e&&e.destroy(),this._legend=null}get className(){const{image:e}=this,t=this._getFirstWidget();return this._get("className")||!e&&t?t.iconClass:""}set className(e){void 0!==e?this._override("className",e):this._clearOverride("className")}get title(){const e=this._getFirstWidget();return this._get("title")||e?e.label:""}set title(e){void 0!==e?this._override("title",e):this._clearOverride("title")}render(){return(0,S.u)("div",{class:O},this._renderContents())}_renderContent(e){const{_legend:t,listItem:i}=this;return e?"legend"===e?i&&i.view&&i.layer&&t?(0,S.u)("div",{class:this.classes(M,L),key:t},t.render()):null:"string"==typeof e?(0,S.u)("div",{class:this.classes(M,T),key:e,innerHTML:e}):(0,C.Qd)(e)?(0,S.u)("div",{class:this.classes(M,k),key:e},e.render()):e instanceof HTMLElement?(0,S.u)("div",{class:this.classes(M,I),key:e,bind:e,afterCreate:this._attachToNode}):null:null}_renderContents(){const{content:e}=this;return Array.isArray(e)?e.map((e=>this._renderContent(e))):this._renderContent(e)}_getLegendOptions(){const{listItem:e}=this;if(!e)return{};const{layer:t,view:i}=e;return t&&i?{view:i,layerInfos:[(0,f.yN)(t)]}:{}}_createLegend(e){this._hasLegend(e)&&!this._legend&&Promise.all([i.e(4226),i.e(5592),i.e(1508),i.e(4055),i.e(7111),i.e(3798),i.e(9014),i.e(6739),i.e(2927),i.e(6828),i.e(2151),i.e(3070)]).then(i.bind(i,65349)).then((e=>{let{default:t}=e;const{_handles:i,listItem:s}=this,n=new t(this._getLegendOptions());this._legend=n,this.notifyChange("className"),this.notifyChange("title");const o=(0,c.YP)((()=>[s?.view,s?.layer,s?.layer?.source,s?.layer?.parent]),(()=>this._updateLegend(n)),c.nn);i.add(o,"legends"),this.scheduleRender()}))}_hasLegend(e){const t="legend";return e===t||!!Array.isArray(e)&&e.includes(t)}_attachToNode(e){e.appendChild(this)}_updateLegend(e){e.set(this._getLegendOptions()),this.scheduleRender()}_getWidget(e){return"legend"===e?this._legend:(0,C.Qd)(e)?e:null}_getFirstWidget(){const{content:e}=this;if(Array.isArray(e)){let t=null;return e.some((e=>{const i=this._getWidget(e);return i&&(t=i),!!i})),t}return this._getWidget(e)}};(0,n._)([(0,h.Cb)()],E.prototype,"className",null),(0,n._)([(0,h.Cb)()],E.prototype,"content",void 0),(0,n._)([(0,h.Cb)()],E.prototype,"image",void 0),(0,n._)([(0,h.Cb)()],E.prototype,"listItem",void 0),(0,n._)([(0,h.Cb)()],E.prototype,"title",null),(0,n._)([(0,h.Cb)()],E.prototype,"open",void 0),(0,n._)([(0,h.Cb)()],E.prototype,"visible",void 0),E=(0,n._)([(0,u.j)("esri.widgets.LayerList.ListItemPanel")],E);const N=E;var x;const F=l.Z.ofType({key:"type",defaultKeyValue:"button",base:y.Z,typeMap:{button:g.Z,toggle:m.Z,slider:v}}),V=l.Z.ofType(F),Z="layer",P="child-list-mode";let B=x=class extends((0,a.IG)((0,r.p)(o.Z))){constructor(e){super(e),this.actionsSections=new V,this.actionsOpen=!1,this.children=new(l.Z.ofType(x)),this.childrenSortable=!0,this.error=null,this.hidden=!1,this.layer=null,this.layerView=null,this.listItemCreatedFunction=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null,this.visible=null}initialize(){if(this.handles.add([(0,c.YP)((()=>this.layer),(e=>this._watchLayerProperties(e)),c.nn),(0,c.YP)((()=>this.view),(e=>this._updateChildren(e)),c.nn),(0,c.YP)((()=>this.panel),(e=>this._setListItemOnPanel(e)),c.nn),(0,c.YP)((()=>[this.layer,this.view]),(()=>this._getLayerView()),c.nn)]),"function"==typeof this.listItemCreatedFunction){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.view=null}get connectionStatus(){const{layerView:e}=this;if(e&&"connectionStatus"in e)return e.connectionStatus}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e))&&!e.spatialReferenceSupported}castPanel(e){return this.get("panel.open")&&!e.hasOwnProperty("open")&&(e.open=!0),e?new N(e):null}get title(){const e=this.get("layer.layer");return(!e||e&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""}set title(e){void 0!==e?this._override("title",e):this._clearOverride("title")}get updating(){const{layerView:e,connectionStatus:t}=this;return!t&&(e?e.updating:this._isLayerUpdating(this.layer))}get visibleAtCurrentScale(){return!(0,f.zb)(this.layer,this.get("view.scale"))}get visibilityMode(){return(0,f.sT)(this.layer)}clone(){return new x({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildren(e){const t=this.children;t&&t.forEach((t=>t.view=e))}_addChildren(e){if(this.handles.remove(P),this.children.removeAll(),!e)return;e.forEach((t=>{this.handles.add((0,c.YP)((()=>t.listMode),(()=>this._addChildren(e))),P)}));const t=e.filter((e=>"hide"!==(0,f.aV)(e)));this.children.addMany(this._makeChildren(t))}_watchSublayerChanges(e){e&&this.handles.add(e.on("change",(()=>{this._addChildren(e)})),Z)}_initializeChildLayers(e){this._addChildren(e),this._watchSublayerChanges(e)}_makeChildren(e){return e.map((e=>(0,f.gF)(e)?new x({layer:e,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null)).reverse()}_watchLayerProperties(e){if(!this.handles)return;if(this.handles.remove(Z),this.handles.remove(P),!e)return;if(this.handles.add((0,c.YP)((()=>e.listMode),(()=>this._watchLayerProperties(e))),Z),"hide-children"===(0,f.aV)(e))return void this.children.removeAll();const t=(0,f.Ff)(e);t&&this.handles.add((0,c.YP)((()=>e[t]),(()=>{e.hasOwnProperty(t)&&this._initializeChildLayers(e[t])}),c.nn),Z)}async _getLayerView(){const{layer:e,view:t}=this;if(e&&t)try{const i=await t.whenLayerView(e);if(i.layer!==this.layer)return;this._set("layerView",i)}catch{}}_isLayerUpdating(e){return e&&"loading"===e.loadStatus}};(0,n._)([(0,h.Cb)({type:V})],B.prototype,"actionsSections",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"actionsOpen",void 0),(0,n._)([(0,h.Cb)({type:l.Z})],B.prototype,"children",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"childrenSortable",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],B.prototype,"connectionStatus",null),(0,n._)([(0,d.B)("layer.loadError?")],B.prototype,"error",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"hidden",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],B.prototype,"incompatible",null),(0,n._)([(0,h.Cb)()],B.prototype,"layer",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],B.prototype,"layerView",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"listItemCreatedFunction",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"open",void 0),(0,n._)([(0,h.Cb)({type:N})],B.prototype,"panel",void 0),(0,n._)([(0,p.p)("panel")],B.prototype,"castPanel",null),(0,n._)([(0,h.Cb)()],B.prototype,"parent",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"sortable",void 0),(0,n._)([(0,h.Cb)()],B.prototype,"title",null),(0,n._)([(0,h.Cb)({readOnly:!0})],B.prototype,"updating",null),(0,n._)([(0,h.Cb)({value:null})],B.prototype,"view",void 0),(0,n._)([(0,d.B)("layer.visible")],B.prototype,"visible",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],B.prototype,"visibleAtCurrentScale",null),(0,n._)([(0,h.Cb)({readOnly:!0})],B.prototype,"visibilityMode",null),B=x=(0,n._)([(0,u.j)("esri.widgets.LayerList.ListItem")],B);const G=B},9309:(e,t,i)=>{i.d(t,{Cl:()=>p,Ff:()=>r,Hh:()=>u,YO:()=>h,aV:()=>o,gF:()=>c,jt:()=>y,sT:()=>l,xA:()=>a,yN:()=>g,zb:()=>d});const s="hide",n="hide-children";function o(e){if(e)return null!=e.listMode?e.listMode:void 0}function l(e){if(!e)return"inherited";const t=e.get("layer.capabilities.exportMap.supportsSublayerVisibility");if("boolean"==typeof t)return t?"independent":"inherited";const i=e.get("capabilities.exportMap.supportsSublayerVisibility");return"boolean"==typeof i?i?"independent":"inherited":null!=e.visibilityMode?e.visibilityMode:"independent"}function r(e){if(e)return"type"in e?e.listMode!==n&&"wmts"!==e.type?"group"===e.type?"layers":"sublayers":void 0:"sublayers"}function a(e){const t=e&&(e.get("layer.layer")||e.layer);if(!t)return!1;const i=t.get("capabilities.exportMap.supportsDynamicLayers");return"boolean"!=typeof i||i}function c(e){return o(e)!==s}function d(e,t){if(!e||isNaN(t))return!1;const i=function(e){if(e)return null!=e.minScale?e.minScale:void 0}(e),s=function(e){if(e)return null!=e.maxScale?e.maxScale:void 0}(e),n=!isNaN(i)&&i>0&&t>i,o=!isNaN(s)&&s>0&&t<s;return n||o}function p(e,t){e&&e.sort(((e,i)=>{const s=t.indexOf(e.uid),n=t.indexOf(i.uid);return s>n?-1:s<n?1:0}))}function h(e,t){const i=e?.layer;if(!i)return;const s=r(i);s&&p(i.get(s),t)}function u(e){const t=e?.layer;return t&&"group"===t.type?t.layers:null}function y(e,t){const i=e.layer?.uid;return i&&t.find((e=>e.layer?.uid===i))}function g(e){const t=function(e){return!!e?.layer}(e)?e:null,i=e?.parent,s="map-image"===i?.type&&t.source;return s&&i?{layer:i,title:"",sublayerIds:[s.mapLayerId]}:{layer:e,title:""}}},30818:(e,t,i)=>{var s=i(27366),n=(i(59166),i(40281)),o=i(42537),l=i(92026),r=i(94172),a=i(8025),c=(i(63780),i(93169),i(89125)),d=i(49861),p=i(69912),h=i(52349),u=i(61920),y=i(98173),g=i(69407),_=i(15067),v=i(80975),m=i(80532),b=i(67005),w=i(91505),f=(i(25243),i(85015)),C=i(41691),S=(i(51508),i(100)),O=i(93655);async function M(){return async function(){return Promise.all([i.e(9058),i.e(3645)]).then(i.bind(i,50309))}().then((e=>{let{contains:t,intersects:i,overlaps:s,simplify:n}=e;return{contains:t,intersects:i,overlaps:s,simplify:n}}))}async function L(e){const{selector:t,candidates:i,currentSelection:s,options:n,view:o}=e;if(!(i&&i.length&&s&&o))return{added:[],removed:[]};const{overlaps:l,intersects:r,contains:a}=n,{spatialReference:c}=o;if(!t)return{added:[],removed:s.removeAll()};const d=t,p=await M(),h=[],u=[];return i.forEach((e=>{const t=e.geometry,i=l&&!!p.overlaps(c,d,t),n=r&&!!p.intersects(c,d,t),o=a&&!!p.contains(c,d,t),y=s.includes(e);i||n||o?!y&&h.push(e):y&&u.push(e)})),s.removeMany(u),s.addMany(h),{added:h,removed:u}}var T=i(61459),I=i(16851),k=i(16072);let E=class extends w.Z.EventedAccessor{constructor(e){let{candidates:t,options:i,view:s}=e;super(),this._activeOptions=null,this._dashedFillSymbol=new T.Z({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}}),this._dashedLineSymbol=new I.Z({style:"dash",color:[12,207,255],width:2}),this._defaultOptions={createTool:"rectangle",createOptions:null,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}},this._completed=!1,this._handles=new S.Z,this._sketchViewModel=new _.Z,this._sketchGraphicsLayer=new O.Z({listMode:"hide",internal:!0}),this._transparentPointSymbol=new k.Z({color:[0,0,0,0],outline:{style:"none",width:0}}),this.candidates=null,this.geometry=null,this.options=null,this.selection=new n.Z,this.view=null,this.candidates=t,this.options=i,this.view=s;const{_dashedFillSymbol:o,_dashedLineSymbol:l,_sketchViewModel:r,_sketchGraphicsLayer:a,_transparentPointSymbol:c}=this;r.set({layer:a,view:this.view,activePointSymbol:c,activeLineSymbol:l,activeVertexSymbol:c,activeFillSymbol:o,pointSymbol:c,polygonSymbol:o,polylineSymbol:l,vertexSymbol:c}),this._handles.add([r.on("create",(e=>this._onSketchEvent(e))),r.on(["undo","redo"],(e=>this._onSketchEvent(e)))])}initialize(){this._load()}destroy(){this._handles.destroy(),this._handles=null}get state(){const{_completed:e,_sketchViewModel:{state:t}}=this;return e?"complete":"active"===t?"active":"disabled"}cancel(){this._sketchViewModel.cancel()}async _load(){await this.view.whenReady();const{options:e}=this,{createTool:t,createOptions:i}=this._activeOptions={...this._defaultOptions,...e};this._sketchViewModel.create(t,i)}_onSketchEvent(e){const t=("create"===e.type?e.graphic:e.graphics[0])?.geometry||null,i="create"===e.type&&"cancel"===e.state,s="create"===e.type&&"complete"===e.state;this._processSelectionGeometry(t,s,i)}_processSelectionGeometry(e,t,i){if(this._set("geometry",e),(t||i)&&(this._completed=!0),i)return void this._onComplete([],!0);const{_activeOptions:s,candidates:n,selection:o,view:l}=this;L({selector:e,candidates:n,currentSelection:o,options:s.selectionOptions,view:l}).then((e=>{let{added:i,removed:s}=e;t?this._onComplete(this.selection.toArray(),!1):(i.length||s.length)&&this.emit("selection-change",{added:i,removed:s,type:"selection-change"})}))}_onComplete(e,t){this._handles.removeAll(),this.notifyChange("state"),this.emit("complete",{aborted:t,selection:e,type:"complete"})}};(0,s._)([(0,d.Cb)()],E.prototype,"_completed",void 0),(0,s._)([(0,d.Cb)()],E.prototype,"candidates",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],E.prototype,"geometry",void 0),(0,s._)([(0,d.Cb)()],E.prototype,"options",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],E.prototype,"selection",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],E.prototype,"state",null),(0,s._)([(0,d.Cb)({value:null})],E.prototype,"view",void 0),E=(0,s._)([(0,p.j)("esri.widgets.support.Selector2D.SelectionOperation2D")],E);const N=E;let x=class extends((0,C.p)(f.Z)){constructor(e){super(e),this._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0},this.candidates=null,this.options=null,this.view=null}draw(e){const{_defaultSelectionOptions:t,candidates:i,options:s,view:n}=this,o={...t,...s,...e?.selectionOptions};return new N({candidates:i,options:{...e,selectionOptions:o},view:n})}async selectionFrom(e,t){const{_defaultSelectionOptions:i,candidates:s,options:o,view:l}=this,r=new n.Z,a={...i,...o,...t};return await L({selector:e,candidates:s,currentSelection:r,options:a,view:l}),r.toArray()}};(0,s._)([(0,d.Cb)()],x.prototype,"candidates",void 0),(0,s._)([(0,d.Cb)()],x.prototype,"options",void 0),(0,s._)([(0,d.Cb)({value:null})],x.prototype,"view",void 0),x=(0,s._)([(0,p.j)("esri.widgets.support.Selector2D")],x);const F=x;let V=class extends w.Z.EventedAccessor{constructor(e){super(e),this._operationHandlesGroup=null,this.activeOperation=null,this.layers=null,this.selector=new F}destroy(){this._operationHandlesGroup=(0,l.hw)(this._operationHandlesGroup),this.selector.destroy()}get state(){return this.activeOperation?"active":this.view?.ready&&this.layers?.length?"ready":"disabled"}set view(e){this.selector.view=e,this._set("view",e)}cancel(){"active"===this.state&&(this.activeOperation.cancel(),this.activeOperation=null),this.selector.candidates=null}activate(e){const{state:t}=this;if("disabled"===t)return;"active"===t&&this.cancel(),this.selector.candidates=this._getCandidates();const i=this.selector.draw(e);return this._operationHandlesGroup=(0,o.AL)([i.once("complete",(e=>this._onOperationComplete(e))),i.on("selection-change",(e=>this._onOperationSelectionChange(e)))]),this.activeOperation=i,i}_getCandidates(){let e=[];return this.layers.forEach((t=>{e=e.concat(...t.graphics.toArray())})),e}_onOperationSelectionChange(e){this.emit("selection-change",e)}_onOperationComplete(e){this._operationHandlesGroup=(0,l.hw)(this._operationHandlesGroup),this.activeOperation=null,this.emit("complete",e)}};(0,s._)([(0,d.Cb)()],V.prototype,"activeOperation",void 0),(0,s._)([(0,d.Cb)()],V.prototype,"layers",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],V.prototype,"selector",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],V.prototype,"state",null),(0,s._)([(0,d.Cb)()],V.prototype,"view",null),V=(0,s._)([(0,p.j)("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],V);const Z=V,P={lassoTool:!0,rectangleTool:!0},B={createTool:"polygon",createOptions:{mode:"freehand"}},G={createTool:"rectangle"},R="esri-selection-toolbar",A="esri-selection-toolbar__container",H="esri-selection-toolbar__tool-button",D="esri-widget";let J=class extends g.Z{constructor(e,t){super(e,t),this._viewModelHandlesGroup=null,this.activeToolInfo=null,this.label=void 0,this.layers=[],this.messages=null,this.toolConfigs=[],this.view=null,this.viewModel=new Z,this.visibleElements={...P},this._viewModelHandlesGroup=(0,o.AL)([this.viewModel.on("selection-change",(e=>this.emit("selection-change",e))),this.viewModel.on("complete",(e=>{this._set("activeToolInfo",null),this.emit("complete",e)}))])}destroy(){this._viewModelHandlesGroup=(0,l.hw)(this._viewModelHandlesGroup)}loadDependencies(){return Promise.all([Promise.all([i.e(4788),i.e(8731)]).then(i.bind(i,46802)),i.e(8907).then(i.bind(i,78907))])}castVisibleElements(e){return{...P,...e}}activate(e){switch(this.cancel(),e){case"lasso":this._activateTool("lasso");case"rectangle":this._activateTool("rectangle");default:this._activateTool(e)}}cancel(){this.viewModel.cancel(),this._set("activeToolInfo",null)}render(){return(0,b.u)("div",{"aria-label":this.label,class:this.classes(R,D)},(0,b.u)("div",{class:A},this.renderDefaultTools(),this.renderCustomTools()))}renderDefaultTools(){if("2d"===this.view?.type)return[this.renderRectangleTool(),this.renderLassoTool()]}renderCustomTools(){if(this.toolConfigs&&this.toolConfigs.length)return this.toolConfigs.map((e=>(0,b.u)("calcite-action",{active:this.activeToolInfo?.toolName===e.toolName,bind:this,class:H,label:e.toolName,onclick:()=>this._onCustomToolClick(e.toolName),scale:"s",text:e.toolName,title:e.toolName},(0,b.u)("calcite-icon",{scale:"s",icon:e.icon||"selection"}))))}renderLassoTool(){const{activeToolInfo:e,messages:t,visibleElements:i}=this;if(i.lassoTool)return(0,b.u)("calcite-action",{active:"lasso"===e?.toolName,bind:this,label:t.selectByLasso,onclick:this._onLassoToolClick,scale:"s",text:t.selectByLasso,title:t.selectByLasso},(0,b.u)("calcite-icon",{scale:"s",icon:"lasso"}))}renderRectangleTool(){const{activeToolInfo:e,messages:t,visibleElements:i}=this;if(i.rectangleTool)return(0,b.u)("calcite-action",{active:"rectangle"===e?.toolName,bind:this,label:t.selectByRectangle,onclick:this._onRectangleToolClick,scale:"s",text:t.selectByRectangle,title:t.selectByRectangle},(0,b.u)("calcite-icon",{scale:"s",icon:"cursor-marquee"}))}_onCustomToolClick(e){this._toggleTool(e)}_onLassoToolClick(){this._toggleTool("lasso")}_onRectangleToolClick(){this._toggleTool("rectangle")}_activateTool(e){const t=this._getToolOptions(e);if(!t)return;const i=this.viewModel.activate(t);this._set("activeToolInfo",{toolName:e,operation:i})}_toggleTool(e){if(this.activeToolInfo){const t=this.activeToolInfo.toolName;if(this.cancel(),t===e)return}this._activateTool(e)}_getToolOptions(e){if("lasso"===e)return B;if("rectangle"===e)return G;const t=this.toolConfigs.find((t=>t.toolName===e));if(!t)return;const{createTool:i,createOptions:s,selectionOptions:n}=t;return{createTool:i,createOptions:s,selectionOptions:n}}};(0,s._)([(0,d.Cb)({readOnly:!0})],J.prototype,"activeToolInfo",void 0),(0,s._)([(0,d.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],J.prototype,"label",void 0),(0,s._)([(0,a.B)("viewModel.layers")],J.prototype,"layers",void 0),(0,s._)([(0,d.Cb)(),(0,m.H)("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],J.prototype,"messages",void 0),(0,s._)([(0,d.Cb)()],J.prototype,"toolConfigs",void 0),(0,s._)([(0,a.B)("viewModel.view")],J.prototype,"view",void 0),(0,s._)([(0,d.Cb)()],J.prototype,"viewModel",void 0),(0,s._)([(0,d.Cb)()],J.prototype,"visibleElements",void 0),(0,s._)([(0,c.p)("visibleElements")],J.prototype,"castVisibleElements",null),J=(0,s._)([(0,p.j)("esri.widgets.support.SelectionToolbar")],J);const j=J;var Y=i(95439),W=i(10064),z=i(22006),U=i(9309),$=i(69735);const q=e=>Q(e)||X(e),Q=e=>{if(!("type"in e))return!1;switch(e.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":return!0;default:return!1}},X=e=>{const t=(0,U.Ff)(e);if(e.hasOwnProperty(t)&&(0,l.pC)(e[t]))for(const i of e[t])if(q(i))return!0;return!1};var K,ee=i(95781);let te=K=class extends ee.Z{constructor(e){super(e),this.children=new n.Z}get enabled(){return!!(0,l.pC)(this.featureSource)&&this.featureSource.enabled}get featureSource(){const{layer:e,getFeatureSnappingSources:t}=this;return t().find((t=>t.layer===e))}_initializeChildLayers(e){const t=e.filter(q);super._initializeChildLayers(t)}_makeChildren(e){return e.map((e=>(0,U.gF)(e)?new K({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null)).reverse()}};(0,s._)([(0,d.Cb)()],te.prototype,"children",void 0),(0,s._)([(0,d.Cb)()],te.prototype,"enabled",null),(0,s._)([(0,d.Cb)({constructOnly:!0})],te.prototype,"getFeatureSnappingSources",void 0),(0,s._)([(0,d.Cb)()],te.prototype,"featureSource",null),(0,s._)([(0,d.Cb)()],te.prototype,"parent",void 0),te=K=(0,s._)([(0,p.j)("esri.widgets.support.SnappingControls.SnappingListItem")],te);let ie=class extends $.Z{constructor(){super(...arguments),this.featureSnappingSources=new n.Z}get operationalItemsFlat(){return this.operationalItems.flatten((e=>e.children))}_compileList(){const e=this.get("view.map.layers");if(!e)return;const t=e.filter(q);this._watchLayersListMode(t);const i=this._getViewableLayers(t);i&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createListItem(e){return new te({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};(0,s._)([(0,d.Cb)()],ie.prototype,"featureSnappingSources",void 0),(0,s._)([(0,d.Cb)()],ie.prototype,"operationalItems",void 0),ie=(0,s._)([(0,p.j)("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],ie);let se=class extends((0,C.p)(f.Z)){constructor(e){super(e),this.layerListViewModel=new ie,this.snappingOptions=null,this.view=null}initialize(){this.handles.add([(0,r.YP)((()=>({viewModel:this.layerListViewModel,view:this.view})),(e=>{let{viewModel:t,view:i}=e;t.view=i}),r.nn),(0,r.YP)((()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources})),(e=>{let{viewModel:t,sources:i}=e;t.featureSnappingSources=i}),r.nn)])}get state(){return this.get("snappingOptions")?"ready":"disabled"}enableSnappingForLayer(e){(this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e)).enabled=!0}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)(0,U.gF)(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find((t=>t.layer.id===e))}_makeSnappingSourceForLayer(e){const{layer:t}=this.layerListViewModel.operationalItemsFlat.find((t=>t.layer.id===e));if(!t)throw new W.Z("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);const i=new z.Z({layer:t});return this.snappingOptions.featureSources.add(i),i}};(0,s._)([(0,d.Cb)({constructOnly:!0})],se.prototype,"layerListViewModel",void 0),(0,s._)([(0,d.Cb)({constructOnly:!0})],se.prototype,"snappingOptions",void 0),(0,s._)([(0,d.Cb)()],se.prototype,"state",null),(0,s._)([(0,d.Cb)({constructOnly:!0})],se.prototype,"view",void 0),se=(0,s._)([(0,p.j)("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],se);const ne=se,oe={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},le="esri-snapping-controls",re="esri-snapping-controls__container",ae="esri-snapping-controls__panel",ce="esri-snapping-controls__toggle-block",de="esri-snapping-controls__layer-list-block",pe="esri-snapping-controls__layer-list",he="esri-snapping-controls__layer-list__filter",ue="esri-snapping-controls__layer-list__item",ye="esri-snapping-controls__layer-list__item__checkbox",ge="esri-snapping-controls__layer-list__item__label",_e="esri-snapping-controls__nested-container",ve="esri-widget";let me=class extends g.Z{constructor(e,t){super((()=>{const{view:t,viewModel:i,snappingOptions:s,...n}=e;return n})(),t),this._layerListFilter=null,this.label=void 0,this.messages=null,this.messagesCommon=null,this.snappingOptions=null,this.view=null,this.visibleElements={...oe},this._defaultViewModel=null,e?.viewModel?this.viewModel=e.viewModel:(this._defaultViewModel=new ne({snappingOptions:e.snappingOptions,view:e.view}),this.viewModel=this._defaultViewModel)}destroy(){this._defaultViewModel=(0,l.SC)(this._defaultViewModel)}loadDependencies(){return Promise.all([Promise.all([i.e(4788),i.e(8731)]).then(i.bind(i,46802)),Promise.all([i.e(8478),i.e(4788),i.e(636),i.e(5355)]).then(i.bind(i,95355)),i.e(8907).then(i.bind(i,78907)),i.e(1507).then(i.bind(i,51507)),Promise.all([i.e(8478),i.e(4788),i.e(636),i.e(6360)]).then(i.bind(i,66360)),i.e(968).then(i.bind(i,70968)),i.e(1730).then(i.bind(i,31730)),i.e(2269).then(i.bind(i,32269)),Promise.all([i.e(895),i.e(8695)]).then(i.bind(i,68695)),Promise.all([i.e(895),i.e(8140)]).then(i.bind(i,98140)),i.e(7958).then(i.bind(i,57958)),i.e(3198).then(i.bind(i,43198)),Promise.all([i.e(895),i.e(609)]).then(i.bind(i,29999))])}set viewModel(e){e!==this._get("viewModel")&&(((0,l.Wi)(this._defaultViewModel)||this._defaultViewModel!==e)&&(this._defaultViewModel=(0,l.SC)(this._defaultViewModel)),this._set("viewModel",e))}castVisibleElements(e){return{...oe,...e}}render(){const{label:e,visibleElements:{header:t}}=this;return(0,b.u)("div",{"aria-label":e,class:this.classes(le,ve)},(0,b.u)("div",{class:re},t?this.renderHeaderView():this.renderContent()))}renderHeaderView(){return(0,b.u)("calcite-panel",{heading:this.label,class:ae},this.renderContent())}renderContent(){return[this.renderToggles(),this.renderLayerList()]}renderToggles(){return(0,b.u)("calcite-block",{class:ce,heading:"",open:!0},this.renderEnabledToggle(),(0,b.u)("div",{class:_e},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))}renderEnabledToggle(){if(!this.visibleElements.enabledToggle)return;const{messages:{enableSnapping:e},viewModel:{snappingOptions:{enabled:t,enabledToggled:i}}}=this;return(0,b.u)("calcite-label",{layout:"inline-space-between"},e,(0,b.u)("calcite-switch",{checked:t,disabled:i,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}renderSelfEnabledToggle(){if(!this.visibleElements.selfEnabledToggle)return;const{messages:{geometryGuides:e},viewModel:{snappingOptions:{enabled:t,selfEnabled:i,enabledToggled:s}}}=this;return(0,b.u)("calcite-label",{layout:"inline-space-between"},e,(0,b.u)("calcite-switch",{checked:i,disabled:s||!t,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}renderFeatureEnabledToggle(){if(!this.visibleElements.featureEnabledToggle)return;const{messages:{featureToFeature:e},viewModel:{snappingOptions:{enabled:t,featureEnabled:i,enabledToggled:s}}}=this;return(0,b.u)("calcite-label",{layout:"inline-space-between"},e,(0,b.u)("calcite-switch",{checked:i,disabled:s||!t,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}renderLayerList(){if(!this.visibleElements.layerList)return;const{messages:e,messagesCommon:t}=this,i=this.viewModel.layerListViewModel.operationalItems.length>9?(0,b.u)("calcite-input",{class:he,clearable:!0,placeholder:e?.searchLayers,onCalciteInputInput:e=>{let{target:{value:t}}=e;return this._layerListFilter=""===t?null:new RegExp(t,"i")}}):null;return(0,b.u)("calcite-block",{"intl-collapse":t?.collapse,"intl-expand":t?.expand,heading:e.snappingLayers,class:de,open:!0,collapsible:!0},i,(0,b.u)("calcite-list",{class:pe},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,(0,l.Wg)(this._layerListFilter))))}renderLayerListItemCollection(e,t){return e.map((e=>{if(!t||this._itemTitleMatchesFilter(e,t))return e.children.length>0?this.renderLayerListItemGroup(e):this.renderLayerListItem(e);const i=e.children.filter((e=>this._itemTitleMatchesFilter(e,t)));return i.length>0?this.renderLayerListItemGroup(e,i):null})).toArray()}renderLayerListItem(e){const{messages:{untitledLayer:t}}=this,i=e.title||t,s=e.enabled,n=(0,b.u)("calcite-checkbox",{value:e.layer.id,checked:s,bind:this,onCalciteCheckboxChange:e=>this._handleLayerListItemChange(e.target)});return(0,b.u)("calcite-list-item",{key:`${this.id}-list-item-${e.uid}`,onclick:()=>{const e=!n.properties.checked;this._handleLayerListItemChange({checked:e,value:n.properties.value})}},(0,b.u)("calcite-label",{class:ue,slot:"content-start",tabIndex:-1,layout:"inline","disable-spacing":"true"},(0,b.u)("div",{class:ye},n),(0,b.u)("div",{class:ge},i)))}renderLayerListItemGroup(e,t){const i=e.title||this.messages.untitledLayer,s=e.title&&""!==e.title?e.title:(0,Y.D)(),n=!!t,o=t??e.children;return(0,b.u)("calcite-list-item",{key:s},(0,b.u)("calcite-accordion",{"icon-position":"start",appearance:"transparent",afterCreate:e=>{e.append(...Array.from(e.children).map((e=>(e.remove(),e))))}},(0,b.u)("calcite-accordion-item",{active:n,"item-title":i,key:e.uid},(0,b.u)("calcite-list",null,[...this.renderLayerListItemCollection(o)]))))}_enableSnappingSwitchChange(e){this.snappingOptions.enabled=e.target.checked}_featureEnabledSwitchChange(e){this.snappingOptions.featureEnabled=e.target.checked}_itemTitleMatchesFilter(e,t){return t.test(e.title)}_selfEnabledSwitchChange(e){this.snappingOptions.selfEnabled=e.target.checked}async _handleLayerListItemChange(e){e.checked?this.viewModel.enableSnappingForLayer(e.value):this.viewModel.disableSnappingForLayer(e.value)}};(0,s._)([(0,d.Cb)()],me.prototype,"_layerListFilter",void 0),(0,s._)([(0,d.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],me.prototype,"label",void 0),(0,s._)([(0,d.Cb)(),(0,m.H)("esri/widgets/support/SnappingControls/t9n/SnappingControls")],me.prototype,"messages",void 0),(0,s._)([(0,d.Cb)(),(0,m.H)("esri/t9n/common")],me.prototype,"messagesCommon",void 0),(0,s._)([(0,a.B)("viewModel.snappingOptions")],me.prototype,"snappingOptions",void 0),(0,s._)([(0,a.B)("viewModel.view")],me.prototype,"view",void 0),(0,s._)([(0,d.Cb)()],me.prototype,"viewModel",null),(0,s._)([(0,d.Cb)()],me.prototype,"visibleElements",void 0),(0,s._)([(0,c.p)("visibleElements")],me.prototype,"castVisibleElements",null),me=(0,s._)([(0,p.j)("esri.widgets.support.SnappingControls")],me);const be=me;var we=i(93531),fe=i(8704);const Ce="esri-sketch",Se="esri-sketch--vertical",Oe="esri-sketch__panel",Me="esri-sketch__info-panel",Le="esri-sketch__section",Te="esri-sketch__tool-section",Ie="esri-sketch__info-section",ke="esri-sketch__info-count-section",Ee="esri-sketch__menu-container",Ne="esri-sketch__menu-header",xe="esri-sketch__menu-title",Fe="esri-sketch__feature-count-badge",Ve="esri-sketch__feature-count-number",Ze="esri-disabled",Pe="esri-widget",Be="esri-icon-edit",Ge={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0,settingsMenu:!0,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0}};let Re=class extends g.Z{constructor(e,t){super(e,t),this._activeCreateOptions=null,this._defaultViewModel=null,this._menuOpen=!1,this._selectionToolbar=null,this._selectionHandlesGroup=null,this._snappingControls=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.createGraphic=null,this.creationMode="continuous",this.defaultCreateOptions=null,this.defaultUpdateOptions=null,this.iconClass=Be,this.label=void 0,this.labelOptions=new h.Z,this.layer=null,this.layout="horizontal",this.messages=null,this.snappingOptions=new y.Z,this.tooltipOptions=new u.Z,this.updateGraphics=new n.Z,this.view=null,this.visibleElements={...Ge},this._activateCreateTool=this._activateCreateTool.bind(this),e?.viewModel||(this._defaultViewModel=new _.Z,this.viewModel=this._defaultViewModel)}initialize(){const{layer:e,view:t}=this,i=new j({view:"2d"===t?.type?t:null,layers:e?[e]:null});this._selectionHandlesGroup=(0,o.AL)([(0,r.gx)((()=>i.activeToolInfo),(()=>this.viewModel.cancel())),i.on("complete",(e=>this._onSelectionOperationComplete(e)))]),this._selectionToolbar=i,this._setUpSnappingControls()}loadDependencies(){return Promise.all([Promise.all([i.e(4788),i.e(8731)]).then(i.bind(i,46802)),i.e(8907).then(i.bind(i,78907))])}destroy(){this._selectionToolbar.destroy(),this._cleanupViewModel(),this._selectionHandlesGroup=(0,l.hw)(this._selectionHandlesGroup),this._snappingControls=(0,l.SC)(this._snappingControls)}get activeTool(){const e=this._selectionToolbar.activeToolInfo;if(e)switch(e.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}return this.viewModel.activeTool}get state(){return this._selectionToolbar.activeToolInfo?"active":this.viewModel.state}set viewModel(e){e!==this._get("viewModel")&&(((0,l.Wi)(this._defaultViewModel)||this._defaultViewModel!==e)&&this._cleanupViewModel(),this._set("viewModel",e),e&&(this._viewModelHandlesGroup=(0,o.AL)([e.on("create",(e=>{this.scheduleRender(),this._onCreateOperation(e)})),e.on("update",(()=>this.scheduleRender())),e.on("delete",(e=>this.emit("delete",e))),e.on("undo",(()=>this.scheduleRender())),e.on("redo",(()=>this.scheduleRender())),(0,r.YP)((()=>e.layer),(e=>{this._selectionToolbar.layers=e?[e]:null})),(0,r.YP)((()=>e.view),(e=>{this._selectionToolbar.view="2d"===e?.type?e:null,this._setUpSnappingControls()})),(0,r.YP)((()=>e.state),(()=>this.notifyChange("state")))])))}castVisibleElements(e){const t={...Ge,...e,createTools:{...Ge.createTools,...e?.createTools},selectionTools:{...Ge.selectionTools,...e?.selectionTools},snappingControlsElements:{...Ge.snappingControlsElements,...e?.snappingControlsElements}};return(0,l.pC)(this._snappingControls)&&(this._snappingControls.visibleElements=t.snappingControlsElements),t}create(e,t){this._activeCreateOptions=t||null,this.viewModel.create(e,t)}update(e,t){return this.viewModel.update(e,t)}complete(){}cancel(){this._selectionToolbar.cancel(),this.viewModel.cancel()}undo(){this.viewModel.undo(),this.view?.focus()}redo(){this.viewModel.redo(),this.view?.focus()}delete(){}render(){const{label:e,layout:t,viewModel:{state:i}}=this;return(0,b.u)("div",{"aria-label":e,class:this.classes(Ce,Pe,{[Ze]:"disabled"===i,[Se]:"vertical"===t})},(0,b.u)("div",{role:"toolbar",class:Oe},this.renderTopPanelContents()),(0,b.u)("div",{class:this.classes(Oe,Me)},this.renderInfoPanelContents()))}renderTopPanelContents(){const e=this.classes(Le,Te),{availableCreateTools:t,visibleElements:i}=this;return[(0,b.u)("div",{role:"menu",key:"selection-button-container",class:e},this.renderDefaultSelectionButton(),this.renderSelectionToolbar()),t&&t.length?(0,b.u)("div",{role:"menu",class:e},this.renderDrawButtons()):null,i.undoRedoMenu?(0,b.u)("div",{role:"menu",key:"undo-redo-menu-button-container",class:e},this.renderUndoRedoMenuButtons()):null,i.settingsMenu?(0,b.u)("div",{key:"settings-menu-button-container",class:Le},this.renderSettingsMenuButton()):null]}renderInfoPanelContents(){return this._menuOpen?this.renderSettingsMenu():this.updateGraphics.length?[(0,b.u)("div",{class:this.classes(Le,Ie,ke),key:"feature-count-container"},this.renderFeatureCount()),(0,b.u)("div",{class:this.classes(Le,Ie),key:"delete-button-container"},this.renderDeleteButton())]:void 0}renderSettingsMenu(){const{settings:e}=this.messages;return[(0,b.u)("div",{role:"menu",class:Ee,key:"settings-menu-container"},(0,b.u)("header",{class:Ne,key:"settings-menu-header"},(0,b.u)("span",{class:xe},e)),this.renderSnappingControls())]}renderSnappingControls(){const{snappingControls:e}=this.visibleElements;if((0,l.pC)(this._snappingControls)&&e)return this._snappingControls.render()}renderFeatureCount(){const{layout:e,messages:t,updateGraphics:{length:i}}=this,s=(0,fe.n)(1===i?t.featureCount:t.featuresCount,{count:i});return(0,b.u)("div",{class:Fe,"aria-label":s},(0,b.u)("span",{class:Ve},"vertical"===e?i:s))}renderDeleteButton(){const e=this.messages.deleteFeature;return(0,b.u)("calcite-action",{bind:this,label:e,onclick:this.delete,scale:"s",text:e,title:e},(0,b.u)("calcite-icon",{scale:"s",icon:"trash"}))}renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return;const e=this.messages.selectFeature;return(0,b.u)("calcite-action",{active:"ready"===this.state,bind:this,label:e,onclick:this._activateDefaultSelectTool,scale:"s",text:e,title:e},(0,b.u)("calcite-icon",{scale:"s",icon:"cursor"}))}renderSelectionToolbar(){if("2d"!==this.view?.type)return;const e=this.visibleElements.selectionTools;return this._selectionToolbar.visibleElements={lassoTool:!!e["lasso-selection"],rectangleTool:!!e["rectangle-selection"]},this._selectionToolbar.render()}renderDrawButtons(){const e=this.visibleElements.createTools;return this.availableCreateTools.map((t=>"point"===t&&e.point?this.renderPointButton():"polyline"===t&&e.polyline?this.renderPolylineButton():"polygon"===t&&e.polygon?this.renderPolygonButton():"rectangle"===t&&e.rectangle?this.renderRectangleButton():"circle"===t&&e.circle?this.renderCircleButton():void 0))}renderPointButton(){const e="point",t=this.messages.drawPoint;return(0,b.u)("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},(0,b.u)("calcite-icon",{scale:"s",icon:"pin"}))}renderPolygonButton(){const e="polygon",t=this.messages.drawPolygon;return(0,b.u)("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},(0,b.u)("calcite-icon",{scale:"s",icon:"polygon"}))}renderPolylineButton(){const e="polyline",t=this.messages.drawPolyline;return(0,b.u)("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},(0,b.u)("calcite-icon",{scale:"s",icon:"line"}))}renderCircleButton(){const e="circle",t=this.messages.drawCircle;return(0,b.u)("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},(0,b.u)("calcite-icon",{scale:"s",icon:"circle"}))}renderRectangleButton(){const e="rectangle",t=this.messages.drawRectangle;return(0,b.u)("calcite-action",{active:this.activeTool===e,bind:this,label:t,onclick:()=>this._activateCreateTool(e),scale:"s",text:t,title:t},(0,b.u)("calcite-icon",{scale:"s",icon:"rectangle"}))}renderUndoRedoMenuButtons(){return[this.renderUndoButton(),this.renderRedoButton()]}renderUndoButton(){const e=this.messages.undo;return(0,b.u)("calcite-action",{disabled:!this.viewModel.canUndo(),bind:this,label:e,onclick:this.undo,scale:"s",text:e,title:e},(0,b.u)("calcite-icon",{scale:"s",icon:(0,v.dZ)(this.container)?"redo":"undo"}))}renderRedoButton(){const e=this.messages.redo;return(0,b.u)("calcite-action",{disabled:!this.viewModel.canRedo(),bind:this,label:e,onclick:this.redo,scale:"s",text:e,title:e},(0,b.u)("calcite-icon",{scale:"s",icon:(0,v.dZ)(this.container)?"undo":"redo"}))}renderSettingsMenuButton(){const e=this.messages.settings;return(0,b.u)("calcite-action",{active:this._menuOpen,bind:this,label:e,onclick:this._toggleMenu,scale:"s",text:e,title:e},(0,b.u)("calcite-icon",{scale:"s",icon:"gear"}))}_activateCreateTool(e){this.activeTool!==e?(this._selectionToolbar.cancel(),this.create(e)):this.cancel()}_onCreateOperation(e){if("complete"!==e.state)return;const{creationMode:t}=this,{type:i}=e;if("create"===i){const{tool:i,graphic:s}=e,n=this._activeCreateOptions;this._activeCreateOptions=null,"continuous"===t?this.create(i,n):"update"===t&&this.update([s])}}_toggleMenu(){this._menuOpen=!this._menuOpen,this.scheduleRender()}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:i}=e;if(!e.aborted&&i.length){const e=t.tool,s=i.length>1&&"reshape"===e?"transform":e;this.update(i,{...t,tool:s})}this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel(),this.view?.focus()}_cleanupViewModel(){this._defaultViewModel=(0,l.SC)(this._defaultViewModel),this._viewModelHandlesGroup=(0,l.hw)(this._viewModelHandlesGroup)}_setUpSnappingControls(){const{snappingOptions:e,view:t}=this;if(this._snappingControls=(0,l.SC)(this._snappingControls),!e||!t)return;const i=new be({snappingOptions:e,view:t,visibleElements:this.visibleElements.snappingControlsElements});this._snappingControls=i}};(0,s._)([(0,d.Cb)()],Re.prototype,"activeTool",null),(0,s._)([(0,d.Cb)({cast:e=>{if(!e||!e.length)return null;const t=new Set(["point","polyline","polygon","rectangle","circle"]);return e.filter((e=>t.has(e)))}})],Re.prototype,"availableCreateTools",void 0),(0,s._)([(0,a.B)("viewModel.createGraphic")],Re.prototype,"createGraphic",void 0),(0,s._)([(0,d.Cb)()],Re.prototype,"creationMode",void 0),(0,s._)([(0,a.B)("viewModel.defaultCreateOptions")],Re.prototype,"defaultCreateOptions",void 0),(0,s._)([(0,a.B)("viewModel.defaultUpdateOptions")],Re.prototype,"defaultUpdateOptions",void 0),(0,s._)([(0,d.Cb)()],Re.prototype,"iconClass",void 0),(0,s._)([(0,d.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Re.prototype,"label",void 0),(0,s._)([(0,a.B)("viewModel.labelOptions")],Re.prototype,"labelOptions",void 0),(0,s._)([(0,a.B)("viewModel.layer")],Re.prototype,"layer",void 0),(0,s._)([(0,d.Cb)({type:["horizontal","vertical"]})],Re.prototype,"layout",void 0),(0,s._)([(0,d.Cb)(),(0,m.H)("esri/widgets/Sketch/t9n/Sketch")],Re.prototype,"messages",void 0),(0,s._)([(0,a.B)("viewModel.snappingOptions")],Re.prototype,"snappingOptions",void 0),(0,s._)([(0,d.Cb)()],Re.prototype,"state",null),(0,s._)([(0,a.B)("viewModel.tooltipOptions")],Re.prototype,"tooltipOptions",void 0),(0,s._)([(0,a.B)("viewModel.updateGraphics")],Re.prototype,"updateGraphics",void 0),(0,s._)([(0,a.B)("viewModel.view")],Re.prototype,"view",void 0),(0,s._)([(0,d.Cb)(),(0,we.s)(["create","update","undo","redo"])],Re.prototype,"viewModel",null),(0,s._)([(0,d.Cb)()],Re.prototype,"visibleElements",void 0),(0,s._)([(0,c.p)("visibleElements")],Re.prototype,"castVisibleElements",null),(0,s._)([(0,a.B)("viewModel.complete")],Re.prototype,"complete",null),(0,s._)([(0,a.B)("viewModel.delete")],Re.prototype,"delete",null),Re=(0,s._)([(0,p.j)("esri.widgets.Sketch")],Re)}}]);
//# sourceMappingURL=3142.5b91a84b.chunk.js.map