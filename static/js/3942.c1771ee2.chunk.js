"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[3942],{59896:(e,t,i)=>{function n(e){return 32+e.length}function r(e){if(!e)return 0;let t=32;for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];switch(typeof r){case"string":t+=n(r);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function s(e,t){return 32+e.length*t}var a;i.d(t,{Y8:()=>a,do:()=>s,f2:()=>r}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(a||(a={}))},14916:(e,t,i)=>{function n(e,t,i,n){let r=null,s=1e3;"number"==typeof t?(s=t,n=i):(r=t??null,s=i);let a,o=0;const l=()=>{o=0,e.apply(n,a)},d=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r&&r.apply(n,t),a=t,s?o||(o=setTimeout(l,s)):l()};return d.remove=()=>{o&&(clearTimeout(o),o=0)},d.forceUpdate=()=>{o&&(clearTimeout(o),l())},d.hasPendingUpdates=()=>!!o,d}i.d(t,{P:()=>n})},5163:(e,t,i)=>{i.d(t,{L4:()=>A,LO:()=>p,Rd:()=>h,Ud:()=>g,VG:()=>u,Wv:()=>m,Zv:()=>_,_o:()=>M,aC:()=>v,h9:()=>b,ld:()=>w,mg:()=>f,q6:()=>y,sS:()=>x,yc:()=>I});var n=i(59896),r=i(17768),s=i(16889),a=i(92026),o=i(643),l=i(68860),d=i(6291);function c(e,t,i){return e.units[t][i]}function u(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return`${(0,d.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n})} ${c(e,i,r)}`}function p(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return`${(0,d.uf)(t,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${c(e,i,r)}`}function h(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.KU)(t,i);return u(e,(0,l.En)(t,i,s),s,n,r)}function f(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.KU)(t,i);return p(e,(0,l.En)(t,i,s),s,n,r)}function m(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.OG)(t,i);return u(e,(0,l.En)(t,i,s),s,n,r)}function b(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.OG)(t,i);return p(e,(0,l.En)(t,i,s),s,n,r)}function g(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.FN)(t,i);return u(e,(0,l.En)(t,i,s),s,n,r)}function y(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.FN)(t,i);return p(e,(0,l.En)(t,i,s),s,n,r)}function _(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.qv)(t,i);return u(e,(0,l.En)(t,i,s),s,n,r)}function v(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.qv)(t,i);return p(e,(0,l.En)(t,i,s),s,n,r)}function w(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.tQ)(t,i);return u(e,(0,l.En)(t,i,s),s,n,r)}function I(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";const s=(0,l.Yl)(t,i);return u(e,(0,l.En)(t,i,s),s,n,r)}function A(e,t,i,n,s){const o=r.BV.normalize(function(e,t,i){if(t===i)return e;switch(i){case"arithmetic":return function(e){return 90-e}(e);case"geographic":return function(e){return-e-90}(e)}}((0,l.En)(e,t,"degrees"),i,n),0,!0);return s=(0,a.Pt)(s,2),(0,d.uf)(o,{style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:s,minimumFractionDigits:s})}function M(e,t,i,n,r){i!==n&&(e=-e);const s=(0,l.En)(e,t,"degrees")%360;return r=(0,a.Pt)(r,2),(0,d.uf)(s,{style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,signDisplay:"exceptZero"})}const C=["B","kB","MB","GB","TB"];function x(e,t){let i=0===t?0:Math.floor(Math.log(t)/Math.log(n.Y8.KILOBYTES));i=(0,s.uZ)(i,0,C.length-1);const r=(0,d.uf)(t/n.Y8.KILOBYTES**i,{maximumFractionDigits:2});return(0,o.gx)(e.units.bytes[C[i]],{fileSize:r})}},4075:(e,t,i)=>{i.d(t,{D2:()=>l,NM:()=>c,WU:()=>p,f1:()=>d});i(59166);var n=i(6291);const r=/^-?(\d+)(\.(\d+))?$/i;function s(e,t){return e-t}function a(e,t){let i,n;return i=Number(e.toFixed(t)),i<e?n=i+1/10**t:(n=i,i-=1/10**t),i=Number(i.toFixed(t)),n=Number(n.toFixed(t)),[i,n]}function o(e,t,i,n,r){const s=d(e,t,i,n),a=null==s.previous||s.previous<=r,o=null==s.next||s.next<=r;return a&&o||s.previous+s.next<=2*r}function l(e){const t=String(e),i=t.match(r);if(i&&i[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(t.toLowerCase().includes("e")){const e=t.split("e"),i=e[0],n=e[1];if(i&&n){const e=Number(i);let t=Number(n);const r=t>0;r||(t=Math.abs(t));const s=l(e);return r?(s.integer+=t,t>s.fractional?s.fractional=0:s.fractional-=t):(s.fractional+=t,t>s.integer?s.integer=1:s.integer-=t),s}}return{integer:0,fractional:0}}function d(e,t,i,n){const r={previous:null,next:null};if(null!=i){const n=e-i,s=t-i-n;r.previous=Math.floor(Math.abs(100*s/n))}if(null!=n){const i=n-e,s=n-t-i;r.next=Math.floor(Math.abs(100*s/i))}return r}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=e.slice(0),{tolerance:n=2,strictBounds:r=!1,indexes:d=i.map(((e,t)=>t))}=t;d.sort(s);for(let s=0;s<d.length;s++){const e=d[s],t=i[e],c=0===e?null:i[e-1],u=e===i.length-1?null:i[e+1],p=l(t).fractional;if(p){let l,d=0,h=!1;for(;d<=p&&!h;){const e=a(t,d);l=r&&0===s?e[1]:e[0],h=o(t,l,c,u,n),d++}h&&(i[e]=l)}}return i}const u={maximumFractionDigits:20};function p(e){return(0,n.uf)(e,u)}},99388:(e,t,i)=>{i.d(t,{zB:()=>u});var n=i(63780),r=i(32718),s=i(77427),a=i(76969),o=(i(4075),i(57203),i(74579)),l=i(226),d=i(40778);r.Z.getLogger("esri.renderers.support.utils"),(0,a.Ze)("short-date");function c(e,t,i){(0,s.s1)(e,t,(()=>[])).push(...i)}async function u(e){const t=new Map;if("visualVariables"in e&&e.visualVariables){const i=e.visualVariables.filter((e=>"color"===e.type));for(const e of i){const i=e.field||e.valueExpression,n=(await(0,l.pO)(e)).map((e=>e.color));c(t,i,n)}}if("heatmap"===e.type){const i=(0,d.h)(e).map((e=>e.color));c(t,e.field,i)}else if("pie-chart"===e.type){for(const i of e.attributes)c(t,i.field,[i.color]);c(t,null,[e?.othersCategory?.color,(0,o._h)(e.backgroundFillSymbol,null)])}else if("dot-density"===e.type){for(const i of e.attributes)c(t,i.field,[i.color]);c(t,null,[e.backgroundColor])}else if("unique-value"===e.type)if("predominance"===e.authoringInfo?.type)for(const i of e.uniqueValueInfos)c(t,i.value.toString(),[(0,o._h)(i.symbol,null)]);else{const i=e.uniqueValueInfos.map((e=>(0,o._h)(e.symbol,null))),{field:n,field2:r,field3:s,valueExpression:a}=e;(n||a)&&c(t,n||a,i),r&&c(t,r,i),s&&c(t,s,i)}else if("class-breaks"===e.type){const i=e.classBreakInfos.map((e=>(0,o._h)(e.symbol,null)));c(t,e.field||e.valueExpression,i)}else"simple"===e.type&&c(t,null,[(0,o._h)(e.symbol,null)]);return"defaultSymbol"in e&&e.defaultSymbol&&c(t,null,[(0,o._h)(e.defaultSymbol,null)]),t.forEach(((e,i)=>{const r=(0,n.Tw)(e.filter(Boolean),((e,t)=>JSON.stringify(e)===JSON.stringify(t)));t.set(i,r)})),t}},77946:(e,t,i)=>{i.d(t,{F:()=>l,e:()=>o});var n=i(23084),r=i(5192),s=i(49818),a=i(21149);async function o(e,t,i){const n=await l(e,t,i);return s.default.fromJSON(n)}async function l(e,t,i){const s=(0,n.en)(e),o={...i},l=a.Z.from(t),{data:d}=await(0,r.executeQuery)(s,l,l.sourceSpatialReference,o);return d}},11812:(e,t,i)=>{i.d(t,{Z:()=>p});var n,r=i(27366),s=i(46784),a=i(49861),o=(i(63780),i(93169),i(25243)),l=i(69912);function d(e){const{exifInfo:t,exifName:i,tagName:n}=e;if(!t||!i||!n)return null;const r=t.find((e=>e.name===i));return r?function(e){const{tagName:t,tags:i}=e;if(!i||!t)return null;const n=i.find((e=>e.name===t));return n&&n.value||null}({tagName:n,tags:r.tags}):null}const c={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let u=n=class extends s.wq{constructor(e){super(e),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:e}=this,t=d({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:e});return c[t]||null}clone(){return new n({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};(0,r._)([(0,a.Cb)({type:String})],u.prototype,"contentType",void 0),(0,r._)([(0,a.Cb)()],u.prototype,"exifInfo",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],u.prototype,"orientationInfo",null),(0,r._)([(0,a.Cb)({type:o.z8})],u.prototype,"id",void 0),(0,r._)([(0,a.Cb)({type:String})],u.prototype,"globalId",void 0),(0,r._)([(0,a.Cb)({type:String})],u.prototype,"keywords",void 0),(0,r._)([(0,a.Cb)({type:String})],u.prototype,"name",void 0),(0,r._)([(0,a.Cb)({json:{read:!1}})],u.prototype,"parentGlobalId",void 0),(0,r._)([(0,a.Cb)({json:{read:!1}})],u.prototype,"parentObjectId",void 0),(0,r._)([(0,a.Cb)({type:o.z8})],u.prototype,"size",void 0),(0,r._)([(0,a.Cb)({json:{read:!1}})],u.prototype,"url",void 0),u=n=(0,r._)([(0,l.j)("esri.layers.support.AttachmentInfo")],u);const p=u},37384:(e,t,i)=>{i.d(t,{$o:()=>r,V$:()=>a});const n="calcite-theme-";function r(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"").startsWith("dark")}function s(){return`${n}${r()?"dark":"light"}`}function a(e){o(e),e.classList.add(s())}function o(e){Array.from(e.classList).forEach((t=>{t.startsWith(n)&&e.classList.remove(t)}))}},4819:(e,t,i)=>{i.d(t,{Z:()=>_});var n=i(27366),r=i(52639),s=i(85015),a=i(40281),o=i(10064),l=i(92026),d=i(94172),c=i(49861),u=(i(63780),i(93169),i(89125)),p=i(69912),h=i(11812),f=i(99837),m=i(45276);const b={editing:!1,operations:{add:!0,update:!0,delete:!0}},g=a.Z.ofType(h.Z);let y=class extends s.Z{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...b},this.activeAttachmentInfo=null,this.attachmentInfos=new g,this.graphic=null,this.mode="view",this.own((0,d.YP)((()=>this.graphic),(()=>this._graphicChanged()),d.nn))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...b,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||"function"!=typeof e.queryAttachments)throw new o.Z("invalid-layer","getAttachments(): A valid layer is required.");const i=this._getFeatureId(),n=new f.Z({objectIds:[i],returnMetadata:!0}),r=[],s=e.queryAttachments(n).then((e=>e[i]||r)).catch((()=>r));this._getAttachmentsPromise=s,this.notifyChange("state");const a=await s;return t.removeAll(),a.length&&t.addMany(a),this._getAttachmentsPromise=null,this.notifyChange("state"),a}async addAttachment(e){const{_attachmentLayer:t,attachmentInfos:i,graphic:n,abilities:r}=this;if(!e)throw new o.Z("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!r.operations.add)throw new o.Z("invalid-abilities","addAttachment(): add abilities are required.");if(!t||"function"!=typeof t.addAttachment)throw new o.Z("invalid-layer","addAttachment(): A valid layer is required.");const s=t.addAttachment(n,e).then((e=>this._queryAttachment(e.objectId))),a=await s;return i.add(a),a}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:i,graphic:n,abilities:r}=this;if(!e)throw new o.Z("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!r.operations.delete)throw new o.Z("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||"function"!=typeof t.deleteAttachments)throw new o.Z("invalid-layer","deleteAttachment(): A valid layer is required.");const s=t.deleteAttachments(n,[e.id]).then((()=>e)),a=await s;return i.remove(a),a}async updateAttachment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeAttachmentInfo;const{_attachmentLayer:i,attachmentInfos:n,graphic:r,abilities:s}=this;if(!e)throw new o.Z("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new o.Z("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!s.operations.update)throw new o.Z("invalid-abilities","updateAttachment(): Update abilities are required.");const a=n.findIndex((e=>e===t));if(!i||"function"!=typeof i.updateAttachment)throw new o.Z("invalid-layer","updateAttachment(): A valid layer is required.");const l=i.updateAttachment(r,t.id,e).then((e=>this._queryAttachment(e.objectId))),d=await l;return n.splice(a,1,d),d}async _queryAttachment(e){if(!e)throw new o.Z("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:t}=this,i=this._getFeatureId(),n=new f.Z({objectIds:[i],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return t.queryAttachments(n).then((e=>e[i][0]))}_getFeatureId(){const{_attachmentLayer:e,graphic:t}=this;if(!e||!t)return null;const{objectIdField:i}=e,{attributes:n}=t;return n&&n[i]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})))}_setAttachmentLayer(){const{graphic:e}=this,t=(0,m.l$)(e);this._attachmentLayer=t?"scene"===t.type&&(0,l.pC)(t.associatedLayer)?t.associatedLayer:t:null}};(0,n._)([(0,c.Cb)()],y.prototype,"abilities",void 0),(0,n._)([(0,u.p)("abilities")],y.prototype,"castAbilities",null),(0,n._)([(0,c.Cb)()],y.prototype,"activeAttachmentInfo",void 0),(0,n._)([(0,c.Cb)({readOnly:!0,type:g})],y.prototype,"attachmentInfos",void 0),(0,n._)([(0,c.Cb)({type:r.Z})],y.prototype,"graphic",void 0),(0,n._)([(0,c.Cb)()],y.prototype,"mode",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],y.prototype,"state",null),(0,n._)([(0,c.Cb)({readOnly:!0})],y.prototype,"supportsResizeAttachments",null),y=(0,n._)([(0,p.j)("esri.widgets.Attachments.AttachmentsViewModel")],y);const _=y},83942:(e,t,i)=>{i.d(t,{Z:()=>Gt});var n=i(27366),r=(i(59166),i(94172)),s=i(8025),a=(i(63780),i(93169),i(89125)),o=i(49861),l=i(69912),d=i(69407),c=(i(25243),i(10064)),u=i(5163),p=i(4819),h=i(65905);var f=i(80975),m=i(80532),b=i(67005);const g={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},y="esri-attachments",_="esri-attachments__loader-container",v="esri-attachments__loader",w="esri-attachments__container",I="esri-attachments__container--list",A="esri-attachments__container--preview",M="esri-attachments__actions",C="esri-attachments__delete-button",x="esri-attachments__add-attachment-button",F="esri-attachments__error-message",E="esri-attachments__items",T="esri-attachments__item",k="esri-attachments__item-button",L="esri-attachments__item-mask",R="esri-attachments__item-mask--icon",$="esri-attachments__image",Z="esri-attachments__image--resizable",N="esri-attachments__label",S="esri-attachments__filename",V="esri-attachments__item-chevron-icon",P="esri-attachments__item-link",B="esri-attachments__item-link-overlay",O="esri-attachments__item-link-overlay-icon",q="esri-attachments__item-add-icon",U="esri-attachments__form-node",D="esri-attachments__file-fieldset",j="esri-attachments__file-label",z="esri-attachments__file-name",W="esri-attachments__file-input",Y="esri-attachments__metadata",Q="esri-attachments__metadata-fieldset",H="esri-attachments__progress-bar",G="esri-widget",K="esri-button",X="esri-button--disabled",J="esri-button--secondary",ee="esri-button--tertiary",te="esri-button--third",ie="esri-button--small",ne="esri-button--half",re="esri-widget__content--empty",se="esri-icon-right",ae="esri-icon-left",oe="esri-icon-plus",le=window.CSS;let de=class extends d.Z{constructor(e,t){super(e,t),this.abilities=null,this.displayType="auto",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new p.Z,this.visibleElements={...g},this._supportsImageOrientation=le&&le.supports&&le.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.own([(0,r.on)((()=>this.viewModel?.attachmentInfos),"change",(()=>this.scheduleRender())),(0,r.YP)((()=>this.viewModel?.mode),(()=>this._modeChanged()),r.nn)])}get effectiveDisplayType(){const{displayType:e}=this;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}castVisibleElements(e){return{...g,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new c.Z("attachments:add-attachment",this.messages.addErrorMessage,e)),e}))}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new c.Z("attachments:delete-attachment",this.messages.deleteErrorMessage,e)),e}))}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((e=>{throw this._set("submitting",!1),this._set("error",new c.Z("attachments:update-attachment",this.messages.updateErrorMessage,e)),e}))}render(){const{submitting:e,viewModel:t}=this,{state:i}=t;return(0,b.u)("div",{class:this.classes(y,G)},e?this.renderProgressBar():null,"loading"===i?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?(0,b.u)("div",{key:"error-message",class:F},e.message):null}renderAttachments(){const{mode:e,activeAttachmentInfo:t}=this.viewModel;return"add"===e?this.renderAddForm():"edit"===e?this.renderDetailsForm(t):this.renderAttachmentContainer()}renderLoading(){return(0,b.u)("div",{class:_,key:"loader"},(0,b.u)("div",{class:v}))}renderProgressBar(){return this.visibleElements.progressBar?(0,b.u)("div",{class:H,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,i=e||!t,n=this.visibleElements.cancelAddButton?(0,b.u)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(K,ee,ie,ne,e&&X)},this.messages.cancel):null,r=this.visibleElements.addSubmitButton?(0,b.u)("button",{type:"submit",disabled:i,class:this.classes(K,J,ie,ne,{[X]:i})},this.messages.add):null,s=t?(0,b.u)("span",{key:"file-name",class:z},t.name):null,a=(0,b.u)("form",{bind:this,afterCreate:f.Yo,afterRemoved:f.pV,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},(0,b.u)("fieldset",{class:D},s,(0,b.u)("label",{class:this.classes(j,K,J)},t?this.messages.changeFile:this.messages.selectFile,(0,b.u)("input",{class:W,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),r,n);return(0,b.u)("div",{key:"add-form-container",class:U},a)}renderDetailsForm(e){const{visibleElements:t,viewModel:i,selectedFile:n,submitting:r}=this,{contentType:s,size:a,url:o}=e,{abilities:l}=i,d=r||!n,c=l.editing&&l.operations.delete&&t.deleteButton?(0,b.u)("button",{key:"delete-button",type:"button",disabled:r,bind:this,onclick:t=>this._submitDeleteAttachment(t,e),class:this.classes(K,ie,ee,C,{[X]:r})},this.messages.delete):null,p=l.editing&&l.operations.update&&t.updateButton?(0,b.u)("button",{disabled:d,key:"update-button",type:"submit",class:this.classes(K,ie,te,{[X]:d})},this.messages.update):null,h=this.visibleElements.cancelUpdateButton?(0,b.u)("button",{disabled:r,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(K,ie,ee,te,{[X]:r})},this.messages.cancel):null,m=n?(0,b.u)("span",{key:"file-name",class:z},n.name):null,g=l.editing&&l.operations.update?(0,b.u)("fieldset",{key:"file",class:D},m,(0,b.u)("label",{class:this.classes(j,K,J)},this.messages.changeFile,(0,b.u)("input",{class:W,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=(0,b.u)("fieldset",{key:"size",class:Q},(0,b.u)("label",null,(0,u.sS)(this.messagesUnits,a))),_=(0,b.u)("fieldset",{key:"content-type",class:Q},(0,b.u)("label",null,s)),v=(0,b.u)("form",{bind:this,afterCreate:f.Yo,afterRemoved:f.pV,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},(0,b.u)("div",{class:Y},y,_),g,(0,b.u)("div",{class:M},c,h,p));return(0,b.u)("div",{key:"edit-form-container",class:U},(0,b.u)("a",{class:P,href:o,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:e,size:400}),(0,b.u)("div",{class:B},(0,b.u)("span",{class:O},(0,b.u)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},(0,b.u)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),(0,b.u)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),v)}renderImageMask(e){let{attachmentInfo:t,size:i}=e;const{supportsResizeAttachments:n}=this.viewModel,{contentType:r,name:s,url:a}=t,o=n&&function(e){const t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(r),l=this._getCSSTransform(t,o),d=l?{transform:l,"image-orientation":"none"}:{},c=a.includes("?")?"&":"?",u=o?`${a}${c}w=${i}`:function(e){const t=(0,h.V)("esri/themes/base/images/files/");return e?"text/plain"===e?`${t}text-32.svg`:"application/pdf"===e?`${t}pdf-32.svg`:"text/csv"===e?`${t}csv-32.svg`:"application/gpx+xml"===e?`${t}gpx-32.svg`:"application/x-dwf"===e?`${t}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${t}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${t}zip-32.svg`:e.includes("image/")?`${t}image-32.svg`:e.includes("audio/")?`${t}sound-32.svg`:e.includes("video/")?`${t}video-32.svg`:e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?`${t}excel-32.svg`:e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?`${t}word-32.svg`:e.includes("powerpoint")||e.includes("presentationml")?`${t}report-32.svg`:`${t}generic-32.svg`:`${t}generic-32.svg`}(r),p={[R]:!o},f={[Z]:n};return(0,b.u)("div",{class:this.classes(p,L)},(0,b.u)("img",{styles:d,alt:s,src:u,class:this.classes(f,$)}))}renderAttachmentInfo(e){let{attachmentInfo:t,displayType:i}=e;const{viewModel:n}=this,{abilities:r}=n,{name:s,url:a}=t,o=this.renderImageMask({attachmentInfo:t,size:"list"===i?48:400}),l=r.editing?(0,b.u)("span",{"aria-hidden":"true",class:this.classes(V,(0,f.dZ)(this.container)?ae:se)}):null,d=[o,(0,b.u)("label",{class:N},(0,b.u)("span",{class:S},s||this.messages.noTitle),l)],c=r.editing?(0,b.u)("button",{key:"details-button",bind:this,class:k,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},d):(0,b.u)("a",{key:"details-link",class:k,href:a,target:"_blank"},d);return(0,b.u)("li",{class:T,key:t},c)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:i}=this,{attachmentInfos:n,abilities:r}=t,s=n&&n.length,a={[I]:"preview"!==e,[A]:"preview"===e},o=r.editing&&r.operations.add&&i.addButton?(0,b.u)("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(K,ee,x),type:"button"},(0,b.u)("span",{"aria-hidden":"true",class:this.classes(q,oe)}),this.messages.add):null,l=s?(0,b.u)("ul",{class:E},n.toArray().map((t=>this.renderAttachmentInfo({attachmentInfo:t,displayType:e})))):(0,b.u)("div",{class:re},this.messages.noAttachments);return(0,b.u)("div",{key:"attachments-container",class:this.classes(w,a)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,i=t&&t.files&&t.files.item(0);this._set("selectedFile",i)}_submitDeleteAttachment(e,t){e.preventDefault(),this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.addAttachment()}_submitUpdateAttachment(e){e.preventDefault(),this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeAttachmentInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e,t){const{orientationInfo:i}=e;return!this._supportsImageOrientation&&t&&i?[i.rotation?`rotate(${i.rotation}deg)`:"",i.mirrored?"scaleX(-1)":""].join(" "):""}};(0,n._)([(0,s.B)("viewModel.abilities")],de.prototype,"abilities",void 0),(0,n._)([(0,o.Cb)()],de.prototype,"displayType",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],de.prototype,"effectiveDisplayType",null),(0,n._)([(0,s.B)("viewModel.graphic")],de.prototype,"graphic",void 0),(0,n._)([(0,o.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],de.prototype,"label",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/widgets/Attachments/t9n/Attachments")],de.prototype,"messages",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/core/t9n/Units")],de.prototype,"messagesUnits",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],de.prototype,"selectedFile",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],de.prototype,"submitting",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],de.prototype,"error",void 0),(0,n._)([(0,o.Cb)({type:p.Z})],de.prototype,"viewModel",void 0),(0,n._)([(0,o.Cb)()],de.prototype,"visibleElements",void 0),(0,n._)([(0,a.p)("visibleElements")],de.prototype,"castVisibleElements",null),de=(0,n._)([(0,l.j)("esri.widgets.Attachments")],de);const ce=de;var ue=i(83244),pe=i(96919);const he="esri-feature-element-info",fe="esri-feature-element-info__title",me="esri-feature-element-info__description";let be=class extends d.Z{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return(0,b.u)("div",{class:he},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?(0,b.u)(pe.X6,{level:this.headingLevel,class:fe},e):null}renderDescription(){const{description:e}=this;return e?(0,b.u)("div",{key:"description",class:me},e):null}};(0,n._)([(0,o.Cb)()],be.prototype,"description",void 0),(0,n._)([(0,o.Cb)()],be.prototype,"headingLevel",void 0),(0,n._)([(0,o.Cb)()],be.prototype,"title",void 0),be=(0,n._)([(0,l.j)("esri.widgets.Feature.support.FeatureElementInfo")],be);const ge=be,ye="esri-feature-attachments";let _e=class extends d.Z{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new ce,this.description=null,this.displayType=null,this.graphic=null,this.headingLevel=2,this.title=null,this.viewModel=new ue.Z}initialize(){this._featureElementInfo=new ge,this.own([(0,r.YP)((()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),r.nn),(0,r.YP)((()=>this.viewModel?.graphic),(e=>this.attachmentsWidget.graphic=e),r.nn)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}render(){const{attachmentsWidget:e}=this;return(0,b.u)("div",{class:ye},this._featureElementInfo?.render(),e?.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:i}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:i})}};(0,n._)([(0,o.Cb)({readOnly:!0})],_e.prototype,"attachmentsWidget",void 0),(0,n._)([(0,s.B)("viewModel.description")],_e.prototype,"description",void 0),(0,n._)([(0,s.B)("attachmentsWidget.displayType")],_e.prototype,"displayType",void 0),(0,n._)([(0,s.B)("viewModel.graphic")],_e.prototype,"graphic",void 0),(0,n._)([(0,o.Cb)()],_e.prototype,"headingLevel",void 0),(0,n._)([(0,s.B)("viewModel.title")],_e.prototype,"title",void 0),(0,n._)([(0,o.Cb)({type:ue.Z})],_e.prototype,"viewModel",void 0),_e=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureAttachments")],_e);const ve=_e;var we=i(50267),Ie=i(45276),Ae=i(53963);const Me="esri-feature-content",Ce="esri-feature-content__loader-container",xe="esri-feature-content__loader";let Fe=class extends d.Z{constructor(e,t){super(e,t),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{(0,Ie.or)(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}renderLoading(){return(0,b.u)("div",{class:Ce,key:"loader"},(0,b.u)("div",{class:xe}))}renderCreated(){const e=this.viewModel?.created;return e?e instanceof HTMLElement?(0,b.u)("div",{key:e,bind:e,afterCreate:this._attachToNode}):(0,Ae.Qd)(e)?(0,b.u)("div",{key:e},!e.destroyed&&e.render()):(0,b.u)("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){const e=this.viewModel?.state;return(0,b.u)("div",{class:Me},"loading"===e?this.renderLoading():this.renderCreated())}_attachToNode(e){e.appendChild(this)}};(0,n._)([(0,s.B)("viewModel.creator")],Fe.prototype,"creator",void 0),(0,n._)([(0,s.B)("viewModel.graphic")],Fe.prototype,"graphic",void 0),(0,n._)([(0,o.Cb)({type:we.Z})],Fe.prototype,"viewModel",void 0),Fe=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureContent")],Fe);const Ee=Fe;var Te=i(86836),ke=i(643);const Le=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function Re(e){let t=null;return Le.some((i=>(i.pattern.test(e)&&(t=i),!!t))),t}function $e(e,t){if("string"!=typeof t||!t)return t;const i=Re(t);if(!i)return t;const n=t.match(i.pattern),r=n&&n[2],s=(0,ke.gx)((0,ke.gx)(i.label,{messages:e,hierPart:r}),{appName:i.appName}),a=i.target?` target="${i.target}"`:"",o="_blank"===i.target?' rel="noreferrer"':"";return t.replace(i.pattern,`<a${a} href="$1"${o}>${s}</a>`)}const Ze="esri-feature-fields",Ne="esri-feature-fields__field-header",Se="esri-feature-fields__field-data",Ve="esri-feature-fields__field-data--date",Pe="esri-widget__table";let Be=class extends d.Z{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new Te.Z,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new ge,this.own((0,r.YP)((()=>[this.viewModel?.description,this.viewModel?.title]),(()=>this._setupFeatureElementInfo()),r.nn))}destroy(){this._featureElementInfo.destroy()}renderFieldInfo(e,t){const{attributes:i}=this.viewModel,n=e.fieldName,r=e.label||n,s=i?null==i[n]?"":i[n]:"",a=!(!e.format||!e.format.dateFormat),o="number"!=typeof s||a?$e(this.messagesURIUtils,s):this._forceLTR(s),l={[Ve]:a};return(0,b.u)("tr",{key:`fields-element-info-row-${n}-${t}`},(0,b.u)("th",{key:`fields-element-info-row-header-${n}-${t}`,class:Ne,innerHTML:r}),(0,b.u)("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes(Se,l),innerHTML:o}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e?.length?(0,b.u)("table",{class:Pe,summary:this.messages.fieldsSummary},(0,b.u)("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){return(0,b.u)("div",{class:Ze},this._featureElementInfo?.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};(0,n._)([(0,s.B)("viewModel.attributes")],Be.prototype,"attributes",void 0),(0,n._)([(0,s.B)("viewModel.description")],Be.prototype,"description",void 0),(0,n._)([(0,s.B)("viewModel.expressionInfos")],Be.prototype,"expressionInfos",void 0),(0,n._)([(0,s.B)("viewModel.fieldInfos")],Be.prototype,"fieldInfos",void 0),(0,n._)([(0,s.B)("viewModel.title")],Be.prototype,"title",void 0),(0,n._)([(0,o.Cb)({type:Te.Z})],Be.prototype,"viewModel",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/widgets/Feature/t9n/Feature")],Be.prototype,"messages",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/widgets/support/t9n/uriUtils")],Be.prototype,"messagesURIUtils",void 0),Be=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureFields")],Be);const Oe=Be;var qe=i(98928),Ue=i(99388),De=i(21516),je=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],ze=[].concat(je.slice(30,39),je.slice(28,30).reverse()),We=[{name:"default",colors:ze},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],Ye=i(36257);const Qe="en-us",He=new Map([["ar",()=>i.e(9440).then(i.bind(i,39440)).then((e=>e.a))],["bg-bg",()=>i.e(6647).then(i.bind(i,46647)).then((e=>e.b))],["bs-ba",()=>i.e(5546).then(i.bind(i,45546)).then((e=>e.b))],["ca-es",()=>i.e(7143).then(i.bind(i,27143)).then((e=>e.c))],["cs-cz",()=>i.e(4745).then(i.bind(i,23863)).then((e=>e.c))],["da-dk",()=>i.e(7960).then(i.bind(i,62668)).then((e=>e.d))],["de-de",()=>i.e(591).then(i.bind(i,60591)).then((e=>e.d))],["de-ch",()=>i.e(7393).then(i.bind(i,77393)).then((e=>e.d))],["el-gr",()=>i.e(4052).then(i.bind(i,54052)).then((e=>e.e))],["en-us",()=>i.e(1304).then(i.bind(i,1304)).then((e=>e.e))],["en-ca",()=>i.e(2922).then(i.bind(i,92922)).then((e=>e.e))],["es-es",()=>i.e(4720).then(i.bind(i,64720)).then((e=>e.e))],["et-ee",()=>i.e(5773).then(i.bind(i,35773)).then((e=>e.e))],["fi-fi",()=>i.e(9356).then(i.bind(i,90098)).then((e=>e.f))],["fr-fr",()=>i.e(6682).then(i.bind(i,46682)).then((e=>e.f))],["he-il",()=>i.e(8257).then(i.bind(i,48257)).then((e=>e.h))],["hr-hr",()=>i.e(2627).then(i.bind(i,32627)).then((e=>e.h))],["hu-hu",()=>i.e(4888).then(i.bind(i,84888)).then((e=>e.h))],["id-id",()=>i.e(8578).then(i.bind(i,48578)).then((e=>e.i))],["it-it",()=>i.e(3907).then(i.bind(i,53907)).then((e=>e.i))],["ja-jp",()=>i.e(5649).then(i.bind(i,5649)).then((e=>e.j))],["ko-kr",()=>i.e(3625).then(i.bind(i,13625)).then((e=>e.k))],["lt-lt",()=>i.e(3318).then(i.bind(i,33318)).then((e=>e.l))],["lv-lv",()=>i.e(5429).then(i.bind(i,45429)).then((e=>e.l))],["nb-no",()=>i.e(4422).then(i.bind(i,54422)).then((e=>e.n))],["nl-nl",()=>i.e(3834).then(i.bind(i,93834)).then((e=>e.n))],["pl-pl",()=>i.e(2141).then(i.bind(i,92141)).then((e=>e.p))],["pt-br",()=>i.e(5496).then(i.bind(i,98915)).then((e=>e.p))],["pt-pt",()=>i.e(9056).then(i.bind(i,77643)).then((e=>e.p))],["ro-ro",()=>i.e(620).then(i.bind(i,620)).then((e=>e.r))],["ru-ru",()=>i.e(428).then(i.bind(i,50428)).then((e=>e.r))],["sk-sk",()=>i.e(4699).then(i.bind(i,64699)).then((e=>e.s))],["sl-sl",()=>i.e(1416).then(i.bind(i,91416)).then((e=>e.s))],["sr-rs",()=>i.e(4078).then(i.bind(i,24078)).then((e=>e.s))],["sv-se",()=>i.e(7930).then(i.bind(i,97930)).then((e=>e.s))],["th-th",()=>i.e(213).then(i.bind(i,90213)).then((e=>e.t))],["tr-tr",()=>i.e(6979).then(i.bind(i,26979)).then((e=>e.t))],["uk-ua",()=>i.e(6602).then(i.bind(i,66602)).then((e=>e.u))],["vi-vn",()=>i.e(1870).then(i.bind(i,41870)).then((e=>e.v))],["zh-cn",()=>i.e(7645).then(i.bind(i,50323)).then((e=>e.z))],["zh-hk",()=>i.e(9105).then(i.bind(i,9105)).then((e=>e.z))],["zh-tw",()=>i.e(9105).then(i.bind(i,9105)).then((e=>e.z))]]);function Ge(e){return e?He.has(e.toLowerCase())?e.toLowerCase():function(e){const t=e.split("-")[0].toLowerCase();let i=null;for(const n of He.keys())if(n.startsWith(t)){i=n;break}return i}(e)||Qe:Qe}let Ke,Xe;async function Je(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,Ye.Kd)();if(e=Ge(e),Ke&&e===Xe)return Ke;Ke=i.e(3457).then(i.bind(i,43457)).then((e=>e.i)),Xe=e;try{const[t,i]=await Promise.all([Ke,He.get(Xe)()]);Xe===e&&(t.am4core.options.defaultLocale=i.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0}catch{return Ke=null,Xe=null,null}return Ke}function et(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";const i=We.find((e=>e.name===t));return i?i.colors.map((t=>e.color(t))):null}var tt=i(37384);const it="esri-feature-media",nt="esri-feature-media__container",rt="esri-feature-media__item-container",st="esri-feature-media__item",at="esri-feature-media__item-title",ot="esri-feature-media__item-caption",lt="esri-feature-media__previous",dt="esri-feature-media__previous-icon",ct="esri-feature-media__previous-icon--rtl",ut="esri-feature-media__next",pt="esri-feature-media__next-icon",ht="esri-feature-media__next-icon--rtl",ft="esri-feature-media__chart",mt="esri-feature-media__button",bt="esri-feature-media__icon",gt="esri-icon-left-triangle-arrow",yt="esri-icon-right-triangle-arrow",_t=.05,vt=.95,wt="color",It="tooltip",At="value",Mt="default-line-value";let Ct=class extends d.Z{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new De.Z,this.messages=null,this._getChartDependencies=async e=>{const t=await Je(),{destroyed:i,viewModel:n}=this;if(i||!n||!e)return;const{activeMediaInfo:r}=n,s=await this._getRendererColors(t);this._renderChart({chartDiv:e,mediaInfo:r,chartsModule:t,colorMap:s})}}initialize(){this._featureElementInfo=new ge,this.own([(0,r.YP)((()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex]),(()=>this._setupMediaRefreshTimer()),r.nn),(0,r.YP)((()=>[this.viewModel?.description,this.viewModel?.title]),(()=>this._setupFeatureElementInfo()),r.nn)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}render(){return(0,b.u)("div",{bind:this,class:it,onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?(0,b.u)("div",{key:"media-element-container",class:nt},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:n}=this.viewModel,{value:r,refreshInterval:s,altText:a,title:o,type:l}=e,{sourceURL:d,linkURL:c}=r,u=(0,Ie.or)(c)?"_blank":"_self",p="_blank"===u?"noreferrer":"",h=s?t:null,f=h?h.timestamp:0,m=h?h.sourceURL:d,g=(0,b.u)("img",{alt:a||o,key:`media-${l}-${i}-${n}-${f}`,src:m});return(c?(0,b.u)("a",{title:o,href:c,rel:p,target:u},g):null)||g}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return(0,b.u)("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:ft,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?(0,b.u)("div",{key:"media-title",class:at,innerHTML:e.title}):null,i=e.caption?(0,b.u)("div",{key:"media-caption",class:ot,innerHTML:e.caption}):null;return(0,b.u)("div",{key:"media-container",class:rt},(0,b.u)("div",{key:"media-item-container",class:st},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,n=t?this.classes(mt,lt):this.classes(mt,ut),r=t?this.classes(bt,dt,gt):this.classes(bt,pt,yt),s=t?this.classes(bt,ct,yt):this.classes(bt,ht,gt),a=t?"media-previous":"media-next",o=t?this._previous:this._next;return(0,b.u)("button",{type:"button",key:a,title:i,"aria-label":i,tabIndex:0,class:n,bind:this,onclick:o},(0,b.u)("span",{"aria-hidden":"true",class:r}),(0,b.u)("span",{"aria-hidden":"true",class:s}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){const{am4core:t}=e,i=this.viewModel?.layer,n=new Map;if(!i)return n;const r=await(0,Ue.zB)(i.renderer);return r.delete(null),Array.from(r.values()).every((e=>1===e?.length))?(n.set(Mt,t.color({r:50,g:50,b:50,a:1})),Array.from(r.keys()).forEach((e=>{e&&n.set(e,t.color(r.get(e)[0].toCss(!0)))})),n):n}_handleMediaKeyup(e){const t=(0,qe.kK)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:i,chartDiv:n,mediaInfo:r,colorMap:s}=e,{value:a,type:o}=r,{am4core:l}=i,d=et(l);(0,tt.$o)()&&l.useTheme(i.am4themes_dark);const c=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!c.matches?l.useTheme(i.am4themes_animated):l.unuseTheme(i.am4themes_animated),l.useTheme((function(e){e instanceof l.ColorSet&&d&&(e.list=d)}));const u="pie-chart"===o?this._createPieChart(e):this._createXYChart(e);n.setAttribute("aria-label",r.altText||r.title),u.data=a.series.map((e=>({[It]:e.tooltip,[At]:e.value,[wt]:s.get(e.fieldName)}))).filter((e=>"pie-chart"!==o||e.value>0))}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:n,am4charts:r}=i,s=n.create(t,r.PieChart);s.rtl=(0,f.dZ)(this.container);const a=s.series.push(new r.PieSeries);return a.labels.template.disabled=!0,a.ticks.template.disabled=!0,a.dataFields.value=At,a.dataFields.category=It,this._customizeChartTooltip(a.tooltip,n),a.slices.template.tooltipText=s.rtl?"{category}: %{value.percent.formatNumber('#.0')}":"{category}: {value.percent.formatNumber('#.0')}%",a.slices.template.propertyFields.fill=wt,a.slices.template.propertyFields.stroke=wt,s}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:n}=t,{value:r}=n,{am4core:s,am4charts:a}=i,o=e.xAxes.push(new a.CategoryAxis);o.dataFields.category=It,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,s),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dy=-o.tooltip.contentHeight}));const l=e.yAxes.push(new a.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_t,l.renderer.maxLabelPosition=vt,l.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(l.tooltip,s),d.wrap=!0;const c=e.series.push(new a.ColumnSeries);c.dataFields.valueY=At,c.dataFields.categoryX=It,c.columns.template.propertyFields.fill=wt,c.columns.template.propertyFields.stroke=wt,e.cursor=new a.XYCursor,r.series.length>15&&(e.scrollbarX=new s.Scrollbar)}_createBarChart(e,t){const{chartsModule:i,mediaInfo:n}=t,{value:r}=n,{am4core:s,am4charts:a}=i,o=e.yAxes.push(new a.CategoryAxis);o.dataFields.category=It,o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,s),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dx=o.tooltip.contentWidth}));const l=e.xAxes.push(new a.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_t,l.renderer.maxLabelPosition=vt,l.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(l.tooltip,s),d.wrap=!0;const c=e.series.push(new a.ColumnSeries);c.dataFields.valueX=At,c.dataFields.categoryY=It,c.columns.template.propertyFields.fill=wt,c.columns.template.propertyFields.stroke=wt,e.cursor=new a.XYCursor,r.series.length>15&&(e.scrollbarY=new s.Scrollbar)}_createLineChart(e,t){const{chartsModule:i,mediaInfo:n,colorMap:r}=t,{value:s}=n,{am4core:a,am4charts:o}=i,l=e.xAxes.push(new o.CategoryAxis);l.dataFields.category=It,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",(()=>{l.tooltip.dy=-l.tooltip.contentHeight}));const d=e.yAxes.push(new o.ValueAxis),c=d.renderer.labels.template;d.renderer.minLabelPosition=_t,d.renderer.maxLabelPosition=vt,d.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(d.tooltip,a),c.wrap=!0;const u=e.series.push(new o.LineSeries);u.dataFields.categoryX=It,u.dataFields.valueY=At,u.strokeWidth=1;const p=r.get(Mt);p&&(u.stroke=p);const h=u.bullets.push(new o.CircleBullet);h.propertyFields.fill=wt,h.propertyFields.stroke=wt,e.cursor=new o.XYCursor,s.series.length>15&&(e.scrollbarX=new a.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:n}=e,{type:r}=n,{am4core:s,am4charts:a}=i,o=s.create(t,a.XYChart);return o.rtl=(0,f.dZ)(this.container),"column-chart"===r&&this._createColumnChart(o,e),"bar-chart"===r&&this._createBarChart(o,e),"line-chart"===r&&this._createLineChart(o,e),o}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const r=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),n);this._refreshTimer=r}_getImageSource(e,t){const i=e.includes("?")?"&":"?",[n,r=""]=e.split("#");return`${n}${i}timestamp=${t}${r?"#":""}${r}`}};(0,n._)([(0,s.B)("viewModel.attributes")],Ct.prototype,"attributes",void 0),(0,n._)([(0,s.B)("viewModel.activeMediaInfoIndex")],Ct.prototype,"activeMediaInfoIndex",void 0),(0,n._)([(0,s.B)("viewModel.description")],Ct.prototype,"description",void 0),(0,n._)([(0,s.B)("viewModel.fieldInfoMap")],Ct.prototype,"fieldInfoMap",void 0),(0,n._)([(0,s.B)("viewModel.layer")],Ct.prototype,"layer",void 0),(0,n._)([(0,s.B)("viewModel.mediaInfos")],Ct.prototype,"mediaInfos",void 0),(0,n._)([(0,s.B)("viewModel.popupTemplate")],Ct.prototype,"popupTemplate",void 0),(0,n._)([(0,s.B)("viewModel.relatedInfos")],Ct.prototype,"relatedInfos",void 0),(0,n._)([(0,s.B)("viewModel.title")],Ct.prototype,"title",void 0),(0,n._)([(0,o.Cb)({type:De.Z})],Ct.prototype,"viewModel",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/widgets/Feature/t9n/Feature")],Ct.prototype,"messages",void 0),Ct=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureMedia")],Ct);const xt=Ct;var Ft=i(57240);const Et="esri-icon-loading-indicator esri-rotating",Tt="esri-feature-expression",kt="esri-feature__loading-container",Lt="esri-feature__loading-spinner";let Rt=class extends d.Z{constructor(e,t){super(e,t),this.viewModel=new Ft.Z}initialize(){this.own((0,r.YP)((()=>this.viewModel?.contentElementViewModel),(()=>this._setupExpressionWidget()),r.nn))}destroy(){this._destroyContentWidget()}renderLoading(){return(0,b.u)("div",{key:"loading-container",class:kt},(0,b.u)("span",{class:this.classes(Et,Lt)}))}render(){const{state:e}=this.viewModel;return(0,b.u)("div",{class:Tt},"loading"===e?this.renderLoading():"disabled"===e?null:this._contentWidget?.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,i=t?.type;this._destroyContentWidget();const n=e?"fields"===i?new Oe({viewModel:e}):"media"===i?new xt({viewModel:e}):"text"===i?new Ee({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};(0,n._)([(0,o.Cb)({type:Ft.Z})],Rt.prototype,"viewModel",void 0),Rt=(0,n._)([(0,l.j)("esri.widgets.Feature.FeatureExpression")],Rt);const $t=Rt;var Zt=i(71045),Nt=i(72221),St=i(8704);const Vt="esri-icon-loading-indicator esri-rotating",Pt="esri-widget",Bt="esri-feature",Ot="esri-feature__size-container",qt="esri-feature__title",Ut="esri-feature__main-container",Dt="esri-feature__content-element",jt="esri-feature__text",zt="esri-feature__last-edited-info",Wt="esri-feature__loading-container",Yt="esri-feature__loading-spinner",Qt={title:!0,content:!0,lastEditedInfo:!0};let Ht=class extends((0,Nt.q)(d.Z)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...Qt},this.map=null,this.view=null,this.viewModel=new Zt.Z}initialize(){this.own((0,r.YP)((()=>this.viewModel?.contentViewModels),(()=>this._setupContentWidgets()),r.nn))}loadDependencies(){return i.e(9385).then(i.bind(i,19385))}destroy(){this._destroyContentWidgets()}castVisibleElements(e){return{...Qt,...e}}render(){const{state:e}=this.viewModel,t=(0,b.u)("div",{class:Ot,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return(0,b.u)("div",{class:this.classes(Bt,Pt)},t)}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t)}nextMedia(e){this.viewModel.nextMedia(e)}previousMedia(e){this.viewModel.previousMedia(e)}renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return(0,b.u)("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},i.title?(0,b.u)("div",{key:"error-title",slot:"title"},e.errorMessage):null,(0,b.u)("div",{key:"error-message",slot:"message"},t.loadingError))}renderLoading(){return(0,b.u)("div",{key:"loading-container",class:Wt},(0,b.u)("span",{class:this.classes(Vt,Yt)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?(0,b.u)("div",{class:Ut},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?(0,b.u)(pe.X6,{level:this.headingLevel,class:qt,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?(0,b.u)("div",{key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:(0,b.u)("div",{key:`${t}-content`},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);case"expression":return this.renderExpression(t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:n}=t.viewModel;return"loading"===i||n.length>0?(0,b.u)("div",{key:this._buildKey("attachments-element",e),class:this.classes(Dt)},t.render()):null}renderExpression(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,b.u)("div",{key:this._buildKey("expression-element",e),class:Dt},t.render())}renderCustom(e,t){const{creator:i}=e,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,b.u)("div",{key:this._buildKey("custom-element",t),class:Dt},n.render()):null}renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,b.u)("div",{key:this._buildKey("fields-element",e),class:Dt},t.render())}renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:(0,b.u)("div",{key:this._buildKey("media-element",e),class:Dt},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:n,user:r}=i,s="edit"===i.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,a=(0,St.n)(s,{date:n,user:r});return(0,b.u)("div",{key:"edit-info-element",class:this.classes(zt,Dt)},a)}renderText(e,t){const i=e.text,n=this._contentWidgets[t];return!n||n.destroyed?null:i?(0,b.u)("div",{key:this._buildKey("text-element",t),class:this.classes(Dt,jt)},n.render()):null}_buildKey(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return`${e}__${this.get("viewModel.graphic.uid")||"0"}-${i.join("-")}`}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this._contentWidgets.forEach((e=>this._destroyContentWidget(e))),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,i=this.get("viewModel.content"),{contentViewModels:n}=this.viewModel;if(Array.isArray(i))i.forEach(((i,r)=>{"attachments"===i.type&&(this._contentWidgets[r]=new ve({displayType:i.displayType,headingLevel:t.title?e+1:e,viewModel:n[r]})),"fields"===i.type&&(this._contentWidgets[r]=new Oe({viewModel:n[r]})),"media"===i.type&&(this._contentWidgets[r]=new xt({viewModel:n[r]})),"text"===i.type&&(this._contentWidgets[r]=new Ee({viewModel:n[r]})),"custom"===i.type&&(this._contentWidgets[r]=new Ee({viewModel:n[r]})),"expression"===i.type&&(this._contentWidgets[r]=new $t({viewModel:n[r]}))}),this);else{const e=n[0];e&&!e.destroyed&&(this._contentWidgets[0]=new Ee({viewModel:e}))}this.scheduleRender()}};(0,n._)([(0,s.B)("viewModel.graphic")],Ht.prototype,"graphic",void 0),(0,n._)([(0,s.B)("viewModel.defaultPopupTemplateEnabled")],Ht.prototype,"defaultPopupTemplateEnabled",void 0),(0,n._)([(0,o.Cb)()],Ht.prototype,"headingLevel",void 0),(0,n._)([(0,o.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Ht.prototype,"label",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/widgets/Feature/t9n/Feature")],Ht.prototype,"messages",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/t9n/common")],Ht.prototype,"messagesCommon",void 0),(0,n._)([(0,o.Cb)(),(0,m.H)("esri/widgets/support/t9n/uriUtils")],Ht.prototype,"messagesURIUtils",void 0),(0,n._)([(0,s.B)("viewModel.spatialReference")],Ht.prototype,"spatialReference",void 0),(0,n._)([(0,s.B)("viewModel.title")],Ht.prototype,"title",void 0),(0,n._)([(0,o.Cb)()],Ht.prototype,"visibleElements",void 0),(0,n._)([(0,a.p)("visibleElements")],Ht.prototype,"castVisibleElements",null),(0,n._)([(0,s.B)("viewModel.map")],Ht.prototype,"map",void 0),(0,n._)([(0,s.B)("viewModel.view")],Ht.prototype,"view",void 0),(0,n._)([(0,o.Cb)({type:Zt.Z})],Ht.prototype,"viewModel",void 0),Ht=(0,n._)([(0,l.j)("esri.widgets.Feature")],Ht);const Gt=Ht},83244:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(27366),r=i(49861),s=(i(63780),i(93169),i(25243),i(69912)),a=i(4819);let o=class extends a.Z{constructor(e){super(e),this.description=null,this.title=null}};(0,n._)([(0,r.Cb)()],o.prototype,"description",void 0),(0,n._)([(0,r.Cb)()],o.prototype,"title",void 0),o=(0,n._)([(0,s.j)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],o);const l=o},50267:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(27366),r=i(52639),s=i(85015),a=i(41691),o=i(94172),l=i(49861),d=(i(63780),i(93169),i(25243),i(69912)),c=i(45276);let u=class extends((0,a.p)(s.Z)){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add((0,o.YP)((()=>this.creator),(e=>{this._destroyContent(),this._createContent(e)}),o.nn))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:i}=this;e&&((0,c.vD)(i,{graphic:t}).catch((()=>null)),this._set("created",null))}async _createContent(e){const{graphic:t}=this,i=(0,c.vD)(e,{graphic:t}).catch((()=>null));this._loadingPromise=i,this.notifyChange("state");const n=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};(0,n._)([(0,l.Cb)({readOnly:!0})],u.prototype,"created",void 0),(0,n._)([(0,l.Cb)()],u.prototype,"creator",void 0),(0,n._)([(0,l.Cb)()],u.prototype,"destroyer",void 0),(0,n._)([(0,l.Cb)({type:r.Z})],u.prototype,"graphic",void 0),(0,n._)([(0,l.Cb)({readOnly:!0})],u.prototype,"state",null),u=(0,n._)([(0,d.j)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],u);const p=u},57240:(e,t,i)=>{i.d(t,{Z:()=>w});var n=i(27366),r=i(52639),s=i(44715),a=i(85015),o=i(41691),l=i(94172),d=i(14916),c=i(49861),u=(i(63780),i(93169),i(25243),i(69912)),p=(i(26418),i(23046),i(1374),i(39384),i(29230)),h=i(29514),f=i(98752),m=i(26538),b=i(50267),g=i(86836),y=i(21516),_=i(83819);let v=class extends((0,o.p)(a.Z)){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:e}=this;e&&e.abort(),this._abortController=null},this._createVM=()=>{const e=this.contentElement?.type;this.contentElementViewModel?.destroy();const t="fields"===e?new g.Z:"media"===e?new y.Z:"text"===e?new b.Z:null;this._set("contentElementViewModel",t)},this._compile=async()=>{this._cancelQuery();const e=new AbortController;this._abortController=e,await this._compileExpression(),this._abortController===e&&(this._abortController=null)},this._compileThrottled=(0,d.P)(this._compile,1,this),this._compileExpression=async()=>{const{expressionInfo:e,graphic:t,interceptor:i,spatialReference:n,map:r,view:a,_abortController:o}=this;if(!(e&&t&&n&&r))return void this._set("contentElement",null);const l=await(0,_.$p)();if(o!==this._abortController)return;const d=await(0,_.Rq)({arcadeUtils:l,expressionInfo:e,graphic:t,interceptor:i,map:r,spatialReference:n,view:a});if(!d||"esri.arcade.Dictionary"!==d.declaredClass)return void this._set("contentElement",null);const c=await(0,s.d)(d,o.signal),u=c?.type,m="media"===u?h.Z.fromJSON(c):"text"===u?f.Z.fromJSON(c):"fields"===u?p.Z.fromJSON(c):null;this._set("contentElement",m)},this.handles.add([(0,l.YP)((()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view]),(()=>this._compileThrottled()),l.nn),(0,l.YP)((()=>[this.contentElement]),(()=>this._createVM()),l.nn)])}destroy(){this._cancelQuery(),this.contentElementViewModel?.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:i}=this;return e?"loading":t||i?"ready":"disabled"}get map(){return this.view?.map||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map")}};(0,n._)([(0,c.Cb)()],v.prototype,"_abortController",void 0),(0,n._)([(0,c.Cb)({type:m.Z})],v.prototype,"expressionInfo",void 0),(0,n._)([(0,c.Cb)({type:r.Z})],v.prototype,"graphic",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],v.prototype,"contentElement",void 0),(0,n._)([(0,c.Cb)({readOnly:!0})],v.prototype,"contentElementViewModel",void 0),(0,n._)([(0,c.Cb)()],v.prototype,"interceptor",void 0),(0,n._)([(0,c.Cb)()],v.prototype,"spatialReference",null),(0,n._)([(0,c.Cb)({readOnly:!0})],v.prototype,"state",null),(0,n._)([(0,c.Cb)()],v.prototype,"map",null),(0,n._)([(0,c.Cb)()],v.prototype,"view",void 0),v=(0,n._)([(0,u.j)("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],v);const w=v},86836:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(27366),r=i(85015),s=i(49861),a=(i(63780),i(93169),i(25243),i(69912)),o=i(89860),l=i(16698),d=i(45276);let c=class extends r.Z{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,i=[];return t?.forEach((t=>{if(t.hasOwnProperty("visible")&&!t.visible)return;const n=t.clone();n.label=(0,d.JD)(n,e),i.push(n)})),i}};(0,n._)([(0,s.Cb)()],c.prototype,"attributes",void 0),(0,n._)([(0,s.Cb)({type:[o.Z]})],c.prototype,"expressionInfos",void 0),(0,n._)([(0,s.Cb)()],c.prototype,"description",void 0),(0,n._)([(0,s.Cb)({type:[l.Z]})],c.prototype,"fieldInfos",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],c.prototype,"formattedFieldInfos",null),(0,n._)([(0,s.Cb)()],c.prototype,"title",void 0),c=(0,n._)([(0,a.j)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],c);const u=c},21516:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(27366),r=i(85015),s=i(49861),a=(i(63780),i(93169),i(89125)),o=i(69912),l=i(16698),d=i(60260),c=i(45276),u=i(16490);const p={chartAnimation:!0};let h=class extends r.Z{constructor(e){super(e),this.abilities={...p},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...p,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,i=(e+t)%t;this.activeMediaInfoIndex=i}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,i=t+e;this._setContentElementMedia(i)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:i,expressionAttributes:n,fieldInfoMap:r,layer:s}=this;return t?.map((t=>{const a=t?.clone();if(!a)return null;if(a.title=(0,c.S$)({attributes:e,fieldInfoMap:r,globalAttributes:i,expressionAttributes:n,layer:s,text:a.title}),a.caption=(0,c.S$)({attributes:e,fieldInfoMap:r,globalAttributes:i,expressionAttributes:n,layer:s,text:a.caption}),a.altText=(0,c.S$)({attributes:e,fieldInfoMap:r,globalAttributes:i,expressionAttributes:n,layer:s,text:a.altText}),"image"===a.type){const{value:e}=a;return this._setImageValue({value:e,formattedAttributes:i,layer:s}),a.value.sourceURL?a:void 0}if("pie-chart"===a.type||"line-chart"===a.type||"column-chart"===a.type||"bar-chart"===a.type){const{value:t}=a;return this._setChartValue({value:t,chartType:a.type,attributes:e,formattedAttributes:i,layer:s}),a}return null})).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:i,formattedAttributes:n,layer:r}=e,{linkURL:s,sourceURL:a}=i;if(a){const e=(0,c.Qu)(a,r);i.sourceURL=(0,c.ar)({formattedAttributes:n,template:e,fieldInfoMap:t})}if(s){const e=(0,c.Qu)(s,r);i.linkURL=(0,c.ar)({formattedAttributes:n,template:e,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:i,formattedAttributes:n,chartType:r,layer:s}=e,{popupTemplate:a,relatedInfos:o}=this,{fields:l,normalizeField:d}=t;if(t.fields=(0,c.iJ)(l,s),d&&(t.normalizeField=(0,c.k6)(d,s)),!l.some((e=>!!(null!=n[e]||(0,c.oM)(e)&&o.size))))return;const u=a?.fieldInfos;l.forEach((e=>{if((0,c.oM)(e))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:u,fieldName:e,formattedAttributes:n,chartType:r,value:t})]);const s=this._getChartOption({value:t,attributes:i,chartType:r,formattedAttributes:n,fieldName:e,fieldInfos:u});t.series.push(s)}))}_getRelatedChartInfos(e){const{fieldInfos:t,fieldName:i,formattedAttributes:n,chartType:r,value:s}=e,a=[],o=(0,u.Bt)(i),{layerId:l,fieldName:d}=o,c=this.relatedInfos?.get(l.toString());if(!c)return a;const{relatedFeatures:p,relation:h}=c;if(!h||!p)return a;const{cardinality:f}=h;return p.forEach((e=>{const{attributes:o}=e;o&&Object.keys(o).forEach((e=>{e===d&&a.push(this._getChartOption({value:s,attributes:o,formattedAttributes:n,fieldName:i,chartType:r,relatedFieldName:e,fieldInfos:t}))}))})),"one-to-many"===f||"many-to-many"===f?a:[a[0]]}_getTooltip(e){let{label:t,value:i,chartType:n}=e;return"pie-chart"===n?`${t}`:`${t}: ${i}`}_getChartOption(e){const{value:t,attributes:i,formattedAttributes:n,fieldName:r,relatedFieldName:s,fieldInfos:a,chartType:o}=e,{layer:p,fieldInfoMap:h}=this,{normalizeField:f,tooltipField:m}=t,b=f?(0,c.oM)(f)?i[(0,u.Bt)(f).fieldName]:i[f]:null,g=s&&void 0!==i[s]?i[s]:void 0!==i[r]?i[r]:n[r],y=new d.Z({fieldName:r,value:void 0===g?null:g&&b?g/b:g});if((0,c.oM)(r)){const e=h.get(r.toLowerCase()),t=h.get(m.toLowerCase()),i=e?.fieldName??r,a=n[t?.fieldName??m]??e?.label??e?.fieldName??s,l=n[i];return y.tooltip=this._getTooltip({label:a,value:l,chartType:o}),y}const _=(0,c._R)(a,r),v=(0,c.k6)(r,p),w=m&&void 0!==n[m]?n[m]:(0,c.JD)(_||new l.Z({fieldName:v}),this.popupTemplate?.expressionInfos),I=n[v];return y.tooltip=this._getTooltip({label:w,value:I,chartType:o}),y}};(0,n._)([(0,s.Cb)()],h.prototype,"abilities",void 0),(0,n._)([(0,a.p)("abilities")],h.prototype,"castAbilities",null),(0,n._)([(0,s.Cb)()],h.prototype,"activeMediaInfoIndex",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],h.prototype,"activeMediaInfo",null),(0,n._)([(0,s.Cb)()],h.prototype,"attributes",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"description",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"fieldInfoMap",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"formattedAttributes",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"expressionAttributes",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],h.prototype,"formattedMediaInfos",null),(0,n._)([(0,s.Cb)()],h.prototype,"layer",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],h.prototype,"formattedMediaInfoCount",null),(0,n._)([(0,s.Cb)()],h.prototype,"mediaInfos",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"popupTemplate",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"relatedInfos",void 0),(0,n._)([(0,s.Cb)()],h.prototype,"title",void 0),h=(0,n._)([(0,o.j)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],h);const f=h},71045:(e,t,i)=>{i.d(t,{Z:()=>k});var n=i(27366),r=i(52639);var s,a=i(85015),o=i(100),l=i(32718),d=i(92026),c=i(66978),u=i(94172),p=i(14916),h=i(49861),f=(i(63780),i(93169),i(89125)),m=i(69912),b=i(98752),g=i(83244),y=i(50267),_=i(57240),v=i(86836),w=i(21516),I=i(83819),A=i(45276),M=i(16490);const C="content-view-models",x="esri.widgets.FeatureViewModel",F=l.Z.getLogger(x),E={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};let T=s=class extends a.Z{constructor(e){super(e),this._handles=new o.Z,this._error=null,this._featureAbortController=null,this.graphicChangedThrottled=(0,p.P)(this._graphicChanged,1,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...E},this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return"attachments"===e.type&&t.attachmentsContent||"custom"===e.type&&t.customContent||"fields"===e.type&&t.fieldsContent||"media"===e.type&&t.mediaContent||"text"===e.type&&t.textContent||"expression"===e.type&&t.expressionContent},this._handles.add((0,u.YP)((()=>[this.graphic,this._effectivePopupTemplate,this.abilities]),(()=>this.graphicChangedThrottled()),u.nn))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return(0,d.pC)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return(0,A.cT)((0,A.Hs)(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return(0,A.l$)(this.graphic)}castAbilities(e){return{...E,...e}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(e){this._set("graphic",e?e.clone():null)}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){const i=this.contentViewModels[e];i instanceof w.Z&&i.setActiveMedia(t)}nextMedia(e){const t=this.contentViewModels[e];t instanceof w.Z&&t.next()}previousMedia(e){const t=this.contentViewModels[e];t instanceof w.Z&&t.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal})}catch(i){(0,c.D_)(i)||(this._error=i,F.error("error","The popupTemplate could not be displayed for this feature.",{error:i,graphic:e,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===t&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContentElement(e,t){return"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):"expression"===e.type?this._compileExpression(e,t):void 0}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map(((e,t)=>this._compileContentElement(e,t))):"string"==typeof e?this._compileText(new b.Z({text:e}),0).text:e}_destroyContentViewModels(){this._handles?.remove(C),this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[])}_setExpressionContentVM(e,t){const{formattedAttributes:i}=this,{contentElement:n,contentElementViewModel:r}=e,s=n?.type;r&&s&&("fields"===s&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createFieldsVMParams(n,t))),"media"===s&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:t,formattedAttributes:i}),r.set(this._createMediaVMParams(n,t))),"text"===s&&r.set(this._createTextVMParams(n)))}_compileExpression(e,t){const{expressionInfo:i}=e,{graphic:n,map:r,spatialReference:a,view:o}=this,l=new _.Z({expressionInfo:i,graphic:n,interceptor:s.interceptor,map:r,spatialReference:a,view:o});return this.contentViewModels[t]=l,this._handles.add((0,u.YP)((()=>l.contentElementViewModel),(()=>this._setExpressionContentVM(l,t)),u.nn),C),e}_compileAttachments(e,t){const{graphic:i}=this,{description:n,title:r}=e;return this.contentViewModels[t]=new g.Z({graphic:i,...this._compileTitleAndDesc({title:r,description:n})}),e}_compileCustom(e,t){const{graphic:i}=this,{creator:n,destroyer:r}=e;return this.contentViewModels[t]=new y.Z({graphic:i,creator:n,destroyer:r}),e}_compileTitleAndDesc(e){let{title:t,description:i}=e;const{_fieldInfoMap:n,_sourceLayer:r,graphic:s,formattedAttributes:a,_expressionAttributes:o}=this,{attributes:l}=s,d=a.global;return{title:(0,A.S$)({attributes:l,fieldInfoMap:n,globalAttributes:d,expressionAttributes:o,layer:r,text:t}),description:(0,A.S$)({attributes:l,fieldInfoMap:n,globalAttributes:d,expressionAttributes:o,layer:r,text:i})}}_createFieldsVMParams(e,t){const{_effectivePopupTemplate:i,formattedAttributes:n}=this,r={...n.global,...n.content[t]},s=(e?.fieldInfos||i?.fieldInfos)?.filter((e=>{let{fieldName:t}=e;return(0,A.Rd)(t)||(0,A.oM)(t)||r.hasOwnProperty(t)})),a=i?.expressionInfos,{description:o,title:l}=e;return{attributes:r,expressionInfos:a,fieldInfos:s,...this._compileTitleAndDesc({title:l,description:o})}}_compileFields(e,t){const i=e.clone(),n=new v.Z(this._createFieldsVMParams(e,t));return this.contentViewModels[t]=n,i.fieldInfos=n.formattedFieldInfos.slice(0),i}_createMediaVMParams(e,t){const{abilities:i,graphic:n,_fieldInfoMap:r,formattedAttributes:s,_effectivePopupTemplate:a,relatedInfos:o,_sourceLayer:l,_expressionAttributes:d}=this,{attributes:c}=n,{description:u,mediaInfos:p,title:h}=e;return{abilities:{chartAnimation:i.chartAnimation},activeMediaInfoIndex:e.activeMediaInfoIndex||0,attributes:c,layer:l,fieldInfoMap:r,formattedAttributes:{...s.global,...s.content[t]},expressionAttributes:d,mediaInfos:p,popupTemplate:a,relatedInfos:o,...this._compileTitleAndDesc({title:h,description:u})}}_compileMedia(e,t){const i=e.clone(),n=new w.Z(this._createMediaVMParams(e,t));return i.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[t]=n,i}_createTextVMParams(e){const{graphic:t,_fieldInfoMap:i,_sourceLayer:n,_expressionAttributes:r}=this;if(e&&e.text){const{attributes:s}=t,a=this.formattedAttributes.global;e.text=(0,A.S$)({attributes:s,fieldInfoMap:i,globalAttributes:a,expressionAttributes:r,layer:n,text:e.text})}return{graphic:t,creator:e.text}}_compileText(e,t){const i=e.clone();return this.contentViewModels[t]=new y.Z(this._createTextVMParams(i)),i}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:i}=this;if(!e)return;const{lastEditInfoEnabled:n}=e,r=t?.editFieldsInfo;return n&&r?(0,A.Tj)(r,i.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:i,graphic:n,_expressionAttributes:r}=this,{attributes:s}=n,a=this.formattedAttributes.global;return(0,A.S$)({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:r,layer:i,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,i=e?.title;return(0,A.vD)(i,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,i=e?.content;return(0,A.vD)(i,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:i,graphic:n,_effectivePopupTemplate:r,spatialReference:a,map:o,view:l}=this,{content:{value:d},title:{value:u}}=await(0,c.as)({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!n)return;await(0,A.Xh)({graphic:n,popupTemplate:r,layer:i,spatialReference:a},e);const{expressionAttributes:{value:p}}=await(0,c.as)({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:(0,I.Um)({expressionInfos:r?.expressionInfos,spatialReference:a,graphic:n,map:o,interceptor:s.interceptor,view:l})});t===this._featureAbortController&&n&&(this._expressionAttributes=p,this._graphicExpressionAttributes={...n.attributes,...p},this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(u)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null))}_createMediaFormattedAttributes(e){let{contentElement:t,contentElementIndex:i,formattedAttributes:n}=e;const{_effectivePopupTemplate:r,graphic:s,relatedInfos:a,_sourceLayer:o,_fieldInfoMap:l,_graphicExpressionAttributes:d}=this;n.content[i]=(0,A.uI)({fieldInfos:r?.fieldInfos,graphic:s,attributes:{...d,...t.attributes},layer:o,fieldInfoMap:l,relatedInfos:a})}_createFieldsFormattedAttributes(e){let{contentElement:t,contentElementIndex:i,formattedAttributes:n}=e;if(t.fieldInfos){const{graphic:e,relatedInfos:r,_sourceLayer:s,_fieldInfoMap:a,_graphicExpressionAttributes:o}=this;n.content[i]=(0,A.uI)({fieldInfos:t.fieldInfos,graphic:e,attributes:{...o,...t.attributes},layer:s,fieldInfoMap:a,relatedInfos:r})}}_createFormattedAttributes(e){const{_effectivePopupTemplate:t,graphic:i,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:s,_graphicExpressionAttributes:a}=this,o=t?.fieldInfos,l={global:(0,A.uI)({fieldInfos:o,graphic:i,attributes:a,layer:r,fieldInfoMap:s,relatedInfos:n}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&this._createFieldsFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:l}),"media"===e.type&&this._createMediaFormattedAttributes({contentElement:e,contentElementIndex:t,formattedAttributes:l})})),l}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:i}=this;return this._queryRelatedInfos(t,(0,A.Hs)(i),e)}async _queryRelatedInfos(e,t,i){const{relatedInfos:n,_sourceLayer:r}=this;n.clear();const s=(0,d.pC)(r.associatedLayer)?await r.associatedLayer.load(i):r;if(!s)return;const a=t.filter((e=>e&&(0,A.oM)(e.fieldName)));if(!a||!a.length)return;t.forEach((e=>this._configureRelatedInfo(e,s)));const o=await(0,M.Vb)({relatedInfos:n,layer:s},i);Object.keys(o).forEach((e=>{const t=n.get(e.toString()),i=o[e]?.value;t&&i&&(t.layerInfo=i.data)}));const l=await(0,M.kp)({graphic:e,relatedInfos:n,layer:s},i);Object.keys(l).forEach((e=>{(0,M.lg)(l[e]?.value,n.get(e.toString()))}))}_configureRelatedInfo(e,t){const{relatedInfos:i}=this,n=(0,M.Bt)(e.fieldName);if(!n)return;const{layerId:r,fieldName:s}=n;if(!r)return;const a=i.get(r.toString())||(0,M.uc)(r,t);a&&((0,M.NF)({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(r,a))}};T.interceptor=new class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=e=>{}),this.preRequestCallback||(this.preLayerQueryCallback=e=>{})}}(A.s5,A.Ns),(0,n._)([(0,h.Cb)()],T.prototype,"_error",void 0),(0,n._)([(0,h.Cb)()],T.prototype,"_featureAbortController",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"_effectivePopupTemplate",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"_fieldInfoMap",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"_sourceLayer",null),(0,n._)([(0,h.Cb)()],T.prototype,"abilities",void 0),(0,n._)([(0,f.p)("abilities")],T.prototype,"castAbilities",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"content",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"contentViewModels",void 0),(0,n._)([(0,h.Cb)({type:Boolean})],T.prototype,"defaultPopupTemplateEnabled",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"state",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"formattedAttributes",void 0),(0,n._)([(0,h.Cb)({type:r.Z,value:null})],T.prototype,"graphic",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"lastEditInfo",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"relatedInfos",void 0),(0,n._)([(0,h.Cb)()],T.prototype,"spatialReference",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"title",void 0),(0,n._)([(0,h.Cb)()],T.prototype,"map",null),(0,n._)([(0,h.Cb)({readOnly:!0})],T.prototype,"waitingForContent",null),(0,n._)([(0,h.Cb)()],T.prototype,"view",void 0),T=s=(0,n._)([(0,m.j)(x)],T);const k=T},72221:(e,t,i)=>{i.d(t,{q:()=>o});var n=i(27366),r=(i(32718),i(25243),i(63780),i(93169),i(75366),i(69912)),s=i(53963),a=i(67005);const o=e=>{let t=class extends e{constructor(){super(...arguments),this.renderNodeContent=e=>(0,s.Qd)(e)&&!e.destroyed?(0,a.u)("div",{key:e},e.render()):e instanceof HTMLElement?(0,a.u)("div",{key:e,bind:e,afterCreate:this._attachToNode}):(0,s.o)(e)?(0,a.u)("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};return t=(0,n._)([(0,r.j)("esri.widgets.Feature.ContentMixin")],t),t}},83819:(e,t,i)=>{i.d(t,{$p:()=>c,Rq:()=>p,Um:()=>h});var n=i(32718),r=i(66978),s=i(16455),a=i(45276);const o=["$datastore","$map","$layer","$aggregatedfeatures"],l=n.Z.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function d(e){return"string"==typeof e?(0,a.qD)((0,a.M3)(e)):Array.isArray(e)?function(e){return`<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?(0,a.qD)((0,a.M3)(e)):e}</li>`)).join("")}</ul>`}(e):"esri.arcade.Dictionary"===e?.declaredClass?function(e){return`<table class="esri-widget__table">${e.keys().map((t=>{const i=e.field(t);return`<tr><th>${t}</th><td>${"string"==typeof i?(0,a.qD)((0,a.M3)(i)):i}</td></tr>`})).join("")}</table>`}(e):e}function c(){return i.e(4978).then(i.bind(i,84978))}async function u(e){let{graphic:t,view:i}=e;const{isAggregate:n,layer:r}=t;if(!n||!r||"2d"!==i?.type)return[];const s=await i.whenLayerView(r);if(!s.createQuery||!s.queryFeatures)return[];const a=s.createQuery();a.aggregateIds=[t.getObjectId()];const{features:o}=await s.queryFeatures(a);return o}async function p(e){let{expressionInfo:t,arcadeUtils:i,interceptor:n,spatialReference:r,map:a,graphic:d,view:c}=e;if(!t||!t.expression)return null;const p=i.createSyntaxTree(t.expression),h=o.filter((e=>i.hasVariable(p,e))),[f]=await Promise.all([u({graphic:d,view:c}),i.loadScriptDependencies(p,!0,h)]),m=i.getViewInfo({spatialReference:r}),b=i.createExecContext(d,m);b.interceptor=n,b.useAsync=!0,function(e){let{aggregatedFeatures:t,arcadeUtils:i,featureSetVars:n,context:r,viewInfo:a,map:o,graphic:l,interceptor:d}=e;n.forEach((e=>{const n=e.toLowerCase(),c={map:o,spatialReference:a.sr,interceptor:d};if("$map"===n&&(r.vars[n]=i.convertMapToFeatureSetCollection(c)),"$layer"===n&&(r.vars[n]=i.convertFeatureLayerToFeatureSet({layer:l.sourceLayer,spatialReference:a.sr,interceptor:d})),"$datastore"===n&&(r.vars[n]=i.convertServiceUrlToWorkspace({url:l.sourceLayer.url,spatialReference:a.sr,interceptor:d})),"$aggregatedfeatures"===n){const e=l.layer,{fields:o,objectIdField:c,geometryType:u,spatialReference:p,displayField:h}=e,f=new s.default({fields:o,objectIdField:c,geometryType:u,spatialReference:p,displayField:h,..."feature"===e.type?{templates:e.templates,typeIdField:e.typeIdField,types:e.types}:null,source:t});r.vars[n]=i.convertFeatureLayerToFeatureSet({layer:f,spatialReference:a.sr,interceptor:d})}}))}({aggregatedFeatures:f,arcadeUtils:i,featureSetVars:h,context:b,viewInfo:m,map:a,graphic:d,interceptor:n});const g=i.createFunction(p,b);return i.executeAsyncFunction(g,b).catch((e=>l.error("arcade-execution-error",{error:e,graphic:d,expressionInfo:t})))}async function h(e){let{expressionInfos:t,spatialReference:i,graphic:n,interceptor:s,map:a,view:o}=e;if(!t||!t.length)return{};const l=await c(),u={};for(const r of t)u[`expression/${r.name}`]=p({expressionInfo:r,arcadeUtils:l,interceptor:s,spatialReference:i,map:a,graphic:n,view:o});const h=await(0,r.as)(u),f={};for(const r in h)f[r]=d(h[r].value);return f}},45276:(e,t,i)=>{i.d(t,{Hs:()=>U,JD:()=>x,M3:()=>D,Ns:()=>J,Qu:()=>N,Rd:()=>C,S$:()=>L,Tj:()=>O,Xh:()=>Y,_R:()=>B,ar:()=>R,cT:()=>q,iJ:()=>E,k6:()=>F,l$:()=>I,oM:()=>Q,or:()=>M,qD:()=>j,s5:()=>X,uI:()=>W,vD:()=>A});i(59166);var n=i(32718),r=i(92026),s=i(643),a=i(76969),o=i(6291),l=i(37270),d=i(91738),c=i(819);const u=n.Z.getLogger("esri.widgets.Feature.support.featureUtils"),p=/href=(""|'')/gi,h=/(\{([^\{\r\n]+)\})/g,f=/\'/g,m=/^\s*expression\//i,b=/(\n)/gi,g=/[\u00A0-\u9999<>\&]/gim,y=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,_=/^(?:mailto:|tel:)/,v="relationships/",w=(0,a.Ze)("short-date-short-time");function I(e){if(!(0,r.Wi)(e))return e.get("sourceLayer")||e.get("layer")}async function A(e,t){return"function"==typeof e?e.call(null,t):e}function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!_.test(e.trim().toLowerCase())}function C(e){return!!e&&m.test(e)}function x(e,t){const i=function(e,t){if(!C(t)||!e)return null;const i=t.replace(m,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===i&&(n=e,!0))),n}(t,e?.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function F(e,t){const i=T(t,e);return i?i.name:e}function E(e,t){return e&&e.map((e=>F(e,t)))}function T(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function k(e){return`${e}`.trim()}function L(e){let{attributes:t,globalAttributes:i,layer:n,text:r,expressionAttributes:s,fieldInfoMap:a}=e;return r?R({formattedAttributes:i,template:S(r,{...i,...s,...t},n),fieldInfoMap:a}):""}function R(e){let{formattedAttributes:t,template:i,fieldInfoMap:n}=e;return k(function(e){return e.replace(p,"")}((0,s.gx)((0,s.gx)(i,(e=>function(e,t){const i=t.get(e.toLowerCase());return`{${i&&i.fieldName||e}}`}(e,n))),t)))}function $(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t[e];if("string"==typeof n){const r="%27",s=(i?encodeURIComponent(n):n).replace(f,r);t[e]=s}}function Z(e,t,i){const n=(t=k(t))&&"{"!==t[0];return(0,s.gx)(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={...e};return Object.keys(i).forEach((e=>$(e,i,t))),i}(i,n))}function N(e,t){return e.replace(h,((e,i,n)=>{const r=T(t,n);return r?`{${r.name}}`:i}))}function S(e,t,i){const n=N(e,i);return n?n.replace(y,((e,i,n)=>Z(e,i||n,t))):n}function V(e){return!!e?.layer}function P(e,t){const i=t.fieldInfos,n=t.fieldName,r=B(i,n)?.clone(),s=t.preventPlacesFormatting,a=t.layer,c=T(a,n);if(r&&"date"===c?.type){const e=r.format||new d.Z;e.dateFormat=e.dateFormat||"short-date-short-time",e.dateTimeFormatOptions=!V(a)&&function(e){return"feature"===e?.type}(a)&&a.datesInUnknownTimezone||V(a)&&function(e){return"map-image"===e?.type}(a.layer)&&a.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,r.format=e}const u=r&&r.format;return"string"==typeof e&&(0,l.Ec)(n)&&u?u.formatRasterPixelValue(e):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,u))||null==e||null==u?j(e):s?(0,o.uf)(e,{...(0,o.sh)(u),minimumFractionDigits:0,maximumFractionDigits:20}):u.format(e)}function B(e,t){if(!e||!e.length||!t)return;const i=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==i)&&(n=e,!0))),n}function O(e,t){const{creatorField:i,creationDateField:n,editorField:r,editDateField:s}=e;if(!t)return;const o=t[s];if("number"==typeof o){const e=t[r];return{type:"edit",date:(0,a.p6)(o,w),user:e}}const l=t[n];if("number"==typeof l){const e=t[i];return{type:"create",date:(0,a.p6)(l,w),user:e}}return null}function q(e,t){const i=new Map;return e&&e.forEach((e=>{const n=F(e.fieldName,t);e.fieldName=n,i.set(n.toLowerCase(),e)})),i}function U(e){const t=[];if(!e)return t;const{fieldInfos:i,content:n}=e;return i&&t.push(...i),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const i=e&&e.fieldInfos;i&&t.push(...i)}})),t):t}function D(e){return e.replace(g,(e=>`&#${e.charCodeAt(0)};`))}function j(e){return"string"==typeof e?e.replace(b,'<br class="esri-text-new-line" />'):e}function z(e){const{value:t,fieldName:i,fieldInfos:n,fieldInfoMap:r,layer:s,graphic:o}=e;if(null==t)return"";const l=function(e){let{fieldName:t,value:i,graphic:n,layer:r}=e;if(Q(t))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;const s=r.getFieldDomain(t,{feature:n});return s&&"coded-value"===s.type?s.getName(i):null}({fieldName:i,value:t,graphic:o,layer:s});if(l)return l;const d=function(e){let{fieldName:t,graphic:i,layer:n}=e;if(Q(t))return null;if(!n||"function"!=typeof n.getFeatureType)return null;const{typeIdField:r}=n;if(!r||t!==r)return null;const s=n.getFeatureType(i);return s?s.name:null}({fieldName:i,graphic:o,layer:s});if(d)return d;if(r.get(i.toLowerCase()))return P(t,{fieldInfos:n||Array.from(r.values()),fieldName:i,layer:s});const c=s&&s.fieldsIndex;return c&&c.isDateField(i)?(0,a.p6)(t,w):j(t)}function W(e){let{fieldInfos:t,attributes:i,layer:n,graphic:r,fieldInfoMap:s,relatedInfos:a}=e;const o={};return a?.forEach((e=>function(e){let{attributes:t,relatedInfo:i,fieldInfoMap:n,fieldInfos:r,layer:s}=e;t&&i&&(i.relatedFeatures&&i.relatedFeatures&&i.relatedFeatures.forEach((e=>H({attributes:t,graphic:e,relatedInfo:i,fieldInfoMap:n,fieldInfos:r,layer:s}))),i.relatedStatsFeatures&&i.relatedStatsFeatures&&i.relatedStatsFeatures.forEach((e=>H({attributes:t,graphic:e,relatedInfo:i,fieldInfoMap:n,fieldInfos:r,layer:s}))))}({attributes:o,relatedInfo:e,fieldInfoMap:s,fieldInfos:t,layer:n}))),Object.keys(i).forEach((e=>{const a=i[e];o[e]=z({fieldName:e,fieldInfos:t,fieldInfoMap:s,layer:n,value:a,graphic:r})})),o}async function Y(e,t){let{graphic:i,popupTemplate:n,layer:r,spatialReference:s}=e;if(!r||!n)return;if("function"==typeof r.load&&await r.load(t),!i.attributes)return;const a=i.attributes[r.objectIdField];if(null==a)return;const o=[a],d=await n.getRequiredFields(r.fieldsIndex),p=(0,l.R9)(d,i),h=p?[]:d,f=n.returnGeometry||await async function(e){if(!e.expressionInfos?.length)return!1;const t=await(0,c.LC)(),{arcadeUtils:{hasGeometryFunctions:i}}=t;return i(e)}(n);if(p&&!f)return;const m=await async function(e,t){const{layer:i,graphic:n,outFields:r,objectIds:s,returnGeometry:a,spatialReference:o}=e,l=s[0];if("number"!=typeof l&&"string"!=typeof l){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:i,graphic:n,objectId:l,requiredFields:r};return u.warn(e,t),null}if(!i.capabilities?.operations?.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:i,graphic:n,requiredFields:r,returnGeometry:a};return u.warn(e,t),null}const d=i.createQuery();return d.objectIds=s,d.outFields=r?.length?r:[i.objectIdField],d.returnGeometry=!!a,d.returnZ=!!a,d.returnM=!!a,d.outSpatialReference=o,(await i.queryFeatures(d,t)).features[0]}({layer:r,graphic:i,outFields:h,objectIds:o,returnGeometry:f,spatialReference:s},t);m&&(m.geometry&&(i.geometry=m.geometry),m.attributes&&(i.attributes={...i.attributes,...m.attributes}))}function Q(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(v)}function H(e){let{attributes:t,graphic:i,relatedInfo:n,fieldInfos:r,fieldInfoMap:s,layer:a}=e;t&&i&&n&&Object.keys(i.attributes).forEach((e=>{const o=function(e){return e?`${v}${e.layerId}/${e.fieldName}`:""}({layerId:n.relation.id.toString(),fieldName:e}),l=i.attributes[e];t[o]=z({fieldName:o,fieldInfos:r,fieldInfoMap:s,layer:a,value:l,graphic:i})}))}const G=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},K=e=>{let{layer:t,method:i,query:n,definitionExpression:s}=e;if(!t.capabilities?.query?.supportsCacheHint||"attachments"===i)return;const a=(0,r.pC)(n.where)&&n.where,o=(0,r.pC)(n.geometry)&&n.geometry;G(s)||G(a)||"extent"===o?.type||"tile"===n.resultType||(n.cacheHint=!0)},X=e=>{let{query:t,layer:i,method:n}=e;K({layer:i,method:n,query:t,definitionExpression:`${i.definitionExpression} ${i.serviceDefinitionExpression}`})},J=e=>{let{queryPayload:t,layer:i,method:n}=e;K({layer:i,method:n,query:t,definitionExpression:`${i.definitionExpression} ${i.serviceDefinitionExpression}`})}},16490:(e,t,i)=>{i.d(t,{Bt:()=>m,NF:()=>w,Vb:()=>_,kp:()=>v,lg:()=>g,uc:()=>b});var n=i(76200),r=i(10064),s=i(32718),a=i(66978),o=i(37270),l=(i(93169),i(64020),i(77946)),d=(i(63780),i(35995),i(68860),i(92975),i(83406),i(53866),i(32238),i(77577),i(7882),i(80885),i(29909),i(50689),i(78084),i(49818),i(21149)),c=(i(19545),i(11812),i(99837),i(59486),i(99086)),u=(i(54307),i(33997)),p=i(45276);const h=s.Z.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),f=new Map;function m(e){if(!(0,p.oM)(e))return null;const[t,i]=e.split("/").slice(1);return{layerId:t,fieldName:i}}function b(e,t){const i=function(e,t){if(!t.relationships)return null;let i=null;const{relationships:n}=t;return n.some((t=>t.id===parseInt(e,10)&&(i=t,!0))),i}(e,t);if(i)return{url:`${t.url}/${i.relatedTableId}`,sourceSpatialReference:t.spatialReference,relation:i,relatedFields:[],outStatistics:[]}}function g(e,t){if(!t)return;if(!e)return;const{features:i,statsFeatures:n}=e,r=i&&i.value;t.relatedFeatures=r?r.features:[];const s=n&&n.value;t.relatedStatsFeatures=s?s.features:[]}async function y(e,t,i,n){const r=i.layerId.toString(),{layerInfo:s,relation:u,relatedFields:p,outStatistics:h,url:f,sourceSpatialReference:m}=t,b=function(e){let t,{originRelationship:i,relationships:n,layerId:r}=e;return n&&n.some((e=>(`${e.relatedTableId}`===r&&e.id===i.id&&(t=e),!!t))),t}({originRelationship:u,relationships:s.relationships,layerId:r});if(b.relationshipTableId&&b.keyFieldInRelationshipTable){const t=(await function(e,t,i,n){const r=new c.Z;return r.outFields=["*"],r.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),r.objectIds=[e.attributes[i.objectIdField]],i.queryRelatedFeatures(r,n)}(e,b,i,n))[e.attributes[i.objectIdField]];if(!t)return null;const r=t.features.map((e=>e.attributes[s.objectIdField]));if(h?.length>0&&s.supportsStatistics){const e=new d.Z;e.where=function(e,t,i){let n=0;const r=[];for(;n<t.length;)r.push(`${e} IN (${t.slice(n,i+n)})`),n+=i;return r.join(" OR ")}(s.objectIdField,r,1e3),e.outFields=p,e.outStatistics=h,e.sourceSpatialReference=m;const i={features:Promise.resolve(t),statsFeatures:(0,l.e)(f,e)};return(0,a.as)(i)}}const g=b?.keyField;if(g){const i=(0,o.H7)(function(e,t){if(null!=e){t=t.toLowerCase();for(const i of e)if(i&&i.name.toLowerCase()===t)return i}return null}(s.fields,g)),r=function(e,t){const i=t.toLowerCase();for(const n in e)if(n.toLowerCase()===i)return e[n];return null}(e.attributes,u.keyField),c=i?`${g}=${r}`:`${g}='${r}'`,p=(0,l.e)(f,new d.Z({where:c,outFields:t.relatedFields,sourceSpatialReference:m}),n),h=t.outStatistics&&t.outStatistics.length>0&&s.supportsStatistics?(0,l.e)(f,new d.Z({where:c,outFields:t.relatedFields,outStatistics:t.outStatistics,sourceSpatialReference:m}),n):null,b={features:p};return h&&(b.statsFeatures=h),(0,a.as)(b)}return null}function _(e,t){let{relatedInfos:i,layer:s}=e;const o={};return i.forEach(((e,i)=>{const{relation:a}=e;if(!a){const e=new r.Z("relation-required","A relation is required on a layer to retrieve related records.");throw h.error(e),e}const{relatedTableId:l}=a;if("number"!=typeof l){const e=new r.Z("A related table ID is required on a layer to retrieve related records.");throw h.error(e),e}const d=`${s.url}/${l}`,c=f.get(d),u=c||function(e,t){return(0,n.default)(e,{query:{f:"json"},signal:t&&t.signal})}(d,t);c||f.set(d,u),o[i]=u})),(0,a.as)(o)}function v(e,t){let{graphic:i,relatedInfos:n,layer:r}=e;const s={};return n.forEach(((e,n)=>{e.layerInfo&&(s[n]=y(i,e,r,t))})),(0,a.as)(s)}function w(e){let{relatedInfo:t,fieldName:i,fieldInfo:n}=e;if(t.relatedFields.push(i),n.statisticType){const e=new u.Z({statisticType:n.statisticType,onStatisticField:i,outStatisticFieldName:i});t.outStatistics.push(e)}}},226:(e,t,i)=>{i.d(t,{NA:()=>d,QQ:()=>c,fD:()=>u,pO:()=>o});var n=i(51995),r=i(75434);const s=new n.Z([64,64,64]);function a(e,t){const i=[],n=e.length-1;return 5===e.length?i.push(0,2,4):i.push(0,n),e.map(((e,s)=>i.includes(s)?(0,r.MN)(e,s,n,t):null))}async function o(e,t,n){let r=!1,s=[],o=[];if(e.stops){const t=e.stops;s=t.map((e=>e.value)),r=t.some((e=>!!e.label)),r&&(o=t.map((e=>e.label)))}const d=s[0],c=s[s.length-1];if(null==d&&null==c)return null;const u=r?null:a(s,n);return(await Promise.all(s.map((async(n,s)=>({value:n,color:"opacity"===e.type?await l(n,e,t):(await Promise.resolve().then(i.bind(i,56011))).getColor(e,n),label:r?o[s]:u[s]}))))).reverse()}async function l(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;const a=new n.Z(r),o=(await Promise.resolve().then(i.bind(i,56011))).getOpacity(t,e);return null!=o&&(a.a=o),a}function d(e){let t=!1,i=[],n=[];i=e.map((e=>e.value)),t=e.some((e=>!!e.label)),t&&(n=e.map((e=>e.label)));const r=i[0],s=i[i.length-1];if(null==r&&null==s)return null;const o=t?null:a(i,!1);return i.map(((i,r)=>({value:i,color:c(i,e),label:t?n[r]:o[r]}))).reverse()}function c(e,t){const{startIndex:i,endIndex:r,weight:s}=function(e,t){let i=0,n=t.length-1;return t.some(((t,r)=>e<t.value?(n=r,!0):(i=r,!1))),{startIndex:i,endIndex:n,weight:(e-t[i].value)/(t[n].value-t[i].value)}}(e,t);if(i===r)return t[i].color;const a=n.Z.blendColors(t[i].color,t[r].color,s);return new n.Z(a)}function u(e,t){let i=[];if(e&&"multipart"===e.type)e.colorRamps.reverse().forEach(((r,s)=>{0===s?i.push({value:t.max,color:new n.Z(r.toColor),label:"high"}):i.push({value:null,color:new n.Z(r.toColor),label:""}),s===e.colorRamps.length-1?i.push({value:t.min,color:new n.Z(r.fromColor),label:"low"}):i.push({value:null,color:new n.Z(r.fromColor),label:""})}));else{let r,s;e&&"algorithmic"===e.type?(r=e.fromColor,s=e.toColor):(r=[0,0,0,1],s=[255,255,255,1]),i=[{value:t.max,color:new n.Z(s),label:"high"},{value:t.min,color:new n.Z(r),label:"low"}]}return i}},40778:(e,t,i)=>{i.d(t,{h:()=>r});var n=i(6711);function r(e){if(!e.colorStops)return[];const t=[...e.colorStops].filter((e=>e.color?.a>0));let i=t.length-1;if(t&&t[0]){const e=t[i];e&&1!==e.ratio&&(t.push(new n.Z({ratio:1,color:e.color})),i++)}return t.map(((t,n)=>{let r="";return 0===n?r=e.legendOptions?.minLabel||"low":n===i&&(r=e.legendOptions?.maxLabel||"high"),{color:t.color,label:r,ratio:t.ratio}})).reverse()}},75434:(e,t,i)=>{i.d(t,{Eh:()=>o,MN:()=>d,jb:()=>u,uY:()=>c,y$:()=>p,zZ:()=>a});i(51508);var n=i(76969),r=i(4075),s=i(16851);const a="<",o=">",l=(0,n.Ze)("short-date");function d(e,t,i,s){let d="";0===t?d=`${a} `:t===i&&(d=`${o} `);let c=null;return c=s?(0,n.p6)(e,l):(0,r.WU)(e),d+c}const c=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function u(e){if(!("visualVariables"in e)||!e.visualVariables)return null;const t=e.visualVariables.find((e=>"color"===e.type));if(!t)return null;let n=null,r=null;if(t.stops){if(1===t.stops.length)return t.stops[0].color;n=t.stops[0].value,r=t.stops[t.stops.length-1].value}const s=n+(r-n)/2,{getColor:a}=await Promise.resolve().then(i.bind(i,56011));return a(t,s)}async function p(e,t){const i=e.trailCap,n=e.trailWidth||1,r=t||await u(e)||e.color;return new s.Z({cap:i,color:r,width:n})}},53963:(e,t,i)=>{i.d(t,{Qd:()=>n,o:()=>r});i(78088),i(67005),i(80975);function n(e){return e&&"function"==typeof e.render}function r(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}}}]);
//# sourceMappingURL=3942.c1771ee2.chunk.js.map