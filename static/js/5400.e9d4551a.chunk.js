"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[5400],{95400:(e,t,i)=>{i.r(t),i.d(t,{default:()=>N});var a=i(85580),n=i(72791),l=i(10064),r=i(15075),o=i(585),s=i(78952);function c(){return(0,r.i)()}function d(){return(0,r.l)()}function u(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=[[e.x,e.y]],n=[],l=v(e.spatialReference);let o=0;switch(t){case"dd":o=r.P.geogToDd(l,1,a,i,n);break;case"ddm":o=r.P.geogToDdm(l,1,a,i,n);break;case"dms":o=r.P.geogToDms(l,1,a,i,n);break;default:return console.warn(`invalid format: ${t}`),null}return o?n[0]:null}function v(e){let t=null;if(e||(e=s.Z.WGS84),e.wkid){if(t=r.e.geogcs(e.wkid),!t)throw new l.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!e.wkt)throw new l.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(t=r.e.fromString(r.f.PE_TYPE_GEOGCS,e.wkt),!t)throw new l.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return t}var p=i(79803),f=i(91946),g=i(93655);let h,w;const m=new f.Z({url:"assets/pin.svg",height:36,width:36}),k=new g.Z({id:"coordinate-widget"}),b=e=>{const t=(0,n.useRef)(!1),i=(0,n.useRef)(null),a=(0,n.useRef)(null),[l,f]=(0,n.useState)(!1),[g,b]=(0,n.useState)(!1),x=(0,n.useRef)(null),C=(0,n.useRef)(null),N=[{value:"dd",label:"Decimal Degrees",placeholder:"35.7582196 -78.8079653"},{value:"dms",label:"Degrees Minutes Seconds",placeholder:"35\xb0 45' 29.7116777\"N 78\xb0 48' 31.524W"},{value:"spft",label:"Stateplane Feet",placeholder:"731166.165 2056872.973"},{value:"usng",label:"US National Grid",placeholder:"17S PV 98178 59368"}],[S,y]=(0,n.useState)(N[0]),A=(0,n.useRef)(N[0]),j=(0,n.useCallback)((e=>{f((e=>!e))}),[]),R=(0,n.useCallback)((e=>{b((e=>!e))}),[]),F=(0,n.useCallback)((t=>{var i,a,n;(t.target.active=!t.target.active,t.target.active)?(null===(i=h)||void 0===i||i.remove(),E(e.view,e.clickActivated)):(null===(a=w)||void 0===a||a.remove(),e.view.popup.autoOpenEnabled=!0,null===(n=document.querySelector(".identify-widget"))||void 0===n||n.classList.add("active"),M())}),[]),T=(0,n.useCallback)((e=>{i.current&&(i.current.value="");const t=N.find((t=>t.value===e.target.value));t&&(y(t),A.current.value=t.value)}),[A]),Z=(0,n.useCallback)((t=>{if(""===t.currentTarget.value){const t=e.view.map.findLayerById("coordinate-widget");t&&t.removeAll()}}),[]),$=(0,n.useCallback)((async t=>{var a,n;if(""===(null===(a=i.current)||void 0===a?void 0:a.value))return void(null===(n=i.current)||void 0===n||n.setAttribute("status","invalid"));c()||await d(),p.kR()||await p.zD();let l=new o.Z;if("dd"===A.current.value){var u,f,g;let e=null===(u=i.current)||void 0===u?void 0:u.value.replace(","," ").split(" ");var h;if(2!==(null===(f=e)||void 0===f?void 0:f.length))e=null===(h=i.current)||void 0===h?void 0:h.value.split(", ");if(2===(null===(g=e)||void 0===g?void 0:g.length)){let t=!isNaN(parseFloat(e[1]))&&parseFloat(e[1])<0?parseFloat(e[1]):!isNaN(parseFloat(e[0]))&&parseFloat(e[0])<0?parseFloat(e[0]):NaN,a=!isNaN(parseFloat(e[0]))&&parseFloat(e[0])>0?parseFloat(e[0]):!isNaN(parseFloat(e[1]))&&parseFloat(e[1])>0?parseFloat(e[1]):NaN;var w,b;if(isNaN(t)||isNaN(a))null===(w=i.current)||void 0===w||w.setAttribute("status","invalid");else l=new o.Z({x:t,y:a,spatialReference:{wkid:4326}}),null===(b=i.current)||void 0===b||b.setAttribute("status","valid")}}var x,N,S;"dms"===A.current.value&&(i.current&&(l=function(e,t){const i=[];e=(e=(e=e.replace(/[\u00B0\u00BA]/g,"^")).replace(/\u2032/g,"'")).replace(/\u2033/g,'"');const a=v(t);return r.P.dmsToGeog(a,1,[e],i)?new o.Z(i[0][0],i[0][1],t||s.Z.WGS84):null}(null===(x=i.current)||void 0===x?void 0:x.value.replace(/\s\s+/g," ")),l||null===(N=i.current)||void 0===N||N.setAttribute("status","invalid")));if("spft"===A.current.value){var y,j;const t=null===(y=i.current)||void 0===y?void 0:y.value.replace(/\s\s+/g," ");let a=null===t||void 0===t?void 0:t.split(" ");var R,F;if(2!==(null===(j=a)||void 0===j?void 0:j.length))if(a=null===t||void 0===t?void 0:t.split(","),2!==(null===(R=a)||void 0===R?void 0:R.length))return void(null===(F=i.current)||void 0===F||F.setAttribute("status","invalid"));const n=parseFloat(a[1]),r=parseFloat(a[2]);var T;if(isNaN(n)||isNaN(r))return void(null===(T=i.current)||void 0===T||T.setAttribute("status","invalid"));l=new o.Z({x:n,y:r,spatialReference:{wkid:4326}}),l=p.iV(l,e.view.spatialReference)}(i.current&&"usng"===A.current.value&&(l=function(e,t){const i=[];!t&&/\(.+27/.test(e)&&(t=s.Z.GCS_NAD_1927);const a=v(t);return r.c.usngToGeog(a,1,[e],i)?new o.Z(i[0][0],i[0][1],t||s.Z.WGS84):null}(i.current.value)),e.view.constraints.geometry.contains(l))||(null===(S=C.current)||void 0===S||S.setAttribute("open",!0),setTimeout((()=>{var e;null===(e=C.current)||void 0===e||e.removeAttribute("open")}),3e3));e.view.map.findLayerById("coordinate-widget")||e.view.map.add(k),k.removeAll(),k.add({geometry:l,attributes:null,symbol:m}),e.view.goTo(l)}),[]),G=async t=>{let i;c()||await d(),p.kR()||await p.zD(),i="point"===t.type?t:e.view.toMap({x:t.x,y:t.y});const n=new o.Z({x:i.longitude,y:i.latitude,spatialReference:{wkid:4326}});if("dd"===A.current.value){let e=u(n,"dd",7).replaceAll("078.","78.").split(" ");e[0].includes("S")&&(e[0]=`-${e[0].replace("S","")}`),e[0].includes("N")&&(e[0]=`${e[0].replace("N","")}`),e[1].includes("W")&&(e[1]=`-${e[1].replace("W","")}`),e[1].includes("E")&&(e[1]=`${e[1].replace("N","")}`),a.current.innerHTML=e.join(" ")}else if("dms"===A.current.value){const e=u(n,"dms",7).split(" "),t=`${e[0]}\xb0 ${e[1]}' ${e[2].replace("N",'"N')} ${e[3].substring(1)}\xb0 ${e[4]}' ${e[5].replace("W",'"W')}`;a.current.innerHTML=t}else if("usng"===A.current.value)a.current.innerHTML=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=[[e.x,e.y]],n=[],l=v(e.spatialReference);return r.c.geogToUsng(l,1,a,t,!1,i,n)?n[0]:null}(n,5,!0);else if("spft"===A.current.value){const e=p.iV(i,{wkid:2264});a.current.innerHTML=`${e.y.toFixed(3)}N ${e.x.toFixed(3)}E`}},E=(t,i)=>{var a;i(t),e.view.popup.autoOpenEnabled=!1,null===(a=document.querySelector(".identify-widget"))||void 0===a||a.classList.remove("active"),w=e.view.on("click",(e=>{G(e)}))},M=async()=>{c()||await d(),G(e.view.extent.center),h=e.view.on("pointer-move",(e=>{G(e)}))};return(0,n.useEffect)((()=>{if(!t.current&&e.view)return t.current=!0,e.expand&&(e.expand.hasHandles()||e.expand.watch("expanded",(t=>{var i,a;t?x.current.getAttribute("active")?M():E(e.view,e.clickActivated):(null===(i=h)||void 0===i||i.remove(),null===(a=w)||void 0===a||a.remove())}))),M(),()=>{}}),[]),{loaded:t,settingsClicked:j,showSettings:l,formats:N,formatChanged:T,searchClicked:R,showSearch:g,selectedFormat:S,searchCoordinates:$,coordInput:i,modeClicked:F,coordinateRef:a,modeActionRef:x,noticeRef:C,coordinateInputChanged:Z}};var x=i(80184);function C(e){var t;const{loaded:i,settingsClicked:n,showSettings:l,formats:r,formatChanged:o,searchClicked:s,showSearch:c,selectedFormat:d,searchCoordinates:u,coordInput:v,modeClicked:p,coordinateRef:f,modeActionRef:g,noticeRef:h,coordinateInputChanged:w}=b(e);return(0,x.jsxs)("div",{id:"coordinatesWidget",children:[(0,x.jsx)(a.JA,{scale:"s",ref:h,kind:"danger",closable:!0,children:(0,x.jsx)("div",{slot:"message",children:"Location outside of county"})}),(0,x.jsx)("div",{hidden:!l||void 0,children:(0,x.jsx)(a.ko,{scale:"m",label:"Coordinate Systems",onCalciteSelectChange:o,children:r.map((e=>(0,x.jsx)(a.GB,{value:e.value,children:e.label},e.value)))})}),(0,x.jsx)("div",{hidden:!c||void 0,children:(0,x.jsxs)(a.ZK,{children:[(0,x.jsxs)("div",{className:"coordinate-input",children:[(0,x.jsx)(a.e,{scale:"m",ref:v,id:"coordInput",placeholder:d.placeholder,clearable:!0,onCalciteInputChange:w}),(0,x.jsx)(a.ln,{onClick:u,appearance:"transparent",kind:"neutral",width:"full",scale:"m",iconEnd:"search"})]}),(0,x.jsx)(a.Bi,{hidden:"invalid"!==(null===(t=v.current)||void 0===t?void 0:t.getAttribute("status"))||void 0,status:"invalid",children:"Value is not valid"})]})}),(0,x.jsxs)("div",{className:"coordinates-row",children:[(0,x.jsx)("div",{ref:f,className:"coordinates-text"}),(0,x.jsx)(a.G1,{id:"coordinateSearch",text:"",icon:"search",active:!!c||void 0,onClick:s}),(0,x.jsx)(a.$A,{closeOnClick:!0,label:"Search Coordinates",referenceElement:"coordinateSearch",children:"Search Coordinates"}),(0,x.jsx)(a.G1,{id:"coordinateUnits",text:"",icon:"gear",onClick:n,active:!!l||void 0}),(0,x.jsx)(a.$A,{closeOnClick:!0,label:"Set Units",referenceElement:"coordinateUnits",children:"Set Units"}),(0,x.jsx)(a.G1,{id:"coordinateMode",ref:g,text:"",icon:"pin",onClick:p}),(0,x.jsx)(a.$A,{closeOnClick:!0,label:"Set Mode",referenceElement:"coordinateMode",children:"Set Mode"})]})]})}const N=n.memo(C)}}]);
//# sourceMappingURL=5400.e9d4551a.chunk.js.map