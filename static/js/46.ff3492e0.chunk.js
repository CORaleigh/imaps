(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[46],{1153:function(e,t,a){"use strict";a.r(t),a.d(t,"applyEdits",(function(){return p})),a.d(t,"isEditableLayer",(function(){return d}));var n=a(141),s=a(138),r=a(140),i=a(132),o=a(160),l=a(171),u=a(288);function d(e){var t,a;return!0===(null==e||null==(t=e.capabilities)||null==(a=t.operations)?void 0:a.supportsEditing)&&e&&(!("editingEnabled"in e)||e.editingEnabled)}async function p(e,t,a,s){let r,i;const o={edits:a,result:new Promise(((e,t)=>{r=e,i=t}))};e.emit("apply-edits",o);try{const{results:i,edits:o}=await c(e,t,a,s),l=e=>e.filter((e=>!e.error)).map(n.a),u={edits:o,addedFeatures:l(i.addFeatureResults),updatedFeatures:l(i.updateFeatureResults),deletedFeatures:l(i.deleteFeatureResults),addedAttachments:l(i.addAttachmentResults),updatedAttachments:l(i.updateAttachmentResults),deletedAttachments:l(i.deleteAttachmentResults)};return(u.addedFeatures.length||u.updatedFeatures.length||u.deletedFeatures.length||u.addedAttachments.length||u.updatedAttachments.length||u.deletedAttachments.length)&&e.emit("edits",u),r(u),i}catch(l){throw i(l),l}}async function c(e,t,a,n){if(await e.load(),!function(e){return e&&null!=e.applyEdits}(t))return Promise.reject(new r.a(`${e.type}-layer:no-editing-support`,"Layer source does not support applyEdits capability",{layer:e}));if(!e.editingEnabled)throw new r.a(`${e.type}-layer:editing-disabled`,"Editing is disabled for layer",{layer:e});const i=await function(e,t,a){const n=t&&(t.addFeatures||t.updateFeatures||t.deleteFeatures),i=t&&(t.addAttachments||t.updateAttachments||t.deleteAttachments);if(!t||!n&&!i)throw new r.a(`${e.type}-layer:missing-parameters`,"'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");if(!e.capabilities.data.isVersioned&&a&&a.gdbVersion)throw new r.a(`${e.type}-layer:invalid-parameter`,"'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");if(!e.capabilities.editing.supportsRollbackOnFailure&&a&&a.rollbackOnFailureEnabled)throw new r.a(`${e.type}-layer:invalid-parameter`,"This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");if(!e.capabilities.editing.supportsGlobalId&&a&&a.globalIdUsed)throw new r.a(`${e.type}-layer:invalid-parameter`,"This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");if(!e.capabilities.editing.supportsGlobalId&&i)throw new r.a(`${e.type}-layer:invalid-parameter`,"'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");if((!a||!a.globalIdUsed)&&i)throw new r.a(`${e.type}-layer:invalid-parameter`,"When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true");const l={...t};if(l.addFeatures=t&&o.a.isCollection(t.addFeatures)?t.addFeatures.toArray():l.addFeatures||[],l.updateFeatures=t&&o.a.isCollection(t.updateFeatures)?t.updateFeatures.toArray():l.updateFeatures||[],l.deleteFeatures=t&&o.a.isCollection(t.deleteFeatures)?t.deleteFeatures.toArray():l.deleteFeatures||[],l.addFeatures.length&&!e.capabilities.operations.supportsAdd)throw new r.a(`${e.type}-layer:unsupported-operation`,"Layer does not support adding features.");if(l.updateFeatures.length&&!e.capabilities.operations.supportsUpdate)throw new r.a(`${e.type}-layer:unsupported-operation`,"Layer does not support updating features.");if(l.deleteFeatures.length&&!e.capabilities.operations.supportsDelete)throw new r.a(`${e.type}-layer:unsupported-operation`,"Layer does not support deleting features.");l.addAttachments=l.addAttachments||[],l.updateAttachments=l.updateAttachments||[],l.deleteAttachments=l.deleteAttachments||[],l.addFeatures=l.addFeatures.map(m),l.updateFeatures=l.updateFeatures.map(m);const d=a&&a.globalIdUsed;return l.addFeatures.forEach((t=>function(e,t,a){f(e,t,a)}(t,e,d))),l.updateFeatures.forEach((t=>function(e,t,a){if(f(e,t,a),"geometry"in e&&Object(s.k)(e.geometry)&&!t.capabilities.editing.supportsGeometryUpdate)throw new r.a(`${t.type}-layer:unsupported-operation`,"Layer does not support geometry updates.")}(t,e,d))),l.deleteFeatures.forEach((t=>function(e,t,a){f(e,t,a)}(t,e,d))),l.addAttachments.forEach((t=>h(t,e))),l.updateAttachments.forEach((t=>h(t,e))),async function(e){const t=e.addFeatures,a=e.updateFeatures,n=t.concat(a).map((e=>e.geometry)),s=await Object(u.a)(n),r=t.length,i=a.length;return s.slice(0,r).forEach(((t,a)=>{e.addFeatures[a].geometry=t})),s.slice(r,r+i).forEach(((t,a)=>{e.updateFeatures[a].geometry=t})),e}(l)}(e,a,n);return i.addFeatures.length||i.updateFeatures.length||i.deleteFeatures.length||i.addAttachments.length||i.updateAttachments.length||i.deleteAttachments.length?{edits:i,results:await t.applyEdits(i,n)}:{edits:i,results:{addFeatureResults:[],updateFeatureResults:[],deleteFeatureResults:[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}}function f(e,t,a){if(a){if("attributes"in e&&!e.attributes[t.globalIdField])throw new r.a(`${t.type}-layer:invalid-parameter`,"Feature should have 'globalId' when 'globalIdUsed' is true");if(!("attributes"in e)&&!e.globalId)throw new r.a(`${t.type}-layer:invalid-parameter`,"'globalId' of the feature should be passed when 'globalIdUsed' is true")}if("geometry"in e&&Object(s.k)(e.geometry)){if(e.geometry.hasZ&&!1===t.capabilities.data.supportsZ)throw new r.a(`${t.type}-layer:z-unsupported`,"Layer does not support z values while feature has z values.");if(e.geometry.hasM&&!1===t.capabilities.data.supportsM)throw new r.a(`${t.type}-layer:m-unsupported`,"Layer does not support m values while feature has m values.")}}function h(e,t){const{feature:a,attachment:n}=e;if(!a||"attributes"in a&&!a.attributes[t.globalIdField])throw new r.a(`${t.type}-layer:invalid-parameter`,"Attachment should have reference to a feature with 'globalId'");if(!("attributes"in a)&&!a.globalId)throw new r.a(`${t.type}-layer:invalid-parameter`,"Attachment should have reference to 'globalId' of the parent feature");if(!n.globalId)throw new r.a(`${t.type}-layer:invalid-parameter`,"Attachment should have 'globalId'");if(!n.data&&!n.uploadId)throw new r.a(`${t.type}-layer:invalid-parameter`,"Attachment should have 'data' or 'uploadId'");if(!(n.data instanceof File&&n.data.name)&&!n.name)throw new r.a(`${t.type}-layer:invalid-parameter`,"'name' is required when attachment is specified as Base64 encoded string using 'data'");if(!t.capabilities.editing.supportsUploadWithItemId&&n.uploadId)throw new r.a(`${t.type}-layer:invalid-parameter`,"This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");if("string"==typeof n.data){const e=Object(i.i)(n.data);if(e&&!e.isBase64)throw new r.a(`${t.type}-layer:invalid-parameter`,"Attachment 'data' should be a Blob, File or Base64 encoded string")}}function m(e){const t=new l.a;return e.attributes||(e.attributes={}),t.geometry=e.geometry,t.attributes=e.attributes,t}},288:function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return w}));var n=a(191),s=a(138),r=a(130),i=a(140),o=a(156),l=a(194),u=a(174),d=a(177),p=a(296),c=a(132),f=a(147),h=(a(150),a(151));async function m(e,t,a){const n="string"==typeof e?Object(c.J)(e):e,s=t[0].spatialReference,r=Object(f.c)(t[0]),i={...a,query:{...n.query,f:"json",sr:s.wkid?s.wkid:JSON.stringify(s),geometries:JSON.stringify((o=t,{geometryType:Object(f.c)(o[0]),geometries:o.map((e=>e.toJSON()))}))}};var o;return function(e,t,a){const n=Object(f.b)(t);return e.map((e=>{const t=n.fromJSON(e);return t.spatialReference=a,t}))}((await Object(h.default)(n.path+"/simplify",i)).data,r,s)}const y=r.a.getLogger("esri.geometry.support.normalizeUtils");function g(e){return"polygon"===e[0].type}function b(e){return"polyline"===e[0].type}function w(e,t){if(!(e instanceof d.a||e instanceof u.a)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw y.error(e),new i.a(e)}const a=Object(p.b)(e),n=[];for(const s of a){const e=[];n.push(e),e.push([s[0][0],s[0][1]]);for(let a=0;a<s.length-1;a++){const n=s[a][0],r=s[a][1],i=s[a+1][0],o=s[a+1][1],l=Math.sqrt((i-n)*(i-n)+(o-r)*(o-r)),u=(o-r)/l,d=(i-n)/l,p=l/t;if(p>1){for(let o=1;o<=p-1;o++){const a=o*t,s=d*a+n,i=u*a+r;e.push([s,i])}const a=(l+Math.floor(p-1)*t)/2,s=d*a+n,i=u*a+r;e.push([s,i])}e.push([i,o])}}return function(e){return"polygon"===e.type}(e)?new u.a({rings:n,spatialReference:e.spatialReference}):new d.a({paths:n,spatialReference:e.spatialReference})}function F(e,t,a){if(t){const t=w(e,1e6);e=Object(l.e)(t,!0)}return a&&(e=Object(p.e)(e,a)),e}function A(e,t,a){if(Array.isArray(e)){const n=e[0];if(n>t){const a=Object(p.d)(n,t);e[0]=n+a*(-2*t)}else if(n<a){const t=Object(p.d)(n,a);e[0]=n+t*(-2*a)}}else{const n=e.x;if(n>t){const a=Object(p.d)(n,t);e=e.clone().offset(a*(-2*t),0)}else if(n<a){const t=Object(p.d)(n,a);e=e.clone().offset(t*(-2*a),0)}}return e}async function O(e,t,a){if(!Array.isArray(e))return O([e],t);const r=t?t.url:n.a.geometryServiceUrl;let i,y,w,j,v,I,R,x,$=0;const E=[],L=[];for(const n of e)if(Object(s.j)(n))L.push(n);else if(i||(i=n.spatialReference,y=Object(o.d)(i),w=i.isWebMercator,I=w?102100:4326,j=p.a[I].maxX,v=p.a[I].minX,R=p.a[I].plus180Line,x=p.a[I].minus180Line),y)if("mesh"===n.type)L.push(n);else if("point"===n.type)L.push(A(n.clone(),j,v));else if("multipoint"===n.type){const e=n.clone();e.points=e.points.map((e=>A(e,j,v))),L.push(e)}else if("extent"===n.type){const e=n.clone()._normalize(!1,!1,y);L.push(e.rings?new u.a(e):e)}else if(n.extent){const e=n.extent,t=Object(p.d)(e.xmin,v)*(2*j);let a=0===t?n.clone():Object(p.e)(n.clone(),t);e.offset(t,0),e.intersects(R)&&e.xmax!==j?($=e.xmax>$?e.xmax:$,a=F(a,w),E.push(a),L.push("cut")):e.intersects(x)&&e.xmin!==v?($=e.xmax*(2*j)>$?e.xmax*(2*j):$,a=F(a,w,360),E.push(a),L.push("cut")):L.push(a)}else L.push(n.clone());else L.push(n);let S=Object(p.d)($,j),U=-90;const k=S,J=new d.a;for(;S>0;){const e=360*S-180;J.addPath([[e,U],[e,-1*U]]),U*=-1,S--}if(E.length>0&&k>0){const t=function(e,t){let a=-1;for(let n=0;n<t.cutIndexes.length;n++){const s=t.cutIndexes[n],r=t.geometries[n],i=Object(p.b)(r);for(let e=0;e<i.length;e++){const t=i[e];t.some((a=>{if(a[0]<180)return!0;{let a=0;for(let e=0;e<t.length;e++){const n=t[e][0];a=n>a?n:a}a=Number(a.toFixed(9));const n=-360*Object(p.d)(a,180);for(let s=0;s<t.length;s++){const t=r.getPoint(e,s);r.setPoint(e,s,t.clone().offset(n,0))}return!0}}))}if(s===a){if(g(e))for(const t of Object(p.b)(r))e[s]=e[s].addRing(t);else if(b(e))for(const t of Object(p.b)(r))e[s]=e[s].addPath(t)}else a=s,e[s]=r}return e}(E,await async function(e,t,a,n){const s="string"==typeof e?Object(c.J)(e):e,r=t[0].spatialReference,i={...n,query:{...s.query,f:"json",sr:JSON.stringify(r),target:JSON.stringify({geometryType:Object(f.c)(t[0]),geometries:t}),cutter:JSON.stringify(a)}},o=await Object(h.default)(s.path+"/cut",i),{cutIndexes:l,geometries:u=[]}=o.data;return{cutIndexes:l,geometries:u.map((e=>{const t=Object(f.a)(e);return t.spatialReference=r,t}))}}(r,E,J,a)),n=[],i=[];for(let a=0;a<L.length;a++){const r=L[a];if("cut"!==r)i.push(r);else{const r=t.shift(),o=e[a];Object(s.k)(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&r.rings.length>=o.rings.length?(n.push(r),i.push("simplify")):i.push(w?Object(l.b)(r):r)}}if(!n.length)return i;const o=await m(r,n,a),u=[];for(let e=0;e<i.length;e++){const t=i[e];"simplify"!==t?u.push(t):u.push(w?Object(l.b)(o.shift()):o.shift())}return u}const M=[];for(let n=0;n<L.length;n++){const e=L[n];if("cut"!==e)M.push(e);else{const e=E.shift();M.push(!0===w?Object(l.b)(e):e)}}return Promise.resolve(M)}function j(e,t){const a=Object(o.d)(t);if(a){const[t,n]=a.valid,s=n-t;if(e<t)for(;e<t;)e+=s;if(e>n)for(;e>n;)e-=s}return e}},296:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l}));var n=a(144),s=a(177),r=a(147);const i={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new s.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:n.a.WebMercator}),minus180Line:new s.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:n.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new s.a({paths:[[[180,-180],[180,180]]],spatialReference:n.a.WGS84}),minus180Line:new s.a({paths:[[[-180,-180],[-180,180]]],spatialReference:n.a.WGS84})}};function o(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const a=u(e);for(const n of a)for(const e of n)e[0]+=t;return e}function u(e){return Object(r.g)(e)?e.rings:e.paths}function d(e){const t=(null==e?void 0:e.isWebMercator)?102100:4326;return[i[t].minX,i[t].maxX]}}}]);
//# sourceMappingURL=46.ff3492e0.chunk.js.map