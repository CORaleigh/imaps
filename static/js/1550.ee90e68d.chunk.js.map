{"version":3,"file":"static/js/1550.ee90e68d.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/node_modules/@stencil/core/internal/client|lazy|/^/.//.*/.entry/.js.*$/|include: //.entry/.js$/|exclude: //.system/.entry/.js$/|groupOptions: {}|namespace object","Components/Basemaps/utils/basemaps.ts","Components/Basemaps/Basemaps.tsx"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(() => {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = () => ([]);\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 67435;\nmodule.exports = webpackEmptyAsyncContext;","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nlet stateHandle: __esri.WatchHandle;\nlet lastInRaleigh = false;\nlet boundary: __esri.Geometry;\nimport esriRequest from '@arcgis/core/request';\nimport Polygon from '@arcgis/core/geometry/Polygon';\nimport * as geometryEngine from '@arcgis/core/geometry/geometryEngine';\nimport * as type from '@arcgis/core/smartMapping/symbology/type';\n//import Collection from '@arcgis/core/core/Collection';\n//import BasemapGalleryItem from '@arcgis/core/widgets/BasemapGallery/support/BasemapGalleryItem';\nexport const createAlert = () => {\n  const alert = document.createElement('calcite-alert');\n  alert.setAttribute('auto-dismiss', '');\n  alert.setAttribute('auto-dismiss-duration', 'fast');\n  alert.setAttribute('scale', 'm');\n  alert.setAttribute('color', 'yellow');\n  alert.id = 'basemapAlert';\n  alert.classList.add(document.body.classList.contains('dark') ? 'calcite-theme-dark' : 'calcite-theme-light');\n  const title = document.createElement('div');\n  title.slot = 'title';\n  title.textContent = 'Image basemap changed';\n  const message = document.createElement('div');\n  message.slot = 'message';\n  message.textContent = 'Image basemap changed';\n  alert.appendChild(title);\n  alert.appendChild(message);\n  document.body.appendChild(alert);\n};\n\nexport const basemapChanged = (activeBasemap: __esri.Basemap, view: __esri.MapView, selectedTab: string) => {\n  const scheme = type.getSchemes({ basemap: activeBasemap, geometryType: 'polygon' });\n  const propertyLayer = view.map.allLayers.find((layer) => {\n    return layer.type === 'feature' && layer.title.startsWith('Property');\n  }) as __esri.FeatureLayer;\n  const renderer = (propertyLayer.renderer as __esri.SimpleRenderer).clone();\n  if (scheme.basemapTheme === 'light') {\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.r = 0;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.g = 0;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.b = 0;\n  }\n  if (\n    scheme.basemapTheme === 'dark' ||\n    selectedTab === 'imagery' ||\n    activeBasemap.title.toLocaleLowerCase().includes('dark')\n  ) {\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.r = 255;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.g = 255;\n    (renderer.symbol as __esri.SimpleFillSymbol).outline.color.b = 255;\n  }\n  propertyLayer.renderer = renderer;\n  //propertyLayer.refresh();\n};\n// export const addSnippet = (items: Collection<BasemapGalleryItem>) => {\n//   items.forEach((item, i) => {\n//     if (item.basemap.portalItem.snippet) {\n//       const listItem = document.querySelectorAll('.esri-basemap-gallery__item')[i];\n//       const title = listItem?.querySelector('.esri-basemap-gallery__item-title');\n//       if (title) {\n//         const div = document.createElement('div');\n//         div.append(title);\n//         const summary = document.createElement('div');\n//         summary.textContent = item.basemap.portalItem.snippet;\n//         summary.className = 'esri-basemap-gallery__item-snippet';\n//         div.append(summary);\n//         listItem.append(div);\n//       }\n//     }\n//   });\n// };\nlet handle: __esri.WatchHandle;\nexport const basemapSelected = (\n  value: string,\n  view: __esri.MapView,\n  basemapGallery: __esri.BasemapGallery,\n  defaultId: string,\n  imageryId: string,\n): void => {\n  const query: any = {};\n  if (!boundary) {\n    getBoundary(view).then((result) => {\n      boundary = result;\n      const inRaleigh = geometryEngine.contains(boundary, view.center);\n      if (inRaleigh != lastInRaleigh) {\n        lastInRaleigh = inRaleigh;\n      }\n      (basemapGallery.source as __esri.PortalBasemapsSource).refresh();\n    });\n  }\n\n  //selected = value;\n\n  if (value === 'imagery') {\n    handle = view.watch('stationary', (stationary: boolean) => {\n      if (stationary) {\n        const inRaleigh = geometryEngine.contains(boundary, view.center);\n        if (inRaleigh != lastInRaleigh) {\n          lastInRaleigh = inRaleigh;\n          (basemapGallery.source as __esri.PortalBasemapsSource).refresh();\n        }\n      }\n    });\n    document.querySelector('.basemaps-base .esri-button-menu')?.removeAttribute('hidden');\n    query.id = imageryId;\n    (basemapGallery.source as __esri.PortalBasemapsSource).filterFunction = filterBasemaps;\n    (basemapGallery.source as __esri.PortalBasemapsSource).updateBasemapsCallback = (items: __esri.Basemap[]) => {\n      return items.reverse();\n    };\n    setTimeout(() => {\n      stateHandle = (basemapGallery.source as __esri.PortalBasemapsSource).watch('state', (state) => {\n        value = (document.querySelector('#basemap-radio calcite-radio-group-item[checked]') as any)?.value;\n\n        if (state === 'ready' && value === 'imagery') {\n          const basemap = basemapGallery.source.basemaps.find((basemap) => {\n            return basemap.portalItem.title === view.map.basemap.title;\n          });\n          if (!basemap && !lastInRaleigh && view.map.basemap.portalItem) {\n            setTimeout(() => {\n              const message = document.querySelector('#basemapAlert div[slot=\"message\"]') as any;\n              message.textContent = `${\n                view.map.basemap.portalItem.title\n              } imagery not available outside Raleigh, switching to ${\n                basemapGallery.source.basemaps.getItemAt(0).portalItem.title\n              }`;\n              view.map.basemap = basemapGallery.source.basemaps.getItemAt(0);\n              console.log(value);\n              document.querySelector('calcite-alert')?.setAttribute('active', '');\n            });\n          }\n        }\n      });\n    }, 1000);\n  } else {\n    document.querySelector('.basemaps-base .esri-button-menu')?.setAttribute('hidden', '');\n    if (handle) {\n      handle.remove();\n    }\n    stateHandle?.remove();\n    (basemapGallery.source as __esri.PortalBasemapsSource).filterFunction = () => {\n      return true;\n    };\n    (basemapGallery.source as __esri.PortalBasemapsSource).updateBasemapsCallback = (items: __esri.Basemap[]) => {\n      return items;\n    };\n  }\n  if (value === 'basemaps') {\n    document.querySelector('.basemaps-base .esri-button-menu')?.removeAttribute('hidden');\n    query.id = defaultId;\n  }\n  (basemapGallery.source as __esri.PortalBasemapsSource).query = query;\n};\n\nexport const filterBasemaps = (item: __esri.Basemap): boolean => {\n  if (lastInRaleigh) {\n    return true;\n  } else {\n    return item.portalItem.tags.includes('countywide');\n  }\n};\n\nexport const getBoundary = (view: __esri.MapView): Promise<__esri.Geometry> => {\n  return new Promise((resolve) => {\n    esriRequest(\n      'https://maps.raleighnc.gov/images/rest/services/Orthos2020/ImageServer/queryBoundary?outSR=102100&f=json',\n      { responseType: 'json' },\n    ).then((response) => {\n      const geometry: Polygon = Polygon.fromJSON(response.data.shape);\n      lastInRaleigh = geometryEngine.contains(geometry, view.center);\n      resolve(geometry);\n    });\n  });\n};\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport React, { useEffect, useRef } from 'react';\nimport BasemapGallery from '@arcgis/core/widgets/BasemapGallery';\nimport { basemapChanged, basemapSelected, createAlert } from './utils/basemaps';\nimport './Basemaps.scss';\nexport const Basemaps = (props: any) => {\n  const ref = useRef<HTMLDivElement>(null);\n  let selectedTab = 'basemaps';\n  //const eventId = 0;\n  useEffect(() => {\n    const basemapGallery = new BasemapGallery({\n      container: ref.current as HTMLDivElement,\n      view: props.view,\n      source: { query: { id: 'f6329364e80c438a958ce74aadc3a89f' } },\n    });\n\n    createAlert();\n    document?.querySelector('#basemap-radio')?.addEventListener('calciteRadioGroupChange', (event: any) => {\n      //document?.querySelector('calcite-combobox')?.addEventListener('calciteComboboxItemChange', (event: any) => {\n      const tab = (event as any).detail; //.value;\n      //setSelectedTab(tab);\n      selectedTab = tab;\n\n      basemapSelected(tab, props.view, basemapGallery, props.default, props.imagery);\n      // setTimeout(() => {\n      //   if (eventId === 1) {\n      //     addSnippet(basemapGallery.viewModel.items);\n      //   }\n      //   if (eventId === 0) {\n      //     eventId += 1;\n      //   } else {\n      //     eventId = 0;\n      //   }\n      // }, 1000);\n    });\n    basemapGallery.watch('activeBasemap', (activeBasemap: __esri.Basemap) => {\n      basemapChanged(activeBasemap, props.view, selectedTab);\n    });\n    // setTimeout(() => {\n    //   console.log(basemapGallery.viewModel.items);\n    //   addSnippet(basemapGallery.viewModel.items);\n    // }, 1000);\n  }, []); // only after initial render\n  return (\n    <div className=\"panel\">\n      <calcite-radio-group id=\"basemap-radio\" appearance=\"solid\" layout=\"horizontal\" scale=\"m\" width=\"full\">\n        <calcite-radio-group-item value=\"basemaps\" checked>\n          Streets\n        </calcite-radio-group-item>\n        <calcite-radio-group-item value=\"imagery\">Imagery</calcite-radio-group-item>\n        <calcite-radio-group-item value=\"esri\">Esri</calcite-radio-group-item>\n      </calcite-radio-group>\n      {/* <calcite-combobox\n        label=\"demo combobox\"\n        selection-mode=\"single\"\n        allow-custom-values=\"false\"\n        scale=\"m\"\n        max-items=\"0\"\n        dir=\"ltr\"\n        calcite-hydrated=\"\"\n      >\n        <calcite-combobox-item\n          icon=\"layer-basemap\"\n          value=\"basemaps\"\n          text-label=\"Basemaps\"\n          aria-hidden=\"\"\n          dir=\"ltr\"\n          scale=\"m\"\n          tabindex=\"-1\"\n          calcite-hydrated=\"\"\n          key=\"basemaps\"\n          selected\n        ></calcite-combobox-item>\n        <calcite-combobox-item\n          icon=\"image-layer\"\n          value=\"imagery\"\n          key=\"imagery\"\n          text-label=\"Imagery\"\n          aria-hidden=\"\"\n          dir=\"ltr\"\n          scale=\"m\"\n          tabindex=\"-1\"\n          calcite-hydrated=\"\"\n        ></calcite-combobox-item>\n        <calcite-combobox-item\n          icon=\"layer-basemap\"\n          value=\"esri\"\n          text-label=\"Esri Basemaps\"\n          aria-hidden=\"\"\n          dir=\"ltr\"\n          scale=\"m\"\n          tabindex=\"-1\"\n          calcite-hydrated=\"\"\n          key=\"esri\"\n        ></calcite-combobox-item>\n      </calcite-combobox> */}\n      <div ref={ref}></div>\n    </div>\n  );\n};\nexport default Basemaps;\n"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","id","module","exports","stateHandle","boundary","lastInRaleigh","handle","filterBasemaps","item","portalItem","tags","includes","getBoundary","view","esriRequest","responseType","response","geometry","Polygon","data","shape","geometryEngine","contains","center","Basemaps","props","ref","useRef","selectedTab","useEffect","basemapGallery","BasemapGallery","container","current","source","query","alert","document","createElement","setAttribute","classList","add","body","title","slot","textContent","message","appendChild","createAlert","querySelector","addEventListener","event","tab","detail","value","defaultId","imageryId","result","inRaleigh","refresh","watch","stationary","removeAttribute","filterFunction","updateBasemapsCallback","items","reverse","setTimeout","state","basemaps","find","basemap","map","getItemAt","console","log","remove","basemapSelected","default","imagery","activeBasemap","scheme","type","geometryType","propertyLayer","allLayers","layer","startsWith","renderer","clone","basemapTheme","symbol","outline","color","r","g","b","toLocaleLowerCase","basemapChanged","className","appearance","layout","scale","width","checked"],"sourceRoot":""}