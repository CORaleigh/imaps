(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[95,164],{1047:function(e,t,r){"use strict";var i=r(82),a=(r(80),r(81),r(88),r(85)),n=r(84),s=(r(83),r(86),r(87),r(167)),o=class extends s.a{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){var e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}};Object(i.a)([Object(a.b)({readOnly:!0})],o.prototype,"supportsTileUpdates",null),Object(i.a)([Object(a.b)({constructOnly:!0})],o.prototype,"remoteClient",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],o.prototype,"service",void 0),Object(i.a)([Object(a.b)()],o.prototype,"spatialReference",null),Object(i.a)([Object(a.b)({constructOnly:!0})],o.prototype,"tileInfo",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],o.prototype,"tileStore",void 0);var l=o=Object(i.a)([Object(n.a)("esri.views.2d.layers.features.processors.BaseProcessor")],o);t.a=l},1205:function(e,t,r){"use strict";r.r(t);var i=r(7),a=r(82),n=r(80),s=r(89),o=r(81),l=(r(88),r(85),r(84)),c=(r(93),r(83),r(86),r(87),r(94)),u=r(99),h=r(317),f=r(122),d=r(365),v=r(955),p=r(151),m=r(519),y=r(366),b=r(561),_=r(562),x=r(431),g=r(452),O=r(557),j=r(1047);function M(e){var t=e.message,r={message:{data:{},tileKey:t.tileKey},transferList:new Array};for(var i in t.data){var a=t.data[i];if(r.message.data[i]=null,Object(s.k)(a)){var n=a.stride,o=a.indices.slice(0),l=a.vertices.slice(0),c=a.records.slice(0),u={stride:n,indices:o,vertices:l,records:c,metrics:Object(s.b)(a.metrics,(e=>e.slice(0)))};r.transferList.push(o,l,c),r.message.data[i]=u}}return r}o.a.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");var S=class extends j.a{constructor(){super(...arguments),this.type="symbol",this._matchers={feature:null,aggregate:null},this._bufferData=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}destroy(){}get supportsTileUpdates(){return!0}update(e,t){var r=this;return Object(i.a)((function*(){var i=t.schema.processors[0];if("symbol"===i.type){var a=Object(h.a)(r._schema,i);Object(h.b)(a,"mesh")&&(Object(n.a)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",a),e.mesh=!0,e.why.mesh.push("Symbology changed"),r._schema=i,r._factory=r._createFactory(i),r._factory.update(i,r.tileStore.tileScheme.tileInfo))}}))()}onTileMessage(e,t,r,i){return Object(c.u)(i),this._onTileData(e,t,r,i)}onTileClear(e){return this._bufferData.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{clear:!0}})}onTileError(e,t,r){var i=r.signal,a={tileKey:e.id,error:t};return this.remoteClient.invoke("tileRenderer.onTileError",a,{signal:i})}onTileUpdate(e){var t=this;for(var r of e.removed)this._bufferData.has(r.key.id)&&(this._bufferData.get(r.key.id).forEach((e=>{var t=new Set;Object(p.g)((r=>{var i=e.message.data[r];if(Object(s.k)(i))for(var a=m.a.from(i.records).getCursor();a.next();)t.add(a.id)}));var r=e.message.tileKey;return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:r,data:{type:"update",addOrUpdate:null}})})),this._bufferData.delete(r.key.id));var i=function(e){t._bufferData.forEach((r=>{for(var i of r)i.message.tileKey===e.id&&t._updateTileMesh("append",e,M(i),[],!1,!1,null)}))};for(var a of e.added)i(a)}_addBufferData(e,t){this._bufferData.has(e)||this._bufferData.set(e,[]),this._bufferData.get(e).push(M(t))}_createFactory(e){var{geometryType:t,objectIdField:r,fields:i}=this.service,a={geometryType:t,fields:i,spatialReference:u.a.fromJSON(this.spatialReference)},n=new g.a(((e,t)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",e,t)),!1),{matcher:o,aggregateMatcher:l}=e.mesh;return this._store=n,this._matchers.feature=Object(_.a)(o,n,a),this._matchers.aggregate=Object(s.b)(l,(e=>Object(_.a)(e,n,a))),new O.a(t,r,n)}_onTileData(e,t,r,a){var n=this;return Object(i.a)((function*(){var{type:i,addOrUpdate:o,remove:l}=t,u=t.end;if(!o){var h={type:i,addOrUpdate:null,remove:l,clear:!1,end:u};return n.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:h},a)}var f=n._processFeatures(e,o,r,a);try{var d=yield f;if(Object(s.j)(d)){var v={type:i,addOrUpdate:null,remove:l,clear:!1,end:u};return n.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:v},a)}for(var p of d)e.key.id!==p.message.tileKey&&n._addBufferData(e.key.id,p);yield Object(c.b)(d.map((r=>{var s=e.key.id===r.message.tileKey,o=s?t.remove:[],l=s&&t.end;return n._updateTileMesh(i,e,r,o,l,t.clear,a.signal)})))}catch(m){n._handleError(e,m,a)}}))()}_updateTileMesh(e,t,r,a,n,o,l){var u=this;return Object(i.a)((function*(){var i=e,o=r.message.tileKey;o!==t.key.id&&(n=!1);var h=Object(s.b)(r,(e=>e.message)),f=Object(s.b)(r,(e=>e.transferList))||[],d={type:i,addOrUpdate:h,remove:a,clear:!1,end:n},v={transferList:Object(s.q)(f)||[],signal:l};return Object(c.u)(v),u.remoteClient.invoke("tileRenderer.onTileData",{tileKey:o,data:d},v)}))()}_processFeatures(e,t,r,a){var n=this;return Object(i.a)((function*(){if(Object(s.j)(t)||!t.hasFeatures)return null;var i={transform:e.transform,hasZ:!1,hasM:!1},o=n._factory,l={viewingMode:"",scale:e.scale},u=yield n._matchers.feature,h=yield n._matchers.aggregate;Object(c.u)(a);var f=n._getLabelInfos(e,t);return yield o.analyze(t.getCursor(),u,h,i,l),Object(c.u)(a),n._writeFeatureSet(e,t,i,f,o,r)}))()}_writeFeatureSet(e,t,r,i,a,n){for(var o=t.getApproximateSize(),l="simple"===this._schema.mesh.matcher.type&&this._schema.mesh.matcher.isDotDensity,c=new b.a(e.key.id,{features:o,records:o,metrics:0},l,n,!0),u={viewingMode:"",scale:e.scale},h=t.getCursor();h.next();)try{var f=h.getDisplayId(),d=Object(s.k)(i)?i.get(f):null;a.writeCursor(c,h,r,u,e.level,d)}catch(p){}var v=e.tileInfoView.tileInfo.isWrappable;return c.serialize(v)}_handleError(e,t,r){if(!Object(c.m)(t)){var i={tileKey:e.id,error:t.message};return this.remoteClient.invoke("tileRenderer.onTileError",i,{signal:r.signal})}}_getLabelInfos(e,t){var r=this,i=this._schema.mesh.labels,a=Object(s.b)(i,(t=>t.filter((t=>function(e,t){return(!e.minScale||e.minScale>=t)&&(!e.maxScale||e.maxScale<=t)}(t,e.scale)))));if(Object(s.j)(a)||0===a.length)return null;for(var n=new Map,o=(new v.b(f.e),t.getCursor()),l=function(){var e=o.getDisplayId(),t=[],i=Object(y.c)(e),s=i&&1!==o.readAttribute("cluster_count")?"aggregate":"feature",l=function(a){if(a.target!==s)return"continue";var n=o.getStorage(),l=i&&"feature"===s?n.getComputedStringAtIndex(o.readAttribute("referenceId"),a.fieldIndex):n.getComputedStringAtIndex(e,a.fieldIndex);if(!l)return"continue";var c=Object(d.a)(l.toString()),u=c[0],h=c[1];r._store.getMosaicItem(a.symbol,Object(x.a)(u)).then((e=>{t[a.index]={glyphs:e.glyphMosaicItems,rtl:h,index:a.index}}))};for(var c of a)l(c);n.set(e,t)};o.next();)l();return n}_shouldDiscard(e,t){switch(this.service.geometryType){case"esriGeometryPoint":var r=t.readLegacyPointGeometry();return!r||e.checkOverlap(r.x,r.y);case"esriGeometryPolygon":var i=t.readLegacyCentroid();return!i||e.checkOverlap(i.x,i.y);default:return!1}}_markUsed(e,t){switch(this.service.geometryType){case"esriGeometryPoint":var{x:r,y:i}=t.readLegacyPointGeometry();return e.markUsed(r,i);case"esriGeometryPolygon":var{x:a,y:n}=t.readLegacyCentroid();return e.markUsed(a,n)}}},w=S=Object(a.a)([Object(l.a)("esri.views.2d.layers.features.processors.SymbolProcessor")],S);t.default=w},135:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return C})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return _})),r.d(t,"f",(function(){return g})),r.d(t,"g",(function(){return x})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return v})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return S})),r.d(t,"l",(function(){return m})),r.d(t,"m",(function(){return O})),r.d(t,"n",(function(){return b})),r.d(t,"o",(function(){return d})),r.d(t,"p",(function(){return y})),r.d(t,"q",(function(){return M})),r.d(t,"r",(function(){return n})),r.d(t,"s",(function(){return j})),r.d(t,"t",(function(){return u})),r.d(t,"u",(function(){return h}));var i=r(184);function a(e,t){return e[0]=t[0],e[1]=t[1],e}function n(e,t,r){return e[0]=t,e[1]=r,e}function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function l(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function c(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function u(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function h(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function f(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function d(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function v(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function p(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function m(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function y(e){var t=e[0],r=e[1];return t*t+r*r}function b(e,t){return e[0]=-t[0],e[1]=-t[1],e}function _(e,t){var r=t[0],i=t[1],a=r*r+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a),e}function x(e,t){return e[0]*t[0]+e[1]*t[1]}function g(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function O(e,t,r,i){var a=t[0],n=t[1];return e[0]=a+i*(r[0]-a),e[1]=n+i*(r[1]-n),e}function j(e,t,r){var i=t[0],a=t[1];return e[0]=r[0]*i+r[2]*a+r[4],e[1]=r[1]*i+r[3]*a+r[5],e}function M(e,t,r,i){var a=t[0]-r[0],n=t[1]-r[1],s=Math.sin(i),o=Math.cos(i);return e[0]=a*o-n*s+r[0],e[1]=a*s+n*o+r[1],e}function S(e,t){return e[0]===t[0]&&e[1]===t[1]}var w=m,C=o,I=l,k=c,T=v,E=p,P=y;Object.freeze({__proto__:null,copy:a,set:n,add:s,subtract:o,multiply:l,divide:c,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:u,max:h,round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:f,scaleAndAdd:d,distance:v,squaredDistance:p,length:m,squaredLength:y,negate:b,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:_,dot:x,cross:g,lerp:O,random:function(e,t){t=t||1;var r=2*Object(i.b)()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},transformMat2:function(e,t,r){var i=t[0],a=t[1];return e[0]=r[0]*i+r[2]*a,e[1]=r[1]*i+r[3]*a,e},transformMat2d:j,transformMat3:function(e,t,r){var i=t[0],a=t[1];return e[0]=r[0]*i+r[3]*a+r[6],e[1]=r[1]*i+r[4]*a+r[7],e},transformMat4:function(e,t,r){var i=t[0],a=t[1];return e[0]=r[0]*i+r[4]*a+r[12],e[1]=r[1]*i+r[5]*a+r[13],e},rotate:M,angle:function(e,t){var r=e[0],i=e[1],a=t[0],n=t[1],s=r*r+i*i;s>0&&(s=1/Math.sqrt(s));var o=a*a+n*n;o>0&&(o=1/Math.sqrt(o));var l=(r*a+i*n)*s*o;return l>1?0:l<-1?Math.PI:Math.acos(l)},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:S,equals:function(e,t){var r=e[0],a=e[1],n=t[0],s=t[1];return Math.abs(r-n)<=i.a*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(a-s)<=i.a*Math.max(1,Math.abs(a),Math.abs(s))},len:w,sub:C,mul:I,div:k,dist:T,sqrDist:E,sqrLen:P})},156:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return y})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return c}));var i=r(91),a=r(93),n=r(127),s=r(633);function o(e,t=!1){var r=n.e.SIZE_FIELD_STOPS|n.e.SIZE_MINMAX_VALUE|n.e.SIZE_SCALE_STOPS|n.e.SIZE_UNIT_VALUE,i=(e&(n.f.FIELD_TARGETS_OUTLINE|n.f.MINMAX_TARGETS_OUTLINE|n.f.SCALE_TARGETS_OUTLINE|n.f.UNIT_TARGETS_OUTLINE))>>>4;return t?r&i:r&~i}function l(e,t,r,i,a){switch(e){case n.d.FILL:return p.from(t,i);case n.d.LINE:return y.from(t,r);case n.d.MARKER:return m.from(t);case n.d.TEXT:return b.from(t);case n.d.LABEL:return _.from(t,a);default:throw new Error("Unable to createMaterialKey for unknown geometryType ".concat(e))}}function c(e){switch(u.load(e).geometryType){case n.d.MARKER:return new m(e);case n.d.FILL:return new p(e);case n.d.LINE:return new y(e);case n.d.TEXT:return new b(e);case n.d.LABEL:return new _(e)}}class u{constructor(e){this._data=0,this._data=e}static load(e){var t=this.shared;return t.data=e,t}set data(e){this._data=e}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(e){this.setBits(e,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(e){this.setBit(20,e)}get sdf(){return!!this.bit(11)}set sdf(e){this.setBit(11,e)}get pattern(){return!!this.bit(12)}set pattern(e){this.setBit(12,e)}get textureBinding(){return this.bits(0,8)}set textureBinding(e){this.setBits(e,0,8)}get geometryTypeString(){switch(this.geometryType){case n.d.FILL:return"fill";case n.d.MARKER:return"marker";case n.d.LINE:return"line";case n.d.TEXT:return"text";case n.d.LABEL:return"label";default:throw new a.a("Unable to handle unknown geometryType: ".concat(this.geometryType))}}setBit(e,t){var r=1<<e;t?this._data|=r:this._data&=~r}bit(e){return(this._data&1<<e)>>e}setBits(e,t,r){for(var i=t,a=0;i<r;i++,a++)this.setBit(i,0!=(e&1<<a))}bits(e,t){for(var r=0,i=e,a=0;i<t;i++,a++)r|=this.bit(i)<<a;return r}hasVV(){return!1}setVV(e,t){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}getVariationHash(){return this._data&~(7&this.textureBinding)}}u.shared=new u(0);var h=e=>class extends e{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(e){this.setBit(16,e)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(e){this.setBit(17,e)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(e){this.setBit(18,e)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(e){this.setBit(19,e)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(e,t){super.setVV(e,t);var r=o(e,t)&e;this.vvSizeMinMaxValue=!!(r&n.e.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(r&n.e.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(r&n.e.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(r&n.e.SIZE_SCALE_STOPS)}},f=e=>class extends e{get vvRotation(){return 0!==this.bit(15)}set vvRotation(e){this.setBit(15,e)}hasVV(){return super.hasVV()||this.vvRotation}setVV(e,t){super.setVV(e,t),this.vvRotation=!t&&!!(e&n.e.ROTATION)}},d=e=>class extends e{get vvColor(){return 0!==this.bit(13)}set vvColor(e){this.setBit(13,e)}hasVV(){return super.hasVV()||this.vvColor}setVV(e,t){super.setVV(e,t),this.vvColor=!t&&!!(e&n.e.COLOR)}},v=e=>class extends e{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(e){this.setBit(14,e)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(e,t){super.setVV(e,t),this.vvOpacity=!t&&!!(e&n.e.OPACITY)}};class p extends(d(v(u))){static load(e){var t=this.shared;return t.data=e,t}static from(e,t){var r=this.load(0);return r.geometryType=n.d.FILL,t?r.dotDensity=!0:r.setVV(e,!1),r.data}getVariation(){return Object(i.a)(Object(i.a)({},super.getVariation()),{},{dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity})}get dotDensity(){return!!this.bit(15)}set dotDensity(e){this.setBit(15,e)}}p.shared=new p(0);class m extends(d(v(f(h(u))))){static load(e){var t=this.shared;return t.data=e,t}static from(e){var t=this.load(0);return t.geometryType=n.d.MARKER,t.setVV(e,!1),t.data}getVariation(){return Object(i.a)(Object(i.a)({},super.getVariation()),{},{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}m.shared=new m(0);class y extends(d(v(h(u)))){static load(e){var t=this.shared;return t.data=e,t}static from(e,t){var r=this.load(0);return r.geometryType=n.d.LINE,r.setVV(e,t),r.data}getVariation(){return Object(i.a)(Object(i.a)({},super.getVariation()),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}y.shared=new y(0);class b extends(d(v(f(h(u))))){static load(e){var t=this.shared;return t.data=e,t}static from(e){var t=this.load(e);return t.geometryType=n.d.TEXT,t.setVV(e,!1),t.data}getVariation(){return Object(i.a)(Object(i.a)({},super.getVariation()),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}b.shared=new b(0);class _ extends(h(u)){static load(e){var t=this.shared;return t.data=e,t}static from(e,t){var r=this.load(0);return r.geometryType=n.d.LABEL,r.setVV(e,!1),r.mapAligned=!!Object(s.a)(t),r.data}getVariation(){return Object(i.a)(Object(i.a)({},super.getVariation()),{},{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}_.shared=new _(0)},180:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));r(80);function i(e){}function a(e){return()=>e}},193:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(139),a=r(117),n={inches:Object(a.c)(1,"meters","inches"),feet:Object(a.c)(1,"meters","feet"),"us-feet":Object(a.c)(1,"meters","us-feet"),yards:Object(a.c)(1,"meters","yards"),miles:Object(a.c)(1,"meters","miles"),"nautical-miles":Object(a.c)(1,"meters","nautical-miles"),millimeters:Object(a.c)(1,"meters","millimeters"),centimeters:Object(a.c)(1,"meters","centimeters"),decimeters:Object(a.c)(1,"meters","decimeters"),meters:Object(a.c)(1,"meters","meters"),kilometers:Object(a.c)(1,"meters","kilometers"),"decimal-degrees":1/Object(a.m)(1,"meters",i.a.radius)}},194:function(e,t,r){"use strict";var i,a=r(7),n=r(82),s=(r(80),r(92)),o=(r(81),r(88),r(85)),l=r(102),c=r(84),u=(r(83),r(86),r(87),r(128)),h=r(203),f=r(412),d=i=class extends(Object(h.a)(u.a)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}collectRequiredFields(e,t){var r=this;return Object(a.a)((function*(){yield Promise.all([r.collectSymbolFields(e,t),r.collectVVRequiredFields(e,t)])}))()}collectSymbolFields(e,t){var r=this;return Object(a.a)((function*(){yield Promise.all(r.getSymbols().map((r=>r.collectRequiredFields(e,t))))}))()}getSymbol(e,t){return this.symbol}getSymbolAsync(e,t){var r=this;return Object(a.a)((function*(){return r.symbol}))()}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new i({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:Object(s.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};Object(n.a)([Object(o.b)({type:String,json:{write:!0}})],d.prototype,"description",void 0),Object(n.a)([Object(o.b)({type:String,json:{write:!0}})],d.prototype,"label",void 0),Object(n.a)([Object(o.b)(f.b)],d.prototype,"symbol",void 0),Object(n.a)([Object(l.a)({simple:"simple"})],d.prototype,"type",void 0);var v=d=i=Object(n.a)([Object(c.a)("esri.renderers.SimpleRenderer")],d);t.a=v},197:function(e,t,r){"use strict";r.r(t);var i,a=r(91),n=r(7),s=r(82),o=(r(80),r(92)),l=r(89),c=r(143),u=r(81),h=(r(88),r(85)),f=r(84),d=r(96),v=r(93),p=(r(83),r(86),r(87),r(94)),m=r(152),y=r(118),b=r(109),_=r(356),x=r(106),g=r(128),O=r(203),j=r(235),M=u.a.getLogger("esri.renderers.DictionaryRenderer"),S={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}},w=i=class extends(Object(O.a)(g.a)){constructor(e){super(e),this._ongoingRequests=new Map,this._symbolCache=new j.a(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,r,i){null!=i&&i.origin||super.writeVisualVariables(e,t,r,i)}clone(){return new i({config:Object(o.a)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:Object(o.a)(this.fieldMap),url:Object(o.a)(this.url),visualVariables:Object(o.a)(this.visualVariables)})}getSymbolAsync(e,t){var r=this;return Object(n.a)((function*(){var i;r._dictionaryPromise||(r._dictionaryPromise=r.fetchResources(t));try{i=yield r._dictionaryPromise}catch(C){if(Object(p.m)(C))return r._dictionaryPromise=null,null}var a={};if(r.fieldMap)for(var n of r._symbolFields){var s=r.fieldMap[n];if(s&&null!==e.attributes[s]&&void 0!==e.attributes[s]){var o=""+e.attributes[s];a[n]=o}else a[n]=""}var u=i(a,t);if(!u||"string"!=typeof u)return null;var h=Object(c.b)(u).toString(),f=r._symbolCache.get(h);if(f)return f.catch((()=>{r._symbolCache.pop(h)})),f;var d=u.split(";"),v=[],m=[];for(var y of d)if(y&&0!==y.length)if(-1===y.indexOf("po:"))if(-1!==y.indexOf("|"))for(var _ of y.split("|"))r._itemNames.has(_)&&v.push(_);else r._itemNames.has(y)&&v.push(y);else{var x=y.substr(3).split("|");if(3===x.length){var g=x[0],O=x[1],j=x[2];if("DashTemplate"===O)j=j.split(" ").map((e=>Number(e)));else if("Color"===O){var M=new b.a(j).toRgba();j=[M[0],M[1],M[2],255*M[3]]}else j=Number(j);m.push({primitiveName:g,propertyName:O,value:j})}}var S=!Object(l.k)(e.geometry)||!e.geometry.hasZ&&"point"===e.geometry.type,w=r._cimPartsToCIMSymbol(v,m,S,t);return r._symbolCache.put(h,w,1),w}))()}collectRequiredFields(e,t){var r=this;return Object(n.a)((function*(){yield r.collectVVRequiredFields(e,t),r.scaleExpression&&(yield Object(y.c)(e,t,r.scaleExpression));var i=t.map((e=>e.name));for(var a in r.fieldMap)i.indexOf(r.fieldMap[a])<0||e.add(r.fieldMap[a])}))()}get arcadeRequired(){return!0}fetchResources(e){var t=this;return Object(n.a)((function*(){if(t._dictionaryPromise)return t._dictionaryPromise;if(t.url){var r=Object(l.k)(e)?e.abortOptions:null,i=Object(x.default)(t.url+"/resources/styles/dictionary-info.json",Object(a.a)({responseType:"json",query:{f:"json"}},r)),[{data:n}]=yield Promise.all([i,Object(m.e)()]);if(!n)throw t._dictionaryPromise=null,new v.a("esri.renderers.DictionaryRenderer","Bad dictionary data!");var s=n.expression,o=n.authoringInfo;t._refSymbolUrlTemplate=t.url+"/"+n.cimRefTemplateUrl,t._itemNames=new Set(n.itemsNames),t._symbolFields=o.symbol;var c={};if(t.config){var u=t.config;for(var h in u)c[h]=u[h]}if(o.configuration)for(var f of o.configuration)c.hasOwnProperty(f.name)||(c[f.name]=f.value);var d=[];if(Object(l.k)(e)&&e.fields&&t.fieldMap){var p=function(r){var i=t.fieldMap[r],n=e.fields.filter((e=>e.name===i));n.length>0&&d.push(Object(a.a)(Object(a.a)({},n[0]),{},{name:r}))};for(var y of t._symbolFields)p(y)}return t._dictionaryPromise=Object(m.b)(s,Object(l.k)(e)?e.spatialReference:null,d,c).then((e=>{var t={scale:0};return(r,i)=>{var a=e.repurposeFeature({geometry:null,attributes:r});return t.scale=Object(l.k)(i)?i.scale:void 0,e.evaluate({$feature:a,$view:t})}})).catch((e=>(M.error("Creating dictinoary expression failed:",e),null))),t._dictionaryPromise}M.error("no valid URL!")}))()}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return"".concat(this.url,"-").concat(JSON.stringify(this.fieldMap))}getSymbolFields(){return this._symbolFields}_getSymbolPart(e,t){var r=this;return Object(n.a)((function*(){if(r._ongoingRequests.has(e))return r._ongoingRequests.get(e).then((e=>e.data));var i=r._refSymbolUrlTemplate.replace(/\{itemName\}/gi,e),n=Object(x.default)(i,Object(a.a)({responseType:"json",query:{f:"json"}},t));r._ongoingRequests.set(e,n);try{return(yield n).data}catch(s){return r._ongoingRequests.delete(e),Promise.reject(s)}}))()}_combineSymbolParts(e,t,r){if(!e||0===e.length)return null;var i=Object(a.a)({},e[0]);if(e.length>1)for(var n of(i.symbolLayers=[],e)){var s=n;i.symbolLayers.unshift(...s.symbolLayers)}return r&&(i.callout=S),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:t}}_cimPartsToCIMSymbol(e,t,r,i){var a=this;return Object(n.a)((function*(){for(var n=new Array(e.length),s=0;s<e.length;s++)n[s]=a._getSymbolPart(e[s],i);var o=yield Promise.all(n);return new _.a({data:a._combineSymbolParts(o,t,r)})}))()}};Object(s.a)([Object(h.b)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],w.prototype,"config",void 0),Object(s.a)([Object(h.b)({type:Object,json:{write:!0}})],w.prototype,"fieldMap",void 0),Object(s.a)([Object(h.b)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],w.prototype,"scaleExpression",void 0),Object(s.a)([Object(d.a)("scaleExpression")],w.prototype,"writeData",null),Object(s.a)([Object(h.b)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],w.prototype,"scaleExpressionTitle",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],w.prototype,"url",void 0),Object(s.a)([Object(d.a)("visualVariables")],w.prototype,"writeVisualVariables",null);var C=w=i=Object(s.a)([Object(f.a)("esri.renderers.DictionaryRenderer")],w);t.default=C},198:function(e,t,r){"use strict";var i,a=r(7),n=r(82),s=(r(80),r(92)),o=(r(81),r(88),r(85)),l=r(102),c=r(84),u=(r(83),r(86),r(87),r(118)),h=r(109),f=r(128),d=r(278),v=i=class extends f.a{constructor(e){super(e),this.blurRadius=10,this.colorStops=[new d.a({ratio:0,color:new h.a("rgba(255, 140, 0, 0)")}),new d.a({ratio:.75,color:new h.a("rgba(255, 140, 0, 1)")}),new d.a({ratio:.9,color:new h.a("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.maxPixelIntensity=100,this.minPixelIntensity=0,this.type="heatmap"}collectRequiredFields(e,t){var r=this;return Object(a.a)((function*(){var i=r.field;i&&"string"==typeof i&&Object(u.f)(e,t,i)}))()}getAttributeHash(){return null}getMeshHash(){return"".concat(JSON.stringify(this.colorStops),".").concat(this.blurRadius,".").concat(this.field)}clone(){return new i({blurRadius:this.blurRadius,colorStops:Object(s.a)(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}};Object(n.a)([Object(o.b)({type:Number,json:{write:!0}})],v.prototype,"blurRadius",void 0),Object(n.a)([Object(o.b)({type:[d.a],json:{write:!0}})],v.prototype,"colorStops",void 0),Object(n.a)([Object(o.b)({type:String,json:{write:!0}})],v.prototype,"field",void 0),Object(n.a)([Object(o.b)({type:Number,json:{write:{overridePolicy:(e,t,r)=>({enabled:null==r})}}})],v.prototype,"fieldOffset",void 0),Object(n.a)([Object(o.b)({type:Number,json:{write:!0}})],v.prototype,"maxPixelIntensity",void 0),Object(n.a)([Object(o.b)({type:Number,json:{write:!0}})],v.prototype,"minPixelIntensity",void 0),Object(n.a)([Object(l.a)({heatmap:"heatmap"})],v.prototype,"type",void 0);var p=v=i=Object(n.a)([Object(c.a)("esri.renderers.HeatmapRenderer")],v);t.a=p},199:function(e,t,r){"use strict";var i,a=r(7),n=r(82),s=(r(80),r(92)),o=r(81),l=r(88),c=r(85),u=r(145),h=r(102),f=r(84),d=(r(83),r(86),r(87),r(118)),v=r(109),p=r(220),m=r(211),y=r(128),b=r(203),_=r(116),x=r(90),g=o.a.getLogger("esri.renderers.support.AttributeColorInfo"),O=i=class extends x.a{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return null==e?e:"function"==typeof e?(g.error(".field: field must be a string value"),null):Object(l.l)(e)}getAttributeHash(){return"".concat(this.field,"-").concat(this.valueExpression)}clone(){return new i({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};Object(n.a)([Object(c.b)({type:v.a,json:{type:[Number],write:!0}})],O.prototype,"color",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],O.prototype,"field",void 0),Object(n.a)([Object(_.a)("field")],O.prototype,"castField",null),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],O.prototype,"label",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],O.prototype,"valueExpression",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],O.prototype,"valueExpressionTitle",void 0);var j,M=O=i=Object(n.a)([Object(f.a)("esri.renderers.support.AttributeColorInfo")],O),S=j=class extends x.a{constructor(){super(...arguments),this.unit=null}clone(){return new j({unit:this.unit})}};Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],S.prototype,"unit",void 0);var w,C=S=j=Object(n.a)([Object(f.a)("esri.renderers.support.DotDensityLegendOptions")],S),I=w=class extends(Object(b.a)(y.a)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new v.a([0,0,0,0]),this.blendDots=!0,this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new p.a,this.dotValue=null,this.referenceDotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;var t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new m.a({outline:this.outline})}getSymbolAsync(){var e=this;return Object(a.a)((function*(){return e.getSymbol()}))()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes&&this.attributes.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new w({attributes:Object(s.a)(this.attributes),backgroundColor:Object(s.a)(this.backgroundColor),dotBlendingEnabled:Object(s.a)(this.dotBlendingEnabled),dotShape:Object(s.a)(this.dotShape),dotSize:Object(s.a)(this.dotSize),dotValue:Object(s.a)(this.dotValue),legendOptions:Object(s.a)(this.legendOptions),outline:Object(s.a)(this.outline),referenceScale:Object(s.a)(this.referenceScale),visualVariables:Object(s.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return"".concat(this.attributes.map((e=>e.field||e.valueExpression||"")),"-").concat(this.outline&&JSON.stringify(this.outline.toJSON())||"")}collectRequiredFields(e,t){var r=this;return Object(a.a)((function*(){for(var i of(yield r.collectVVRequiredFields(e,t),r.attributes))i.valueExpression&&(yield Object(d.c)(e,t,i.valueExpression)),i.field&&e.add(i.field)}))()}};Object(n.a)([Object(c.b)({type:[M],json:{write:!0}})],I.prototype,"attributes",void 0),Object(n.a)([Object(c.b)({type:v.a,json:{write:!0}})],I.prototype,"backgroundColor",void 0),Object(n.a)([Object(c.b)({type:Boolean}),Object(u.a)("dotBlendingEnabled")],I.prototype,"blendDots",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:!0}})],I.prototype,"dotBlendingEnabled",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!1}})],I.prototype,"dotShape",void 0),Object(n.a)([Object(c.b)({type:Number,json:{write:!1}})],I.prototype,"dotSize",void 0),Object(n.a)([Object(c.b)({type:C,json:{write:!0}})],I.prototype,"legendOptions",void 0),Object(n.a)([Object(c.b)({type:p.a,json:{default:null,write:!0}})],I.prototype,"outline",void 0),Object(n.a)([Object(c.b)({type:Number,json:{write:!0}})],I.prototype,"dotValue",void 0),Object(n.a)([Object(c.b)({type:Number}),Object(u.a)("dotValue")],I.prototype,"referenceDotValue",void 0),Object(n.a)([Object(c.b)({type:Number,json:{write:!0}})],I.prototype,"referenceScale",void 0),Object(n.a)([Object(c.b)({type:Number,json:{write:!0}})],I.prototype,"seed",void 0),Object(n.a)([Object(h.a)({dotDensity:"dot-density"})],I.prototype,"type",void 0);var k=I=w=Object(n.a)([Object(f.a)("esri.renderers.DotDensityRenderer")],I);t.a=k},214:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return h}));var i=r(128),a=r(229),n=r(231),s=r(197),o=r(199),l=r(198),c=r(194),u={key:"type",base:i.a,typeMap:{heatmap:l.a,simple:c.a,"unique-value":n.a,"class-breaks":a.a,"dot-density":o.a,dictionary:s.default},errorContext:"renderer"},h={key:"type",base:i.a,typeMap:{simple:c.a,"unique-value":n.a,"class-breaks":a.a},errorContext:"renderer"}},233:function(e,t,r){"use strict";function i(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function a(e){return null!=e&&!isNaN(e)&&isFinite(e)}function n(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function s(e,t){var r=t||n(e),i=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===i?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a}))},234:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return d}));r(80);var i=r(89),a=r(220),n=r(211),s=r(291),o=r(345),l=r(282),c=s.a.fromJSON(l.a),u=a.a.fromJSON(l.c),h=n.a.fromJSON(l.b),f=o.a.fromJSON(l.d);function d(e){if(Object(i.j)(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return c;case"polyline":return u;case"polygon":case"extent":return h}return null}var v=s.a.fromJSON(l.e),p=a.a.fromJSON(l.g),m=n.a.fromJSON(l.f)},235:function(e,t,r){"use strict";var i=r(213);t.a=class{constructor(e,t){this._storage=new i.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t,r){this._storage.put(e,t,r,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}}},238:function(e,t,r){"use strict";function i(){return new Float32Array(2)}function a(e,t){var r=new Float32Array(2);return r[0]=e,r[1]=t,r}function n(){return i()}function s(){return a(1,1)}function o(){return a(1,0)}function l(){return a(0,1)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var c=n(),u=s(),h=o(),f=l();Object.freeze({__proto__:null,create:i,clone:function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t},fromValues:a,createView:function(e,t){return new Float32Array(e,t,2)},zeros:n,ones:s,unitX:o,unitY:l,ZEROS:c,ONES:u,UNIT_X:h,UNIT_Y:f})},244:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return l}));r(80);var i=r(124),a=r(175),n=r(188),s=r(93),o=r(214);function l(e,t,r,a){var n=function(e,t){return e?function(e,t){if(!t||"web-scene"!==t.origin)return!0;switch(e.type){case"simple":case"unique-value":case"class-breaks":return!0;case"heatmap":case"dictionary":case"dot-density":default:return!1}}(e,t)?e.write({},t):(t.messages&&t.messages.push(new s.a("renderer:unsupported","Renderer of type '".concat(e.declaredClass,"' are not supported in scenes."),{renderer:e,context:t})),null):null}(e,a);n&&Object(i.c)(r,n,t)}function c(e,t){return h(e,null,t)}var u=Object(n.b)({types:o.a});function h(e,t,r){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(r&&r.messages&&r.messages.push(new a.a("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null):u(e,t,r):null}},277:function(e,t,r){"use strict";r.r(t),r.d(t,"getAllSizes",(function(){return M})),r.d(t,"getColor",(function(){return v})),r.d(t,"getOpacity",(function(){return p})),r.d(t,"getRotationAngle",(function(){return m})),r.d(t,"getSize",(function(){return y})),r.d(t,"getSizeForValue",(function(){return x})),r.d(t,"getSizeFromNumberOrVariable",(function(){return b})),r.d(t,"getSizeRangeAtScale",(function(){return g})),r.d(t,"getVisualVariableValues",(function(){return O})),r.d(t,"viewScaleRE",(function(){return d}));var i=r(180),a=r(89),n=r(81),s=r(109),o=r(123),l=r(193),c=r(233),u=n.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),h=new o.a,f=Math.PI,d=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function v(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"color"===e.type))[0]:e;if(i)if("esri.renderers.visualVariables.ColorVariable"===i.declaredClass){var n="number"==typeof t,o=n?null:t,l=o&&o.attributes,c=n?t:null,h=i.field,{ipData:f,hasExpression:d}=i.cache,v=i.cache.compiledFunc;if(!h&&!d){var p=i.stops;return p&&p[0]&&p[0].color}if("number"!=typeof c)if(d){if(!Object(a.k)(r)||!Object(a.k)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var m={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},y=r.arcade.arcadeUtils,b=y.getViewInfo(m),_=y.createExecContext(o,b);if(!v){var x=y.createSyntaxTree(i.valueExpression);v=y.createFunction(x),i.cache.compiledFunc=v}c=y.executeFunction(v,_)}else l&&(c=l[h]);var g=i.normalizationField,O=l?parseFloat(l[g]):void 0;if(null!=c&&(!g||n||!isNaN(O)&&0!==O)){isNaN(O)||n||(c/=O);var M=j(c,f);if(M){var S=M[0],w=M[1],C=S===w?i.stops[S].color:s.a.blendColors(i.stops[S].color,i.stops[w].color,M[2],Object(a.k)(r)?r.color:void 0);return new s.a(C)}}}else u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function p(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"opacity"===e.type))[0]:e;if(i)if("esri.renderers.visualVariables.OpacityVariable"===i.declaredClass){var n="number"==typeof t,s=n?null:t,o=s&&s.attributes,l=n?t:null,c=i.field,{ipData:h,hasExpression:f}=i.cache,d=i.cache.compiledFunc;if(!c&&!f){var v=i.stops;return v&&v[0]&&v[0].opacity}if("number"!=typeof l)if(f){if(Object(a.j)(r)||Object(a.j)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,y=m.getViewInfo(p),b=m.createExecContext(s,y);if(!d){var _=m.createSyntaxTree(i.valueExpression);d=m.createFunction(_),i.cache.compiledFunc=d}l=m.executeFunction(d,b)}else o&&(l=o[c]);var x=i.normalizationField,g=o?parseFloat(o[x]):void 0;if(null!=l&&(!x||n||!isNaN(g)&&0!==g)){isNaN(g)||n||(l/=g);var O=j(l,h);if(O){var M=O[0],S=O[1];if(M===S)return i.stops[M].opacity;var w=i.stops[M].opacity;return w+(i.stops[S].opacity-w)*O[2]}}}else u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function m(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"rotation"===e.type))[0]:e;if(i){if("esri.renderers.visualVariables.RotationVariable"===i.declaredClass){var n=i.axis||"heading",s="heading"===n&&"arithmetic"===i.rotationType?90:0,o="heading"===n&&"arithmetic"===i.rotationType?-1:1,l="number"==typeof t?null:t,c=l&&l.attributes,h=i.field,{hasExpression:f}=i.cache,d=i.cache.compiledFunc,v=0;if(!h&&!f)return v;if(f){if(Object(a.j)(r)||Object(a.j)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var p={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,y=m.getViewInfo(p),b=m.createExecContext(l,y);if(!d){var _=m.createSyntaxTree(i.valueExpression);d=m.createFunction(_),i.cache.compiledFunc=d}v=m.executeFunction(d,b)}else c&&(v=c[h]||0);return v="number"!=typeof v||isNaN(v)?null:s+o*v}u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function y(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"size"===e.type))[0]:e;if(i){if("esri.renderers.visualVariables.SizeVariable"===i.declaredClass){var n=x(function(e,t,r){var i="number"==typeof t,n=i?null:t,s=n&&n.attributes,o=i?t:null,{isScaleDriven:l}=e.cache,h=e.cache.compiledFunc;if(l){var f=Object(a.k)(r)?r.scale:void 0,d=Object(a.k)(r)?r.view:void 0;o=null==f||"3d"===d?function(e){var t=null,r=null,i=e.stops;return i?(t=i[0].value,r=i[i.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):f}else if(!i)switch(e.inputValueType){case"expression":if(Object(a.j)(r)||Object(a.j)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},p=r.arcade.arcadeUtils,m=p.getViewInfo(v),y=p.createExecContext(n,m);if(!h){var b=p.createSyntaxTree(e.valueExpression);h=p.createFunction(b),e.cache.compiledFunc=h}o=p.executeFunction(h,y);break;case"field":s&&(o=s[e.field]);break;case"unknown":o=null}if(!Object(c.d)(o))return null;if(i||!e.normalizationField)return o;var _=s?parseFloat(s[e.normalizationField]):null;return Object(c.d)(_)&&0!==_?o/_:null}(i,t,r),i,t,r,i.cache.ipData);return null==n||isNaN(n)?0:n}u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function b(e,t,r){return null==e?null:Object(c.c)(e)?y(e,t,r):Object(c.d)(e)?e:null}function _(e,t,r){return Object(c.d)(r)&&e>r?r:Object(c.d)(t)&&e<t?t:e}function x(e,t,r,i,n){switch(t.transformationType){case"additive":return function(e,t,r,i){return e+(b(t.minSize,r,i)||t.minDataValue)}(e,t,r,i);case"constant":return function(e,t,r){var i=e.stops,a=i&&i.length&&i[0].size;return null==a&&(a=e.minSize),b(a,t,r)}(t,r,i);case"clamped-linear":return function(e,t,r,i){var n=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),s=b(t.minSize,r,i),o=b(t.maxSize,r,i),l=Object(a.k)(i)?i.shape:void 0;if(e<=t.minDataValue)return s;if(e>=t.maxDataValue)return o;if("area"===t.scaleBy&&l){var c="circle"===l,u=c?f*Math.pow(s/2,2):s*s,h=u+n*((c?f*Math.pow(o/2,2):o*o)-u);return c?2*Math.sqrt(h/f):Math.sqrt(h)}return s+n*(o-s)}(e,t,r,i);case"proportional":return function(e,t,r,i){var n=Object(a.k)(i)?i.shape:void 0,s=e/t.minDataValue,o=b(t.minSize,r,i),l=b(t.maxSize,r,i);return _("circle"===n?2*Math.sqrt(s*Math.pow(o/2,2)):"square"===n||"diamond"===n||"image"===n?Math.sqrt(s*Math.pow(o,2)):s*o,o,l)}(e,t,r,i);case"stops":return function(e,t,r,i,a){var[n,s,o]=j(e,a);if(n===s)return b(t.stops[n].size,r,i);var l=b(t.stops[n].size,r,i);return l+(b(t.stops[s].size,r,i)-l)*o}(e,t,r,i,n);case"real-world-size":return function(e,t,r,i){var n=(Object(a.k)(i)&&i.resolution?i.resolution:1)*l.a[t.valueUnit],s=b(t.minSize,r,i),o=b(t.maxSize,r,i),{valueRepresentation:c}=t;return _("area"===c?2*Math.sqrt(e/f)/n:"radius"===c||"distance"===c?2*e/n:e/n,s,o)}(e,t,r,i);case"identity":return e;case"unknown":return null}}function g(e,t,r){var{isScaleDriven:i}=e.cache;if(!(i&&"3d"===r||t))return null;var a={scale:t,view:r},n=b(e.minSize,h,a),s=b(e.maxSize,h,a);if(null!=n||null!=s){if(n>s){var o=s;s=n,n=o}return{minSize:n,maxSize:s}}}function O(e,t,r){if(e.visualVariables){var i=[],a=[],n=[],s=[],o=[];for(var l of e.visualVariables)switch(l.type){case"color":a.push(l);break;case"opacity":n.push(l);break;case"rotation":o.push(l);break;case"size":s.push(l)}return a.forEach((e=>{var a=v(e,t,r);i.push({variable:e,value:a})})),n.forEach((e=>{var a=p(e,t,r);i.push({variable:e,value:a})})),o.forEach((e=>{var a=m(e,t,r);i.push({variable:e,value:a})})),s.forEach((e=>{var a=y(e,t,r);i.push({variable:e,value:a})})),i.filter((e=>null!=e.value))}}function j(e,t){if(t){var r=0,i=t.length-1;return t.some(((t,a)=>e<t?(i=a,!0):(r=a,!1))),[r,i,(e-t[r])/(t[i]-t[r])]}}function M(e,t,r){var a=["proportional","proportional","proportional"];for(var n of e){var s=n.useSymbolValue?"symbol-value":y(n,t,r);switch(n.axis){case"width":a[0]=s;break;case"depth":a[1]=s;break;case"height":a[2]=s;break;case"width-and-depth":a[0]=s,a[1]=s;break;case"all":case void 0:case null:a[0]=s,a[1]=s,a[2]=s;break;default:Object(i.a)(n.axis)}}return a}},278:function(e,t,r){"use strict";var i,a=r(82),n=(r(80),r(81),r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(90)),l=r(109),c=i=class extends o.a{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new i({color:this.color,ratio:this.ratio})}};Object(a.a)([Object(n.b)({type:l.a,json:{write:!0}})],c.prototype,"color",void 0),Object(a.a)([Object(n.b)({type:Number,json:{write:!0}})],c.prototype,"ratio",void 0);var u=c=i=Object(a.a)([Object(s.a)("esri.renderers.support.HeatmapColorStop")],c);t.a=u},287:function(e,t,r){"use strict";var i=r(89),a=r(153),n=r(445),s=r(369);class o{static executeEffects(e,t){var r=Object(a.c)(t),i=new n.a(r);for(var o of e){var l=Object(s.a)(o);l&&(i=l.execute(i,o,1.3333333333333333))}return i}static next(e){var t=e.next();return Object(a.d)(t),t}}t.a=class{bindFeature(e,t,r){}write(e,t){if(Object(i.j)(this._effects))return this._write(e,t);for(var r=o.executeEffects(this._effects,t.readLegacyGeometry()),a=o.next(r);a;)this._write(e,t,a),a=o.next(r)}_write(e,t,r){}}},290:function(e,t,r){"use strict";function i(){var e=new Float32Array(6);return e[0]=1,e[3]=1,e}function a(e,t,r,i){var a=t[i],n=t[i+1];e[i]=r[0]*a+r[2]*n+r[4],e[i+1]=r[1]*a+r[3]*n+r[5]}function n(e,t,r,i=0,n=0,s=2){for(var o=n||t.length/s,l=i;l<o;l++)a(e,t,r,l*s)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));Object.freeze({__proto__:null,create:i,clone:function(e){var t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},fromValues:function(e,t,r,i,a,n){var s=new Float32Array(6);return s[0]=e,s[1]=t,s[2]=r,s[3]=i,s[4]=a,s[5]=n,s},createView:function(e,t){return new Float32Array(e,t,6)},transform:a,transformMany:n})},319:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(93);function a(e,t){if(e&&"name"in e){var r=e;return t&&t.error(new i.a(r.name,r.message,r.details)),!1}return!0}},320:function(e,t,r){"use strict";function i(e,t,r,i){return function(e){return"function"==typeof e}(e)?e(t,r,i):e}function a(e){return[e.r,e.g,e.b,e.a]}function n(e,t,r){var i=e=>{for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},a=[],n=0,o=-1;do{if((o=t.indexOf("[",n))>=n){if(o>n){var l=t.substr(n,o-n);a.push([l,null,i(l)])}if(n=o+1,(o=t.indexOf("]",n))>=n){if(o>n){var c=e[t.substr(n,o-n)];c&&a.push([null,c,!1])}n=o+1}}}while(-1!==o);if(n<t.length-1){var u=t.substr(n);a.push([u,null,i(u)])}return e=>{var t="",i=null;for(var n of a){var[o,l,c]=n;if(o)c?i=o:(i&&(t+=i,i=null),t+=o);else{var u=e.attributes[l];u&&(i&&(t+=i,i=null),t+=u)}}return s(t,r)}}function s(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function o(e,t,r,i,a,n,s=!0){for(var o=t/a,l=r/n,c=Math.ceil(o/2),u=Math.ceil(l/2),h=0;h<n;h++)for(var f=0;f<a;f++){for(var d=4*(f+(s?n-h-1:h)*a),v=0,p=0,m=0,y=0,b=0,_=0,x=0,g=(h+.5)*l,O=Math.floor(h*l);O<(h+1)*l;O++)for(var j=Math.abs(g-(O+.5))/u,M=(f+.5)*o,S=j*j,w=Math.floor(f*o);w<(f+1)*o;w++){var C=Math.abs(M-(w+.5))/c,I=Math.sqrt(S+C*C);I>=-1&&I<=1&&((v=2*I*I*I-3*I*I+1)>0&&(x+=v*e[(C=4*(w+O*t))+3],m+=v,e[C+3]<255&&(v=v*e[C+3]/250),y+=v*e[C],b+=v*e[C+1],_+=v*e[C+2],p+=v))}i[d]=y/p,i[d+1]=b/p,i[d+2]=_/p,i[d+3]=x/m}}function l(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function c(e){var t;return null==(t=e.data)?void 0:t.symbol}function u(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function h(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function f(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function d(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return o})),r.d(t,"k",(function(){return c}))},321:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return o})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return c}));var i=r(184);function a(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function n(e,t){var r=t[0],i=t[1],a=t[2],n=t[3],s=t[4],o=t[5],l=r*n-i*a;return l?(l=1/l,e[0]=n*l,e[1]=-i*l,e[2]=-a*l,e[3]=r*l,e[4]=(a*o-n*s)*l,e[5]=(i*s-r*o)*l,e):null}function s(e,t,r){var i=t[0],a=t[1],n=t[2],s=t[3],o=t[4],l=t[5],c=r[0],u=r[1],h=r[2],f=r[3],d=r[4],v=r[5];return e[0]=i*c+n*u,e[1]=a*c+s*u,e[2]=i*h+n*f,e[3]=a*h+s*f,e[4]=i*d+n*v+o,e[5]=a*d+s*v+l,e}function o(e,t,r){var i=t[0],a=t[1],n=t[2],s=t[3],o=t[4],l=t[5],c=Math.sin(r),u=Math.cos(r);return e[0]=i*u+n*c,e[1]=a*u+s*c,e[2]=i*-c+n*u,e[3]=a*-c+s*u,e[4]=o,e[5]=l,e}function l(e,t,r){var i=t[0],a=t[1],n=t[2],s=t[3],o=t[4],l=t[5],c=r[0],u=r[1];return e[0]=i*c,e[1]=a*c,e[2]=n*u,e[3]=s*u,e[4]=o,e[5]=l,e}function c(e,t,r){var i=t[0],a=t[1],n=t[2],s=t[3],o=t[4],l=t[5],c=r[0],u=r[1];return e[0]=i,e[1]=a,e[2]=n,e[3]=s,e[4]=i*c+n*u+o,e[5]=a*c+s*u+l,e}function u(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e}function h(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function f(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}var d=s,v=f;Object.freeze({__proto__:null,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:a,set:function(e,t,r,i,a,n,s){return e[0]=t,e[1]=r,e[2]=i,e[3]=a,e[4]=n,e[5]=s,e},invert:n,determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:s,rotate:o,scale:l,translate:c,fromRotation:u,fromScaling:h,fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},subtract:f,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},multiplyScalarAndAdd:function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){var r=e[0],a=e[1],n=e[2],s=e[3],o=e[4],l=e[5],c=t[0],u=t[1],h=t[2],f=t[3],d=t[4],v=t[5];return Math.abs(r-c)<=i.a*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-u)<=i.a*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(n-h)<=i.a*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(s-f)<=i.a*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(o-d)<=i.a*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(l-v)<=i.a*Math.max(1,Math.abs(l),Math.abs(v))},mul:d,sub:v})},381:function(e,t,r){"use strict";t.a=class{constructor(e,t){this._pos=0;var r=t?this._roundToNearest(t,e.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(r),this._buffer=new e(this._array),this._ctor=e,this._i16View=new Int16Array(this._array)}get length(){return this._pos}_roundToNearest(e,t){var r=Math.round(e);return r+(t-r%t)}_ensureSize(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest(1.5*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),r=new ArrayBuffer(t),i=new this._ctor(r);i.set(this._buffer,0),this._array=r,this._buffer=i,this._i16View=new Int16Array(this._array)}}writeF32(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}push(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t}writeFixed(e){this._buffer[this._pos++]=e}setValue(e,t){this._buffer[e]=t}i1616Add(e,t,r){this._i16View[2*e]+=t,this._i16View[2*e+1]+=r}getValue(e){return this._buffer[e]}incr(e){if(this._buffer.length<e)throw new Error("Increment index overflows the target buffer");this._buffer[e]++}decr(e){this._buffer[e]--}writeRegion(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}writeManyFrom(e,t,r){this._ensureSize(r-t);for(var i=t;i!==r;i++)this.writeFixed(e._buffer[i])}buffer(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e}toArray(){for(var e=this._array,t=[],r=0;r<e.byteLength/4;r++)t.push(e[r]);return t}seek(e){this._pos=e}destroy(){this._array=null,this._buffer=null}}},399:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return o}));Number.POSITIVE_INFINITY;var i=Math.PI,a=128/i,n=1/Math.LN2;function s(e,t){return(e%=t)>=0?e:e+t}function o(e){return s(e*a,256)}function l(e){return s(.7111111111111111*e,256)}function c(e){return Math.log(e)*n}function u(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}},418:function(e,t,r){"use strict";r.d(t,"a",(function(){return D})),r.d(t,"b",(function(){return g}));var i=r(91),a=r(7),n=r(143),s=r(81),o=r(152),l=r(109),c=r(105),u=r(320),h=r(419),f=r(352),d=r(493),v=s.a.getLogger("esri.symbols.cim.cimAnalyzer");function p(e){switch(e){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function m(e){switch(e){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function y(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function b(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function _(e,t,r,i){var a;e[t]?a=e[t]:(a={},e[t]=a),a[r]=i}function x(e){var t=e.markerPlacement;return t&&t.angleToLine?1:0}function g(e,t,r,i){return O.apply(this,arguments)}function O(){return(O=Object(a.a)((function*(e,t,r,i){var a,n,s=r||[];if(!e)return s;var l={};if("CIMSymbolReference"!==e.type)return v.error("Expect cim type to be 'CIMSymbolReference'"),s;if(a=e.symbol,n=e.primitiveOverrides){var c=[],u=function(e){var r=e.valueExpressionInfo;if(r&&t){var i=r.expression,a=Object(o.d)(i,t.spatialReference,t.fields).then((t=>{t&&_(l,e.primitiveName,e.propertyName,t)}));c.push(a)}else null!=e.value&&_(l,e.primitiveName,e.propertyName,e.value)};for(var h of n)u(h);yield Promise.all(c)}switch(a.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":j(a,n,l,t,s,i)}return s}))).apply(this,arguments)}function j(e,t,r,i,a,n){if(e){var s=e.symbolLayers;if(s){var o,l=f.a.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(o=1);for(var c=s.length;c--;){var u=s[c];if(u&&!1!==u.enable){var h=[];switch(f.b.findApplicableOverrides(u,t,h),u.type){case"CIMSolidFill":M(u,r,h,i,a);break;case"CIMPictureFill":S(u,r,h,i,a);break;case"CIMHatchFill":w(u,r,h,i,a);break;case"CIMGradientFill":C(u,r,h,i,a);break;case"CIMSolidStroke":I(u,r,h,i,a,"CIMPolygonSymbol"===e.type,l);break;case"CIMPictureStroke":k(u,r,h,i,a,"CIMPolygonSymbol"===e.type,l);break;case"CIMGradientStroke":T(u,r,h,i,a,"CIMPolygonSymbol"===e.type,l);break;case"CIMCharacterMarker":if(E(u,r,h,i,a))break;break;case"CIMPictureMarker":if(E(u,r,h,i,a))break;"CIMLineSymbol"===e.type&&(o=x(u)),P(u,r,h,i,a,o,l);break;case"CIMVectorMarker":if(E(u,r,h,i,a))break;"CIMLineSymbol"===e.type&&(o=x(u)),z(u,r,h,i,a,o,l,n);break;default:v.error("Cannot analyze CIM layer",u.type)}}}}}}function M(e,t,r,i,a){var s=e.primitiveName,o=Object(u.e)(e.color),l=Object(n.b)(JSON.stringify(e)).toString();a.push({type:"fill",templateHash:l,materialHash:0===r.length?l:()=>l,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:A(s,t,"Color",i,o,N),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function S(e,t,r,i,a){var s=e.primitiveName,o=e.tintColor?Object(u.e)(e.tintColor):{r:255,g:255,b:255,a:1},l=Object(n.b)(JSON.stringify(e)).toString(),c=Object(n.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString();a.push({type:"fill",templateHash:l,materialHash:0===r.length?c:()=>c,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:A(s,t,"TintColor",i,o,N),height:A(s,t,"Height",i,e.height),scaleX:A(s,t,"ScaleX",i,e.scaleX),angle:A(s,t,"Rotation",i,e.rotation),offsetX:A(s,t,"OffsetX",i,e.offsetX),offsetY:A(s,t,"OffsetY",i,e.offsetY)})}function w(e,t,r,i,a){var s=["Rotation","OffsetX","OffsetY"],o=r.filter((t=>t.primitiveName!==e.primitiveName&&-1===s.indexOf(t.propertyName))),l=e.primitiveName,c=Object(n.b)(JSON.stringify(e)).toString(),u=Object(n.b)("".concat(e.separation).concat(JSON.stringify(e.lineSymbol))).toString();a.push({type:"fill",templateHash:c,materialHash:0===r.length?u:W(u,t,o,i),cim:e,materialOverrides:o,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:A(l,t,"Separation",i,e.separation),scaleX:1,angle:A(l,t,"Rotation",i,e.rotation),offsetX:A(l,t,"OffsetX",i,e.offsetX),offsetY:A(l,t,"OffsetY",i,e.offsetY)})}function C(e,t,r,i,a){var s=Object(n.b)(JSON.stringify(e)).toString();a.push({type:"fill",templateHash:s,materialHash:0===r.length?s:W(s,t,r,i),cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function I(e,t,r,i,a,s,o){var l=Object(n.b)(JSON.stringify(e)).toString(),c=e.primitiveName,h=Object(u.e)(e.color),f=void 0!==e.width?e.width:4,d=p(e.capStyle),v=m(e.joinStyle),y=e.miterLimit;a.push({type:"line",templateHash:l,materialHash:0===r.length?l:()=>l,cim:e,materialOverrides:null,isOutline:s,colorLocked:e.colorLocked,effects:e.effects,color:A(c,t,"Color",i,h,N),width:A(c,t,"Width",i,f),cap:A(c,t,"CapStyle",i,d),join:A(c,t,"JoinStyle",i,v),miterLimit:A(c,t,"MiterLimit",i,y),referenceWidth:o,zOrder:F(e.name),isDashed:!1})}function k(e,t,r,i,a,s,o){var l=Object(n.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),c=e.primitiveName,h=Object(u.e)(e.tintColor),f=void 0!==e.width?e.width:4,d=p(e.capStyle),v=m(e.joinStyle),y=e.miterLimit,b=Object(n.b)(JSON.stringify(e)).toString();a.push({type:"line",templateHash:b,materialHash:0===r.length?l:()=>l,cim:e,materialOverrides:null,isOutline:s,colorLocked:e.colorLocked,effects:e.effects,color:A(c,t,"TintColor",i,h,N),width:A(c,t,"Width",i,f),cap:A(c,t,"CapStyle",i,d),join:A(c,t,"JoinStyle",i,v),miterLimit:A(c,t,"MiterLimit",i,y),referenceWidth:o,zOrder:F(e.name),isDashed:!1})}function T(e,t,r,i,a,s,o){var l=e.primitiveName,c=void 0!==e.width?e.width:4,u=p(e.capStyle),h=m(e.joinStyle),f=e.miterLimit,d=Object(n.b)(JSON.stringify(e)).toString();a.push({type:"line",templateHash:d,materialHash:0===r.length?d:W(d,t,r,i),cim:e,materialOverrides:null,isOutline:s,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:A(l,t,"Width",i,c),cap:A(l,t,"CapStyle",i,u),join:A(l,t,"JoinStyle",i,h),miterLimit:A(l,t,"MiterLimit",i,f),referenceWidth:o,zOrder:F(e.name),isDashed:!1})}function E(e,t,r,i,a){var s=e.markerPlacement;if(!s||"CIMMarkerPlacementInsidePolygon"!==s.type)return!1;var o=s,l=["Rotation","OffsetX","OffsetY"],c=r.filter((t=>t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName))),u=Object(n.b)(JSON.stringify(e)).toString();return a.push({type:"fill",templateHash:u,materialHash:0===r.length?u:W(u,t,c,i),cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:A(o.primitiveName,t,"StepY",i,o.stepY),scaleX:1,angle:A(o.primitiveName,t,"GridAngle",i,o.gridAngle),offsetX:A(o.primitiveName,t,"OffsetX",i,o.offsetX),offsetY:A(o.primitiveName,t,"OffsetY",i,o.offsetY)}),!0}function P(e,t,r,i,a,s,o){var l=e.primitiveName,c=e.size,h=e.scaleX,f=e.rotation,d=e.offsetX,v=e.offsetY,p=Object(u.e)(e.tintColor),m=Object(n.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),y=!1,b="";for(var _ of r)_.primitiveName===l&&(void 0!==_.value?b+="-".concat(_.primitiveName,"-").concat(_.propertyName,"-").concat(JSON.stringify(_.value)):_.valueExpressionInfo&&(y=!0));a.push({type:"marker",templateHash:Object(n.b)(JSON.stringify(e)+b).toString(),materialHash:y?()=>m:m,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:s,size:A(l,t,"Size",i,c),scaleX:A(l,t,"ScaleX",i,h),rotation:A(l,t,"Rotation",i,f),offsetX:A(l,t,"OffsetX",i,d),offsetY:A(l,t,"OffsetY",i,v),color:A(l,t,"TintColor",i,p,N),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:o,sizeRatio:1,markerPlacement:e.markerPlacement})}function z(e,t,r,i,a,n,s,o){var l=e.markerGraphics;if(l){var c=0;if(e.scaleSymbolsProportionally){var u=e.frame;u&&(c=u.ymax-u.ymin)}for(var h of l)if(h){var f=h.symbol;if(!f)continue;switch(f.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":R(e,h,r,t,i,a,n,s,c,o);break;case"CIMTextSymbol":L(e,h,t,r,i,a,n,s,c)}}}}function L(e,t,r,a,s,o,l,c,h){f.b.findApplicableOverrides(t,a,[]);var d=t.geometry;if("x"in d&&"y"in d){var v,p=t.symbol,m=(v=p).underline?"underline":v.strikethrough?"line-through":"none",_=function(e){var t="normal",r="normal";if(e){var i=e.toLowerCase();-1!==i.indexOf("italic")?t="italic":-1!==i.indexOf("oblique")&&(t="oblique"),-1!==i.indexOf("bold")?r="bold":-1!==i.indexOf("light")&&(r="lighter")}return{style:t,weight:r}}(p.fontStyleName);p.font=Object(i.a)({family:p.fontFamilyName,decoration:m},_);var x=e.frame,g=d.x-.5*(x.xmin+x.xmax),O=d.y-.5*(x.ymin+x.ymax),j=e.size/h,M=e.primitiveName,S=(p.height||0)*j,w=p.angle||0,C=((p.offsetX||0)+g)*j,I=((p.offsetY||0)+O)*j,k=Object(u.e)(f.a.getFillColor(p)),T=Object(u.e)(f.a.getStrokeColor(p)),E=f.a.getStrokeWidth(p);E||(T=Object(u.e)(f.a.getFillColor(p.haloSymbol)),E=p.haloSize*j);var P="";for(var z of a)z.primitiveName===M&&void 0!==z.value&&(P+="-".concat(z.primitiveName,"-").concat(z.propertyName,"-").concat(JSON.stringify(z.value)));var L=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),R=Object(n.b)(JSON.stringify(t)+L+P).toString();o.push({type:"text",templateHash:R,materialHash:()=>Object(n.b)(JSON.stringify(p.font)).toString(),cim:p,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:l,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:p.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:A(M,r,"Size",s,S),angle:A(M,r,"Rotation",s,w),offsetX:A(M,r,"OffsetX",s,C),offsetY:A(M,r,"OffsetY",s,I),horizontalAlignment:y(p.horizontalAlignment),verticalAlignment:b(p.verticalAlignment),text:A(t.primitiveName,r,"TextString",s,t.textString,u.a,p.textCase),color:k,outlineColor:T,outlineSize:E,referenceSize:c,sizeRatio:1,markerPlacement:e.markerPlacement})}}function R(e,t,r,a,s,o,l,c,h,v){var p=t.symbol,m=t.geometry;if(m){var y=p.symbolLayers;if(y)if(v)V(e,t,a,r,s,o,l,c,h);else for(var b=y.length;b--;){var _=y[b];if(_&&!1!==_.enable)switch(_.type){case"CIMSolidFill":case"CIMSolidStroke":var x=function(){var v=Object(d.b)(m);if(!v)return"continue";var[p,y,b]=Object(d.d)(v,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),x="CIMSolidFill"===_.type,g={type:"sdf",geom:m,asFill:x},O=e.primitiveName,j=e.size,M=e.rotation||0,S=e.offsetX,w=e.offsetY,C=_.primitiveName,I=Object(u.e)(x?f.a.getFillColor(_):f.a.getStrokeColor(_)),k=x?{r:0,g:0,b:0,a:0}:Object(u.e)(f.a.getStrokeColor(_)),T=f.a.getStrokeWidth(_);if(!x&&!T)return"break";var E=!1,P="";for(var z of r)z.primitiveName!==C&&z.primitiveName!==O||(void 0!==z.value?P+="-".concat(z.primitiveName,"-").concat(z.propertyName,"-").concat(JSON.stringify(z.value)):z.valueExpressionInfo&&(E=!0));var L=JSON.stringify(Object(i.a)(Object(i.a)({},e),{},{markerGraphics:null})),R=Object(n.b)(JSON.stringify(g)).toString(),V={type:"marker",templateHash:Object(n.b)(JSON.stringify(t)+JSON.stringify(_)+L+P).toString(),materialHash:E?()=>R:R,cim:g,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:y,y:b},isAbsoluteAnchorPoint:!1,size:A(e.primitiveName,a,"Size",s,j),rotation:A(e.primitiveName,a,"Rotation",s,M),offsetX:A(e.primitiveName,a,"OffsetX",s,S),offsetY:A(e.primitiveName,a,"OffsetY",s,w),scaleX:1,frameHeight:h,rotateClockwise:e.rotateClockwise,referenceSize:c,sizeRatio:p,color:A(C,a,"Color",s,I,N),outlineColor:A(C,a,"Color",s,k,N),outlineWidth:A(C,a,"Width",s,T),markerPlacement:e.markerPlacement};return o.push(V),"break"}();if("continue"===x)continue;if("break"===x)break;default:V(e,t,a,r,s,o,l,c,h)}}}}function V(e,t,r,i,a,s,o,l,u){var h,d=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}(e,t),v=["Rotation","OffsetX","OffsetY"];h=i.filter((t=>t.primitiveName!==e.primitiveName||-1===v.indexOf(t.propertyName)));var p="";for(var m of i)void 0!==m.value&&(p+="-".concat(m.primitiveName,"-").concat(m.propertyName,"-").concat(JSON.stringify(m.value)));var[y,b,_]=f.a.getTextureAnchor(d),x=e.primitiveName,g=e.rotation||0,O=e.offsetX||0,j=e.offsetY||0,M=Object(n.b)(JSON.stringify(d)+p).toString(),S={type:"marker",templateHash:M,materialHash:0===h.length?M:W(M,r,h,a),cim:d,materialOverrides:h,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:y,y:b},isAbsoluteAnchorPoint:!1,size:e.size,rotation:A(x,r,"Rotation",a,g),offsetX:A(x,r,"OffsetX",a,O),offsetY:A(x,r,"OffsetY",a,j),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:u,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:_/Object(c.h)(e.size),markerPlacement:e.markerPlacement};s.push(S)}function F(e){if(e&&0===e.indexOf("Level_")){var t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function N(e){if(!e||0===e.length)return null;var t=new l.a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function A(e,t,r,i,a,n,s){var l=t[e];if(l){var c=l[r];if("string"==typeof c||"number"==typeof c||c instanceof Array)return n?n.call(null,c,s):c;if(null!=c&&c instanceof o.a)return(e,t,r)=>{var o=Object(h.a)(c,e,{$view:r},i.geometryType,t);return null!==o&&n&&(o=n.call(null,o,s)),null!==o?o:a}}return a}function W(e,t,r,i){for(var a of r)a.valueExpressionInfo&&function(){var e=t[a.primitiveName]&&t[a.primitiveName][a.propertyName];e instanceof o.a&&(a.fn=(t,r,a)=>Object(h.a)(e,t,{$view:a},i.geometryType,r))}();return(t,i,a)=>{for(var s of r)s.fn&&(s.value=s.fn(t,i,a));return Object(n.b)(e+f.b.buildOverrideKey(r)).toString()}}function D(e,t){if(!t||0===t.length)return e;var r=JSON.parse(JSON.stringify(e));return f.b.applyOverrides(r,t),r}},419:function(e,t,r){"use strict";var i=r(91),a=r(81),n=r(93),s=r(311);var o=new Map;function l(e,t,r){var{transform:l,hasZ:c,hasM:u}=r;o.has(t)||o.set(t,function(e){var t={};switch(e){case"esriGeometryPoint":return(e,r,i,a)=>Object(s.e)(r,t,e,i,a);case"esriGeometryPolygon":return(e,r,i,a)=>Object(s.f)(r,t,e,i,a);case"esriGeometryPolyline":return(e,r,i,a)=>Object(s.g)(r,t,e,i,a);case"esriGeometryMultipoint":return(e,r,i,a)=>Object(s.d)(r,t,e,i,a);default:return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.a("mapview-arcade","Unable to handle geometryType: ".concat(e))),e=>e}}(t));var h=o.get(t)(e.geometry,l,c,u);return Object(i.a)(Object(i.a)({},e),{},{geometry:h})}t.a=function(e,t,r,n,s){var o=e.referencesGeometry()&&s?l(t,n,s):t,c=e.repurposeFeature(o);try{return e.evaluate(Object(i.a)(Object(i.a)({},r),{},{$feature:c}))}catch(u){return a.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}},431:function(e,t,r){"use strict";function i(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}r.d(t,"a",(function(){return i}))},447:function(e,t,r){"use strict";var i=r(105),a=r(285),n=r(365),s=r(156),o=r(187),l=r(448),c=r(287);class u extends(Object(l.a)(c.a)){constructor(e,t,r,n,o,l,c,u,h,f,d,v,p,m,y,b,_,x=!1){super(),this._xOffset=Object(i.h)(v),this._yOffset=Object(i.h)(p),this._decoration=h||"none",this._color=n,this._haloColor=o,this._haloSize=Math.min(Math.floor(5*Object(i.h)(Object(i.k)(r))),127),this._size=Math.min(Math.round(Object(i.h)(t)),127);var g=Math.min(Math.round(Object(i.h)(t)),127);this._referenceSize=Math.round(Math.sqrt(256*g)),this._scale=this._size/24,this._angle=d,this._justify=Object(a.c)(l||"center"),this._xAlignD=Object(a.d)(l||"center"),this._yAlignD=Object(a.f)(c||"baseline"),this._baseline="baseline"===(c||"baseline"),this._bitset=(1===u?1:0)|(f?1:0)<<1;var O=s.e.load(e);O.sdf=!0,this._materialKey=O.data,this._lineWidth=Object(i.h)(m)||512,this._lineHeight=y||1,this._textPlacement=b,this._effects=_,this._isCIM=x}static fromText(e,t){var r=new u(e.materialKey,e.font.size,e.haloSize||0,e.color&&Object(o.d)(e.color)||0,e.haloColor&&Object(o.d)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1),[,i]=Object(n.a)(e.text);return r.bindTextInfo(t,i),r._vertexBoundsScale=e.maxVVSize?e.maxVVSize/e.font.size:1,r}static fromCIMText(e,t){var r=e.scaleFactor||1,i=e.size*e.sizeRatio*r,a=new u(e.materialKey,i,e.outlineSize*e.sizeRatio,Object(o.c)(e.color),Object(o.c)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*r,e.offsetY*e.sizeRatio*r,512,1,e.markerPlacement,e.effects,!0),[,s]=Object(n.a)(e.text);return a.bindTextInfo(t,s),a._vertexBoundsScale=e.maxVVSize?e.maxVVSize/i:1,a}}t.a=u},448:function(e,t,r){"use strict";var i=r(89),a=r(105),n=r(168),s=r(122),o=r(164),l=r(454),c=r(127),u=r(156),h=r(449);t.a=e=>class extends e{constructor(...e){super(...e),this._isCIM=!1,this._vertexBoundsScale=1,this.geometryType=c.d.TEXT,this._aux=Object(o.b)(0,0,this._referenceSize,this._bitset)}bindTextInfo(e,t){e&&e.length?this._shapingInfo=Object(i.b)(e,(e=>Object(l.a)(e,t,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:s.l*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM}))):this._shapingInfo=null}_write(e,t,r){var i=t.getDisplayId();this._writeGeometry(e,t,i,r)}_writeGeometry(e,t,r,a){var s=this._shapingInfo;if(!Object(i.j)(s)){if(Object(i.k)(this._textPlacement)){var o=null!=a?a:t.readLegacyGeometry();return this._writePlacedText(e,r,o,s)}var l=a?Object(n.p)(Object(n.d)(a),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readUnquantizedGeometry();if(l){if(l.isPoint){var[c,u]=l.coords;return this._writeGlyphs(e,r,{x:c,y:u},s)}l.forEachVertex(((t,i)=>this._writeGlyphs(e,r,{x:t,y:i},s)))}}}_writePlacedText(e,t,r,n){var s=Object(i.q)(this._textPlacement),o=h.a.getPlacement(r,s,Object(a.h)(1));if(o)for(var l=o.next();null!=l;){var c=l.getAngle();n.setRotation(c),this._writeGlyphs(e,t,{x:l.tx,y:l.ty},n),n.setRotation(-c),l=o.next()}}_writeGlyphs(e,t,r,i){var a=u.e.load(this._materialKey),n=Object(o.a)(Math.round(8*r.x),Math.round(8*r.y));for(var s of i.glyphs){a.textureBinding=s.textureBinding,e.recordStart(t,a.data,this.geometryType,!1,!0);var l=s.bounds,c=this._vertexBoundsScale;e.vertexBounds(l.x*c,l.y*c,l.width*c,l.height*c),this._writeVertices(e,t,n,s),e.recordEnd()}}_writeGlyph(e,t,r,i,a){var n=u.e.load(this._materialKey),s=Object(o.a)(Math.round(8*r),Math.round(8*i));n.textureBinding=a.textureBinding,e.recordStart(t,n.data,this.geometryType,!1,!0);var l=a.bounds,c=this._vertexBoundsScale;e.vertexBounds(l.x*c,l.y*c,l.width*c,l.height*c),this._writeVertices(e,t,s,a),e.recordEnd()}_writeVertices(e,t,r,i){var a=e.vertexCount();this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.upperLeft),e.vertexWrite(i.texcoords.upperLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.upperRight),e.vertexWrite(i.texcoords.upperRight),e.vertexEnd(),this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.lowerLeft),e.vertexWrite(i.texcoords.lowerLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,i),e.vertexWrite(i.offsets.lowerRight),e.vertexWrite(i.texcoords.lowerRight),e.vertexEnd(),e.indexWrite(a+0),e.indexWrite(a+1),e.indexWrite(a+2),e.indexWrite(a+1),e.indexWrite(a+3),e.indexWrite(a+2)}_writeVertexCommon(e,t,r,i){var a=this._color,n=this._haloColor,s=Object(o.b)(0,0,this._referenceSize,this._bitset),l=Object(o.b)(0,0,this._size,this._haloSize);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(a),e.vertexWrite(n),e.vertexWrite(l),e.vertexWrite(s)}}},449:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(153),a=r(369);class n{static getPlacement(e,t,r){var n=Object(a.b)(t);if(!n)return null;var s=Object(i.c)(e);return n.execute(s,t,r)}}},450:function(e,t,r){"use strict";var i=r(89),a=r(105),n=r(122),s=r(290),o=r(238),l=r(164),c=r(156),u=r(187),h=r(287),f=r(451);class d extends(Object(f.a)(h.a)){constructor(e,t,r,i,a,u,h,f,d,v,p,m,y,b,_,x,g,O,j,M,S){super(),this.angle=i,this.height=h,this.width=u,this.xOffset=t*j,this.yOffset=r*j,this._markerPlacement=M,this._effects=S,this._anchorX=.5-(.5+x)*_.width/_.width,this._anchorY=.5-(.5+g)*_.height/_.height;var w=(1===b?1:0)|(p?1:0)<<1|(y?1:0)<<2|(m?1:0)<<3,C=_&&_.sdf,I=c.d.load(e);I.sdf=C,I.pattern=!0,I.textureBinding=_.textureBinding,this._materialKey=I.data,this._fillColor=a,this._outlineColor=d,this._sizeOutlineWidth=Object(l.b)(Math.round(Math.min(Math.sqrt(128*u),255)),Math.round(Math.min(Math.sqrt(128*h),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*f),255)));var k=_.rect.x+n.q,T=_.rect.y+n.q,E=k+_.width,P=T+_.height;this._offsets.xUpperLeft=k,this._offsets.yUpperLeft=T,this._offsets.xUpperRight=E,this._offsets.yUpperRight=T,this._offsets.xBottomLeft=k,this._offsets.yBottomLeft=P,this._offsets.xBottomRight=E,this._offsets.yBottomRight=P,this._texUpperLeft=Object(l.a)(k,T),this._texUpperRight=Object(l.a)(E,T),this._texBottomLeft=Object(l.a)(k,P),this._texBottomRight=Object(l.a)(E,P),u*=O,h*=O,u*=j,h*=j;var z=Math.round(64*O);this._bitestAndDistRatio=Object(l.a)(w,z),this._computedWidth=u,this._computedHeight=h;var L=Object(o.a)(),R=Object(s.a)();this._applyTransformation(R,L)}static fromCIMMarker(e,t){var r=t&&t.width||1,n=t&&t.height||1,s=e.size,o=r/n*e.scaleX,l=e.scaleSymbolsProportionally&&e.frameHeight?s/e.frameHeight:1,c=Object(u.c)(e.color),h=Object(u.c)(e.outlineColor),f=Object(a.h)(s),v=f*o,p=Object(a.h)(e.offsetX||0),m=Object(a.h)(e.offsetY||0),y=Object(a.h)(e.outlineWidth||0)*l,b=e.alignment||0,_=Object(a.h)(e.referenceSize),x=e.rotation||0;e.rotateClockwise||(x=-x);var g=0,O=0,j=e.anchorPoint;j&&(e.isAbsoluteAnchorPoint?s&&(g=-j.x/(s*o),O=j.y/s):(g=j.x,O=j.y));var M=new d(e.materialKey,p,m,x,c,v,f,_,h,y,e.colorLocked,e.scaleSymbolsProportionally,!1,b,t,g,O,e.sizeRatio,Object(i.r)(e.scaleFactor,1),e.markerPlacement,e.effects);return M._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/v:1,M._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/f:1,M}static fromPictureMarker(e,t){var r=Math.round(Object(a.h)(e.width)),i=Math.round(Object(a.h)(e.height)),s=n.p,o=Math.round(Object(a.h)(e.xoffset||0)),l=Math.round(Object(a.h)(e.yoffset||0)),c=new d(e.materialKey,o,l,e.angle,s,r,i,i,0,0,!1,!1,!1,0,t,0,0,1,1,null,null);return c._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.width:1,c._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1,c}static fromSimpleMarker(e,t){var r=Object(u.d)(e.color),i=Math.round(Object(a.h)(e.size)),n=i,s=Math.round(Object(a.h)(e.xoffset||0)),o=Math.round(Object(a.h)(e.yoffset||0)),l=e.style,c=e.outline,h=0|(c&&c.color&&Object(u.d)(c.color)),f=0|(c&&c.width&&Math.round(Object(a.h)(c.width))),v=new d(e.materialKey,s,o,e.angle,r,i,n,n,h,f,!1,!1,"esriSMSCross"===l||"esriSMSX"===l,0,t,0,0,126/64,1,null,null);return v.boundsType="esriSMSCircle"===l?"circle":"square",v._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1,v._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1,v}static fromLineSymbolMarker(e,t){var r,i=Object(u.d)(e.color),n=Math.round(Object(a.h)(6*e.lineWidth)),s=n,o="cross"===e.style||"x"===e.style;switch(e.placement){case"begin-end":r="Both";break;case"begin":r="JustBegin";break;case"end":r="JustEnd";break;default:r="None"}var l={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:r,offsetAlongLine:0},c=new d(e.materialKey,0,0,0,i,n,s,s/6,i,o?Math.round(Object(a.h)(e.lineWidth)):0,!1,!1,o,1,t,0,0,126/64,1,l,null);return c.boundsType="circle"===e.style?"circle":"square",c}}t.a=d},451:function(e,t,r){"use strict";var i=r(89),a=r(105),n=r(168),s=r(135),o=r(321),l=r(290),c=r(238),u=r(164),h=r(127),f=r(449),d=3.14159265359/180;t.a=e=>class extends e{constructor(...e){super(...e),this.angle=0,this.xOffset=0,this.yOffset=0,this.width=0,this.height=0,this.boundsType="square",this._anchorX=0,this._anchorY=0,this._computedWidth=0,this._computedHeight=0,this._vertexBoundsScaleX=1,this._vertexBoundsScaleY=1,this._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},this.geometryType=h.d.MARKER}_write(e,t,r){var i=t.getDisplayId();e.recordStart(i,this._materialKey,this.geometryType,!1,!0),this._writeGeometry(e,t,i,r),e.recordEnd()}_writeGeometry(e,t,r,a){if(Object(i.k)(this._markerPlacement))return this._writePlacedMarkers(e,t,a);var s=a?Object(n.p)(Object(n.d)(a),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readUnquantizedGeometry();if(s){if(s.isPoint){var[o,l]=s.coords;if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(o<-1||o>=513||l<-1||l>=513))return;return this._writeVertices(e,r,this._getPos(o,l),o,l)}s.forEachVertex(((t,i)=>this._writeVertices(e,r,this._getPos(t,i),t,i)))}}_writePlacedMarkers(e,t,r){var n=null!=r?r:t.readLegacyGeometry(),s=f.a.getPlacement(n,Object(i.q)(this._markerPlacement),Object(a.h)(1));if(s)for(var o=t.getDisplayId(),u=Object(c.a)(),h=Object(l.a)(),v=s.next();null!=v;){var{tx:p,ty:m}=v;p>=-128&&p<=640&&m>=-128&&m<=640&&(this._applyTransformation(h,u,v.getAngle()/d),this._writeVertices(e,o,this._getPos(p,m),p,m)),v=s.next()}}_writeVertices(e,t,r,i,a){var n=e.vertexCount();e.vertexBounds(i+this.xOffset,a-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY),e.vertexWrite(r),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(this._texUpperLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(this._texUpperRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(this._texBottomLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(this._texBottomRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.indexWrite(n+0),e.indexWrite(n+1),e.indexWrite(n+2),e.indexWrite(n+1),e.indexWrite(n+3),e.indexWrite(n+2)}_applyTransformation(e,t,r=0){Object(o.d)(e),Object(o.h)(e,e,Object(c.b)(this.xOffset,-this.yOffset)),this.angle+r!==0&&Object(o.f)(e,e,d*(this.angle+r));var i=this._computedWidth,a=this._computedHeight,n=(this._anchorX-.5)*i,l=(this._anchorY-.5)*a;Object(s.r)(t,n,l),Object(s.s)(t,t,e),this._offsetUpperLeft=Object(u.a)(16*t[0],16*t[1]),this._offsets.xUpperLeft=t[0],this._offsets.yUpperLeft=t[1],Object(s.r)(t,n+i,l),Object(s.s)(t,t,e),this._offsetUpperRight=Object(u.a)(16*t[0],16*t[1]),this._offsets.xUpperRight=t[0],this._offsets.yUpperRight=t[1],Object(s.r)(t,n,l+a),Object(s.s)(t,t,e),this._offsetBottomLeft=Object(u.a)(16*t[0],16*t[1]),this._offsets.xBottomLeft=t[0],this._offsets.yBottomLeft=t[1],Object(s.r)(t,n+i,l+a),Object(s.s)(t,t,e),this._offsetBottomRight=Object(u.a)(16*t[0],16*t[1]),this._offsets.xBottomRight=t[0],this._offsets.yBottomRight=t[1]}_getPos(e,t){return Object(u.a)(Math.round(8*e),Math.round(8*t))}}},452:function(e,t,r){"use strict";r.d(t,"a",(function(){return He})),r.d(t,"b",(function(){return Ye}));var i=r(91),a=r(7),n=r(81),s=r(93),o=r(94),l=r(234),c=r(319),u=r(360),h=r(447),f=r(450),d=r(110),v=r(105),p=r(122),m=r(164),y=r(156),b=r(187),_=r(399),x=r(232),g=r(89),O=r(168),j=r(127),M=r(178),S=(r(536),r(537));function w(e,t,r,i,a,n,s){H=0;var o,l,c,u,h,f=(i-r)*n,d=a&&a.length,v=d?(a[0]-r)*n:f,p=C(t,r,i,0,v,n,!0);if(p&&p.next!==p.prev){if(d&&(p=function(e,t,r,i,a,n){for(var s=new Array,o=0,l=i.length;o<l;o++){var c=C(e,t,r,i[o]*n,o<l-1?i[o+1]*n:r*n,n,!1);c===c.next&&(c.steiner=!0),s.push(L(c))}for(var u of(s.sort(q),s))R(u,a),a=I(a,a.next);return a}(t,r,i,a,p,n)),f>80*n){o=c=t[0+r*n],l=u=t[1+r*n];for(var m=n;m<v;m+=n){var y=t[m+r*n],b=t[m+1+r*n];o=Math.min(o,y),l=Math.min(l,b),c=Math.max(c,y),u=Math.max(u,b)}h=0!==(h=Math.max(c-o,u-l))?1/h:0}k(p,e,n,o,l,h,s,0)}}function C(e,t,r,i,a,n,s){var o;if(s===function(e,t,r,i,a,n){for(var s=0,o=i,l=a-n;o<a;o+=n)s+=(e[l+t*n]-e[o+t*n])*(e[o+1+t*n]+e[l+1+t*n]),l=o;return s}(e,t,0,i,a,n)>0)for(var l=i;l<a;l+=n)o=P(l+t*n,e[l+t*n],e[l+1+t*n],o);else for(var c=a-n;c>=i;c-=n)o=P(c+t*n,e[c+t*n],e[c+1+t*n],o);return o&&B(o,o.next)&&(z(o),o=o.next),o}function I(e,t=e){if(!e)return e;var r,i=e;do{if(r=!1,i.steiner||!B(i,i.next)&&0!==F(i.prev,i,i.next))i=i.next;else{if(z(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function k(e,t,r,i,a,n,s,o){if(e){!o&&n&&(e=V(e,i,a,n));for(var l=e;e.prev!==e.next;){var c=e.prev,u=e.next;if(n?E(e,i,a,n):T(e))t.push(c.index/r+s),t.push(e.index/r+s),t.push(u.index/r+s),z(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?k(e=U(e,t,r,s),t,r,i,a,n,s,2):2===o&&G(e,t,r,i,a,n,s):k(I(e),t,r,i,a,n,s,1);break}}}}function T(e){var t=e.prev,r=e,i=e.next;if(F(t,r,i)>=0)return!1;for(var a=e.next.next,n=a,s=0;a!==e.prev&&(0===s||a!==n);){if(s++,A(t.x,t.y,r.x,r.y,i.x,i.y,a.x,a.y)&&F(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function E(e,t,r,i){var a=e.prev,n=e,s=e.next;if(F(a,n,s)>=0)return!1;for(var o=a.x<n.x?a.x<s.x?a.x:s.x:n.x<s.x?n.x:s.x,l=a.y<n.y?a.y<s.y?a.y:s.y:n.y<s.y?n.y:s.y,c=a.x>n.x?a.x>s.x?a.x:s.x:n.x>s.x?n.x:s.x,u=a.y>n.y?a.y>s.y?a.y:s.y:n.y>s.y?n.y:s.y,h=D(o,l,t,r,i),f=D(c,u,t,r,i),d=e.prevZ,v=e.nextZ;d&&d.z>=h&&v&&v.z<=f;){if(d!==e.prev&&d!==e.next&&A(a.x,a.y,n.x,n.y,s.x,s.y,d.x,d.y)&&F(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==e.prev&&v!==e.next&&A(a.x,a.y,n.x,n.y,s.x,s.y,v.x,v.y)&&F(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&A(a.x,a.y,n.x,n.y,s.x,s.y,d.x,d.y)&&F(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=f;){if(v!==e.prev&&v!==e.next&&A(a.x,a.y,n.x,n.y,s.x,s.y,v.x,v.y)&&F(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function P(e,t,r,i){var a=K.create(e,t,r);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function L(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function R(e,t){if(t=function(e,t){var r,i=t,a=e.x,n=e.y,s=-1/0;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var o=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=a&&o>s){if(s=o,o===a){if(n===i.y)return i;if(n===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(a===s)return r.prev;var l,c=r,u=r.x,h=r.y,f=1/0;for(i=r.next;i!==c;)a>=i.x&&i.x>=u&&a!==i.x&&A(n<h?a:s,n,u,h,n<h?s:a,n,i.x,i.y)&&(((l=Math.abs(n-i.y)/(a-i.x))<f||l===f&&i.x>r.x)&&W(i,e)&&(r=i,f=l)),i=i.next;return r}(e,t)){var r=Z(t,e);I(r,r.next)}}function V(e,t,r,i){for(var a;a!==e;a=a.next){if(null===(a=a||e).z&&(a.z=D(a.x,a.y,t,r,i)),a.prev.next!==a||a.next.prev!==a)return a.prev.next=a,a.next.prev=a,V(e,t,r,i);a.prevZ=a.prev,a.nextZ=a.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var i=void 0,a=e;e=null,t=null;for(var n=0;a;){n++,i=a;for(var s=0;s<r&&i;s++)i=i.nextZ;for(var o=r;s>0||o>0&&i;){var l=void 0;0===s?(l=i,i=i.nextZ,o--):0!==o&&i?a.z<=i.z?(l=a,a=a.nextZ,s--):(l=i,i=i.nextZ,o--):(l=a,a=a.nextZ,s--),t?t.nextZ=l:e=l,l.prevZ=t,t=l}a=i}if(t.nextZ=null,r*=2,n<2)return e}}(e)}function F(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function N(e,t,r,i){return!!(B(e,t)&&B(r,i)||B(e,i)&&B(r,t))||F(e,t,r)>0!=F(e,t,i)>0&&F(r,i,e)>0!=F(r,i,t)>0}function A(e,t,r,i,a,n,s,o){return(a-s)*(t-o)-(e-s)*(n-o)>=0&&(e-s)*(i-o)-(r-s)*(t-o)>=0&&(r-s)*(n-o)-(a-s)*(i-o)>=0}function W(e,t){return F(e.prev,e,e.next)<0?F(e,t,e.next)>=0&&F(e,e.prev,t)>=0:F(e,t,e.prev)<0||F(e,e.next,t)<0}function D(e,t,r,i,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function B(e,t){return e.x===t.x&&e.y===t.y}function q(e,t){return e.x-t.x}function U(e,t,r,i){var a=e;do{var n=a.prev,s=a.next.next;!B(n,s)&&N(n,a,a.next,s)&&W(n,s)&&W(s,n)&&(t.push(n.index/r+i),t.push(a.index/r+i),t.push(s.index/r+i),z(a),z(a.next),a=e=s),a=a.next}while(a!==e);return a}function G(e,t,r,i,a,n,s){var o=e;do{for(var l=o.next.next;l!==o.prev;){if(o.index!==l.index&&X(o,l)){var c=Z(o,l);return o=I(o,o.next),c=I(c,c.next),k(o,t,r,i,a,n,s,0),void k(c,t,r,i,a,n,s,0)}l=l.next}o=o.next}while(o!==e)}function X(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&N(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&W(e,t)&&W(t,e)&&function(e,t){var r=e,i=!1,a=(e.x+t.x)/2,n=(e.y+t.y)/2;do{r.y>n!=r.next.y>n&&r.next.y!==r.y&&a<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)}function Z(e,t){var r=K.create(e.index,e.x,e.y),i=K.create(t.index,t.x,t.y),a=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,i.next=r,r.prev=i,n.next=i,i.prev=n,i}class K{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(e,t,r){var i=H<Y.length?Y[H++]:new K;return i.index=e,i.x=t,i.y=r,i.prev=null,i.next=null,i.z=null,i.prevZ=null,i.nextZ=null,i.steiner=!1,i}}for(var Y=new Array,H=0,J=0;J<8096;J++)Y.push(new K);var Q=r(538),$=new Q.a,ee=new S.b(0,0,0,1,0),te=new S.b(0,0,0,1,0);function re(e,t,r){for(var i=0,a=1;a<r;a++){var n=e[2*(t+a-1)],s=e[2*(t+a-1)+1];i+=(e[2*(t+a)]-n)*(e[2*(t+a)+1]+s)}return i}function ie(e,t,r,i,a){for(var n=0,s=r;s<i;s+=3){var o=2*(e.getValue(s)-a),l=2*(e.getValue(s+1)-a),c=2*(e.getValue(s+2)-a);n+=Math.abs((t[o]-t[c])*(t[l+1]-t[o+1])-(t[o]-t[l])*(t[c+1]-t[o+1]))}return n}ee.setExtent(p.E),te.setExtent(p.E);var ae=e=>class extends e{constructor(...e){super(...e),this.forceLibtess=!1,this.geometryType=j.d.FILL}_write(e,t,r){var i="esriGeometryPoint"===t.geometryType,a=y.a.load(this._materialKey);e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,a.dotDensity,i),this._writeGeometry(e,t,a,r,i),e.recordEnd()}_writeGeometry(e,t,r,i,a){var n=this._getGeometry(t,i,a);if(!Object(g.j)(n)){var s=e.indexCount();if(n.lengths[0]>1e3||this.forceLibtess||!function(e,t){var{coords:r,lengths:i,hasIndeterminateRingOrder:a}=t,n=e.indexWriter(),s=e.vertexCount();if(a)return!1;for(var o=n.length,l=0,c=0;c<i.length;){for(var u=c,h=i[c],f=re(r,l,h),d=[];++u<i.length;){var v=i[u],p=re(r,l+h,v);if(!(p>0))break;f+=p,d.push(l+h),h+=v}var m=n.length;w(n,r,l,l+h,d,2,s);var y=ie(n,r,m,n.length,s),b=Math.abs(f);if(Math.abs((y-b)/Math.max(1e-7,b))>1e-5)return n.seek(o),!1;c=u,l+=h}return!0}(e,n)){var o=function(e,t){var r=[],i=[],a=e.indexWriter(),n=e.vertexCount(),{coords:s,lengths:o}=t;$.beginPolygon(r,i);for(var l=0,c=0;c<o.length;c++){var u=t.lengths[c];$.beginContour();for(var h=0;h<u;h++){var f=[s[2*(l+h)],s[2*(l+h)+1],0];$.addVertex(f,f)}$.endContour(),l+=u}$.endPolygon();for(var d=0;d<i.length;d++)a.push(i[d]+n);return r}(e,n);s!==e.indexCount()&&this._writeVertices(e,t,o,[o.length/2],r)}else!(s===e.indexCount())&&this._writeVertices(e,t,n.coords,n.lengths,r)}}_writeVertices(e,t,r,i,a){var n=t.getDisplayId(),s=0;for(var o of i){for(var l=o+s,c=s;c<l;c++){var u=r[2*c],h=r[2*c+1],f=Object(m.a)(1*u,1*h);e.vertexBounds(u,h,0,0),e.vertexWrite(f),e.vertexWrite(n),a.dotDensity?e.vertexWriteF32(1/Math.abs(t.readGeometryArea())):(e.vertexWrite(this.fillColor),e.vertexWrite(this.tl),e.vertexWrite(this.br),e.vertexWrite(this.aux1),e.vertexWrite(this.aux2),e.vertexWrite(this.aux3))}s+=o}}_getGeometry(e,t,r){var i=t?Object(O.p)(Object(O.d)(t),2):e.readUnquantizedGeometry();return i?function(e,t){if(!function(e,t,r){for(var i=0,a=0;a<e.lengths.length;a++){for(var n=e.lengths[a],s=0;s<n;s++){var o=e.coords[2*(s+i)],l=e.coords[2*(s+i)+1];if(o<t||o>r||l<t||l>r)return!0}i+=n}return!1}(e,-128,p.E+128))return e;ee.setPixelMargin(t),ee.reset(3);for(var r=0,i=0;i<e.lengths.length;i++){var a=e.lengths[i],n=e.coords[2*(0+r)],s=e.coords[2*(0+r)+1];ee.moveTo(n,s);for(var o=1;o<a;o++)n=e.coords[2*(o+r)],s=e.coords[2*(o+r)+1],ee.lineTo(n,s);ee.close(),r+=a}var l=ee.result(!1);if(!l)return null;var c=[],u=[];for(var h of l){var f=0;for(var d of h)u.push(d.x),u.push(d.y),f++;c.push(f)}return new M.a(c,u)}(i,r?256:128):null}},ne=r(418),se=r(287),oe=n.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");class le extends se.a{constructor(e){super(),this._ongoingMaterialRequestMap=new Map,this._materialCache=new Map,this._dynamicPropertyMap=new Map,this._cimLayer=e}analyze(e,t,r,i){var a=t.readLegacyFeature(),n=this._materialCache,s=this._cimLayer.materialHash;if(!s)return oe.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);var o="function"==typeof s?s(a,r,i):s;if(n.has(o)){var l=n.get(o);return Promise.resolve(l)}if(this._ongoingMaterialRequestMap.has(o))return this._ongoingMaterialRequestMap.get(o);var c=Object(ne.a)(this._cimLayer.cim,this._cimLayer.materialOverrides);c.mosaicHash=o;var u=e.getMosaicItem(c).then((e=>(this._ongoingMaterialRequestMap.delete(o),n.set(o,e),e))).catch((e=>(this._ongoingMaterialRequestMap.delete(o),oe.error(".analyze()",e.message),null)));return this._ongoingMaterialRequestMap.set(o,u),u}}var ce=le,ue=128;class he extends(ae(ce)){constructor(e){var t;if(super(e),Object(x.c)(e.color)){this._dynamicPropertyMap.set("_fillColor",((t,r,i)=>{var a=e.color(t,r,i);return a&&Object(b.c)(a)||0}))}else{var r=e.color;this.fillColor=r&&Object(b.c)(r)||0}var i=0;Object(x.c)(e.height)||(i=e.height||0);var a="CIMMarkerPlacementInsidePolygon"===(null==(t=e.cim.placement)?void 0:t.type)&&e.cim.placement.shiftOddRows?2:1;this._dynamicPropertyMap.set("_height",((t,r,n)=>Object(x.c)(e.height)?e.height(t,r,n)*a:i*a));var n=0;Object(x.c)(e.offsetX)||(n=Object(v.h)(e.offsetX||0)+ue)>255&&(n=255);this._dynamicPropertyMap.set("_offsetX",((t,r,i)=>{if(Object(x.c)(e.offsetX)){var a=Object(v.h)(e.offsetX(t,r,i))+ue;return a>255&&(a=255),a}return n}));var s=1;Object(x.c)(e.scaleX)||(s=e.scaleX||1);this._dynamicPropertyMap.set("_scaleX",((t,r,i)=>Object(x.c)(e.scaleX)?e.scaleX(t,r,i):s));var o=0;Object(x.c)(e.offsetY)||(o=Object(v.h)(-e.offsetY||0)+ue)>255&&(o=255);this._dynamicPropertyMap.set("_offsetY",((t,r,i)=>{if(Object(x.c)(e.offsetY)){var a=Object(v.h)(-e.offsetY(t,r,i))+ue;return a>255&&(a=255),a}return o}));var l=0;Object(x.c)(e.angle)||(l=Object(_.d)(e.angle)||0);this._dynamicPropertyMap.set("_angle",((t,r,i)=>Object(x.c)(e.angle)?Object(_.d)(e.angle(t,r,i)):l)),this._effects=e.effects,this._cimFillLayer=e,this._fillMaterialKey=y.a.load(e.materialKey)}static fromCIMFill(e){return new he(e)}bindFeature(e,t,r){var i=e.readLegacyFeature();this._dynamicPropertyMap.forEach(((e,a)=>{this[a]=e(i,t,r)}));var a=this._fillMaterialKey,n=this._materialCache,s=this._cimFillLayer;this.aux3=Object(m.b)(0,0,this._angle,s.colorLocked?1:0);var o=(0,s.materialHash)(i,t,r),l=n.get(o),u=null;if(l&&Object(c.a)(l.spriteMosaicItem)&&(u=l.spriteMosaicItem),u){var{rect:h,width:f,height:y}=u,b=h.x+p.q,_=h.y+p.q,x=b+f,g=_+y,O=Object(d.o)(Object(v.h)(this._height));O>255?O=255:O<=0&&(O=Object(d.o)(g-_));var j=Object(d.o)(Object(v.h)(this._height/y*f||0));j>255?j=255:j<=0&&(j=Object(d.o)(x-b));var M=this._scaleX;this.tl=Object(m.a)(b,_),this.br=Object(m.a)(x,g),this.aux1=Object(m.b)(j,O,this._offsetX,this._offsetY),this.aux2=Object(m.a)(ue*M,128),a.sdf=u.sdf,a.pattern=!0,a.textureBinding=u.textureBinding}else this.tl=0,this.br=0,this.aux1=0,this.aux2=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data}}var fe=he,de=r(539),ve=31,pe=1024,me=1/3.8,ye=e=>t=>{var r=e.out,i=Math.ceil(pe*e._halfWidth),a=Math.ceil(pe*e._halfReferenceWidth);t.entry0=e.offset+e.vertexCount++;var n=Object(m.a)(t.distance,i),s=Object(m.b)(Math.round(ve*t.prevNormal.x),Math.round(ve*t.prevNormal.y),Math.round(0),Math.round(-31)),o=Object(m.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(m.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(s),r.vertexWrite(n),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(o),r.vertexWrite(Object(m.a)(a,0)),r.vertexEnd(),t.entry2=e.offset+e.vertexCount++;var l=Object(m.a)(t.distance,i),c=Object(m.b)(Math.round(ve*-t.prevNormal.x),Math.round(ve*-t.prevNormal.y),Math.round(0),Math.round(31)),u=Object(m.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(m.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(c),r.vertexWrite(l),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(u),r.vertexWrite(Object(m.a)(a,0)),r.vertexEnd(),t.exit0=e.offset+e.vertexCount++;var h=Object(m.a)(t.distance,i),f=Object(m.b)(Math.round(ve*t.nextNormal.x),Math.round(ve*t.nextNormal.y),Math.round(0),Math.round(-31)),d=Object(m.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(m.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(f),r.vertexWrite(h),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(d),r.vertexWrite(Object(m.a)(a,0)),r.vertexEnd(),t.exit2=e.offset+e.vertexCount++;var v=Object(m.a)(t.distance,i),p=Object(m.b)(Math.round(ve*-t.nextNormal.x),Math.round(ve*-t.nextNormal.y),Math.round(0),Math.round(31)),y=Object(m.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(m.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(p),r.vertexWrite(v),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(y),r.vertexWrite(Object(m.a)(a,0)),r.vertexEnd()},be=e=>t=>{var r=e.out;r.indexWrite(t.leftExit0),r.indexWrite(t.rightEntry0),r.indexWrite(t.leftExit2),r.indexWrite(t.rightEntry0),r.indexWrite(t.rightEntry2),r.indexWrite(t.leftExit2),e.indexCount+=6},_e=e=>(t,r,i,a,n,s,o,l,c)=>{var u=Object(m.a)(c,Math.ceil(pe*e._halfWidth)),h=Object(m.b)(Math.round(ve*n),Math.round(ve*s),Math.round(ve*o),Math.round(ve*l)),f=Object(m.b)(ve*i,ve*a,0,e._bitset),d=e.out;return d.vertexBounds(t,r,1,1),d.vertexWrite(Object(m.a)(8*t,8*r)),d.vertexWrite(e.id),d.vertexWrite(e._fillColor),d.vertexWrite(h),d.vertexWrite(u),d.vertexWrite(e._tl),d.vertexWrite(e._br),d.vertexWrite(f),d.vertexWrite(Object(m.a)(Math.ceil(pe*e._halfReferenceWidth),0)),d.vertexEnd(),e.offset+e.vertexCount++},xe=e=>(t,r,i)=>{var a=e.out;a.indexWrite(t),a.indexWrite(r),a.indexWrite(i),e.indexCount+=3},ge=e=>class extends e{constructor(...e){super(...e),this.tessellationProperties={},this._tessellationOptions={},this.geometryType=j.d.LINE}_initializeTessellator(e){var t=y.c.load(this._materialKey),r=this._tessellationOptions,i=t.vvSizeFieldStops||t.vvSizeMinMaxValue||t.vvSizeScaleStops||t.vvSizeUnitValue,a=this.tessellationProperties._halfWidth<p.D/2;if(r.thin=a&&!e&&!i,r.trackDistance=this._isDashed||this._hasPattern,r.wrapDistance=65535,r.innerBisectorAutoSplitThreshold=me,r.outerBisectorAutoSplitThreshold=me,r.enableInnerBisectorSplit=this._isDashed||this._hasPattern,r.enableOuterBisectorSplit=this._isDashed||this._hasPattern,r.thin)this._tessellationCallbacks={vertex:ye(this.tessellationProperties),bridge:be(this.tessellationProperties)};else{var n=new de.a(_e(this.tessellationProperties),xe(this.tessellationProperties));n.miterLimitCosine=this._miterLimitCosine,n.textured=this._isDashed||this._hasPattern,n.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=n}}_write(e,t,r){var i="esriGeometryPoint"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,!1,i),this._writeGeometry(e,t,r,i),e.recordEnd()}_writeGeometry(e,t,r,i){var a=null!=r?r:t.readLegacyGeometry(),n=this._getLines(a,i);Object(g.j)(n)||this._writeVertices(e,t,n)}_getLines(e,t){if(Object(g.j)(e))return null;var r=e.paths||e.rings;return Object(g.j)(r)?null:function(e,t){te.setPixelMargin(t);for(var r=te,i=-t,a=p.E+t,n=[],s=!1,o=0;o<e.length;){var l=[],c=e[o];r.reset(2);var[u,h]=c[0];if(s)r.moveTo(u,h);else{if(u<i||u>a||h<i||h>a){s=!0;continue}l.push({x:u,y:h})}for(var f=!1,d=c.length,v=1;v<d;++v)if(u+=c[v][0],h+=c[v][1],s)r.lineTo(u,h);else{if(u<i||u>a||h<i||h>a){f=!0;break}l.push({x:u,y:h})}if(f)s=!0;else{if(s){var m=r.resultWithStarts();if(m)for(var y of m)n.push(y)}else n.push({line:l,start:0});o++,s=!1}}return 0===(n=n.filter((e=>e.line.length>1))).length?null:n}(r,t?256:16)}_writeVertices(e,t,r){var i=t.getDisplayId(),a=e.vertexCount(),n=this.tessellationProperties;for(var{line:s,start:o}of(n.out=e,n.id=i,n.indexCount=0,n.vertexCount=0,n.offset=a,r))this._tessellationOptions.initialDistance=o%65535,this._tessellationCallbacks instanceof de.a&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),Object(de.d)(s,this._tessellationOptions,this._tessellationCallbacks),Object(de.b)()}};class Oe extends(ge(ce)){constructor(e){super(e),this._cimLineLayer=e;var t=0;Object(x.c)(e.width)||(t=.5*Object(v.h)(e.width));if(this._dynamicPropertyMap.set("_halfWidth",((r,i,a)=>Object(x.c)(e.width)?.5*Object(v.h)(e.width(r,i,a)):t)),Object(x.c)(e.cap)?this._dynamicPropertyMap.set("_capType",e.cap):this._capType=e.cap,Object(x.c)(e.join)?this._dynamicPropertyMap.set("_joinType",e.join):this._joinType=e.join,Object(x.c)(e.color)){this._dynamicPropertyMap.set("_fillColor",((t,r,i)=>{var a=e.color(t,r,i);return a&&Object(b.c)(a)||0}))}else{var r=e.color;this._fillColor=r&&Object(b.c)(r)||0}if(Object(x.c)(e.miterLimit)){this._dynamicPropertyMap.set("_miterLimitCosine",((t,r,i)=>Object(x.b)(e.miterLimit(t,r,i))))}else this._miterLimitCosine=Object(x.b)(e.miterLimit);this._scaleFactor=e.scaleFactor||1,this._isDashed=e.isDashed,this._effects=e.effects,this.tessellationProperties._bitset=e.colorLocked?1:0,this._materialKey=e.materialKey,this._initializeTessellator(!0)}static fromCIMLine(e){return new Oe(e)}bindFeature(e,t,r){var i=e.readLegacyFeature();this._dynamicPropertyMap.forEach(((e,a)=>{this[a]=e(i,t,r)})),this._halfWidth*=this._scaleFactor;var a=this._materialCache,n=(0,this._cimLineLayer.materialHash)(i,t,r),s=a.get(n),o=null;if(s&&Object(c.a)(s.spriteMosaicItem)&&(o=s.spriteMosaicItem),o){this._hasPattern=!0;var{rect:l,width:u,height:h}=o,f=l.x+p.q,d=l.y+p.q,v=f+u,b=d+h;this.tessellationProperties._tl=Object(m.a)(f,d),this.tessellationProperties._br=Object(m.a)(v,b)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;var _=y.c.load(this._materialKey);o&&(_.sdf=o.sdf,_.pattern=!0,_.textureBinding=o.textureBinding),this._materialKey=_.data}}var je=Oe,Me=r(290),Se=r(238),we=r(451),Ce=Object(Se.a)(),Ie=Object(Me.a)(),ke=n.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");class Te extends(Object(we.a)(ce)){constructor(e){if(super(e),this._cimMarkerLayer=e,Object(x.c)(e.color)){this._dynamicPropertyMap.set("_fillColor",((t,r,i)=>Object(b.c)(e.color(t,r,i))))}else this._fillColor=Object(b.c)(e.color);if(Object(x.c)(e.outlineColor)){this._dynamicPropertyMap.set("_outlineColor",((t,r,i)=>Object(b.c)(e.outlineColor(t,r,i))))}else this._outlineColor=Object(b.c)(e.outlineColor);if(Object(x.c)(e.size)){this._dynamicPropertyMap.set("_size",((t,r,i)=>Object(v.h)(e.size(t,r,i))))}else this._size=Object(v.h)(e.size);if(Object(x.c)(e.scaleX)?this._dynamicPropertyMap.set("_scaleX",e.scaleX):this._scaleX=e.scaleX,Object(x.c)(e.offsetX)){this._dynamicPropertyMap.set("xOffset",((t,r,i)=>Object(v.h)(e.offsetX(t,r,i))))}else this.xOffset=Object(v.h)(e.offsetX);if(Object(x.c)(e.offsetY)){this._dynamicPropertyMap.set("yOffset",((t,r,i)=>Object(v.h)(e.offsetY(t,r,i))))}else this.yOffset=Object(v.h)(e.offsetY);if(Object(x.c)(e.outlineWidth)){this._dynamicPropertyMap.set("_outlineWidth",((t,r,i)=>Object(v.h)(e.outlineWidth(t,r,i))))}else this._outlineWidth=Object(v.h)(e.outlineWidth);Object(x.c)(e.rotation)?this._dynamicPropertyMap.set("_angle",e.rotation):this._angle=e.rotation,this._scaleFactor=Object(g.r)(e.scaleFactor,1),this._markerPlacement=e.markerPlacement,this._effects=e.effects,this._bitSet=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3,this._materialKey=e.materialKey}static fromCIMMarker(e){return new Te(e)}bindFeature(e,t,r){var i=e.readLegacyFeature();this._dynamicPropertyMap.forEach(((e,a)=>{this[a]=e(i,t,r)}));var a=this._cimMarkerLayer.materialHash,n="function"==typeof a?a(i,t,r):a,o=this._materialCache.get(n);if(o&&Object(c.a)(o.spriteMosaicItem)&&o.spriteMosaicItem){var l=o.spriteMosaicItem,u=this._cimMarkerLayer.sizeRatio,h=l.width/l.height*this._scaleX,f=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,d=this._size,b=d*h,_=this.xOffset,x=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;var g=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/Object(v.h)(this._cimMarkerLayer.frameHeight):1,O=this._outlineWidth*g,j=Object(v.h)(this._cimMarkerLayer.referenceSize),M=0,S=0,w=this._cimMarkerLayer.anchorPoint;w&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(M=-w.x/(this._size*h),S=w.y/this._size):(M=w.x,S=w.y)),this._sizeOutlineWidth=Object(m.b)(Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*d),255)),Math.round(Math.min(Math.sqrt(128*O),255)),Math.round(Math.min(Math.sqrt(128*j),255))),this.angle=f;var C=Math.round(64*u);this._bitestAndDistRatio=Object(m.a)(this._bitSet,C);var I=l.rect.x+p.q,k=l.rect.y+p.q,T=I+l.width,E=k+l.height;this._texUpperLeft=Object(m.a)(I,k),this._texUpperRight=Object(m.a)(T,k),this._texBottomLeft=Object(m.a)(I,E),this._texBottomRight=Object(m.a)(T,E);var P=y.d.load(this._materialKey);P.sdf=l.sdf,P.pattern=!0,P.textureBinding=l.textureBinding,this._materialKey=P.data,this._anchorX=.5-(.5+M)*l.width/l.width,this._anchorY=.5-(.5+S)*l.height/l.height,b*=u,d*=u,b*=this._scaleFactor,d*=this._scaleFactor,b*=l.rect.width/l.width,d*=l.rect.height/l.height,this._computedWidth=b,this._computedHeight=d,this._applyTransformation(Ie,Ce),this.xOffset=_,this.yOffset=x}else ke.error(new s.a("mapview-cim","Encountered an error when binding feature"))}}var Ee=Te,Pe=r(431),ze=r(285),Le=r(448);class Re extends(Object(Le.a)(ce)){constructor(e){super(e),this._horizontalAlignment="center",this._verticalAlignment="middle",this._textToGlyphs=new Map;var t,r=e.scaleFactor||1;if(this._cimTextLayer=e,Object(x.c)(e.color)){this._dynamicPropertyMap.set("_color",((t,r,i)=>Object(b.c)(e.color(t,r,i))))}else this._color=Object(b.c)(e.color);if(Object(x.c)(e.color)){this._dynamicPropertyMap.set("_haloColor",((t,r,i)=>Object(b.c)(e.outlineColor(t,r,i))))}else this._haloColor=Object(b.c)(e.outlineColor);Object(x.c)(e.size)||(t=Math.min(Math.round(Object(v.h)(e.size*e.sizeRatio)),127));var i;if(this._dynamicPropertyMap.set("_size",((r,i,a)=>Object(x.c)(e.size)?Math.min(Math.round(Object(v.h)(e.size(r,i,a)*e.sizeRatio)),127):t)),Object(x.c)(e.outlineSize)){this._dynamicPropertyMap.set("_haloSize",((t,r,i)=>Math.min(Math.floor(5*Object(v.h)(e.outlineSize(t,r,i)*e.sizeRatio)),127)))}else this._haloSize=Math.min(Math.floor(5*Object(v.h)(e.outlineSize*e.sizeRatio)),127);Object(x.c)(e.offsetX)||(i=Math.round(Object(v.h)(e.offsetX*e.sizeRatio)));var a;this._dynamicPropertyMap.set("_xOffset",((t,r,a)=>Object(x.c)(e.offsetX)?Math.round(Object(v.h)(e.offsetX(t,r,a)*e.sizeRatio)):i)),Object(x.c)(e.offsetY)||(a=Math.round(Object(v.h)(e.offsetY*e.sizeRatio)));this._dynamicPropertyMap.set("_yOffset",((t,r,i)=>Object(x.c)(e.offsetY)?Math.round(Object(v.h)(e.offsetY(t,r,i)*e.sizeRatio)):a)),Object(x.c)(e.angle)?this._dynamicPropertyMap.set("_angle",e.angle):this._angle=e.angle,Object(x.c)(e.horizontalAlignment)?this._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):this._horizontalAlignment=e.horizontalAlignment,Object(x.c)(e.verticalAlignment)?this._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):this._verticalAlignment=e.verticalAlignment,this._scaleFactor=r,Object(x.c)(e.text)?this._dynamicPropertyMap.set("_text",e.text):this._text=e.text;var n=Math.min(Math.round(Object(v.h)(e.referenceSize*e.sizeRatio)),127);this._referenceSize=Math.round(Math.sqrt(256*n)),this._materialKey=e.materialKey;var s=y.f.load(this._materialKey);s.sdf=!0,this._bitset=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1,this._materialKey=s.data,this._decoration="none",this._lineHeight=1,this._lineWidth=512,this._textPlacement=e.markerPlacement,this._effects=e.effects,this._isCIM=!0}static fromCIMText(e){return new Re(e)}analyze(e,t,r,i){var n=this;return Object(a.a)((function*(){var a=t.readLegacyFeature(),s=function(e,t,r,i){return"string"==typeof e.text?e.text:"function"==typeof e.text?e.text(t,r,i):""}(n._cimTextLayer,a,r,i),o=yield e.getMosaicItem(n._cimTextLayer.cim,Object(Pe.a)(s));return n._textToGlyphs.set(s,o.glyphMosaicItems),o}))()}bindFeature(e,t,r){var i=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach(((e,a)=>{this[a]=e(i,t,r)})),this._text&&0!==this._text.length){this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=Object(ze.d)(this._horizontalAlignment||"center"),this._yAlignD=Object(ze.f)(this._verticalAlignment||"baseline");var a=this._textToGlyphs.get(this._text);this.bindTextInfo(a,!1)}else this._shapingInfo=null}}var Ve=Re,Fe=128;class Ne extends(ae(se.a)){constructor(e,t,r,i,a,n,s,o,l){super(),this._effects=l;var c=y.a.load(e);t&&(c.sdf=t.sdf,c.pattern=!0,c.textureBinding=t.textureBinding),this.fillColor=r,this.tl=i,this.br=a,this.aux1=n,this.aux2=s,this.aux3=o,this._materialKey=c.data}static fromCIMFill(e,t){var r=e.color,i=r&&Object(b.c)(r)||0,a=e.materialKey;if(!t){var n=Object(m.b)(0,0,0,e.colorLocked?1:0);return new Ne(a,null,i,0,0,0,0,n,e.effects)}var{rect:s,width:o,height:l}=t,c=s.x+p.q,u=s.y+p.q,h=c+o,f=u+l,y=Object(d.o)(l);y>255?y=255:y<=0&&(y=Object(d.o)(f-u));var x=Object(d.o)(o||0);x>255?x=255:x<=0&&(x=Object(d.o)(h-c));var g=Object(v.h)(e.offsetX||0)+Fe;g>255&&(g=255);var O=Object(v.h)(-e.offsetY||0)+Fe;O>255&&(O=255);var j=e.scaleX||1,M=Object(m.a)(c,u),S=Object(m.a)(h,f),w=Object(m.b)(x,y,g,O),C=Object(m.a)(Fe*j,128),I=Object(m.b)(0,0,Object(_.b)(e.angle),e.colorLocked?1:0);return new Ne(a,t,i,M,S,w,C,I,e.effects)}static fromSimpleFill(e,t,r=!1){var{color:i}=e,a=i&&"esriSFSNull"!==e.style&&Object(b.d)(i)||0,n=Object(m.b)(0,0,0,r?255:0),s=e.materialKey;if(!t)return new Ne(s,null,a,0,0,0,0,n,null);var{rect:o,width:l,height:c}=t,u=o.x+p.q,h=o.y+p.q,f=u+l,v=h+c,y=Object(m.a)(u,h),_=Object(m.a)(f,v),x=Object(m.b)(Object(d.o)(f-u),Object(d.o)(v-h),0,0),g=Object(m.a)(Fe,Fe);return new Ne(s,t,a,y,_,x,g,n,null)}static fromPictureFill(e,t,r=!1){var i=p.p,{rect:a,width:n,height:s}=t,o=a.x+p.q,l=a.y+p.q,c=o+n,u=l+s,h=Object(m.a)(o,l),f=Object(m.a)(c,u),y=Object(d.o)(Object(v.h)(e.width));y>255&&(y=255);var b=Object(d.o)(Object(v.h)(e.height));b>255&&(b=255);var _=Object(v.h)(e.xoffset)+Fe;_>255&&(_=255);var x=Object(v.h)(-e.yoffset)+Fe;x>255&&(x=255);var g=Object(m.b)(y,b,_,x),O=Object(m.a)(Fe*e.xscale,Fe*e.yscale),j=Object(m.b)(0,0,0,r?255:0),M=e.materialKey;return new Ne(M,t,i,h,f,g,O,j,null)}}var Ae=Ne,We=r(151),De=n.a.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");class Be extends(ge(se.a)){constructor(e,t,r,i,a,n,s,o,l,c,u,h,f,d,v,p){super();var m=y.c.load(e);t&&(m.sdf=t.sdf,m.pattern=!0,m.textureBinding=t.textureBinding),this._capType=i,this._joinType=a,this._miterLimitCosine=Object(x.b)(n),this.tessellationProperties._fillColor=s,this.tessellationProperties._tl=o,this.tessellationProperties._br=l,this._hasPattern=c,this._isDashed=u,this._joinOnUTurn=v,this._isColorLocked=h,this._zOrder=d,this._effects=p,this._materialKey=m.data,this.tessellationProperties._bitset=h?1:0,this.tessellationProperties._halfWidth=.5*r,this.tessellationProperties._halfReferenceWidth=.5*f,this._initializeTessellator(!1)}static fromCIMLine(e,t,r){var i=e.color,a=e.scaleFactor||1,n=e.isDashed,s=e.cap;n&&1===s&&(s=2);var o=e.join,l=Object(v.h)(e.width)*a,c=Object(v.h)(e.referenceWidth),u=Object(v.h)(e.miterLimit),h=i&&Object(b.c)(i)||0;if(!t)return new Be(e.materialKey,t,l,s,o,u,h,0,0,!1,n,e.colorLocked,c,e.zOrder,r,e.effects);var{rect:f,width:d,height:y}=t,_=f.x+p.q,x=f.y+p.q,g=_+d,O=x+y,j=Object(m.a)(_,x),M=Object(m.a)(g,O);return new Be(e.materialKey,t,l,s,o,u,h,j,M,!0,n,e.colorLocked,c,e.zOrder,r,e.effects)}static fromSimpleLine(e,t,r){var{color:i}=e,a="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,n=Object(We.h)(e.cap||"round",a),s=Object(We.i)(e.join||"round"),o=i&&"esriSLSNull"!==e.style&&Object(b.d)(i)||0;"esriSLSNull"===e.style&&(o=0);var l=Object(v.h)(e.width),c=e.miterLimit;if(!t)return new Be(e.materialKey,t,l,n,s,c,o,0,0,!1,a,!1,l,0,r,null);var{rect:u,width:h,height:f}=t,d=u.x+p.q,y=u.y+p.q,_=d+h,x=y+f,g=Object(m.a)(d,y),O=Object(m.a)(_,x);return new Be(e.materialKey,t,l,n,s,c,o,g,O,!0,a,!1,l,0,r,null)}static fromPictureLineSymbol(e,t,r,i){return De.error("PictureLineSymbol support does not exist!"),null}}var qe=Be;function Ue(){return(Ue=Object(a.a)((function*(e,t,r){try{yield e.acquire(),yield t(r),e.release()}catch(i){throw e.release(),i}}))).apply(this,arguments)}var Ge=class{constructor(){this._resolver=null}isHeld(){return!!this._resolver}acquire(){var e=this;return Object(a.a)((function*(){if(!e._resolver)return e._resolver=Object(o.g)(),Promise.resolve();yield e._resolver.promise,yield e.acquire()}))()}release(){var e=this._resolver;this._resolver=null,e.resolve()}},Xe=n.a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),Ze=new Array;function Ke(e,t){var r=e.length;return e.push(null),t.then((t=>e[r]=t)),e}function Ye(e){return!!(1&e)}class He{constructor(e,t){this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Ge,this._fetchResource=e,this._joinOnUTurn=t}get _markerError(){return this._errorTemplates.marker[0]}get _fillError(){return this._errorTemplates.fill[0]}get _lineError(){return this._errorTemplates.line[0]}get _textError(){return this._errorTemplates.line[0]}createTemplateGroup(e,t){this._initErrorTemplates();var r=e.hash;if(this._symbolToTemplate.has(r))return this._symbolToTemplate.get(r);var i=new Array;t&&this._createMeshTemplates(i,t,!0),this._createMeshTemplates(i,e,!1);var a=this._createGroupId("expanded-cim"===e.type);return this._idToTemplateGroup.set(a,i),this._symbolToTemplate.set(r,a),a}getTemplateGroup(e){return this._idToTemplateGroup.has(e)?this._idToTemplateGroup.get(e):Ze}getDynamicTemplateGroup(e){return this._idToTemplateGroup.has(e)?(Ye(e)||Xe.error("mapview-template-store","Id ".concat(e," does not refer to a dynamic template")),this._idToTemplateGroup.get(e)):Ze}getMosaicItem(e,t){var r=this._createTemplateId(),i=new Promise((e=>this._idToResolver.set(r,e)));return this._fetchQueue.push({symbol:e,id:r,glyphIds:t}),i}finalize(e){return this._fetchQueue.length||this._lock.isHeld()?function(e,t,r){return Ue.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),e):Promise.resolve()}_initErrorTemplates(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],Object(u.c)(l.c),!1),marker:this._createMeshTemplates([],Object(u.c)(l.b),!1),line:this._createMeshTemplates([],Object(u.c)(l.d),!1)})}_fetchAllQueuedResources(e){if(!this._fetchQueue.length)return Promise.resolve();var t=this._fetchQueue,r=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(r).then((()=>this._fetchResource(t,e).then((e=>{for(var{id:t,mosaicItem:r}of e)this._idToResolver.get(t)(r),this._idToResolver.delete(t)})))).catch((e=>{Object(o.m)(e)?this._fetchQueue=this._fetchQueue.concat(t):function(e){return"worker:port-closed"===e.name}(e)||Xe.error(new s.a("mapview-template-store","Unable to fetch requested texture resources",e))}))}_createGroupId(e){return this._idCounter++<<1|(e?1:0)}_createTemplateId(){return this._templateIdCounter++}_createSMS(e){var t=this;return Object(a.a)((function*(){var{spriteMosaicItem:r}=yield t.getMosaicItem(e);return Object(c.a)(r,Xe)?f.a.fromSimpleMarker(e,r):t._markerError}))()}_createPMS(e){var t=this;return Object(a.a)((function*(){var{spriteMosaicItem:r}=yield t.getMosaicItem(e);return Object(c.a)(r,Xe)?f.a.fromPictureMarker(e,r):t._markerError}))()}_createSFS(e,t){var r=this;return Object(a.a)((function*(){var{spriteMosaicItem:i}=yield r.getMosaicItem(e);return Object(c.a)(i,Xe)?Ae.fromSimpleFill(e,i,t):r._fillError}))()}_createPFS(e,t){var r=this;return Object(a.a)((function*(){var{spriteMosaicItem:i}=yield r.getMosaicItem(e);return Object(c.a)(i,Xe)?Ae.fromPictureFill(e,i,t):r._fillError}))()}_createSLS(e,t){var r=this;return Object(a.a)((function*(){var{spriteMosaicItem:t}=yield r.getMosaicItem(e);return Object(c.a)(t,Xe)?qe.fromSimpleLine(e,t,r._joinOnUTurn):r._lineError}))()}_createLMS(e){var t=this;return Object(a.a)((function*(){var{spriteMosaicItem:r}=yield t.getMosaicItem(e);return Object(c.a)(r,Xe)?f.a.fromLineSymbolMarker(e,r):t._markerError}))()}_createTS(e){var t=this;return Object(a.a)((function*(){var{glyphMosaicItems:r}=yield t.getMosaicItem(e);return h.a.fromText(e,r)}))()}_createCIMText(e){var t=this;return Object(a.a)((function*(){var{glyphMosaicItems:r}=yield t.getMosaicItem(e.cim,Object(Pe.a)(e.text));return Object(c.a)(r,Xe)?h.a.fromCIMText(e,r):t._textError}))()}_createCIMFill(e){var t=this;return Object(a.a)((function*(){var{spriteMosaicItem:r}=yield t.getMosaicItem(e.cim);return Object(c.a)(r,Xe)?Ae.fromCIMFill(e,r):t._fillError}))()}_createCIMLine(e){var t=this;return Object(a.a)((function*(){var{spriteMosaicItem:r}=yield t.getMosaicItem(e.cim);return Object(c.a)(r,Xe)?qe.fromCIMLine(e,r,t._joinOnUTurn):t._lineError}))()}_createCIMMarker(e){var t=this;return Object(a.a)((function*(){var{spriteMosaicItem:r}=yield t.getMosaicItem(e.cim);return Object(c.a)(r,Xe)?f.a.fromCIMMarker(e,r):t._markerError}))()}_createCIM(e){var t=this;return Object(a.a)((function*(){var r=e.templateHash;if(t._cimTemplateCache.has(r))return t._cimTemplateCache.get(r);var a,n=Object(i.a)(Object(i.a)({},e),{},{cim:Object(i.a)(Object(i.a)({},e.cim),{},{mosaicHash:e.materialHash})});switch(n.type){case"marker":a=t._createCIMMarker(n);break;case"line":a=t._createCIMLine(n);break;case"fill":a=t._createCIMFill(n);break;case"text":a=t._createCIMText(n)}return a.then((e=>t._cimTemplateCache.set(r,e))),a}))()}_createDynamicCIM(e){var t,r=e.templateHash;if(this._cimTemplateCache.has(r))return this._cimTemplateCache.get(r);switch(e.type){case"marker":t=Ee.fromCIMMarker(e);break;case"line":t=je.fromCIMLine(e);break;case"fill":t=fe.fromCIMFill(e);break;case"text":t=Ve.fromCIMText(e)}return this._cimTemplateCache.set(r,t),t}_createPrimitiveMeshTemplates(e,t,r){switch(t.type){case"esriSMS":return Ke(e,this._createSMS(t));case"esriPMS":return Ke(e,this._createPMS(t));case"esriSFS":return Ke(e,this._createSFS(t,r));case"line-marker":return Ke(e,this._createLMS(t));case"esriPFS":return Ke(e,this._createPFS(t,r));case"esriSLS":return Ke(e,this._createSLS(t,!1));case"esriTS":return Ke(e,this._createTS(t));default:return Xe.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}_createMeshTemplates(e,t,r){if(-1!==t.type.indexOf("3d"))return Xe.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){for(var i of t.layers)"function"==typeof i.materialHash?e.push(this._createDynamicCIM(i)):Ke(e,this._createCIM(i));return e}if("composite-symbol"===t.type){for(var a of t.layers)this._createPrimitiveMeshTemplates(e,a,r);return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,r)}}},464:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r(7),a=r(546),n=(r(138),r(418)),s=r(127),o=r(156),l={marker:s.d.MARKER,fill:s.d.FILL,line:s.d.LINE,text:s.d.TEXT};class c{constructor(e,t,r,i){for(var a of(this.layers=e,this.data=t,this.hash=this._createHash(),this.rendererKey=r,e)){var n=l[a.type];a.materialKey=Object(o.g)(n,this.rendererKey,!1,!1),a.maxVVSize=i}}get type(){return"expanded-cim"}_createHash(){var e="";for(var t of this.layers)e+=t.templateHash;return e}}var u=function(){var e=Object(i.a)((function*(e,t){return new c(yield Object(n.b)(e.data,t),e.data,e.rendererKey,e.maxVVSize)}));return function(t,r){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)((function*(e,t,r){if(!e)return null;if("cim"===e.type)return u(e,t);if("web-style"===e.type){var i=a.a.fromJSON(e),n={type:"cim",data:(yield i.fetchCIMSymbol(r)).data,rendererKey:e.rendererKey,maxVVSize:e.maxVVSize};return u(n,t)}return e}));return function(t,r,i){return e.apply(this,arguments)}}()},493:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c}));var i=r(100),a=r(350),n=r(427);function s(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":var t=e.symbolLayers;return t&&1===t.length?s(t[0]):null;case"CIMVectorMarker":var r=e.markerGraphics;if(!r||1!==r.length)return null;var i=r[0];if(!i)return null;var a=i.geometry;if(!a)return null;var n=i.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type?null:{geom:a,asFill:"CIMPolygonSymbol"===n.type};case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function o(e){var t=1/0,r=-1/0,i=1/0,a=-1/0;for(var n of e)for(var s of n)s[0]<t&&(t=s[0]),s[0]>r&&(r=s[0]),s[1]<i&&(i=s[1]),s[1]>a&&(a=s[1]);return[t,i,r,a]}function l(e){return e?e.rings?o(e.rings):e.paths?o(e.paths):Object(i.d)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function c(e,t,r,i,a){var[n,s,o,l]=e;if(o<n||l<s)return[0,0,0];var c=o-n,u=l-s,h=Math.floor(31.5),f=(128-2*(h+1))/Math.max(c,u),d=Math.round(c*f)+2*h,v=Math.round(u*f)+2*h,p=1;t&&(p=v/f/(t.ymax-t.ymin));var m=0,y=0;if(i)if(a){if(t&&r&&t.ymax-t.ymin>0){var b=(t.xmax-t.xmin)/(t.ymax-t.ymin);m=i.x/(r*b),y=i.y/r}}else m=i.x,y=i.y;return m=.5*(t.xmax+t.xmin)+m*(t.xmax-t.xmin),y=.5*(t.ymax+t.ymin)+y*(t.ymax-t.ymin),m-=n,y-=s,m*=f,y*=f,[p,(m+=h)/d-.5,-((y+=h)/v-.5)]}function u(e){var t=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),r=function(e){var t=1/0,r=-1/0,i=1/0,n=-1/0;for(var s of e)for(var o of s)o[0]<t&&(t=o[0]),o[0]>r&&(r=o[0]),o[1]<i&&(i=o[1]),o[1]>n&&(n=o[1]);return new a.a(t,i,r-t,n-i)}(t),i=Math.floor(31.5),n=(128-2*(i+1))/Math.max(r.width,r.height),s=Math.round(r.width*n)+2*i,o=Math.round(r.height*n)+2*i,l=[];for(var c of t)if(c&&c.length>1){var u=[];for(var f of c){var[d,v]=f;d-=r.x,v-=r.y,d*=n,v*=n,d+=i-.5,v+=i-.5,u.push([d,v])}if(e.asFill){var p=u.length-1;u[0][0]===u[p][0]&&u[0][1]===u[p][1]||u.push(u[0])}l.push(u)}var m=function(e,t,r,i){for(var a=t*r,n=new Array(a),s=i*i+1,o=0;o<a;++o)n[o]=s;for(var l of e)for(var c=l.length,u=1;u<c;++u){var h=l[u-1],f=l[u],d=void 0,v=void 0,p=void 0,m=void 0;h[0]<f[0]?(d=h[0],v=f[0]):(d=f[0],v=h[0]),h[1]<f[1]?(p=h[1],m=f[1]):(p=f[1],m=h[1]);var y=Math.floor(d)-i,b=Math.floor(v)+i,_=Math.floor(p)-i,x=Math.floor(m)+i;y<0&&(y=0),b>t&&(b=t),_<0&&(_=0),x>r&&(x=r);for(var g=f[0]-h[0],O=f[1]-h[1],j=g*g+O*O,M=y;M<b;M++)for(var S=_;S<x;S++){var w=void 0,C=void 0,I=(M-h[0])*g+(S-h[1])*O;I<0?(w=h[0],C=h[1]):I>j?(w=f[0],C=f[1]):(I/=j,w=h[0]+I*g,C=h[1]+I*O);var k=(M-w)*(M-w)+(S-C)*(S-C),T=(r-S-1)*t+M;k<n[T]&&(n[T]=k)}}for(var E=0;E<a;++E)n[E]=Math.sqrt(n[E]);return n}(l,s,o,i);return e.asFill&&function(e,t,r,i,a){for(var n of e)for(var s=n.length,o=1;o<s;++o){var l=n[o-1],c=n[o],u=void 0,h=void 0,f=void 0,d=void 0;l[0]<c[0]?(u=l[0],h=c[0]):(u=c[0],h=l[0]),l[1]<c[1]?(f=l[1],d=c[1]):(f=c[1],d=l[1]);var v=Math.floor(u),p=Math.floor(h)+1,m=Math.floor(f),y=Math.floor(d)+1;v<i&&(v=i),p>t-i&&(p=t-i),m<i&&(m=i),y>r-i&&(y=r-i);for(var b=m;b<y;++b)if(l[1]>b!=c[1]>b){for(var _=(r-b-1)*t,x=v;x<p;++x)x<(c[0]-l[0])*(b-l[1])/(c[1]-l[1])+l[0]&&(a[_+x]=-a[_+x]);for(var g=i;g<v;++g)a[_+g]=-a[_+g]}}}(l,s,o,i,m),[h(m,i),s,o]}function h(e,t){for(var r=2*t,i=e.length,a=new Uint8Array(4*i),s=0;s<i;++s){var o=.5-e[s]/r;Object(n.a)(o,a,4*s)}return a}},519:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(89),a=r(122),n=2147483647;class s{constructor(e){this._head=e,this._cursor=e}static from(e,t=0,r=e.byteLength/o.BYTES_PER_RECORD-t){var i=new o(new Int32Array(e,t*o.BYTES_PER_RECORD,r*o.ELEMENTS_PER_RECORD));return new s(i)}size(){var e,t;return null!=(e=null==(t=this._cursor)?void 0:t.size())?e:0}get id(){return this._cursor.id}set id(e){this._cursor.id=e}get materialKey(){return this._cursor.materialKey}set materialKey(e){this._cursor.materialKey=e}get insertAfter(){return this._cursor.insertAfter}get indexFrom(){return this._cursor.indexFrom}set indexFrom(e){this._cursor.indexFrom=e}get indexCount(){return this._cursor.indexCount}set indexCount(e){this._cursor.indexCount=e}get vertexFrom(){return this._cursor.vertexFrom}set vertexFrom(e){this._cursor.vertexFrom=e}get vertexCount(){return this._cursor.vertexCount}set vertexCount(e){this._cursor.vertexCount=e}get index(){return this._cursor._index}link(e){if(this._head){for(var t=this._head;t._link;)t=t._link;t._link=e._head}else this._head=e._head}getCursor(){return this.copy()}lookup(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor}copy(){var e,t=new s(null==(e=this._head)?void 0:e.copy());if(!t._head)return t;for(var r=t._head,i=t._head._link;i;)r._link=i.copy(),i=(r=i)._link;return t}next(){return!!this._cursor&&(!!this._cursor.next()||!!this._cursor._link&&(this._cursor=this._cursor._link,this.next()))}peekId(){var e;return null!=(e=this._cursor.peekId())?e:this._cursor._link.peekId()}delete(e){for(var t=this._head,r=null;t;){if(t.delete(e))return t.isEmpty()&&(Object(i.k)(r)&&(r._link=t._link),t===this._head&&(this._head=t._link),t===this._cursor&&(this._cursor=t._link)),!0;r=t,t=t._link}return!1}}s.ELEMENTS_PER_RECORD=a.f,s.BYTES_PER_RECORD=s.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;class o{constructor(e){this._link=null,this._index=-1,this._deletedCount=0,this._offsets={instance:null},this._packedRecords=e}static from(e,t=0,r=e.byteLength/this.BYTES_PER_RECORD-t){return new o(new Int32Array(e,t*this.BYTES_PER_RECORD,r*this.ELEMENTS_PER_RECORD))}delete(e){var t=this._index,r=this.lookup(e);if(r)for(this.id=n,++this._deletedCount;this.next()&&this.id===e;)this.id=n,++this._deletedCount;return this._index=t,r}isEmpty(){return this._deletedCount===this.size()}link(e){this._link?this._link.link(e):this._link=e}lookup(e){if(Object(i.j)(this._offsets.instance)){this._offsets.instance=new Map;var t=this.copy();t._index=-1;for(var r=0;t.next();)t.id!==r&&(this._offsets.instance.set(t.id,t._index),r=t.id)}if(!this._offsets.instance.has(e))return!1;var a=this._index;return this._index=this._offsets.instance.get(e),this.id!==n||(this._index=a,!1)}get id(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD]}set id(e){this._packedRecords[this._index*o.ELEMENTS_PER_RECORD]=e}get materialKey(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+1]}set materialKey(e){this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+1]=e}get insertAfter(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+2]}get indexFrom(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+3]}set indexFrom(e){this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+3]=e}get indexCount(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+4]}set indexCount(e){this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+4]=e}get vertexFrom(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+5]}set vertexFrom(e){this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+5]=e}get vertexCount(){return this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+6]}set vertexCount(e){this._packedRecords[this._index*o.ELEMENTS_PER_RECORD+6]=e}get index(){return this._index}size(){return this._packedRecords.length/o.ELEMENTS_PER_RECORD}next(){for(;++this._index<this.size()&&this.id===n;);return this._index<this.size()}peekId(){var e=(this._index+1)*o.ELEMENTS_PER_RECORD;return e>=this._packedRecords.length?0:this._packedRecords[e]}getCursor(){return this.copy()}copy(){var e=new o(this._packedRecords);return e._link=this._link,e._index=this._index,e._offsets=this._offsets,e._deletedCount=this._deletedCount,e}}o.ELEMENTS_PER_RECORD=a.f,o.BYTES_PER_RECORD=o.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT},521:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(430);function i(e,t,r,i){var a=e.clone(),n=1<<a.level,s=a.col+t,o=a.row+r;return i&&s<0?(a.col=s+n,a.world-=1):s>=n?(a.col=s-n,a.world+=1):a.col=s,a.row=o,a}},534:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var i=r(122),a=r(127),n=new Map;function s(e){return n.get(e)}function o(e,t,r){var{indicesPerRecord:a,multiplier:s,verticesPerRecord:o}=n.get(e);return{recordBytes:r*i.f*Uint32Array.BYTES_PER_ELEMENT,indexBytes:s*a*r*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:s*o*r*t}}n.set(a.d.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),n.set(a.d.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),n.set(a.d.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),n.set(a.d.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),n.set(a.d.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4})},536:function(e,t,r){"use strict";function i(e,t,r){var i,n,o,l,c,u=t&&t.length,h=u?t[0]*r:e.length,d=a(e,0,h,r,!0),v=new Array;if(!d||d.next===d.prev)return v;if(u&&(d=f(e,t,d,r)),e.length>80*r){i=o=e[0],n=l=e[1];for(var p=r;p<h;p+=r){var m=e[p],y=e[p+1];i=Math.min(i,m),n=Math.min(n,y),o=Math.max(o,m),l=Math.max(l,y)}c=0!==(c=Math.max(o-i,l-n))?1/c:0}return s(d,v,r,i,n,c),v}function a(e,t,r,i,a){var n;if(a===b(e,t,r,i)>0)for(var s=t;s<r;s+=i)n=c(s,e[s],e[s+1],n);else for(var o=r-i;o>=t;o-=i)n=c(o,e[o],e[o+1],n);return n&&O(n,n.next)&&(u(n),n=n.next),n}function n(e,t=e){if(!e)return e;var r,i=e;do{if(r=!1,i.steiner||!O(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(u(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function s(e,t,r,i,a,c,h=0){if(e){!h&&c&&(e=v(e,i,a,c));for(var f=e;e.prev!==e.next;){var d=e.prev,p=e.next;if(c?l(e,i,a,c):o(e))t.push(d.index/r),t.push(e.index/r),t.push(p.index/r),u(e),e=p.next,f=p.next;else if((e=p)===f){h?1===h?s(e=M(e,t,r),t,r,i,a,c,2):2===h&&S(e,t,r,i,a,c):s(n(e),t,r,i,a,c,1);break}}}}function o(e){var t=e.prev,r=e,i=e.next;if(m(t,r,i)>=0)return!1;for(var a=e.next.next,n=a,s=0;a!==e.prev&&(0===s||a!==n);){if(s++,_(t.x,t.y,r.x,r.y,i.x,i.y,a.x,a.y)&&m(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function l(e,t,r,i){var a=e.prev,n=e,s=e.next;if(m(a,n,s)>=0)return!1;for(var o=a.x<n.x?a.x<s.x?a.x:s.x:n.x<s.x?n.x:s.x,l=a.y<n.y?a.y<s.y?a.y:s.y:n.y<s.y?n.y:s.y,c=a.x>n.x?a.x>s.x?a.x:s.x:n.x>s.x?n.x:s.x,u=a.y>n.y?a.y>s.y?a.y:s.y:n.y>s.y?n.y:s.y,h=g(o,l,t,r,i),f=g(c,u,t,r,i),d=e.prevZ,v=e.nextZ;d&&d.z>=h&&v&&v.z<=f;){if(d!==e.prev&&d!==e.next&&_(a.x,a.y,n.x,n.y,s.x,s.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==e.prev&&v!==e.next&&_(a.x,a.y,n.x,n.y,s.x,s.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&_(a.x,a.y,n.x,n.y,s.x,s.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=f;){if(v!==e.prev&&v!==e.next&&_(a.x,a.y,n.x,n.y,s.x,s.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function c(e,t,r,i){var a=new I(e,t,r);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function u(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function h(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function f(e,t,r,i){for(var s=new Array,o=0,l=t.length;o<l;o++){var c=a(e,t[o]*i,o<l-1?t[o+1]*i:e.length,i,!1);c===c.next&&(c.steiner=!0),s.push(h(c))}for(var u of(s.sort(j),s))d(u,r),r=n(r,r.next);return r}function d(e,t){if(t=function(e,t){var r,i=t,a=e.x,n=e.y,s=-1/0;do{if(n<=i.y&&n>=i.next.y&&i.next.y!==i.y){var o=i.x+(n-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=a&&o>s){if(s=o,o===a){if(n===i.y)return i;if(n===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(a===s)return r.prev;var l,c=r,u=r.x,h=r.y,f=1/0;for(i=r.next;i!==c;)a>=i.x&&i.x>=u&&a!==i.x&&_(n<h?a:s,n,u,h,n<h?s:a,n,i.x,i.y)&&(((l=Math.abs(n-i.y)/(a-i.x))<f||l===f&&i.x>r.x)&&x(i,e)&&(r=i,f=l)),i=i.next;return r}(e,t)){var r=C(t,e);n(r,r.next)}}function v(e,t,r,i){for(var a;a!==e;a=a.next){if(null===(a=a||e).z&&(a.z=g(a.x,a.y,t,r,i)),a.prev.next!==a||a.next.prev!==a)return a.prev.next=a,a.next.prev=a,v(e,t,r,i);a.prevZ=a.prev,a.nextZ=a.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var i=void 0,a=e;e=null,t=null;for(var n=0;a;){n++,i=a;for(var s=0;s<r&&i;s++)i=i.nextZ;for(var o=r;s>0||o>0&&i;){var l=void 0;0===s?(l=i,i=i.nextZ,o--):0!==o&&i?a.z<=i.z?(l=a,a=a.nextZ,s--):(l=i,i=i.nextZ,o--):(l=a,a=a.nextZ,s--),t?t.nextZ=l:e=l,l.prevZ=t,t=l}a=i}if(t.nextZ=null,r*=2,n<2)return e}}(e)}function p(e,t,r,i){var a=t&&t.length,n=a?t[0]*r:e.length,s=Math.abs(b(e,0,n,r));if(a)for(var o=0,l=t.length;o<l;o++){var c=t[o]*r,u=o<l-1?t[o+1]*r:e.length;s-=Math.abs(b(e,c,u,r))}for(var h=0,f=0;f<i.length;f+=3){var d=i[f]*r,v=i[f+1]*r,p=i[f+2]*r;h+=Math.abs((e[d]-e[p])*(e[v+1]-e[d+1])-(e[d]-e[v])*(e[p+1]-e[d+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)}function m(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function y(e,t,r,i){return!!(O(e,t)&&O(r,i)||O(e,i)&&O(r,t))||m(e,t,r)>0!=m(e,t,i)>0&&m(r,i,e)>0!=m(r,i,t)>0}function b(e,t,r,i){for(var a=0,n=t,s=r-i;n<r;n+=i)a+=(e[s]-e[n])*(e[n+1]+e[s+1]),s=n;return a}function _(e,t,r,i,a,n,s,o){return(a-s)*(t-o)-(e-s)*(n-o)>=0&&(e-s)*(i-o)-(r-s)*(t-o)>=0&&(r-s)*(n-o)-(a-s)*(i-o)>=0}function x(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function g(e,t,r,i,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function O(e,t){return e.x===t.x&&e.y===t.y}function j(e,t){return e.x-t.x}function M(e,t,r){var i=e;do{var a=i.prev,n=i.next.next;!O(a,n)&&y(a,i,i.next,n)&&x(a,n)&&x(n,a)&&(t.push(a.index/r),t.push(i.index/r),t.push(n.index/r),u(i),u(i.next),i=e=n),i=i.next}while(i!==e);return i}function S(e,t,r,i,a,o){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.index!==c.index&&w(l,c)){var u=C(l,c);return l=n(l,l.next),u=n(u,u.next),s(l,t,r,i,a,o),void s(u,t,r,i,a,o)}c=c.next}l=l.next}while(l!==e)}function w(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&y(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&x(e,t)&&x(t,e)&&function(e,t){var r=e,i=!1,a=(e.x+t.x)/2,n=(e.y+t.y)/2;do{r.y>n!=r.next.y>n&&r.next.y!==r.y&&a<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)}function C(e,t){var r=new I(e.index,e.x,e.y),i=new I(t.index,t.x,t.y),a=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,i.next=r,r.prev=i,n.next=i,i.prev=n,i}r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return i}));class I{constructor(e,t,r){this.index=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}}},557:function(e,t,r){"use strict";r.d(t,"a",(function(){return R}));var i=r(7),a=(r(80),r(89)),n=r(94),s=r(366),o=r(81),l=r(93),c=r(110),u=r(105),h=r(122),f=r(285),d=r(164),v=r(127),p=r(633),m=r(156),y=r(187),b=r(232);function _(e){return e.length-1}function x(e){for(var t=0,r=0;r<_(e);r++)t+=g(e,r);return t}function g(e,t,r=1){var[i,a]=function(e,t){return e[t+1]}(e,t);return Math.sqrt(i*i+a*a)*r}class O{constructor(e,t,r,i,a){this._segments=e,this._index=t,this._distance=r,this._xStart=i,this._yStart=a,this._done=!1}static create(e){return new O(e,0,0,e[0][0],e[0][1])}clone(){return new O(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){var e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length),r=Math.acos(t);return e>0&&(r=2*Math.PI-r),r}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){var{dx:e,dy:t}=this;return Math.sqrt(e*e+t*t)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<_(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,t){var r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;for(var i=this.backwardLength;this.prev();){if(i+this.length>e)return this._seekBackwards(e-i);i+=this.length}return this._distance=0,t?this:null}seek(e,t=!1){if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;for(var r=this.remainingLength;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}function j(e,t,r){var i=x(e),a=O.create(e),n=i/2,s=(i-t)/2,o=Math.floor(s/t),l=n-o*t;a.seek(l);for(var c=-o;c<=o;c++)a.x<512&&a.x>=0&&a.y<512&&a.y>=0&&r(a.clone(),c,n+c*t,i),a.seek(t)}function M(e,t){var r=1e-6;if(!(t<=0)){var i=e.length;if(!(i<3)){var a=[],n=0;a.push(0);for(var s=1;s<i;s++)n+=Object(b.a)(e[s],e[s-1]),a.push(n);t=Math.min(t,.2*n);var o=[];o.push(e[0][0]),o.push(e[0][1]);var l=e[i-1][0],c=e[i-1][1],u=Object(b.e)([0,0],e[0],e[1]);Object(b.d)(u),e[0][0]+=t*u[0],e[0][1]+=t*u[1],Object(b.e)(u,e[i-1],e[i-2]),Object(b.d)(u),e[i-1][0]+=t*u[0],e[i-1][1]+=t*u[1];for(var h=1;h<i;h++)a[h]+=t;a[i-1]+=t;for(var f=.5*t,d=1;d<i-1;d++){for(var v=0,p=0,m=0,y=d-1;y>=0&&!(a[y+1]<a[d]-f);y--){var _=f+a[y+1]-a[d],x=a[y+1]-a[y],g=a[d]-a[y]<f?1:_/x;if(Math.abs(g)<r)break;var O=g*g,j=g*_-.5*O*x,M=g*x/t,S=e[y+1],w=e[y][0]-S[0],C=e[y][1]-S[1];v+=M/j*(S[0]*g*_+.5*O*(_*w-x*S[0])-O*g*x*w/3),p+=M/j*(S[1]*g*_+.5*O*(_*C-x*S[1])-O*g*x*C/3),m+=M}for(var I=d+1;I<i&&!(a[I-1]>a[d]+f);I++){var k=f-a[I-1]+a[d],T=a[I]-a[I-1],E=a[I]-a[d]<f?1:k/T;if(Math.abs(E)<r)break;var P=E*E,z=E*k-.5*P*T,L=E*T/t,R=e[I-1],V=e[I][0]-R[0],F=e[I][1]-R[1];v+=L/z*(R[0]*E*k+.5*P*(k*V-T*R[0])-P*E*T*V/3),p+=L/z*(R[1]*E*k+.5*P*(k*F-T*R[1])-P*E*T*F/3),m+=L}o.push(v/m),o.push(p/m)}o.push(l),o.push(c);for(var N=0,A=0;N<i;N++)e[N][0]=o[A++],e[N][1]=o[A++]}}}var S=r(447),w=o.a.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");var C=function(e){var t=new Map;return r=>(t.has(r)||t.set(r,e(r)),t.get(r))}((e=>{var t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t})),I=e=>Math.floor(127*e+127),k=e=>Math.floor(10*e),T=e=>Math.round(e*(254/360));class E extends S.a{constructor(e,t,r,i){super(e,r.font.size,r.haloSize||0,r.color&&Object(y.d)(r.color)||0,r.haloColor&&Object(y.d)(r.haloColor)||0,r.horizontalAlignment,r.verticalAlignment,Object(p.a)(t.labelPlacement)?1:0,r.font.decoration,!1,r.angle||0,r.xoffset,r.yoffset,r.lineWidth,r.lineHeight,null,null),this._outLineLabelAngle=0,this._refPlacementPadding=0,this._refPlacementDirX=0,this._refPlacementDirY=0,this._refOffsetX=0,this._refOffsetY=0,this._zoomLevel=0,this.geometryType=v.d.LABEL;var a=function(e,t){var r=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return Object(c.d)(r,0,25.5)}(t,i),n=function(e,t){var r=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return Object(c.d)(r,0,25.5)}(t,i),s=t.labelPlacement,[o,l]=Object(f.b)(s);this._xAlignD=o,this._yAlignD=l,this._minZoom=a,this._maxZoom=n,this._refPlacementPadding=Object(u.h)(r.haloSize)+h.C;var d=m.b.load(e);d.sdf=!0,this._materialKey=d.data}static fromLabelClass(e,t){if("center-along"===e.labelPlacement){var r=e.symbol;r.xoffset=0,r.yoffset=0,r.angle=0,r.font.decoration="none"}return new E(e.materialKey,e,e.symbol,t)}get _shapedBox(){return Object(a.q)(this._shapingInfo).bounds}setZoomLevel(e){this._zoomLevel=e}bindReferenceTemplate(e){var t=Object(f.e)(this._xAlignD),r=Object(f.g)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,Object(a.j)(e))this._refSymbolAndPlacementOffset=Object(d.b)(0,0,I(t),I(r));else{if("circle"===e.boundsType&&(t||r)){var i=Math.sqrt(t*t+r*r);t/=i,r/=i}var n=Math.max(e.height,e.width),s=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=Object(d.b)(s,n,I(t),I(r)),this._referenceSize=n,this._refPlacementDirX=t,this._refPlacementDirY=r,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}}_write(e,t){if(!Object(a.j)(this._shapingInfo)){var r=this._shapingInfo,i=t.getDisplayId(),n="esriGeometryPolygon"===t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(n)switch(this.current={out:e,inId:i,inShaping:r,zoomLevel:this._zoomLevel},t.geometryType){case"esriGeometryPolyline":this._placeLineLabels(n);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(n);break;default:((e,t="mapview-labeling")=>{w.error(new l.a(t,e))})("mapview-labeling","Geometry of type ".concat(t.geometryType," is not supported"))}}}_isVisible(e,t){var r=k(this.current.zoomLevel);return k(e)<=r&&r<=k(t)}_placePointLabels(e){var{out:t,inId:r,inShaping:i}=this.current;this._writeGlyphs(t,r,e,i)}_placeLineLabels(e){var t=function(e,t){for(var r=t,i=0;i<e.length;i++){var a=e[i],n=[];n.push(a[0]);for(var s=1;s<a.length;s++){var[o,l]=n[s-1];o+=a[s][0],l+=a[s][1],n.push([o,l])}M(n,r);var c=[];c.push(n[0]);for(var u=1;u<n.length;u++){var[h,f]=n[u-1],[d,v]=n[u],p=Math.round(d-h),m=Math.round(v-f);c.push([p,m])}e[i]=c,a=c}return e}(e.paths,this.current.inShaping.bounds.width),r=this._placeSubdivGlyphs.bind(this),i=(this._shapedBox.width+128)/2;for(var a of t)j(a,i,r)}_placeSubdivGlyphs(e,t,r,i){var a=C(t),n=this._shapedBox.width/2,s=Math.min(r,i-r),o=Object(c.m)(s/(8+n/2)),l=0===t?o:Math.min(a,o),u=Math.max(this._minZoom,this.current.zoomLevel+1-l),h=this.current.zoomLevel-u,f=this._shapedBox.width/2*Math.pow(2,h);this.current.inShaping.isMultiline?0===t&&this._placeStraight(e,u):this._placeCurved(e,u,f)}_placeStraight(e,t){var{out:r,inId:i,inShaping:a}=this.current;this._writeGlyphs(r,i,e,a,t)}_placeCurved(e,t,r){var{out:i,inId:a}=this.current;i.metricStart(a,t,e.x,e.y,0,0,0,0);var n=e.clone(),s=e.angle*(180/Math.PI)%360,o=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=T(s),this._placeFirst(n,t,1),this._placeBack(e,n,t,r,1),this._placeForward(e,n,t,r,1),this._outLineLabelAngle=T(o),this._placeFirst(n,t,0),this._placeBack(e,n,t,r,0),this._placeForward(e,n,t,r,0),i.metricEnd()}_placeBack(e,t,r,i,a){for(var n=e.clone(),s=e.backwardLength+0;n.prev()&&!(s>=i);)this._placeOnSegment(n,t,s,r,-1,a),s+=n.length+0}_placeForward(e,t,r,i,a){for(var n=e.clone(),s=e.remainingLength+0;n.next()&&!(s>=i);)this._placeOnSegment(n,t,s,r,1,a),s+=n.length+0}_placeFirst(e,t,r){var i=e,a=this.current.inShaping,n=a.glyphs,s=this.current.zoomLevel,{out:o,inId:l}=this.current;for(var u of n){var h=u.x>a.bounds.x?r:1-r,f=h*e.remainingLength+(1-h)*e.backwardLength,d=Math.abs(u.x+u.width/2-a.bounds.x),v=Math.max(0,s+Object(c.m)(d/(f+0))),p=Math.max(t,v);if(u.maxZoom=25,u.angle=e.angle+(1-r)*Math.PI,u.minZoom=p,!(i.x<0||i.x>=512||i.y<0||i.y>=512)&&(this._writeGlyph(o,l,i.x,i.y,u),r&&this._isVisible(u.minZoom,u.maxZoom))){var m=u.bounds;o.metricBoxWrite(m.center[0],m.center[1],m.width,m.height)}}}_placeOnSegment(e,t,r,i,a,n){var s=this.current.inShaping.glyphs,{out:o,inId:l}=this.current,u=this.current.inShaping,h=this.current.zoomLevel,f=e.dx/e.length,d=e.dy/e.length,v={x:e.x+r*-a*f,y:e.y+r*-a*d};for(var p of s){var m=p.x>u.bounds.x?n:1-n;if(m&&1===a||!m&&-1===a){var y=Math.abs(p.x+p.width/2-u.bounds.x),b=Math.max(0,h+Object(c.m)(y/r)-.1),_=Math.max(i,h+Object(c.m)(y/(r+e.length+0)));if(0!==b&&(p.angle=e.angle+(1-n)*Math.PI,p.minZoom=_,p.maxZoom=b,!(v.x<0||v.x>=512||v.y<0||v.y>=512)&&(this._writeGlyph(o,l,v.x,v.y,p),n&&this._isVisible(p.minZoom,p.maxZoom)))){var x=p.bounds,g=e.x-t.x,O=e.y-t.y;o.metricBoxWrite(x.center[0]+g,x.center[1]+O,x.width,x.height)}}}}_writeGlyphs(e,t,r,i,a=this._minZoom){if(!(r.x<0||r.x>=512||r.y<0||r.y>=512)){var n=r.x+this._refOffsetX,s=r.y-this._refOffsetY;for(var o of i.glyphs)o.minZoom=a,o.maxZoom=this._maxZoom,this._writeGlyph(e,t,n,s,o);var l=m.b.load(this._materialKey),c=this._refPlacementDirX,u=this._refPlacementDirY,h=l.vvSizeFieldStops||l.vvSizeMinMaxValue||l.vvSizeScaleStops||l.vvSizeUnitValue,f=i.boundsT;e.metricStart(t,a,n,s,c,u,this._referenceSize,h?1:0),e.metricBoxWrite(f.center[0],f.center[1],f.width,f.height),e.metricEnd()}}_writeVertexCommon(e,t,r,i){var a=this._color,n=this._haloColor,s=Object(d.b)(0,0,this._size,this._haloSize),o=Math.max(i.minZoom,this._minZoom),l=Math.min(i.maxZoom,this._maxZoom),c=Object(d.b)(k(o),k(l),this._outLineLabelAngle,0);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(a),e.vertexWrite(n),e.vertexWrite(s),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(c)}}var P=E,z=r(450),L=r(452);class R{constructor(e,t,r){this._geometryType=e,this._idField=t,this._templateStore=r}update(e,t){Object(a.k)(e.mesh.labels)&&this._setLabelTemplates(e.mesh.labels,t)}_setLabelTemplates(e,t){this._labelTemplates=e.map((e=>P.fromLabelClass(e,t)))}get templates(){return this._templateStore}analyze(e,t,r,o,l,c){var u=this;return Object(i.a)((function*(){if(!Object(n.n)(c)){var i;"dictionary"===t.type&&(i=yield t.analyze(u._idField,e.copy(),o,l,c));for(var h=0;e.next();){var f;if(f=i?i[h++]:Object(a.k)(r)&&Object(s.c)(e.getDisplayId())&&1!==e.readAttribute("cluster_count")?r.match(u._idField,e,u._geometryType,o,l):t.match(u._idField,e,u._geometryType,o,l),e.setGroupId(f),Object(L.b)(f)){var d=u._templateStore.getDynamicTemplateGroup(f);for(var v of d)v&&v.analyze&&v.analyze(u._templateStore,e,o,l)}}return u._templateStore.finalize(c)}}))()}analyzeGraphics(e,t,r,a,s){var o=this;return Object(i.a)((function*(){if(!Object(n.n)(s)){var i=e.getCursor();for(t&&(yield t.analyze(o._idField,i.copy(),r,a,s));i.next();){var l=i.getGroupId();if(null!=l&&-1!==l||(l=t.match(o._idField,i,i.geometryType,r,a),i.setGroupId(l)),Object(L.b)(l)){var c=o._templateStore.getDynamicTemplateGroup(l);for(var u of c)u&&u.analyze&&u.analyze(o._templateStore,i,r,a)}i.setGroupId(l)}return o._templateStore.finalize(s)}}))()}writeGraphic(e,t){var r=t.getGroupId(),i=t.getDisplayId(),a=this._templateStore.getTemplateGroup(r);if(e.featureStart(t.insertAfter),null!=i){if(Object(L.b)(r))for(var n of a)n.bindFeature(t,null,null);if(a){for(var s of a)s&&s.write(e,t);e.featureEnd()}}}writeCursor(e,t,r,i,n,s){var o=t.getGroupId(),l=t.getDisplayId(),c=this._templateStore.getTemplateGroup(o);if(t.getObjectId(),null!=l&&c){if(Object(L.b)(o))for(var u of c)u.bindFeature(t,r,i);for(var h of c)h.write(e,t);if(Object(a.k)(s)&&e.hasRecords){var f=s&&this._findLabelRef(c);this._writeLabels(e,t,s,f,n)}}}_findLabelRef(e){for(var t of e)if(t instanceof z.a)return t;return null}_writeLabels(e,t,r,i,n){for(var s of r)if(Object(a.k)(s)&&s){var{glyphs:o,rtl:l,index:c}=s,u=this._labelTemplates[c];u.setZoomLevel(n),u.bindReferenceTemplate(i),u.bindTextInfo(o,l),u.write(e,t)}}}},561:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(245),a=r(122),n=(r(642),r(508),r(577),r(607),r(127)),s=r(151),o=r(534),l=r(381);class c{constructor(e,t,r){this._start={index:0,vertex:0};var i=Object(o.b)(e,t,r),a=t/4;this.geometryType=e,this._records=new l.a(Int32Array,i.recordBytes),this._indices=new l.a(Uint32Array,i.indexBytes),this._vertices=new l.a(Uint32Array,i.vertexBytes),this._metrics=new l.a(Float32Array,0),this._strideInt=a}serialize(e){var t=this._records.buffer(),r=this._indices.buffer(),i=this._vertices.buffer(),a=this._metrics.length?this._metrics.buffer():null,n=4*this._strideInt;return e.push(t,r,i),{stride:n,records:t,indices:r,vertices:i,metrics:a}}get strideInt(){return this._strideInt}get recordCount(){return this._records.length/a.f}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}recordStart(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}recordEnd(e,t,r,i,a,n,s){this._records.push(e),this._records.push(t),this._records.push(r),this._records.push(i),this._records.push(a),this._records.push(n),this._records.push(s)}writeIndex(e){this._indices.push(e)}writeVertex(e){this._vertices.push(e)}writeVertexF32(e){this._vertices.writeF32(e)}copyLastFrom(e,t,r){for(var i=e._records.length-7,a=e._records.getValue(i),n=e._records.getValue(i+1),s=e._records.getValue(i+2),o=e._records.getValue(i+4),l=e._records.getValue(i+6),c=this._vertices.length,u=(e._start.vertex-this._vertices.length)/this._strideInt,h=this._indices.length,f=this.vertexCount,d=e._start.index;d!==e._indices.length;d++){var v=e._indices.getValue(d);this._indices.push(v-u)}for(var p=e._start.vertex;p!==e._vertices.length;p++){var m=e._vertices.getValue(p);this._vertices.push(m)}for(var y=c;y<=this._vertices.length;y+=this._strideInt)this._vertices.i1616Add(y,t,r);this._records.push(a),this._records.push(n),this._records.push(s),this._records.push(h),this._records.push(o),this._records.push(f),this._records.push(l)}}var u=r(366),h=r(521),f=128;function d(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case f:return 1}}function v(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case f:return 1}}class p{constructor(e,t,r,i,a){this._hasDotDensity=!1,this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=t,this.tileKey=e,this._hasDotDensity=r,this._hasAggregate=i,this._pixelBufferEnabled=a}get hasAggregates(){return this._hasAggregate}get hasPixelBufferEnabled(){return this._pixelBufferEnabled}serialize(e){var t=[];return t.push(this._serializeTileVertexData(this.tileKey,this._data.self)),this._data.neighbors.forEach(((r,a)=>{var n=1<<a,s=d(n),o=v(n),l=Object(h.a)(new i.a(this.tileKey),s,o,e);t.push(this._serializeTileVertexData(l.id,r))})),t}_serializeTileVertexData(e,t){var r,i,a,s,o,l=new Array;return{message:{tileKey:e,data:{[n.d.MARKER]:null==(r=t.get(n.d.MARKER))?void 0:r.serialize(l),[n.d.FILL]:null==(i=t.get(n.d.FILL))?void 0:i.serialize(l),[n.d.LINE]:null==(a=t.get(n.d.LINE))?void 0:a.serialize(l),[n.d.TEXT]:null==(s=t.get(n.d.TEXT))?void 0:s.serialize(l),[n.d.LABEL]:null==(o=t.get(n.d.LABEL))?void 0:o.serialize(l)}},transferList:l}}featureStart(e=0){this._current.insertAfter=e}featureEnd(){}recordStart(e,t,r,i,a){this._current.writer=this._getVertexWriter(r,i),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=a,this._current.id=e,this._current.materialKey=t,this._current.geometryType=r,this._current.isDotDensity=!1,this._current.writer.recordStart()}recordCount(){return this._current.writer.recordCount}vertexCount(){return this._current.writer.vertexCount}indexCount(){return this._current.writer.indexCount}vertexBounds(e,t,r,i){this._current.bufferingEnabled&&this._addOverlap(e,t,r,i)}vertexWrite(e){this._current.writer.writeVertex(e)}vertexWriteF32(e){this._current.writer.writeVertexF32(e)}vertexEnd(){}vertexWriter(){return this._current.writer.vertexWriter}indexWrite(e){this._current.writer.writeIndex(e)}indexWriter(){return this._current.writer.indexWriter}metricWriter(){return this._current.writer.metricWriter}metricStart(e,t,r,i,a,s,o,l){this._current.writer=this._getVertexWriter(n.d.LABEL,!1);var c=this._current.writer.metricWriter;c.push(Object(u.b)(e)),c.push(t),c.push(r),c.push(i),c.push(a),c.push(s),c.push(o),c.push(l),c.push(255),this._current.metricBoxLenPointer=c.push(0)}metricEnd(){var e=this._current.writer.metricWriter;0===e.getValue(this._current.metricBoxLenPointer)&&e.seek(e.length-10)}metricBoxWrite(e,t,r,i){var a=this._current.writer.metricWriter;a.incr(this._current.metricBoxLenPointer),a.push(0),a.push(0),a.push(e),a.push(t),a.push(r),a.push(i)}recordEnd(){var e=this._current.indexStart,t=this._current.writer.indexCount;if(e===t)return!1;this.hasRecords=!0;var r=t-e,i=this._current.vertStart,o=this._current.writer.vertexCount-i;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,e,r,i,o),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===n.d.LABEL)return!0;for(var l=this._current.writer,u=0;u<8;u++){var h=1<<u;if(this._current.overlaps&h){if(!this._data.neighbors[u]){var f=new Map;this._data.neighbors[u]=f}var p=this._data.neighbors[u],m=this._current.geometryType;if(!p.has(m)){var y=Object(s.l)(m,this._current.isDotDensity).geometry;p.set(m,new c(m,y,a.o))}var b=p.get(this._current.geometryType),_=512*-d(h)*8,x=512*-v(h)*8;b.copyLastFrom(l,_,x)}}return!0}_addOverlap(e,t,r,i){var n=255^((e<0+r?148:e>=a.E-r?41:189)|(t<0+i?224:t>=a.E-i?7:231));this._current.overlaps|=n}_getVertexWriter(e,t){if(!this._data.self.has(e)){var r=this._data.self,i=Object(s.l)(e,this._hasDotDensity).geometry;r.set(e,new c(e,i,8e3))}return this._data.self.get(e)}}},562:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var i=r(7),a=r(81),n=r(93),s=r(91),o=r(152),l=r(320),c=r(235),u=r(419),h=r(464),f=r(360),d=a.a.getLogger("esri/views/2d/engine/webgl/util/Matcher");class v{constructor(){this.type="feature",this._defaultResult=null}static fromBasicRenderer(e,t,r){return Object(i.a)((function*(){var i=new v;if(e.symbol){var a=yield Object(h.a)(e.symbol,r),n=t.createTemplateGroup(a,null);i.setDefault(n)}return i}))()}size(){return 1}getDefault(){return this._defaultResult}setDefault(e){this._defaultResult=e}match(e,t,r,i,a){return this.getDefault()}analyze(e,t,r,a,n){return Object(i.a)((function*(){return null}))()}}class p extends v{constructor(e,t,r,i){super(),this.type="interval",this._intervals=[],this._isMaxInclusive=t,this._fieldIndex=i,this._field=e,this._normalizationInfo=r}static fromCBRenderer(e,t,r){return Object(i.a)((function*(){var{isMaxInclusive:a,normalizationField:n,normalizationTotal:s,normalizationType:o}=e,l=e.field,c=new p(l,a,{normalizationField:n,normalizationTotal:s,normalizationType:o},e.fieldIndex),u=yield Object(h.a)(e.backgroundFillSymbol,r);yield Promise.all(e.intervals.map(function(){var e=Object(i.a)((function*(e){var i=yield Object(h.a)(e.symbol,r),a=yield t.createTemplateGroup(i,u),n={min:e.min,max:e.max};c.add(n,a)}));return function(t){return e.apply(this,arguments)}}()));var f=yield Object(h.a)(e.defaultSymbol,r);if(f){var d=yield t.createTemplateGroup(f,u);c.setDefault(d)}return c}))()}add(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort(((e,t)=>e.interval.min-t.interval.min))}size(){return super.size()+this._intervals.length}match(e,t,r,i,a){if(null==this._fieldIndex&&!this._field)return this.getDefault();var n=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(!n&&(null==n||isNaN(n)))return this.getDefault();for(var s=0;s<this._intervals.length;s++){var{interval:o,result:l}=this._intervals[s],c=n>=o.min,u=this._isMaxInclusive?n<=o.max:n<o.max;if(c&&u)return l}return this.getDefault()}_needsNormalization(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}_getValueFromField(e){var t=e.readAttribute(this._field);if(!this._needsNormalization()||null==t)return t;var{normalizationField:r,normalizationTotal:i,normalizationType:a}=this._normalizationInfo,n=!!r&&e.readAttribute(r);if(a)switch(a){case"esriNormalizeByField":return n?t/n:void 0;case"esriNormalizeByLog":return Math.log(t)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return t/i*100;default:return void d.error("Found unknown normalization type: ".concat(a))}else d.error("Normalization is required, but no type was set!")}}class m extends v{constructor(e,t,r){super(),this.type="map",this._nullResult=null,this._resultsMap=new Map,this._fieldsIndex=r,this._fields=e,this._seperator=t||""}static fromUVRenderer(e,t,r){return Object(i.a)((function*(){var a=e.fieldDelimiter,n=[e.field];e.field2&&n.push(e.field2),e.field3&&n.push(e.field3);var s=yield Object(h.a)(e.backgroundFillSymbol,r),o=new m(n,a,e.fieldIndex);yield Promise.all(e.map.map(function(){var e=Object(i.a)((function*(e){var i=yield Object(h.a)(e.symbol,r),a=yield t.createTemplateGroup(i,s);"<Null>"===e.value?o.setNullResult(a):o.add(e.value,a)}));return function(t){return e.apply(this,arguments)}}()));var l=yield Object(h.a)(e.defaultSymbol,r);if(l){var c=yield t.createTemplateGroup(l,s);o.setDefault(c)}return o}))()}setNullResult(e){this._nullResult=e}add(e,t){this._resultsMap.set(e.toString(),t)}size(){return super.size()+this._resultsMap.size}match(e,t,r,i,a){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();var n=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==n||""===n||"<Null>"===n))return this._nullResult;if(!n&&null==n)return this.getDefault();var s=n.toString();return this._resultsMap.has(s)?this._resultsMap.get(s):this.getDefault()}_getValueFromFields(e){var t=[];for(var r of this._fields){var i=e.readAttribute(r);t.push(i)}return t.join(this._seperator)}}function y(){return(y=Object(i.a)((function*(e,t){var r=e||1;if("number"==typeof r)return(e,t,i)=>r;var i=yield Object(o.d)(r,t.spatialReference,t.fields);return(e,r,a)=>Object(u.a)(i,e,{$view:a},t.geometryType,r)||1}))).apply(this,arguments)}class b extends v{constructor(e,t,r,i){super(),this.type="dictionary",this._groupIdCache=new c.a(100),this._renderer=e,this._fieldMap=e.fieldMap,this._symbolFields=e.getSymbolFields(),this._templates=t,this._info=r,this._scaleFn=i}static fromDictionaryRenderer(e,t,a){return Object(i.a)((function*(){var i=(yield Promise.resolve().then(r.bind(null,197))).default.fromJSON(e.renderer);yield i.fetchResources({spatialReference:a.spatialReference,fields:a.fields});var n=yield function(e,t){return y.apply(this,arguments)}(i.scaleExpression,a);return new b(i,t,a,n)}))()}_analyzeFeature(e,t,r,a){var o=this;return Object(i.a)((function*(){var i=e.readLegacyFeature(),c=o._scaleFn(i,t,r),u=o._attributeHash(i)+"-"+c,v=o._groupIdCache.get(u);if(v)return v;var p=Object(s.a)(Object(s.a)({},r),{},{spatialReference:o._info.spatialReference,abortOptions:a,fields:o._info.fields}),m=yield o._renderer.getSymbolAsync(i,p),y=Object(f.c)(m,o._renderer),b=Object(h.a)(y,o._info,a).then((e=>{if("expanded-cim"!==e.type)return d.error(new n.a("mapview-bad-type","Found unexpected type ".concat(e.type," in dictionary response"))),null;for(var t of(e.hash+="-"+c,e.layers))t.scaleFactor=c,t.templateHash+="-"+c,"text"===t.type&&"string"==typeof t.text&&t.text.indexOf("[")>-1&&(t.text=Object(l.c)(o._fieldMap,t.text,t.cim.textCase));return o._templates.createTemplateGroup(e,null)}));return o._groupIdCache.put(u,b,1),b}))()}analyze(e,t,r,a,n){var s=this;return Object(i.a)((function*(){for(var e=t.getCursor(),i=[];e.next();)i.push(s._analyzeFeature(e,r,a,n));return Promise.all(i)}))()}match(e,t,r,i,a){return null}_attributeHash(e){var t="";for(var r of this._symbolFields){var i=this._fieldMap[r];i&&(t+=e.attributes[i]+"-")}return t}}var _=a.a.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");function x(e,t,r){return g.apply(this,arguments)}function g(){return(g=Object(i.a)((function*(e,t,r){switch(e.type){case"simple":return v.fromBasicRenderer(e,t,r);case"map":return m.fromUVRenderer(e,t,r);case"interval":return p.fromCBRenderer(e,t,r);case"dictionary":return b.fromDictionaryRenderer(e,t,r);default:return _.error(new n.a("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}}))).apply(this,arguments)}},577:function(e,t,r){"use strict";var i=r(82),a=(r(80),r(81),r(88),r(85)),n=r(84),s=(r(83),r(86),r(87),r(97)),o=r(135),l=r(711);var c=new Set,u=[],h=new Map,f=[0,0],d=class extends s.a{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){var{concurrency:e,process:t,strategy:r}=this;this._queue=new l.a({concurrency:e,process:(e,r)=>{var i=this._keyToItem.get(e);return t(i,{signal:r})},peeker:"scale-first"===r?e=>this._peekByScaleFirst(e):e=>this._peekByCenterFirst(e)})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){var t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e){var t=e.key.id;if(this.has(t))return this.get(t);var r=this._queue.push(t),i=()=>{this._keyToItem.delete(t),this.notifyChange("updating")};return this._keyToItem.set(t,e),r.then(i,i),this.notifyChange("updating"),r}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;var t=this.tileInfoView,r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;e.forEach((e=>{var t=this._keyToItem.get(e),a=this.tileInfoView.getTileScale(t.key);h.has(a)||(h.set(a,[]),r=Math.max(a,r),i=Math.min(a,i)),h.get(a).push(t.key),c.add(a)}));var a=this.state.scale;h.has(a)||(function(e,t){e.length=0,t.forEach((t=>e.push(t)))}(u,c),u.sort(),a=u.reduce(((e,t)=>Math.abs(t-a)<Math.abs(e-a)?t:e),u[0])),a=Math.min(a,r),a=Math.max(a,i);var n=h.get(a),s=t.getClosestInfoForScale(a),o=s.getColumnForX(this.state.center[0]),l=s.getRowForY(this.state.center[1]);return n.sort(((e,t)=>{var r=s.denormalizeCol(e.col,e.world),i=s.denormalizeCol(t.col,t.world);return Math.sqrt((o-r)*(o-r)+(l-e.row)*(l-e.row))-Math.sqrt((o-i)*(o-i)+(l-t.row)*(l-t.row))})),c.clear(),h.clear(),n[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;var t=this.tileInfoView,r=this.state.center,i=Number.POSITIVE_INFINITY,a=null;return e.forEach((e=>{var n=this._keyToItem.get(e);t.getTileCoords(f,n.key);var s=Object(o.i)(f,r);s<i&&(i=s,a=n.key)})),a.id}};Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"concurrency",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"process",void 0),Object(i.a)([Object(a.b)()],d.prototype,"state",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"strategy",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"tileInfoView",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],d.prototype,"updating",null);var v=d=Object(i.a)([Object(n.a)("esri.views.2d.tiling.TileQueue")],d);t.a=v},607:function(e,t,r){"use strict";var i=r(245),a=r(513),n=r(135);function s(e,t){e.delete(t)}var o=class{constructor(e,t,r){this.maxSize=e,this.tileInfoView=t,this.removedFunc=r,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){var t=this._tilePerId.get(e);if(!t)return null;var r=t.key.level,i=this._tileKeysPerLevel[r];s(this._tilePerId,e);for(var a=0;a<i.length;a++)if(i[a].id===e){i.splice(a,1);break}return t.visible=!0,t}add(e){e.visible=!1;var t=e.key,r=t.id;if(!this._tilePerId.has(r)){this._tilePerId.set(r,e);var i=t.level;this._tileKeysPerLevel[i]||(this._tileKeysPerLevel[i]=[]),this._tileKeysPerLevel[i].push(t)}}prune(e,t,r){var i=this._tilePerId.size;if(!(i<=this.maxSize)){for(var a=this._tileKeysPerLevel.length-1;i>this.maxSize&&a>=0;)a!==e&&(i=this._pruneAroundCenterTile(i,t,r,a)),a--;i>this.maxSize&&(i=this._pruneAroundCenterTile(i,t,r,e))}}_pruneAroundCenterTile(e,t,r,i){var a=this._tileKeysPerLevel[i];if(!a||0===a.length)return e;var{size:s,origin:o}=this.tileInfoView.tileInfo,l=r*s[0],c=r*s[1],u=[0,0],h=[0,0];for(a.sort(((e,r)=>(u[0]=o.x+l*(e.col+.5),u[1]=o.y-c*(e.row+.5),h[0]=o.x+l*(r.col+.5),h[1]=o.y-c*(r.row+.5),Object(n.j)(u,t)-Object(n.j)(h,t))));a.length>0;){var f=a.pop();if(this._removeTile(f.id),--e===this.maxSize)break}return e}_removeTile(e){var t=this._tilePerId.get(e);this.removedFunc&&this.removedFunc(t),s(this._tilePerId,e)}},l=new i.a(0,0,0,0),c=new Map,u=[],h=[];t.a=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this.resampling=null==e.resampling||!!e.resampling,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),null!=e.buffer&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new o(e.cacheSize,this.tileInfoView,(e=>{this.releaseTile(e)})))}destroy(){this.tileIndex.clear()}update(e){var{resampling:t,tileIndex:r}=this,i=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.coveragePolicy);if(h.length=0,u.length=0,c.clear(),i){var{minScale:n,maxScale:s}=this.tileInfoView.tileInfo,{spans:o,lodInfo:f}=i,{level:d}=f,{scale:v,center:p,resolution:m}=e.state,y=!e.stationary&&v>this._previousScale;if(this._previousScale=v,this.tiles.length=0,!t&&(v>n||v<s))return this.tiles.length=0,c.clear(),r.forEach((e=>{this.releaseTile(e)})),r.clear(),h.length=0,u.length=0,c.clear(),a.a.pool.release(i),!0;r.forEach((e=>e.visible=!0));var b=0,_=0;if(o.length>0)for(var{row:x,colFrom:g,colTo:O}of o)for(var j=g;j<=O;j++){b++;var M=l.set(d,x,f.normalizeCol(j),f.getWorldForColumn(j)).id;if(r.has(M)){var S=r.get(M);S.isReady?(c.set(M,S),_++):y||this._addParentTile(M,c)}else{var w=void 0;if(this._tileCache&&this._tileCache.has(M)){if(w=this._tileCache.pop(M),this.tileIndex.set(M,w),w.isReady){c.set(M,w),_++;continue}}else w=this.acquireTile(l),this.tileIndex.set(M,w);y||this._addParentTile(M,c)}}var C=_===b;for(var I of(r.forEach(((e,t)=>{if(l.set(t),!c.has(t)){var r=this.tileInfoView.intersects(i,l),a="purge"===this.cachePolicy?l.level!==d:l.level>d;!r||!y&&C?!a&&r||u.push(t):e.isReady?h.push(t):a&&u.push(t)}})),h)){var k=r.get(I);k&&k.isReady&&c.set(I,k)}for(var T of u){var E=r.get(T);this._tileCache?this._tileCache.add(E):this.releaseTile(E),r.delete(T)}return c.forEach((e=>this.tiles.push(e))),r.forEach((e=>{c.has(e.key.id)||(e.visible=!1)})),this._tileCache&&this._tileCache.prune(d,p,m),a.a.pool.release(i),c.clear(),C}}clear(e=!0){var{tileIndex:t}=this;e&&t.forEach((e=>{this.releaseTile(e)})),t.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,t){for(var r=e,i=null;r=this.tileInfoView.getTileParentId(r);)if(this.tileIndex.has(r)){if((i=this.tileIndex.get(r))&&i.isReady){t.has(i.key.id)||t.set(i.key.id,i);break}}else if(this._tileCache&&this._tileCache.has(r)&&(i=this._tileCache.pop(r),this.tileIndex.set(r,i),i&&i.isReady)){t.has(i.key.id)||t.set(i.key.id,i);break}}}},633:function(e,t,r){"use strict";function i(e){switch(e){case"above-along":case"below-along":case"center-along":return 1;default:return 0}}r.d(t,"a",(function(){return i}))},642:function(e,t,r){"use strict";var i=r(82),a=(r(80),r(81),r(88),r(85)),n=r(84),s=(r(83),r(86),r(87),r(97)),o=r(135),l=r(711);var c=new Set,u=[],h=new Map,f=[0,0],d=class extends s.a{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){var{concurrency:e,process:t}=this;this._queue=new l.a({concurrency:e,process:(e,r)=>{var i=this._keyToItem.get(e);return t(i,{signal:r})},peeker:e=>e.values().next().value})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){var t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){var t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e,t){var r=e.key.id+"-"+t;if(this.has(r))return this.get(r);var i=this._queue.push(r),a=()=>{this._keyToItem.delete(r),this.notifyChange("updating")};return this._keyToItem.set(r,e),i.then(a,a),this.notifyChange("updating"),i}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;var t=this.tileInfoView,r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;e.forEach((e=>{var t=this._keyToItem.get(e),a=this.tileInfoView.getTileScale(t.key);h.has(a)||(h.set(a,[]),r=Math.max(a,r),i=Math.min(a,i)),h.get(a).push(t.key),c.add(a)}));var a=this.state.scale;h.has(a)||(function(e,t){e.length=0,t.forEach((t=>e.push(t)))}(u,c),u.sort(),a=u.reduce(((e,t)=>Math.abs(t-a)<Math.abs(e-a)?t:e),u[0])),a=Math.min(a,r),a=Math.max(a,i);var n=h.get(a),s=t.getClosestInfoForScale(a),o=s.getColumnForX(this.state.center[0]),l=s.getRowForY(this.state.center[1]);return n.sort(((e,t)=>{var r=s.denormalizeCol(e.col,e.world),i=s.denormalizeCol(t.col,t.world);return Math.sqrt((o-r)*(o-r)+(l-e.row)*(l-e.row))-Math.sqrt((o-i)*(o-i)+(l-t.row)*(l-t.row))})),c.clear(),h.clear(),n[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;var t=this.tileInfoView,r=this.state.center,i=Number.POSITIVE_INFINITY,a=null;return e.forEach((e=>{var n=this._keyToItem.get(e);t.getTileCoords(f,n.key);var s=Object(o.i)(f,r);s<i&&(i=s,a=n.key)})),a.id}};Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"concurrency",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"process",void 0),Object(i.a)([Object(a.b)()],d.prototype,"state",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"strategy",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],d.prototype,"tileInfoView",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],d.prototype,"updating",null);d=Object(i.a)([Object(n.a)("esri.views.2d.tiling.PagedTileQueue")],d)},955:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return o}));var i=r(110),a=r(405),n=r(122),s=0,o=1,l=2;class c{constructor(e,t){this.width=e,this.height=t;var r=Math.ceil(e/1),i=Math.ceil(t/1);this._cols=r,this._rows=i,this._cells=a.a.create(r*i)}insertMetrics(e){var t=this._hasCollision(e);return t===s&&this._markMetrics(e),t}getCellId(e,t){return e+t*this._cols}has(e){return this._cells.has(e)}hasRange(e,t){return this._cells.hasRange(e,t)}set(e){this._cells.set(e)}setRange(e,t){this._cells.setRange(e,t)}_hasCollision(e){var t=e.id,r=0,i=0;e.save();do{var a=e.boundsCount;r+=a;for(var n=0;n<a;n++){var c=e.boundsComputedAnchorX(n),u=e.boundsComputedAnchorY(n),h=e.boundsWidth(n)+2,f=e.boundsHeight(n)+2;switch(this._collide(c,u,h,f)){case l:return l;case o:i++}}}while(e.peekId()===t&&e.next());return e.restore(),r===i?o:s}_collide(e,t,r,a){var n=e-r/2,c=e+r/2,u=t-a/2,h=t+a/2;if(c<0||h<0||n>this.width||u>this.height)return o;for(var f=Object(i.d)(Math.floor(n/1),0,this._cols),d=Object(i.d)(Math.floor(u/1),0,this._rows),v=Object(i.d)(Math.ceil(c/1),0,this._cols),p=Object(i.d)(Math.ceil(h/1),0,this._rows),m=d;m<=p;m++)for(var y=f;y<=v;y++){var b=this.getCellId(y,m);if(this.has(b))return l}return s}_mark(e,t,r,a){for(var n=e-r/2,s=e+r/2,o=t-a/2,l=t+a/2,c=Object(i.d)(Math.floor(n/1),0,this._cols),u=Object(i.d)(Math.floor(o/1),0,this._rows),h=Object(i.d)(Math.ceil(s/1),0,this._cols),f=Object(i.d)(Math.ceil(l/1),0,this._rows),d=u;d<=f;d++)for(var v=c;v<=h;v++){var p=this.getCellId(v,d);this.set(p)}return!1}_markMetrics(e){var t=e.id;do{for(var r=e.boundsCount,i=0;i<r;i++){var a=e.boundsComputedAnchorX(i),n=e.boundsComputedAnchorY(i),s=e.boundsWidth(i)+2,o=e.boundsHeight(i)+2;this._mark(a,n,s,o)}}while(e.peekId()===t&&e.next())}}class u{constructor(e,t=2){this._bucketSize=e,this._rowsLength=n.E/e,this._colsLength=n.E/e,this._elementsPerBucket=t,this._grid=this._initGrid()}checkOverlap(e,t){var r=Math.floor(e/this._bucketSize),i=Math.floor(t/this._bucketSize);return r<0||r>=this._rowsLength||i<0||i>=this._colsLength||this._grid[i*this._colsLength+r]>=this._elementsPerBucket}markUsed(e,t){var r=Math.floor(e/this._bucketSize),i=Math.floor(t/this._bucketSize);this._grid[i*this._colsLength+r]+=1}reset(){this._grid=this._initGrid()}_initGrid(){return new Uint8Array(this._rowsLength*this._colsLength)}}}}]);
//# sourceMappingURL=95.13ad93e5.chunk.js.map