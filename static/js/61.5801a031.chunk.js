(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[61,12,14,33,34,35,39,114,134,164,168,196,273,274,276,282],Array(119).concat([function(e,t,r){"use strict";function i(e,...t){for(var r="",i=0;i<t.length;i++)r+=e[i]+t[i];return r+=e[e.length-1]}r.d(t,"a",(function(){return i})),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(i||(i={}))},function(e,t,r){"use strict";function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}r.d(t,"a",(function(){return i}))},,,,,,,,,,,,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=r(89),o=(r(81),r(88)),c=r(85),l=r(116),u=r(95),d=r(84),h=r(96),p=(r(83),r(86),r(87),r(90)),f=r(99),b=r(113),m=r(100),v=r(101),g=r(150),y=r(170),O=r(250),j=r(246),_=new u.a({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),w=new u.a({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),x=i=class extends p.a{constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.datumTransformation=null,this.distance=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.units=null,this.where=null}static from(e){return Object(o.d)(i,e)}castDatumTransformation(e){return"number"==typeof e||"object"==typeof e?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){var r={};for(var i in e){var n=e[i];Array.isArray(n)?r[i]=n.map((e=>e instanceof Date?e.getTime():e)):n instanceof Date?r[i]=n.getTime():r[i]=n}t.parameterValues=r}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new i(Object(a.a)({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:Object(s.k)(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))}};x.MAX_MAX_RECORD_COUNT_FACTOR=5,Object(n.a)([Object(c.b)({json:{write:!0}})],x.prototype,"aggregateIds",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{writer:(e,t)=>{null!=e&&(t.cacheHint=e)}}}})],x.prototype,"cacheHint",void 0),Object(n.a)([Object(c.b)({json:{write:!0}})],x.prototype,"datumTransformation",void 0),Object(n.a)([Object(l.a)("datumTransformation")],x.prototype,"castDatumTransformation",null),Object(n.a)([Object(c.b)({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],x.prototype,"distance",void 0),Object(n.a)([Object(c.b)({type:y.a,json:{write:!0}})],x.prototype,"dynamicDataSource",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],x.prototype,"gdbVersion",void 0),Object(n.a)([Object(c.b)({types:v.a,json:{read:m.a,write:!0}})],x.prototype,"geometry",void 0),Object(n.a)([Object(c.b)({type:Number,json:{write:!0}})],x.prototype,"geometryPrecision",void 0),Object(n.a)([Object(c.b)({type:[String],json:{write:!0}})],x.prototype,"groupByFieldsForStatistics",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],x.prototype,"having",void 0),Object(n.a)([Object(c.b)({type:Date})],x.prototype,"historicMoment",void 0),Object(n.a)([Object(h.a)("historicMoment")],x.prototype,"writeHistoricMoment",null),Object(n.a)([Object(c.b)({type:Number,json:{write:!0}})],x.prototype,"maxAllowableOffset",void 0),Object(n.a)([Object(c.b)({type:Number,cast:e=>e<1?1:e>i.MAX_MAX_RECORD_COUNT_FACTOR?i.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],x.prototype,"maxRecordCountFactor",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],x.prototype,"multipatchOption",void 0),Object(n.a)([Object(c.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],x.prototype,"num",void 0),Object(n.a)([Object(c.b)({json:{write:!0}})],x.prototype,"objectIds",void 0),Object(n.a)([Object(c.b)({type:[String],json:{write:!0}})],x.prototype,"orderByFields",void 0),Object(n.a)([Object(c.b)({type:[String],json:{write:!0}})],x.prototype,"outFields",void 0),Object(n.a)([Object(c.b)({type:f.a,json:{read:{source:"outSR"},write:{target:"outSR"}}})],x.prototype,"outSpatialReference",void 0),Object(n.a)([Object(c.b)({type:[j.a],json:{write:{enabled:!0,overridePolicy(){return{enabled:Object(s.k)(this.outStatistics)&&this.outStatistics.length>0}}}}})],x.prototype,"outStatistics",void 0),Object(n.a)([Object(c.b)({json:{write:!0}})],x.prototype,"parameterValues",void 0),Object(n.a)([Object(h.a)("parameterValues")],x.prototype,"writeParameterValues",null),Object(n.a)([Object(c.b)({type:b.a,json:{write:!0}})],x.prototype,"pixelSize",void 0),Object(n.a)([Object(c.b)({type:O.a,json:{write:!0}})],x.prototype,"quantizationParameters",void 0),Object(n.a)([Object(c.b)({type:[Object],json:{write:!0}})],x.prototype,"rangeValues",void 0),Object(n.a)([Object(c.b)({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],x.prototype,"relationParameter",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],x.prototype,"resultType",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],x.prototype,"returnCentroid",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],x.prototype,"returnDistinctValues",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:!e})}}})],x.prototype,"returnExceededLimitFeatures",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:!0}})],x.prototype,"returnGeometry",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],x.prototype,"returnQueryGeometry",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],x.prototype,"returnM",void 0),Object(n.a)([Object(c.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],x.prototype,"returnZ",void 0),Object(n.a)([Object(c.b)({type:f.a,json:{write:!0}})],x.prototype,"sourceSpatialReference",void 0),Object(n.a)([Object(c.b)({type:String,json:{read:{source:"spatialRel",reader:_.read},write:{target:"spatialRel",writer:_.write}}})],x.prototype,"spatialRelationship",void 0),Object(n.a)([Object(c.b)({type:Number,json:{read:{source:"resultOffset"}}})],x.prototype,"start",void 0),Object(n.a)([Object(h.a)("start"),Object(h.a)("num")],x.prototype,"writeStart",null),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],x.prototype,"sqlFormat",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:!0}})],x.prototype,"text",void 0),Object(n.a)([Object(c.b)({type:g.a,json:{write:!0}})],x.prototype,"timeExtent",void 0),Object(n.a)([Object(c.b)({type:String,json:{read:w.read,write:{writer:w.write,overridePolicy(e){return{enabled:e&&this.distance>0}}}}})],x.prototype,"units",void 0),Object(n.a)([Object(c.b)({type:String,json:{write:{overridePolicy(e){return{enabled:null!=e||this.start>0}}}}})],x.prototype,"where",void 0),Object(n.a)([Object(h.a)("where")],x.prototype,"writeWhere",null);var S=x=i=Object(n.a)([Object(d.a)("esri.tasks.support.Query")],x);t.a=S},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i}));"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e||"undefined"!=typeof self&&self;function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return a(null==t&&r.path)}},r.exports),r.exports}function a(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}}).call(this,r(172))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return T})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return j})),r.d(t,"g",(function(){return O})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return b})),r.d(t,"k",(function(){return S})),r.d(t,"l",(function(){return m})),r.d(t,"m",(function(){return _})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return p})),r.d(t,"p",(function(){return v})),r.d(t,"q",(function(){return x})),r.d(t,"r",(function(){return a})),r.d(t,"s",(function(){return w})),r.d(t,"t",(function(){return u})),r.d(t,"u",(function(){return d}));var i=r(184);function n(e,t){return e[0]=t[0],e[1]=t[1],e}function a(e,t,r){return e[0]=t,e[1]=r,e}function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function c(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function l(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function u(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function d(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function h(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function p(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function f(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function b(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function m(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function v(e){var t=e[0],r=e[1];return t*t+r*r}function g(e,t){return e[0]=-t[0],e[1]=-t[1],e}function y(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e}function O(e,t){return e[0]*t[0]+e[1]*t[1]}function j(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function _(e,t,r,i){var n=t[0],a=t[1];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e}function w(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e}function x(e,t,r,i){var n=t[0]-r[0],a=t[1]-r[1],s=Math.sin(i),o=Math.cos(i);return e[0]=n*o-a*s+r[0],e[1]=n*s+a*o+r[1],e}function S(e,t){return e[0]===t[0]&&e[1]===t[1]}var M=m,T=o,E=c,P=l,C=f,I=b,A=v;Object.freeze({__proto__:null,copy:n,set:a,add:s,subtract:o,multiply:c,divide:l,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:u,max:d,round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:h,scaleAndAdd:p,distance:f,squaredDistance:b,length:m,squaredLength:v,negate:g,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:y,dot:O,cross:j,lerp:_,random:function(e,t){t=t||1;var r=2*Object(i.b)()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},transformMat2:function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e},transformMat2d:w,transformMat3:function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e},transformMat4:function(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e},rotate:x,angle:function(e,t){var r=e[0],i=e[1],n=t[0],a=t[1],s=r*r+i*i;s>0&&(s=1/Math.sqrt(s));var o=n*n+a*a;o>0&&(o=1/Math.sqrt(o));var c=(r*n+i*a)*s*o;return c>1?0:c<-1?Math.PI:Math.acos(c)},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:S,equals:function(e,t){var r=e[0],n=e[1],a=t[0],s=t[1];return Math.abs(r-a)<=i.a*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=i.a*Math.max(1,Math.abs(n),Math.abs(s))},len:M,sub:T,mul:E,div:P,dist:C,sqrDist:I,sqrLen:A})},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return l}));r(80);var i=r(95);function n(e){return e}var a={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}},s=Object(i.b)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});function o(e,t,r){var i=new Date(e.getTime());if(t&&r){var n=a[r],{getter:s,setter:o,multiplier:c}=n;i[o](i[s]()+t*c)}return i}var c={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function l(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return null}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s}));var i=r(91),n=r(83);function a(e,t){var r={query:e};return t&&((r=Object(i.a)(Object(i.a)({},t),r)).query=Object(i.a)(Object(i.a)({},r.query),t.query)),r}function s(e){return"string"==typeof e?Object(n.J)(e):e}function o(e,t,r){var i={};for(var n in e)if("declaredClass"!==n){var a=e[n];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){i[n]=[];for(var s=0;s<a.length;s++)i[n][s]=o(a[s])}else if("object"==typeof a)if(a.toJSON){var c=a.toJSON(r&&r[n]);i[n]=t?c:JSON.stringify(c)}else i[n]=t?a:JSON.stringify(a);else i[n]=a}return i}},,,,function(e,t,r){"use strict";r.r(t);var i=r(82),n=(r(80),r(89)),a=(r(81),r(88),r(85)),s=r(95),o=r(98),c=r(84),l=r(96),u=(r(83),r(86),r(87),r(90)),d=r(99),h=r(100),p=r(101),f=r(123),b=r(155),m=new s.a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null}),v=class extends u.a{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){for(var r=d.a.fromJSON(t.spatialReference),i=[],a=0;a<e.length;a++){var s=e[a],o=f.a.fromJSON(s),c=s.geometry&&s.geometry.spatialReference;Object(n.k)(o.geometry)&&!c&&(o.geometry.spatialReference=r),i.push(o)}return i}writeGeometryType(e,t,r,i){if(e)m.write(e,t,r,i);else{var{features:a}=this;if(a)for(var s of a)if(s&&Object(n.k)(s.geometry))return void m.write(s.geometry.type,t,r,i)}}readQueryGeometry(e,t){if(!e)return null;var r=!!e.spatialReference,i=Object(h.a)(e);return!r&&t.spatialReference&&(i.spatialReference=d.a.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)t.spatialReference=e.toJSON();else{var{features:r}=this;if(r)for(var i of r)if(i&&Object(n.k)(i.geometry)&&i.geometry.spatialReference)return void(t.spatialReference=i.geometry.spatialReference.toJSON())}}toJSON(e){var t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(var r=0;r<t.features.length;r++){var i=t.features[r];if(i.geometry){var n=e&&e[r];i.geometry=n&&n.toJSON()||i.geometry}}return t}quantize(e){for(var{scale:[t,r],translate:[i,a]}=e,s=this.features,o=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-i)/t)),(e=>Math.round((a-e)/r))),c=0,l=s.length;c<l;c++)o(Object(n.q)(s[c].geometry))||(s.splice(c,1),c--,l--);return this.transform=e,this}unquantize(){var{geometryType:e,features:t,transform:r}=this;if(!r)return this;var{translate:[i,a],scale:[s,o]}=r,c=this._getHydrationFunction(e,(e=>e*s+i),(e=>a-e*o));for(var{geometry:l}of t)Object(n.k)(l)&&c(l);return this.transform=null,this}_quantizePoints(e,t,r){for(var i,n,a=[],s=0,o=e.length;s<o;s++){var c=e[s];if(s>0){var l=t(c[0]),u=r(c[1]);l===i&&u===n||(a.push([l-i,u-n]),i=l,n=u)}else i=t(c[0]),n=r(c[1]),a.push([i,n])}return a.length>0?a:null}_getQuantizationFunction(e,t,r){return"point"===e?e=>(e.x=t(e.x),e.y=r(e.y),e):"polyline"===e||"polygon"===e?e=>{for(var i=Object(h.g)(e)?e.rings:e.paths,n=[],a=0,s=i.length;a<s;a++){var o=i[a],c=this._quantizePoints(o,t,r);c&&n.push(c)}return n.length>0?(Object(h.g)(e)?e.rings=n:e.paths=n,e):null}:"multipoint"===e?e=>{var i=this._quantizePoints(e.points,t,r);return i.length>0?(e.points=i,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,r){return"point"===e?e=>{e.x=t(e.x),e.y=r(e.y)}:"polyline"===e||"polygon"===e?e=>{for(var i,n,a=Object(h.g)(e)?e.rings:e.paths,s=0,o=a.length;s<o;s++)for(var c=a[s],l=0,u=c.length;l<u;l++){var d=c[l];l>0?(i+=d[0],n+=d[1]):(i=d[0],n=d[1]),d[0]=t(i),d[1]=r(n)}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax)}:"multipoint"===e?e=>{for(var i,n,a=e.points,s=0,o=a.length;s<o;s++){var c=a[s];s>0?(i+=c[0],n+=c[1]):(i=c[0],n=c[1]),c[0]=t(i),c[1]=r(n)}}:void 0}};Object(i.a)([Object(a.b)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),Object(i.a)([Object(a.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),Object(i.a)([Object(a.b)({type:[f.a],json:{write:!0}})],v.prototype,"features",void 0),Object(i.a)([Object(o.a)("features")],v.prototype,"readFeatures",null),Object(i.a)([Object(a.b)({type:[b.a],json:{write:!0}})],v.prototype,"fields",void 0),Object(i.a)([Object(a.b)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:m.read}}})],v.prototype,"geometryType",void 0),Object(i.a)([Object(l.a)("geometryType")],v.prototype,"writeGeometryType",null),Object(i.a)([Object(a.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),Object(i.a)([Object(a.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),Object(i.a)([Object(a.b)({types:p.a,json:{write:!0}})],v.prototype,"queryGeometry",void 0),Object(i.a)([Object(o.a)("queryGeometry")],v.prototype,"readQueryGeometry",null),Object(i.a)([Object(a.b)({type:d.a,json:{write:!0}})],v.prototype,"spatialReference",void 0),Object(i.a)([Object(l.a)("spatialReference")],v.prototype,"writeSpatialReference",null),Object(i.a)([Object(a.b)({json:{write:!0}})],v.prototype,"transform",void 0),(v=Object(i.a)([Object(c.a)("esri.tasks.support.FeatureSet")],v)).prototype.toJSON.isDefaultToJSON=!0,v||(v={});var g=v;t.default=g},,,,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(81),r(88),r(85)),s=r(98),o=r(84),c=r(96),l=(r(83),r(86),r(87),r(90)),u=r(140),d=i=class extends l.a{constructor(e){super(e),this.end=null,this.start=null}static get allTime(){return h}static get empty(){return p}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?e.getTime():null}get isAllTime(){return this.equals(i.allTime)}get isEmpty(){return this.equals(i.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?e.getTime():null}clone(){return new i({end:this.end,start:this.start})}expandTo(e){if(this.isEmpty||this.isAllTime)return this.clone();var t=this.start?Object(u.e)(this.start,e):null,r=this.end?Object(u.c)(Object(u.e)(this.end,e),1,e):null;return new i({start:t,end:r})}intersection(e){var t,r,n,a,s,o,c,l;if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return i.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();var u,d,h=null!=(t=null==(r=this.start)?void 0:r.getTime())?t:-1/0,p=null!=(n=null==(a=this.end)?void 0:a.getTime())?n:1/0,f=null!=(s=null==(o=e.start)?void 0:o.getTime())?s:-1/0,b=null!=(c=null==(l=e.end)?void 0:l.getTime())?c:1/0;if(f>=h&&f<=p?u=f:h>=f&&h<=b&&(u=h),p>=f&&p<=b?d=p:b>=h&&b<=p&&(d=b),!isNaN(u)&&!isNaN(d)){var m=new i;return m.start=u===-1/0?null:new Date(u),m.end=d===1/0?null:new Date(d),m}return i.empty}offset(e,t){if(this.isEmpty||this.isAllTime)return this.clone();var r=new i,{start:n,end:a}=this;return n&&(r.start=Object(u.c)(n,e,t)),a&&(r.end=Object(u.c)(a,e,t)),r}equals(e){if(!e)return!1;var t=this.start?this.start.getTime():this.start,r=this.end?this.end.getTime():this.end,i=e.start?e.start.getTime():e.start,n=e.end?e.end.getTime():e.end;return t===i&&r===n}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return h.clone();var t=this.start&&e.start?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end&&e.end?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new i({start:t,end:r})}};Object(n.a)([Object(a.b)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0),Object(n.a)([Object(s.a)("end")],d.prototype,"readEnd",null),Object(n.a)([Object(c.a)("end")],d.prototype,"writeEnd",null),Object(n.a)([Object(a.b)({readOnly:!0,json:{read:!1}})],d.prototype,"isAllTime",null),Object(n.a)([Object(a.b)({readOnly:!0,json:{read:!1}})],d.prototype,"isEmpty",null),Object(n.a)([Object(a.b)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0),Object(n.a)([Object(s.a)("start")],d.prototype,"readStart",null),Object(n.a)([Object(c.a)("start")],d.prototype,"writeStart",null);var h=new(d=i=Object(n.a)([Object(o.a)("esri.TimeExtent")],d)),p=new d({start:void 0,end:void 0}),f=d;t.a=f},,,,,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(81),r(88)),s=r(85),o=r(95),c=r(102),l=r(98),u=r(84),d=(r(83),r(86),r(87),r(90)),h=r(149),p=r(237),f=new o.a({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"}),b=i=class extends d.a{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(e,{description:t}){var r;try{r=JSON.parse(t)}catch(i){}return r?r.value:null}readValueType(e,{description:t}){var r;try{r=JSON.parse(t)}catch(i){}return r?f.fromJSON(r.fieldValueType):null}clone(){return new i({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],b.prototype,"alias",void 0),Object(n.a)([Object(s.b)({type:[String,Number],json:{write:{allowNull:!0}}})],b.prototype,"defaultValue",void 0),Object(n.a)([Object(s.b)()],b.prototype,"description",void 0),Object(n.a)([Object(l.a)("description")],b.prototype,"readDescription",null),Object(n.a)([Object(s.b)({types:h.d,json:{read:{reader:h.b},write:!0}})],b.prototype,"domain",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],b.prototype,"editable",void 0),Object(n.a)([Object(s.b)({type:a.a,json:{write:!0}})],b.prototype,"length",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],b.prototype,"name",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],b.prototype,"nullable",void 0),Object(n.a)([Object(c.a)(p.a)],b.prototype,"type",void 0),Object(n.a)([Object(s.b)()],b.prototype,"valueType",void 0),Object(n.a)([Object(l.a)("valueType",["description"])],b.prototype,"readValueType",null);var m=b=i=Object(n.a)([Object(u.a)("esri.layers.support.Field")],b);t.a=m},,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var i=r(82),n=r(85),a=r(84),s=r(97),o=r(115),c=r(297),l=e=>{var t=class extends e{destroy(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}get handles(){return this._get("handles")||new o.a}get updatingHandles(){return this._get("updatingHandles")||new c.a}};return Object(i.a)([Object(n.b)({readOnly:!0})],t.prototype,"handles",null),Object(i.a)([Object(n.b)({readOnly:!0})],t.prototype,"updatingHandles",null),t=Object(i.a)([Object(a.a)("esri.core.HandleOwner")],t)},u=class extends(l(s.a)){};u=Object(i.a)([Object(a.a)("esri.core.HandleOwner")],u)},function(e,t,r){"use strict";r.d(t,"a",(function(){return G})),r.d(t,"b",(function(){return K})),r.d(t,"c",(function(){return H})),r.d(t,"d",(function(){return Z})),r.d(t,"e",(function(){return W})),r.d(t,"f",(function(){return U})),r.d(t,"g",(function(){return N})),r.d(t,"h",(function(){return k})),r.d(t,"i",(function(){return J})),r.d(t,"j",(function(){return Q})),r.d(t,"k",(function(){return X})),r.d(t,"l",(function(){return A})),r.d(t,"m",(function(){return j})),r.d(t,"n",(function(){return z})),r.d(t,"o",(function(){return L})),r.d(t,"p",(function(){return ue})),r.d(t,"q",(function(){return re})),r.d(t,"r",(function(){return ae})),r.d(t,"s",(function(){return le})),r.d(t,"t",(function(){return ee})),r.d(t,"u",(function(){return te})),r.d(t,"v",(function(){return v})),r.d(t,"w",(function(){return g})),r.d(t,"x",(function(){return oe})),r.d(t,"y",(function(){return $})),r.d(t,"z",(function(){return se}));var i=r(81),n=r(93),a=r(100),s=r(292),o=r(316),c=r(178);function l(e,t){return e?t?4:3:t?3:2}var u=i.a.getLogger("esri.tasks.support.optimizedFeatureSet"),d={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},h=(e,t,r,i,n,a)=>{e[r]=n,e[r+1]=a},p=(e,t,r,i,n,a)=>{e[r]=n,e[r+1]=a,e[r+2]=t[i+2]},f=(e,t,r,i,n,a)=>{e[r]=n,e[r+1]=a,e[r+2]=t[i+3]},b=(e,t,r,i,n,a)=>{e[r]=n,e[r+1]=a,e[r+2]=t[i+2],e[r+3]=t[i+3]};function m(e,t,r,i){if(e){if(r)return t&&i?b:p;if(t&&i)return f}else if(t&&i)return p;return h}function v({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function g({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function y({scale:e,translate:t},r){return r*e[0]+t[0]}function O({scale:e,translate:t},r){return t[1]-r*e[1]}function j(e,t,r){return e?t?r?E(e):x(e):r?M(e):_(e):null}function _(e){var t=e.coords;return{x:t[0],y:t[1]}}function w(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function x(e){var t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function S(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function M(e){var t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function T(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function E(e){var t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function P(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function C(e,t){return e&&t?P:e?S:t?T:w}function I(e,t,r,i,n){var a=C(r,i);for(var o of t){var{geometry:l,attributes:u}=o,d=void 0;l&&(d=a(new c.a,l)),e.push(new s.a(d,u,null,u[n]))}return e}function A(e,t,r){if(!e)return null;for(var i=l(t,r),n=[],a=0;a<e.coords.length;a+=i){for(var s=[],o=0;o<i;o++)s.push(e.coords[a+o]);n.push(s)}return t?r?{points:n,hasZ:t,hasM:r}:{points:n,hasZ:t}:r?{points:n,hasM:r}:{points:n}}function R(e,t,r,i,n){var a=l(r,i);for(var o of t){var u=o.geometry,d=o.attributes,h=void 0;u&&(h=F(new c.a,u,a)),e.push(new s.a(h,d,null,d[n]))}return e}function F(e,t,r=l(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;var i=e.coords,n=0;for(var a of t.points)for(var s=0;s<r;s++)i[n++]=a[s];return e}function L(e,t,r){if(!e)return null;var i=l(t,r),{coords:n,lengths:a}=e,s=[],o=0;for(var c of a){for(var u=[],d=0;d<c;d++){for(var h=[],p=0;p<i;p++)h.push(n[o++]);u.push(h)}s.push(u)}return t?r?{paths:s,hasZ:t,hasM:r}:{paths:s,hasZ:t}:r?{paths:s,hasM:r}:{paths:s}}function D(e,t,r,i,n){var a=l(r,i);for(var o of t){var u=o.geometry,d=o.attributes,h=void 0;u&&(h=k(new c.a,u,a)),e.push(new s.a(h,d,null,d[n]))}return e}function k(e,t,r=l(t.hasZ,t.hasM)){var{lengths:i,coords:n}=e,a=0;for(var s of t.paths){for(var o of s)for(var c=0;c<r;c++)n[a++]=o[c];i.push(s.length)}return e}function z(e,t,r){if(!e)return null;var i=l(t,r),{coords:n,lengths:a}=e,s=[],o=0;for(var c of a){for(var u=[],d=0;d<c;d++){for(var h=[],p=0;p<i;p++)h.push(n[o++]);u.push(h)}s.push(u)}return t?r?{rings:s,hasZ:t,hasM:r}:{rings:s,hasZ:t}:r?{rings:s,hasM:r}:{rings:s}}function V(e,t,r,i,n){for(var a of t){var o=a.geometry,l=a.centroid,u=a.attributes,d=void 0;o&&(d=N(new c.a,o,r,i)),l?e.push(new s.a(d,u,w(new c.a,l),u[n])):e.push(new s.a(d,u,null,u[n]))}return e}function N(e,t,r=t.hasZ,i=t.hasM){return U(e,t.rings,r,i),e}function U(e,t,r,i){var n=l(r,i),{lengths:a,coords:s}=e,o=0;for(var c of(a.length=s.length=0,t)){for(var u of c)for(var d=0;d<n;d++)s[o++]=u[d];a.push(c.length)}return e}var B=[],q=[];function G(e,t,r,i,n){B[0]=e;var[a]=H(q,B,t,r,i,n);return B.length=q.length=0,a}function H(e,t,r,i,a,o){if(e.length=0,!r){for(var c of t){var l=c.attributes[o];e.push(new s.a(null,c.attributes,null,l))}return e}switch(r){case"esriGeometryPoint":return I(e,t,i,a,o);case"esriGeometryMultipoint":return R(e,t,i,a,o);case"esriGeometryPolyline":return D(e,t,i,a,o);case"esriGeometryPolygon":return V(e,t,i,a,o);default:u.error("convertToFeatureSet:unknown-geometry",new n.a("Unable to parse unknown geometry type '".concat(r,"'"))),e.length=0}return e}function W(e,t,r,i,a,s){var o=e.length;switch(r){case"esriGeometryPoint":I(e,t,i,a,s);break;case"esriGeometryMultipoint":R(e,t,i,a,s);break;case"esriGeometryPolyline":D(e,t,i,a,s);break;case"esriGeometryPolygon":V(e,t,i,a,s);break;default:u.error("convertToFeatureSet:unknown-geometry",new n.a("Unable to parse unknown geometry type '".concat(r,"'")))}for(var c=0;c<t.length;c++)e[c+o].geometryType=r,e[c+o].insertAfter=t[c].insertAfter,e[c+o].groupId=t[c].groupId;return e}function J(e,t,r,i){q[0]=e,Y(B,q,t,r,i);var n=B[0];return B.length=q.length=0,n}function Z(e,t,r){if(!e)return null;var i=new c.a;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),Object(a.f)(e)?C(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(i,e):Object(a.g)(e)?N(i,e,t,r):Object(a.h)(e)?k(i,e,l(t,r)):Object(a.e)(e)?F(i,e,l(t,r)):void u.error("convertFromGeometry:unknown-geometry",new n.a("Unable to parse unknown geometry type '".concat(e,"'")))}function X(e,t,r,i){var a=e&&("coords"in e?e:e.geometry);if(!a)return null;switch(t){case"esriGeometryPoint":var s=_;return r&&i?s=E:r?s=x:i&&(s=M),s(a);case"esriGeometryMultipoint":return A(a,r,i);case"esriGeometryPolyline":return L(a,r,i);case"esriGeometryPolygon":return z(a,r,i);default:return void u.error("convertToGeometry:unknown-geometry",new n.a("Unable to parse unknown geometry type '".concat(t,"'")))}}function Y(e,t,r,i,a){switch(e.length=0,r){case"esriGeometryPoint":return function(e,t,r,i){var n=_;for(var a of(r&&i?n=E:r?n=x:i&&(n=M),t)){var{geometry:s,attributes:o}=a,c=s?n(s):null;e.push({attributes:o,geometry:c})}return e}(e,t,i,a);case"esriGeometryMultipoint":return function(e,t,r,i){for(var n of t){var{geometry:a,attributes:s}=n,o=void 0;a&&(o=A(a,r,i)),e.push({attributes:s,geometry:o})}return e}(e,t,i,a);case"esriGeometryPolyline":return function(e,t,r,i){for(var n of t){var{geometry:a,attributes:s}=n,o=void 0;a&&(o=L(a,r,i)),e.push({attributes:s,geometry:o})}return e}(e,t,i,a);case"esriGeometryPolygon":return function(e,t,r,i){for(var n of t){var{geometry:a,attributes:s,centroid:o}=n,c=void 0;if(a&&(c=z(a,r,i)),o){var l=_(o);e.push({attributes:s,centroid:l,geometry:c})}else e.push({attributes:s,geometry:c})}return e}(e,t,i,a);default:u.error("convertToFeatureSet:unknown-geometry",new n.a("Unable to parse unknown geometry type '".concat(r,"'")))}return e}function Q(e){var{objectIdFieldName:t,spatialReference:r,transform:i,fields:n,hasM:a,hasZ:s,features:o,geometryType:c,exceededTransferLimit:l,uniqueIdField:u,queryGeometry:d,queryGeometryType:h}=e,p={features:Y([],o,c,s,a),fields:n,geometryType:c,objectIdFieldName:t,spatialReference:r,uniqueIdField:u,queryGeometry:X(d,h,!1,!1)};return i&&(p.transform=i),l&&(p.exceededTransferLimit=l),a&&(p.hasM=a),s&&(p.hasZ=s),p}function K(e,t){var r=new o.a,{hasM:i,hasZ:a,features:s,objectIdFieldName:c,spatialReference:l,geometryType:d,exceededTransferLimit:h,transform:p,fields:f}=e;return f&&(r.fields=f),r.geometryType=d,r.objectIdFieldName=c||t,r.spatialReference=l,r.objectIdFieldName?(s&&H(r.features,s,d,a,i,r.objectIdFieldName),h&&(r.exceededTransferLimit=h),i&&(r.hasM=i),a&&(r.hasZ=a),p&&(r.transform=p),r):(u.error(new n.a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function $(e){var{transform:t,features:r,hasM:i,hasZ:n}=e;if(!t)return e;for(var a of r)a.geometry&&se(a.geometry,a.geometry,i,n,t),a.centroid&&se(a.centroid,a.centroid,i,n,t);return e.transform=null,e}function ee(e,t){var{geometryType:r,features:i,hasM:n,hasZ:a}=t;if(!e)return t;for(var s=0;s<i.length;s++){var o=i[s],l=o.weakClone();l.geometry=new c.a,te(l.geometry,o.geometry,n,a,r,e),o.centroid&&(l.centroid=new c.a,te(l.centroid,o.centroid,n,a,"esriGeometryPoint",e)),i[s]=l}return t.transform=e,t}function te(e,t,r,i,n,a,s=r,o=i){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var c=d[n],{coords:u,lengths:h}=t,p=l(r,i),f=l(r&&s,i&&o),b=m(r,i,s,o);if(!h.length)return b(e.coords,u,0,0,v(a,u[0]),g(a,u[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=p,e;var y,O,j,_,w=0,x=0,S=x;for(var M of h)if(!(M<c)){var T=0;x=S,j=y=v(a,u[w]),_=O=g(a,u[w+1]),b(e.coords,u,x,w,j,_),T++,w+=p,x+=f;for(var E=1;E<M;E++,w+=p)j=v(a,u[w]),_=g(a,u[w+1]),j===y&&_===O||(b(e.coords,u,x,w,j-y,_-O),x+=f,T++,y=j,O=_);T>=c&&(e.lengths.push(T),S=x)}return e.coords.length=S,e.coords.length?e:null}function re(e,t,r,i,n,a,s=r,o=i){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;var c=d[n],{coords:u,lengths:h}=t,p=l(r,i),f=l(r&&s,i&&o),b=m(r,i,s,o);if(!h.length)return b(e.coords,u,0,0,u[0],u[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=p,e;var v=0,g=a*a;for(var y of h)if(y<c)v+=y*p;else{var O=e.coords.length/f,j=v,_=v+(y-1)*p;b(e.coords,u,e.coords.length,j,u[j],u[j+1]),ne(e.coords,u,p,g,b,j,_),b(e.coords,u,e.coords.length,_,u[_],u[_+1]);var w=e.coords.length/f-O;w>=c?e.lengths.push(w):e.coords.length=O*f,v+=y*p}return e.coords.length?e:null}function ie(e,t,r,i){var n=e[t],a=e[t+1],s=e[r],o=e[r+1],c=e[i],l=e[i+1],u=s,d=o,h=c-u,p=l-d;if(0!==h||0!==p){var f=((n-u)*h+(a-d)*p)/(h*h+p*p);f>1?(u=c,d=l):f>0&&(u+=h*f,d+=p*f)}return(h=n-u)*h+(p=a-d)*p}function ne(e,t,r,i,n,a,s){for(var o,c=i,l=0,u=a+r;u<s;u+=r)(o=ie(t,u,a,s))>c&&(l=u,c=o);c>i&&(l-a>r&&ne(e,t,r,i,n,a,l),n(e,t,e.length,l,t[l],t[l+1]),s-l>r&&ne(e,t,r,i,n,l,s))}function ae(e,t,r,i){if(!t||!t.coords||!t.coords.length)return null;var n=l(r,i),a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(t&&t.coords)for(var u=t.coords,d=0;d<u.length;d+=n){var h=u[d],p=u[d+1];a=Math.min(a,h),o=Math.max(o,h),s=Math.min(s,p),c=Math.max(c,p)}return e[0]=a,e[1]=s,e[2]=o,e[3]=c,e}function se(e,t,r,i,n){var{coords:a,lengths:s}=t,o=r?i?b:p:i?p:h,c=l(r,i);if(!a.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!s.length)return o(e.coords,a,0,0,y(n,a[0]),O(n,a[1])),e!==t&&(e.lengths.length=0,e.coords.length=c),e;for(var[u,d]=n.scale,f=0,m=0;m<s.length;m++){var v=s[m];e.lengths[m]=v;var g=y(n,a[f]),j=O(n,a[f+1]);o(e.coords,a,f,f,g,j),f+=c;for(var _=1;_<v;_++,f+=c)g+=a[f]*u,j-=a[f+1]*d,o(e.coords,a,f,f,g,j)}return e!==t&&(e.lengths.length=s.length,e.coords.length=a.length),e}function oe(e,t,r,i,n,a){var s=l(r,i),o=m(r,i,n,a),c=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(var u=0;u<c.length;u+=s)o(e.coords,c,e.coords.length,u,c[u],c[u+1]);return e}function ce(e,t,r,i){for(var n=0,a=e[i*t],s=e[i*(t+1)],o=1;o<r;o++){var c=a+e[i*(t+o)],l=s+e[i*(t+o)+1],u=(c-a)*(l+s);a=c,s=l,n+=u}return.5*n}function le(e,t){for(var{coords:r,lengths:i}=e,n=0,a=0,s=0;s<i.length;s++)a+=ce(r,n,i[s],t),n+=s;return Math.abs(a)}function ue(e,t){for(var r=e.clone(),i=e.coords,n=e.lengths,a=0,s=0;s<n.length;s++){for(var o=n[s],c=i[t*a],l=i[t*a+1],u=1;u<o;u++){var d=c+i[t*(a+u)],h=l+i[t*(a+u)+1];r.coords[t*(a+u)]=d,r.coords[t*(a+u)+1]=h,c=d,l=h}a+=o}return r}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var i,n,a=r(82),s=(r(80),r(81),r(88)),o=r(85),c=r(116),l=r(95),u=r(102),d=r(98),h=r(188),p=r(84),f=(r(83),r(86),r(87),r(90)),b=r(155),m=r(262),v=r(99),g=r(183),y=(r(101),i=class extends f.a{constructor(e){super(e),this.type="query-table"}clone(){var e,{workspaceId:t,query:r,oidFields:n,spatialReference:a,geometryType:s}=this,o={workspaceId:t,query:r,oidFields:n,spatialReference:null!=(e=null==a?void 0:a.clone())?e:void 0,geometryType:s};return new i(o)}});Object(a.a)([Object(u.a)({queryTable:"query-table"})],y.prototype,"type",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],y.prototype,"workspaceId",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],y.prototype,"query",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],y.prototype,"oidFields",void 0),Object(a.a)([Object(o.b)({type:v.a,json:{write:!0}})],y.prototype,"spatialReference",void 0),Object(a.a)([Object(u.a)(g.a)],y.prototype,"geometryType",void 0),y=i=Object(a.a)([Object(p.a)("esri.layers.support.source.QueryTableDataSource")],y);var O,j=n=class extends f.a{constructor(e){super(e),this.type="raster"}clone(){var{workspaceId:e,dataSourceName:t}=this;return new n({workspaceId:e,dataSourceName:t})}};Object(a.a)([Object(u.a)({raster:"raster"})],j.prototype,"type",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],j.prototype,"dataSourceName",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],j.prototype,"workspaceId",void 0),j=n=Object(a.a)([Object(p.a)("esri.layers.support.source.RasterDataSource")],j);var _,w,x=O=class extends f.a{constructor(e){super(e),this.type="table"}clone(){var{workspaceId:e,gdbVersion:t,dataSourceName:r}=this;return new O({workspaceId:e,gdbVersion:t,dataSourceName:r})}};Object(a.a)([Object(u.a)({table:"table"})],x.prototype,"type",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],x.prototype,"workspaceId",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],x.prototype,"gdbVersion",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],x.prototype,"dataSourceName",void 0),x=O=Object(a.a)([Object(p.a)("esri.layers.support.source.TableDataSource")],x);var S=Object(l.b)()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"}),M=_=class extends f.a{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,r){return E()(e,t,r)}castLeftTableSource(e){return Object(s.k)(C(),e)}readRightTableSource(e,t,r){return E()(e,t,r)}castRightTableSource(e){return Object(s.k)(C(),e)}clone(){var e,t,{leftTableKey:r,rightTableKey:i,leftTableSource:n,rightTableSource:a,joinType:s}=this,o={leftTableKey:r,rightTableKey:i,leftTableSource:null!=(e=null==n?void 0:n.clone())?e:void 0,rightTableSource:null!=(t=null==a?void 0:a.clone())?t:void 0,joinType:s};return new _(o)}};Object(a.a)([Object(u.a)({joinTable:"join-table"})],M.prototype,"type",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],M.prototype,"leftTableKey",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],M.prototype,"rightTableKey",void 0),Object(a.a)([Object(o.b)({json:{write:!0}})],M.prototype,"leftTableSource",void 0),Object(a.a)([Object(d.a)("leftTableSource")],M.prototype,"readLeftTableSource",null),Object(a.a)([Object(c.a)("leftTableSource")],M.prototype,"castLeftTableSource",null),Object(a.a)([Object(o.b)({json:{write:!0}})],M.prototype,"rightTableSource",void 0),Object(a.a)([Object(d.a)("rightTableSource")],M.prototype,"readRightTableSource",null),Object(a.a)([Object(c.a)("rightTableSource")],M.prototype,"castRightTableSource",null),Object(a.a)([Object(u.a)(S)],M.prototype,"joinType",void 0),M=_=Object(a.a)([Object(p.a)("esri.layers.support.source.JoinTableDataSource")],M);var T=null;function E(){return T||(T=Object(h.b)({types:C()})),T}var P=null;function C(){return P||(P={key:"type",base:null,typeMap:{"data-layer":A,"map-layer":m.a}}),P}var I={key:"type",base:null,typeMap:{"join-table":M,"query-table":y,raster:j,table:x}},A=w=class extends f.a{constructor(e){super(e),this.type="data-layer"}clone(){var{fields:e,dataSource:t}=this;return new w({fields:e,dataSource:t})}};Object(a.a)([Object(u.a)({dataLayer:"data-layer"})],A.prototype,"type",void 0),Object(a.a)([Object(o.b)({type:[b.a],json:{write:!0}})],A.prototype,"fields",void 0),Object(a.a)([Object(o.b)({types:I,json:{write:!0}})],A.prototype,"dataSource",void 0),(A=w=Object(a.a)([Object(p.a)("esri.layers.support.source.DataLayerSource")],A)).from=Object(s.m)(A)},,,,function(e,t,r){"use strict";function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function n(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function a(e,t){return new Float64Array(e,t,16)}r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a}));var s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:i,clone:n,fromValues:function(e,t,r,i,n,a,s,o,c,l,u,d,h,p,f,b){return[e,t,r,i,n,a,s,o,c,l,u,d,h,p,f,b]},createView:a,IDENTITY:s})},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return b}));var i=r(89),n=r(410),a=r(104),s=r(332),o=r(174),c=r(396),l=r(202),u=r(200);class d{constructor(e,t,r){this.itemByteSize=e,this.itemCreate=t,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(r/this.itemByteSize),this.tickHandle=n.a.before((()=>this.reset()))}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(i.o)(this.tickHandle)),this.itemsPtr=0,this.items=Object(i.o)(this.items),this.buffers=Object(i.o)(this.buffers)}get(){0===this.itemsPtr&&Object(n.a)((()=>{}));for(var e=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=e;){for(var t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),r=0;r<this.itemsPerBuffer;++r)this.items.push(this.itemCreate(t,r*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}reset(){for(var e=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>e;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}static createVec2f64(e=h){return new d(16,l.c,e)}static createVec3f64(e=h){return new d(24,a.c,e)}static createVec4f64(e=h){return new d(32,u.e,e)}static createMat3f64(e=h){return new d(72,s.b,e)}static createMat4f64(e=h){return new d(128,o.d,e)}static createQuatf64(e=h){return new d(32,c.b,e)}get test(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}var h=4096,p=d.createVec2f64(),f=d.createVec3f64(),b=d.createVec4f64(),m=(d.createMat3f64(),d.createMat4f64()),v=d.createQuatf64()},function(e,t,r){"use strict";class i{constructor(e=[],t=[],r=!1){this.lengths=null!=e?e:[],this.coords=null!=t?t:[],this.hasIndeterminateRingOrder=r}get isPoint(){return 0===this.lengths.length}forEachVertex(e){var t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(var r=0;r<this.lengths.length;r++){for(var i=this.lengths[r],n=0;n<i;n++)e(this.coords[2*(n+t)],this.coords[2*(n+t)+1]);t+=i}}clone(){return new i(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}t.a=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return O})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return b})),r.d(t,"i",(function(){return c})),r.d(t,"j",(function(){return l})),r.d(t,"k",(function(){return m}));var i=r(110),n=(r(104),r(157),r(202),r(200)),a=r(135);r(191),Object(n.c)();class s{constructor(e){this.message=e}toString(){return"AssertException: ".concat(this.message)}}function o(e,t){if(!e){t=t||"assert";var r=new Error(t);throw r.stack&&console.log(r.stack),new s(t)}}function c(e,t,r,i){var n,a=(r[0]-e[0])/t[0],s=(i[0]-e[0])/t[0];a>s&&(n=a,a=s,s=n);var o=(r[1]-e[1])/t[1],c=(i[1]-e[1])/t[1];if(o>c&&(n=o,o=c,c=n),a>c||o>s)return!1;o>a&&(a=o),c<s&&(s=c);var l=(r[2]-e[2])/t[2],u=(i[2]-e[2])/t[2];return l>u&&(n=l,l=u,u=n),!(a>u||l>s)&&(u<s&&(s=u),!(s<0))}function l(e,t,r,i){e[12]=t,e[13]=r,e[14]=i}function u(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]}function d(e,t,r){return 2*Math.atan(Math.sqrt(t*t+r*r)*Math.tan(.5*e)/t)}function h(e,t,r){return 2*Math.atan(Math.sqrt(t*t+r*r)*Math.tan(.5*e)/r)}function p(e,t,r){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+r*r))}function f(e,t,r){return 2*Math.atan(r*Math.tan(.5*e)/Math.sqrt(t*t+r*r))}function b(e,t,r=0){for(var n,a=Object(i.d)(e,0,y),s=0;s<4;s++)t[r+s]=Math.floor(256*((n=a*v[s])-Math.floor(n)))}function m(e,t=0){for(var r=0,i=0;i<4;i++)r+=e[t+i]*g[i];return r}var v=[1,256,65536,16777216],g=[1/256,1/65536,1/16777216,1/4294967296],y=m(new Uint8ClampedArray([255,255,255,255]));function O(e,t,r,i,n){var s=e;0===e[11]?(i[0]=2/(t*s[0]),i[1]=2/(r*s[5]),i[2]=(1+s[12])/s[0],i[3]=(1+s[13])/s[5],Object(a.r)(n,0,1)):(i[0]=-2/(t*s[0]),i[1]=-2/(r*s[5]),i[2]=(1-s[8])/s[0],i[3]=(1-s[9])/s[5],Object(a.r)(n,1,0))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));r(80);function i(e){}function n(e){return()=>e}},,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return O}));var i=r(82),n=r(126),a=r(84),s=r(144),o=r(97),c=r(228),l=r(89),u=r(253),d=r(92);class h{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(s.a),this._values=new Map}clone(e){var t=this,r=new h,i=this._originStores[0];i&&i.forEach(((e,t)=>{r.set(t,Object(d.a)(e),0)}));for(var n=function(i){var n=t._originStores[i];n&&n.forEach(((t,n)=>{e&&e.has(n)||r.set(n,Object(d.a)(t),i)}))},a=2;a<s.a;a++)n(a);return r}get(e,t){var r=void 0===t?this._values:this._originStores[t];return r?r.get(e):void 0}keys(e){var t=null==e?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,r=6){var i=this._originStores[r];if(i||(i=new Map,this._originStores[r]=i),i.set(e,t),!this._values.has(e)||Object(l.d)(this._propertyOriginMap.get(e))<=r){var n=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),n!==t}return!1}delete(e,t=6){var r=this._originStores[t];if(r){var i=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(var n=t-1;n>=0;n--){var a=this._originStores[n];if(a&&a.has(e)){this._values.set(e,a.get(e)),this._propertyOriginMap.set(e,n);break}}}return i}}has(e,t){var r=void 0===t?this._values:this._originStores[t];return!!r&&r.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;var r=this._originStores[t],i=r&&r.get(e),n=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,t),n!==i}originOf(e){return this._propertyOriginMap.get(e)||0}forEach(e){this._values.forEach(e)}}var p=h,f=e=>{var t=class extends e{constructor(...e){super(...e);var t=Object(l.d)(Object(n.a)(this)),r=t.metadatas,i=t.store,a=new p;t.store=a,i.keys().forEach((e=>{a.set(e,i.get(e),0)})),Object.keys(r).forEach((e=>{t.internalGet(e)&&a.set(e,t.internalGet(e),0)}))}read(e,t){Object(u.a)(this,e,t)}getAtOrigin(e,t){var r=b(this),i=Object(s.d)(t);if("string"==typeof e)return r.get(e,i);var n={};return e.forEach((e=>{n[e]=r.get(e,i)})),n}originOf(e){return Object(s.b)(this.originIdOf(e))}originIdOf(e){return b(this).originOf(e)}revert(e,t){var r=b(this),i=Object(s.d)(t),a=Object(n.a)(this);("string"==typeof e?"*"===e?r.keys(i):[e]:e).forEach((e=>{a.propertyInvalidated(e),r.revert(e,i),a.propertyCommitted(e)}))}};return t=Object(i.a)([Object(a.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],t)};function b(e){return Object(n.a)(e).store}var m=class extends(f(o.a)){};m=Object(i.a)([Object(a.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],m);var v=e=>{var t=class extends e{constructor(...e){super(...e)}clear(e,t="user"){return g(this).delete(e,Object(s.d)(t))}write(e={},t){return Object(c.b)(this,e=e||{},t),e}setAtOrigin(e,t,r){Object(n.a)(this).setAtOrigin(e,t,Object(s.d)(r))}removeOrigin(e){var t=g(this),r=Object(s.d)(e),i=t.keys(r);for(var n of i)t.originOf(n)===r&&t.set(n,t.get(n,r),6)}updateOrigin(e,t){for(var r=g(this),i=Object(s.d)(t),n=this.get(e),a=i+1;a<s.a;++a)r.delete(e,a);r.set(e,n,i)}toJSON(e){return this.write({},e)}};return(t=Object(i.a)([Object(a.a)("esri.core.WriteableMultiOriginJSONSupport")],t)).prototype.toJSON.isDefaultToJSON=!0,t};function g(e){return Object(n.a)(e).store}var y=e=>{var t=class extends(v(f(e))){constructor(...e){super(...e)}};return t=Object(i.a)([Object(a.a)("esri.core.MultiOriginJSONSupport")],t)},O=class extends(y(o.a)){};O=Object(i.a)([Object(a.a)("esri.core.MultiOriginJSONSupport")],O)},,,,function(e,t,r){"use strict";r.r(t),r.d(t,"executeQuery",(function(){return b})),r.d(t,"executeQueryForCount",(function(){return j})),r.d(t,"executeQueryForExtent",(function(){return _})),r.d(t,"executeQueryForIds",(function(){return O})),r.d(t,"executeQueryPBF",(function(){return v})),r.d(t,"executeQueryPBFBuffer",(function(){return y})),r.d(t,"queryToQueryStringParameters",(function(){return f})),r.d(t,"runQuery",(function(){return w}));var i=r(91),n=r(7),a=r(89),s=r(83),o=r(100),c=r(106),l=r(236),u=r(270),d=r(269),h=r(386),p="Layer does not support extent calculation.";function f(e,t){var r=e.geometry,i=e.toJSON(),n=i;if(Object(a.k)(r)&&(n.geometry=JSON.stringify(r),n.geometryType=Object(o.c)(r),n.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),i.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(",")),i.objectIds&&(n.objectIds=i.objectIds.join(",")),i.orderByFields&&(n.orderByFields=i.orderByFields.join(",")),!i.outFields||!i.returnDistinctValues&&(null!=t&&t.returnCountOnly||null!=t&&t.returnExtentOnly||null!=t&&t.returnIdsOnly)?delete n.outFields:-1!==i.outFields.indexOf("*")?n.outFields="*":n.outFields=i.outFields.join(","),i.outSR?n.outSR=i.outSR.wkid||JSON.stringify(i.outSR):r&&(i.returnGeometry||i.returnCentroid)&&(n.outSR=n.inSR),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(n.outStatistics=JSON.stringify(i.outStatistics)),i.pixelSize&&(n.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(n.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.parameterValues&&(n.parameterValues=JSON.stringify(i.parameterValues)),i.rangeValues&&(n.rangeValues=JSON.stringify(i.rangeValues)),i.dynamicDataSource&&(n.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i.timeExtent){var s=i.timeExtent,{start:c,end:l}=s;null==c&&null==l||(n.time=c===l?c:"".concat(null==c?"null":c,",").concat(null==l?"null":l)),delete i.timeExtent}return n}function b(e,t,r,i){return m.apply(this,arguments)}function m(){return(m=Object(n.a)((function*(e,t,r,i){var n=Object(a.k)(t.timeExtent)&&t.timeExtent.isEmpty?{data:{features:[]}}:yield w(e,t,"json",i);return Object(u.a)(t,r,n.data),n}))).apply(this,arguments)}function v(e,t,r,i){return g.apply(this,arguments)}function g(){return(g=Object(n.a)((function*(e,t,r,i){if(Object(a.k)(t.timeExtent)&&t.timeExtent.isEmpty)return Promise.resolve({data:r.createFeatureResult()});var n=yield y(e,t,i),s=n;return s.data=Object(h.a)(n.data,r),s}))).apply(this,arguments)}function y(e,t,r){return w(e,t,"pbf",r)}function O(e,t,r){return Object(a.k)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):w(e,t,"json",r,{returnIdsOnly:!0})}function j(e,t,r){return Object(a.k)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):w(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}function _(e,t,r){return Object(a.k)(t.timeExtent)&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):w(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((e=>{var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(p);if(t.hasOwnProperty("count"))throw new Error(p);return e}))}function w(e,t,r,n={},o={}){var u="string"==typeof e?Object(s.J)(e):e,h=t.geometry?[t.geometry]:[];return n.responseType="pbf"===r?"array-buffer":"json",Object(l.a)(h,null,n).then((e=>{var l=e&&e[0];Object(a.k)(l)&&((t=t.clone()).geometry=l);var h=Object(d.a)(Object(i.a)(Object(i.a)(Object(i.a)({},u.query),{},{f:r},o),f(t,o)));return Object(c.default)(Object(s.y)(u.path,"query"),Object(i.a)(Object(i.a)({},n),{},{query:Object(i.a)(Object(i.a)({},h),n.query)}))}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return O})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return v})),r.d(t,"k",(function(){return b})),r.d(t,"l",(function(){return a})),r.d(t,"m",(function(){return g}));var i=r(184);function n(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function o(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function c(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function l(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function d(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+a*a)}function h(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],a=t[3]-e[3];return r*r+i*i+n*n+a*a}function p(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)}function f(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function b(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r*r+i*i+n*n+a*a;return s>0&&(s=1/Math.sqrt(s),e[0]=r*s,e[1]=i*s,e[2]=n*s,e[3]=a*s),e}function m(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function v(e,t,r,i){var n=t[0],a=t[1],s=t[2],o=t[3];return e[0]=n+i*(r[0]-n),e[1]=a+i*(r[1]-a),e[2]=s+i*(r[2]-s),e[3]=o+i*(r[3]-o),e}function g(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*s,e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*s,e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*s,e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*s,e}function y(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function O(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],o=t[0],c=t[1],l=t[2],u=t[3];return Math.abs(r-o)<=i.a*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-c)<=i.a*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-l)<=i.a*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(s-u)<=i.a*Math.max(1,Math.abs(s),Math.abs(u))}var j=o,_=c,w=l,x=d,S=h,M=p,T=f;Object.freeze({__proto__:null,copy:n,set:a,add:s,subtract:o,multiply:c,divide:l,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:u,scaleAndAdd:function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e},distance:d,squaredDistance:h,length:p,squaredLength:f,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},normalize:b,dot:m,lerp:v,random:function(e,t){var r,n,a,s,o,c;t=t||1;do{o=(r=2*Object(i.b)()-1)*r+(n=2*Object(i.b)()-1)*n}while(o>=1);do{c=(a=2*Object(i.b)()-1)*a+(s=2*Object(i.b)()-1)*s}while(c>=1);var l=Math.sqrt((1-o)/c);return e[0]=t*r,e[1]=t*n,e[2]=t*a*l,e[3]=t*s*l,e},transformMat4:g,transformQuat:function(e,t,r){var i=t[0],n=t[1],a=t[2],s=r[0],o=r[1],c=r[2],l=r[3],u=l*i+o*a-c*n,d=l*n+c*i-s*a,h=l*a+s*n-o*i,p=-s*i-o*n-c*a;return e[0]=u*l+p*-s+d*-c-h*-o,e[1]=d*l+p*-o+h*-s-u*-c,e[2]=h*l+p*-c+u*-o-d*-s,e[3]=t[3],e},str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},exactEquals:y,equals:O,sub:j,mul:_,div:w,dist:x,sqrDist:S,len:M,sqrLen:T})},function(e,t,r){"use strict";var i=r(91),n=(r(80),r(81)),a=r(205),s=r(486),o=n.a.getLogger("esri.views.webgl.FrameBufferObject");class c{constructor(e,t,r,n){var o,l;if(this._context=e,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachments=new Map,this._initialized=!1,this._desc=Object(i.a)({},t),e.instanceCounter.increment(4,this),r)if(Array.isArray(r))for(var u of r){var{attachmentPoint:d,texture:h}=u,p=h instanceof a.a?h:new a.a(e,h);o=p.descriptor,this._colorAttachments.set(d,p),this._validateColorAttachmentPoint(d),this._validateTextureDimensions(o,this._desc)}else r instanceof a.a?(o=r.descriptor,this._colorAttachments.set(36064,r)):(o=r,this._colorAttachments.set(36064,new a.a(e,r))),0!==(null==(l=this._desc)?void 0:l.colorTarget)&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),this._validateTextureDimensions(o,this._desc);if(n instanceof s.a){var f,b=null!=(f=this._desc.depthStencilTarget)?f:3;2===b?this._stencilAttachment=n:1===b||3===b?this._depthAttachment=n:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),c._validateBufferDimensions(n.descriptor,this._desc)}else if(n){var m;this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),n instanceof a.a?(this._depthStencilTexture=n,m=this._depthStencilTexture.descriptor):(m=n,this._depthStencilTexture=new a.a(this._context,m)),this._validateTextureDimensions(m,this._desc)}}dispose(){if(this._desc){var e=this._context.getBoundFramebufferObject();this._disposeColorAttachments(),this._disposeDepthStencilAttachments(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(e),this._context.instanceCounter.decrement(4,this),this._desc=null}}get glName(){return this._glName}get descriptor(){return this._desc}get colorTexture(){var e=this._colorAttachments.get(36064);return e&&e instanceof a.a?e:null}get colorAttachment(){return this._colorAttachments.get(36064)}get depthStencilAttachment(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment}get depthStencilTexture(){return this._depthStencilTexture}get width(){return this._desc.width}get height(){return this._desc.height}getColorTexture(e){var t=this._colorAttachments.get(e);return t&&t instanceof a.a?t:null}attachColorTexture(e,t=36064){if(e){this._validateColorAttachmentPoint(t);var r=e.descriptor;if(this._validateTextureDimensions(r,this._desc),this._disposeColorAttachments(),this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl;i.framebufferTexture2D(i.FRAMEBUFFER,t,i.TEXTURE_2D,e.glName,0)}this._colorAttachments.set(t,e)}}detachColorTexture(e=36064){var t=this._colorAttachments.get(e);if(t instanceof a.a){var r=t;if(this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl;i.framebufferTexture2D(i.FRAMEBUFFER,e,i.TEXTURE_2D,null,0)}return this._colorAttachments.delete(e),r}}attachDepthStencilTexture(e){if(e){var t=e.descriptor;if(34041!==t.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==t.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDimensions(t,this._desc),this._desc.depthStencilTarget&&4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.TEXTURE_2D,e.glName,0)}this._depthStencilTexture=e}}detachDepthStencilTexture(){var e=this._depthStencilTexture;if(e&&this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl;this._context.gl.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,e}attachDepthStencilBuffer(e){if(e){var t=e.descriptor;if(34041!==t.internalFormat&&33189!==t.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat"),c._validateBufferDimensions(t,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=34041===t.internalFormat?3:1,this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl,i=1===this._desc.depthStencilTarget?r.DEPTH_ATTACHMENT:r.DEPTH_STENCIL_ATTACHMENT;r.framebufferRenderbuffer(r.FRAMEBUFFER,i,r.RENDERBUFFER,e.glName)}this._depthAttachment=e}}detachDepthStencilBuffer(){var e=this._context.gl,t=this._depthAttachment;if(t&&this._initialized){this._context.bindFramebuffer(this);var r=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,null)}return this._depthAttachment=null,t}copyToTexture(e,t,r,i,n,a,s){(e<0||t<0||n<0||a<0)&&console.error("Offsets cannot be negative!"),(r<=0||i<=0)&&console.error("Copy width and height must be greater than zero!");var o=this._desc,c=s.descriptor;3553!==s.descriptor.target&&console.error("Texture target must be TEXTURE_2D!"),(e+r>o.width||t+i>o.height||n+r>c.width||a+i>c.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");var l=this._context;l.bindTexture(s,0),l.bindFramebuffer(this),l.gl.copyTexSubImage2D(3553,0,n,a,e,t,r,i)}readPixels(e,t,r,i,n,a,s){(r<=0||i<=0)&&console.error("Copy width and height must be greater than zero!"),s||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,r,i,n,a,s)}resize(e,t){var r=this._desc;if(r.width!==e||r.height!==t){if(!this._initialized)return r.width=e,r.height=t,this._colorAttachments.forEach((r=>{r&&r.resize(e,t)})),void(this._depthStencilTexture&&this._depthStencilTexture.resize(e,t));r.width=e,r.height=t,this._colorAttachments.forEach((r=>{r&&r.resize(e,t)})),null!=this._depthStencilTexture?this._depthStencilTexture.resize(e,t):(this._depthAttachment||this._stencilAttachment)&&(this._depthAttachment&&this._depthAttachment.resize(e,t),this._stencilAttachment&&this._stencilAttachment.resize(e,t)),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}}initializeAndBind(){var e,t,r,i,n=this._context.gl;if(this._initialized)n.bindFramebuffer(n.FRAMEBUFFER,this.glName);else{this._glName&&n.deleteFramebuffer(this._glName);var o=this._context,c=n.createFramebuffer(),u=this._desc,d=null!=(e=u.colorTarget)?e:1,h=null!=(t=u.width)?t:1,p=null!=(r=u.height)?r:1;if(n.bindFramebuffer(n.FRAMEBUFFER,c),0===this._colorAttachments.size)if(0===d)this._colorAttachments.set(36064,l(o,u));else{var f=new s.a(o,{internalFormat:32854,width:h,height:p});this._colorAttachments.set(36064,f)}this._colorAttachments.forEach(((e,t)=>{e&&(e instanceof a.a?n.framebufferTexture2D(n.FRAMEBUFFER,t,n.TEXTURE_2D,e.glName,0):n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,e.glName))}));var b=null!=(i=u.depthStencilTarget)?i:0;switch(b){case 1:case 3:this._depthAttachment||(this._depthAttachment=new s.a(o,{internalFormat:1===u.depthStencilTarget?33189:34041,width:h,height:p}));var m=1===b?n.DEPTH_ATTACHMENT:n.DEPTH_STENCIL_ATTACHMENT;n.framebufferRenderbuffer(n.FRAMEBUFFER,m,n.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new s.a(o,{internalFormat:36168,width:h,height:p})),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.STENCIL_ATTACHMENT,n.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:if(!this._depthStencilTexture){o.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");var v={target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:h,height:p};this._depthStencilTexture=new a.a(o,v)}n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,this._depthStencilTexture.glName,0)}this._glName=c,this._initialized=!0}}_disposeColorAttachments(){this._colorAttachments.forEach(((e,t)=>{if(e instanceof a.a){if(this._initialized){this._context.bindFramebuffer(this);var r=this._context.gl;r.framebufferTexture2D(r.FRAMEBUFFER,t,r.TEXTURE_2D,null,0)}e.dispose()}else if(e instanceof WebGLRenderbuffer){var i=this._context.gl;this._initialized&&(this._context.bindFramebuffer(this),i.framebufferRenderbuffer(i.FRAMEBUFFER,t,i.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(e)}})),this._colorAttachments.clear()}_disposeDepthStencilAttachments(){var e=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var t=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)}static _validateBufferDimensions(e,t){console.assert(e.width>=0&&e.height>=0),void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(t.width=e.width,t.height=e.height)}_validateTextureDimensions(e,t){console.assert(e.width>=0&&e.height>=0),3553!==e.target&&console.error("Texture type must be TEXTURE_2D!"),void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Color attachment texture must match the framebuffer's!"):(t.width=e.width,t.height=e.height)}_validateColorAttachmentPoint(e){if(-1===c._MAX_COLOR_ATTACHMENTS){var t=this._context.capabilities.drawBuffers;if(t){var r=this._context.gl;c._MAX_COLOR_ATTACHMENTS=r.getParameter(t.MAX_COLOR_ATTACHMENTS)}else c._MAX_COLOR_ATTACHMENTS=1}var i=e-36064;i+1>c._MAX_COLOR_ATTACHMENTS&&o.error("esri.FrameBufferObject","illegal attachment point for color attachment: ".concat(i+1,". Implementation supports up to ").concat(c._MAX_COLOR_ATTACHMENTS," color attachments"))}}c._MAX_COLOR_ATTACHMENTS=-1;var l=(e,t)=>new a.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:t.width,height:t.height});t.a=c},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(139),n=r(117),a={inches:Object(n.c)(1,"meters","inches"),feet:Object(n.c)(1,"meters","feet"),"us-feet":Object(n.c)(1,"meters","us-feet"),yards:Object(n.c)(1,"meters","yards"),miles:Object(n.c)(1,"meters","miles"),"nautical-miles":Object(n.c)(1,"meters","nautical-miles"),millimeters:Object(n.c)(1,"meters","millimeters"),centimeters:Object(n.c)(1,"meters","centimeters"),decimeters:Object(n.c)(1,"meters","decimeters"),meters:Object(n.c)(1,"meters","meters"),kilometers:Object(n.c)(1,"meters","kilometers"),"decimal-degrees":1/Object(n.m)(1,"meters",i.a.radius)}},function(e,t,r){"use strict";var i,n=r(7),a=r(82),s=(r(80),r(92)),o=(r(81),r(88),r(85)),c=r(102),l=r(84),u=(r(83),r(86),r(87),r(128)),d=r(203),h=r(412),p=i=class extends(Object(d.a)(u.a)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}collectRequiredFields(e,t){var r=this;return Object(n.a)((function*(){yield Promise.all([r.collectSymbolFields(e,t),r.collectVVRequiredFields(e,t)])}))()}collectSymbolFields(e,t){var r=this;return Object(n.a)((function*(){yield Promise.all(r.getSymbols().map((r=>r.collectRequiredFields(e,t))))}))()}getSymbol(e,t){return this.symbol}getSymbolAsync(e,t){var r=this;return Object(n.a)((function*(){return r.symbol}))()}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new i({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:Object(s.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],p.prototype,"description",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],p.prototype,"label",void 0),Object(a.a)([Object(o.b)(h.b)],p.prototype,"symbol",void 0),Object(a.a)([Object(c.a)({simple:"simple"})],p.prototype,"type",void 0);var f=p=i=Object(a.a)([Object(l.a)("esri.renderers.SimpleRenderer")],p);t.a=f},function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88),r(85)),o=r(95),c=r(98),l=r(84),u=r(96),d=(r(83),r(86),r(87),r(90)),h=r(138),p=r(341),f=r(230),b=i=class extends d.a{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?Object(f.a)(t.value):e}writeExpression(e,t,r){null!=this.value&&(e=Object(f.a)(this.value)),t[r]=e}clone(){return new i({expression:this.expression,title:this.title,value:this.value})}};Object(n.a)([Object(s.b)({type:String,json:{write:{allowNull:!0}}})],b.prototype,"expression",void 0),Object(n.a)([Object(c.a)("expression",["expression","value"])],b.prototype,"readExpression",null),Object(n.a)([Object(u.a)("expression")],b.prototype,"writeExpression",null),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],b.prototype,"title",void 0),Object(n.a)([Object(s.b)({json:{read:!1,write:!1}})],b.prototype,"value",void 0);var m,v=b=i=Object(n.a)([Object(l.a)("esri.layers.support.LabelExpressionInfo")],b),g=r(234),y=new o.a({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function O(e){return!e||"service"!==e.origin&&!j(e.layer)}function j(e){return"map-image"===(null==e?void 0:e.type)}function _(e){var t,r;return!!j(e)&&!(null==(t=e.capabilities)||null==(r=t.exportMap)||!r.supportsArcadeExpressionForLabeling)}var w=m=class extends d.a{constructor(e){super(e),this.type="label",this.name=null,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.maxScale=0,this.minScale=0,this.symbol=g.a,this.useCodedValues=void 0,this.where=null}static evaluateWhere(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var i=e.split(" ");if(3===i.length)return r(t[i[0]],i[1],i[2]);if(7===i.length){var n=r(t[i[0]],i[1],i[2]),a=i[3],s=r(t[i[4]],i[5],i[6]);switch(a){case"AND":return n&&s;case"OR":return n||s}}return!1}catch(o){console.log("Error.: can't parse = "+e)}}readLabelExpression(e,t){var r=t.labelExpressionInfo;if(!r||!r.value&&!r.expression)return e}writeLabelExpression(e,t,r){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)e=Object(f.f)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var i=Object(f.e)(this.labelExpressionInfo.expression);i&&(e="["+i+"]")}null!=e&&(t[r]=e)}writeLabelExpressionInfo(e,t,r,i){if(null==e&&null!=this.labelExpression&&O(i))e=new v({expression:this.getLabelExpressionArcade()});else if(!e)return;var n=e.toJSON(i);n.expression&&(t[r]=n)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return Object(f.b)(this)}getLabelExpressionArcade(){return Object(f.c)(this)}getLabelExpressionSingleField(){return Object(f.d)(this)}hash(){return JSON.stringify(this)}clone(){return new m({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:Object(a.a)(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:Object(a.a)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],w.prototype,"name",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],w.prototype,"deconflictionStrategy",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:{overridePolicy(e,t,r){return this.labelExpressionInfo&&"service"===(null==r?void 0:r.origin)&&_(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],w.prototype,"labelExpression",void 0),Object(n.a)([Object(c.a)("labelExpression")],w.prototype,"readLabelExpression",null),Object(n.a)([Object(u.a)("labelExpression")],w.prototype,"writeLabelExpression",null),Object(n.a)([Object(s.b)({type:v,json:{write:{overridePolicy:(e,t,r)=>function(e){return O(e)||_(e.layer)}(r)?{allowNull:!0}:{enabled:!1}}}})],w.prototype,"labelExpressionInfo",void 0),Object(n.a)([Object(u.a)("labelExpressionInfo")],w.prototype,"writeLabelExpressionInfo",null),Object(n.a)([Object(s.b)({type:y.apiValues,json:{type:y.jsonValues,read:y.read,write:y.write}})],w.prototype,"labelPlacement",void 0),Object(n.a)([Object(s.b)({type:Number})],w.prototype,"maxScale",void 0),Object(n.a)([Object(u.a)("maxScale")],w.prototype,"writeMaxScale",null),Object(n.a)([Object(s.b)({type:Number})],w.prototype,"minScale",void 0),Object(n.a)([Object(u.a)("minScale")],w.prototype,"writeMinScale",null),Object(n.a)([Object(s.b)({types:h.g,json:{origins:{"web-scene":{types:h.h,write:p.b,default:null}},write:p.b,default:null}})],w.prototype,"symbol",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],w.prototype,"useCodedValues",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],w.prototype,"where",void 0);var x=w=m=Object(n.a)([Object(l.a)("esri.layers.support.LabelClass")],w);t.a=x},function(e,t,r){"use strict";r.d(t,"a",(function(){return H})),r.d(t,"b",(function(){return B})),r.d(t,"c",(function(){return k})),r.d(t,"d",(function(){return J})),r.d(t,"e",(function(){return U})),r.d(t,"f",(function(){return V})),r.d(t,"g",(function(){return q})),r.d(t,"h",(function(){return N})),r.d(t,"i",(function(){return P})),r.d(t,"j",(function(){return C})),r.d(t,"k",(function(){return I})),r.d(t,"l",(function(){return x})),r.d(t,"m",(function(){return S})),r.d(t,"n",(function(){return G})),r.d(t,"o",(function(){return K})),r.d(t,"p",(function(){return Y})),r.d(t,"q",(function(){return T})),r.d(t,"r",(function(){return L})),r.d(t,"s",(function(){return F}));var i=r(91),n=r(7),a=r(89),s=r(143),o=r(81),c=r(93),l=r(118),u=r(256),d=r(248),h=r(355),p=(r(171),o.a.getLogger("esri.widgets.Feature.support.featureUtils")),f=/href=(""|'')/gi,b=/(\{([^\{\r\n]+)\})/g,m=/\'/g,v=/^\s*expression\//i,g=/(\n)/gi,y=/[\u00A0-\u9999<>\&]/gim,O=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,j=/^(?:mailto:|tel:)/,_="relationships/",w=Object(u.a)("short-date-short-time");function x(e){if(!Object(a.j)(e))return e.get("sourceLayer")||e.get("layer")}function S(e,t){return M.apply(this,arguments)}function M(){return(M=Object(n.a)((function*(e,t){return"function"==typeof e?e.call(null,t):e}))).apply(this,arguments)}function T(e=""){if(e)return!j.test(e.trim().toLowerCase())}function E(e,t){if(!function(e){return v.test(e)}(t)||!e)return null;var r,i=t.replace(v,"").toLowerCase();return e.some((e=>e.name.toLowerCase()===i&&(r=e,!0))),r}function P(e,t){var r=E(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function C(e,t){var r=A(t,e);return r?r.name:e}function I(e,t){return e&&e.map((e=>C(e,t)))}function A(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function R(e){return"".concat(e).trim()}function F({attributes:e,globalAttributes:t,layer:r,text:n,fieldInfoMap:a}){return n?L({formattedAttributes:t,template:z(n,Object(i.a)(Object(i.a)({},t),e),r),fieldInfoMap:a}):""}function L({formattedAttributes:e,template:t,fieldInfoMap:r}){return R(function(e){return e.replace(f,"")}(Object(s.c)(Object(s.c)(t,(e=>function(e,t){var r=t.get(e.toLowerCase());return"{".concat(r&&r.fieldName||e,"}")}(e,r))),e)))}function D(e,t=!1){var r=Object(i.a)({},e);return Object.keys(r).forEach((e=>function(e,t,r=!1){var i=t[e];if("string"==typeof i){var n=(r?encodeURIComponent(i):i).replace(m,"%27");t[e]=n}}(e,r,t))),r}function k(e,t){return e.replace(b,((e,r,i)=>{var n=A(t,i);return n?"{".concat(n.name,"}"):r}))}function z(e,t,r){var i=k(e,r);return i?i.replace(O,((e,r,i)=>function(e,t,r){var i=(t=R(t))&&"{"!==t[0];return Object(s.c)(e,D(r,i))}(e,r||i,t))):i}function V(e,t){var r=t.fieldInfos,n=t.fieldName,a=N(r,n),s=null==a?void 0:a.clone(),o=t.preventPlacesFormatting,c=A(t.layer,n);if(s&&c&&"date"===c.type){var l=s.format||new h.a;l.dateFormat=l.dateFormat||"short-date-short-time",s.format=l}var u=s&&s.format;return"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){var r=Number(e);if(!isNaN(r))return r}return e}(e,u))||null==e||null==u?e:o?Object(d.b)(e,Object(i.a)(Object(i.a)({},Object(d.a)(u)),{},{minimumFractionDigits:0,maximumFractionDigits:20})):u.format(e)}function N(e,t){if(e&&e.length&&t){var r,i=t.toLowerCase();return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==i)&&(r=e,!0))),r}}function U(e,t){var{creatorField:r,creationDateField:i,editorField:n,editDateField:a}=e;if(t){var s=t[a];if("number"==typeof s){var o=t[n];return{type:"edit",date:Object(u.b)(s,w),user:o}}var c=t[i];if("number"==typeof c){var l=t[r];return{type:"create",date:Object(u.b)(c,w),user:l}}return null}}function B(e,t){var r=new Map;return e&&e.forEach((e=>{var i=C(e.fieldName,t);e.fieldName=i,r.set(i.toLowerCase(),e)})),r}function q(e){var t=[];if(!e)return t;var{fieldInfos:r,content:i}=e;return r&&t.push(...r),i&&Array.isArray(i)?(i.forEach((e=>{if("fields"===e.type){var r=e&&e.fieldInfos;r&&t.push(...r)}})),t):t}function G(e){return e.replace(y,(e=>"&#".concat(e.charCodeAt(0),";")))}function H(e){return"string"==typeof e?e.replace(g,'<br class="esri-text-new-line" />'):e}function W(e){var{value:t,fieldName:r,fieldInfos:i,fieldInfoMap:n,layer:a,graphic:s}=e;if(null==t)return"";var o=function({fieldName:e,value:t,graphic:r,layer:i}){if(K(e))return null;if(!i||"function"!=typeof i.getFieldDomain)return null;var n=i.getFieldDomain(e,{feature:r});return n&&"coded-value"===n.type?n.getName(t):null}({fieldName:r,value:t,graphic:s,layer:a});if(o)return o;var c=function({fieldName:e,graphic:t,layer:r}){if(K(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;var{typeIdField:i}=r;if(!i||e!==i)return null;var n=r.getFeatureType(t);return n?n.name:null}({fieldName:r,graphic:s,layer:a});if(c)return c;if(n.get(r.toLowerCase()))return V(t,{fieldInfos:i,fieldName:r,layer:a});var l=a&&a.fieldsIndex;return l&&l.isDateField(r)?Object(u.b)(t,w):H(t)}function J({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:a,relatedInfos:s}){var o=Object(i.a)({},t);return null==s||s.forEach((e=>function(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>$({attributes:e,graphic:r,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>$({attributes:e,graphic:r,relatedInfo:t}))))}(o,e))),Object.keys(o).forEach((t=>{var i=o[t];o[t]=W({fieldName:t,fieldInfos:e,fieldInfoMap:a,layer:r,value:i,graphic:n})})),o}function Z(e,t){return X.apply(this,arguments)}function X(){return(X=Object(n.a)((function*(e,t){var{layer:r,graphic:i,outFields:n,objectIds:a,returnGeometry:s,spatialReference:o}=e,l=a[0];if("number"!=typeof l&&"string"!=typeof l){var u="Could not query required fields for the specified feature. The feature's ID is invalid.",d={layer:r,graphic:i,objectId:l,requiredFields:n},h=new c.a("layer-query-features-invalid-objectid",u,d);throw p.warn(u,d),h}if("function"!=typeof r.queryFeatures){var f="The specified layer does not support the method 'queryFeatures'. The following fields will not be available.",b={layer:r,graphic:i,requiredFields:n},m=new c.a("layer-query-features-unsupported",f,b);throw p.warn(f,b),m}var v=r.createQuery();return v.objectIds=a,v.outFields=n,v.returnGeometry=!!s,v.outSpatialReference=o,(yield r.queryFeatures(v,t)).features[0]}))).apply(this,arguments)}function Y(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(n.a)((function*({graphic:e,popupTemplate:t,layer:r,spatialReference:n},a){if(r&&t){var{returnGeometry:s}=t;"function"==typeof r.load&&(yield r.load(a));var o=e.attributes[r.objectIdField];if(null!=o){var c=[o],u=yield t.getRequiredFields(r.fields),d=Object(l.j)(u,e),h=d?[]:u;if(!d||s){var p=yield Z({layer:r,graphic:e,outFields:h,objectIds:c,returnGeometry:s,spatialReference:n},a);p&&(p.geometry&&(e.geometry=p.geometry),p.attributes&&(e.attributes=Object(i.a)(Object(i.a)({},e.attributes),p.attributes)))}}}}))).apply(this,arguments)}function K(e=""){return!!e&&-1!==e.indexOf(_)}function $({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((i=>{var n=function(e){return e?"".concat(_).concat(e.layerId,"/").concat(e.fieldName):""}({layerId:r.relation.id.toString(),fieldName:i});e[n]=t.attributes[i]}))}},function(e,t,r){"use strict";r.r(t);var i,n=r(91),a=r(7),s=r(82),o=(r(80),r(92)),c=r(89),l=r(143),u=r(81),d=(r(88),r(85)),h=r(84),p=r(96),f=r(93),b=(r(83),r(86),r(87),r(94)),m=r(152),v=r(118),g=r(109),y=r(356),O=r(106),j=r(128),_=r(203),w=r(235),x=u.a.getLogger("esri.renderers.DictionaryRenderer"),S={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}},M=i=class extends(Object(_.a)(j.a)){constructor(e){super(e),this._ongoingRequests=new Map,this._symbolCache=new w.a(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,r,i){null!=i&&i.origin||super.writeVisualVariables(e,t,r,i)}clone(){return new i({config:Object(o.a)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:Object(o.a)(this.fieldMap),url:Object(o.a)(this.url),visualVariables:Object(o.a)(this.visualVariables)})}getSymbolAsync(e,t){var r=this;return Object(a.a)((function*(){var i;r._dictionaryPromise||(r._dictionaryPromise=r.fetchResources(t));try{i=yield r._dictionaryPromise}catch(T){if(Object(b.m)(T))return r._dictionaryPromise=null,null}var n={};if(r.fieldMap)for(var a of r._symbolFields){var s=r.fieldMap[a];if(s&&null!==e.attributes[s]&&void 0!==e.attributes[s]){var o=""+e.attributes[s];n[a]=o}else n[a]=""}var u=i(n,t);if(!u||"string"!=typeof u)return null;var d=Object(l.b)(u).toString(),h=r._symbolCache.get(d);if(h)return h.catch((()=>{r._symbolCache.pop(d)})),h;var p=u.split(";"),f=[],m=[];for(var v of p)if(v&&0!==v.length)if(-1===v.indexOf("po:"))if(-1!==v.indexOf("|"))for(var y of v.split("|"))r._itemNames.has(y)&&f.push(y);else r._itemNames.has(v)&&f.push(v);else{var O=v.substr(3).split("|");if(3===O.length){var j=O[0],_=O[1],w=O[2];if("DashTemplate"===_)w=w.split(" ").map((e=>Number(e)));else if("Color"===_){var x=new g.a(w).toRgba();w=[x[0],x[1],x[2],255*x[3]]}else w=Number(w);m.push({primitiveName:j,propertyName:_,value:w})}}var S=!Object(c.k)(e.geometry)||!e.geometry.hasZ&&"point"===e.geometry.type,M=r._cimPartsToCIMSymbol(f,m,S,t);return r._symbolCache.put(d,M,1),M}))()}collectRequiredFields(e,t){var r=this;return Object(a.a)((function*(){yield r.collectVVRequiredFields(e,t),r.scaleExpression&&(yield Object(v.c)(e,t,r.scaleExpression));var i=t.map((e=>e.name));for(var n in r.fieldMap)i.indexOf(r.fieldMap[n])<0||e.add(r.fieldMap[n])}))()}get arcadeRequired(){return!0}fetchResources(e){var t=this;return Object(a.a)((function*(){if(t._dictionaryPromise)return t._dictionaryPromise;if(t.url){var r=Object(c.k)(e)?e.abortOptions:null,i=Object(O.default)(t.url+"/resources/styles/dictionary-info.json",Object(n.a)({responseType:"json",query:{f:"json"}},r)),[{data:a}]=yield Promise.all([i,Object(m.e)()]);if(!a)throw t._dictionaryPromise=null,new f.a("esri.renderers.DictionaryRenderer","Bad dictionary data!");var s=a.expression,o=a.authoringInfo;t._refSymbolUrlTemplate=t.url+"/"+a.cimRefTemplateUrl,t._itemNames=new Set(a.itemsNames),t._symbolFields=o.symbol;var l={};if(t.config){var u=t.config;for(var d in u)l[d]=u[d]}if(o.configuration)for(var h of o.configuration)l.hasOwnProperty(h.name)||(l[h.name]=h.value);var p=[];if(Object(c.k)(e)&&e.fields&&t.fieldMap){var b=function(r){var i=t.fieldMap[r],a=e.fields.filter((e=>e.name===i));a.length>0&&p.push(Object(n.a)(Object(n.a)({},a[0]),{},{name:r}))};for(var v of t._symbolFields)b(v)}return t._dictionaryPromise=Object(m.b)(s,Object(c.k)(e)?e.spatialReference:null,p,l).then((e=>{var t={scale:0};return(r,i)=>{var n=e.repurposeFeature({geometry:null,attributes:r});return t.scale=Object(c.k)(i)?i.scale:void 0,e.evaluate({$feature:n,$view:t})}})).catch((e=>(x.error("Creating dictinoary expression failed:",e),null))),t._dictionaryPromise}x.error("no valid URL!")}))()}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return"".concat(this.url,"-").concat(JSON.stringify(this.fieldMap))}getSymbolFields(){return this._symbolFields}_getSymbolPart(e,t){var r=this;return Object(a.a)((function*(){if(r._ongoingRequests.has(e))return r._ongoingRequests.get(e).then((e=>e.data));var i=r._refSymbolUrlTemplate.replace(/\{itemName\}/gi,e),a=Object(O.default)(i,Object(n.a)({responseType:"json",query:{f:"json"}},t));r._ongoingRequests.set(e,a);try{return(yield a).data}catch(s){return r._ongoingRequests.delete(e),Promise.reject(s)}}))()}_combineSymbolParts(e,t,r){if(!e||0===e.length)return null;var i=Object(n.a)({},e[0]);if(e.length>1)for(var a of(i.symbolLayers=[],e)){var s=a;i.symbolLayers.unshift(...s.symbolLayers)}return r&&(i.callout=S),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:t}}_cimPartsToCIMSymbol(e,t,r,i){var n=this;return Object(a.a)((function*(){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=n._getSymbolPart(e[s],i);var o=yield Promise.all(a);return new y.a({data:n._combineSymbolParts(o,t,r)})}))()}};Object(s.a)([Object(d.b)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],M.prototype,"config",void 0),Object(s.a)([Object(d.b)({type:Object,json:{write:!0}})],M.prototype,"fieldMap",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],M.prototype,"scaleExpression",void 0),Object(s.a)([Object(p.a)("scaleExpression")],M.prototype,"writeData",null),Object(s.a)([Object(d.b)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],M.prototype,"scaleExpressionTitle",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],M.prototype,"url",void 0),Object(s.a)([Object(p.a)("visualVariables")],M.prototype,"writeVisualVariables",null);var T=M=i=Object(s.a)([Object(h.a)("esri.renderers.DictionaryRenderer")],M);t.default=T},function(e,t,r){"use strict";var i,n=r(7),a=r(82),s=(r(80),r(92)),o=(r(81),r(88),r(85)),c=r(102),l=r(84),u=(r(83),r(86),r(87),r(118)),d=r(109),h=r(128),p=r(278),f=i=class extends h.a{constructor(e){super(e),this.blurRadius=10,this.colorStops=[new p.a({ratio:0,color:new d.a("rgba(255, 140, 0, 0)")}),new p.a({ratio:.75,color:new d.a("rgba(255, 140, 0, 1)")}),new p.a({ratio:.9,color:new d.a("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.maxPixelIntensity=100,this.minPixelIntensity=0,this.type="heatmap"}collectRequiredFields(e,t){var r=this;return Object(n.a)((function*(){var i=r.field;i&&"string"==typeof i&&Object(u.f)(e,t,i)}))()}getAttributeHash(){return null}getMeshHash(){return"".concat(JSON.stringify(this.colorStops),".").concat(this.blurRadius,".").concat(this.field)}clone(){return new i({blurRadius:this.blurRadius,colorStops:Object(s.a)(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}};Object(a.a)([Object(o.b)({type:Number,json:{write:!0}})],f.prototype,"blurRadius",void 0),Object(a.a)([Object(o.b)({type:[p.a],json:{write:!0}})],f.prototype,"colorStops",void 0),Object(a.a)([Object(o.b)({type:String,json:{write:!0}})],f.prototype,"field",void 0),Object(a.a)([Object(o.b)({type:Number,json:{write:{overridePolicy:(e,t,r)=>({enabled:null==r})}}})],f.prototype,"fieldOffset",void 0),Object(a.a)([Object(o.b)({type:Number,json:{write:!0}})],f.prototype,"maxPixelIntensity",void 0),Object(a.a)([Object(o.b)({type:Number,json:{write:!0}})],f.prototype,"minPixelIntensity",void 0),Object(a.a)([Object(c.a)({heatmap:"heatmap"})],f.prototype,"type",void 0);var b=f=i=Object(a.a)([Object(l.a)("esri.renderers.HeatmapRenderer")],f);t.a=b},function(e,t,r){"use strict";var i,n=r(7),a=r(82),s=(r(80),r(92)),o=r(81),c=r(88),l=r(85),u=r(145),d=r(102),h=r(84),p=(r(83),r(86),r(87),r(118)),f=r(109),b=r(220),m=r(211),v=r(128),g=r(203),y=r(116),O=r(90),j=o.a.getLogger("esri.renderers.support.AttributeColorInfo"),_=i=class extends O.a{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return null==e?e:"function"==typeof e?(j.error(".field: field must be a string value"),null):Object(c.l)(e)}getAttributeHash(){return"".concat(this.field,"-").concat(this.valueExpression)}clone(){return new i({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};Object(a.a)([Object(l.b)({type:f.a,json:{type:[Number],write:!0}})],_.prototype,"color",void 0),Object(a.a)([Object(l.b)({type:String,json:{write:!0}})],_.prototype,"field",void 0),Object(a.a)([Object(y.a)("field")],_.prototype,"castField",null),Object(a.a)([Object(l.b)({type:String,json:{write:!0}})],_.prototype,"label",void 0),Object(a.a)([Object(l.b)({type:String,json:{write:!0}})],_.prototype,"valueExpression",void 0),Object(a.a)([Object(l.b)({type:String,json:{write:!0}})],_.prototype,"valueExpressionTitle",void 0);var w,x=_=i=Object(a.a)([Object(h.a)("esri.renderers.support.AttributeColorInfo")],_),S=w=class extends O.a{constructor(){super(...arguments),this.unit=null}clone(){return new w({unit:this.unit})}};Object(a.a)([Object(l.b)({type:String,json:{write:!0}})],S.prototype,"unit",void 0);var M,T=S=w=Object(a.a)([Object(h.a)("esri.renderers.support.DotDensityLegendOptions")],S),E=M=class extends(Object(g.a)(v.a)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new f.a([0,0,0,0]),this.blendDots=!0,this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new b.a,this.dotValue=null,this.referenceDotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;var t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new m.a({outline:this.outline})}getSymbolAsync(){var e=this;return Object(n.a)((function*(){return e.getSymbol()}))()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes&&this.attributes.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new M({attributes:Object(s.a)(this.attributes),backgroundColor:Object(s.a)(this.backgroundColor),dotBlendingEnabled:Object(s.a)(this.dotBlendingEnabled),dotShape:Object(s.a)(this.dotShape),dotSize:Object(s.a)(this.dotSize),dotValue:Object(s.a)(this.dotValue),legendOptions:Object(s.a)(this.legendOptions),outline:Object(s.a)(this.outline),referenceScale:Object(s.a)(this.referenceScale),visualVariables:Object(s.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return"".concat(this.attributes.map((e=>e.field||e.valueExpression||"")),"-").concat(this.outline&&JSON.stringify(this.outline.toJSON())||"")}collectRequiredFields(e,t){var r=this;return Object(n.a)((function*(){for(var i of(yield r.collectVVRequiredFields(e,t),r.attributes))i.valueExpression&&(yield Object(p.c)(e,t,i.valueExpression)),i.field&&e.add(i.field)}))()}};Object(a.a)([Object(l.b)({type:[x],json:{write:!0}})],E.prototype,"attributes",void 0),Object(a.a)([Object(l.b)({type:f.a,json:{write:!0}})],E.prototype,"backgroundColor",void 0),Object(a.a)([Object(l.b)({type:Boolean}),Object(u.a)("dotBlendingEnabled")],E.prototype,"blendDots",void 0),Object(a.a)([Object(l.b)({type:Boolean,json:{write:!0}})],E.prototype,"dotBlendingEnabled",void 0),Object(a.a)([Object(l.b)({type:String,json:{write:!1}})],E.prototype,"dotShape",void 0),Object(a.a)([Object(l.b)({type:Number,json:{write:!1}})],E.prototype,"dotSize",void 0),Object(a.a)([Object(l.b)({type:T,json:{write:!0}})],E.prototype,"legendOptions",void 0),Object(a.a)([Object(l.b)({type:b.a,json:{default:null,write:!0}})],E.prototype,"outline",void 0),Object(a.a)([Object(l.b)({type:Number,json:{write:!0}})],E.prototype,"dotValue",void 0),Object(a.a)([Object(l.b)({type:Number}),Object(u.a)("dotValue")],E.prototype,"referenceDotValue",void 0),Object(a.a)([Object(l.b)({type:Number,json:{write:!0}})],E.prototype,"referenceScale",void 0),Object(a.a)([Object(l.b)({type:Number,json:{write:!0}})],E.prototype,"seed",void 0),Object(a.a)([Object(d.a)({dotDensity:"dot-density"})],E.prototype,"type",void 0);var P=E=M=Object(a.a)([Object(h.a)("esri.renderers.DotDensityRenderer")],E);t.a=P},function(e,t,r){"use strict";function i(){return[0,0,0,0]}function n(e){return[e[0],e[1],e[2],e[3]]}function a(e,t,r,i){return[e,t,r,i]}function s(e){for(var t=[0,0,0,0],r=Math.min(4,e.length),i=0;i<r;++i)t[i]=e[i];return t}function o(e,t){return new Float64Array(e,t,4)}function c(){return[0,0,0,0]}function l(){return a(1,1,1,1)}function u(){return a(1,0,0,0)}function d(){return a(0,1,0,0)}function h(){return a(0,0,1,0)}function p(){return a(0,0,0,1)}r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return n})),r.d(t,"g",(function(){return s}));var f=[0,0,0,0],b=l(),m=u(),v=d(),g=h(),y=p();Object.freeze({__proto__:null,create:i,clone:n,fromValues:a,fromArray:s,createView:o,zeros:c,ones:l,unitX:u,unitY:d,unitZ:h,unitW:p,ZEROS:f,ONES:b,UNIT_X:m,UNIT_Y:v,UNIT_Z:g,UNIT_W:y})},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o}));var i=r(94);function n(e,t,r){return Object(i.j)(e.map(((e,i)=>t.apply(r,[e,i]))))}function a(e,t,r){return Object(i.j)(e.map(((e,i)=>t.apply(r,[e,i])))).then((e=>e.map((e=>e.value))))}function s(e){return e.then((e=>({ok:!0,value:e}))).catch((e=>({ok:!1,error:e})))}function o(e){return e.then((e=>({ok:!0,value:e}))).catch((e=>(Object(i.t)(e),{ok:!1,error:e})))}},function(e,t,r){"use strict";function i(){return[0,0]}function n(e){return[e[0],e[1]]}function a(e,t){return[e,t]}function s(e){for(var t=[0,0],r=Math.min(2,e.length),i=0;i<r;++i)t[i]=e[i];return t}function o(e,t){return new Float64Array(e,t,2)}function c(){return[0,0]}function l(){return a(1,1)}function u(){return a(1,0)}function d(){return a(0,1)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return a}));var h=[0,0],p=l(),f=u(),b=d();Object.freeze({__proto__:null,create:i,clone:n,fromValues:a,fromArray:s,createView:o,zeros:c,ones:l,unitX:u,unitY:d,ZEROS:h,ONES:p,UNIT_X:f,UNIT_Y:b})},,function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),e=>{var t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get scaleRangeId(){return"".concat(this.minScale,",").concat(this.maxScale)}};return Object(i.a)([Object(n.b)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),Object(i.a)([Object(n.b)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],t.prototype,"scaleRangeId",null),t=Object(i.a)([Object(a.a)("esri.layers.mixins.ScaleRangeLayer")],t)})},function(e,t,r){"use strict";var i=r(91),n=r(89),a=r(110),s=r(364);class o{constructor(e,t,r=null){this._context=null,this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,e.instanceCounter.increment(0,this),this._context=e,this._descriptor=Object(i.a)({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},t),this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}dispose(){if(this._context&&this._context.gl){if(this._glName){var e=this._context.gl;this._context.unbindTextureAllUnits(this),e.deleteTexture(this._glName),this._glName=null}this._context.instanceCounter.decrement(0,this),this._context=null}}release(){this.dispose()}resize(e,t){var r=this._descriptor;r.width===e&&r.height===t||(r.width=e,r.height=t,this.setData(null))}setData(e){if(this._context&&this._context.gl){var t=this._context.gl;this._glName||(this._glName=t.createTexture()),void 0===e&&(e=null),null===e&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var r=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var i=this._descriptor;o._validateTexture(this._context,i),t.pixelStorei(t.UNPACK_ALIGNMENT,i.unpackAlignment),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i.flipped?1:0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.preMultiplyAlpha?1:0);var a=i.pixelFormat,s=i.internalFormat?i.internalFormat:a;if(e instanceof ImageData||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){var c=e.width,l=e.height;e instanceof HTMLVideoElement&&(c=e.videoWidth,l=e.videoHeight),i.width&&i.height&&console.assert(c===i.width&&l===i.height),t.texImage2D(t.TEXTURE_2D,0,s,a,i.dataType,e),i.hasMipmap&&this.generateMipmap(),void 0===i.width&&(i.width=c),void 0===i.height&&(i.height=l)}else{null!=i.width&&null!=i.height||console.error("Width and height must be specified!"),t.DEPTH24_STENCIL8&&s===t.DEPTH_STENCIL&&(s=t.DEPTH24_STENCIL8);var u=i.width,d=i.height;if(function(e){return Object(n.k)(e)&&"type"in e&&"compressed"===e.type}(e)){var h=Math.round(Math.log(Math.max(u,d))/Math.LN2)+1;i.hasMipmap=i.hasMipmap&&h===e.levels.length;for(var p=0;;++p){var f=e.levels[Math.min(p,e.levels.length-1)];if(t.compressedTexImage2D(t.TEXTURE_2D,p,s,u,d,0,f),1===u&&1===d||!i.hasMipmap)break;u=Math.max(1,u>>1),d=Math.max(1,d>>1)}}else if(Object(n.k)(e))t.texImage2D(t.TEXTURE_2D,0,s,u,d,0,a,i.dataType,e),i.hasMipmap&&this.generateMipmap();else for(var b=0;t.texImage2D(t.TEXTURE_2D,b,s,u,d,0,a,i.dataType,null),(1!==u||1!==d)&&i.hasMipmap;++b)u=Math.max(1,u>>1),d=Math.max(1,d>>1)}o._applySamplingMode(t,this._descriptor),o._applyWrapMode(t,this._descriptor),o._applyAnisotropicFilteringParameters(this._context,this._descriptor),r&&this._context.bindTexture(r,0)}}updateData(e,t,r,i,n,a){a||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");var s=this._context.gl,o=this._descriptor,c=this._context.getBoundTexture(0);this._context.bindTexture(this,0),(t<0||r<0||i>o.width||n>o.height||t+i>o.width||r+n>o.height)&&console.error("An attempt to update out of bounds of the texture!"),s.pixelStorei(s.UNPACK_ALIGNMENT,o.unpackAlignment),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,o.flipped?1:0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.preMultiplyAlpha?1:0),a instanceof ImageData||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement?s.texSubImage2D(s.TEXTURE_2D,e,t,r,o.pixelFormat,o.dataType,a):s.texSubImage2D(s.TEXTURE_2D,e,t,r,i,n,o.pixelFormat,o.dataType,a),this._context.bindTexture(c,0)}generateMipmap(){var e=this._descriptor;e.hasMipmap||(e.hasMipmap=!0,this._samplingModeDirty=!0,o._validateTexture(this._context,e)),9729===e.samplingMode?(this._samplingModeDirty=!0,e.samplingMode=9985):9728===e.samplingMode&&(this._samplingModeDirty=!0,e.samplingMode=9984);var t=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var r=this._context.gl;r.generateMipmap(r.TEXTURE_2D),this._context.bindTexture(t,0)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,o._validateTexture(this._context,this._descriptor),this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,o._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}applyChanges(){var e=this._context.gl,t=this._descriptor;this._samplingModeDirty&&(o._applySamplingMode(e,t),this._samplingModeDirty=!1),this._wrapModeDirty&&(o._applyWrapMode(e,t),this._wrapModeDirty=!1)}static _validateTexture(e,t){(t.width<0||t.height<0)&&console.error("Negative dimension parameters are not allowed!");var r=Object(a.k)(t.width)&&Object(a.k)(t.height);Object(s.a)(e.gl)||r||("number"==typeof t.wrapMode?33071!==t.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===t.wrapMode.s&&33071===t.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}static _applySamplingMode(e,t){var r=t.samplingMode,i=t.samplingMode;9985===r||9987===r?(r=9729,t.hasMipmap||(i=9729)):9984!==r&&9986!==r||(r=9728,t.hasMipmap||(i=9728)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i)}static _applyWrapMode(e,t){"number"==typeof t.wrapMode?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.wrapMode.t))}static _applyAnisotropicFilteringParameters(e,t){if(null!=t.maxAnisotropy){var r=e.capabilities.textureFilterAnisotropic;if(r){var i=e.gl;i.texParameterf(i.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY,t.maxAnisotropy)}}}}t.a=o},,function(e,t,r){"use strict";function i(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function n(e){return e.toLowerCase().trim()}t.a=class{constructor(e){if(this.fields=e,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],e){var t=[];for(var r of e){var a=r&&r.name;if(a){var s=n(a);this._fieldsMap.set(a,r),this._fieldsMap.set(s,r),t.push(s),i(r)&&(this.dateFields.push(r),this._dateFieldsSet.add(r))}}t.sort(),this.uid=t.join(",")}}destroy(){this._fieldsMap.clear()}has(e){return null!=this.get(e)}get(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(n(e)):void 0}isDateField(e){return this._dateFieldsSet.has(this.get(e))}normalizeFieldName(e){var t=this.get(e);if(t)return t.name}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));var i=r(133),n=Object(i.b)((function(e){var t;void 0!==(t=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"])&&(e.exports=t)})),a=Object(i.b)((function(e){var t;void 0!==(t=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"])&&(e.exports=t)})),s=Object(i.b)((function(e){var t;void 0!==(t=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"])&&(e.exports=t)}))},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var i=r(89),n=r(112),a=r(117);function s(e,t,r){if(Object(i.j)(t)||Object(i.j)(r)||r.vcsWkid||Object(n.c)(t,r))return null;var s=Object(a.g)(t)/Object(a.g)(r);if(1===s)return null;switch(e){case"point":case"esriGeometryPoint":return e=>function(e,t){e&&null!=e.z&&(e.z*=t)}(e,s);case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(var r of e.paths)for(var i of r)i.length>2&&(i[2]*=t)}(e,s);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(var r of e.rings)for(var i of r)i.length>2&&(i[2]*=t)}(e,s);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(var r of e.points)r.length>2&&(r[2]*=t)}(e,s);default:return null}}function o(e,t,r){if(null==e.hasM||e.hasZ)for(var i of t)for(var n of i)n.length>2&&(n[2]*=r)}function c(e,t,r){if((e||t)&&r){var i=Object(a.g)(r);l(e,r,i),l(t,r,i)}}function l(e,t,r){if(e)for(var i of e)u(i.geometry,t,r)}function u(e,t,r){if(e&&e.spatialReference&&!Object(n.c)(e.spatialReference,t)){var i=Object(a.g)(e.spatialReference)/r;if(1!==i)if("x"in e)null!=e.z&&(e.z*=i);else if("rings"in e)o(e,e.rings,i);else if("paths"in e)o(e,e.paths,i);else if("points"in e&&(null==e.hasM||e.hasZ))for(var s of e.points)s.length>2&&(s[2]*=i)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var i=r(176);class n{constructor(e,t,r){this._namespace=e,this._storage=t,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",r&&(this._storage.registerRemoveFunc(this._namespace,r),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(e,t,r,i=0){this._storage.put(this._namespace+e,t,r,i)}get(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}pop(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class a{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new i.a,this._users=new i.a}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}put(e,t,r,i){var n=this._db.get(e);if(n&&(this._size-=n.size,this._db.delete(e),n.entry!==t&&this._notifyRemoved(e,n.entry)),r>this._maxSize)this._notifyRemoved(e,t);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var a=1+Math.max(i,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:a,lives:a}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}updateSize(e,t,r){var i=this._db.get(e);if(i&&i.entry===t){if(this._size-=i.size,r>this._maxSize)return this._db.delete(e),void this._notifyRemoved(e,t);i.size=r,this._size+=r,this._checkSizeLimit()}}pop(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}get(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}getStats(){var e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach(((e,i)=>{var n=e.lifetime;r[n]=(r[n]||0)+e.size,this._users.forAll((r=>{var n=r.namespace;if(i.startsWith(n)){var a=t[n]||0;t[n]=a+e.size}}))}));var i={};this._users.forAll((e=>{var r=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var n=t[r]||0;t[r]=n,i[r]=Math.round(100*e.hitRate)+"%"}else i[r]="0%"}));var n=Object.keys(t);n.forEach((e=>t[e]=t[e]/this._size*100)),n.sort(((e,r)=>t[r]-t[e])),n.forEach((r=>e[r]=Math.round(t[r])+"% / "+i[r]));for(var a=r.length-1;a>=0;--a){var s=r[a];s&&(e["Priority "+(a+-3-1)]=Math.round(s/this.size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){this._db.forEach(((t,r)=>{r.startsWith(e)&&(this._size-=t.size,this._db.delete(r),this._notifyRemoved(r,t.entry))}))}clearAll(){this._db.forEach(((e,t)=>this._notifyRemoved(t,e.entry))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(e,t){this._removeFuncs.forAll((r=>{e.startsWith(r[0])&&r[1](t)}))}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(var[e,t]of this._db)if(this._db.delete(e),t.lives<=1?(this._size-=t.size,this._notifyRemoved(e,t.entry)):(--t.lives,this._db.set(e,t)),this._size<=.9*this.maxSize)return}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var i=r(128),n=r(229),a=r(231),s=r(197),o=r(199),c=r(198),l=r(194),u={key:"type",base:i.a,typeMap:{heatmap:c.a,simple:l.a,"unique-value":a.a,"class-breaks":n.a,"dot-density":o.a,dictionary:s.default},errorContext:"renderer"},d={key:"type",base:i.a,typeMap:{simple:l.a,"unique-value":a.a,"class-breaks":n.a},errorContext:"renderer"}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),e=>{var t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return Object(i.a)([Object(n.b)({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{default:"normal",read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),Object(i.a)([Object(n.b)()],t.prototype,"effect",void 0),t=Object(i.a)([Object(a.a)("esri.layers.mixins.BlendLayer")],t)})},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(90)),o=class extends s.a{constructor(){super(...arguments),this.type=null}};Object(i.a)([Object(n.b)({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],o.prototype,"type",void 0);var c=o=Object(i.a)([Object(a.a)("esri.layers.support.FeatureReduction")],o);t.a=c},,,,,,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(81),r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(90)),c=r(140),l=i=class extends o.a{constructor(e){super(e),this.value=0,this.unit="milliseconds"}toMilliseconds(){return this.value*c.b[this.unit]}clone(){return new i({value:this.value,unit:this.unit})}};Object(n.a)([Object(a.b)({type:Number,json:{write:!0},nonNullable:!0})],l.prototype,"value",void 0),Object(n.a)([Object(a.b)({type:c.d.apiValues,json:{type:c.d.jsonValues,read:c.d.read,write:c.d.write},nonNullable:!0})],l.prototype,"unit",void 0);var u=l=i=Object(n.a)([Object(s.a)("esri.TimeInterval")],l);t.a=u},,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88)),o=r(85),c=r(84),l=r(96),u=(r(83),r(86),r(87),r(90)),d=r(99),h=(r(101),r(170)),p=i=class extends u.a{constructor(e){super(e),this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}clone(){return new i(Object(a.a)({dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};Object(n.a)([Object(o.b)({type:h.a,json:{write:!0}})],p.prototype,"dynamicDataSource",void 0),Object(n.a)([Object(o.b)({type:String,json:{write:!0}})],p.prototype,"gdbVersion",void 0),Object(n.a)([Object(o.b)({type:Number,json:{write:!0}})],p.prototype,"geometryPrecision",void 0),Object(n.a)([Object(o.b)({type:Date})],p.prototype,"historicMoment",void 0),Object(n.a)([Object(l.a)("historicMoment")],p.prototype,"_writeHistoricMoment",null),Object(n.a)([Object(o.b)({type:Number,json:{write:!0}})],p.prototype,"maxAllowableOffset",void 0),Object(n.a)([Object(o.b)({type:[Number],json:{write:!0}})],p.prototype,"objectIds",void 0),Object(n.a)([Object(o.b)({type:[String],json:{write:!0}})],p.prototype,"orderByFields",void 0),Object(n.a)([Object(o.b)({type:[String],json:{write:!0}})],p.prototype,"outFields",void 0),Object(n.a)([Object(o.b)({type:d.a,json:{read:{source:"outSR"},write:{target:"outSR"}}})],p.prototype,"outSpatialReference",void 0),Object(n.a)([Object(o.b)({json:{write:!0}})],p.prototype,"relationshipId",void 0),Object(n.a)([Object(o.b)({type:Number,json:{read:{source:"resultOffset"}}})],p.prototype,"start",void 0),Object(n.a)([Object(l.a)("start"),Object(l.a)("num")],p.prototype,"writeStart",null),Object(n.a)([Object(o.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],p.prototype,"num",void 0),Object(n.a)([Object(o.b)({json:{write:!0}})],p.prototype,"returnGeometry",void 0),Object(n.a)([Object(o.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],p.prototype,"returnM",void 0),Object(n.a)([Object(o.b)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],p.prototype,"returnZ",void 0),Object(n.a)([Object(o.b)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],p.prototype,"where",void 0),(p=i=Object(n.a)([Object(c.a)("esri.tasks.support.RelationshipQuery")],p)).from=Object(s.m)(p);var f=p;t.a=f},,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return d}));var i=r(143),n="__begin__",a="__end__",s=new RegExp(n,"ig"),o=new RegExp(a,"ig"),c=new RegExp("^"+n,"i"),l=new RegExp(a+"$","i"),u='"';function d(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function h(e){var t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function p(e){var t=h(e);if(!t)return null;switch(t.type){case"conventional":return b(t.expression);case"arcade":return t.expression}return null}function f(e){var t=h(e);if(!t)return null;switch(t.type){case"conventional":return function(e){var t=e.match(m);return t&&t[1].trim()||null}(t.expression);case"arcade":return O(t.expression)}return null}function b(e){var t;return e?(t=Object(i.c)(e,(e=>n+'$feature["'+e+'"]'+a)),t=c.test(t)?t.replace(c,""):u+t,t=(t=l.test(t)?t.replace(l,""):t+u).replace(s,'" + ').replace(o,' + "')):t='""',t}var m=/^\s*\{([^}]+)\}\s*$/i;var v=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,g=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,y=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function O(e){if(!e)return null;var t=v.exec(e)||g.exec(e);return t?t[1]||t[3]:(t=y.exec(e))?t[2]:null}},,,function(e,t,r){"use strict";function i(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function n(e){return null!=e&&!isNaN(e)&&isFinite(e)}function a(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function s(e,t){var r=t||a(e),i=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===i?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return n}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return p}));r(80);var i=r(89),n=r(220),a=r(211),s=r(291),o=r(345),c=r(282),l=s.a.fromJSON(c.a),u=n.a.fromJSON(c.c),d=a.a.fromJSON(c.b),h=o.a.fromJSON(c.d);function p(e){if(Object(i.j)(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return l;case"polyline":return u;case"polygon":case"extent":return d}return null}var f=s.a.fromJSON(c.e),b=n.a.fromJSON(c.g),m=a.a.fromJSON(c.f)},function(e,t,r){"use strict";var i=r(213);t.a=class{constructor(e,t){this._storage=new i.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t,r){this._storage.put(e,t,r,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return E})),r.d(t,"b",(function(){return C})),r.d(t,"c",(function(){return x}));var i=r(7),n=r(159),a=r(89),s=r(81),o=r(93),c=r(112),l=r(161),u=r(130),d=r(141),h=r(243),p=r(91),f=r(83),b=r(100),m=(r(101),r(106));function v(e,t,r,i){return g.apply(this,arguments)}function g(){return(g=Object(i.a)((function*(e,t,r,i){var n="string"==typeof e?Object(f.J)(e):e,a=t[0].spatialReference,s=Object(p.a)(Object(p.a)({},i),{},{query:Object(p.a)(Object(p.a)({},n.query),{},{f:"json",sr:JSON.stringify(a),target:JSON.stringify({geometryType:Object(b.c)(t[0]),geometries:t}),cutter:JSON.stringify(r)})}),o=yield Object(m.default)(n.path+"/cut",s),{cutIndexes:c,geometries:l=[]}=o.data;return{cutIndexes:c,geometries:l.map((e=>{var t=Object(b.a)(e);return t.spatialReference=a,t}))}}))).apply(this,arguments)}function y(e,t,r){return O.apply(this,arguments)}function O(){return(O=Object(i.a)((function*(e,t,r){var i="string"==typeof e?Object(f.J)(e):e,n=t[0].spatialReference,a=Object(b.c)(t[0]),s=Object(p.a)(Object(p.a)({},r),{},{query:Object(p.a)(Object(p.a)({},i.query),{},{f:"json",sr:n.wkid?n.wkid:JSON.stringify(n),geometries:JSON.stringify(j(t))})});return _((yield Object(m.default)(i.path+"/simplify",s)).data,a,n)}))).apply(this,arguments)}function j(e){return{geometryType:Object(b.c)(e[0]),geometries:e.map((e=>e.toJSON()))}}function _(e,t,r){var i=Object(b.b)(t);return e.map((e=>{var t=i.fromJSON(e);return t.spatialReference=r,t}))}var w=s.a.getLogger("esri.geometry.support.normalizeUtils");function x(e,t){if(!(e instanceof d.a||e instanceof u.a)){var r="straightLineDensify: the input geometry is neither polyline nor polygon";throw w.error(r),new o.a(r)}var i=Object(h.b)(e),n=[];for(var a of i){var s=[];n.push(s),s.push([a[0][0],a[0][1]]);for(var c=0;c<a.length-1;c++){var l=a[c][0],p=a[c][1],f=a[c+1][0],b=a[c+1][1],m=Math.sqrt((f-l)*(f-l)+(b-p)*(b-p)),v=(b-p)/m,g=(f-l)/m,y=m/t;if(y>1){for(var O=1;O<=y-1;O++){var j=O*t,_=g*j+l,x=v*j+p;s.push([_,x])}var S=(m+Math.floor(y-1)*t)/2,M=g*S+l,T=v*S+p;s.push([M,T])}s.push([f,b])}}return function(e){return"polygon"===e.type}(e)?new u.a({rings:n,spatialReference:e.spatialReference}):new d.a({paths:n,spatialReference:e.spatialReference})}function S(e,t,r){if(t){var i=x(e,1e6);e=Object(l.e)(i,!0)}return r&&(e=Object(h.e)(e,r)),e}function M(e,t,r){if(Array.isArray(e)){var i=e[0];if(i>t){var n=Object(h.d)(i,t);e[0]=i+n*(-2*t)}else if(i<r){var a=Object(h.d)(i,r);e[0]=i+a*(-2*r)}}else{var s=e.x;if(s>t){var o=Object(h.d)(s,t);e=e.clone().offset(o*(-2*t),0)}else if(s<r){var c=Object(h.d)(s,r);e=e.clone().offset(c*(-2*r),0)}}return e}function T(e,t){for(var r=-1,i=function(i){for(var n=t.cutIndexes[i],a=t.geometries[i],s=Object(h.b)(a),o=function(e){var t=s[e];t.some((r=>{if(r[0]<180)return!0;for(var i=0,n=0;n<t.length;n++){var s=t[n][0];i=s>i?s:i}i=Number(i.toFixed(9));for(var o=-360*Object(h.d)(i,180),c=0;c<t.length;c++){var l=a.getPoint(e,c);a.setPoint(e,c,l.clone().offset(o,0))}return!0}))},c=0;c<s.length;c++)o(c);if(n===r){if(function(e){return"polygon"===e[0].type}(e))for(var l of Object(h.b)(a))e[n]=e[n].addRing(l);else if(function(e){return"polyline"===e[0].type}(e))for(var u of Object(h.b)(a))e[n]=e[n].addPath(u)}else r=n,e[n]=a},n=0;n<t.cutIndexes.length;n++)i(n);return e}function E(e,t,r){return P.apply(this,arguments)}function P(){return(P=Object(i.a)((function*(e,t,r){if(!Array.isArray(e))return E([e],t);var i,s,o,p,f,b,m,g,O=t?t.url:n.a.geometryServiceUrl,j=0,_=[],w=[];for(var x of e)if(Object(a.j)(x))w.push(x);else if(i||(i=x.spatialReference,s=Object(c.d)(i),b=(o=i.isWebMercator)?102100:4326,p=h.a[b].maxX,f=h.a[b].minX,m=h.a[b].plus180Line,g=h.a[b].minus180Line),s)if("mesh"===x.type)w.push(x);else if("point"===x.type)w.push(M(x.clone(),p,f));else if("multipoint"===x.type){var P=x.clone();P.points=P.points.map((e=>M(e,p,f))),w.push(P)}else if("extent"===x.type){var C=x.clone()._normalize(!1,!1,s);w.push(C.rings?new u.a(C):C)}else if(x.extent){var I=x.extent,A=Object(h.d)(I.xmin,f)*(2*p),R=0===A?x.clone():Object(h.e)(x.clone(),A);I.offset(A,0),I.intersects(m)&&I.xmax!==p?(j=I.xmax>j?I.xmax:j,R=S(R,o),_.push(R),w.push("cut")):I.intersects(g)&&I.xmin!==f?(j=I.xmax*(2*p)>j?I.xmax*(2*p):j,R=S(R,o,360),_.push(R),w.push("cut")):w.push(R)}else w.push(x.clone());else w.push(x);for(var F=Object(h.d)(j,p),L=-90,D=F,k=new d.a;F>0;){var z=360*F-180;k.addPath([[z,L],[z,-1*L]]),L*=-1,F--}if(_.length>0&&D>0){for(var V=T(_,yield v(O,_,k,r)),N=[],U=[],B=0;B<w.length;B++){var q=w[B];if("cut"!==q)U.push(q);else{var G=V.shift(),H=e[B];Object(a.k)(H)&&"polygon"===H.type&&H.rings&&H.rings.length>1&&G.rings.length>=H.rings.length?(N.push(G),U.push("simplify")):U.push(o?Object(l.b)(G):G)}}if(!N.length)return U;for(var W=yield y(O,N,r),J=[],Z=0;Z<U.length;Z++){var X=U[Z];"simplify"!==X?J.push(X):J.push(o?Object(l.b)(W.shift()):W.shift())}return J}for(var Y=[],Q=0;Q<w.length;Q++){var K=w[Q];if("cut"!==K)Y.push(K);else{var $=_.shift();Y.push(!0===o?Object(l.b)($):$)}}return Promise.resolve(Y)}))).apply(this,arguments)}function C(e,t){var r=Object(c.d)(t);if(r){var[i,n]=r.valid,a=n-i;if(e<i)for(;e<i;)e+=a;if(e>n)for(;e>n;)e-=a}return e}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=new(r(95).a)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88),r(85)),o=r(98),c=r(84),l=r(96),u=(r(83),r(86),r(87),r(90)),d=r(140),h=r(150),p=r(222),f=i=class extends u.a{constructor(e){super(e),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}clone(){var{respectsDaylightSaving:e,timezone:t}=this;return new i({respectsDaylightSaving:e,timezone:t})}};Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],f.prototype,"respectsDaylightSaving",void 0),Object(n.a)([Object(o.a)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],f.prototype,"readRespectsDaylightSaving",null),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],f.prototype,"timezone",void 0);var b,m=f=i=Object(n.a)([Object(c.a)("esri.layers.support.TimeReference")],f),v=b=class extends u.a{constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=new Date(t.timeExtent[0]),i=new Date(t.timeExtent[1]);return new h.a({start:r,end:i})}writeFullTimeExtent(e,t){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?new p.a({value:t.timeInterval,unit:d.d.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new p.a({value:t.defaultTimeInterval,unit:d.d.fromJSON(t.defaultTimeIntervalUnits)}):null}writeInterval(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null}clone(){var{cumulative:e,endField:t,hasLiveData:r,interval:i,startField:n,timeReference:s,fullTimeExtent:o,trackIdField:c,useTime:l}=this;return new b({cumulative:e,endField:t,hasLiveData:r,interval:i,startField:n,timeReference:Object(a.a)(s),fullTimeExtent:Object(a.a)(o),trackIdField:c,useTime:l})}};Object(n.a)([Object(s.b)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],v.prototype,"cumulative",void 0),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],v.prototype,"endField",void 0),Object(n.a)([Object(s.b)({type:h.a,json:{write:{enabled:!0,allowNull:!0}}})],v.prototype,"fullTimeExtent",void 0),Object(n.a)([Object(o.a)("fullTimeExtent",["timeExtent"])],v.prototype,"readFullTimeExtent",null),Object(n.a)([Object(l.a)("fullTimeExtent")],v.prototype,"writeFullTimeExtent",null),Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],v.prototype,"hasLiveData",void 0),Object(n.a)([Object(s.b)({type:p.a,json:{write:{enabled:!0,allowNull:!0}}})],v.prototype,"interval",void 0),Object(n.a)([Object(o.a)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],v.prototype,"readInterval",null),Object(n.a)([Object(l.a)("interval")],v.prototype,"writeInterval",null),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],v.prototype,"startField",void 0),Object(n.a)([Object(s.b)({type:m,json:{write:{enabled:!0,allowNull:!0}}})],v.prototype,"timeReference",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],v.prototype,"trackIdField",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],v.prototype,"useTime",void 0);var g=v=b=Object(n.a)([Object(c.a)("esri.layers.support.TimeInfo")],v);t.a=g},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return v})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return g}));var i=r(89),n=r(83),a=r(258),s=["MapServer","ImageServer","FeatureServer","SceneServer","StreamServer","VectorTileServer"],o=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(".concat(s.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),c=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(".concat(s.join("|"),"))(?:\\/(?:layers\\/)?(\\d+))?"),"i"),l=/(.*)\/(\d+)\/?$/i;function u(e){return!!o.test(e)}function d(e){var t=Object(n.J)(e),r=t.path.match(o)||t.path.match(c);if(!r)return null;var[,i,a,s,l]=r,u=a.indexOf("/");return{title:p(-1!==u?a.slice(u+1):a),serverType:s,sublayer:null!=l&&""!==l?parseInt(l,10):null,url:{path:i}}}function h(e){var t=Object(n.J)(e).path.match(l);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function p(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function f(e,t){var r=[];if(e){var n=d(e);Object(i.k)(n)&&n.title&&r.push(n.title)}if(t){var a=p(t);r.push(a)}if(2===r.length){if(-1!==r[0].toLowerCase().indexOf(r[1].toLowerCase()))return r[0];if(-1!==r[1].toLowerCase().indexOf(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function b(e){if(!e)return!1;var t=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),r=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return t&&r}function m(e,t){return e?Object(n.H)(Object(n.G)(e,t)):e}function v(e){var{url:t}=e;if(!t)return{url:t};t=Object(n.G)(t,e.logger);var r,a=Object(n.J)(t),s=d(a.path);if(Object(i.k)(s))null!=s.sublayer&&null==e.layer.layerId&&(r=s.sublayer),t=s.url.path;else if(e.nonStandardUrlAllowed){var o=h(a.path);Object(i.k)(o)&&(t=o.serviceUrl,r=o.sublayerId)}return{url:Object(n.H)(t),layerId:r}}function g(e,t,r,i,s){Object(a.f)(t,i,"url",s),i.url&&null!=e.layerId&&(i.url=Object(n.y)(i.url,r,e.layerId.toString()))}function y(e){if(!e)return!1;var t=e.toLowerCase(),r=-1!==t.indexOf("/services/"),i=-1!==t.indexOf("/mapserver/wmsserver"),n=-1!==t.indexOf("/imageserver/wmsserver"),a=-1!==t.indexOf("/wmsserver");return r&&(i||n||a)}function O(e){if(!e)return!1;var t=new n.a(Object(n.z)(e)).authority.toLowerCase();return"server.arcgisonline.com"===t||"services.arcgisonline.com"===t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return c}));var i=r(99),n=r(141),a=r(100),s={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new n.a({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator}),minus180Line:new n.a({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.a.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new n.a({paths:[[[180,-180],[180,180]]],spatialReference:i.a.WGS84}),minus180Line:new n.a({paths:[[[-180,-180],[-180,180]]],spatialReference:i.a.WGS84})}};function o(e,t){return Math.ceil((e-t)/(2*t))}function c(e,t){var r=l(e);for(var i of r)for(var n of i)n[0]+=t;return e}function l(e){return Object(a.g)(e)?e.rings:e.paths}function u(e){var t=(null==e?void 0:e.isWebMercator)?102100:4326;return[s[t].minX,s[t].maxX]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return c}));r(80);var i=r(124),n=r(175),a=r(188),s=r(93),o=r(214);function c(e,t,r,n){var a=function(e,t){return e?function(e,t){if(!t||"web-scene"!==t.origin)return!0;switch(e.type){case"simple":case"unique-value":case"class-breaks":return!0;case"heatmap":case"dictionary":case"dot-density":default:return!1}}(e,t)?e.write({},t):(t.messages&&t.messages.push(new s.a("renderer:unsupported","Renderer of type '".concat(e.declaredClass,"' are not supported in scenes."),{renderer:e,context:t})),null):null}(e,n);a&&Object(i.c)(r,a,t)}function l(e,t){return d(e,null,t)}var u=Object(a.b)({types:o.a});function d(e,t,r){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(r&&r.messages&&r.messages.push(new n.a("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null):u(e,t,r):null}},,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88),r(85)),o=r(95),c=r(84),l=r(96),u=(r(83),r(86),r(87),r(90)),d=new o.a({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"}),h=i=class extends u.a{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(t.statisticParameters=Object(a.a)(e))}clone(){return new i({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:Object(a.a)(this.statisticParameters)})}};Object(n.a)([Object(s.b)({type:Number,json:{write:!0}})],h.prototype,"maxPointCount",void 0),Object(n.a)([Object(s.b)({type:Number,json:{write:!0}})],h.prototype,"maxRecordCount",void 0),Object(n.a)([Object(s.b)({type:Number,json:{write:!0}})],h.prototype,"maxVertexCount",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],h.prototype,"onStatisticField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],h.prototype,"outStatisticFieldName",void 0),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"statisticType",reader:d.read},write:{target:"statisticType",writer:d.write}}})],h.prototype,"statisticType",void 0),Object(n.a)([Object(s.b)({type:Object})],h.prototype,"statisticParameters",void 0),Object(n.a)([Object(l.a)("statisticParameters")],h.prototype,"writeStatisticParameters",null);var p=h=i=Object(n.a)([Object(c.a)("esri.tasks.support.StatisticDefinition")],h);t.a=p},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var i,n,a,s,o,c,l=r(120),u=r(89),d=r(104),h=r(111),p=r(119);function f(e,t){if(t.slicePlaneEnabled){e.extensions.add("GL_OES_standard_derivatives"),t.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add("slicePlaneOrigin","vec3"),e.vertex.uniforms.add("slicePlaneBasis1","vec3"),e.vertex.uniforms.add("slicePlaneBasis2","vec3")),e.fragment.uniforms.add("slicePlaneOrigin","vec3"),e.fragment.uniforms.add("slicePlaneBasis1","vec3"),e.fragment.uniforms.add("slicePlaneBasis2","vec3");var r=Object(p.a)(i||(i=Object(l.a)(["\n      struct SliceFactors {\n        float front;\n        float side0;\n        float side1;\n        float side2;\n        float side3;\n      };\n\n      SliceFactors calculateSliceFactors(vec3 pos) {\n        vec3 rel = pos - slicePlaneOrigin;\n\n        vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\n        float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\n\n        float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\n        float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\n\n        float basis1Dot = dot(slicePlaneBasis1, rel);\n        float basis2Dot = dot(slicePlaneBasis2, rel);\n\n        return SliceFactors(\n          dot(slicePlaneNormal, pos) + slicePlaneW,\n          -basis1Dot - basis1Len2,\n          basis1Dot - basis1Len2,\n          -basis2Dot - basis2Len2,\n          basis2Dot - basis2Len2\n        );\n      }\n\n      bool sliceByFactors(SliceFactors factors) {\n        return factors.front < 0.0\n          && factors.side0 < 0.0\n          && factors.side1 < 0.0\n          && factors.side2 < 0.0\n          && factors.side3 < 0.0;\n      }\n\n      bool sliceEnabled() {\n        // a slicePlaneBasis1 vector of zero length is used to disable slicing in the shader during draped rendering.\n        return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n      }\n\n      bool sliceByPlane(vec3 pos) {\n        return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n      }\n\n      #define rejectBySlice(_pos_) sliceByPlane(_pos_)\n      #define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }\n    "]))),c=Object(p.a)(n||(n=Object(l.a)(["\n      vec4 applySliceHighlight(vec4 color, vec3 pos) {\n        SliceFactors factors = calculateSliceFactors(pos);\n\n        if (sliceByFactors(factors)) {\n          return color;\n        }\n\n        const float HIGHLIGHT_WIDTH = 1.0;\n        const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\n\n        factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\n        factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\n        factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\n        factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\n        factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\n\n        float highlightFactor = (1.0 - step(0.5, factors.front))\n          * (1.0 - step(0.5, factors.side0))\n          * (1.0 - step(0.5, factors.side1))\n          * (1.0 - step(0.5, factors.side2))\n          * (1.0 - step(0.5, factors.side3));\n\n        return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n      }\n    "]))),u=t.sliceHighlightDisabled?Object(p.a)(a||(a=Object(l.a)(["#define highlightSlice(_color_, _pos_) (_color_)"]))):Object(p.a)(s||(s=Object(l.a)(["\n        ","\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),c);t.sliceEnabledForVertexPrograms&&e.vertex.code.add(r),e.fragment.code.add(r),e.fragment.code.add(u)}else{var d=Object(p.a)(o||(o=Object(l.a)(["\n      #define rejectBySlice(_pos_) false\n      #define discardBySlice(_pos_) {}\n      #define highlightSlice(_color_, _pos_) (_color_)\n    "])));t.sliceEnabledForVertexPrograms&&e.vertex.code.add(d),e.fragment.code.add(d)}}(c=f||(f={})).bindUniformsWithOrigin=function(e,t,r){c.bindUniforms(e,t,r.slicePlane,r.origin)},c.bindUniforms=function(e,t,r,i){t.slicePlaneEnabled&&(Object(u.k)(r)?(i?(Object(h.i)(b,r.origin,i),e.setUniform3fv("slicePlaneOrigin",b)):e.setUniform3fv("slicePlaneOrigin",r.origin),e.setUniform3fv("slicePlaneBasis1",r.basis1),e.setUniform3fv("slicePlaneBasis2",r.basis2)):(e.setUniform3fv("slicePlaneBasis1",d.b),e.setUniform3fv("slicePlaneBasis2",d.b),e.setUniform3fv("slicePlaneOrigin",d.b)))};var b=Object(d.e)()},function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88),r(85)),o=r(95),c=r(84),l=(r(83),r(86),r(87),r(90)),u=r(103),d=(r(101),new o.a({upperLeft:"upper-left",lowerLeft:"lower-left"})),h=i=class extends l.a{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new i(Object(a.a)({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};Object(n.a)([Object(s.b)({type:u.a,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],h.prototype,"extent",void 0),Object(n.a)([Object(s.b)({type:["view","edit"],json:{write:!0}})],h.prototype,"mode",void 0),Object(n.a)([Object(s.b)({type:String,json:{read:d.read,write:d.write}})],h.prototype,"originPosition",void 0),Object(n.a)([Object(s.b)({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],h.prototype,"tolerance",void 0);var p=h=i=Object(n.a)([Object(c.a)("esri.tasks.support.QuantizationParameters")],h);t.a=p},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(92)),a=(r(81),r(88),r(85)),s=r(95),o=r(84),c=r(96),l=(r(83),r(86),r(87),r(90)),u=new s.a({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),d=class extends l.a{constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}writeDrawingTool(e,t){t.drawingTool=u.toJSON(e)}writePrototype(e,t){t.prototype=Object(n.c)(Object(n.a)(e),!0)}writeThumbnail(e,t){t.thumbnail=Object(n.c)(Object(n.a)(e))}};Object(i.a)([Object(a.b)({json:{write:!0}})],d.prototype,"name",void 0),Object(i.a)([Object(a.b)({json:{write:!0}})],d.prototype,"description",void 0),Object(i.a)([Object(a.b)({json:{read:u.read,write:u.write}})],d.prototype,"drawingTool",void 0),Object(i.a)([Object(c.a)("drawingTool")],d.prototype,"writeDrawingTool",null),Object(i.a)([Object(a.b)({json:{write:!0}})],d.prototype,"prototype",void 0),Object(i.a)([Object(c.a)("prototype")],d.prototype,"writePrototype",null),Object(i.a)([Object(a.b)({json:{write:!0}})],d.prototype,"thumbnail",void 0),Object(i.a)([Object(c.a)("thumbnail")],d.prototype,"writeThumbnail",null);var h=d=Object(i.a)([Object(o.a)("esri.layers.support.FeatureTemplate")],d);t.a=h},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(81).a.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class n{constructor(){this.includedModules=new Map}include(e,t){this.includedModules.has(e)?this.includedModules.get(e)!==t&&i.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(e,t),e(this.builder,t))}}class a extends n{constructor(){super(...arguments),this.vertex=new c,this.fragment=new c,this.attributes=new l,this.varyings=new u,this.extensions=new d,this.constants=new h}get builder(){return this}generateSource(e){var t=this.extensions.generateSource(e),r=this.attributes.generateSource(e),i=this.varyings.generateSource(),n="vertex"===e?this.vertex:this.fragment,a=n.uniforms.generateSource(),s=n.code.generateSource(),o="vertex"===e?f:p,c=this.constants.generateSource().concat(n.constants.generateSource());return"\n".concat(t.join("\n"),"\n\n").concat(o,"\n\n").concat(c.join("\n"),"\n\n").concat(a.join("\n"),"\n\n").concat(r.join("\n"),"\n\n").concat(i.join("\n"),"\n\n").concat(s.join("\n"))}}class s{constructor(){this._entries=new Array,this._set=new Set}add(e,t,r){var i="".concat(e,"_").concat(t,"_").concat(r);return this._set.has(i)||(this._entries.push([e,t,r]),this._set.add(i)),this}generateSource(){return this._entries.map((e=>"uniform ".concat(e[1]," ").concat(e[0]).concat((e=>e?"[".concat(e,"]"):"")(e[2]),";")))}}class o{constructor(){this._entries=new Array}add(e){this._entries.push(e)}generateSource(){return this._entries}}class c extends n{constructor(){super(...arguments),this.uniforms=new s,this.code=new o,this.constants=new h}get builder(){return this}}class l{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(e){return"fragment"===e?[]:this._entries.map((e=>"attribute ".concat(e[1]," ").concat(e[0],";")))}}class u{constructor(){this._entries=new Array}add(e,t){this._entries.push([e,t])}generateSource(){return this._entries.map((e=>"varying ".concat(e[1]," ").concat(e[0],";")))}}class d{constructor(){this._entries=new Set}add(e){this._entries.add(e)}generateSource(e){var t="vertex"===e?d.ALLOWLIST_VERTEX:d.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((e=>t.includes(e))).map((e=>"#extension ".concat(e," : enable")))}}d.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],d.ALLOWLIST_VERTEX=[];class h{constructor(){this._entries=[]}add(e,t,r){var i="ERROR_CONSTRUCTOR_STRING";switch(t){case"float":i=h.numberToFloatStr(r);break;case"int":i=h.numberToIntStr(r);break;case"bool":i=r.toString();break;case"vec2":i="vec2(".concat(h.numberToFloatStr(r[0]),",                            ").concat(h.numberToFloatStr(r[1]),")");break;case"vec3":i="vec3(".concat(h.numberToFloatStr(r[0]),",                            ").concat(h.numberToFloatStr(r[1]),",                            ").concat(h.numberToFloatStr(r[2]),")");break;case"vec4":i="vec4(".concat(h.numberToFloatStr(r[0]),",                            ").concat(h.numberToFloatStr(r[1]),",                            ").concat(h.numberToFloatStr(r[2]),",                            ").concat(h.numberToFloatStr(r[3]),")");break;case"ivec2":i="ivec2(".concat(h.numberToIntStr(r[0]),",                             ").concat(h.numberToIntStr(r[1]),")");break;case"ivec3":i="ivec3(".concat(h.numberToIntStr(r[0]),",                             ").concat(h.numberToIntStr(r[1]),",                             ").concat(h.numberToIntStr(r[2]),")");break;case"ivec4":i="ivec4(".concat(h.numberToIntStr(r[0]),",                             ").concat(h.numberToIntStr(r[1]),",                             ").concat(h.numberToIntStr(r[2]),",                             ").concat(h.numberToIntStr(r[3]),")");break;case"bvec2":i="bvec2(".concat(r[0].toString(),",                             ").concat(r[1].toString(),")");break;case"bvec3":i="bvec3(".concat(r[0].toString(),",                             ").concat(r[1].toString(),",                             ").concat(r[2].toString(),")");break;case"bvec4":i="bvec4(".concat(r[0].toString(),",                             ").concat(r[1].toString(),",                             ").concat(r[2].toString(),",                             ").concat(r[3].toString(),")");break;case"mat2":case"mat3":case"mat4":i="".concat(t,"(").concat(Array.prototype.map.call(r,(e=>h.numberToFloatStr(e))).join(", "),")")}return this._entries.push("const ".concat(t," ").concat(e," = ").concat(i,";")),this}static numberToIntStr(e){return e.toFixed(0)}static numberToFloatStr(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}generateSource(){return Array.from(this._entries)}}var p="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",f="precision highp float;\nprecision highp sampler2D;"},function(e,t,r){"use strict";r.d(t,"a",(function(){return C})),r.d(t,"b",(function(){return R})),r.d(t,"c",(function(){return L})),r.d(t,"d",(function(){return I})),r.d(t,"e",(function(){return P})),r.d(t,"f",(function(){return A})),r.d(t,"g",(function(){return F})),r.d(t,"h",(function(){return D}));var i=r(347),n=r(111),a=r(177);function s(e=c){return[e[0],e[1],e[2],e[3]]}function o(e,t,r,i,n=s()){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}var c=[0,0,1,0],l=(Object.freeze({__proto__:null,create:s,wrap:function(e,t,r,i){return o(e,t,r,i,a.e.get())},wrapAxisAngle:function(e,t){return o(e[0],e[1],e[2],t,a.e.get())},copy:function(e,t=s()){return o(e[0],e[1],e[2],e[3],t)},fromValues:o,fromAxisAndAngle:function(e,t,r=s()){return Object(n.j)(r,e),r[3]=t,r},fromPoints:function(e,t,r=s()){return Object(n.f)(r,e,t),Object(n.q)(r,r),r[3]=Object(i.a)(e,t),r},axis:function(e){return e},UP:c}),r(424)),u=r(374),d=r(398),h=r(425),p=r(549),f=r(467),b=r(104),m=r(157),v=r(299),g=r(200),y=r(191);function O(e){return e?[Object(h.c)(e[0]),Object(h.c)(e[1]),Object(h.c)(e[2]),Object(h.c)(e[3]),Object(h.c)(e[4]),Object(h.c)(e[5])]:[Object(h.c)(),Object(h.c)(),Object(h.c)(),Object(h.c)(),Object(h.c)(),Object(h.c)()]}function j(){return[Object(b.e)(),Object(b.e)(),Object(b.e)(),Object(b.e)(),Object(b.e)(),Object(b.e)(),Object(b.e)(),Object(b.e)()]}function _(e,t){Object(h.j)(t[4],t[0],t[3],e[0]),Object(h.j)(t[1],t[5],t[6],e[1]),Object(h.j)(t[4],t[5],t[1],e[2]),Object(h.j)(t[3],t[2],t[6],e[3]),Object(h.j)(t[0],t[1],t[2],e[4]),Object(h.j)(t[5],t[4],t[7],e[5])}function w(e,t){for(var r=0;r<6;r++)if(!Object(h.q)(e[r],t))return!1;return!0}var x=[Object(g.d)(-1,-1,-1,1),Object(g.d)(1,-1,-1,1),Object(g.d)(1,1,-1,1),Object(g.d)(-1,1,-1,1),Object(g.d)(-1,-1,1,1),Object(g.d)(1,-1,1,1),Object(g.d)(1,1,1,1),Object(g.d)(-1,1,1,1)],S=new v.a(f.b),M=j(),T=Object.freeze({__proto__:null,create:O,createPoints:j,copy:function(e,t=O()){for(var r=0;r<6;r++)Object(h.a)(e[r],t[r])},fromMatrix:function(e,t,r,i=M){var s=Object(m.l)(a.a.get(),t,e);Object(m.a)(s,s);for(var o=0;o<8;++o){var c=Object(y.m)(a.e.get(),x[o],s);Object(n.v)(i[o],c[0]/c[3],c[1]/c[3],c[2]/c[3])}_(r,i)},computePlanes:_,intersectsSphere:function(e,t){for(var r=0;r<6;r++)if(Object(h.k)(e[r],t))return!1;return!0},intersectsRay:function(e,t){return w(e,Object(f.e)(t,S.get()))},intersectClipRay:function(e,t){for(var r=0;r<6;r++){var i=e[r];if(!Object(h.l)(i,t))return!1}return!0},intersectsLineSegment:function(e,t,r){return w(e,Object(f.a)(t,r,S.get()))},intersectsPoint:function(e,t){for(var r=0;r<6;r++)if(Object(h.m)(e[r],t)>0)return!1;return!0},intersectsAABB:function(e,t){for(var r=0;r<6;r++)if(Object(h.o)(e[r],t))return!1;return!0},planePointIndices:{bottom:[5,1,0,4],near:[0,1,2,3],far:[5,4,7,6],right:[1,5,6,2],left:[4,0,3,7],top:[7,3,2,6]}}),E=r(505),P=h.h,C=p.a,I=(E.b,l.d),A=u.g,R=f.c,F=d.d,L=T,D=i.d},,,,function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88)),o=r(85),c=r(84),l=r(96),u=(r(83),r(86),r(87),r(90)),d=i=class extends u.a{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new i(Object(a.a)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};Object(n.a)([Object(o.b)({type:[String],json:{write:!0}})],d.prototype,"attachmentTypes",void 0),Object(n.a)([Object(o.b)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],d.prototype,"attachmentsWhere",void 0),Object(n.a)([Object(o.b)({type:[String],json:{write:!0}})],d.prototype,"keywords",void 0),Object(n.a)([Object(o.b)({type:[Number],json:{write:!0}})],d.prototype,"globalIds",void 0),Object(n.a)([Object(o.b)({json:{write:!0}})],d.prototype,"name",void 0),Object(n.a)([Object(o.b)({type:Number,json:{read:{source:"resultRecordCount"}}})],d.prototype,"num",void 0),Object(n.a)([Object(o.b)({type:[Number],json:{write:!0}})],d.prototype,"objectIds",void 0),Object(n.a)([Object(o.b)({type:Boolean,json:{default:!1,write:!0}})],d.prototype,"returnMetadata",void 0),Object(n.a)([Object(o.b)({type:[Number],json:{write:!0}})],d.prototype,"size",void 0),Object(n.a)([Object(o.b)({type:Number,json:{read:{source:"resultOffset"}}})],d.prototype,"start",void 0),Object(n.a)([Object(l.a)("start"),Object(l.a)("num")],d.prototype,"writeStart",null),Object(n.a)([Object(o.b)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],d.prototype,"where",void 0),(d=i=Object(n.a)([Object(c.a)("esri.tasks.support.AttachmentQuery")],d)).from=Object(s.m)(d);var h=d;t.a=h},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),e=>{var t=class extends e{constructor(){super(...arguments),this.refreshInterval=0}refresh(){this.emit("refresh")}};return Object(i.a)([Object(n.b)({type:Number,cast:e=>e>=.1?e:e<=0?0:.1,json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),t=Object(i.a)([Object(a.a)("esri.layers.mixins.RefreshableLayer")],t)})},,function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i,n=r(82),a=(r(80),r(81),r(88)),s=r(85),o=r(102),c=r(84),l=(r(83),r(86),r(87),r(90)),u=i=class extends l.a{constructor(e){super(e),this.type="map-layer"}clone(){var{mapLayerId:e,gdbVersion:t}=this;return new i({mapLayerId:e,gdbVersion:t})}};Object(n.a)([Object(o.a)({mapLayer:"map-layer"})],u.prototype,"type",void 0),Object(n.a)([Object(s.b)({type:a.a,json:{write:!0}})],u.prototype,"mapLayerId",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],u.prototype,"gdbVersion",void 0),u=i=Object(n.a)([Object(c.a)("esri.layers.support.source.MapLayerSource")],u)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r(80);var i=r(81);r(93);function n(e){}i.a.getLogger("esri/views/webgl")},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return c}));var i=r(89),n=r(130),a=r(141),s=(r(101),r(131)),o=r(531);class c{constructor(e){this.left=null,this.right=null,this.type="vertex",this.index=null,this.component=e}get pos(){return this._pos}set pos(e){this._pos=e,this.component.unnormalizeVertexPositions()}}class l{constructor(e,t,r){this.type="edge",this.component=e,this.left=t,this.right=r,t.right=this,r.left=this}}class u{constructor(e){this.vertices=[],this.edges=[],this.data=e}unnormalizeVertexPositions(){this.vertices.length<=1||this.data.coordinateHelper.unnormalize(this.vertices)}updateVertexIndex(e,t){if(0!==this.vertices.length){var r=this.vertices[0],i=null,n=e,a=t;do{(i=n).index=a++,n=i.right?i.right.right:null}while(null!=n&&n!==r);i.left&&i!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(i),this.vertices.length-1)}}getFirstVertex(){return 0===this.vertices.length?null:this.vertices[0]}getLastVertex(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]}swapVertices(e,t){var r=this.vertices[e];this.vertices[e]=this.vertices[t],this.vertices[t]=r}iterateVertices(e){if(0!==this.vertices.length){var t=this.vertices[0],r=t;do{e(r,r.index),r=Object(i.k)(r.right)?r.right.right:null}while(r!==t&&null!=r)}}}class d extends s.a{constructor(e){super(),this.coordinateHelper=e,this.undoStack=[],this.redoStack=[],this.components=[]}apply(e,t=1){0!==t&&!Object(i.j)(this.lastOperation)&&this.lastOperation.accumulate(e)||(e.apply(),this.undoStack.push(e),this.redoStack=[])}undo(){if(this.undoStack.length>0){var e=this.undoStack.pop();return e.undo(),this.redoStack.push(e),e}return null}get canUndo(){return this.undoStack.length>0}get lastOperation(){return this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:null}redo(){if(this.redoStack.length>0){var e=this.redoStack.pop();return e.apply(),this.undoStack.push(e),e}return null}get canRedo(){return this.redoStack.length>0}toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.createPoint(this.components[0].vertices[0].pos)}toPolyline(){var e=[],t=this.coordinateHelper.toArray;return this.components.forEach(((r,i)=>{var n=[],a=r.vertices.find((e=>null==e.left)),s=a;do{n.push(t(a.pos)),a=a.right?a.right.right:null}while(a&&a!==s);e.push(n)})),new a.a({paths:e,spatialReference:this.coordinateHelper.spatialReference})}toPolygon(){var e=[],t=this.coordinateHelper.toArray;return this.components.forEach(((r,n)=>{var a=[],s=r.vertices[0],o=s,c=o;do{a.push(t(o.pos)),o=Object(i.k)(o.right)?o.right.right:null}while(o&&o!==c);a.push(t(s.pos)),e.push(a)})),new n.a({rings:e,spatialReference:this.coordinateHelper.spatialReference})}static fromGeometry(e,t){var r=Object(o.a)(e.hasZ,e.hasM,e.spatialReference,t),i=new d(r);switch(e.type){case"polygon":for(var n=e.rings,a=0;a<n.length;++a){for(var s=n[a],h=new u(i),p=s.length-1,f=0;f<p;++f){var b=r.fromArray(s[f]),m=new c(h);h.vertices.push(m),m.pos=b,m.index=f}for(var v=h.vertices.length-1,g=0;g<v;++g){var y=h.vertices[g],O=h.vertices[g+1],j=new l(h,y,O);h.edges.push(j)}var _=new l(h,h.vertices[h.vertices.length-1],h.vertices[0]);h.edges.push(_),i.components.push(h)}break;case"polyline":for(var w of e.paths){for(var x=new u(i),S=w.length,M=0;M<S;++M){var T=r.fromArray(w[M]),E=new c(x);x.vertices.push(E),E.pos=T,E.index=M}for(var P=x.vertices.length-1,C=0;C<P;++C){var I=x.vertices[C],A=x.vertices[C+1],R=new l(x,I,A);x.edges.push(R)}i.components.push(x)}break;case"point":var F=new u(i),L=new c(F);L.index=0,L.pos=i.coordinateHelper.fromPoint(e),F.vertices.push(L),i.components.push(F)}return i}}},function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(81),r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(216)),c=i=class extends o.a{constructor(e){super(e),this.type="selection"}clone(){return new i}};Object(n.a)([Object(a.b)({type:["selection"]})],c.prototype,"type",void 0);var l=c=i=Object(n.a)([Object(s.a)("esri.layers.support.FeatureReductionSelection")],c);t.a=l},,function(e,t,r){"use strict";r.d(t,"a",(function(){return D})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return n}));var i=r(91);function n(e,t,r=32774,i=[0,0,0,0]){return{srcRgb:e,srcAlpha:e,dstRgb:t,dstAlpha:t,opRgb:r,opAlpha:r,color:{r:i[0],g:i[1],b:i[2],a:i[3]}}}function a(e,t,r,i,n=32774,a=32774,s=[0,0,0,0]){return{srcRgb:e,srcAlpha:t,dstRgb:r,dstAlpha:i,opRgb:n,opAlpha:a,color:{r:s[0],g:s[1],b:s[2],a:s[3]}}}var s={zNear:0,zFar:1},o={r:!0,g:!0,b:!0,a:!0};function c(e){return y.intern(e)}function l(e){return j.intern(e)}function u(e){return w.intern(e)}function d(e){return S.intern(e)}function h(e){return T.intern(e)}function p(e){return P.intern(e)}function f(e){return I.intern(e)}function b(e){return R.intern(e)}function m(e){return L.intern(e)}class v{constructor(e,t){this.makeKey=e,this.makeRef=t,this.interns=new Map}intern(e){if(!e)return null;var t=this.makeKey(e),r=this.interns;return r.has(t)||r.set(t,this.makeRef(e)),r.get(t)}}function g(e){return"["+e.join(",")+"]"}var y=new v(O,(e=>Object(i.a)({__tag:"Blending"},e)));function O(e){return e?g([e.srcRgb,e.srcAlpha,e.dstRgb,e.dstAlpha,e.opRgb,e.opAlpha,e.color.r,e.color.g,e.color.b,e.color.a]):null}var j=new v(_,(e=>Object(i.a)({__tag:"Culling"},e)));function _(e){return e?g([e.face,e.mode]):null}var w=new v(x,(e=>Object(i.a)({__tag:"PolygonOffset"},e)));function x(e){return e?g([e.factor,e.units]):null}var S=new v(M,(e=>Object(i.a)({__tag:"DepthTest"},e)));function M(e){return e?g([e.func]):null}var T=new v(E,(e=>Object(i.a)({__tag:"StencilTest"},e)));function E(e){return e?g([e.function.func,e.function.ref,e.function.mask,e.operation.fail,e.operation.zFail,e.operation.zPass]):null}var P=new v(C,(e=>Object(i.a)({__tag:"DepthWrite"},e)));function C(e){return e?g([e.zNear,e.zFar]):null}var I=new v(A,(e=>Object(i.a)({__tag:"ColorWrite"},e)));function A(e){return e?g([e.r,e.g,e.b,e.a]):null}var R=new v(F,(e=>Object(i.a)({__tag:"StencilWrite"},e)));function F(e){return e?g([e.mask]):null}var L=new v((function(e){return e?g([O(e.blending),_(e.culling),x(e.polygonOffset),M(e.depthTest),E(e.stencilTest),C(e.depthWrite),A(e.colorWrite),F(e.stencilWrite)]):null}),(e=>({blending:c(e.blending),culling:l(e.culling),polygonOffset:u(e.polygonOffset),depthTest:d(e.depthTest),stencilTest:h(e.stencilTest),depthWrite:p(e.depthWrite),colorWrite:f(e.colorWrite),stencilWrite:b(e.stencilWrite)})));class D{constructor(e){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._stateSetters=e}setPipeline(e){(this._pipelineInvalid||e!==this._pipeline)&&(this.setBlending(e.blending),this.setCulling(e.culling),this.setPolygonOffset(e.polygonOffset),this.setDepthTest(e.depthTest),this.setStencilTest(e.stencilTest),this.setDepthWrite(e.depthWrite),this.setColorWrite(e.colorWrite),this.setStencilWrite(e.stencilWrite),this._pipeline=e),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}setBlending(e){this._blending=this.setSubState(e,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}setCulling(e){this._culling=this.setSubState(e,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}setPolygonOffset(e){this._polygonOffset=this.setSubState(e,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}setDepthTest(e){this._depthTest=this.setSubState(e,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}setStencilTest(e){this._stencilTest=this.setSubState(e,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}setDepthWrite(e){this._depthWrite=this.setSubState(e,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}setColorWrite(e){this._colorWrite=this.setSubState(e,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}setStencilWrite(e){this._stencilWrite=this.setSubState(e,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}setSubState(e,t,r,i){return(r||e!==t)&&(i(e),this._pipelineInvalid=!0),e}}},function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(92)),s=(r(81),r(88),r(85)),o=r(84),c=(r(83),r(86),r(87),r(90)),l=r(169),u=r(105),d=r(138),h=r(181),p=i=class extends c.a{constructor(){super(...arguments),this.statisticType=null,this.onStatisticField=null,this.onStatisticValueExpression=null}clone(){return new i({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})}};Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],p.prototype,"statisticType",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],p.prototype,"onStatisticField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],p.prototype,"onStatisticValueExpression",void 0);var f,b=p=i=Object(n.a)([Object(o.a)("esri.layers.support.OutStatistic")],p),m=f=class extends c.a{constructor(){super(...arguments),this.name=null}clone(){return new f({name:this.name,outStatistic:this.outStatistic.clone()})}};Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],m.prototype,"name",void 0),Object(n.a)([Object(s.b)({type:b,json:{write:!0}})],m.prototype,"outStatistic",void 0);var v,g=m=f=Object(n.a)([Object(o.a)("esri.layers.support.AggregateField")],m),y=r(195),O=v=class extends c.a{constructor(e){super(e),this.type="cluster",this.clusterRadius=Object(u.k)("80px"),this.clusterMinSize=Object(u.k)("12px"),this.clusterMaxSize=Object(u.k)("50px"),this.popupEnabled=!0,this.popupTemplate=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}clone(){return new v({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:Object(a.a)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:Object(a.a)(this.fields),popupEnabled:this.popupEnabled,popupTemplate:Object(a.a)(this.popupTemplate)})}};Object(n.a)([Object(s.b)({type:["cluster"],readOnly:!0,json:{write:!0}})],O.prototype,"type",void 0),Object(n.a)([Object(s.b)({type:Number,cast:e=>"auto"===e?e:Object(u.k)(e),json:{write:!0}})],O.prototype,"clusterRadius",void 0),Object(n.a)([Object(s.b)({type:Number,cast:u.k,json:{write:!0}})],O.prototype,"clusterMinSize",void 0),Object(n.a)([Object(s.b)({type:Number,cast:u.k,json:{write:!0}})],O.prototype,"clusterMaxSize",void 0),Object(n.a)([Object(s.b)(h.j)],O.prototype,"popupEnabled",void 0),Object(n.a)([Object(s.b)({type:l.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],O.prototype,"popupTemplate",void 0),Object(n.a)([Object(s.b)({types:d.f})],O.prototype,"symbol",void 0),Object(n.a)([Object(s.b)({type:[y.a],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],O.prototype,"labelingInfo",void 0),Object(n.a)([Object(s.b)(h.d)],O.prototype,"labelsVisible",void 0),Object(n.a)([Object(s.b)({type:[g],json:{write:!0}})],O.prototype,"fields",void 0);var j=O=v=Object(n.a)([Object(o.a)("esri.layers.support.FeatureReductionCluster")],O);t.a=j},function(e,t,r){"use strict";function i(e){var t={};for(var r in e)if("declaredClass"!==r){var n=e[r];if(null!=n&&"function"!=typeof n)if(Array.isArray(n)){t[r]=[];for(var a=0;a<n.length;a++)t[r][a]=i(n[a])}else"object"==typeof n?n.toJSON&&(t[r]=JSON.stringify(n)):t[r]=n}return t}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(212);function n(e,t,r){if(r&&r.features&&r.hasZ){var n=Object(i.a)(r.geometryType,t,e.outSpatialReference);if(n)for(var a of r.features)n(a.geometry)}}},function(e,t,r){"use strict";r.r(t);var i,n=r(7),a=r(91),s=r(82),o=r(80),c=r(124),l=r(89),u=r(81),d=r(85),h=r(116),p=r(95),f=r(98),b=r(188),m=r(84),v=r(96),g=r(93),y=r(83),O=(r(86),r(87),r(94)),j=r(99),_=r(103),w=r(107),x=r(118),S=r(169),M=r(106),T=r(138),E=r(115),P=r(218),C=r(186),I=r(242),A=r(303),R=r(181),F=r(283),L=(r(128),r(229),r(231)),D=(r(197),r(199),r(198),r(194)),k=r(214),z=r(244),V=r(207),N=r(92),U=r(90),B=r(88),q=i=class extends U.a{constructor(e){super(e),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new i({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],q.prototype,"expression",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],q.prototype,"name",void 0),Object(s.a)([Object(d.b)({type:["boolean"],json:{write:!0}})],q.prototype,"returnType",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],q.prototype,"title",void 0);var G=q=i=Object(s.a)([Object(m.a)("esri.form.ExpressionInfo")],q),H=class extends U.a{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],H.prototype,"description",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],H.prototype,"label",void 0),Object(s.a)([Object(d.b)()],H.prototype,"type",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],H.prototype,"visibilityExpression",void 0);var W,J=H=Object(s.a)([Object(m.a)("esri.form.elements.Element")],H),Z=W=class extends U.a{constructor(e){super(e),this.type=null}clone(){return new W({type:this.type})}};Object(s.a)([Object(d.b)({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],Z.prototype,"type",void 0);var X,Y=Z=W=Object(s.a)([Object(m.a)("esri.form.elements.inputs.AttachmentInput")],Z),Q=X=class extends J{constructor(e){super(e),this.attachmentKeyword=null,this.editable=!0,this.input=null,this.type="attachment"}clone(){return new X({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],Q.prototype,"attachmentKeyword",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{write:!0}})],Q.prototype,"editable",void 0),Object(s.a)([Object(d.b)({type:Y,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Q.prototype,"input",void 0),Object(s.a)([Object(d.b)({type:["attachment"],json:{read:!1,write:!0}})],Q.prototype,"type",void 0);var K=Q=X=Object(s.a)([Object(m.a)("esri.form.elements.AttachmentElement")],Q),$=r(149),ee=class extends U.a{constructor(e){super(e),this.type=null}};Object(s.a)([Object(d.b)()],ee.prototype,"type",void 0);var te=ee=Object(s.a)([Object(m.a)("esri.form.elements.inputs.Input")],ee),re=class extends te{constructor(e){super(e),this.maxLength=null,this.minLength=0}};Object(s.a)([Object(d.b)({type:Number,json:{write:!0}})],re.prototype,"maxLength",void 0),Object(s.a)([Object(d.b)({type:Number,json:{write:!0}})],re.prototype,"minLength",void 0);var ie,ne=re=Object(s.a)([Object(m.a)("esri.form.elements.inputs.TextInput")],re),ae=ie=class extends ne{constructor(e){super(e),this.type="barcode-scanner"}clone(){return new ie({maxLength:this.maxLength,minLength:this.minLength})}};Object(s.a)([Object(d.b)({type:["barcode-scanner"],json:{read:!1,write:!0}})],ae.prototype,"type",void 0);var se,oe=ae=ie=Object(s.a)([Object(m.a)("esri.form.elements.inputs.BarcodeScannerInput")],ae),ce=se=class extends te{constructor(e){super(e),this.noValueOptionLabel=null,this.showNoValueOption=!1,this.type="combo-box"}clone(){return new se({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],ce.prototype,"noValueOptionLabel",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{write:!0}})],ce.prototype,"showNoValueOption",void 0),Object(s.a)([Object(d.b)({type:["combo-box"],json:{read:!1,write:!0}})],ce.prototype,"type",void 0);var le,ue=ce=se=Object(s.a)([Object(m.a)("esri.form.elements.inputs.ComboBoxInput")],ce);function de(e){return null!=e?new Date(e):null}function he(e){return e?e.getTime():null}var pe=le=class extends te{constructor(e){super(e),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(e,t){return de(t.max)}writeMax(e,t){t.max=he(e)}readMin(e,t){return de(t.min)}writeMin(e,t){t.min=he(e)}clone(){return new le({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}};Object(s.a)([Object(d.b)({type:Boolean,json:{write:!0}})],pe.prototype,"includeTime",void 0),Object(s.a)([Object(d.b)({type:Date,json:{type:Number,write:!0}})],pe.prototype,"max",void 0),Object(s.a)([Object(f.a)("max")],pe.prototype,"readMax",null),Object(s.a)([Object(v.a)("max")],pe.prototype,"writeMax",null),Object(s.a)([Object(d.b)({type:Date,json:{type:Number,write:!0}})],pe.prototype,"min",void 0),Object(s.a)([Object(f.a)("min")],pe.prototype,"readMin",null),Object(s.a)([Object(v.a)("min")],pe.prototype,"writeMin",null),Object(s.a)([Object(d.b)({type:["datetime-picker"],json:{read:!1,write:!0}})],pe.prototype,"type",void 0);var fe,be=pe=le=Object(s.a)([Object(m.a)("esri.form.elements.inputs.DateTimePickerInput")],pe),me=fe=class extends te{constructor(e){super(e),this.noValueOptionLabel=null,this.showNoValueOption=!1,this.type="radio-buttons"}clone(){return new fe({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],me.prototype,"noValueOptionLabel",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{write:!0}})],me.prototype,"showNoValueOption",void 0),Object(s.a)([Object(d.b)({type:["radio-buttons"],json:{read:!1,write:!0}})],me.prototype,"type",void 0);var ve,ge=me=fe=Object(s.a)([Object(m.a)("esri.form.elements.inputs.RadioButtonsInput")],me),ye=ve=class extends ne{constructor(e){super(e),this.type="text-area"}clone(){return new ve({maxLength:this.maxLength,minLength:this.minLength})}};Object(s.a)([Object(d.b)({type:["text-area"],json:{read:!1,write:!0}})],ye.prototype,"type",void 0);var Oe,je=ye=ve=Object(s.a)([Object(m.a)("esri.form.elements.inputs.TextAreaInput")],ye),_e=Oe=class extends ne{constructor(e){super(e),this.type="text-box"}clone(){return new Oe({maxLength:this.maxLength,minLength:this.minLength})}};Object(s.a)([Object(d.b)({type:["text-box"],json:{read:!1,write:!0}})],_e.prototype,"type",void 0),_e=Oe=Object(s.a)([Object(m.a)("esri.form.elements.inputs.TextBoxInput")],_e);var we,xe={base:te,key:"type",typeMap:{"barcode-scanner":oe,"combo-box":ue,"datetime-picker":be,"radio-buttons":ge,"text-area":je,"text-box":_e}},Se=we=class extends J{constructor(e){super(e),this.domain=null,this.editable=!0,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field"}clone(){return new we({description:this.description,domain:this.domain,editable:this.editable,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,visibilityExpression:this.visibilityExpression})}};Object(s.a)([Object(d.b)({types:$.d,json:{read:{reader:$.b},write:!0}})],Se.prototype,"domain",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{write:!0}})],Se.prototype,"editable",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],Se.prototype,"fieldName",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],Se.prototype,"hint",void 0),Object(s.a)([Object(d.b)({types:xe,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Se.prototype,"input",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],Se.prototype,"requiredExpression",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:!1,write:!0}})],Se.prototype,"type",void 0);var Me,Te=Se=we=Object(s.a)([Object(m.a)("esri.form.elements.FieldElement")],Se),Ee=r(500),Pe=Me=class extends J{constructor(e){super(e),this.displayCount=null,this.displayType="list",this.editable=!0,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new Me({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:Object(N.a)(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};Object(s.a)([Object(d.b)({type:Number,json:{write:!0}})],Pe.prototype,"displayCount",void 0),Object(s.a)([Object(d.b)({type:["list"],json:{write:!0}})],Pe.prototype,"displayType",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{write:!0}})],Pe.prototype,"editable",void 0),Object(s.a)([Object(d.b)({type:[Ee.a],json:{write:!0}})],Pe.prototype,"orderByFields",void 0),Object(s.a)([Object(d.b)({type:Number,json:{write:!0}})],Pe.prototype,"relationshipId",void 0),Object(s.a)([Object(d.b)({type:["relationship"],json:{read:!1,write:!0}})],Pe.prototype,"type",void 0);var Ce,Ie=Pe=Me=Object(s.a)([Object(m.a)("esri.form.elements.RelationshipElement")],Pe);function Ae(e){return{typesWithGroup:{base:J,key:"type",typeMap:{attachment:K,field:Te,group:e,relationship:Ie}},typesWithoutGroup:{base:J,key:"type",typeMap:{attachment:K,field:Te,relationship:Ie}}}}function Re(e,t,r=!0){if(!e)return null;var i=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((e=>i[e.type])).map((e=>i[e.type].fromJSON(e)))}function Fe(e,t,r=!0){if(!e)return null;var i=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((e=>i[e.type])).map((e=>e.toJSON()))}function Le(e,t,r=!0){return e?e.map((e=>Object(B.k)(r?t.typesWithGroup:t.typesWithoutGroup,e))):null}var De=Ce=class extends J{constructor(e){super(e),this.elements=null,this.initialState="expanded",this.type="group"}castElements(e){return Le(e,ze,!1)}readElements(e,t){return Re(t.formElements,ze,!1)}writeElements(e,t){t.formElements=Fe(e,ze,!1)}clone(){return new Ce({description:this.description,elements:Object(N.a)(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};Object(s.a)([Object(d.b)({json:{write:!0}})],De.prototype,"elements",void 0),Object(s.a)([Object(h.a)("elements")],De.prototype,"castElements",null),Object(s.a)([Object(f.a)("elements",["formElements"])],De.prototype,"readElements",null),Object(s.a)([Object(v.a)("elements")],De.prototype,"writeElements",null),Object(s.a)([Object(d.b)({type:["collapsed","expanded"],json:{write:!0}})],De.prototype,"initialState",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:!1,write:!0}})],De.prototype,"type",void 0);var ke,ze=Ae(De=Ce=Object(s.a)([Object(m.a)("esri.form.elements.GroupElement")],De)),Ve=Ae(De),Ne=ke=class extends U.a{constructor(e){super(e),this.description=null,this.elements=null,this.expressionInfos=null,this.title=null}castElements(e){return Le(e,Ve)}readElements(e,t){return Re(t.formElements,Ve)}writeElements(e,t){t.formElements=Fe(e,Ve)}clone(){return new ke({description:this.description,expressionInfos:Object(N.a)(this.expressionInfos),elements:Object(N.a)(this.elements),title:this.title})}};Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],Ne.prototype,"description",void 0),Object(s.a)([Object(d.b)({json:{write:!0}})],Ne.prototype,"elements",void 0),Object(s.a)([Object(h.a)("elements")],Ne.prototype,"castElements",null),Object(s.a)([Object(f.a)("elements",["formElements"])],Ne.prototype,"readElements",null),Object(s.a)([Object(v.a)("elements")],Ne.prototype,"writeElements",null),Object(s.a)([Object(d.b)({type:[G],json:{write:!0}})],Ne.prototype,"expressionInfos",void 0),Object(s.a)([Object(d.b)({type:String,json:{write:!0}})],Ne.prototype,"title",void 0);var Ue=Ne=ke=Object(s.a)([Object(m.a)("esri.form.FormTemplate")],Ne),Be=r(146);var qe,Ge=r(130),He=r(183),We=(r(101),r(227)),Je=r(185),Ze=r(123),Xe=r(275),Ye=r(212),Qe=r(270),Ke=0,$e=u.a.getLogger("esri.layers.graphics.sources.MemorySource"),et=class extends(Je.a.LoadableMixin(Object(We.b)(w.a))){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){var t=Object(l.k)(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Promise.resolve(this)}destroy(){var e;null==(e=this._connection)||e.close(),this._connection=null}get workerGeometryType(){var e=this.layer&&this.layer.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then((()=>this._applyEdits(e)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}queryFeatures(e,t={}){var r=this;return Object(n.a)((function*(){yield r.load(t);var i=yield r._connection.invoke("queryFeatures",e?e.toJSON():null,t);Object(Qe.a)(e,r.layer.spatialReference,i);var n=Be.default.fromJSON(i);if(!r._requiresClientGraphicMapping())return n;var a=r.layer.objectIdField;for(var s of n.features){var o=s.attributes[a],c=r._idToClientGraphic.get(o);c&&(s.geometry=c.geometry)}return n.geometryType=r.layer.geometryType,n}))()}queryFeaturesJSON(e,t={}){var r=this;return Object(n.a)((function*(){if(r._requiresClientGraphicMapping())throw new g.a("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");yield r.load(t);var i=yield r._connection.invoke("queryFeatures",e?e.toJSON():null,t);return Object(Qe.a)(e,r.layer.spatialReference,i),i}))()}queryFeatureCount(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,t)))}queryObjectIds(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,t)))}queryExtent(e,t={}){return this.load(t).then((()=>this._connection.invoke("queryExtent",e?e.toJSON():null,t))).then((e=>({count:e.count,extent:_.a.fromJSON(e.extent)})))}querySnapping(e,t={}){return this.load(t).then((()=>this._connection.invoke("querySnapping",e,t)))}_applyEdits(e){if(!this._connection)throw new g.a("feature-layer-source:edit-failure","Memory source not loaded");var t=this.layer.objectIdField,r=null,i=[],n=[],a=e=>"objectId"in e&&null!=e.objectId?e.objectId:"attributes"in e&&null!=e.attributes[t]?e.attributes[t]:null;if(e.addFeatures&&(r=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(var s of e.deleteFeatures){var o=a(s);null!=o&&i.push(o)}var c=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures)for(var l of e.updateFeatures)if(n.push(this._serializeFeature(l)),c){var u=a(l);null!=u&&c.set(u,l)}return Object(Ye.b)(r?r.features:null,n,this.layer.spatialReference),this._connection.invoke("applyEdits",{adds:r?r.features:[],updates:n,deletes:i}).then((({fullExtent:e,featureEditResults:t})=>{if(this.fullExtent=e,r&&r.finish(t.uidToObjectId),this._idToClientGraphic){if(c)for(var i of t.updateResults)if(i.success){var n=c.get(i.objectId);null!=n&&this._addIdToClientGraphic(n)}for(var a of t.deleteResults)a.success&&this._idToClientGraphic.delete(a.objectId)}return this._createEditsResult(t)}))}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new g.a("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}_prepareAddFeatures(e){for(var t=new Map,r=new Array(e.length),i=null,n=0;n<e.length;n++){var a=e[n],s=this._serializeFeature(a);!i&&Object(l.k)(a.geometry)&&(i=a.geometry.type),r[n]=s,t.set("".concat(s.uid),a)}var o=this;return{features:r,inferredGeometryType:i,finish(e){var r=o.sourceJSON.objectIdField;for(var i in e){var n=e[i],a=t.get(i);a&&(a.attributes||(a.attributes={}),-1===n?delete a.attributes[r]:a.attributes[r]=n,o._addIdToClientGraphic(a))}}}}_addIdToClientGraphic(e){if(this._idToClientGraphic){var t=this.sourceJSON.objectIdField,r=e.attributes&&e.attributes[t];null!=r&&this._idToClientGraphic.set(r,e)}}_requiresClientGraphicMapping(){var e=this.layer.geometryType||this.sourceJSON.geometryType;return this._geometryTypeRequiresClientGraphicMapping(e)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return"mesh"===e||"multipatch"===e||"extent"===e}_serializeFeature(e){var{attributes:t}=e,r=this._geometryForSerialization(e),i=(Ke++).toString();return r?{uid:i,geometry:r.toJSON(),attributes:t}:{uid:i,attributes:t}}_geometryForSerialization(e){var{geometry:t}=e;return Object(l.j)(t)?null:this._geometryRequiresClientGraphicMapping(t)?t.extent?Ge.a.fromExtent(t.extent):null:t}_startWorker(e){var t=this;return Object(n.a)((function*(){t._connection=yield Object(Xe.b)("MemorySourceWorker",{strategy:Object(o.a)("feature-layers-workers")?"dedicated":"local",signal:e});var{fields:r,spatialReference:i,objectIdField:n,hasM:a,hasZ:s,timeInfo:c}=t.layer,l="defaults"===t.layer.originOf("spatialReference"),u=t._prepareAddFeatures(t.items);t.on("before-changes",(e=>{$e.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),e.preventDefault()}));var d={features:u.features,fields:r&&r.map((e=>e.toJSON())),geometryType:He.c.toJSON(t.workerGeometryType),hasM:a,hasZ:s,objectIdField:n,spatialReference:l?null:i&&i.toJSON(),timeInfo:c?c.toJSON():null},h=yield t._connection.invoke("load",d,{signal:e});for(var p of h.warnings)$e.warn(p.message,{layer:t.layer,warning:p});h.featureErrors.length&&$e.warn("Encountered ".concat(h.featureErrors.length," validation errors while loading features"),h.featureErrors);var f=h.layerDefinition;t._geometryTypeRequiresClientGraphicMapping(u.inferredGeometryType)&&(f.geometryType=He.c.toJSON(u.inferredGeometryType)),"mesh"!==f.geometryType&&"mesh"!==t.layer.geometryType||(f.hasZ=!0),t.sourceJSON=f,t._requiresClientGraphicMapping()&&(t._idToClientGraphic=new Map),u.finish(h.assignedObjectIds)}))()}};Object(s.a)([(qe={Type:Ze.a,ensureType:Object(B.m)(Ze.a)},(e,t)=>{e[t]=qe})],et.prototype,"itemType",void 0),Object(s.a)([Object(d.b)()],et.prototype,"type",void 0),Object(s.a)([Object(d.b)({constructOnly:!0})],et.prototype,"layer",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],et.prototype,"workerGeometryType",null),Object(s.a)([Object(d.b)()],et.prototype,"sourceJSON",void 0);var tt,rt=et=Object(s.a)([Object(m.a)("esri.layers.graphics.sources.MemorySource")],et),it=r(377),nt=r(215),at=r(318),st=r(273),ot=r(260),ct=r(204),lt=r(239),ut=r(304),dt=tt=class extends U.a{constructor(e){super(e)}clone(){var{name:e,fields:t,isAscending:r,isUnique:i,description:n}=this;return new tt({name:e,fields:t,isAscending:r,isUnique:i,description:n})}};Object(s.a)([Object(d.b)({constructOnly:!0})],dt.prototype,"name",void 0),Object(s.a)([Object(d.b)({constructOnly:!0})],dt.prototype,"fields",void 0),Object(s.a)([Object(d.b)({constructOnly:!0})],dt.prototype,"isAscending",void 0),Object(s.a)([Object(d.b)({constructOnly:!0})],dt.prototype,"isUnique",void 0),Object(s.a)([Object(d.b)({constructOnly:!0})],dt.prototype,"description",void 0);dt=tt=Object(s.a)([Object(m.a)("esri.layers.support.FeatureIndex")],dt);var ht=r(216),pt=r(195),ft=r(268),bt=r(265),mt=r(342),vt=r(251),gt=r(298),yt=r(335),Ot=r(117),jt=class extends U.a{constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};Object(s.a)([Object(d.b)({type:String,json:{read:{source:"shapeAreaFieldName"}}})],jt.prototype,"shapeAreaField",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:{source:"shapeLengthFieldName"}}})],jt.prototype,"shapeLengthField",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:e=>Ot.a.read(e)||Ot.n.read(e)}})],jt.prototype,"units",void 0);var _t=jt=Object(s.a)([Object(m.a)("esri.layers.support.GeometryFieldsInfo")],jt),wt=r(339),xt=r(346),St=new p.a({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),Mt=new p.a({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"}),Tt=class extends U.a{constructor(e){super(e),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};Object(s.a)([Object(d.b)({json:{read:St.read,write:St.write}})],Tt.prototype,"cardinality",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"composite",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"id",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"keyField",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"keyFieldInRelationshipTable",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"name",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"relatedTableId",void 0),Object(s.a)([Object(d.b)({json:{read:!0,write:!0}})],Tt.prototype,"relationshipTableId",void 0),Object(s.a)([Object(d.b)({json:{read:Mt.read,write:Mt.write}})],Tt.prototype,"role",void 0);var Et=Tt=Object(s.a)([Object(m.a)("esri.layers.support.Relationship")],Tt),Pt=r(170),Ct=r(310),It=r(274),At=r(259),Rt=r(132),Ft=r(224),Lt=new p.a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Dt={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},kt="FeatureLayer",zt=u.a.getLogger("esri.layers.FeatureLayer");function Vt(e){return e&&e instanceof w.a}function Nt(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}function Ut(e,t,r){return e&&e.hasOwnProperty(t)?e[t]:r}var Bt=Object(yt.a)();function qt(e,t,r){var i=!(null==r||!r.writeLayerSchema);return{enabled:i,ignoreOrigin:i}}var Gt=class extends(Object(nt.a)(Object(ut.a)(Object(ct.a)(Object(ot.a)(Object(it.a)(Object(F.a)(Object(st.a)(Object(C.a)(Object(at.a)(P.a)))))))))){constructor(...e){super(...e),this._handles=new E.a,this.capabilities=null,this.charts=null,this.copyright=null,this.displayField=null,this.definitionExpression=null,this.dynamicDataSource=null,this.editFieldsInfo=null,this.editingEnabled=!0,this.editingInfo=null,this.elevationInfo=null,this.featureReduction=null,this.fields=null,this.floorInfo=null,this.formTemplate=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.layerId=void 0,this.legendEnabled=!0,this.minScale=0,this.maxScale=0,this.globalIdField=null,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.relationships=null,this.sourceJSON=null,this.returnM=void 0,this.returnZ=void 0,this.screenSizePerspectiveEnabled=!0,this.serviceDefinitionExpression=null,this.spatialReference=j.a.WGS84,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.trackIdField=null,this.type="feature",this.typeIdField=null,this.types=null,this.indexes=new(w.a.ofType(dt)),this.userIsAdmin=!1,this.version=void 0,this.visible=!0}destroy(){var e;null==(e=this.source)||e.destroy(),this._handles=Object(l.e)(this._handles)}normalizeCtorArgs(e,t){return"string"==typeof e?Object(a.a)({url:e},t):e}load(e){var t=this,r=Object(l.k)(e)?e.signal:null;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch((e=>e)).then(Object(n.a)((function*(){if(t.url&&null==t.layerId&&/FeatureServer|MapServer\/*$/i.test(t.url)){var e=yield t._fetchFirstLayerId(r);null!=e&&(t.layerId=e)}if(!t.url&&!t._hasMemorySource())throw new g.a("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return t._initLayerProperties(yield t.createGraphicsSource(r))})));return this.addResolvingPromise(i),Promise.resolve(this)}this.addResolvingPromise(this.createGraphicsSource(r).then((e=>this._initLayerProperties(e))))}readCapabilities(e,t){return t=t.layerDefinition||t,{attachment:this._readAttachmentCapabilities(t.attachmentProperties),data:this._readDataCapabilities(t),metadata:this._readMetadataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")||0)+1}readEditingEnabled(e,t){return this._readEditingEnabled(t,!1)}readEditingEnabledFromWebMap(e,t,r){return this._readEditingEnabled(t,!0,r)}writeEditingEnabled(e,t){this._writeEditingEnabled(e,t,!1)}writeEditingEnabledToWebMap(e,t,r,i){this._writeEditingEnabled(e,t,!0,i)}readEditingInfo(e,t){var{editingInfo:r}=t;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null}readFeatureReduction(e,t){return Object(mt.a)(e,t)}writeWebSceneFeatureReduction(e,t,r,i){Object(mt.c)(e,t,"layerDefinition.featureReduction",i)}get fieldsIndex(){return new V.a(this.fields||[])}readIsTable(e,t){return"Table"===(t=t&&t.layerDefinition||t).type||!t.geometryType}writeIsTable(e,t,r,i){null!=i&&i.writeLayerSchema&&Object(c.c)(r,e?"Table":"Feature Layer",t)}readMinScale(e,t){return t.effectiveMinScale||e||0}readMaxScale(e,t){return t.effectiveMaxScale||e||0}readGlobalIdFieldFromService(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields)for(var r of t.fields)if("esriFieldTypeGlobalID"===r.type)return r.name}readObjectIdFieldFromService(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields)for(var r of t.fields)if("esriFieldTypeOID"===r.type)return r.name}get parsedUrl(){var e=this.url?Object(y.J)(this.url):null;return null!=e&&(null!=this.dynamicDataSource?e.path=Object(y.y)(e.path,"dynamicLayer"):null!=this.layerId&&(e.path=Object(y.y)(e.path,this.layerId.toString()))),e}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){Object(x.l)(e,this.fields),this._set("renderer",e)}readRenderer(e,t,r){var i=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(i){var n=Object(z.b)(i,t,r)||void 0;return n||zt.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r}),n}if(t.defaultSymbol)return t.types&&t.types.length?new L.a({defaultSymbol:Ht(t.defaultSymbol,t,r),field:t.typeIdField,uniqueValueInfos:t.types.map((e=>({id:e.id,symbol:Ht(e.symbol,e,r)})))}):new D.a({symbol:Ht(t.defaultSymbol,t,r)})}set source(e){var t=this._get("source");t!==e&&(Vt(t)&&this._resetMemorySource(t),Vt(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof w.a?new rt({layer:this,items:e}):e:null}readSource(e,t){var r=Be.default.fromJSON(t.featureSet);return new rt({layer:this,items:r&&r.features||[]})}readServiceDefinitionExpression(e,t){return t.definitionQuery||t.definitionExpression}readTemplates(e,t){var r=t.editFieldsInfo,i=r&&r.creatorField,n=r&&r.editorField;return e=e&&e.map((e=>vt.a.fromJSON(e))),this._fixTemplates(e,i),this._fixTemplates(e,n),e}readTitle(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,i=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var n=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?Object(I.j)(this.url,r):r;var a=r;if(!a&&this.url){var s=Object(I.f)(this.url);Object(l.k)(s)&&(a=s.title)}if(!a)return;return"item-title-and-service-name"===this.sublayerTitleMode&&n&&n!==a&&(a=n+" - "+a),Object(I.a)(a)}if("item-title"===this.sublayerTitleMode&&i)return i}readTitleFromWebMap(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name}readTypeIdField(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r){var i=Object(x.q)(t.fields,r);i&&(r=i.name)}return r}readTypes(e,t){e=(t=t.layerDefinition||t).types;var r=t.editFieldsInfo,i=r&&r.creatorField,n=r&&r.editorField;return e&&e.map((e=>(e=gt.a.fromJSON(e),this._fixTemplates(e.templates,i),this._fixTemplates(e.templates,n),e)))}set url(e){var t=Object(I.i)({layer:this,url:e,nonStandardUrlAllowed:!0,logger:zt});this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}writeUrl(e,t,r,i){Object(I.k)(this,e,null,t,i)}readVersion(e,t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}readVisible(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0}addAttachment(e,t){return this.load().then((()=>this._checkAttachmentSupport(e))).then((()=>{if(!("addAttachment"in this.source))throw new g.a(kt,"Layer source does not support addAttachment capability");return this.source.addAttachment(e,t)}))}updateAttachment(e,t,r){return this.load().then((()=>this._checkAttachmentSupport(e))).then((()=>{if(!("updateAttachment"in this.source))throw new g.a(kt,"Layer source does not support updateAttachment capability");return this.source.updateAttachment(e,t,r)}))}applyEdits(e,t){var i=this;return Object(n.a)((function*(){var n=yield r.e(47).then(r.bind(null,1173));return yield i.load(),n.applyEdits(i,i.source,e,t)}))()}on(e,t){return super.on(e,t)}createPopupTemplate(e){return Object(It.a)(this,e)}createGraphicsSource(e){var t=this;return Object(n.a)((function*(){if(t._hasMemorySource())return t.emit("graphics-source-create",{graphicsSource:t.source}),t.source.load({signal:e});var i=yield Promise.all([r.e(22),r.e(116)]).then(r.bind(null,1174));Object(O.u)(e);var n=yield new i.default({layer:t}).load({signal:e});return t.emit("graphics-source-create",{graphicsSource:n}),n}))()}createQuery(){var e=new Rt.a,t=this.get("capabilities.data");e.dynamicDataSource=this.dynamicDataSource,e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=["*"],e.where=this.definitionExpression||"1=1";var{timeOffset:r,timeExtent:i}=this;return e.timeExtent=null!=r&&null!=i?i.offset(-r.value,r.unit):i||null,e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e}deleteAttachments(e,t){return this.load().then((()=>this._checkAttachmentSupport(e))).then((()=>{if(!("deleteAttachments"in this.source))throw new g.a(kt,"Layer source does not support deleteAttachments capability");return this.source.deleteAttachments(e,t)}))}fetchRecomputedExtents(e){return this.load({signal:null==e?void 0:e.signal}).then((()=>{if(this.source.fetchRecomputedExtents)return this.source.fetchRecomputedExtents(e);throw new g.a(kt,"Layer source does not support fetchUpdates capability")}))}getFeatureType(e){var{typeIdField:t,types:r}=this;if(!t||!e)return null;var i=e.attributes?e.attributes[t]:void 0;if(null==i)return null;var n=null;return r.some((e=>{var{id:t}=e;return null!=t&&(t.toString()===i.toString()&&(n=e),!!n)})),n}getFieldDomain(e,t){var r=t&&t.feature,i=this.getFeatureType(r);if(i){var n=i.domains&&i.domains[e];if(n&&"inherited"!==n.type)return n}return this._getLayerDomain(e)}getField(e){return this.fieldsIndex.get(e)}queryAttachments(e,t){return e=At.a.from(e),this.load().then((()=>{if(!this.get("capabilities.data.supportsAttachment"))throw new g.a(kt,"this layer doesn't support attachments");var{attachmentTypes:t,objectIds:r,globalIds:i,num:n,size:a,start:s,where:o}=e;if(!this.get("capabilities.operations.supportsQueryAttachments")){var c=r&&r.length>1,l=t&&t.length,u=i&&i.length,d=a&&a.length;if(c||l||u||d||n||s||o)throw new g.a(kt,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e)}if(!(r&&r.length||o))throw new g.a(kt,"'objectIds' or 'where' are required to perform attachment query",e);if(!("queryAttachments"in this.source))throw new g.a(kt,"Layer source does not support queryAttachments capability",e);return this.source.queryAttachments(e)}))}queryFeatures(e,t){return this.load().then((()=>this.source.queryFeatures(Rt.a.from(e)||this.createQuery(),t))).then((e=>{if(e&&e.features)for(var t of e.features)t.layer=t.sourceLayer=this;return e}))}queryObjectIds(e,t){return this.load().then((()=>{if(this.source.queryObjectIds)return this.source.queryObjectIds(Rt.a.from(e)||this.createQuery(),t);throw new g.a(kt,"Layer source does not support queryObjectIds capability")}))}queryFeatureCount(e,t){return this.load().then((()=>{if(this.source.queryFeatureCount)return this.source.queryFeatureCount(Rt.a.from(e)||this.createQuery(),t);throw new g.a(kt,"Layer source does not support queryFeatureCount capability")}))}queryExtent(e,t){return this.load().then((()=>{if(this.source.queryExtent)return this.source.queryExtent(Rt.a.from(e)||this.createQuery(),t);throw new g.a(kt,"Layer source does not support queryExtent capability")}))}queryRelatedFeatures(e,t){return this.load().then((()=>{if("queryRelatedFeatures"in this.source)return this.source.queryRelatedFeatures(Ft.a.from(e),t);throw new g.a(kt,"Layer source does not support queryRelatedFeatures capability")}))}queryRelatedFeaturesCount(e,t){return this.load().then((()=>{if("queryRelatedFeaturesCount"in this.source)return this.source.queryRelatedFeaturesCount(Ft.a.from(e),t);throw new g.a(kt,"Layer source does not support queryRelatedFeaturesCount capability")}))}read(e,t){var r=e.featureCollection;if(r){var i=r.layers;i&&1===i.length&&(super.read(i[0],t),null!=r.showLegend&&super.read({showLegend:r.showLegend},t))}super.read(e,t),t&&"service"===t.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}write(e,t){var r,i,n=(t=Object(a.a)(Object(a.a)({},t),{},{writeLayerSchema:null!=(r=null==(i=t)?void 0:i.writeLayerSchema)?r:this._hasMemorySource()})).origin,s=t.layerContainerType,o=t.messages;if(this.isTable){if("web-scene"===n||"web-map"===n&&"tables"!==s)return o&&o.push(new g.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using a Table source cannot be written to web scenes and web maps"),{layer:this})),null;if(this._hasMemorySource())return o&&o.push(new g.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using an in-memory Table source cannot be written to web scenes and web maps"),{layer:this})),null}else if(this.loaded&&"web-map"===n&&"tables"===s)return o&&o.push(new g.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using a non-table source cannot be written to tables in web maps"),{layer:this})),null;return super.write(e,t)}_readEditingEnabled(e,t,r){var i,n=null==(i=e.layerDefinition)?void 0:i.capabilities;return n?this._hasEditingCapability(n):(n=e.capabilities,!(t&&"web-map"===(null==r?void 0:r.origin)&&!this._hasMemorySource()&&n)||this._hasEditingCapability(n))}_hasEditingCapability(e){return e.toLowerCase().split(",").map((e=>e.trim())).includes("editing")}_writeEditingEnabled(e,t,r,i){if(!e){var n,a,s=null!=(n=this.capabilities)&&null!=(a=n.operations)&&a.supportsSync?"Query,Sync":"Query";Object(c.c)("layerDefinition.capabilities",s,t),!r||null!=i&&i.writeLayerSchema||(t.capabilities=s)}}_checkAttachmentSupport(e){var{attributes:t}=e,{objectIdField:r}=this;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:Promise.reject(new g.a(kt,"feature is missing the identifying attribute ".concat(r))):Promise.reject(new g.a(kt,"'attributes' are required on a feature to query attachments")):Promise.reject(new g.a(kt,"A feature is required to add/delete/update attachments")):Promise.reject(new g.a(kt,"this layer doesn't support attachments"))}_getLayerDomain(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}_fetchFirstLayerId(e){return Object(M.default)(this.url,{query:Object(a.a)({f:"json"},this.customParameters),responseType:"json",signal:e}).then((e=>{var t=e.data;if(t)return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}))}_initLayerProperties(e){var t=this;return Object(n.a)((function*(){return t._set("source",e),e.sourceJSON&&(t.sourceJSON=e.sourceJSON,t.read(e.sourceJSON,{origin:"service",url:t.parsedUrl})),t._verifySource(),t._verifyFields(),Object(x.l)(t.renderer,t.fields),Object(x.m)(t.timeInfo,t.fields),Object(Ct.a)(t,{origin:"service"})}))()}_verifyFields(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some((function(e){return"geometry"===e.type}))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,t){e&&e.forEach((e=>{var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]}))}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new g.a("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new g.a("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach((e=>{e.layer=this,e.sourceLayer=this})),this._handles.add([e.on("after-add",(e=>{e.item.layer=this,e.item.sourceLayer=this})),e.on("after-remove",(e=>{e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")}_resetMemorySource(e){e.forEach((e=>{e.layer=null,e.sourceLayer=null})),this._handles.remove("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}_readAttachmentCapabilities(e){var t={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return e&&Array.isArray(e)&&e.forEach((e=>{var r=Dt[e.name];r&&(t[r]=!!e.isEnabled)})),t}_readDataCapabilities(e){return{isVersioned:Nt(e,"isDataVersioned",!1),supportsAttachment:Nt(e,"hasAttachments",!1),supportsM:Nt(e,"hasM",!1),supportsZ:Nt(e,"hasZ",!1)}}_readMetadataCapabilities(e){return{supportsAdvancedFieldProperties:Nt(e,"supportsFieldDescriptionProperty",!1)}}_readOperationsCapabilities(e,t){var r=e?e.toLowerCase().split(",").map((e=>e.trim())):[],i=-1!==r.indexOf("editing"),n=i&&-1!==r.indexOf("create"),a=i&&-1!==r.indexOf("delete"),s=i&&-1!==r.indexOf("update"),o=-1!==r.indexOf("changetracking");return i&&!(n||a||s)&&(n=a=s=!0),{supportsCalculate:Nt(t,"supportsCalculate",!1),supportsTruncate:Nt(t,"supportsTruncate",!1),supportsValidateSql:Nt(t,"supportsValidateSql",!1),supportsAdd:n,supportsDelete:a,supportsEditing:i,supportsChangeTracking:o,supportsQuery:-1!==r.indexOf("query"),supportsQueryAttachments:Nt(t.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:Nt(t,"supportsAttachmentsResizing",!1),supportsSync:-1!==r.indexOf("sync"),supportsUpdate:s,supportsExceedsLimitStatistics:Nt(t,"supportsExceedsLimitStatistics",!1)}}_readQueryCapabilities(e){var t,r=e.advancedQueryCapabilities,i=e.ownershipBasedAccessControlForFeatures,n=e.archivingInfo,a=null==(t=this.url)?void 0:t.includes("MapServer"),s=!Object(o.a)("mapserver-pbf-enabled")&&a&&this.version<10.81,c=(e.supportedQueryFormats||"").split(",").reduce(((e,t)=>{var r=t.toLowerCase().trim();return r&&e.add(r),e}),new Set);return{supportsStatistics:Nt(r,"supportsStatistics",e.supportsStatistics),supportsPercentileStatistics:Nt(r,"supportsPercentileStatistics",!1),supportsCentroid:Nt(r,"supportsReturningGeometryCentroid",!1),supportsDistance:Nt(r,"supportsQueryWithDistance",!1),supportsDistinct:Nt(r,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:Nt(r,"supportsReturningQueryExtent",!1),supportsGeometryProperties:Nt(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:Nt(r,"supportsHavingClause",!1),supportsOrderBy:Nt(r,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:Nt(r,"supportsPagination",!1),supportsQuantization:Nt(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Nt(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:Nt(e,"supportsReturningQueryGeometry",!1),supportsResultType:Nt(r,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:Nt(r,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:Nt(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Nt(e,"useStandardizedQueries",!1),supportsQueryByOthers:Nt(i,"allowOthersToQuery",!0),supportsHistoricMoment:Nt(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:!s&&c.has("pbf"),supportsDisjointSpatialRelationship:Nt(r,"supportsDisjointSpatialRel",!1),supportsCacheHint:Nt(r,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:Ut(e,"maxRecordCountFactor",void 0),maxRecordCount:Ut(e,"maxRecordCount",void 0),standardMaxRecordCount:Ut(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:Ut(e,"tileMaxRecordCount",void 0)}}_readQueryRelatedCapabilities(e){var t=e.advancedQueryCapabilities,r=Nt(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Nt(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}}_readEditingCapabilities(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:Nt(e,"allowGeometryUpdates",!0),supportsGlobalId:Nt(e,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:Nt(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Nt(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Nt(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Nt(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Nt(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Nt(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Nt(t,"allowOthersToUpdate",!0)}}};Object(s.a)([Object(d.b)({readOnly:!0,json:{read:!1}})],Gt.prototype,"capabilities",void 0),Object(s.a)([Object(f.a)("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],Gt.prototype,"readCapabilities",null),Object(s.a)([Object(d.b)({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Gt.prototype,"charts",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"createQueryVersion",null),Object(s.a)([Object(d.b)({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],Gt.prototype,"copyright",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],Gt.prototype,"displayField",void 0),Object(s.a)([Object(d.b)({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],Gt.prototype,"definitionExpression",void 0),Object(s.a)([Object(d.b)({types:T.e,readOnly:!0})],Gt.prototype,"defaultSymbol",void 0),Object(s.a)([Object(d.b)({type:Pt.a})],Gt.prototype,"dynamicDataSource",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"editFieldsInfo",void 0),Object(s.a)([Object(d.b)({type:Boolean})],Gt.prototype,"editingEnabled",void 0),Object(s.a)([Object(f.a)(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Gt.prototype,"readEditingEnabled",null),Object(s.a)([Object(f.a)("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Gt.prototype,"readEditingEnabledFromWebMap",null),Object(s.a)([Object(v.a)(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Gt.prototype,"writeEditingEnabled",null),Object(s.a)([Object(v.a)("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Gt.prototype,"writeEditingEnabledToWebMap",null),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"editingInfo",void 0),Object(s.a)([Object(f.a)("editingInfo")],Gt.prototype,"readEditingInfo",null),Object(s.a)([Object(d.b)(R.b)],Gt.prototype,"elevationInfo",void 0),Object(s.a)([Object(d.b)({types:{key:"type",base:ht.a,typeMap:{selection:bt.a,cluster:ft.a}},json:{write:{target:"layerDefinition.featureReduction"}}})],Gt.prototype,"featureReduction",void 0),Object(s.a)([Object(f.a)("featureReduction",["layerDefinition.featureReduction"])],Gt.prototype,"readFeatureReduction",null),Object(s.a)([Object(v.a)("web-scene","featureReduction",{"layerDefinition.featureReduction":{types:mt.b}})],Gt.prototype,"writeWebSceneFeatureReduction",null),Object(s.a)([Object(d.b)(Object(a.a)(Object(a.a)({},Bt.fields),{},{json:{read:{source:"layerDefinition.fields"},origins:{service:{read:!0},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:qt}}}}}))],Gt.prototype,"fields",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"fieldsIndex",null),Object(s.a)([Object(d.b)({type:xt.a,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"},origins:{"web-scene":{write:!1}}}})],Gt.prototype,"floorInfo",void 0),Object(s.a)([Object(d.b)({type:Ue,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Gt.prototype,"formTemplate",void 0),Object(s.a)([Object(d.b)({type:_.a,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],Gt.prototype,"fullExtent",void 0),Object(s.a)([Object(d.b)()],Gt.prototype,"gdbVersion",void 0),Object(s.a)([Object(d.b)({readOnly:!0,type:_t,json:{read:{source:"geometryProperties"}}})],Gt.prototype,"geometryFieldsInfo",void 0),Object(s.a)([Object(d.b)({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Lt.read},"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:qt,writer(e,t,r){var i=e?Lt.toJSON(e):null;i&&Object(c.c)(r,i,t)}}}},read:{source:"layerDefinition.geometryType",reader:Lt.read}}})],Gt.prototype,"geometryType",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],Gt.prototype,"hasM",void 0),Object(s.a)([Object(d.b)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],Gt.prototype,"hasZ",void 0),Object(s.a)([Object(d.b)({readOnly:!0,type:A.a})],Gt.prototype,"heightModelInfo",void 0),Object(s.a)([Object(d.b)({type:Date})],Gt.prototype,"historicMoment",void 0),Object(s.a)([Object(d.b)(R.c)],Gt.prototype,"id",void 0),Object(s.a)([Object(d.b)({readOnly:!0,json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Gt.prototype,"isTable",void 0),Object(s.a)([Object(f.a)("service","isTable",["type","geometryType"]),Object(f.a)("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Gt.prototype,"readIsTable",null),Object(s.a)([Object(v.a)("web-map","isTable")],Gt.prototype,"writeIsTable",null),Object(s.a)([Object(d.b)(R.d)],Gt.prototype,"labelsVisible",void 0),Object(s.a)([Object(d.b)({type:[pt.a],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:wt.a},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:wt.a},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],Gt.prototype,"labelingInfo",void 0),Object(s.a)([Object(d.b)(R.i)],Gt.prototype,"opacity",void 0),Object(s.a)([Object(d.b)({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],Gt.prototype,"layerId",void 0),Object(s.a)([Object(d.b)(R.e)],Gt.prototype,"legendEnabled",void 0),Object(s.a)([Object(d.b)({type:["show","hide"]})],Gt.prototype,"listMode",void 0),Object(s.a)([Object(d.b)(R.g)],Gt.prototype,"minScale",void 0),Object(s.a)([Object(f.a)("service","minScale",["minScale","effectiveMinScale"])],Gt.prototype,"readMinScale",null),Object(s.a)([Object(d.b)(R.f)],Gt.prototype,"maxScale",void 0),Object(s.a)([Object(f.a)("service","maxScale",["maxScale","effectiveMaxScale"])],Gt.prototype,"readMaxScale",null),Object(s.a)([Object(d.b)({type:String})],Gt.prototype,"globalIdField",void 0),Object(s.a)([Object(f.a)("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),Object(f.a)("service","globalIdField",["globalIdField","fields"])],Gt.prototype,"readGlobalIdFieldFromService",null),Object(s.a)([Object(d.b)({type:String,json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:qt}}}}})],Gt.prototype,"objectIdField",void 0),Object(s.a)([Object(f.a)("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),Object(f.a)("service","objectIdField",["objectIdField","fields"])],Gt.prototype,"readObjectIdFieldFromService",null),Object(s.a)([Object(d.b)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Gt.prototype,"operationalLayerType",void 0),Object(s.a)([Object(d.b)(Bt.outFields)],Gt.prototype,"outFields",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"parsedUrl",null),Object(s.a)([Object(d.b)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Gt.prototype,"path",void 0),Object(s.a)([Object(d.b)(R.j)],Gt.prototype,"popupEnabled",void 0),Object(s.a)([Object(d.b)({type:S.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Gt.prototype,"popupTemplate",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"defaultPopupTemplate",null),Object(s.a)([Object(d.b)({type:[Et],readOnly:!0})],Gt.prototype,"relationships",void 0),Object(s.a)([Object(d.b)({types:k.a,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:k.b,write:{target:"layerDefinition.drawingInfo.renderer",writer:z.c}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(e,t,r)=>({ignoreOrigin:null==r?void 0:r.writeLayerSchema}),writer:z.c}}})],Gt.prototype,"renderer",null),Object(s.a)([Object(f.a)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Object(f.a)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Gt.prototype,"readRenderer",null),Object(s.a)([Object(d.b)()],Gt.prototype,"sourceJSON",void 0),Object(s.a)([Object(d.b)({type:Boolean})],Gt.prototype,"returnM",void 0),Object(s.a)([Object(d.b)({type:Boolean})],Gt.prototype,"returnZ",void 0),Object(s.a)([Object(d.b)(R.m)],Gt.prototype,"screenSizePerspectiveEnabled",void 0),Object(s.a)([Object(d.b)()],Gt.prototype,"source",null),Object(s.a)([Object(h.a)("source")],Gt.prototype,"castSource",null),Object(s.a)([Object(f.a)("portal-item","source",["featureSet"]),Object(f.a)("web-map","source",["featureSet"])],Gt.prototype,"readSource",null),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"serviceDefinitionExpression",void 0),Object(s.a)([Object(f.a)("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],Gt.prototype,"readServiceDefinitionExpression",null),Object(s.a)([Object(d.b)({type:j.a,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],Gt.prototype,"spatialReference",void 0),Object(s.a)([Object(d.b)({type:[vt.a]})],Gt.prototype,"templates",void 0),Object(s.a)([Object(f.a)("templates",["editFieldsInfo","creatorField","editorField","templates"])],Gt.prototype,"readTemplates",null),Object(s.a)([Object(d.b)({type:lt.a})],Gt.prototype,"timeInfo",void 0),Object(s.a)([Object(d.b)()],Gt.prototype,"title",void 0),Object(s.a)([Object(f.a)("service","title",["name"]),Object(f.a)("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Gt.prototype,"readTitle",null),Object(s.a)([Object(f.a)("web-map","title",["layerDefinition.name","title"])],Gt.prototype,"readTitleFromWebMap",null),Object(s.a)([Object(d.b)({type:String})],Gt.prototype,"sublayerTitleMode",void 0),Object(s.a)([Object(d.b)({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],Gt.prototype,"trackIdField",void 0),Object(s.a)([Object(d.b)({json:{read:!1}})],Gt.prototype,"type",void 0),Object(s.a)([Object(d.b)({type:String})],Gt.prototype,"typeIdField",void 0),Object(s.a)([Object(f.a)("service","typeIdField"),Object(f.a)("typeIdField",["layerDefinition.typeIdField"])],Gt.prototype,"readTypeIdField",null),Object(s.a)([Object(d.b)({type:[gt.a]})],Gt.prototype,"types",void 0),Object(s.a)([Object(f.a)("service","types",["types"]),Object(f.a)("types",["layerDefinition.types"])],Gt.prototype,"readTypes",null),Object(s.a)([Object(d.b)({readOnly:!0,json:{write:!1}})],Gt.prototype,"serverGens",void 0),Object(s.a)([Object(d.b)({type:w.a.ofType(dt),readOnly:!0})],Gt.prototype,"indexes",void 0),Object(s.a)([Object(d.b)(R.n)],Gt.prototype,"url",null),Object(s.a)([Object(v.a)("url")],Gt.prototype,"writeUrl",null),Object(s.a)([Object(d.b)({readOnly:!0})],Gt.prototype,"userIsAdmin",void 0),Object(s.a)([Object(d.b)({json:{origins:{service:{read:!0}},read:!1}})],Gt.prototype,"version",void 0),Object(s.a)([Object(f.a)("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],Gt.prototype,"readVersion",null),Object(s.a)([Object(d.b)({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Gt.prototype,"visible",void 0),Object(s.a)([Object(f.a)("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Gt.prototype,"readVisible",null),Gt=Object(s.a)([Object(m.a)("esri.layers.FeatureLayer")],Gt);var Ht=Object(b.b)({types:T.i}),Wt=Gt;t.default=Wt},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var i=r(118),n=(r(361),r(391)),a=(r(392),r(355)),s=r(296),o=r(393),c=(r(394),r(338),r(169)),l=["oid","global-id"],u=["oid","global-id","guid"];function d({displayField:e,editFieldsInfo:t,fields:r,objectIdField:a,title:s},l){if(!r)return null;var u=v({editFieldsInfo:t,fields:r,objectIdField:a},l);if(!u.length)return null;var d=function(e){var t=Object(i.n)(e),{titleBase:r}=e;return t?"".concat(r,": {").concat(t.trim(),"}"):r}({titleBase:s,fields:r,displayField:e}),h=[new o.a,new n.a];return new c.a({title:d,content:h,fieldInfos:u})}var h=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],p=(e,{editFieldsInfo:t,objectIdField:r,visibleFieldNames:i})=>i?i.has(e.name):!b(e.name,t)&&(!r||e.name!==r)&&!(l.indexOf(e.type)>-1)&&!h.some((t=>t.test(e.name)));function f(e,t){return"oid"===e.type?-1:"oid"===t.type?1:y(e)?-1:y(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function b(e,t){if(!e||!t)return!1;var{creationDateField:r,creatorField:i,editDateField:n,editorField:a}=t;return-1!==[r&&r.toLowerCase(),i&&i.toLowerCase(),n&&n.toLowerCase(),a&&a.toLowerCase()].indexOf(e.toLowerCase())}function m(e,t){return e.editable&&-1===u.indexOf(e.type)&&!b(e.name,t)}function v({editFieldsInfo:e,fields:t,objectIdField:r},i){return function(e,t){var r=e;return t&&(e=e.filter((e=>-1===t.indexOf(e.type)))),e===r&&(e=e.slice()),e.sort(f),e}(t,(null==i?void 0:i.ignoreFieldTypes)||O).map((t=>new s.a({fieldName:t.name,isEditable:m(t,e),label:t.alias,format:g(t),visible:p(t,{editFieldsInfo:e,objectIdField:r,visibleFieldNames:null==i?void 0:i.visibleFieldNames})})))}function g(e){switch(e.type){case"small-integer":case"integer":case"single":return new a.a({digitSeparator:!0,places:0});case"double":return new a.a({digitSeparator:!0,places:2});case"date":return new a.a({dateFormat:"long-month-day-year"});default:return null}}function y(e){return"name"===(e.name&&e.name.toLowerCase())||("name"===(e.alias&&e.alias.toLowerCase())||void 0)}var O=["geometry","blob","raster","guid","xml"]},function(e,t,r){"use strict";r.d(t,"a",(function(){return be})),r.d(t,"b",(function(){return ye})),r.d(t,"c",(function(){return me}));var i,n,a=r(91),s=r(7),o=r(80),c=r(93),l=r(94),u=r(226),d=r(89),h=r(165),p=r(160),f=r(289),b={geometryEngineWorker:()=>Promise.all([r.e(9),r.e(162)]).then(r.bind(null,1126)),CSVSourceWorker:()=>Promise.all([r.e(10),r.e(11),r.e(16),r.e(22),r.e(112)]).then(r.bind(null,1263)),EdgeProcessingWorker:()=>Promise.all([r.e(39),r.e(140)]).then(r.bind(null,1235)),ElevationSamplerWorker:()=>r.e(163).then(r.bind(null,1127)),GeoJSONSourceWorker:()=>Promise.all([r.e(10),r.e(11),r.e(16),r.e(22),r.e(106)]).then(r.bind(null,1128)),LercWorker:()=>r.e(219).then(r.bind(null,1129)),MemorySourceWorker:()=>Promise.all([r.e(10),r.e(11),r.e(16),r.e(22),r.e(105)]).then(r.bind(null,1130)),PBFDecoderWorker:()=>Promise.all([r.e(35),r.e(125)]).then(r.bind(null,1264)),Pipeline:()=>Promise.all([r.e(1),r.e(2),r.e(6),r.e(10),r.e(75)]).then(r.bind(null,1222)),PointCloudWorker:()=>Promise.all([r.e(10),r.e(102)]).then(r.bind(null,1240)),RasterWorker:()=>r.e(107).then(r.bind(null,1131)),SceneLayerWorker:()=>r.e(289).then(r.bind(null,1265)),WorkerTileHandler:()=>Promise.all([r.e(42),r.e(43),r.e(118)]).then(r.bind(null,1225)),FeatureServiceSnappingSourceWorker:()=>Promise.all([r.e(10),r.e(11),r.e(16),r.e(35),r.e(97)]).then(r.bind(null,1236))};(n=i||(i={}))[n.HANDSHAKE=0]="HANDSHAKE",n[n.OPEN=1]="OPEN",n[n.OPENED=2]="OPENED",n[n.RESPONSE=3]="RESPONSE",n[n.INVOKE=4]="INVOKE",n[n.ABORT=5]="ABORT",n[n.CLOSE=6]="CLOSE",n[n.OPEN_PORT=7]="OPEN_PORT",n[n.ON=8]="ON";var m=0;function v(){return m++}function g(e){return e?"string"==typeof e?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function y(e,t,r,n){var a;t.type!==i.OPEN_PORT?t.type===i.INVOKE||t.type===i.RESPONSE?(!function(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}(r)?(a=j(n),t.data=r):(a=j(r.transferList),t.data=r.result),a?e.postMessage(t,a):e.postMessage(t)):e.postMessage(t):e.postMessage(t,[t.port])}function O(e){if(!e)return null;var t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}function j(e){if(!e||!e.length)return null;if(Object(o.a)("esri-workers-arraybuffer-transfer"))return e;var t=e.filter((e=>!function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}(e)));return t.length?t:null}var{CLOSE:_,ABORT:w,INVOKE:x,RESPONSE:S,OPEN_PORT:M,ON:T}=i;class E{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}push(e){e.type===i.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){for(var e of(this._timer=null,this._invokeMessages))this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class P{constructor(e,t){this._port=e,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new E((e=>this._onInvokeMessage(e))),this._messageQueue=new Array,this._client=t.client,this._onMessage=this._onMessage.bind(this),this._channel=t.channel,Object(d.k)(t.scheduler)&&(this._frameTask=t.scheduler.registerTask(f.b.REMOTE_CLIENT,(e=>this._update(e)),(()=>this._messageQueue.length>0))),this._port.addEventListener("message",this._onMessage),this._port.start()}static connect(e){var t,r=new MessageChannel;t="function"==typeof e?new e:"default"in e&&"function"==typeof e.default?new e.default:e;var i=new P(r.port1,{channel:r,client:t});return"object"==typeof t&&"remoteClient"in t&&(t.remoteClient=i),P.clients.set(i,t),r.port2}static loadWorker(e){var t=b[e];return t?t():Promise.resolve(null)}close(){this._post({type:_}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,t,r){var i=r&&r.signal,n=r&&r.transferList;if(!this._port)return Promise.reject(new c.a("worker:port-closed","Cannot call invoke('".concat(e,"'), port is closed"),{methodName:e,data:t}));var a=v();return new Promise(((r,s)=>{var o=Object(l.q)(i,(()=>{var e,t=this._outJobs.get(a);t&&(this._outJobs.delete(a),null==(e=t.abortHandle)||e.remove(),this._post({type:w,jobId:a}),s(Object(l.e)()))})),c={resolve:r,reject:s,abortHandle:o,debugInfo:e};this._outJobs.set(a,c),this._post({type:x,jobId:a,methodName:e,abortable:null!=i},t,n)}))}on(e,t){var r=new MessageChannel;function n(e){t(e.data)}return this._port.postMessage({type:i.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),{remove(){r.port1.postMessage({type:i.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)}}}openPort(){var e=new MessageChannel;return this._post({type:M,port:e.port2}),e.port1}_close(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((e=>{var t;null==(t=e.abortHandle)||t.remove(),e.reject(Object(l.e)("Worker closing, aborting job calling '".concat(e.debugInfo,"'")))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=null,this._frameTask=Object(d.p)(this._frameTask)}_onMessage(e){Object(d.k)(this._frameTask)?this._messageQueue.push(e):this._processMessage(e)}_processMessage(e){var t=O(e);if(t)switch(t.type){case S:this._onResponseMessage(t);break;case x:this._invokeQueue.push(t);break;case w:this._onAbortMessage(t);break;case _:this._onCloseMessage();break;case M:this._onOpenPortMessage(t);break;case T:this._onOnMessage(t)}}_onAbortMessage(e){var t=this._inJobs,r=e.jobId,i=t.get(r);this._invokeQueue.push(e),i&&(i.controller&&i.controller.abort(),t.delete(r))}_onCloseMessage(){var e=this._client;this._close(),e&&"destroy"in e&&P.clients.get(this)===e&&e.destroy(),P.clients.delete(this),e&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){var t,{methodName:r,jobId:i,data:n,abortable:a}=e,s=a?Object(l.d)():null,o=this._inJobs,c=this._client,u=c[r];try{if(!u&&r&&-1!==r.indexOf("."))for(var d=r.split("."),h=0;h<d.length-1;h++)u=(c=c[d[h]])[d[h+1]];if("function"!=typeof u)throw new TypeError("".concat(r," is not a function"));t=u.call(c,n,{client:this,signal:s?s.signal:null})}catch(p){return void this._post({type:S,jobId:i,error:g(p)})}Object(l.o)(t)?(o.set(i,{controller:s,promise:t}),t.then((e=>{o.has(i)&&(o.delete(i),this._post({type:S,jobId:i},e))}),(e=>{o.has(i)&&(o.delete(i),Object(l.m)(e)||this._post({type:S,jobId:i,error:g(e||{message:"Error encountered at method ".concat(r)})}))}))):this._post({type:S,jobId:i},t)}_onOpenPortMessage(e){new P(e.port,{client:this._client})}_onOnMessage(e){var{port:t}=e,r=this._client.on(e.eventType,(e=>{t.postMessage(e)})),n=Object(h.c)(e.port,"message",(e=>{O(e).type===i.CLOSE&&(n.remove(),r.remove(),t.close())}))}_onResponseMessage(e){var t,{jobId:r,error:i,data:n}=e,a=this._outJobs;if(a.has(r)){var s=a.get(r);a.delete(r),null==(t=s.abortHandle)||t.remove(),i?s.reject(c.a.fromJSON(JSON.parse(i))):s.resolve(n)}}_update(e){for(;!e.done&&this._messageQueue.length>0;)this._processMessage(this._messageQueue.shift()),e.madeProgress()}_post(e,t,r){return y(this._port,e,t,r)}}P.kernelInfo={revision:u.b,version:p.d,buildDate:u.a},P.clients=new Map;var C=P,I=r(81),A=r(217),R=I.a.getLogger("esri.core.workers.Connection");var F=class{constructor(){this._clients=new Array,this._clientPromises=new Array,this._clientIdx=0}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(e,t){var r=this;return new Promise(((i,n)=>{var a=!0,s=e=>{Object(l.u)(t.signal),a&&(a=!1,e())};this._clients.length=e.length,this._clientPromises.length=e.length;for(var o=function(a){var o=e[a];Object(l.o)(o)?r._clientPromises[a]=o.then((e=>(r._clients[a]=new C(e,t),s(i),r._clients[a])),(()=>(s(n),null))):(r._clients[a]=new C(o,t),r._clientPromises[a]=Promise.resolve(r._clients[a]),s(i))},c=0;c<e.length;++c)o(c)}))}broadcast(e,t,r){for(var i=new Array(this._clientPromises.length),n=0;n<this._clientPromises.length;++n){var a=this._clientPromises[n];i[n]=a.then((i=>i.invoke(e,t,r)))}return i}close(){for(var e of this._clientPromises)e.then((e=>e.close()));this._clients.length=0,this._clientPromises.length=0}getAvailableClient(){for(var e,t=0;t<this._clients.length;++t){var r=this._clients[t];if(r){if(!r.isBusy())return Promise.resolve(r)}else(e=e||[]).push(this._clientPromises[t])}return e?Promise.race(e):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))}invoke(e,t,r){var i=null;return Array.isArray(r)?(R.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),i={transferList:r}):i=r,this.closed?Promise.reject(new Error("Connection closed")):this.getAvailableClient().then((r=>r.invoke(e,t,i)))}on(e,t){return Promise.all(this._clientPromises).then((()=>Object(A.b)(this._clients.map((r=>r.on(e,t))))))}openPorts(){var e=this;return new Promise((t=>{for(var r=new Array(this._clientPromises.length),i=r.length,n=function(n){e._clientPromises[n].then((e=>{r[n]=e.openPort(),0==--i&&t(r)}))},a=0;a<this._clientPromises.length;++a)n(a)}))}get test(){return{numClients:this._clients.length}}},L=r(159),D=r(83),k=r(148),z=r(162),V=(r(171),{});var N=function(e){var t,r={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:Object(a.a)({},e.has),map:Object(a.a)({},e.map),packages:e.packages&&e.packages.concat()||[],paths:Object(a.a)({},e.paths)};return e.hasOwnProperty("async")||(r.async=!0),e.hasOwnProperty("isDebug")||(r.isDebug=!1),e.baseUrl||(r.baseUrl=V.baseUrl),null==(t=V.packages)||t.forEach((e=>{!function(e,t){for(var r of e)if(r.name===t.name)return;e.push(t)}(r.packages,e)})),r},U=r(158);class B{constructor(){var e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((t=>{this[t]=(...r)=>e[t](...r)}))}}var q=U.a.MutationObserver||U.a.WebKitMutationObserver,G=function(){var e;if(U.a.process&&U.a.process.nextTick)e=e=>{U.a.process.nextTick(e)};else if(U.a.Promise)e=e=>{U.a.Promise.resolve().then(e)};else if(q){var t=[],r=document.createElement("div");new q((()=>{for(;t.length>0;)t.shift()()})).observe(r,{attributes:!0}),e=e=>{t.push(e),r.setAttribute("queueStatus","1")}}return e}(),H=(()=>{var e=U.a.MessageEvent;try{new e("message",{data:null})}catch(t){return(e,t={})=>{var{data:r,bubbles:i=!1,cancelable:n=!1}=t,a=document.createEvent("Event");return a.initEvent(e,i,n),a.data=r,a}}return(t,r)=>new e(t,r)})();var W=class{constructor(){this._dispatcher=new B,this._workerPostMessage({type:i.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){G((()=>{this._workerMessageHandler(H("message",{data:e}))}))}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,t,r){this._dispatcher.addEventListener(e,t,r)}removeEventListener(e,t,r){this._dispatcher.removeEventListener(e,t,r)}_workerPostMessage(e){G((()=>{this.dispatchEvent(H("message",{data:e}))}))}_workerMessageHandler(e){var t=this;return Object(s.a)((function*(){var r=O(e);if(r&&r.type===i.OPEN){var{modulePath:n,jobId:a}=r,s=yield C.loadWorker(n);s||(s=yield import(n));var o=C.connect(s);t._workerPostMessage({type:i.OPENED,jobId:a,data:o})}}))()}},J=I.a.getLogger("esri.core.workers");o.a.add("esri-workers-arraybuffer-transfer",!Object(o.a)("safari")||Object(o.a)("safari")>=12);var Z,X,{HANDSHAKE:Y}=i,Q='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});',K="Failed to create Worker. Fallback to execute module in main thread";function $(){return($=Object(s.a)((function*(){if(!Object(o.a)("esri-workers"))return ee(new W);if(!Z&&!X)try{var e=Q.replace('"{CONFIGURATION}"',"'".concat(re(),"'"));Z=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(r){X=r||{}}var t;if(Z)try{t=new Worker(Z,{name:"esri-worker-"+ie++})}catch(r){J.warn(K,X),t=new W}else J.warn(K,X),t=new W;return ee(t)}))).apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(s.a)((function*(e){return new Promise((t=>{function r(n){var a=O(n);a&&a.type===Y&&(e.removeEventListener("message",r),e.removeEventListener("error",i),t(e))}function i(t){t.preventDefault(),e.removeEventListener("message",r),e.removeEventListener("error",i),J.warn("Failed to create Worker. Fallback to execute module in main thread",t),(e=new W).addEventListener("message",r),e.addEventListener("error",i)}e.addEventListener("message",r),e.addEventListener("error",i)}))}))).apply(this,arguments)}function re(){var e;if(null!=L.a.default){var t=Object(a.a)({},L.a);delete t.default,e=JSON.parse(JSON.stringify(t))}else e=JSON.parse(JSON.stringify(L.a));e.assetsPath=Object(D.z)(e.assetsPath),e.request.interceptors=[],e.log.interceptors=[],e.locale=Object(k.b)(),e.has={"csp-restrictions":Object(o.a)("csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Object(o.a)("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":Object(o.a)("esri-2d-query-centroid-enabled"),"featurelayer-pbf":Object(o.a)("featurelayer-pbf"),"featurelayer-snapshot-point-threshold":Object(o.a)("featurelayer-snapshot-point-threshold"),"esri-atomics":Object(o.a)("esri-atomics"),"esri-shared-array-buffer":Object(o.a)("esri-shared-array-buffer"),"esri-tiles-debug":Object(o.a)("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Object(o.a)("esri-workers-arraybuffer-transfer"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=Object(D.z)(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Object(D.z)(e.workers.workerPath):e.workers.workerPath=Object(D.z)(Object(z.a)("esri/core/workers/RemoteClient.js"));var r=L.a.workers.loaderConfig,i=N({baseUrl:null==r?void 0:r.baseUrl,locale:Object(k.b)(),has:Object(a.a)({"csp-restrictions":Object(o.a)("csp-restrictions"),"dojo-test-sniff":0,"host-webworker":1},null==r?void 0:r.has),map:Object(a.a)({},null==r?void 0:r.map),paths:Object(a.a)({},null==r?void 0:r.paths),packages:(null==r?void 0:r.packages)||[]}),n={version:p.d,buildDate:u.a,revision:u.b};return JSON.stringify({esriConfig:e,loaderConfig:i,kernelInfo:n})}var ie=0,ne=I.a.getLogger("esri.core.workers"),{ABORT:ae,INVOKE:se,OPEN:oe,OPENED:ce,RESPONSE:le}=i;class ue{constructor(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",(e=>{e.preventDefault(),ne.error(e)}))}static create(e){return Object(s.a)((function*(){var t=yield function(){return $.apply(this,arguments)}();return new ue(t,e)}))()}terminate(){this.worker.terminate()}open(e,t={}){var r=this;return Object(s.a)((function*(){var{signal:i}=t,n=v();return new Promise(((t,a)=>{var s={resolve:t,reject:a,abortHandle:Object(l.q)(i,(()=>{r._outJobs.delete(n),r._post({type:ae,jobId:n})}))};r._outJobs.set(n,s),r._post({type:oe,jobId:n,modulePath:e})}))}))()}_onMessage(e){var t=O(e);if(t)switch(t.type){case ce:this._onOpenedMessage(t);break;case le:this._onResponseMessage(t);break;case ae:this._onAbortMessage(t);break;case se:this._onInvokeMessage(t)}}_onAbortMessage(e){var t=this._inJobs,r=e.jobId,i=t.get(r);i&&(i.controller&&i.controller.abort(),t.delete(r))}_onInvokeMessage(e){var t,{methodName:r,jobId:i,data:n,abortable:a}=e,s=a?Object(l.d)():null,o=this._inJobs,c=p.e[r];try{if("function"!=typeof c)throw new TypeError("".concat(r," is not a function"));t=c.call(null,n,{signal:s?s.signal:null})}catch(u){return void this._post({type:le,jobId:i,error:g(u)})}Object(l.o)(t)?(o.set(i,{controller:s,promise:t}),t.then((e=>{o.has(i)&&(o.delete(i),this._post({type:le,jobId:i},e))}),(e=>{o.has(i)&&(o.delete(i),e||(e={message:"Error encountered at method"+r}),Object(l.m)(e)||this._post({type:le,jobId:i,error:g(e||{message:"Error encountered at method ".concat(r)})}))}))):this._post({type:le,jobId:i},t)}_onOpenedMessage(e){var t,{jobId:r,data:i}=e,n=this._outJobs.get(r);n&&(this._outJobs.delete(r),null==(t=n.abortHandle)||t.remove(),n.resolve(i))}_onResponseMessage(e){var t,{jobId:r,error:i,data:n}=e,a=this._outJobs.get(r);a&&(this._outJobs.delete(r),null==(t=a.abortHandle)||t.remove(),i?a.reject(c.a.fromJSON(JSON.parse(i))):a.resolve(n))}_post(e,t,r){return y(this.worker,e,t,r)}}var de=ue,he=Object(o.a)("esri-workers-debug")?1:Object(o.a)("host-browser")?navigator.hardwareConcurrency-1:0;he||(he=Object(o.a)("safari")&&Object(o.a)("mac")||Object(o.a)("trident")?7:2);var pe=0,fe=[];function be(){_e()}function me(e,t){return ve(e,{client:t})}function ve(e,t){return ge.apply(this,arguments)}function ge(){return(ge=Object(s.a)((function*(e,t){var r=new F;return yield r.open(e,t),r}))).apply(this,arguments)}function ye(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(s.a)((function*(e,t={}){if("string"!=typeof e)throw new c.a("workers:undefined-module","modulePath is missing");var r=t.strategy||"distributed";if(Object(o.a)("host-webworker")&&!Object(o.a)("esri-workers")&&(r="local"),"local"===r){var i=yield C.loadWorker(e);i||(i=yield import(e)),Object(l.u)(t.signal);var n=t.client||i;return ve([C.connect(i)],Object(a.a)(Object(a.a)({},t),{},{client:n}))}if(yield _e(),Object(l.u)(t.signal),"dedicated"===r){var s=pe++%he;return ve([yield fe[s].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){var u=Math.min(t.maxNumWorkers,he);if(u<he){for(var d=new Array(u),h=0;h<u;++h){var p=pe++%he;d[h]=fe[p].open(e,t)}return ve(d,t)}}return ve(fe.map((r=>r.open(e,t))),t)}))).apply(this,arguments)}var je=null;function _e(){return we.apply(this,arguments)}function we(){return(we=Object(s.a)((function*(){if(je)return je;Object(l.d)();for(var e=[],t=function(t){var r=de.create(t).then((e=>(fe[t]=e,e)));e.push(r)},r=0;r<he;r++)t(r);return je=Promise.all(e)}))).apply(this,arguments)}},,function(e,t,r){"use strict";r.r(t),r.d(t,"getAllSizes",(function(){return x})),r.d(t,"getColor",(function(){return f})),r.d(t,"getOpacity",(function(){return b})),r.d(t,"getRotationAngle",(function(){return m})),r.d(t,"getSize",(function(){return v})),r.d(t,"getSizeForValue",(function(){return O})),r.d(t,"getSizeFromNumberOrVariable",(function(){return g})),r.d(t,"getSizeRangeAtScale",(function(){return j})),r.d(t,"getVisualVariableValues",(function(){return _})),r.d(t,"viewScaleRE",(function(){return p}));var i=r(180),n=r(89),a=r(81),s=r(109),o=r(123),c=r(193),l=r(233),u=a.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),d=new o.a,h=Math.PI,p=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function f(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"color"===e.type))[0]:e;if(i)if("esri.renderers.visualVariables.ColorVariable"===i.declaredClass){var a="number"==typeof t,o=a?null:t,c=o&&o.attributes,l=a?t:null,d=i.field,{ipData:h,hasExpression:p}=i.cache,f=i.cache.compiledFunc;if(!d&&!p){var b=i.stops;return b&&b[0]&&b[0].color}if("number"!=typeof l)if(p){if(!Object(n.k)(r)||!Object(n.k)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var m={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,g=v.getViewInfo(m),y=v.createExecContext(o,g);if(!f){var O=v.createSyntaxTree(i.valueExpression);f=v.createFunction(O),i.cache.compiledFunc=f}l=v.executeFunction(f,y)}else c&&(l=c[d]);var j=i.normalizationField,_=c?parseFloat(c[j]):void 0;if(null!=l&&(!j||a||!isNaN(_)&&0!==_)){isNaN(_)||a||(l/=_);var x=w(l,h);if(x){var S=x[0],M=x[1],T=S===M?i.stops[S].color:s.a.blendColors(i.stops[S].color,i.stops[M].color,x[2],Object(n.k)(r)?r.color:void 0);return new s.a(T)}}}else u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function b(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"opacity"===e.type))[0]:e;if(i)if("esri.renderers.visualVariables.OpacityVariable"===i.declaredClass){var a="number"==typeof t,s=a?null:t,o=s&&s.attributes,c=a?t:null,l=i.field,{ipData:d,hasExpression:h}=i.cache,p=i.cache.compiledFunc;if(!l&&!h){var f=i.stops;return f&&f[0]&&f[0].opacity}if("number"!=typeof c)if(h){if(Object(n.j)(r)||Object(n.j)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var b={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,v=m.getViewInfo(b),g=m.createExecContext(s,v);if(!p){var y=m.createSyntaxTree(i.valueExpression);p=m.createFunction(y),i.cache.compiledFunc=p}c=m.executeFunction(p,g)}else o&&(c=o[l]);var O=i.normalizationField,j=o?parseFloat(o[O]):void 0;if(null!=c&&(!O||a||!isNaN(j)&&0!==j)){isNaN(j)||a||(c/=j);var _=w(c,d);if(_){var x=_[0],S=_[1];if(x===S)return i.stops[x].opacity;var M=i.stops[x].opacity;return M+(i.stops[S].opacity-M)*_[2]}}}else u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function m(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"rotation"===e.type))[0]:e;if(i){if("esri.renderers.visualVariables.RotationVariable"===i.declaredClass){var a=i.axis||"heading",s="heading"===a&&"arithmetic"===i.rotationType?90:0,o="heading"===a&&"arithmetic"===i.rotationType?-1:1,c="number"==typeof t?null:t,l=c&&c.attributes,d=i.field,{hasExpression:h}=i.cache,p=i.cache.compiledFunc,f=0;if(!d&&!h)return f;if(h){if(Object(n.j)(r)||Object(n.j)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var b={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,v=m.getViewInfo(b),g=m.createExecContext(c,v);if(!p){var y=m.createSyntaxTree(i.valueExpression);p=m.createFunction(y),i.cache.compiledFunc=p}f=m.executeFunction(p,g)}else l&&(f=l[d]||0);return f="number"!=typeof f||isNaN(f)?null:s+o*f}u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function v(e,t,r){var i="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"size"===e.type))[0]:e;if(i){if("esri.renderers.visualVariables.SizeVariable"===i.declaredClass){var a=O(function(e,t,r){var i="number"==typeof t,a=i?null:t,s=a&&a.attributes,o=i?t:null,{isScaleDriven:c}=e.cache,d=e.cache.compiledFunc;if(c){var h=Object(n.k)(r)?r.scale:void 0,p=Object(n.k)(r)?r.view:void 0;o=null==h||"3d"===p?function(e){var t=null,r=null,i=e.stops;return i?(t=i[0].value,r=i[i.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):h}else if(!i)switch(e.inputValueType){case"expression":if(Object(n.j)(r)||Object(n.j)(r.arcade))return void u.error("Use of arcade expressions requires an arcade context");var f={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,m=b.getViewInfo(f),v=b.createExecContext(a,m);if(!d){var g=b.createSyntaxTree(e.valueExpression);d=b.createFunction(g),e.cache.compiledFunc=d}o=b.executeFunction(d,v);break;case"field":s&&(o=s[e.field]);break;case"unknown":o=null}if(!Object(l.d)(o))return null;if(i||!e.normalizationField)return o;var y=s?parseFloat(s[e.normalizationField]):null;return Object(l.d)(y)&&0!==y?o/y:null}(i,t,r),i,t,r,i.cache.ipData);return null==a||isNaN(a)?0:a}u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function g(e,t,r){return null==e?null:Object(l.c)(e)?v(e,t,r):Object(l.d)(e)?e:null}function y(e,t,r){return Object(l.d)(r)&&e>r?r:Object(l.d)(t)&&e<t?t:e}function O(e,t,r,i,a){switch(t.transformationType){case"additive":return function(e,t,r,i){return e+(g(t.minSize,r,i)||t.minDataValue)}(e,t,r,i);case"constant":return function(e,t,r){var i=e.stops,n=i&&i.length&&i[0].size;return null==n&&(n=e.minSize),g(n,t,r)}(t,r,i);case"clamped-linear":return function(e,t,r,i){var a=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),s=g(t.minSize,r,i),o=g(t.maxSize,r,i),c=Object(n.k)(i)?i.shape:void 0;if(e<=t.minDataValue)return s;if(e>=t.maxDataValue)return o;if("area"===t.scaleBy&&c){var l="circle"===c,u=l?h*Math.pow(s/2,2):s*s,d=u+a*((l?h*Math.pow(o/2,2):o*o)-u);return l?2*Math.sqrt(d/h):Math.sqrt(d)}return s+a*(o-s)}(e,t,r,i);case"proportional":return function(e,t,r,i){var a=Object(n.k)(i)?i.shape:void 0,s=e/t.minDataValue,o=g(t.minSize,r,i),c=g(t.maxSize,r,i);return y("circle"===a?2*Math.sqrt(s*Math.pow(o/2,2)):"square"===a||"diamond"===a||"image"===a?Math.sqrt(s*Math.pow(o,2)):s*o,o,c)}(e,t,r,i);case"stops":return function(e,t,r,i,n){var[a,s,o]=w(e,n);if(a===s)return g(t.stops[a].size,r,i);var c=g(t.stops[a].size,r,i);return c+(g(t.stops[s].size,r,i)-c)*o}(e,t,r,i,a);case"real-world-size":return function(e,t,r,i){var a=(Object(n.k)(i)&&i.resolution?i.resolution:1)*c.a[t.valueUnit],s=g(t.minSize,r,i),o=g(t.maxSize,r,i),{valueRepresentation:l}=t;return y("area"===l?2*Math.sqrt(e/h)/a:"radius"===l||"distance"===l?2*e/a:e/a,s,o)}(e,t,r,i);case"identity":return e;case"unknown":return null}}function j(e,t,r){var{isScaleDriven:i}=e.cache;if(!(i&&"3d"===r||t))return null;var n={scale:t,view:r},a=g(e.minSize,d,n),s=g(e.maxSize,d,n);if(null!=a||null!=s){if(a>s){var o=s;s=a,a=o}return{minSize:a,maxSize:s}}}function _(e,t,r){if(e.visualVariables){var i=[],n=[],a=[],s=[],o=[];for(var c of e.visualVariables)switch(c.type){case"color":n.push(c);break;case"opacity":a.push(c);break;case"rotation":o.push(c);break;case"size":s.push(c)}return n.forEach((e=>{var n=f(e,t,r);i.push({variable:e,value:n})})),a.forEach((e=>{var n=b(e,t,r);i.push({variable:e,value:n})})),o.forEach((e=>{var n=m(e,t,r);i.push({variable:e,value:n})})),s.forEach((e=>{var n=v(e,t,r);i.push({variable:e,value:n})})),i.filter((e=>null!=e.value))}}function w(e,t){if(t){var r=0,i=t.length-1;return t.some(((t,n)=>e<t?(i=n,!0):(r=n,!1))),[r,i,(e-t[r])/(t[i]-t[r])]}}function x(e,t,r){var n=["proportional","proportional","proportional"];for(var a of e){var s=a.useSymbolValue?"symbol-value":v(a,t,r);switch(a.axis){case"width":n[0]=s;break;case"depth":n[1]=s;break;case"height":n[2]=s;break;case"width-and-depth":n[0]=s,n[1]=s;break;case"all":case void 0:case null:n[0]=s,n[1]=s,n[2]=s;break;default:Object(i.a)(a.axis)}}return n}},function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(81),r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(90)),c=r(109),l=i=class extends o.a{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new i({color:this.color,ratio:this.ratio})}};Object(n.a)([Object(a.b)({type:c.a,json:{write:!0}})],l.prototype,"color",void 0),Object(n.a)([Object(a.b)({type:Number,json:{write:!0}})],l.prototype,"ratio",void 0);var u=l=i=Object(n.a)([Object(s.a)("esri.renderers.support.HeatmapColorStop")],l);t.a=u},function(e,t,r){"use strict";r.d(t,"a",(function(){return T})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return _})),r.d(t,"f",(function(){return M})),r.d(t,"g",(function(){return s})),r.d(t,"h",(function(){return c})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return o})),r.d(t,"k",(function(){return w})),r.d(t,"l",(function(){return a})),r.d(t,"m",(function(){return g})),r.d(t,"n",(function(){return S})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return v})),r.d(t,"q",(function(){return j})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return y})),r.d(t,"t",(function(){return f}));var i=r(89);r(103),r(125);function n(e=E){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function a(e,t,r,i,a,s,o=n()){return o[0]=e,o[1]=t,o[2]=r,o[3]=i,o[4]=a,o[5]=s,o}function s(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function o(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function c(e,t,r=0,i=t.length/3){for(var n=e[0],a=e[1],s=e[2],o=e[3],c=e[4],l=e[5],u=0;u<i;u++)n=Math.min(n,t[r+3*u]),a=Math.min(a,t[r+3*u+1]),s=Math.min(s,t[r+3*u+2]),o=Math.max(o,t[r+3*u]),c=Math.max(c,t[r+3*u+1]),l=Math.max(l,t[r+3*u+2]);e[0]=n,e[1]=a,e[2]=s,e[3]=o,e[4]=c,e[5]=l}function l(e,t,r){var i=t.length,n=e[0],a=e[1],s=e[2],o=e[3],c=e[4],l=e[5];if(r)for(var u=0;u<i;u++){var d=t[u];n=Math.min(n,d[0]),a=Math.min(a,d[1]),s=Math.min(s,d[2]),o=Math.max(o,d[0]),c=Math.max(c,d[1]),l=Math.max(l,d[2])}else for(var h=0;h<i;h++){var p=t[h];n=Math.min(n,p[0]),a=Math.min(a,p[1]),o=Math.max(o,p[0]),c=Math.max(c,p[1])}e[0]=n,e[1]=a,e[2]=s,e[3]=o,e[4]=c,e[5]=l}function u(e){return e[0]>=e[3]?0:e[3]-e[0]}function d(e){return e[1]>=e[4]?0:e[4]-e[1]}function h(e){return e[2]>=e[5]?0:e[5]-e[2]}function p(e,t=[0,0,0]){return t[0]=e[0]+u(e)/2,t[1]=e[1]+d(e)/2,t[2]=e[2]+h(e)/2,t}function f(e,t=[0,0,0]){return t[0]=u(e),t[1]=d(e),t[2]=h(e),t}function b(e){return Math.max(u(e),h(e),d(e))}function m(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function v(e,t,r=e){var i=e[0]+u(e)/2,n=e[1]+d(e)/2,a=e[2]+h(e)/2;return r[0]=i+(e[0]-i)*t,r[1]=n+(e[1]-n)*t,r[2]=a+(e[2]-a)*t,r[3]=i+(e[3]-i)*t,r[4]=n+(e[4]-n)*t,r[5]=a+(e[5]-a)*t,r}function g(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function y(e,t,r=e){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function O(e,t,r=e){return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function j(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function _(e){return e?j(e,T):n(T)}function w(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function x(e){return 6===e.length}function S(e){return 0===u(e)&&0===d(e)&&0===h(e)}function M(e,t,r){if(Object(i.j)(e)||Object(i.j)(t))return e===t;if(!x(e)||!x(t))return!1;if(r){for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var T=[1/0,1/0,1/0,-1/0,-1/0,-1/0],E=[0,0,0,0,0,0];n()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var i,n=r(120),a=r(119);function s(e,t){e.fragment.uniforms.add("terrainDepthTexture","sampler2D"),e.fragment.uniforms.add("cameraNearFar","vec2"),e.fragment.uniforms.add("inverseViewport","vec2"),e.fragment.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    //Compare the linearized depths of the fragment and the terrain. If fragment is on the wrong side of the terrain, discard it.\n    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){\n\n      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);\n      if(fragmentDepth "," terrainDepth){\n        discard;\n      }\n    }\n  "])),t.cullAboveGround?">":"<="))}function o(e,t,r){r.multipassTerrainEnabled&&r.terrainLinearDepthTexture&&(e.setUniform1i("terrainDepthTexture",10),t.bindTexture(r.terrainLinearDepthTexture,10))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return l}));var i=[252,146,31,255],n={type:"esriSMS",style:"esriSMSCircle",size:6,color:i,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},a={type:"esriSLS",style:"esriSLSSolid",width:.75,color:i},s={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},o={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},c={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},l={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},u={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return i}));var i,n,a=r(82),s=(r(80),r(89)),o=r(81),c=(r(88),r(85)),l=r(84),u=(r(83),r(86),r(87),r(343)),d=r(176),h=r(94),p=r(97),f=r(108),b=r(323),m=r(331),v=o.a.getLogger("esri.views.support.Scheduler");(n=i||(i={})).REMOTE_CLIENT="worker messages",n.SLIDE="slide",n.STAGE="stage",n.STREAM_DATA_LOADER="stream loader",n.ELEVATION_QUERY="elevation query",n.TERRAIN_SURFACE="terrain",n.SURFACE_GEOMETRY_UPDATES="surface geometry updates",n.GRAPHICS_CORE="Graphics3D",n.I3S_CONTROLLER="I3S",n.POINT_CLOUD_LAYER="point cloud",n.FEATURE_TILE_FETCHER="feature fetcher",n.LABELER="labeler",n.GRAPHICS_DECONFLICTOR="graphics deconflictor",n.FILTER_VISIBILITY="Graphics3D filter visibility",n.FEATURE_QUERY_ENGINE="feature query",n.SCALE_VISIBILITY="Graphics3D scale visibility",n.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",n.POINT_OF_INTEREST_FREQUENT="POI frequent",n.POINT_OF_INTEREST_INFREQUENT="POI infrequent",n.FEATURE_TILE_TREE="feature tile tree",n.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",n.ELEVATION_ALIGNMENT="elevation alignment",n.TEXT_TEXTURE_ATLAS="text texture atlas",n.TEXTURE_UNLOAD="texture unload",n.OVERLAY_MANAGER="overlay manager",n.LINE_OF_SIGHT_TOOL="line of sight tool",n.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",n.ELEVATION_PROFILE="elevation profile",n.SNAPPING="snapping",n[n.TEST_PRIO=1]="TEST_PRIO";var g={[i.REMOTE_CLIENT]:0,[i.SLIDE]:0,[i.STREAM_DATA_LOADER]:0,[i.ELEVATION_QUERY]:0,[i.STAGE]:1,[i.TERRAIN_SURFACE]:1,[i.SURFACE_GEOMETRY_UPDATES]:1,[i.GRAPHICS_CORE]:2,[i.I3S_CONTROLLER]:2,[i.POINT_CLOUD_LAYER]:2,[i.FEATURE_TILE_FETCHER]:2,[i.LABELER]:8,[i.GRAPHICS_DECONFLICTOR]:4,[i.FILTER_VISIBILITY]:4,[i.FEATURE_QUERY_ENGINE]:8,[i.SCALE_VISIBILITY]:4,[i.FRUSTUM_VISIBILITY]:4,[i.POINT_OF_INTEREST_FREQUENT]:6,[i.POINT_OF_INTEREST_INFREQUENT]:30,[i.FEATURE_TILE_TREE]:16,[i.FEATURE_TILE_TREE_ACTIVE]:0,[i.ELEVATION_ALIGNMENT]:12,[i.TEXT_TEXTURE_ATLAS]:12,[i.TEXTURE_UNLOAD]:12,[i.OVERLAY_MANAGER]:12,[i.LINE_OF_SIGHT_TOOL]:16,[i.LINE_OF_SIGHT_TOOL_INTERACTIVE]:0,[i.SNAPPING]:0};function y(e){return e in g?g[e]:"number"==typeof e?e:1}var O,j,_=1e3/30;!function(e){var t=class extends p.a{constructor(e){for(var t in super(e),this.updating=!0,this.performanceInfo={total:new u.a("total"),tasks:new Array},this._budget=null,this._state=1,this._tasks=new d.a,this._runQueue=new d.a,this._load=0,this._idleStateCallbacks=new d.a,this._idleUpdatesStartFired=!1,this._maxReschedule=S,this._forceTask=!1,this._debug=!1,this._debugHandle=Object(f.a)(m.a,"SCHEDULER_LOG_SLOW_TASKS",(e=>this._debug=e)),this._budget=new n(e.nowFunc),T.length=0,i)M.set(i[t],this.performanceInfo.tasks.length),this.performanceInfo.tasks.push(new u.a(i[t])),T.push(0);var r,a=this;this._test={get state(){return Object(s.j)(r)?a._state:r},set state(e){r=e},FRAME_SAFETY_BUDGET:6.5,INTERACTING_BUDGET:_,IDLE_BUDGET:100,get budget(){return a._budget.budget},usedBudget:0,updateTask:e=>this._updateTask(e),getState:e=>this._getState(e),getRuntime:e=>this._getRuntime(e),resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._debugHandle&&this._debugHandle.remove()}registerTask(e,t,i){var n=y(e),a=new r(this,e,t,i,n);return this._tasks.push(a),a}registerIdleStateCallbacks(e,t){var r={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(r),2===this.state&&this._idleUpdatesStartFired&&r.idleBegin();var i=this;return{remove:()=>this._removeIdleStateCallbacks(r),set idleBegin(e){i._idleUpdatesStartFired&&(r.idleEnd(),2===i._state&&e()),r.idleBegin=e},set idleEnd(e){r.idleEnd=e}}}get now(){return this.nowFunc()}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return Object(s.j)(this._test.state)?this._state:this._test.state}updateBudget(e){this._test.usedBudget=0;var t=6.5,r=e.frameDuration,i=1;switch(this.state){case 2:t=0,r=Math.max(100,e.frameDuration),i=30;break;case 1:r=Math.max(_,e.frameDuration)}return r-=e.elapsedFrameTime+t,2!==this.state&&r<1&&!this._forceTask?(this._forceTask=!0,!1):(r=Math.max(r,i),this._budget.reset(r,this.state),this._maxReschedule=S,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e)}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return j.SCHEDULED;var t=j.IDLE;return this._tasks.forAll((r=>{r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?t=j.READY:t!==j.READY&&(t=j.WAITING))})),t}_getRuntime(e){var t=0;return this._tasks.forAll((r=>{r.name===e&&(t+=r.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){var e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;var t="";return e.forEach(((e,r)=>{t+=e>1?" ".concat(e,"x ").concat(r):" ".concat(r)})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){var e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){var e=this;if(this._maxReschedule<=0)return!1;var t=function(){var t=!1,r=0;if(e._tasks.forAll((i=>{if(i.needsUpdate&&0!==i.schedulePriority&&0!==i.priority)switch(t=!0,r=Math.max(r,i.priority),i.schedulePriority){case 1:i.schedulePriority=0,e._runQueue.push(i);break;default:--i.schedulePriority}})),!t)return{v:(e.updating=!1,!1)};e._maxReschedule===S&&(e._maxReschedule=r),--e._maxReschedule};for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.priority,!1))),this._tasks.forAll((e=>{0===e.priority&&e.needsUpdate&&!this._runQueue.some((t=>t===e))&&this._runQueue.unshift(e)}));0===this._runQueue.length;){var r=t();if("object"===typeof r)return r.v}return this.updating=!0,!0}_run(){for(var e=this._budget.now(),t=0;t<T.length;++t)T[t]=0;do{for(;this._runQueue.length>0;){var r=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.update(this._budget)}catch(a){v.error('Exception in task "'.concat(i.name,'"'),a)}i.schedulePriority=i.priority;var n=this._budget.now()-r;if(i.runtime+=n,T[M.get(i.task)]+=n,this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",i.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(T,this._budget.now()-e)}}while(this._schedule());this._recordFrameTaskTimes(T,this._budget.now()-e)}_recordFrameTaskTimes(e,t){for(var r=0;r<e.length;++r)this.performanceInfo.tasks[r].record(e[r]);this.performanceInfo.total.record(t)}get test(){return this._test}};Object(a.a)([Object(c.b)()],t.prototype,"updating",void 0),Object(a.a)([Object(c.b)()],t.prototype,"nowFunc",void 0),t=Object(a.a)([Object(l.a)("esri.views.support.Scheduler")],t),e.Scheduler=t;var r=class extends p.a{constructor(e,t,r,i,n){super({}),this._scheduler=e,this.name=t,this.update=r,this._needsUpdateCB=i,this._priority=n,this.runtime=0,this._queue=new b.a,this.updating=!1,this.schedulePriority=this._priority}normalizeCtorArgs(){return{}}remove(){this.processQueue(w),this._scheduler.removeTask(this),this.schedule=x.schedule,this.reschedule=x.reschedule}get priority(){return this._priority}setPriority(e){this.name=e;var t=y(e);0!==this._priority&&0===this.schedulePriority||(this.schedulePriority=t),this._priority=t}get task(){return this.name}set task(e){this.setPriority(e)}get needsUpdate(){return this.updating||this._needsUpdateCB()}schedule(e,t){return this.updating=!0,this._queue.push(e,t)}reschedule(e,t){return this.updating=!0,this._queue.unshift(e,t)}processQueue(e){for(;!e.done&&this._queue.process();)e.madeProgress();this.updating=this._queue.length>0}};Object(a.a)([Object(c.b)()],r.prototype,"updating",void 0),r=Object(a.a)([Object(l.a)("esri.views.support.SchedulerTask")],r);class n{constructor(e){this.now=e,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&(this._didWork=!0),!0)}get done(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}get budget(){return this._budget}madeProgress(){this._didWork=!0}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this._didWork=!1}get remaining(){return Math.max(this._budget-this.elapsed,0)}get elapsed(){return this.now()-this._begin}resetProgress(){this._didWork=!1}get hasProgressed(){return this._didWork}}e.Budget=n}(O||(O={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(j||(j={}));var w=(()=>{var e=new O.Budget((()=>performance.now()));return e.enabled=!1,e})();var x=new class{remove(){}processQueue(){}schedule(e){return Object(h.w)(e())}reschedule(e){return Object(h.w)(e())}},S=Number.MAX_SAFE_INTEGER,M=new Map,T=new Array},,,function(e,t,r){"use strict";class i{constructor(e=null,t={},r,i){this.displayId=0,this.geohashX=0,this.geohashY=0,this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=i&&(this.objectId=i)}get hasGeometry(){return!(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){var e=new i(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}t.a=i},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(82),n=r(89),a=r(240),s=r(85),o=r(84),c=r(241),l=r(344),u=r(97),d=r(115),h=r(108),p=class extends u.a{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new d.a,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(e,t,r,i=0){var n=0!=(1&i),a=++this.handleId;n||this.installSyncUpdatingWatch(e,t,a);var s=0!=(2&i)?Object(h.a)(e,t,r,n):e.watch(t,r,n);return this.handles.add(s,a),{remove:()=>{this.handles.remove(a)}}}addOnCollectionPropertyChange(e,t,r,i=0){var n=0!=(2&i),a=++this.handleId;return this.handles.add([Object(h.b)(e,t,"after-changes",this.createSyncUpdatingCallback()),Object(h.b)(e,t,"change",r,n?e=>{r({added:e.items,removed:[],moved:[],target:e})}:void 0)],a),{remove:()=>{this.handles.remove(a)}}}addOnCollectionChange(e,t,r=0){var i=0!=(2&r),n=++this.handleId;return this.handles.add([e.on("after-changes",this.createSyncUpdatingCallback()),e.on("change",t)],n),i&&t({added:e.items,removed:[],moved:[],target:e}),{remove:()=>{this.handles.remove(n)}}}addPromise(e){if(Object(n.j)(e))return e;var t=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(f)||this._set("updating",!1))}},t),this.pendingPromises.add(e),this._set("updating",!0);var r=()=>this.handles.remove(t);return e.then(r,r),e}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}installSyncUpdatingWatch(e,t,r){var i=this.createSyncUpdatingCallback(),n=Object(l.a)((()=>Object(a.c)(e,t)),i);return this.handles.add(n,r),n}createSyncUpdatingCallback(){return()=>{this.handles.remove(f),++this.scheduleHandleId;var e=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add(Object(c.b)((()=>{e===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove(f))})),f)}}};Object(i.a)([Object(s.b)({readOnly:!0})],p.prototype,"updating",void 0),p=Object(i.a)([Object(o.a)("esri.views.support.WatchUpdatingTracking")],p);var f=-42},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(92)),a=(r(81),r(88),r(85)),s=r(98),o=r(84),c=r(96),l=(r(83),r(86),r(87),r(90)),u=r(134),d=r(136),h=r(137),p=(r(149),r(251)),f=class extends l.a{constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];switch(i.type){case"range":t[r]=h.a.fromJSON(i);break;case"codedValue":t[r]=u.a.fromJSON(i);break;case"inherited":t[r]=d.a.fromJSON(i)}}return t}writeDomains(e,t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]&&e[i].toJSON());Object(n.c)(r),t.domains=r}readTemplates(e){return e&&e.map((e=>new p.a(e)))}writeTemplates(e,t){t.templates=e&&e.map((e=>e.toJSON()))}};Object(i.a)([Object(a.b)({json:{write:!0}})],f.prototype,"id",void 0),Object(i.a)([Object(a.b)({json:{write:!0}})],f.prototype,"name",void 0),Object(i.a)([Object(a.b)({json:{write:!0}})],f.prototype,"domains",void 0),Object(i.a)([Object(s.a)("domains")],f.prototype,"readDomains",null),Object(i.a)([Object(c.a)("domains")],f.prototype,"writeDomains",null),Object(i.a)([Object(a.b)({json:{write:!0}})],f.prototype,"templates",void 0),Object(i.a)([Object(s.a)("templates")],f.prototype,"readTemplates",null),Object(i.a)([Object(c.a)("templates")],f.prototype,"writeTemplates",null);var b=f=Object(i.a)([Object(o.a)("esri.layers.support.FeatureType")],f);t.a=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(89),n=r(410);class a{constructor(e){this.allocator=e,this.items=[],this.itemsPtr=0,this.tickHandle=n.a.before((()=>this.reset())),this.grow()}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(i.o)(this.tickHandle)),this.items=Object(i.o)(this.items)}get(){return 0===this.itemsPtr&&Object(n.a)((()=>{})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}reset(){var e=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*s);this.items.length=Math.min(e,this.items.length),this.itemsPtr=0}grow(){for(var e=0;e<Math.max(8,Math.min(this.items.length,s));e++)this.items.push(this.allocator())}}var s=1024},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(7);class n{constructor(e,t){this._module=e,this._loadModule=t}get(){return this._module}reload(){var e=this;return Object(i.a)((function*(){return e._module=yield e._loadModule(),e._module}))()}}},function(e,t,r){"use strict";function i(e){return t=>{t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);var r=t._delegatedEventNames,i=Array.isArray(e)?e:function(e){return e.split(",").map((e=>e.trim()))}(e);r.push(...i)}}r.d(t,"a",(function(){return i}))},,function(e,t,r){"use strict";var i,n=r(91),a=r(82),s=(r(80),r(81),r(88),r(85)),o=r(95),c=r(98),l=r(175),u=r(84),d=r(96),h=(r(83),r(86),r(87),r(209)),p=r(90),f=r(117),b=Object(o.b)()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),m=b.jsonValues.slice();Object(h.j)(m,"orthometric");var v=Object(o.b)()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"}),g=i=class extends p.a{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,r){return b.write(e,t,r)}readHeightModel(e,t,r){return b.read(e)||(r&&r.messages&&r.messages.push(function(e,t){return new l.a("height-model:unsupported","Height model of value '".concat(e,"' is not supported"),t)}(e,{context:r})),null)}readHeightUnit(e,t,r){return v.read(e)||(r&&r.messages&&r.messages.push(y(e,{context:r})),null)}readHeightUnitService(e,t,r){return Object(f.x)(e)||v.read(e)||(r&&r.messages&&r.messages.push(y(e,{context:r})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new i({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){var r=Object(f.i)(t);return new i({heightModel:e.heightModel,heightUnit:r,vertCRS:e.vertCRS})}write(e,t){return t=Object(n.a)({origin:"web-scene"},t),super.write(e,t)}static fromJSON(e){if(!e)return null;var t=new i;return t.read(e,{origin:"web-scene"}),t}};function y(e,t){return new l.a("height-unit:unsupported","Height unit of value '".concat(e,"' is not supported"),t)}Object(a.a)([Object(s.b)({type:b.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:m,default:"ellipsoidal"}}}})],g.prototype,"heightModel",void 0),Object(a.a)([Object(d.a)("web-scene","heightModel")],g.prototype,"writeHeightModel",null),Object(a.a)([Object(c.a)(["web-scene","service"],"heightModel")],g.prototype,"readHeightModel",null),Object(a.a)([Object(s.b)({type:v.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:v.jsonValues,write:v.write}}}})],g.prototype,"heightUnit",void 0),Object(a.a)([Object(c.a)("web-scene","heightUnit")],g.prototype,"readHeightUnit",null),Object(a.a)([Object(c.a)("service","heightUnit")],g.prototype,"readHeightUnitService",null),Object(a.a)([Object(s.b)({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],g.prototype,"vertCRS",void 0),Object(a.a)([Object(c.a)("service","vertCRS",["vertCRS","ellipsoid","geoid"])],g.prototype,"readVertCRS",null);var O=g=i=Object(a.a)([Object(u.a)("esri.geometry.HeightModelInfo")],g);t.a=O},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(98),s=r(84),o=(r(83),r(86),r(87),r(118)),c=r(140),l=r(150),u=r(222),d=r(239);var h=e=>{var t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){var r=t.timeInfo.exportOptions;if(!r)return null;var i=r.timeOffset,n=c.d.fromJSON(r.timeOffsetUnits);return i&&n?new u.a({value:i,unit:n}):null}set timeInfo(e){Object(o.m)(e,this.fields),this._set("timeInfo",e)}};return Object(i.a)([Object(n.b)({type:l.a,json:{write:!1}})],t.prototype,"timeExtent",void 0),Object(i.a)([Object(n.b)({type:u.a})],t.prototype,"timeOffset",void 0),Object(i.a)([Object(a.a)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),Object(i.a)([Object(n.b)({value:null,type:d.a,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),Object(i.a)([Object(n.b)({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=Object(i.a)([Object(s.a)("esri.layers.mixins.TemporalLayer")],t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return o})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return a}));var i=r(184);function n(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e,t,r,i,n,a,s,o,c,l){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=a,e[5]=s,e[6]=o,e[7]=c,e[8]=l,e}function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function o(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=r[0],p=r[1],f=r[2],b=r[3],m=r[4],v=r[5],g=r[6],y=r[7],O=r[8];return e[0]=h*i+p*s+f*l,e[1]=h*n+p*o+f*u,e[2]=h*a+p*c+f*d,e[3]=b*i+m*s+v*l,e[4]=b*n+m*o+v*u,e[5]=b*a+m*c+v*d,e[6]=g*i+y*s+O*l,e[7]=g*n+y*o+O*u,e[8]=g*a+y*c+O*d,e}function c(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=r[0],p=r[1];return e[0]=i,e[1]=n,e[2]=a,e[3]=s,e[4]=o,e[5]=c,e[6]=h*i+p*s+l,e[7]=h*n+p*o+u,e[8]=h*a+p*c+d,e}function l(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=t[4],c=t[5],l=t[6],u=t[7],d=t[8],h=Math.sin(r),p=Math.cos(r);return e[0]=p*i+h*s,e[1]=p*n+h*o,e[2]=p*a+h*c,e[3]=p*s-h*i,e[4]=p*o-h*n,e[5]=p*c-h*a,e[6]=l,e[7]=u,e[8]=d,e}function u(e,t,r){var i=r[0],n=r[1],a=r[2];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=a*t[6],e[7]=a*t[7],e[8]=a*t[8],e}function d(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e}function h(e,t){var r=t[0],i=t[1],n=t[2],a=t[4],s=t[5],o=t[6],c=t[8],l=t[9],u=t[10],d=u*s-o*l,h=-u*a+o*c,p=l*a-s*c,f=r*d+i*h+n*p;if(!f)return null;var b=1/f;return e[0]=d*b,e[1]=(-u*i+n*l)*b,e[2]=(o*i-n*s)*b,e[3]=h*b,e[4]=(u*r-n*c)*b,e[5]=(-o*r+n*a)*b,e[6]=p*b,e[7]=(-l*r+i*c)*b,e[8]=(s*r-i*a)*b,e}function p(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],c=t[6],l=t[7],u=t[8],d=t[9],h=t[10],p=t[11],f=t[12],b=t[13],m=t[14],v=t[15],g=r*o-i*s,y=r*c-n*s,O=r*l-a*s,j=i*c-n*o,_=i*l-a*o,w=n*l-a*c,x=u*b-d*f,S=u*m-h*f,M=u*v-p*f,T=d*m-h*b,E=d*v-p*b,P=h*v-p*m,C=g*P-y*E+O*T+j*M-_*S+w*x;return C?(C=1/C,e[0]=(o*P-c*E+l*T)*C,e[1]=(c*M-s*P-l*S)*C,e[2]=(s*E-o*M+l*x)*C,e[3]=(n*E-i*P-a*T)*C,e[4]=(r*P-n*M+a*S)*C,e[5]=(i*M-r*E-a*x)*C,e[6]=(b*w-m*_+v*j)*C,e[7]=(m*O-f*w-v*y)*C,e[8]=(f*_-b*O+v*g)*C,e):null}function f(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}var b=o,m=f;Object.freeze({__proto__:null,fromMat4:n,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},set:a,identity:s,transpose:function(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},invert:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],c=t[6],l=t[7],u=t[8],d=u*s-o*l,h=-u*a+o*c,p=l*a-s*c,f=r*d+i*h+n*p;return f?(f=1/f,e[0]=d*f,e[1]=(-u*i+n*l)*f,e[2]=(o*i-n*s)*f,e[3]=h*f,e[4]=(u*r-n*c)*f,e[5]=(-o*r+n*a)*f,e[6]=p*f,e[7]=(-l*r+i*c)*f,e[8]=(s*r-i*a)*f,e):null},adjoint:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5],c=t[6],l=t[7],u=t[8];return e[0]=s*u-o*l,e[1]=n*l-i*u,e[2]=i*o-n*s,e[3]=o*c-a*u,e[4]=r*u-n*c,e[5]=n*a-r*o,e[6]=a*l-s*c,e[7]=i*c-r*l,e[8]=r*s-i*a,e},determinant:function(e){var t=e[0],r=e[1],i=e[2],n=e[3],a=e[4],s=e[5],o=e[6],c=e[7],l=e[8];return t*(l*a-s*c)+r*(-l*n+s*o)+i*(c*n-a*o)},multiply:o,translate:c,rotate:l,scale:u,scaleByVec2:d,fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},fromRotation:function(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromScaling:function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromMat2d:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},fromQuat:function(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r+r,o=i+i,c=n+n,l=r*s,u=i*s,d=i*o,h=n*s,p=n*o,f=n*c,b=a*s,m=a*o,v=a*c;return e[0]=1-d-f,e[3]=u-v,e[6]=h+m,e[1]=u+v,e[4]=1-l-f,e[7]=p-b,e[2]=h-m,e[5]=p+b,e[8]=1-l-d,e},normalFromMat4Legacy:h,normalFromMat4:p,projection:function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},str:function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},frob:function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},add:function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},subtract:f,multiplyScalar:function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},multiplyScalarAndAdd:function(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},equals:function(e,t){var r=e[0],n=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=e[6],u=e[7],d=e[8],h=t[0],p=t[1],f=t[2],b=t[3],m=t[4],v=t[5],g=t[6],y=t[7],O=t[8];return Math.abs(r-h)<=i.a*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-p)<=i.a*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(a-f)<=i.a*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-b)<=i.a*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(o-m)<=i.a*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(c-v)<=i.a*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(l-g)<=i.a*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-y)<=i.a*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(d-O)<=i.a*Math.max(1,Math.abs(d),Math.abs(O))},mul:b,sub:m})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i={position:0,normal:1,uv0:2,color:3,size:4,tangent:4,auxpos1:5,symbolColor:5,auxpos2:6,featureAttribute:6,instanceFeatureAttribute:6,instanceColor:7,model:8,modelNormal:12,modelOriginHi:11,modelOriginLo:15}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));class i{constructor(e,t){t&&(this._config=t.snapshot()),this._program=this.initializeProgram(e),e.commonUniformStore&&(this._commonUniformStore=e.commonUniformStore,this._commonUniformStore.subscribeProgram(this._program)),this._pipeline=this.initializePipeline(e)}dispose(){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose(),this._program=null)}reload(e){this._program&&(this._commonUniformStore&&this._commonUniformStore.unsubscribeProgram(this._program),this._program.dispose()),this._program=this.initializeProgram(e),this._commonUniformStore&&this._commonUniformStore.subscribeProgram(this._program)}get program(){return this._program}get pipeline(){return this._pipeline}get key(){return this._config.key}get configuration(){return this._config}bindPass(e,t,r){}bindMaterial(e,t,r){}bindDraw(e,t,r){}bindPipelineState(e){e.setPipelineState(this.pipeline)}ensureAttributeLocations(e){this.program.assertCompatibleVertexAttributeLocations(e)}get primitiveType(){return 4}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i,n=r(120),a=r(119),s=r(417);function o(e){e.include(s.a),e.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    float linearDepthFromFloat(float depth, vec2 nearFar) {\n      return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);\n    }\n\n    float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\n      return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);\n    }\n  "]))))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(7),n=r(175),a=r(94),s=r(201);function o(e,t,r){return c.apply(this,arguments)}function c(){return(c=Object(i.a)((function*(e,t,r){var i=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);if(i&&"unique-value"===i.type&&i.styleOrigin){var o=yield Object(s.c)(i.populateFromStyle());if(Object(a.u)(r),!1===o.ok){var c=o.error;t&&t.messages&&t.messages.push(new n.a("renderer:style-reference","Failed to create unique value renderer from style reference: ".concat(c.message),{error:c,context:t})),e.clear("renderer",t.origin)}}}))).apply(this,arguments)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return j})),r.d(t,"f",(function(){return _})),r.d(t,"g",(function(){return w}));var i=r(100);var n=(e,t,r)=>[t,r],a=(e,t,r)=>[t,r,e[2]],s=(e,t,r)=>[t,r,e[2],e[3]];function o(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function c({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function l({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function u(e,t,r){for(var i,n,a,s,o=[],u=0;u<r.length;u++){var d=r[u];u>0?(a=c(e,d[0]),s=l(e,d[1]),a===i&&s===n||(o.push(t(d,a-i,s-n)),i=a,n=s)):(i=c(e,d[0]),n=l(e,d[1]),o.push(t(d,i,n)))}return o.length>0?o:null}function d({scale:e,translate:t},r){return r*e[0]+t[0]}function h({scale:e,translate:t},r){return t[1]-r*e[1]}function p(e,t,r){var i=new Array(r.length);if(!r.length)return i;var[n,a]=e.scale,s=d(e,r[0][0]),o=h(e,r[0][1]);i[0]=t(r[0],s,o);for(var c=1;c<r.length;c++){var l=r[c];s+=l[0]*n,o-=l[1]*a,i[c]=t(l,s,o)}return i}function f(e,t,r){for(var i=new Array(r.length),n=0;n<r.length;n++)i[n]=p(e,t,r[n]);return i}function b(e,t,r,i,o){return t.points=function(e,t,r,i){return u(e,r?i?s:a:i?a:n,t)}(e,r.points,i,o),t}function m(e,t,r,i,n){return t.x=c(e,r.x),t.y=l(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t}function v(e,t,r,i,o){var c=function(e,t,r,i){for(var o=[],c=r?i?s:a:i?a:n,l=0;l<t.length;l++){var d=u(e,c,t[l]);d&&d.length>=3&&o.push(d)}return o.length?o:null}(e,r.rings,i,o);return c?(t.rings=c,t):null}function g(e,t,r,i,o){var c=function(e,t,r,i){for(var o=[],c=r?i?s:a:i?a:n,l=0;l<t.length;l++){var d=u(e,c,t[l]);d&&d.length>=2&&o.push(d)}return o.length?o:null}(e,r.paths,i,o);return c?(t.paths=c,t):null}function y(e,t){return e&&t?Object(i.f)(t)?m(e,{},t,!1,!1):Object(i.h)(t)?g(e,{},t,!1,!1):Object(i.g)(t)?v(e,{},t,!1,!1):Object(i.e)(t)?b(e,{},t,!1,!1):Object(i.d)(t)?(s=!1,o=!1,(n={}).xmin=c(r=e,(a=t).xmin),n.ymin=l(r,a.ymin),n.xmax=c(r,a.xmax),n.ymax=l(r,a.ymax),n!==a&&(s&&(n.zmin=a.zmin,n.zmax=a.zmax),o&&(n.mmin=a.mmin,n.mmax=a.mmax)),n):null:null;var r,n,a,s,o}function O(e,t,r,i,o){return t.points=function(e,t,r,i){return p(e,r?i?s:a:i?a:n,t)}(e,r.points,i,o),t}function j(e,t,r,i,n){return t.x=d(e,r.x),t.y=h(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t}function _(e,t,r,i,o){return t.rings=function(e,t,r,i){return f(e,r?i?s:a:i?a:n,t)}(e,r.rings,i,o),t}function w(e,t,r,i,o){return t.paths=function(e,t,r,i){return f(e,r?i?s:a:i?a:n,t)}(e,r.paths,i,o),t}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var i=r(110);class n{constructor(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((()=>0))}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){var e=this._parameterNames,t={key:this.key};for(var r of e)t[r]=this[r];return t}}function a(e={}){return(t,r)=>{var n,a;t._parameterNames=null!=(n=t._parameterNames)?n:[],t._parameterNames.push(r);for(var s=t._parameterNames.length-1,o=e.count||2,c=Math.ceil(Object(i.m)(o)),l=null!=(a=t._parameterBits)?a:[0],u=0;l[u]+c>16;)++u>=l.length&&l.push(0);t._parameterBits=l;var d=l[u],h=(1<<c)-1<<d;l[u]+=c,Object.defineProperty(t,r,{get(){return this[s]},set(e){if(this[s]!==e&&(this[s]=e,this._keyDirty=!0,this._parameterBits[u]=this._parameterBits[u]&~h|+e<<d&h,"number"!=typeof e&&"boolean"!=typeof e))throw"Configuration value for "+r+" must be boolean or number, got "+typeof e}})}}},,,function(e,t,r){"use strict";class i{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){var e=new i;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}t.a=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f}));var i=r(89),n=r(126),a=r(97),s=r(107),o=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function c(e){return e instanceof a.a}function l(e){return e instanceof s.a?Object.keys(e.items):c(e)?Object(n.a)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof s.a?e.items[t]:e[t]}function d(e){return e?e.declaredClass:null}function h(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var n=l(e),a=l(t);if(0!==n.length||0!==a.length){if(!n.length||!a.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var s,p=a.filter((e=>-1===n.indexOf(e))),f=n.filter((e=>-1===a.indexOf(e))),b=n.filter((r=>a.indexOf(r)>-1&&u(e,r)!==u(t,r))).concat(p,f).sort(),m=d(e);if(m&&o.indexOf(m)>-1&&b.length)return{type:"complete",oldValue:e,newValue:t};var v=c(e)&&c(t);for(var g of b){var y=u(e,g),O=u(t,g),j=void 0;(v||"function"!=typeof y&&"function"!=typeof O)&&y!==O&&(null==y&&null==O||(j=r&&r[g]&&"function"==typeof r[g]?r[g](y,O):"object"==typeof y&&"object"==typeof O&&d(y)===d(O)?h(y,O):{type:"complete",oldValue:y,newValue:O},Object(i.k)(j)&&(Object(i.k)(s)?s.diff[g]=j:s={type:"partial",diff:{[g]:j}})))}return s}}function p(e,t){if(Object(i.j)(e))return!1;var r=t.split("."),n=e;for(var a of r){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;var s=n.diff[a];if(!s)return!1;n=s}return!0}function f(e,t){for(var r of t)if(p(e,r))return!0;return!1}function b(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&d(e)!==d(t)?{type:"complete",oldValue:e,newValue:t}:h(e,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),e=>{var t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return Object(i.a)([Object(n.b)({json:{write:!0,origins:{"web-scene":{write:!1}}}})],t.prototype,"customParameters",void 0),t=Object(i.a)([Object(a.a)("esri.layers.mixins.CustomParametersMixin")],t)})},,function(e,t,r){"use strict";function i(e,t,r,i){return function(e){return"function"==typeof e}(e)?e(t,r,i):e}function n(e){return[e.r,e.g,e.b,e.a]}function a(e,t,r){var i=e=>{for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},n=[],a=0,o=-1;do{if((o=t.indexOf("[",a))>=a){if(o>a){var c=t.substr(a,o-a);n.push([c,null,i(c)])}if(a=o+1,(o=t.indexOf("]",a))>=a){if(o>a){var l=e[t.substr(a,o-a)];l&&n.push([null,l,!1])}a=o+1}}}while(-1!==o);if(a<t.length-1){var u=t.substr(a);n.push([u,null,i(u)])}return e=>{var t="",i=null;for(var a of n){var[o,c,l]=a;if(o)l?i=o:(i&&(t+=i,i=null),t+=o);else{var u=e.attributes[c];u&&(i&&(t+=i,i=null),t+=u)}}return s(t,r)}}function s(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function o(e,t,r,i,n,a,s=!0){for(var o=t/n,c=r/a,l=Math.ceil(o/2),u=Math.ceil(c/2),d=0;d<a;d++)for(var h=0;h<n;h++){for(var p=4*(h+(s?a-d-1:d)*n),f=0,b=0,m=0,v=0,g=0,y=0,O=0,j=(d+.5)*c,_=Math.floor(d*c);_<(d+1)*c;_++)for(var w=Math.abs(j-(_+.5))/u,x=(h+.5)*o,S=w*w,M=Math.floor(h*o);M<(h+1)*o;M++){var T=Math.abs(x-(M+.5))/l,E=Math.sqrt(S+T*T);E>=-1&&E<=1&&((f=2*E*E*E-3*E*E+1)>0&&(O+=f*e[(T=4*(M+_*t))+3],m+=f,e[T+3]<255&&(f=f*e[T+3]/250),v+=f*e[T],g+=f*e[T+1],y+=f*e[T+2],b+=f))}i[p]=v/b,i[p+1]=g/b,i[p+2]=y/b,i[p+3]=O/m}}function c(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function l(e){var t;return null==(t=e.data)?void 0:t.symbol}function u(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function d(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function h(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function p(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return h})),r.d(t,"g",(function(){return u})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return d})),r.d(t,"j",(function(){return o})),r.d(t,"k",(function(){return l}))},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i,n=r(120),a=r(200),s=r(119),o=Object(a.d)(1,1,0,1),c=Object(a.d)(1,0,1,1);function l(e){e.fragment.uniforms.add("depthTex","sampler2D"),e.fragment.uniforms.add("highlightViewportPixelSz","vec4"),e.fragment.constants.add("occludedHighlightFlag","vec4",o).add("unoccludedHighlightFlag","vec4",c),e.fragment.code.add(Object(s.a)(i||(i=Object(n.a)(["\n    void outputHighlight() {\n      vec4 fragCoord = gl_FragCoord;\n\n      float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\n      if (fragCoord.z > sceneDepth + 5e-7) {\n        gl_FragColor = occludedHighlightFlag;\n      }\n      else {\n        gl_FragColor = unoccludedHighlightFlag;\n      }\n    }\n  "]))))}(l||(l={})).bindOutputHighlight=function(e,t,r){e.bindTexture(r.highlightDepthTexture,5),t.setUniform1i("depthTex",5),t.setUniform4f("highlightViewportPixelSz",0,0,r.inverseViewport[0],r.inverseViewport[1])}},function(e,t,r){"use strict";var i=r(94);class n{constructor(e,t,r,i){this.resolve=e,this.reject=t,this.callback=r,this.signal=i}}t.a=class{constructor(){this._tasks=new Array}get length(){return this._tasks.length}push(e,t){return new Promise(((r,i)=>this._tasks.push(new n(r,i,e,t))))}unshift(e,t){return new Promise(((r,i)=>this._tasks.unshift(new n(r,i,e,t))))}process(){if(0===this._tasks.length)return!1;var e=this._tasks.shift();try{Object(i.u)(e.signal);var t=e.callback();t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then?t.then(e.resolve,e.reject):e.resolve(t)}catch(r){e.reject(r)}return!0}cancelAll(){var e=Object(i.e)();for(var t of this._tasks)t.reject(e);this._tasks.length=0}}},function(e,t,r){"use strict";var i=r(91),n=r(82),a=(r(80),r(81),r(88),r(85)),s=r(84),o=r(83),c=(r(86),r(87),r(97)),l=class extends c.a{constructor(...e){super(...e),this.requestOptions=null,this.url=null}normalizeCtorArgs(e,t){return"string"!=typeof e?e:Object(i.a)({url:e},t)}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(e){return e?Object(o.J)(e):null}_encode(e,t,r){var i={};for(var n in e)if("declaredClass"!==n){var a=e[n];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){i[n]=[];for(var s=0;s<a.length;s++)i[n][s]=this._encode(a[s])}else if("object"==typeof a)if(a.toJSON){var o=a.toJSON(r&&r[n]);i[n]=t?o:JSON.stringify(o)}else i[n]=t?a:JSON.stringify(a);else i[n]=a}return i}};Object(n.a)([Object(a.b)({readOnly:!0})],l.prototype,"parsedUrl",null),Object(n.a)([Object(a.b)()],l.prototype,"requestOptions",void 0),Object(n.a)([Object(a.b)({type:String})],l.prototype,"url",void 0);var u=l=Object(n.a)([Object(s.a)("esri.tasks.Task")],l);t.a=u},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c}));r(80),r(295),r(89),r(99),r(183),r(189);var i=r(125),n=(r(155),r(598),r(279));r(311),r(416);class a{constructor(e,t,r){this.uid=e,this.geometry=t,this.attributes=r,this.visible=!0,this.objectId=null,this.centroid=null}}class s{constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}}function o(e){return"point"===e.type}function c(e,t,r,i){return{x:e,y:t,z:r,hasZ:null!=r,hasM:!1,spatialReference:i,type:"point"}}Object(n.d)(),Object(i.i)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return M})),r.d(t,"c",(function(){return _})),r.d(t,"d",(function(){return x})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return O}));var i=r(89),n=r(110),a=r(104),s=r(111),o=r(279),c=r(179),l=r(357),u=r(550),d=Object(o.d)();function h(e,t,r,i,n,a,s){var o=Object(l.d)(t),u=r.tolerance;if(!o)if(e.boundingInfo)Object(c.a)(0===e.primitiveType),f(e.boundingInfo,i,n,u,a,s);else{var d=e.indices.get("position"),h=e.vertexAttributes.get("position");m(i,n,0,d.length/3,d,h,void 0,a,s)}}var p=Object(a.e)();function f(e,t,r,n,a,c){if(!Object(i.j)(e)){var l=function(e,t,r){return Object(s.v)(r,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}(t,r,p);if(Object(o.s)(d,e.getBBMin()),Object(o.r)(d,e.getBBMax()),Object(i.k)(a)&&a.applyToAabb(d),function(e,t,r,i){return function(e,t,r,i,n){var a=(e[0]-i-t[0])*r[0],s=(e[3]+i-t[0])*r[0],o=Math.min(a,s),c=Math.max(a,s),l=(e[1]-i-t[1])*r[1],u=(e[4]+i-t[1])*r[1];if((c=Math.min(c,Math.max(l,u)))<0)return!1;if((o=Math.max(o,Math.min(l,u)))>c)return!1;var d=(e[2]-i-t[2])*r[2],h=(e[5]+i-t[2])*r[2];return!((c=Math.min(c,Math.max(d,h)))<0)&&!((o=Math.max(o,Math.min(d,h)))>c)&&o<n}(e,t,r,i,1/0)}(d,t,l,n)){var{primitiveIndices:u,indices:h,position:b}=e,v=u?u.length:h.length/3;if(v>T){var g=e.getChildren();if(void 0!==g){for(var y=0;y<8;++y)void 0!==g[y]&&f(g[y],t,r,n,a,c);return}}m(t,r,0,v,h,b,u,a,c)}}}var b=Object(a.e)();function m(e,t,r,n,a,s,o,c,l){if(o)return function(e,t,r,n,a,s,o,c,l){for(var u=s.data,d=s.stride||s.size,h=e[0],p=e[1],f=e[2],m=t[0]-h,v=t[1]-p,g=t[2]-f,O=r;O<n;++O){var j=o[O],_=3*j,w=d*a[_++],x=u[w++],S=u[w++],M=u[w];w=d*a[_++];var T=u[w++],E=u[w++],P=u[w];w=d*a[_];var C=u[w++],I=u[w++],A=u[w];Object(i.k)(c)&&([x,S,M]=c.applyToVertex(x,S,M,O),[T,E,P]=c.applyToVertex(T,E,P,O),[C,I,A]=c.applyToVertex(C,I,A,O));var R=T-x,F=E-S,L=P-M,D=C-x,k=I-S,z=A-M,V=v*z-k*g,N=g*D-z*m,U=m*k-D*v,B=R*V+F*N+L*U;if(!(Math.abs(B)<=Number.EPSILON)){var q=h-x,G=p-S,H=f-M,W=q*V+G*N+H*U;if(B>0){if(W<0||W>B)continue}else if(W>0||W<B)continue;var J=G*L-F*H,Z=H*R-L*q,X=q*F-R*G,Y=m*J+v*Z+g*X;if(B>0){if(Y<0||W+Y>B)continue}else if(Y>0||W+Y<B)continue;var Q=(D*J+k*Z+z*X)/B;Q>=0&&l(Q,y(R,F,L,D,k,z,b),j)}}}(e,t,r,n,a,s,o,c,l);for(var u=s.data,d=s.stride||s.size,h=e[0],p=e[1],f=e[2],m=t[0]-h,v=t[1]-p,g=t[2]-f,O=r,j=3*r;O<n;++O){var _=d*a[j++],w=u[_++],x=u[_++],S=u[_];_=d*a[j++];var M=u[_++],T=u[_++],E=u[_];_=d*a[j++];var P=u[_++],C=u[_++],I=u[_];Object(i.k)(c)&&([w,x,S]=c.applyToVertex(w,x,S,O),[M,T,E]=c.applyToVertex(M,T,E,O),[P,C,I]=c.applyToVertex(P,C,I,O));var A=M-w,R=T-x,F=E-S,L=P-w,D=C-x,k=I-S,z=v*k-D*g,V=g*L-k*m,N=m*D-L*v,U=A*z+R*V+F*N;if(!(Math.abs(U)<=Number.EPSILON)){var B=h-w,q=p-x,G=f-S,H=B*z+q*V+G*N;if(U>0){if(H<0||H>U)continue}else if(H>0||H<U)continue;var W=q*F-R*G,J=G*A-F*B,Z=B*R-A*q,X=m*W+v*J+g*Z;if(U>0){if(X<0||H+X>U)continue}else if(X>0||H+X<U)continue;var Y=(L*W+D*J+k*Z)/U;Y>=0&&l(Y,y(A,R,F,L,D,k,b),O)}}}var v=Object(a.e)(),g=Object(a.e)();function y(e,t,r,i,n,a,o){return Object(s.v)(v,e,t,r),Object(s.v)(g,i,n,a),Object(s.f)(o,v,g),Object(s.q)(o,o),o}function O(e,t,r,i,a){var s=(r.screenLength||0)*e.pixelRatio;a&&(s=Object(u.d)(s,i,t,a));var o=s*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return Object(n.i)(o*t,r.minWorldLength||0,null!=r.maxWorldLength?r.maxWorldLength:1/0)}function j(e,t,r){if(e){var i=e.parameters,n=e.paddingPixelsOverride;t.setUniform4f(r,i.divisor,i.offset,i.minPixelSize,n)}}function _(e,t){var r=t?_(t):{};for(var i in e){var n=e[i];n&&n.forEach&&(n=S(n)),null==n&&i in r||(r[i]=n)}return r}function w(e,t){var r=!1;for(var i in t){var n=t[i];void 0!==n&&(r=!0,Array.isArray(n)?e[i]=n.slice():e[i]=n)}return r}function x(e,t,r,i,a){if(t.options.selectionMode){for(var s=e.vertexAttributes.get("position").data,o=e.vertexAttributes.get("size"),c=o&&o.data[0],l=r[0],u=r[1],d=((c+i)/2+4)*e.screenToWorldRatio,h=Number.MAX_VALUE,p=0;p<s.length-5;p+=3){var f=s[p],b=s[p+1],m=l-f,v=u-b,g=s[p+3]-f,y=s[p+4]-b,O=Object(n.d)((g*m+y*v)/(g*g+y*y),0,1),j=g*O-m,_=y*O-v,w=j*j+_*_;w<h&&(h=w)}h<d*d&&a()}}function S(e){var t=[];return e.forEach((e=>t.push(e))),t}var M={multiply:1,ignore:2,replace:3,tint:4},T=1e3},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return g})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return f})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return c}));var i=r(110),n=r(104),a=r(111);function s(e){var t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],r=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],i=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(Math.max(t,r),i))}function o(e,t,r){r=r||e;var i=Object(a.g)(e,t);Object(a.v)(r,e[0]-i*t[0],e[1]-i*t[1],e[2]-i*t[2]),Object(a.q)(r,r)}function c(e,t,r){Math.abs(e[0])>Math.abs(e[1])?Object(a.v)(t,0,1,0):Object(a.v)(t,1,0,0),Object(a.f)(r,e,t),Object(a.q)(t,t),Object(a.f)(t,r,e),Object(a.q)(r,r)}function l(e,t){var r=Object(a.o)(e),n=Object(i.c)(e[2]/r),s=Math.atan2(e[1]/r,e[0]/r);return Object(a.v)(t,r,n,s),t}function u(e,t,r){var i=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2],s=i*i+n*n+a*a;return s?(s=1/Math.sqrt(s),e[0]=i*s,e[1]=n*s,e[2]=a*s,e):(e[0]=0,e[1]=0,e[2]=0,e)}function d(e,t,r,i=Object(n.e)()){var s=Object(a.o)(e),o=Object(a.o)(t),c=Object(a.g)(e,t)/(s*o);if(c<.9999999999999999){var l=Math.acos(c),u=((1-r)*s+r*o)/Math.sin(l),d=u/s*Math.sin((1-r)*l),h=u/o*Math.sin(r*l);return Object(a.d)(O,e,d),Object(a.d)(j,t,h),Object(a.e)(i,O,j)}return Object(a.h)(i,e,t,r)}function h(e,t,r,i=Object(n.e)(),s=Object(n.e)()){var o=Object(a.o)(e),c=Object(a.o)(t),l=Object(a.g)(e,t)/(o*c);if(l<.9999999999999999){var u=Math.acos(l),d=Math.sin(u),h=Math.sin(r*u),p=Math.sin((1-r)*u),f=(1-r)*o+r*c,b=f/d,m=b/c*h;Object(a.d)(O,e,b/o*p),Object(a.d)(j,t,m),Object(a.e)(i,O,j);var v=1/o*(-Math.cos((1-r)*u)*u*f+p*(-o+c));Object(a.d)(O,e,v);var g=1/c*(Math.cos(r*u)*u*f+h*(-o+c));return Object(a.d)(j,t,g),Object(a.e)(s,O,j),Object(a.d)(s,s,1/d),s}return Object(a.h)(i,e,t,r),Object(a.i)(s,t,e),Object(a.q)(s,s),s}class p{constructor(e,t){this.min=e,this.max=t,this.range=t-e}ndiff(e,t=0){return Math.ceil((e-t)/this.range)*this.range+t}_normalize(e,t,r,i=0,n=!1){return(r-=i)<e?r+=this.ndiff(e-r):r>t&&(r-=this.ndiff(r-t)),n&&r===t&&(r=e),r+i}normalize(e,t=0,r=!1){return this._normalize(this.min,this.max,e,t,r)}clamp(e,t=0){return Object(i.d)(e-t,this.min,this.max)+t}monotonic(e,t,r){return e<t?t:t+this.ndiff(e-t,r)}minimalMonotonic(e,t,r){return this._normalize(e,e+this.range,t,r)}center(e,t,r){return t=this.monotonic(e,t,r),this.normalize((e+t)/2,r)}diff(e,t,r){return this.monotonic(e,t,r)-e}shortestSignedDiff(e,t){e=this.normalize(e);var r=(t=this.normalize(t))-e,i=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(r)<Math.abs(i)?r:i}contains(e,t,r){return t=this.minimalMonotonic(e,t),(r=this.minimalMonotonic(e,r))>e&&r<t}}function f(e,t,r,i){Object(a.i)(b,t,e),Object(a.i)(m,r,e),Object(a.f)(i,b,m),Object(a.q)(i,i),i[3]=-Object(a.g)(e,i)}var b=Object(n.e)(),m=Object(n.e)();function v(e){for(var t in e){var r=e[t];r instanceof Function&&(e[t]=r.bind(e))}return e}v(new p(0,2*Math.PI));var g=v(new p(-Math.PI,Math.PI)),y=v(new p(0,360)),O=(Object(n.e)(),Object(n.e)()),j=Object(n.e)()},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(97)),o=class extends s.a{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};Object(i.a)([Object(n.b)()],o.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),Object(i.a)([Object(n.b)()],o.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);var c=new(o=Object(i.a)([Object(a.a)("esri.views.support.DebugFlags")],o));t.a=c},function(e,t,r){"use strict";function i(){return[1,0,0,0,1,0,0,0,1]}function n(e,t){return new Float64Array(e,t,9)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));Object.freeze({__proto__:null,create:i,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,r,i,n,a,s,o,c){return[e,t,r,i,n,a,s,o,c]},createView:n})},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return u}));var i,n,a,s,o=r(120),c=r(119),l=.1,u=.001;function d(e,t){var r=e.fragment;switch(t.alphaDiscardMode){case 0:r.code.add(Object(c.a)(i||(i=Object(o.a)(["\n        #define discardOrAdjustAlpha(color) { if (color.a < ",") { discard; } }\n      "])),c.a.float(u)));break;case 1:r.code.add(Object(c.a)(n||(n=Object(o.a)(["\n        void discardOrAdjustAlpha(inout vec4 color) {\n          color.a = 1.0;\n        }\n      "]))));break;case 2:r.uniforms.add("textureAlphaCutoff","float"),r.code.add(Object(c.a)(a||(a=Object(o.a)(["\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }\n      "]))));break;case 3:e.fragment.uniforms.add("textureAlphaCutoff","float"),e.fragment.code.add(Object(c.a)(s||(s=Object(o.a)(["\n        #define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }\n      "]))))}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return b}));var i=r(82),n=(r(80),r(81)),a=(r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(97)),c=r(459),l=r(597),u=r(408);class d extends u.a{constructor(e){super(!0),this._onChange=e,this._value="mouse",this.registerIncoming("pointer-down",(e=>{var t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse")})),this._moveHandler=this.registerIncoming("pointer-move",(e=>{var t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse")})),this._moveHandler.pause()}_setValue(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e))}}var h=n.a.getLogger("esri.views.input.InputManager"),p=class extends o.a{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=l.c,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){var e=Object.keys(this._nameToGroup);for(var t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=b.INTERNAL){var i=this;if(this._nameToGroup[e])h.error("There is already an InputHandler group registered under the name `"+e+"`");else if(0!==t.length){var n={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=n;for(var a=function(e){var t=n.handlers[e];i._handlers.push(t),t.handler.onInstall({updateDependencies:()=>{i.updateDependencies()},emit:(e,r,n,a,s)=>{i._emitInputEvent(t.priorityIndex+1,e,r,n,s,a)},setPointerCapture:(e,r)=>{i._setPointerCapture(n,t,e,r)},setEventCallback:e=>{t.eventCallback=e},setUninstallCallback:e=>{t.uninstallCallback=e},refreshHasPendingInputs:()=>{i.notifyChange("hasPendingInputs")}})},s=n.handlers.length-1;s>=0;s--)a(s);this.updateDependencies()}else h.error("Can't register a group of zero handlers")}uninstallHandlers(e){var t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback()})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):h.error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){var e=new Set,t=new Set;this._handlersPriority=[];for(var r=this._handlers.length-1;r>=0;r--){var i=this._handlers[r];i.priorityIndex=r,this._handlersPriority.push(i)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(var n=this._handlersPriority.length-1;n>=0;n--){var a=this._handlersPriority[n];a.priorityIndex=n;var s=a.handler.hasSideEffects;if(!s)for(var o of a.handler.outgoingEventTypes)if(e.has(o)){s=!0;break}if(s)for(var c of a.handler.incomingEventMatches)for(var u of(e.add(c.eventType),c.keyModifiers))Object(l.b)(u)||t.add(u);a.active=s}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointerType(e){this._set("latestPointerType",e)}_onEventReceived(e,t){if("pointer-capture-lost"===e){var r=t;this._pointerCaptures.delete(r.native.pointerId)}this._updateKeyModifiers(e,t);var i=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,i,n)}_updateKeyModifiers(e,t){if(t){var r=!1,i=()=>{if(!r){var e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t)})),this._activeKeyModifiers=e,r=!0}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e))};if("key-down"===e||"key-up"===e){var a=t.key;this._keyModifiers.has(a)&&n(a,"key-down"===e)}var s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}}_installRecognizers(){this._latestPointerTypeHandler=new d((e=>this._setLatestPointerType(e))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,b.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],b.INTERNAL)}_setPointerCapture(e,t,r,i){var n=e.name+"-"+t.priorityIndex,a=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,a),i?(a.add(n),1===a.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):a.has(n)&&(a.delete(n),0===a.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies()}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i)}_emitInputEvent(e,t,r,i,n,a){var s=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),o=void 0!==n&&n,c={event:new f(t,r,s,a||this._activeKeyModifiers,o),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new c.a,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){var{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(null==i||!this._stoppedPropagationEventIds.has(i))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null}}_pausePropagation(e){var t=new c.a;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(var r of e.handler.incomingEventMatches){var i=function(e){if(r.eventType!==e.eventType)return"continue";var t=r.keyModifiers.filter((t=>-1!==e.keyModifiers.indexOf(t)));return t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length)?{v:r.keyModifiers.length>e.keyModifiers.length?-1:1}:void 0};for(var n of t.handler.incomingEventMatches){var a=i(n);if("continue"!==a&&"object"===typeof a)return a.v}}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){var t=[];for(var r of e){for(var i=0;i<t.length&&this._compareHandlerPriority(r,t[i])>=0;)i++;t.splice(i,0,r)}return t}get debug(){var e=e=>{var t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t};return{injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r)}))},disablePointerCapture:e}}};Object(i.a)([Object(a.b)({readOnly:!0})],p.prototype,"hasPendingInputs",null),Object(i.a)([Object(a.b)()],p.prototype,"eventSource",void 0),Object(i.a)([Object(a.b)()],p.prototype,"recognizers",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],p.prototype,"latestPointerType",void 0),p=Object(i.a)([Object(s.a)("esri.views.input.InputManager")],p);class f{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(e){this._propagationState|=2;var t=(e,t)=>{this._propagationState&=-3;var r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return!!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}}var b={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(81),n=r(118),a=r(155),s=i.a.getLogger("esri.layers.support.fieldProperties");function o(){return{fields:{type:[a.a],value:null},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var e=this._userOutFields;if(!e||!e.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(var t of e)Object(n.t)(this.fields,t)||s.error("field-attributes-layer:invalid-field","Invalid field ".concat(t," found in outFields"),{layer:this,outFields:e});return Object(n.k)(this.fields,e)}}}}},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(195),n=/\[([^\[\]]+)\]/gi;function a(e,t,r){return e?e.map((e=>{var a=new i.a;if(a.read(e,r),a.labelExpression){var s=t.fields||t.layerDefinition&&t.layerDefinition.fields||this.fields;a.labelExpression=a.labelExpression.replace(n,((e,t)=>"[".concat(function(e,t){if(!t)return e;for(var r=e.toLowerCase(),i=0;i<t.length;i++){var n=t[i].name;if(n.toLowerCase()===r)return n}return e}(t,s),"]")))}return a})):null}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return o})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return l}));var i=r(89),n=r(376);function a(e,t){return Object(i.j)(t)||!t.mode?e?"absolute-height":"on-the-ground":t.mode}function s(e,t){return a(!!Object(i.k)(e)&&e.hasZ,t)}function o(e){var t=u(e);return s(e.geometry,t)}function c(e){var t=u(e),r=s(e.geometry,t);return{mode:r,offset:Object(i.k)(t)&&"on-the-ground"!==r?Object(i.r)(t.offset,0)*Object(n.a)(Object(i.r)(t.unit,"meters")):0}}function l(e){if("on-the-ground"===o(e))return!1;var t=u(e),r=Object(i.k)(t)&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!r||"0"===r)}function u(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function d(e,t,r){if(!Object(i.j)(r)&&r.mode){var n=e.hasZ?e.z:0,a=Object(i.k)(r.offset)?r.offset:0;switch(r.mode){case"absolute-height":return n-a;case"on-the-ground":return 0;case"relative-to-ground":return n-(Object(i.r)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+a);case"relative-to-scene":return n-(Object(i.r)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+a)}}}function h(e,t,r,i=null){return f(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,r,i)}function p(e,t,r,i,n=null){return f(e,t[0],t[1],t.length>2?t[2]:0,r,i,n)}function f(e,t,r,n,a,s,o=null){if(!Object(i.j)(s)){var c=Object(i.k)(o)?o.mode:"absolute-height";return"on-the-ground"===c?0:function(e,t,r,n,a,s,o,c){var l=Object(i.k)(o)&&Object(i.k)(o.offset)?o.offset:0;switch(c){case"absolute-height":return e-l;case"relative-to-ground":return e-(Object(i.r)(s.elevationProvider.getElevation(t,r,n,a,"ground"),0)+l);case"relative-to-scene":return e-(Object(i.r)(s.elevationProvider.getElevation(t,r,n,a,"scene"),0)+l)}}(function(e,t,r,n,a,s){var o=Object(i.k)(s.offset)?s.offset:0;switch(s.mode){case"absolute-height":return r+o;case"on-the-ground":return Object(i.r)(a.elevationProvider.getElevation(e,t,0,n,"ground"),0);case"relative-to-ground":return r+Object(i.r)(a.elevationProvider.getElevation(e,t,r,n,"ground"),0)+o;case"relative-to-scene":return r+Object(i.r)(a.elevationProvider.getElevation(e,t,r,n,"scene"),0)+o}}(t,r,n,a,e,s),t,r,n,a,e,o,c)}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var i=r(124),n=r(93),a=r(216),s=r(268),o=r(265),c={key:"type",base:a.a,typeMap:{selection:o.a}};function l(e,t){var r=(t=t.layerDefinition||t).featureReduction;if(r)switch(r.type){case"selection":return o.a.fromJSON(r);case"cluster":return s.a.fromJSON(r)}return null}function u(e,t,r,a){var s=function(e,t,r){return e?"selection"!==e.type?(r.messages&&r.messages.push(new n.a("featureReduction:unsupported","FeatureReduction of type '".concat(e.declaredClass,"' are not supported in scenes."),{featureReduction:e,context:r})),null):e.write(t,r):null}(e,{},a);s&&Object(i.c)(r,s,t)}},,,,function(e,t,r){"use strict";var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(90)),o=r(107),c=class extends s.a{constructor(e){super(e),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new o.a}};Object(i.a)([Object(n.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],c.prototype,"floorField",void 0),Object(i.a)([Object(n.b)({json:{read:!1,write:!1}})],c.prototype,"viewAllMode",void 0),Object(i.a)([Object(n.b)({json:{read:!1,write:!1}})],c.prototype,"viewAllLevelIds",void 0);var l=c=Object(i.a)([Object(a.a)("esri.layers.support.LayerFloorInfo")],c);t.a=l},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return d}));var i=r(110),n=r(104),a=r(111);function s(e,t){return Object(a.g)(e,t)/Object(a.o)(e)}function o(e,t){var r=Object(a.g)(e,t)/(Object(a.o)(e)*Object(a.o)(t));return-Object(i.b)(r)}function c(e,t,r){Object(a.q)(l,e),Object(a.q)(u,t);var n=Object(a.g)(l,u),s=Object(i.b)(n),o=Object(a.f)(l,l,u);return Object(a.g)(o,r)<0?2*Math.PI-s:s}var l=Object(n.e)(),u=Object(n.e)(),d=Object.freeze({__proto__:null,projectPoint:function(e,t,r){var i=Object(a.g)(e,t)/Object(a.g)(e,e);return Object(a.d)(r,e,i)},projectPointSignedLength:s,angle:o,angleAroundAxis:c})},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(189);class n{constructor(){this.id=Object(i.a)()}unload(){}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return n})),r.d(t,"g",(function(){return d}));var i=r(267),n=Object(i.e)(770,1,771,771),a=Object(i.f)(1,1),s=Object(i.f)(0,771);function o(e){return 2===e?null:1===e?s:a}function c(e){return 2===e?i.c:null}var l=5e5,u={factor:-1,units:-2};function d(e){return e?u:null}function h(e){return 3===e||2===e?513:515}},,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return c}));var i=r(89),n=r(157),a=r(174),s=r(179);r(579);function o(e,t){return Object(i.j)(e)&&(e=[]),e.push(t),e}function c(e,t){if(Object(i.j)(e))return e;var r=e.filter((e=>e!==t));return 0===r.length?null:r}function l(e){return!!Object(i.k)(e)&&!e.visible}function u(e,t){var r=new Map;return r.set(0,t.acquire(e,0)),r.set(1,t.acquire(e,7)),r.set(4,t.acquire(e,3)),r.set(3,t.acquire(e,2)),r.set(2,t.acquire(e,1)),r.set(5,t.acquire(e,4)),r.set(7,t.acquire(e,3)),r.set(6,t.acquire(e,3)),r}function d(e,t){t.release(e,0),t.release(e,7),t.release(e,3),t.release(e,2),t.release(e,1),t.release(e,4)}function h(e,t,r){var a=e.origin.vec3;Object(s.j)(p,-a[0],-a[1],-a[2]),Object(i.k)(e.transformation)?Object(n.l)(t,p,e.transformation):Object(n.c)(t,p),r&&(Object(n.a)(r,t),Object(n.b)(r,r))}new Float64Array(3),new Float32Array(6);var p=Object(a.b)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i,n=r(120),a=r(119);function s(e){e.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    vec4 premultiplyAlpha(vec4 v) {\n      return vec4(v.rgb * v.a, v.a);\n    }\n\n    // Note: the min in the last line has been added to fix an instability in chrome.\n    // See https://devtopia.esri.com/WebGIS/arcgis-js-api/issues/23911\n    // With proper floating point handling, the value could never be >1.\n    vec3 rgb2hsv(vec3 c) {\n      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n      vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n      vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n      float d = q.x - min(q.w, q.y);\n      float e = 1.0e-10;\n      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n    }\n\n    vec3 hsv2rgb(vec3 c) {\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    float rgb2v(vec3 c) {\n      return max(c.x, max(c.y, c.z));\n    }\n  "]))))}},,,,function(e,t,r){"use strict";var i=r(80),n=r(221),a=4294967296,s=Object(i.a)("esri-text-decoder")?new TextDecoder("utf-8"):null,o=Object(i.a)("safari")||Object(i.a)("ios")?6:Object(i.a)("ff")?12:32;class c{constructor(e,t,r=0,i=(e?e.byteLength:0)){this._tag=0,this._dataType=99,this.init(e,t,r,i)}init(e,t,r,i){this._data=e,this._dataView=t,this._pos=r,this._end=i}clone(){return new c(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;var e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){var e=this.getUInt32();return e>>>1^-(1&e)|0}getSInt64(){return this._decodeSVarint()}getBool(){var e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getUint32(t+4,!0)*a;return this._skip(8),r}getSFixed64(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+e.getInt32(t+4,!0)*a;return this._skip(8),r}getDouble(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r}getBytes(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,r,i){var n=this.getMessage(),a=e(n,t,r,i);return n.release(),a}processMessage(e){var t=this.getMessage(),r=e(t);return t.release(),r}getMessage(){var e=this._getLength(),t=c.pool.acquire();return t.init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){c.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){var e,t=this._data,r=this._pos,i=0;if(this._end-r>=10)do{if(i|=127&(e=t[r++]),0==(128&e))break;if(i|=(127&(e=t[r++]))<<7,0==(128&e))break;if(i|=(127&(e=t[r++]))<<14,0==(128&e))break;if(i|=(127&(e=t[r++]))<<21,0==(128&e))break;if(i+=268435456*(127&(e=t[r++])),0==(128&e))break;if(i+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(i+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(i+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(i+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(i+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var n=1;r!==this._end&&0!=(128&(e=t[r]));)++r,i+=(127&e)*n,n*=128;if(r===this._end)throw new Error("Varint overrun!");++r,i+=e*n}return this._pos=r,i}_decodeSVarint(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2}_getLength(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,r){if((r=Math.min(this._end,r))-t>o&&s){var i=e.subarray(t,r);return s.decode(i)}for(var n="",a="",c=t;c<r;++c){var l=e[c];128&l?a+="%"+l.toString(16):(n+=decodeURIComponent(a)+String.fromCharCode(l),a="")}return a.length&&(n+=decodeURIComponent(a)),n}_toBytes(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)}}c.pool=new n.a(c,null,(e=>{e._data=null,e._dataView=null})),t.a=c},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o}));r(80);var i=r(105);function n(e){return Object(i.f)(e.x,e.y)}function a(e,t){var r=(e instanceof HTMLElement?e:e.surface).getBoundingClientRect();return Object(i.f)(t.clientX-r.left,t.clientY-r.top)}function s(e,t){return t instanceof Event?a(e,t):n(t)}function o(e){if(e instanceof Event)return!0;if("object"==typeof e&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;case"key-down":case"key-up":case"gamepad":case"focus":case"blur":default:return!1}return!1}},function(e,t,r){"use strict";t.a=function(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(434),n=r(578);class a{constructor(e,t){for(var r of(this.layout=e,this.buffer="number"==typeof t?new ArrayBuffer(t*e.stride):t,e.fieldNames)){var i=e.fields.get(r);this[r]=new i.constructor(this.buffer,i.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(e,t){var r=this[e];return r&&r.elementCount===t.ElementCount&&r.elementType===t.ElementType?r:null}slice(e,t){return new a(this.layout,this.buffer.slice(e*this.stride,t*this.stride))}copyFrom(e,t,r,i){var n=this.stride;if(n%4==0){var a=new Uint32Array(e.buffer,t*n,i*n/4);new Uint32Array(this.buffer,r*n,i*n/4).set(a)}else{var s=new Uint8Array(e.buffer,t*n,i*n);new Uint8Array(this.buffer,r*n,i*n).set(s)}}}class s{constructor(){this.stride=0,this.fields=new Map,this.fieldNames=[]}vec2f(e,t){return this.appendField(e,i.m,t),this}vec2f64(e,t){return this.appendField(e,i.n,t),this}vec3f(e,t){return this.appendField(e,i.u,t),this}vec3f64(e,t){return this.appendField(e,i.v,t),this}vec4f(e,t){return this.appendField(e,i.C,t),this}vec4f64(e,t){return this.appendField(e,i.D,t),this}mat3f(e,t){return this.appendField(e,i.f,t),this}mat3f64(e,t){return this.appendField(e,i.g,t),this}mat4f(e,t){return this.appendField(e,i.h,t),this}mat4f64(e,t){return this.appendField(e,i.i,t),this}vec4u8(e,t){return this.appendField(e,i.J,t),this}f32(e,t){return this.appendField(e,i.a,t),this}f64(e,t){return this.appendField(e,i.b,t),this}u8(e,t){return this.appendField(e,i.l,t),this}u16(e,t){return this.appendField(e,i.j,t),this}i8(e,t){return this.appendField(e,i.e,t),this}vec2i8(e,t){return this.appendField(e,i.q,t),this}vec2i16(e,t){return this.appendField(e,i.o,t),this}vec2u8(e,t){return this.appendField(e,i.t,t),this}vec4u16(e,t){return this.appendField(e,i.H,t),this}u32(e,t){return this.appendField(e,i.k,t),this}appendField(e,t,r){var i=t.ElementCount*Object(n.a)(t.ElementType),a=this.stride;this.fields.set(e,{size:i,constructor:t,offset:a,optional:r}),this.stride+=i,this.fieldNames.push(e)}alignTo(e){return this.stride=Math.floor((this.stride+e-1)/e)*e,this}hasField(e){return this.fieldNames.indexOf(e)>=0}createBuffer(e){return new a(this,e)}createView(e){return new a(this,e)}clone(){var e=new s;return e.stride=this.stride,e.fields=new Map,this.fields.forEach(((t,r)=>e.fields.set(r,t))),e.fieldNames=this.fieldNames.slice(),e.BufferType=this.BufferType,e}}function o(){return new s}},,function(e,t,r){"use strict";var i,n,a=r(104),s=r(111),o=r(461),c=r(255);(n=i||(i={})).length=function(e,t){var r=e[t],i=e[t+1],n=e[t+2];return Math.sqrt(r*r+i*i+n*n)},n.normalize=function(e,t){var r=e[t],i=e[t+1],n=e[t+2],a=1/Math.sqrt(r*r+i*i+n*n);e[t]*=a,e[t+1]*=a,e[t+2]*=a},n.scale=function(e,t,r){e[t]*=r,e[t+1]*=r,e[t+2]*=r},n.add=function(e,t,r,i,n,a=t){(n=n||e)[a]=e[t]+r[i],n[a+1]=e[t+1]+r[i+1],n[a+2]=e[t+2]+r[i+2]},n.subtract=function(e,t,r,i,n,a=t){(n=n||e)[a]=e[t]-r[i],n[a+1]=e[t+1]-r[i+1],n[a+2]=e[t+2]-r[i+2]};var l,u,d,h,p=r(179),f=r(378),b=r(463),m=i;!function(e){for(var t=.5,r=[[-t,-t,t],[t,-t,t],[t,t,t],[-t,t,t],[-t,-t,-t],[t,-t,-t],[t,t,-t],[-t,t,-t]],i=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],n=[0,0,1,0,1,1,0,1],a=new Uint16Array([0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5]),s=new Uint16Array(36),o=0;o<6;o++)for(var c=0;c<6;c++)s[6*o+c]=o;for(var l=new Uint16Array(36),u=0;u<6;u++)l[6*u+0]=0,l[6*u+1]=1,l[6*u+2]=2,l[6*u+3]=2,l[6*u+4]=3,l[6*u+5]=0;e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Array(24),o=0;o<8;o++)t[3*o]=r[o][0]*e[0],t[3*o+1]=r[o][1]*e[1],t[3*o+2]=r[o][2]*e[2];return new b.a([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:i}],["uv0",{size:2,data:n}]],[["position",a],["normal",s],["uv0",l]])}}(l||(l={})),function(e){var t=.5,r=[[-t,0,-t],[t,0,-t],[t,0,t],[-t,0,t],[0,-t,0],[0,t,0]],i=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],n=new Uint16Array([5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0]),a=new Uint16Array([0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7]);e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Array(18),s=0;s<6;s++)t[3*s]=r[s][0]*e[0],t[3*s+1]=r[s][1]*e[1],t[3*s+2]=r[s][2]*e[2];return new b.a([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:i}]],[["position",n],["normal",a]])}}(u||(u={})),function(e){var t=.5,r=Object(o.c)(-t,0,-t),i=Object(o.c)(t,0,-t),n=Object(o.c)(0,0,t),a=Object(o.c)(0,.5,0),c=Object(o.b)(),l=Object(o.b)(),u=Object(o.b)(),d=Object(o.b)(),h=Object(o.b)();Object(s.i)(c,r,a),Object(s.i)(l,r,i),Object(s.f)(u,c,l),Object(s.q)(u,u),Object(s.i)(c,i,a),Object(s.i)(l,i,n),Object(s.f)(d,c,l),Object(s.q)(d,d),Object(s.i)(c,n,a),Object(s.i)(l,n,r),Object(s.f)(h,c,l),Object(s.q)(h,h);var p=[r,i,n,a],f=[0,-1,0,u[0],u[1],u[2],d[0],d[1],d[2],h[0],h[1],h[2]],m=[0,1,2,3,1,0,3,2,1,3,0,2],v=[0,0,0,1,1,1,2,2,2,3,3,3];e.createGeometry=function(e){Array.isArray(e)||(e=[e,e,e]);for(var t=new Array(12),r=0;r<4;r++)t[3*r]=p[r][0]*e[0],t[3*r+1]=p[r][1]*e[1],t[3*r+2]=p[r][2]*e[2];return new b.a([["position",{size:3,data:t,exclusive:!0}],["normal",{size:3,data:f}]],[["position",new Uint16Array(m)],["normal",new Uint16Array(v)]])}}(d||(d={})),function(e){e.createBoxGeometry=l.createGeometry,e.createDiamondGeometry=u.createGeometry,e.createTetrahedronGeometry=d.createGeometry,e.createSphereGeometry=function(e,t,r,i={uv:!0}){for(var n=-Math.PI,a=2*Math.PI,s=-Math.PI/2,o=Math.PI,c=Math.max(3,Math.floor(t)),l=Math.max(2,Math.floor(r)),u=(c+1)*(l+1),d=new Float32Array(3*u),h=new Float32Array(3*u),p=new Float32Array(2*u),f=[],m=0,v=0;v<=l;v++){for(var g=[],y=v/l,O=s+y*o,j=Math.cos(O),_=0;_<=c;_++){var w=_/c,x=n+w*a,S=Math.cos(x)*j,M=Math.sin(O),T=-Math.sin(x)*j;d[3*m]=S*e,d[3*m+1]=M*e,d[3*m+2]=T*e,h[3*m]=S,h[3*m+1]=M,h[3*m+2]=T,p[2*m]=w,p[2*m+1]=y,g.push(m),++m}f.push(g)}var E=new Uint32Array(2*c*(l-1)*3);m=0;for(var P=0;P<l;P++)for(var C=0;C<c;C++){var I=f[P][C],A=f[P][C+1],R=f[P+1][C+1],F=f[P+1][C];0===P?(E[m++]=I,E[m++]=R,E[m++]=F):P===l-1?(E[m++]=I,E[m++]=A,E[m++]=R):(E[m++]=I,E[m++]=A,E[m++]=R,E[m++]=R,E[m++]=F,E[m++]=I)}var L=[["position",E],["normal",E]],D=[["position",{size:3,data:d,exclusive:!0}],["normal",{size:3,data:h,exclusive:!0}]];return i.uv&&(D.push(["uv0",{size:2,data:p,exclusive:!0}]),L.push(["uv0",E])),i.offset&&(L[0][0]="offset",D[0][0]="offset",L.push(["position",new Uint32Array(E.length)]),D.push(["position",{size:3,data:Float64Array.from(i.offset),exclusive:!0}])),new b.a(D,L)},e.createPolySphereGeometry=function(e,t,r){var i,n,a=e;if(r)i=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],n=new Uint32Array([0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]);else{var s=a*(1+Math.sqrt(5))/2;i=[-a,s,0,a,s,0,-a,-s,0,a,-s,0,0,-a,s,0,a,s,0,-a,-s,0,a,-s,s,0,-a,s,0,a,-s,0,-a,-s,0,a],n=new Uint32Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}for(var o=0;o<i.length;o+=3)m.scale(i,o,e/m.length(i,o));var c={};function l(t,r){t>r&&([t,r]=[r,t]);var n=t.toString()+"."+r.toString();if(c[n])return c[n];var a=i.length;return i.length+=3,m.add(i,3*t,i,3*r,i,a),m.scale(i,a,e/m.length(i,a)),a/=3,c[n]=a,a}for(var u=0;u<t;u++){for(var d=n.length,h=new Uint32Array(4*d),p=0;p<d;p+=3){var f=n[p],v=n[p+1],g=n[p+2],y=l(f,v),O=l(v,g),j=l(g,f),_=4*p;h[_]=f,h[_+1]=y,h[_+2]=j,h[_+3]=v,h[_+4]=O,h[_+5]=y,h[_+6]=g,h[_+7]=j,h[_+8]=O,h[_+9]=y,h[_+10]=O,h[_+11]=j}n=h,c={}}for(var w=new Float32Array(i),x=0;x<w.length;x+=3)m.normalize(w,x);var S=[["position",n],["normal",n]],M=[["position",{size:3,data:new Float32Array(i),exclusive:!0}],["normal",{size:3,data:w,exclusive:!0}]];return new b.a(M,S)},e.createPointGeometry=function(e,t,r,i,n,a,s){var o=t?[t[0],t[1],t[2]]:[0,0,0],c=e?[e[0],e[1],e[2]]:[0,0,1];a=a||[0,0];var l=r?[255*r[0],255*r[1],255*r[2],r.length>3?255*r[3]:255]:[255,255,255,255],u=null!=i&&2===i.length?i:[1,1],d=[["position",{size:3,data:o,exclusive:!0}],["normal",{size:3,data:c,exclusive:!0}],["uv0",{size:a.length,data:a}],["color",{size:4,data:l,exclusive:!0}],["size",{size:2,data:u}]];if(null!=n){var h=new Float32Array([n[0],n[1],n[2],n[3]]);d.push(["auxpos1",{size:4,data:h}])}if(null!=s){var p=new Float32Array([s[0],s[1],s[2],s[3]]);d.push(["auxpos2",{size:4,data:p}])}return new b.a(d,null,1)},e.updatePointGeometry=function(e,t,r,i,n,a,s,o){if(null!=e){var{data:c}=o.getMutableAttribute("normal");c[0]=e[0],c[1]=e[1],c[2]=e[2]}if(null!=t){var{data:l}=o.getMutableAttribute("position");l[0]=t[0],l[1]=t[1],l[2]=t[2]}if(null!=r){var{data:u}=o.getMutableAttribute("color");u[0]=r[0],u[1]=r[1],u[2]=r[2],u[3]=r[3]}if(null!=i){var{data:d}=o.getMutableAttribute("size");d[0]=i[0],d[1]=i[1]}if(null!=n){var{data:h}=o.getMutableAttribute("auxpos1");h[0]=n[0],h[1]=n[1],h[2]=n[2],h[3]=n[3]}if(null!=a){var{data:p}=o.getMutableAttribute("uv0");p[0]=a[0],p[1]=a[1]}if(null!=s){var{data:f}=o.getMutableAttribute("auxpos2");f[0]=s[0],f[1]=s[1],f[2]=s[2],f[3]=s[3]}},e.createPointArrayGeometry=function(e,t){for(var r=new Float32Array(3*e.length),i=new Float32Array(t?3*e.length:3),n=new Uint32Array(e.length),a=new Uint32Array(e.length),s=0;s<e.length;s++)r[3*s]=e[s][0],r[3*s+1]=e[s][1],r[3*s+2]=e[s][2],t&&(i[3*s]=t[s][0],i[3*s+1]=t[s][1],i[3*s+2]=t[s][2]),n[s]=s,a[s]=0;return t||(i[0]=0,i[1]=1,i[2]=0),new b.a([["position",{size:3,data:r,exclusive:!0}],["normal",{size:3,data:i,exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",n],["normal",t?n:a],["uv0",a]],1)},e.createTriangleGeometry=function(){var e=new Uint16Array([0,1,2]),t=new Uint16Array([0,0,0]),r=new Uint16Array([0,0,0]);return new b.a([["position",{size:3,data:[0,0,0,0,0,100,100,0,0],exclusive:!0}],["normal",{size:3,data:[0,1,0],exclusive:!0}],["uv0",{size:2,data:[0,0],exclusive:!0}]],[["position",e],["normal",t],["uv0",r]])};var t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function r(e,t,r,i,n){return!(Math.abs(Object(s.g)(t,e))>n)&&(Object(s.f)(r,e,t),Object(s.q)(r,r),Object(s.f)(i,r,e),Object(s.q)(i,i),!0)}function i(e,t,i,n,a,s,o){return r(e,t,a,s,o)||r(e,i,a,s,o)||r(e,n,a,s,o)}e.createSquareGeometry=function(e=t){for(var r=new Array(12),i=0;i<4;i++)for(var n=0;n<3;n++)r[3*i+n]=e[i][n];var a=new Uint32Array([0,1,2,2,3,0]),s=new Uint32Array([0,0,0,0,0,0]);return new b.a([["position",{size:3,data:r,exclusive:!0}],["normal",{size:3,data:[0,0,1],exclusive:!0}],["uv0",{size:2,data:[0,0,1,0,1,1,0,1],exclusive:!0}],["color",{size:4,data:[255,255,255,255],exclusive:!0}]],[["position",a],["normal",s],["uv0",a],["color",s]])},e.createConeGeometry=function(e,t,r,i,n=!0,a=!0){var s=0,c=t,l=e,u=Object(o.c)(0,s,0),d=Object(o.c)(0,s+l,0),h=Object(o.c)(0,-1,0),p=Object(o.c)(0,1,0);i&&(s=l,d=Object(o.c)(0,0,0),u=Object(o.c)(0,s,0),h=Object(o.c)(0,1,0),p=Object(o.c)(0,-1,0));var f=[d,u],m=[h,p],v=r+2,g=Math.sqrt(l*l+c*c);if(i)for(var y=r-1;y>=0;y--){var O=y*(2*Math.PI/r),j=Object(o.c)(Math.cos(O)*c,s,Math.sin(O)*c);f.push(j);var _=Object(o.c)(l*Math.cos(O)/g,-c/g,l*Math.sin(O)/g);m.push(_)}else for(var w=0;w<r;w++){var x=w*(2*Math.PI/r),S=Object(o.c)(Math.cos(x)*c,s,Math.sin(x)*c);f.push(S);var M=Object(o.c)(l*Math.cos(x)/g,c/g,l*Math.sin(x)/g);m.push(M)}var T=new Uint32Array(2*(r+2)*3),E=new Uint32Array(2*(r+2)*3),P=0,C=0;if(n){for(var I=3;I<f.length;I++)T[P++]=1,T[P++]=I-1,T[P++]=I,E[C++]=0,E[C++]=0,E[C++]=0;T[P++]=f.length-1,T[P++]=2,T[P++]=1,E[C++]=0,E[C++]=0,E[C++]=0}if(a){for(var A=3;A<f.length;A++)T[P++]=A,T[P++]=A-1,T[P++]=0,E[C++]=A,E[C++]=A-1,E[C++]=1;T[P++]=0,T[P++]=2,T[P++]=f.length-1,E[C++]=1,E[C++]=2,E[C++]=m.length-1}for(var R=new Float32Array(3*v),F=0;F<v;F++)R[3*F]=f[F][0],R[3*F+1]=f[F][1],R[3*F+2]=f[F][2];for(var L=new Float32Array(3*v),D=0;D<v;D++)L[3*D]=m[D][0],L[3*D+1]=m[D][1],L[3*D+2]=m[D][2];return new b.a([["position",{size:3,data:R,exclusive:!0}],["normal",{size:3,data:L,exclusive:!0}]],[["position",T],["normal",E]])},e.createCylinderGeometry=function(e,t,r,i,n,a){var c=i?Object(o.a)(i):Object(o.c)(1,0,0),l=n?Object(o.a)(n):Object(o.c)(0,0,0);a=null==a||a;var u=Object(o.b)();Object(s.q)(u,c);var d=Object(o.b)();Object(s.d)(d,u,Math.abs(e));var h=Object(o.b)();Object(s.d)(h,d,-.5),Object(s.e)(h,h,l);var p=Object(o.c)(0,1,0);Math.abs(1-Object(s.g)(u,p))<.2&&Object(s.v)(p,0,0,1);var f=Object(o.b)();Object(s.f)(f,u,p),Object(s.q)(f,f),Object(s.f)(p,f,u);var m=2*r+(a?2:0),v=r+(a?2:0),g=new Float32Array(3*m),y=new Float32Array(3*v),O=new Float32Array(2*m),j=new Uint32Array(3*r*(a?4:2)),_=new Uint32Array(3*r*(a?4:2));a&&(g[3*(m-2)+0]=h[0],g[3*(m-2)+1]=h[1],g[3*(m-2)+2]=h[2],O[2*(m-2)]=0,O[2*(m-2)+1]=0,g[3*(m-1)+0]=g[3*(m-2)+0]+d[0],g[3*(m-1)+1]=g[3*(m-2)+1]+d[1],g[3*(m-1)+2]=g[3*(m-2)+2]+d[2],O[2*(m-1)]=1,O[2*(m-1)+1]=1,y[3*(v-2)+0]=-u[0],y[3*(v-2)+1]=-u[1],y[3*(v-2)+2]=-u[2],y[3*(v-1)+0]=u[0],y[3*(v-1)+1]=u[1],y[3*(v-1)+2]=u[2]);for(var w=function(e,t,r){j[e]=t,_[e]=r},x=0,S=Object(o.b)(),M=Object(o.b)(),T=0;T<r;T++){var E=T*(2*Math.PI/r);Object(s.d)(S,p,Math.sin(E)),Object(s.d)(M,f,Math.cos(E)),Object(s.e)(S,S,M),y[3*T+0]=S[0],y[3*T+1]=S[1],y[3*T+2]=S[2],Object(s.d)(S,S,t),Object(s.e)(S,S,h),g[3*T+0]=S[0],g[3*T+1]=S[1],g[3*T+2]=S[2],O[2*T+0]=T/r,O[2*T+1]=0,g[3*(T+r)+0]=g[3*T+0]+d[0],g[3*(T+r)+1]=g[3*T+1]+d[1],g[3*(T+r)+2]=g[3*T+2]+d[2],O[2*(T+r)+0]=T/r,O[2*T+1]=1;var P=(T+1)%r;w(x++,T,T),w(x++,T+r,T),w(x++,P,P),w(x++,P,P),w(x++,T+r,T),w(x++,P+r,P)}if(a){for(var C=0;C<r;C++){var I=(C+1)%r;w(x++,m-2,v-2),w(x++,C,v-2),w(x++,I,v-2)}for(var A=0;A<r;A++){var R=(A+1)%r;w(x++,A+r,v-1),w(x++,m-1,v-1),w(x++,R+r,v-1)}}return new b.a([["position",{size:3,data:g,exclusive:!0}],["normal",{size:3,data:y,exclusive:!0}],["uv0",{size:2,data:O,exclusive:!0}]],[["position",j],["normal",_],["uv0",j]])},e.createTubeGeometry=function(t,r,i,n,a){i=i||10,n=null==n||n,Object(p.a)(t.length>1);for(var s=[],o=[],c=0;c<i;c++){s.push([0,-c-1,-(c+1)%i-1]);var l=c/i*2*Math.PI;o.push([Math.cos(l)*r,Math.sin(l)*r])}return e.createPathExtrusionGeometry(o,t,[[0,0,0]],s,n,a)},e.createPathExtrusionGeometry=function(e,t,r,n,l,u=Object(o.c)(0,0,0)){var d=e.length,h=new Float32Array(t.length*d*3+(6*r.length||0)),p=new Float32Array(t.length*d*3+(r?6:0)),f=(t.length-1)*d*6+3*n.length*2,m=new Uint32Array(f),g=new Uint32Array(f),y=0,O=0,j=0,_=0,w=Object(o.b)(),x=Object(o.b)(),S=Object(o.b)(),M=Object(o.b)(),T=Object(o.b)(),E=Object(o.b)(),P=Object(o.b)(),C=Object(a.e)(),I=Object(o.b)(),A=Object(o.b)(),R=Object(o.b)(),F=Object(o.b)(),L=Object(o.b)(),D=c.e.create();Object(s.v)(I,0,1,0),Object(s.i)(x,t[1],t[0]),Object(s.q)(x,x),l?(Object(s.e)(C,t[0],u),Object(s.q)(S,C)):Object(s.v)(S,0,0,1),i(x,S,I,I,T,S,v),Object(s.j)(M,S),Object(s.j)(F,T);for(var k=0;k<r.length;k++)Object(s.d)(E,T,r[k][0]),Object(s.d)(C,S,r[k][2]),Object(s.e)(E,E,C),Object(s.e)(E,E,t[0]),h[y++]=E[0],h[y++]=E[1],h[y++]=E[2];p[O++]=-x[0],p[O++]=-x[1],p[O++]=-x[2];for(var z=0;z<n.length;z++)m[j++]=n[z][0]>0?n[z][0]:-n[z][0]-1+r.length,m[j++]=n[z][1]>0?n[z][1]:-n[z][1]-1+r.length,m[j++]=n[z][2]>0?n[z][2]:-n[z][2]-1+r.length,g[_++]=0,g[_++]=0,g[_++]=0;for(var V=r.length,N=r.length-1,U=0;U<t.length;U++){var B=!1;U>0&&(Object(s.j)(w,x),U<t.length-1?(Object(s.i)(x,t[U+1],t[U]),Object(s.q)(x,x)):B=!0,Object(s.e)(A,w,x),Object(s.q)(A,A),Object(s.e)(R,t[U-1],M),c.e.fromPositionAndNormal(t[U],A,D),c.e.intersectRay(D,c.f.wrap(R,w),C)?(Object(s.i)(C,C,t[U]),Object(s.q)(S,C),Object(s.f)(T,A,S),Object(s.q)(T,T)):i(A,M,F,I,T,S,v),Object(s.j)(M,S),Object(s.j)(F,T)),l&&(Object(s.e)(C,t[U],u),Object(s.q)(L,C));for(var q=0;q<d;q++)if(Object(s.d)(E,T,e[q][0]),Object(s.d)(C,S,e[q][1]),Object(s.e)(E,E,C),Object(s.q)(P,E),p[O++]=P[0],p[O++]=P[1],p[O++]=P[2],Object(s.e)(E,E,t[U]),h[y++]=E[0],h[y++]=E[1],h[y++]=E[2],!B){var G=(q+1)%d;m[j++]=V+q,m[j++]=V+d+q,m[j++]=V+G,m[j++]=V+G,m[j++]=V+d+q,m[j++]=V+d+G;for(var H=0;H<6;H++)g[_++]=m[j-6+H]-N}V+=d}for(var W=t[t.length-1],J=0;J<r.length;J++)Object(s.d)(E,T,r[J][0]),Object(s.d)(C,S,r[J][1]),Object(s.e)(E,E,C),Object(s.e)(E,E,W),h[y++]=E[0],h[y++]=E[1],h[y++]=E[2];var Z=O/3;p[O++]=x[0],p[O++]=x[1],p[O++]=x[2];for(var X=V-d,Y=0;Y<n.length;Y++)m[j++]=n[Y][0]>=0?V+n[Y][0]:-n[Y][0]-1+X,m[j++]=n[Y][2]>=0?V+n[Y][2]:-n[Y][2]-1+X,m[j++]=n[Y][1]>=0?V+n[Y][1]:-n[Y][1]-1+X,g[_++]=Z,g[_++]=Z,g[_++]=Z;return new b.a([["position",{size:3,data:h,exclusive:!0}],["normal",{size:3,data:p,exclusive:!0}]],[["position",m],["normal",g]])},e.createPolylineGeometry=function(e,t,r){Object(p.a)(e.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),Object(p.a)(3===e[0].length,"createPolylineGeometry(): malformed vertex"),Object(p.a)(null==t||t.length===e.length,"createPolylineGeometry: need same number of points and normals"),Object(p.a)(null==t||3===t[0].length,"createPolylineGeometry(): malformed normal");for(var i=new Float64Array(3*e.length),n=new Uint32Array(2*(e.length-1)),a=0,s=0,o=0;o<e.length;o++){for(var c=0;c<3;c++)i[a++]=e[o][c];o>0&&(n[s++]=o-1,n[s++]=o)}var l=[],u=[];if(l.push(["position",n]),u.push(["position",{size:3,data:i,exclusive:!0}]),t){for(var d=new Float32Array(3*t.length),h=0,m=0;m<e.length;m++)for(var v=0;v<3;v++)d[h++]=t[m][v];l.push(["normal",n]),u.push(["normal",{size:3,data:d,exclusive:!0}])}return r&&(u.push(["color",{size:4,data:r}]),l.push(["color",Object(f.d)(r.length/4)])),new b.a(u,l,2)},e.createExtrudedTriangle=function(e,t,r,i){for(var n=new Array(18),a=[[-t,0,i/2],[r,0,i/2],[0,e,i/2],[-t,0,-i/2],[r,0,-i/2],[0,e,-i/2]],s=new Uint16Array([0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5]),o=0;o<6;o++)n[3*o]=a[o][0],n[3*o+1]=a[o][1],n[3*o+2]=a[o][2];return new b.a([["position",{size:3,data:n,exclusive:!0}]],[["position",s]])},e.transformInPlace=function(e,t){for(var r=e.getMutableAttribute("position").data,i=0;i<r.length;i+=3){var n=r[i],a=r[i+1],o=r[i+2];Object(s.v)(g,n,a,o),Object(s.l)(g,g,t),r[i]=g[0],r[i+1]=g[1],r[i+2]=g[2]}},e.cgToGIS=function(e,t=e){var r=e.vertexAttributes,i=r.get("position").data,n=r.get("normal").data;if(n)for(var a=t.getMutableAttribute("normal").data,s=0;s<n.length;s+=3){var o=n[s+1];a[s+1]=-n[s+2],a[s+2]=o}if(i)for(var c=t.getMutableAttribute("position").data,l=0;l<i.length;l+=3){var u=i[l+1];c[l+1]=-i[l+2],c[l+2]=u}return t},e.makeOrthoBasisDirUp=r,e.makeOrthoBasisDirUpFallback=i}(h||(h={}));var v=.99619469809,g=Object(o.b)(),y=h;t.a=y},,function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var i=r(112),n=r(117),a=r(292),s=r(316),o=r(178),c=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class l{constructor(e){this.options=e,this.geometryTypes=c,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new s.a}prepareFeatures(e){this._vertexDimension=2,e.hasZ&&this._vertexDimension++,e.hasM&&this._vertexDimension++}finishFeatureResult(e){if(e&&e.features&&e.hasZ&&this.options.sourceSpatialReference&&e.spatialReference&&!Object(i.c)(e.spatialReference,this.options.sourceSpatialReference)&&!e.spatialReference.vcsWkid){var t=Object(n.g)(this.options.sourceSpatialReference)/Object(n.g)(e.spatialReference);if(1!==t)for(var r of e.features)if(r.geometry&&r.geometry.coords)for(var a=r.geometry.coords,s=2;s<a.length;s+=3)a[s]*=t}}addFeature(e,t){e.features.push(t)}createFeature(){return new a.a}createSpatialReference(){return{wkid:0}}createGeometry(){return new o.a}addField(e,t){e.fields.push(t)}allocateCoordinates(e){e.coords.length=e.lengths.reduce(((e,t)=>e+t),0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(e,t){e.coords[this._coordinatePtr++]=t}addCoordinatePoint(e,t){e.coords.push(t)}addLength(e,t){e.lengths.push(t)}addQueryGeometry(e,t){e.queryGeometry=t.queryGeometry,e.queryGeometryType=t.queryGeometryType}createPointGeometry(){return new o.a}}},function(e,t,r){"use strict";function i(){return new Float32Array(4)}function n(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,r,i){var n=new Float32Array(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function s(){return i()}function o(){return a(1,1,1,1)}function c(){return a(1,0,0,0)}function l(){return a(0,1,0,0)}function u(){return a(0,0,1,0)}function d(){return a(0,0,0,1)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a}));var h=s(),p=o(),f=c(),b=l(),m=u(),v=d();Object.freeze({__proto__:null,create:i,clone:n,fromValues:a,createView:function(e,t){return new Float32Array(e,t,4)},zeros:s,ones:o,unitX:c,unitY:l,unitZ:u,unitW:d,ZEROS:h,ONES:p,UNIT_X:f,UNIT_Y:b,UNIT_Z:m,UNIT_W:v})},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return v})),r.d(t,"g",(function(){return O}));var i=r(89),n=r(105),a=r(104),s=r(111),o=r(299),c=r(135),l=r(177);function u(e){return e?{origin:Object(a.d)(e.origin),direction:Object(a.d)(e.direction)}:{origin:Object(a.e)(),direction:Object(a.e)()}}function d(e,t=u()){return h(e.origin,e.direction,t)}function h(e,t,r=u()){return Object(s.j)(r.origin,e),Object(s.j)(r.direction,t),r}function p(e,t,r=u()){var a=Object(n.b)(Object(c.c)(l.d.get(),t));if(a[2]=0,!e.unprojectFromRenderScreen(a,r.origin))return null;var o=Object(n.b)(Object(c.c)(l.d.get(),t));o[2]=1;var d=e.unprojectFromRenderScreen(o,l.d.get());return Object(i.j)(d)?null:(Object(s.i)(r.direction,d,r.origin),r)}function f(e,t,r=u()){return b(e,e.screenToRender(t,Object(n.b)(l.d.get())),r)}function b(e,t,r=u()){Object(s.j)(r.origin,e.eye);var n=Object(s.v)(l.d.get(),t[0],t[1],1),a=e.unprojectFromRenderScreen(n,l.d.get());return Object(i.j)(a)?null:(Object(s.i)(r.direction,a,r.origin),r)}function m(e,t){var r=Object(s.f)(l.d.get(),Object(s.q)(l.d.get(),e.direction),Object(s.i)(l.d.get(),t,e.origin));return Object(s.g)(r,r)}function v(e,t,r){var i=Object(s.g)(e.direction,Object(s.i)(r,t,e.origin));return Object(s.e)(r,e.origin,Object(s.d)(r,e.direction,i)),r}function g(){return{origin:null,direction:null}}var y=new o.a(g),O=Object.freeze({__proto__:null,create:u,wrap:function(e,t){var r=y.get();return r.origin=e,r.direction=t,r},copy:d,fromPoints:function(e,t,r=u()){return Object(s.j)(r.origin,e),Object(s.i)(r.direction,t,e),r},fromValues:h,fromScreen:function(e,t,r=u()){return p(e,e.screenToRender(t,Object(n.b)(l.d.get())),r)},fromRender:p,fromScreenAtEye:f,fromRenderAtEye:b,distance2:m,distance:function(e,t){return Math.sqrt(m(e,t))},closestPoint:v,createWrapper:g})},function(e,t,r){"use strict";var i,n=r(82),a=(r(80),r(81),r(88)),s=r(85),o=r(84),c=(r(83),r(86),r(87),r(90));var l={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}},u=i=class extends c.a{constructor(e){super(e),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){var{exifInfo:e}=this,t=function(e){var{exifInfo:t,exifName:r,tagName:i}=e;if(!t||!r||!i)return null;var n=t.find((e=>e.name===r));return n?function(e){var{tagName:t,tags:r}=e;if(!r||!t)return null;var i=r.find((e=>e.name===t));return i&&i.value||null}({tagName:i,tags:n.tags}):null}({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:e});return l[t]||null}clone(){return new i({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};Object(n.a)([Object(s.b)({type:String})],u.prototype,"contentType",void 0),Object(n.a)([Object(s.b)()],u.prototype,"exifInfo",void 0),Object(n.a)([Object(s.b)({readOnly:!0})],u.prototype,"orientationInfo",null),Object(n.a)([Object(s.b)({type:a.a})],u.prototype,"id",void 0),Object(n.a)([Object(s.b)({type:String})],u.prototype,"globalId",void 0),Object(n.a)([Object(s.b)({type:String})],u.prototype,"keywords",void 0),Object(n.a)([Object(s.b)({type:String})],u.prototype,"name",void 0),Object(n.a)([Object(s.b)({json:{read:!1}})],u.prototype,"parentGlobalId",void 0),Object(n.a)([Object(s.b)({json:{read:!1}})],u.prototype,"parentObjectId",void 0),Object(n.a)([Object(s.b)({type:a.a})],u.prototype,"size",void 0),Object(n.a)([Object(s.b)({json:{read:!1}})],u.prototype,"url",void 0);var d=u=i=Object(n.a)([Object(o.a)("esri.layers.support.AttachmentInfo")],u);t.a=d},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return l}));var i=r(104),n=r(111),a=r(505),s=(()=>{for(var e=new Uint32Array(131072),t=0;t<e.length;++t)e[t]=t;return e})(),o=new Uint16Array([0]),c=(()=>{for(var e=new Uint16Array(65536),t=0;t<e.length;++t)e[t]=t;return e})();function l(e){if(1===e)return o;if(e<c.length)return new Uint16Array(c.buffer,0,e);if(e>s.length){var t=Math.max(2*s.length,e);s=new Uint32Array(t);for(var r=0;r<s.length;r++)s[r]=r}return new Uint32Array(s.buffer,0,e)}function u(e,t,r){if(!e)return!1;var{size:i,data:s}=e;Object(n.v)(r,0,0,0),Object(n.v)(m,0,0,0);for(var o=0,c=0,l=0;l<t.length-2;l+=3){var u=t[l+0]*i,d=t[l+1]*i,h=t[l+2]*i;Object(n.v)(p,s[u+0],s[u+1],s[u+2]),Object(n.v)(f,s[d+0],s[d+1],s[d+2]),Object(n.v)(b,s[h+0],s[h+1],s[h+2]);var v=Object(a.a)(p,f,b);v?(Object(n.e)(p,p,f),Object(n.e)(p,p,b),Object(n.d)(p,p,1/3*v),Object(n.e)(r,r,p),o+=v):(Object(n.e)(m,m,p),Object(n.e)(m,m,f),Object(n.e)(m,m,b),c+=3)}return(0!==c||0!==o)&&(0!==o?(Object(n.d)(r,r,1/o),!0):0!==c&&(Object(n.d)(r,m,1/c),!0))}function d(e,t,r){if(!e||!t)return!1;var{size:i,data:a}=e;Object(n.v)(r,0,0,0);for(var s=-1,o=0,c=0;c<t.length;c++){var l=t[c]*i;s!==l&&(r[0]+=a[l+0],r[1]+=a[l+1],r[2]+=a[l+2],o++),s=l}return o>1&&Object(n.d)(r,r,1/o),o>0}function h(e,t,r,i){if(!e)return!1;var{size:a,data:s}=e;Object(n.v)(i,0,0,0),Object(n.v)(m,0,0,0);for(var o=0,c=0,l=t?t.length-1:s.length/a-1,u=l+(r?2:0),d=0;d<u;d+=2){var h=d<l?d:l,b=d<l?d+1:0,v=(t?t[h]:h)*a,g=(t?t[b]:b)*a;p[0]=s[v+0],p[1]=s[v+1],p[2]=s[v+2],f[0]=s[g+0],f[1]=s[g+1],f[2]=s[g+2],Object(n.d)(p,Object(n.e)(p,p,f),.5);var y=Object(n.z)(p,f);y>0?(Object(n.e)(i,i,Object(n.d)(p,p,y)),o+=y):(Object(n.e)(m,m,p),c++)}return 0!==o?(Object(n.d)(i,i,1/o),!0):0!==c&&(Object(n.d)(i,m,1/c),!0)}var p=Object(i.e)(),f=Object(i.e)(),b=Object(i.e)(),m=Object(i.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c}));var i=r(89),n=r(306),a=r(348),s=r(328);class o extends a.a{constructor(e,t){super(),this.type=3,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=n.a,this._params=Object(s.c)(e,t),this.validateParameterValues(this._params)}dispose(){}get params(){return this._params}update(e){return!1}setParameterValues(e){Object(s.f)(this._params,e)&&(this.validateParameterValues(this._params),this.parametersChanged())}validateParameterValues(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}isVisibleInPass(e){return!0}get renderOccluded(){return this.params.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){Object(i.k)(this.materialRepository)&&this.materialRepository.materialChanged(this)}}function c(e,t){return e.isVisible()&&e.isVisibleInPass(t.pass)&&0!=(e.renderOccluded&t.renderOccludedMask)}var l={renderOccluded:1}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i,n=r(157),a=r(580);!function(e){function t(e,t,r){Object(n.s)(s,r,t),e.setUniform3fv("localOrigin",t),e.setUniformMatrix4fv("view",s)}e.bindCamPosition=function(e,t,r){e.setUniform3f("camPos",r[3]-t[0],r[7]-t[1],r[11]-t[2])},e.bindProjectionMatrix=function(e,t){e.setUniformMatrix4fv("proj",t)},e.bindNearFar=function(e,t){e.setUniform2fv("nearFar",t)},e.bindViewCustomOrigin=t,e.bindView=function(e,r){t(e,r.origin,r.camera.viewMatrix)},e.bindViewport=function(e,t){e.setUniform4fv("viewport",t.camera.fullViewport)}}(i||(i={}));var s=Object(a.a)()},,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(387);function n(e,t){var r=Object(i.a)(e,t),n=r.queryResult.featureResult,a=r.queryResult.queryGeometry,s=r.queryResult.queryGeometryType;if(n&&n.features&&n.features.length&&n.objectIdFieldName){var o=n.objectIdFieldName;for(var c of n.features)c.attributes&&(c.objectId=c.attributes[o])}return n&&(n.queryGeometry=a,n.queryGeometryType=s),n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return M}));var i=r(89),n=r(81),a=r(93),s=r(178),o=r(372),c=r(362),l=n.a.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),u=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],d=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],h=["upperLeft","lowerLeft"];function p(e){return e>=u.length?null:u[e]}function f(e){return e>=d.length?null:d[e]}function b(e){return e>=h.length?null:h[e]}function m(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function v(e,t,r){for(var i=t.createPointGeometry(r);e.next();)switch(e.tag()){case 3:for(var n=e.getUInt32(),a=e.pos()+n,s=0;e.pos()<a;)t.addCoordinatePoint(i,e.getSInt64(),s++);break;case 1:case 2:default:e.skip()}return i}function g(e,t,r){for(var i=t.createGeometry(r),n=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var a=e.getUInt32(),s=e.pos()+a,o=0;e.pos()<s;)t.addLength(i,e.getUInt32(),o++);break;case 3:var c=e.getUInt32(),l=e.pos()+c,u=0;for(t.allocateCoordinates(i);e.pos()<l;)t.addCoordinate(i,e.getSInt64(),u),++u===n&&(u=0);break;case 1:default:e.skip()}return i}function y(e){for(var t=new s.a,r="esriGeometryPoint";e.next();)switch(e.tag()){case 2:for(var i=e.getUInt32(),n=e.pos()+i;e.pos()<n;)t.lengths.push(e.getUInt32());break;case 3:for(var a=e.getUInt32(),c=e.pos()+a;e.pos()<c;)t.coords.push(e.getSInt64());break;case 1:r=o.a[e.getEnum()];break;default:e.skip()}return{queryGeometry:t,queryGeometryType:r}}function O(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function j(e){for(var t={type:p(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=p(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=f(e.getEnum());break;case 5:try{t.domain=JSON.parse(e.getString())}catch(b){l.error(new a.a("query:parsing-pbf","Failed to parse domain",{error:b})),t.domain=null}break;case 6:t.defaultValue=e.getString();break;default:e.skip()}return t}function _(e){for(var t={};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip()}return t}function w(e,t,r,i){for(var n=t.createFeature(r),a=0;e.next();)switch(e.tag()){case 1:var s=i[a++].name;n.attributes[s]=e.processMessage(O);break;case 2:n.geometry=e.processMessageWithArgs(g,t,r);break;case 4:n.centroid=e.processMessageWithArgs(v,t,r);break;default:e.skip()}return n}function x(e){for(var t=[1,1,1,1];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function S(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function M(e){for(var t={originPosition:b(0)};e.next();)switch(e.tag()){case 1:t.originPosition=b(e.getEnum());break;case 2:t.scale=e.processMessage(x);break;case 3:t.translate=e.processMessage(S);break;default:e.skip()}return t}function T(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function E(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:r.latestWkid=e.getUInt32();break;case 3:r.vcsWkid=e.getUInt32();break;case 4:r.latestVcsWkid=e.getUInt32();break;default:e.skip()}return r}function P(e,t){var r=t.createFeatureResult();r.geometryType=m(t,0);for(var i=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(T);break;case 7:r.geometryType=m(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(E,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(M);break;case 9:var n=e.getBool();r.exceededTransferLimit=n;break;case 13:t.addField(r,e.processMessage(j));break;case 15:i||(t.prepareFeatures(r),i=!0),t.addFeature(r,e.processMessageWithArgs(w,t,r,r.fields));break;case 2:r.uniqueIdField=e.processMessage(_);break;case 6:default:e.skip()}return t.finishFeatureResult(r),r}function C(e,t){for(var r={},n=null;e.next();)switch(e.tag()){case 4:n=e.processMessageWithArgs(y);break;case 1:r.featureResult=e.processMessageWithArgs(P,t);break;case 2:case 3:default:e.skip()}return Object(i.k)(n)&&r.featureResult&&t.addQueryGeometry(r,n),r}function I(e,t){try{for(var r=new c.a(new Uint8Array(e),new DataView(e)),i={};r.next();)switch(r.tag()){case 2:i.queryResult=r.processMessageWithArgs(C,t);break;default:r.skip()}return i}catch(n){throw new a.a("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:n})}}},function(e,t,r){"use strict";var i=r(569);class n extends i.a{constructor(e){super(),this.material=e.material,this.techniqueRep=e.techniqueRep,this.output=e.output}getTechnique(){return this.technique}getPipelineState(e,t){return this.getTechnique().pipeline}ensureResources(e){return 2}ensureParameters(e){}}t.a=n},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));r(114),r(261),r(163),r(80),r(81),r(288);r(301),r(129);function i(e){return e&&"function"==typeof e.render}function n(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}},,,,,,,function(e,t,r){"use strict";function i(){return[0,0,0,1]}function n(e,t){return new Float64Array(e,t,4)}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var a=[0,0,0,1];Object.freeze({__proto__:null,create:i,clone:function(e){return[e[0],e[1],e[2],e[3]]},fromValues:function(e,t,r,i){return[e,t,r,i]},createView:n,IDENTITY:a})},function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return d})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return _})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return b})),r.d(t,"i",(function(){return v})),r.d(t,"j",(function(){return g})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return y})),r.d(t,"m",(function(){return f}));var i=r(91),n=r(92),a=r(89),s=(r(217),r(161)),o=r(110),c=r(105),l=r(568);function u(e,t){return e.events.on("drag",function(e,t){var r=null,i=null;return n=>{if("cancel"!==n.action){var s={action:n.action,screenStart:n.start,screenEnd:n.screenPoint};"start"===n.action&&Object(a.j)(r)&&(r=new w,i=new w,t(e,r,i,n.pointerType,s)),Object(a.k)(r)&&r.execute(s),"end"===n.action&&Object(a.k)(r)&&(r=null,i=null)}else Object(a.k)(i)&&(i.execute({action:"cancel"}),r=null,i=null)}}(e,t))}function d(e,t){var r=[e.x,e.y,e.z],i=t,n=[Math.cos(i),Math.sin(i)],a=Math.sqrt(n[0]*n[0]+n[1]*n[1]);if(0===a)return null;n[0]/=a,n[1]/=a;var s=e=>{var t=(e.x-r[0])*n[0]+(e.y-r[1])*n[1];e.x=r[0]+t*n[0],e.y=r[1]+t*n[1]};return e=>(s(e.mapStart),s(e.mapEnd),e)}function h(e,t){var r=null,n=Object(a.k)(e[t])?e[t].spatialReference:null;return o=>{if("start"===o.action&&Object(a.k)(e[t])&&(r=function(e,t){return Object(a.j)(e)||"mesh"===e.type?null:e.spatialReference.equals(t)?e.clone():Object(s.a)(e,t)?Object(s.d)(e,t):null}(e[t],o.mapStart.spatialReference)),Object(a.j)(r))return null;var c=o.mapEnd.x-o.mapStart.x,u=o.mapEnd.y-o.mapStart.y,d=o.mapEnd.z-o.mapStart.z,h=Object(l.d)(r.clone(),c,u,d);return h.spatialReference.equals(n)?e[t]=h:e[t]=Object(s.d)(h,n),Object(i.a)(Object(i.a)({},o),{},{translationX:c,translationY:u,translationZ:d})}}function p(e){return h(e,"geometry")}function f(e,t=null,r){var n=null,o=Object(a.k)(t)&&!e.spatialReference.equals(t)?e=>Object(a.k)(e)?Object(s.d)(e,t):e:e=>e,c=Object(i.a)({exclude:[]},r);return t=>{if("start"===t.action&&(n=o(e.toMap(t.screenStart,c))),Object(a.j)(n))return null;var r=o(e.toMap(t.screenEnd,c));return Object(a.k)(r)?Object(i.a)(Object(i.a)({},t),{},{mapStart:n,mapEnd:r}):null}}function b(e){var t=e.map((e=>Object(a.q)(p(e)))).filter((e=>Object(a.k)(e)));return e=>{var r=e.mapEnd.x-e.mapStart.x,n=e.mapEnd.y-e.mapStart.y,a=e.mapEnd.z-e.mapStart.z;return t.forEach((t=>t(e))),Object(i.a)(Object(i.a)({},e),{},{translationX:r,translationY:n,translationZ:a})}}function m(e,t){var r=new Map;for(var i of t)r.set(i,Object(n.a)(e[i]));return t=>(r.forEach(((t,r)=>{e[r]=t})),t)}function v(e){return m(e,["geometry"])}function g(e){var t=e.map((e=>Object(a.q)(v(e)))).filter((e=>Object(a.k)(e)));return e=>(t.forEach((t=>t(e))),e)}function y(e){var t=Object(a.k)(e.symbol)?e.symbol.clone():null;return r=>(e.symbol=t,r)}function O(){var e=0,t=0,r=0;return n=>{"start"===n.action&&(e=n.mapStart.x,t=n.mapStart.y,r=n.mapStart.z);var a=n.mapEnd.x-e,s=n.mapEnd.y-t,o=n.mapEnd.z-r;return e=n.mapEnd.x,t=n.mapEnd.y,r=n.mapEnd.z,Object(i.a)(Object(i.a)({},n),{},{mapDeltaX:a,mapDeltaY:s,mapDeltaZ:o,mapDeltaSpatialReference:n.mapStart.spatialReference})}}function j(){var e=0,t=0;return r=>{"start"===r.action&&(e=r.screenStart.x,t=r.screenStart.y);var n=r.screenEnd.x-e,a=r.screenEnd.y-t;return e=r.screenEnd.x,t=r.screenEnd.y,Object(i.a)(Object(i.a)({},r),{},{screenDeltaX:n,screenDeltaY:a})}}function _(e,t){var r=null,i=0,n=0;return a=>{if("start"===a.action&&((r=e.toScreen(t)).x<0||r.x>e.width||r.y<0||r.y>e.height?r=null:(i=a.screenStart.x-r.x,n=a.screenStart.y-r.y)),null==r)return null;var s=Object(o.d)(a.screenEnd.x-i,0,e.width),l=Object(o.d)(a.screenEnd.y-n,0,e.height),u=Object(c.f)(s,l);return a.screenStart=r,a.screenEnd=u,a}}class w{constructor(){this.execute=()=>{}}next(e,t=new w){return Object(a.k)(e)&&(this.execute=r=>{var i=e(r);Object(a.k)(i)&&t.execute(i)}),t}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return O})),r.d(t,"d",(function(){return I}));r(80);var i=r(89),n=r(81),a=r(110),s=r(104),o=r(111),c=r(330),l=r(157),u=r(200),d=r(191),h=r(177),p=r(347),f=r(374),b=n.a.getLogger("esri.views.3d.support.geometryUtils.sphere");function m(){return Object(u.c)()}function v(e,t=m()){return Object(d.c)(t,e)}function g(e){e[0]=e[1]=e[2]=e[3]=0}function y(e){return Array.isArray(e)?e[3]:e}function O(e){return Array.isArray(e)?e:P}function j(e,t,r){if(Object(i.j)(t))return!1;var n=Object(o.i)(h.d.get(),t.origin,O(e)),a=Object(o.g)(t.direction,t.direction),s=2*Object(o.g)(t.direction,n),c=s*s-4*a*(Object(o.g)(n,n)-e[3]*e[3]);if(c<0)return!1;var l=Math.sqrt(c),u=(-s-l)/(2*a),d=(-s+l)/(2*a);return(u<0||d<u&&d>0)&&(u=d),!(u<0)&&(r&&Object(o.e)(r,t.origin,Object(o.d)(h.d.get(),t.direction,u)),!0)}function _(e,t,r){var i=h.d.get(),n=h.a.get();Object(o.f)(i,t.origin,t.direction);var a=y(e);Object(o.f)(r,i,t.origin),Object(o.d)(r,r,1/Object(o.o)(r)*a);var s=x(e,t.origin),c=Object(p.a)(t.origin,r);return Object(l.i)(n),Object(l.q)(n,n,c+s,i),Object(o.l)(r,r,n),r}function w(e,t,r){var i=Object(o.i)(h.d.get(),t,O(e)),n=Object(o.d)(h.d.get(),i,e[3]/Object(o.o)(i));return Object(o.e)(r,n,O(e))}function x(e,t){var r=Object(o.i)(h.d.get(),t,O(e)),i=Object(o.o)(r),n=y(e),s=n+Math.abs(n-i);return Object(a.b)(n/s)}var S=Object(s.e)();function M(e,t,r,i){var n=Object(o.i)(S,t,O(e));switch(r){case 0:var a=Object(c.a)(n,S)[2];return Object(o.v)(i,-Math.sin(a),Math.cos(a),0);case 1:var s=Object(c.a)(n,S),l=s[1],u=s[2],d=Math.sin(l);return Object(o.v)(i,-d*Math.cos(u),-d*Math.sin(u),Math.cos(l));case 2:return Object(o.q)(i,n);default:return}}function T(e,t){var r=Object(o.i)(C,t,O(e));return Object(o.o)(r)-e[3]}var E=Object(f.b)(),P=Object(s.e)(),C=Object(s.e)();Object.freeze(P);var I=Object.freeze({__proto__:null,create:m,copy:v,fromCenterAndRadius:function(e,t){return Object(u.d)(e[0],e[1],e[2],t)},wrap:function(e){return e},clear:g,fromRadius:function(e){return e},getRadius:y,getCenter:O,fromValues:function(e,t,r,i){return Object(u.d)(e,t,r,i)},elevate:function(e,t,r){return e!==r&&Object(o.j)(r,e),r[3]=e[3]+t,r},setExtent:function(e,t,r){return b.error("sphere.setExtent is not yet supported"),e===r?r:v(e,r)},intersectRay:j,intersectScreen:function(e,t,r,i){return j(e,Object(f.e)(t,r,E),i)},intersectsRay:function(e,t){return j(e,t,null)},intersectRayClosestSilhouette:function(e,t,r){if(j(e,t,r))return r;var i=_(e,t,h.d.get());return Object(o.e)(r,t.origin,Object(o.d)(h.d.get(),t.direction,Object(o.n)(t.origin,i)/Object(o.o)(t.direction))),r},closestPointOnSilhouette:_,closestPoint:function(e,t,r){return j(e,t,r)?r:(Object(f.f)(t,O(e),r),w(e,r,r))},projectPoint:w,distanceToSilhouette:function(e,t){var r=Object(o.i)(h.d.get(),t,O(e)),i=Object(o.r)(r),n=e[3]*e[3];return Math.sqrt(Math.abs(i-n))},angleToSilhouette:x,axisAt:M,altitudeAt:T,setAltitudeAt:function(e,t,r,i){var n=T(e,t),a=M(e,t,2,C),s=Object(o.d)(C,a,r-n);return Object(o.e)(i,t,s),i}})},,,,,function(e,t,r){"use strict";var i=r(213);t.a=class{constructor(e,t){this._storage=new i.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t){this._storage.put(e,t,1,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(81);class n{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;var t=e.modifiers;for(var r of this.keyModifiers)if(!t.has(r))return!1;return!0}}var a=i.a.getLogger("esri.views.input.InputHandler");class s{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches)for(var e in this._incomingEventMatches=[],this._incoming){var t=this._incoming[e];for(var r of t)this._incomingEventMatches.push(r.match)}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?a.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e)}onUninstall(){}registerIncoming(e,t,r){var i;"function"==typeof t?(r=t,i=[]):i=t||[];var a="string"==typeof e?new n(e,i):e,s=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},c=e=>{var t=this._incoming[e.match.eventType];if(t){var r=t.indexOf(e);t.splice(r,1),s(),this._manager&&this._manager.updateDependencies()}},l=new o(a,r,{onPause:c,onRemove:c,onResume:e=>{var t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),s(),this._manager&&this._manager.updateDependencies())}}),u=this._incoming[a.eventType];return u||(u=[],this._incoming[a.eventType]=u),u.push(l),s(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);var t=new c(e,{onEmit:(e,t,r,i)=>{this._manager.emit(e.eventType,t,r,i)},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0)}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1)}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):a.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var t=this._incoming[e.type];if(t)for(var r of t)if(r.match.matches(e)&&(r.callback(e),e.shouldStopPropagation()))break}}class o{constructor(e,t,r){this.match=e,this._callback=t,this._handler=r}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class c{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,r){this._removed||this._handler.onEmit(this,e,t,r)}remove(){this._removed=!0,this._handler.onRemove(this)}}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i,n,a=r(120),s=r(119);function o(e,t){t.linearDepth?e.vertex.code.add(Object(s.a)(i||(i=Object(a.a)(["\n    vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\n      vec4 eye = view * vec4(pos, 1.0);\n      depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\n      return proj * eye;\n    }\n    "])))):e.vertex.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\n      // Make sure the order of operations is the same as in transformPositionWithDepth.\n      return proj * (view * vec4(pos, 1.0));\n    }\n    "]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return z})),r.d(t,"d",(function(){return D})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return v})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return m}));var i=r(7),n=r(80),a=r(89),s=r(109),o=r(105),c=r(527),l=r(138),u=r(201),d=r(104),h=r(422),p=/\/resource\/(.*?)\.svg$/,f=new s.a("white");function b(e){if(!e)return 0;if(Object(l.c)(e)){var t=function(e){var t=e.symbolLayers&&e.symbolLayers.length;if(t){var r=e.symbolLayers.getItemAt(t-1);return"outline"in r?Object(a.i)(r,"outline","size"):void 0}}(e);return Object(a.k)(t)?t:0}var r=Object(h.d)(e);return r&&Object(o.i)(r.width)||0}function m(e){if(!e||!e.symbolLayers)return!1;switch(e.type){case"point-3d":return e.symbolLayers.some((e=>"object"===e.type));case"line-3d":return e.symbolLayers.some((e=>"path"===e.type));case"polygon-3d":return e.symbolLayers.some((e=>"object"===e.type||"extrude"===e.type));default:return!1}}function v(e,t){var r=t.resource.href;return!Object(n.a)("esri-canvas-svg-support")&&e.styleOrigin&&p.test(r)?r.replace(p,"/resource/png/$1.png"):r}function g(e,t){if(!e)return null;var r=null;return Object(l.c)(e)?r=function(e){var t=e.symbolLayers;if(!t)return null;var r=null;return t.forEach((e=>{"object"===e.type&&null!=e.resource.href||(r="water"===e.type?Object(a.q)(e.color):Object(a.k)(e.material)?Object(a.q)(e.material.color):null)})),r?new s.a(r):null}(e):Object(l.b)(e)&&(r=e.color?new s.a(e.color):null),r?y(r,t):null}function y(e,t){if(null==t)return e;var r=e.toRgba();return r[3]=r[3]*t,new s.a(r)}function O(e,t,r){e&&(t||null!=r)&&(t&&(t=new s.a(t)),Object(l.c)(e)?function(e,t,r){var i=e.symbolLayers;if(i){var n=e=>{var i=Object(a.k)(e)?e:null;return y(t=t||i||null!=r&&f,r)};i.forEach((e=>{if("object"!==e.type||null==e.resource.href||t)if("water"===e.type)e.color=n(e.color);else{var i=Object(a.k)(e.material)?e.material.color:null,s=n(i);Object(a.j)(e.material)?e.material=new c.a({color:s}):e.material.color=s,null!=r&&"outline"in e&&Object(a.k)(e.outline)&&Object(a.k)(e.outline.color)&&(e.outline.color=y(e.outline.color,r))}}))}}(e,t,r):Object(l.b)(e)&&function(e,t,r){(t=t||e.color)&&(e.color=y(t,r)),null!=r&&"outline"in e&&e.outline&&e.outline.color&&(e.outline.color=y(e.outline.color,r))}(e,t,r))}function j(e,t){return _.apply(this,arguments)}function _(){return(_=Object(i.a)((function*(e,t){var r=e.symbolLayers;r&&(yield Object(u.a)(r,function(){var e=Object(i.a)((function*(e){return w(e,t)}));return function(t){return e.apply(this,arguments)}}()))}))).apply(this,arguments)}function w(e,t){return x.apply(this,arguments)}function x(){return(x=Object(i.a)((function*(e,t){switch(e.type){case"extrude":T(e,t);break;case"icon":case"line":case"text":S(e,t);break;case"path":C(e,t);break;case"object":yield E(e,t)}}))).apply(this,arguments)}function S(e,t){var r=M(t);Object(a.k)(r)&&(e.size=r)}function M(e){for(var t of e)if("number"==typeof t)return t;return null}function T(e,t){e.size="number"==typeof t[2]?t[2]:0}function E(e,t){return P.apply(this,arguments)}function P(){return(P=Object(i.a)((function*(e,t){var{resourceSize:r,symbolSize:i}=yield A(e),n=I(t,r,i);e.width=F(t[0],i[0],r[0],n),e.depth=F(t[1],i[1],r[1],n),e.height=F(t[2],i[2],r[2],n)}))).apply(this,arguments)}function C(e,t){var r=I(t,d.a,[e.width,void 0,e.height]);e.width=F(t[0],e.width,1,r),e.height=F(t[2],e.height,1,r)}function I(e,t,r){for(var i=0;i<3;i++){var n=e[i];switch(n){case"symbol-value":return null!=r[i]?r[i]/t[i]:1;case"proportional":break;default:if(n&&t[i])return n/t[i]}}return 1}function A(e){return R.apply(this,arguments)}function R(){return(R=Object(i.a)((function*(e){for(var t=yield r.e(199).then(r.bind(null,655)),i=yield t.computeObjectLayerResourceSize(e,10),{width:n,height:a,depth:s}=e,o=[n,s,a],c=1,l=0;l<3;l++)if(null!=o[l]){c=o[l]/i[l];break}for(var u=0;u<3;u++)null==o[u]&&(o[u]=i[u]*c);return{resourceSize:i,symbolSize:o}}))).apply(this,arguments)}function F(e,t,r,i){switch(e){case"proportional":return r*i;case"symbol-value":return null!=t?t:r;default:return e}}function L(e,t){var r=M(t);if(!Object(a.j)(r))switch(e.type){case"simple-marker":e.size=r;break;case"picture-marker":var i=e.width/e.height;i>1?(e.width=r,e.height=r*i):(e.width=r*i,e.height=r);break;case"simple-line":e.width=r;break;case"text":e.font.size=r}}function D(e,t){return k.apply(this,arguments)}function k(){return(k=Object(i.a)((function*(e,t){if(e&&t)return Object(l.c)(e)?j(e,t):void(Object(l.b)(e)&&L(e,t))}))).apply(this,arguments)}function z(e,t,r){if(e&&null!=t)if(Object(l.c)(e)){var i=e.symbolLayers;i&&i.forEach((e=>{if(e&&"object"===e.type)switch(r){case"tilt":e.tilt=t;break;case"roll":e.roll=t;break;default:e.heading=t}}))}else Object(l.b)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle=t))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(80),r(89);function i(e,t){return!!n(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}function n(e,t){return e===t||e&&t&&e.equals(t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i,n=r(120),a=r(119);function s(e){e.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    // This is the maximum float value representable as 32bit fixed point,\n    // it is rgba2float(vec4(1)) inlined.\n    const float MAX_RGBA_FLOAT =\n      255.0 / 256.0 +\n      255.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 +\n      255.0 / 256.0 / 256.0 / 256.0 / 256.0;\n\n    // Factors to convert to fixed point, i.e. factors (256^0, 256^1, 256^2, 256^3)\n    const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\n\n    vec4 float2rgba(const float value) {\n      // Make sure value is in the domain we can represent\n      float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\n\n      // Decompose value in 32bit fixed point parts represented as\n      // uint8 rgba components. Decomposition uses the fractional part after multiplying\n      // by a power of 256 (this removes the bits that are represented in the previous\n      // component) and then converts the fractional part to 8bits.\n      vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\n\n      // Convert uint8 values (from 0 to 255) to floating point representation for\n      // the shader\n      const float toU8AsFloat = 1.0 / 255.0;\n\n      return fixedPointU8 * toU8AsFloat;\n    }\n\n    // Factors to convert rgba back to float\n    const vec4 RGBA_2_FLOAT_FACTORS = vec4(\n      255.0 / (256.0),\n      255.0 / (256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0),\n      255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n    );\n\n    float rgba2float(vec4 rgba) {\n      // Convert components from 0->1 back to 0->255 and then\n      // add the components together with their corresponding\n      // fixed point factors, i.e. (256^1, 256^2, 256^3, 256^4)\n      return dot(rgba, RGBA_2_FLOAT_FACTORS);\n    }\n  "]))))}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return b}));var i=r(109),n=r(105),a=r(106),s=r(162),o=r(403),c=r(423),l="picture-fill",u="simple-fill",d="simple-marker",h=new o.a(1e3);function p(e){var t=e.style,r=null;if(e)switch(e.type){case d:"cross"!==t&&"x"!==t&&(r=e.color);break;case u:"solid"===t?r=e.color:"none"!==t&&(r={type:"pattern",x:0,y:0,src:Object(s.a)("esri/symbols/patterns/".concat(t,".png")),width:5,height:5});break;case l:r={type:"pattern",src:e.url,width:Object(n.h)(e.width)*e.xscale,height:Object(n.h)(e.height)*e.yscale,x:Object(n.h)(e.xoffset),y:Object(n.h)(e.yoffset)};break;case"text":r=e.color;break;case"cim":r=Object(c.b)(e)}return r}function f(e,t){var r=e+"-"+t;return void 0!==h.get(r)?Promise.resolve(h.get(r)):Object(a.default)(e,{responseType:"image"}).then((e=>{var i=e.data,n=i.naturalWidth,a=i.naturalHeight,s=document.createElement("canvas");s.width=n,s.height=a;var o=s.getContext("2d");o.fillStyle=t,o.fillRect(0,0,n,a),o.globalCompositeOperation="destination-in",o.drawImage(i,0,0);var c=s.toDataURL();return h.put(r,c),c}))}function b(e){if(!e)return null;var t;switch(e.type){case u:case l:case d:t=b(e.outline);break;case"simple-line":var r=Object(n.h)(e.width);"none"!==e.style&&0!==r&&(t={color:e.color,style:m(e.style),width:r,cap:e.cap,join:"miter"===e.join?Object(n.h)(e.miterLimit):e.join});break;default:t=null}return t}var m=function(){var e={};return function(t){if(e[t])return e[t];var r=t.replace(/-/g,"");return e[t]=r,r}}(),v=new i.a([128,128,128])},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return o}));var i=r(91),n=r(109),a=r(320);function s(e){var t=Object(a.k)(e);if("CIMTextSymbol"===t.type)return t.height;var r=0;if(t.symbolLayers)for(var i of t.symbolLayers)Object(a.g)(i)&&i.size>r?r=i.size:Object(a.i)(i)&&i.width>r?r=i.width:Object(a.f)(i);return r}function o(e,t,r){var i=Object(a.k)(e),n=s(e);0!==n?c(i,t/n,!1,r):function(e,t){if("CIMTextSymbol"!==e.type){if(e.symbolLayers)for(var r of e.symbolLayers)switch(r.type){case"CIMPictureMarker":case"CIMVectorMarker":r.size=t;break;case"CIMPictureStroke":case"CIMSolidStroke":r.width=t}}else e.height=t}(i,t)}function c(e,t,r,n){if("CIMTextSymbol"!==e.type){if(r&&e.effects)for(var a of e.effects)u(a,t);if(e.symbolLayers)for(var s of e.symbolLayers)switch(s.type){case"CIMPictureMarker":case"CIMVectorMarker":l(s,t,n);break;case"CIMPictureStroke":case"CIMSolidStroke":null!=n&&n.preserveOutlineWidth||(s.width*=t);break;case"CIMPictureFill":s.height*=t,s.offsetX*=t,s.offsetY*=t;break;case"CIMHatchFill":c(s.lineSymbol,t,!0,Object(i.a)(Object(i.a)({},n),{},{preserveOutlineWidth:!1})),s.offsetX*=t,s.offsetY*=t,s.separation*=t}}else e.height*=t}function l(e,t,r){if(e.markerPlacement&&function(e,t){switch(Object(a.h)(e)&&(e.offset*=t),e.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.placementTemplate&&e.placementTemplate.length){var r=e.placementTemplate.map((e=>e*t));e.placementTemplate=r}break;case"CIMMarkerPlacementAlongLineVariableSize":if(e.maxRandomOffset*=t,e.placementTemplate&&e.placementTemplate.length){var i=e.placementTemplate.map((e=>e*t));e.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":e.startPointOffset*=t;break;case"CIMMarkerPlacementAtExtremities":e.offsetAlongLine*=t;break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":e.beginPosition*=t,e.endPosition*=t;break;case"CIMMarkerPlacementPolygonCenter":e.offsetX*=t,e.offsetY*=t;break;case"CIMMarkerPlacementInsidePolygon":e.offsetX*=t,e.offsetY*=t,e.stepX*=t,e.stepY*=t}}(e.markerPlacement,t),e.offsetX*=t,e.offsetY*=t,e.anchorPoint&&"Absolute"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size*=t,"CIMVectorMarker"===e.type&&e.markerGraphics)for(var i of e.markerGraphics)e.scaleSymbolsProportionally||c(i.symbol,t,!0,r)}function u(e,t){switch(e.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":e.width*=t;break;case"CIMGeometricEffectBuffer":e.size*=t;break;case"CIMGeometricEffectCut":e.beginCut*=t,e.endCut*=t,e.middleCut*=t;break;case"CIMGeometricEffectDashes":if(e.customEndingOffset*=t,e.offsetAlongLine*=t,e.dashTemplate&&e.dashTemplate.length){var r=e.dashTemplate.map((e=>e*t));e.dashTemplate=r}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":e.length*=t;break;case"CIMGeometricEffectMove":e.offsetX*=t,e.offsetY*=t;break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":e.offset*=t;break;case"CIMGeometricEffectRegularPolygon":e.radius*=t;break;case"CIMGeometricEffectTaperedPolygon":e.fromWidth*=t,e.length*=t,e.toWidth*=t;break;case"CIMGeometricEffectWave":e.amplitude*=t,e.period*=t}}function d(e){var t=[];return h(Object(a.k)(e),t),t.length?new n.a(Object(a.e)(t[0])):null}function h(e,t){var r;r="CIMTextSymbol"===e.type?e.symbol:e;var i="CIMPolygonSymbol"===e.type;if(r.symbolLayers)for(var n of r.symbolLayers)if(!(n.colorLocked||i&&(Object(a.i)(n)||Object(a.g)(n)&&n.markerPlacement&&Object(a.h)(n.markerPlacement))))switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":n.markerGraphics.forEach((e=>{h(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":p(t,n.color);break;case"CIMHatchFill":h(n.lineSymbol,t)}}function p(e,t){for(var r of e)if(r.join(".")===t.join("."))return;e.push(t)}function f(e,t){t instanceof n.a||(t=new n.a(t)),b(Object(a.k)(e),t)}function b(e,t){var r;r="CIMTextSymbol"===e.type?e.symbol:e;var i="CIMPolygonSymbol"===e.type;if(r.symbolLayers)for(var n of r.symbolLayers)if(!n.colorLocked&&(!i||!(Object(a.i)(n)||Object(a.g)(n)&&n.markerPlacement&&Object(a.h)(n.markerPlacement)))){var s=t.toArray(0);switch(n.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":n.markerGraphics.forEach((e=>{b(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":n.color=s;break;case"CIMHatchFill":b(n.lineSymbol,t)}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return h}));var i=r(110),n=r(104),a=r(111),s=r(299),o=r(177);function c(e){return e?{origin:Object(n.d)(e.origin),vector:Object(n.d)(e.vector)}:{origin:Object(n.e)(),vector:Object(n.e)()}}function l(e,t){var r=b.get();return r.origin=e,r.vector=t,r}function u(e,t,r=c()){return Object(a.j)(r.origin,e),Object(a.j)(r.vector,t),r}function d(e,t){var r=Object(a.i)(o.d.get(),t,e.origin),n=Object(a.g)(e.vector,r),s=Object(a.g)(e.vector,e.vector),c=Object(i.d)(n/s,0,1),l=Object(a.i)(o.d.get(),Object(a.d)(o.d.get(),e.vector,c),r);return Object(a.g)(l,l)}function h(e,t,r,n,s){var{vector:c,origin:l}=e,u=Object(a.i)(o.d.get(),t,l),d=Object(a.g)(c,u)/Object(a.r)(c);return Object(a.d)(s,c,Object(i.d)(d,r,n)),Object(a.e)(s,s,e.origin)}function p(e,t,r,n){var s=1e-6,c=e.origin,l=Object(a.e)(o.d.get(),c,e.vector),u=t.origin,d=Object(a.e)(o.d.get(),u,t.vector),h=o.d.get(),p=o.d.get();if(h[0]=c[0]-u[0],h[1]=c[1]-u[1],h[2]=c[2]-u[2],p[0]=d[0]-u[0],p[1]=d[1]-u[1],p[2]=d[2]-u[2],Math.abs(p[0])<s&&Math.abs(p[1])<s&&Math.abs(p[2])<s)return!1;var f=o.d.get();if(f[0]=l[0]-c[0],f[1]=l[1]-c[1],f[2]=l[2]-c[2],Math.abs(f[0])<s&&Math.abs(f[1])<s&&Math.abs(f[2])<s)return!1;var b=h[0]*p[0]+h[1]*p[1]+h[2]*p[2],m=p[0]*f[0]+p[1]*f[1]+p[2]*f[2],v=h[0]*f[0]+h[1]*f[1]+h[2]*f[2],g=p[0]*p[0]+p[1]*p[1]+p[2]*p[2],y=(f[0]*f[0]+f[1]*f[1]+f[2]*f[2])*g-m*m;if(Math.abs(y)<s)return!1;var O=(b*m-v*g)/y,j=(b+m*O)/g;r&&(O=Object(i.d)(O,0,1),j=Object(i.d)(j,0,1));var _=o.d.get(),w=o.d.get();return _[0]=c[0]+O*f[0],_[1]=c[1]+O*f[1],_[2]=c[2]+O*f[2],w[0]=u[0]+j*p[0],w[1]=u[1]+j*p[1],w[2]=u[2]+j*p[2],n.tA=O,n.tB=j,n.pA=_,n.pB=w,n.distance2=Object(a.k)(_,w),!0}var f={tA:0,tB:0,pA:Object(n.e)(),pB:Object(n.e)(),distance2:0},b=new s.a((()=>({origin:null,vector:null}))),m=Object.freeze({__proto__:null,create:c,wrap:l,copy:function(e,t=c()){return u(e.origin,e.vector,t)},fromValues:u,fromPoints:function(e,t,r=c()){return Object(a.j)(r.origin,e),Object(a.i)(r.vector,t,e),r},distance2:d,distance:function(e,t){return Math.sqrt(d(e,t))},projectPoint:function(e,t,r){return h(e,t,0,1,r)},pointAt:function(e,t,r){return Object(a.e)(r,e.origin,Object(a.d)(r,e.vector,t))},projectPointClamp:h,closestRayDistance2:function(e,t){if(p(e,l(t.origin,t.direction),!1,f)){var{tA:r,pB:i,distance2:n}=f;if(r>=0&&r<=1)return n;if(r<0)return Object(a.k)(e.origin,i);if(r>1)return Object(a.k)(Object(a.e)(o.d.get(),e.origin,e.vector),i)}return null},closestLineSegmentPoint:function(e,t,r){return!!p(e,t,!0,f)&&(Object(a.j)(r,f.pA),!0)},closestLineSegmentDistance2:function(e,t){return p(e,t,!0,f)?f.distance2:null}})},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return S})),r.d(t,"e",(function(){return M})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return E})),r.d(t,"h",(function(){return z})),r.d(t,"i",(function(){return x})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return T})),r.d(t,"l",(function(){return I})),r.d(t,"m",(function(){return F})),r.d(t,"n",(function(){return D})),r.d(t,"o",(function(){return P})),r.d(t,"p",(function(){return A})),r.d(t,"q",(function(){return C})),r.d(t,"r",(function(){return _})),r.d(t,"s",(function(){return u}));var i=r(89),n=r(110),a=r(104),s=r(111),o=r(177),c=r(398);function l(e=k){return[e[0],e[1],e[2],e[3]]}function u(e,t,r,i){return h(e,t,r,i,o.e.get())}function d(e,t=l()){return h(e[0],e[1],e[2],e[3],t)}function h(e,t,r,i,n=l()){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function p(e,t,r=l()){Object(s.j)(r,t);var i=Object(s.g)(t,t);return Math.abs(i-1)>1e-5&&i>1e-12&&Object(s.d)(r,r,1/Math.sqrt(i)),_(r,e,r),r}function f(e,t,r,i=l()){return w(Object(s.i)(o.d.get(),e,t),Object(s.i)(o.d.get(),r,t),e,i)}function b(e,t,r,i,n){if(e.count<3)return!1;e.getVec(r,v);for(var a=i,o=!1;a<e.count-1&&!o;)e.getVec(a,g),a++,o=!Object(s.p)(v,g);if(!o)return!1;for(a=Math.max(a,n),o=!1;a<e.count&&!o;)e.getVec(a,y),a++,Object(s.i)(O,v,g),Object(s.q)(O,O),Object(s.i)(j,g,y),Object(s.q)(j,j),o=!Object(s.p)(v,y)&&!Object(s.p)(g,y)&&Math.abs(Object(s.g)(O,j))<m;return o?(f(v,g,y,t),!0):(0!==r||1!==i||2!==n)&&b(e,t,0,1,2)}var m=.99619469809,v=Object(a.e)(),g=Object(a.e)(),y=Object(a.e)(),O=Object(a.e)(),j=Object(a.e)();function _(e,t,r){return e!==r&&d(e,r),r[3]=-Object(s.g)(r,t),r}function w(e,t,r,i=l()){return p(r,Object(s.f)(o.d.get(),t,e),i)}function x(e,t,r){return!!Object(i.k)(t)&&L(e,t.origin,t.direction,!0,!1,r)}function S(e,t,r){return L(e,t.origin,t.vector,!1,!1,r)}function M(e,t,r){return L(e,t.origin,t.vector,!1,!0,r)}function T(e,t){return F(e,Object(c.c)(t))-t[3]>=0}function E(e,t){return F(e,t)>=0}function P(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=t[4],o=t[5];return e[0]*(e[0]>0?r:a)+e[1]*(e[1]>0?i:s)+e[2]*(e[2]>0?n:o)+e[3]>=0}function C(e,t){var r=Object(s.g)(e,t.ray.direction),i=-F(e,t.ray.origin);if(i<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return i>0;if((i<0||r<0)&&!(i<0&&r<0))return!0;var n=i/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function I(e,t){var r=Object(s.g)(e,t.ray.direction),i=-F(e,t.ray.origin);if(r>-1e-6&&r<1e-6)return i>0;var n=i/r;return r>0?n<t.c1&&(t.c1=n):n>t.c0&&(t.c0=n),t.c0<=t.c1}function A(e,t,r){var i=Object(s.d)(o.d.get(),e,-e[3]),n=R(e,Object(s.i)(o.d.get(),t,i),o.d.get());return Object(s.e)(r,n,i),r}function R(e,t,r){var i=Object(s.d)(o.d.get(),e,Object(s.g)(e,t));return Object(s.i)(r,t,i),r}function F(e,t){return Object(s.g)(e,t)+e[3]}function L(e,t,r,i,a,o){var c=Object(s.g)(e,r);if(0===c)return!1;var l=-(Object(s.g)(e,t)+e[3])/c;return a&&(l=i?Math.max(0,l):Object(n.d)(l,0,1)),!(l<0||!i&&l>1)&&(Object(s.e)(o,t,Object(s.d)(o,r,l)),!0)}function D(e){return e}var k=[0,0,1,0],z=Object.freeze({__proto__:null,create:l,wrap:u,copy:d,fromValues:h,fromNormalAndOffset:function(e,t,r=l()){return Object(s.j)(r,e),r[3]=t,r},fromPositionAndNormal:p,fromPoints:f,fromManyPoints:function(e,t){return b(e,t,0,1,2)},fromManyPointsSampleAt:b,setOffsetFromPoint:_,negate:function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},fromVectorsAndPoint:w,intersectRay:x,intersectLineSegment:S,intersectLineSegmentClamp:M,isSphereFullyInside:T,isSphereFullyOutside:function(e,t){return F(e,Object(c.c)(t))+t[3]<0},isPointInside:E,isPointOutside:function(e,t){return F(e,t)<0},isAABBFullyInside:P,clip:C,clipInfinite:I,projectPoint:A,projectVector:R,distance:function(e,t){return Math.abs(F(e,t))},signedDistance:F,normal:D,UP:k})},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i,n,a,s,o,c,l,u=r(120),d=r(119);function h(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add("instanceFeatureAttribute","vec4"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),e.vertex.uniforms.add("vvSymbolAnchor","vec3"),e.vertex.code.add(Object(d.a)(i||(i=Object(u.a)(["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "])))),e.vertex.code.add(Object(d.a)(n||(n=Object(u.a)(["\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(d.a)(a||(a=Object(u.a)(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):e.vertex.code.add(Object(d.a)(s||(s=Object(u.a)(["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "])))),t.vvColor?(e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(d.a)(o||(o=Object(u.a)(["\n      uniform float vvColorValues[vvColorNumber];\n      uniform vec4 vvColorColors[vvColorNumber];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[vvColorNumber - 1];\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(d.a)(c||(c=Object(u.a)(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):e.vertex.code.add(Object(d.a)(l||(l=Object(u.a)(["\n      vec4 vvColor() { return vec4(1.0); }\n    "]))))}!function(e){function t(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors))}e.bindUniforms=t,e.bindUniformsWithOpacity=function(e,r){t(e,r),r.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",r.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",r.vvOpacityOpacities))},e.bindUniformsForSymbols=function(e,r){t(e,r),r.vvSizeEnabled&&(e.setUniform3fv("vvSymbolAnchor",r.vvSymbolAnchor),e.setUniformMatrix3fv("vvSymbolRotationMatrix",r.vvSymbolRotationMatrix))}}(h||(h={}))},,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return N})),r.d(t,"d",(function(){return G})),r.d(t,"e",(function(){return D})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return v})),r.d(t,"h",(function(){return g})),r.d(t,"i",(function(){return y})),r.d(t,"j",(function(){return E})),r.d(t,"k",(function(){return A})),r.d(t,"l",(function(){return x})),r.d(t,"m",(function(){return p})),r.d(t,"n",(function(){return j})),r.d(t,"o",(function(){return U})),r.d(t,"p",(function(){return H})),r.d(t,"q",(function(){return k})),r.d(t,"r",(function(){return P})),r.d(t,"s",(function(){return R})),r.d(t,"t",(function(){return S})),r.d(t,"u",(function(){return f})),r.d(t,"v",(function(){return _})),r.d(t,"w",(function(){return B})),r.d(t,"x",(function(){return W})),r.d(t,"y",(function(){return z})),r.d(t,"z",(function(){return C})),r.d(t,"A",(function(){return F})),r.d(t,"B",(function(){return M})),r.d(t,"C",(function(){return b})),r.d(t,"D",(function(){return w})),r.d(t,"E",(function(){return q})),r.d(t,"F",(function(){return J})),r.d(t,"G",(function(){return V})),r.d(t,"H",(function(){return I})),r.d(t,"I",(function(){return L})),r.d(t,"J",(function(){return T}));class i{constructor(e,t,r=0,i,n){this.TypedArrayConstructor=e,this.elementCount=9;var a=this.TypedArrayConstructor;void 0===i&&(i=9*a.BYTES_PER_ELEMENT);var s=0===t.byteLength?0:r;this.typedBuffer=null==n?new a(t,s):new a(t,s,(n-r)/a.BYTES_PER_ELEMENT),this.typedBufferStride=i/a.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}getMat(e,t){for(var r=e*this.typedBufferStride,i=0;i<9;i++)t[i]=this.typedBuffer[r+i];return t}setMat(e,t){for(var r=e*this.typedBufferStride,i=0;i<9;i++)this.typedBuffer[r+i]=t[i]}get(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}set(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}copyFrom(e,t,r){for(var i=this.typedBuffer,n=t.typedBuffer,a=e*this.typedBufferStride,s=r*t.typedBufferStride,o=0;o<9;++o)i[a+o]=n[s+o]}get buffer(){return this.typedBuffer.buffer}}i.ElementCount=9;class n{constructor(e,t,r=0,i,n){this.TypedArrayConstructor=e,this.elementCount=16;var a=this.TypedArrayConstructor;void 0===i&&(i=16*a.BYTES_PER_ELEMENT);var s=0===t.byteLength?0:r;this.typedBuffer=null==n?new a(t,s):new a(t,s,(n-r)/a.BYTES_PER_ELEMENT),this.typedBufferStride=i/a.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}getMat(e,t){for(var r=e*this.typedBufferStride,i=0;i<16;i++)t[i]=this.typedBuffer[r+i];return t}setMat(e,t){for(var r=e*this.typedBufferStride,i=0;i<16;i++)this.typedBuffer[r+i]=t[i]}get(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}set(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}copyFrom(e,t,r){for(var i=this.typedBuffer,n=t.typedBuffer,a=e*this.typedBufferStride,s=r*t.typedBufferStride,o=0;o<16;++o)i[a+o]=n[s+o]}get buffer(){return this.typedBuffer.buffer}}n.ElementCount=16;class a{constructor(e,t,r=0,i,n){this.TypedArrayConstructor=e,this.elementCount=1;var a=this.TypedArrayConstructor;void 0===i&&(i=a.BYTES_PER_ELEMENT);var s=0===t.byteLength?0:r;this.typedBuffer=null==n?new a(t,s):new a(t,s,(n-r)/a.BYTES_PER_ELEMENT),this.typedBufferStride=i/a.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}get(e){return this.typedBuffer[e*this.typedBufferStride]}set(e,t){this.typedBuffer[e*this.typedBufferStride]=t}get buffer(){return this.typedBuffer.buffer}}a.ElementCount=1;var s=r(135);class o{constructor(e,t,r=0,i,n){this.TypedArrayConstructor=e,this.elementCount=2;var a=this.TypedArrayConstructor;void 0===i&&(i=2*a.BYTES_PER_ELEMENT);var s=0===t.byteLength?0:r;this.typedBuffer=null==n?new a(t,s):new a(t,s,(n-r)/a.BYTES_PER_ELEMENT),this.typedBufferStride=i/a.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}getVec(e,t){return Object(s.r)(t,this.typedBuffer[e*this.typedBufferStride],this.typedBuffer[e*this.typedBufferStride+1])}setVec(e,t){this.typedBuffer[e*this.typedBufferStride]=t[0],this.typedBuffer[e*this.typedBufferStride+1]=t[1]}get(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}set(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}setValues(e,t,r){this.typedBuffer[e*this.typedBufferStride]=t,this.typedBuffer[e*this.typedBufferStride+1]=r}copyFrom(e,t,r){var i=this.typedBuffer,n=t.typedBuffer,a=e*this.typedBufferStride,s=r*t.typedBufferStride;i[a]=n[s],i[a+1]=n[s+1]}get buffer(){return this.typedBuffer.buffer}}o.ElementCount=2;var c=r(111);class l{constructor(e,t,r=0,i,n){this.TypedArrayConstructor=e,this.elementCount=3;var a=this.TypedArrayConstructor;void 0===i&&(i=3*a.BYTES_PER_ELEMENT);var s=0===t.byteLength?0:r;this.typedBuffer=null==n?new a(t,s):new a(t,s,(n-r)/a.BYTES_PER_ELEMENT),this.typedBufferStride=i/a.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}getVec(e,t){return Object(c.v)(t,this.typedBuffer[e*this.typedBufferStride],this.typedBuffer[e*this.typedBufferStride+1],this.typedBuffer[e*this.typedBufferStride+2])}setVec(e,t){this.typedBuffer[e*this.typedBufferStride]=t[0],this.typedBuffer[e*this.typedBufferStride+1]=t[1],this.typedBuffer[e*this.typedBufferStride+2]=t[2]}get(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}set(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}setValues(e,t,r,i){this.typedBuffer[e*this.typedBufferStride]=t,this.typedBuffer[e*this.typedBufferStride+1]=r,this.typedBuffer[e*this.typedBufferStride+2]=i}copyFrom(e,t,r){var i=this.typedBuffer,n=t.typedBuffer,a=e*this.typedBufferStride,s=r*t.typedBufferStride;i[a]=n[s],i[a+1]=n[s+1],i[a+2]=n[s+2]}get buffer(){return this.typedBuffer.buffer}}l.ElementCount=3;var u=r(191);class d{constructor(e,t,r=0,i,n){this.TypedArrayConstructor=e,this.elementCount=4;var a=this.TypedArrayConstructor;void 0===i&&(i=4*a.BYTES_PER_ELEMENT);var s=0===t.byteLength?0:r;this.typedBuffer=null==n?new a(t,s):new a(t,s,(n-r)/a.BYTES_PER_ELEMENT),this.typedBufferStride=i/a.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}getVec(e,t){return Object(u.l)(t,this.typedBuffer[e*this.typedBufferStride],this.typedBuffer[e*this.typedBufferStride+1],this.typedBuffer[e*this.typedBufferStride+2],this.typedBuffer[e*this.typedBufferStride+3])}setVec(e,t){this.typedBuffer[e*this.typedBufferStride]=t[0],this.typedBuffer[e*this.typedBufferStride+1]=t[1],this.typedBuffer[e*this.typedBufferStride+2]=t[2],this.typedBuffer[e*this.typedBufferStride+3]=t[3]}get(e,t){return this.typedBuffer[e*this.typedBufferStride+t]}set(e,t,r){this.typedBuffer[e*this.typedBufferStride+t]=r}setValues(e,t,r,i,n){this.typedBuffer[e*this.typedBufferStride]=t,this.typedBuffer[e*this.typedBufferStride+1]=r,this.typedBuffer[e*this.typedBufferStride+2]=i,this.typedBuffer[e*this.typedBufferStride+3]=n}copyFrom(e,t,r){var i=this.typedBuffer,n=t.typedBuffer,a=e*this.typedBufferStride,s=r*t.typedBufferStride;i[a]=n[s],i[a+1]=n[s+1],i[a+2]=n[s+2],i[a+3]=n[s+3]}get buffer(){return this.typedBuffer.buffer}}d.ElementCount=4;class h extends a{constructor(e,t=0,r,i){super(Float32Array,e,t,r,i),this.elementType="f32"}static fromTypedArray(e,t){return new h(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}h.ElementType="f32";class p extends o{constructor(e,t=0,r,i){super(Float32Array,e,t,r,i),this.elementType="f32"}static fromTypedArray(e,t){return new p(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}p.ElementType="f32";class f extends l{constructor(e,t=0,r,i){super(Float32Array,e,t,r,i),this.elementType="f32"}static fromTypedArray(e,t){return new f(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}f.ElementType="f32";class b extends d{constructor(e,t=0,r,i){super(Float32Array,e,t,r,i),this.elementType="f32"}static fromTypedArray(e,t){return new b(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}b.ElementType="f32";class m extends i{constructor(e,t=0,r,i){super(Float32Array,e,t,r,i),this.elementType="f32"}static fromTypedArray(e,t){return new m(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}m.ElementType="f32";class v extends i{constructor(e,t=0,r,i){super(Float64Array,e,t,r,i),this.elementType="f64"}static fromTypedArray(e,t){return new v(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}v.ElementType="f64";class g extends n{constructor(e,t=0,r,i){super(Float32Array,e,t,r,i),this.elementType="f32"}static fromTypedArray(e,t){return new g(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}g.ElementType="f32";class y extends n{constructor(e,t=0,r,i){super(Float64Array,e,t,r,i),this.elementType="f64"}static fromTypedArray(e,t){return new y(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}y.ElementType="f64";class O extends a{constructor(e,t=0,r,i){super(Float64Array,e,t,r,i),this.elementType="f64"}static fromTypedArray(e,t){return new O(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}O.ElementType="f64";class j extends o{constructor(e,t=0,r,i){super(Float64Array,e,t,r,i),this.elementType="f64"}static fromTypedArray(e,t){return new j(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}j.ElementType="f64";class _ extends l{constructor(e,t=0,r,i){super(Float64Array,e,t,r,i),this.elementType="f64"}static fromTypedArray(e,t){return new _(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}_.ElementType="f64";class w extends d{constructor(e,t=0,r,i){super(Float64Array,e,t,r,i),this.elementType="f64"}static fromTypedArray(e,t){return new w(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}w.ElementType="f64";class x extends a{constructor(e,t=0,r,i){super(Uint8Array,e,t,r,i),this.elementType="u8"}static fromTypedArray(e,t){return new x(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}x.ElementType="u8";class S extends o{constructor(e,t=0,r,i){super(Uint8Array,e,t,r,i),this.elementType="u8"}static fromTypedArray(e,t){return new S(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}S.ElementType="u8";class M extends l{constructor(e,t=0,r,i){super(Uint8Array,e,t,r,i),this.elementType="u8"}static fromTypedArray(e,t){return new M(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}M.ElementType="u8";class T extends d{constructor(e,t=0,r,i){super(Uint8Array,e,t,r,i),this.elementType="u8"}static fromTypedArray(e,t){return new T(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}T.ElementType="u8";class E extends a{constructor(e,t=0,r,i){super(Uint16Array,e,t,r,i),this.elementType="u16"}static fromTypedArray(e,t){return new E(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}E.ElementType="u16";class P extends o{constructor(e,t=0,r,i){super(Uint16Array,e,t,r,i),this.elementType="u16"}static fromTypedArray(e,t){return new P(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}P.ElementType="u16";class C extends l{constructor(e,t=0,r,i){super(Uint16Array,e,t,r,i),this.elementType="u16"}static fromTypedArray(e,t){return new C(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}C.ElementType="u16";class I extends d{constructor(e,t=0,r,i){super(Uint16Array,e,t,r,i),this.elementType="u16"}static fromTypedArray(e,t){return new I(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}I.ElementType="u16";class A extends a{constructor(e,t=0,r,i){super(Uint32Array,e,t,r,i),this.elementType="u32"}static fromTypedArray(e,t){return new A(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}A.ElementType="u32";class R extends o{constructor(e,t=0,r,i){super(Uint32Array,e,t,r,i),this.elementType="u32"}static fromTypedArray(e,t){return new R(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}R.ElementType="u32";class F extends l{constructor(e,t=0,r,i){super(Uint32Array,e,t,r,i),this.elementType="u32"}static fromTypedArray(e,t){return new F(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}F.ElementType="u32";class L extends d{constructor(e,t=0,r,i){super(Uint32Array,e,t,r,i),this.elementType="u32"}static fromTypedArray(e,t){return new L(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}L.ElementType="u32";class D extends a{constructor(e,t=0,r,i){super(Int8Array,e,t,r,i),this.elementType="i8"}static fromTypedArray(e,t){return new D(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}D.ElementType="i8";class k extends o{constructor(e,t=0,r,i){super(Int8Array,e,t,r,i),this.elementType="i8"}static fromTypedArray(e,t){return new k(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}k.ElementType="i8";class z extends l{constructor(e,t=0,r,i){super(Int8Array,e,t,r,i),this.elementType="i8"}static fromTypedArray(e,t){return new z(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}z.ElementType="i8";class V extends d{constructor(e,t=0,r,i){super(Int8Array,e,t,r,i),this.elementType="i8"}static fromTypedArray(e,t){return new V(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}V.ElementType="i8";class N extends a{constructor(e,t=0,r,i){super(Int16Array,e,t,r,i),this.elementType="i16"}static fromTypedArray(e,t){return new N(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}N.ElementType="i16";class U extends o{constructor(e,t=0,r,i){super(Int16Array,e,t,r,i),this.elementType="i16"}static fromTypedArray(e,t){return new U(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}U.ElementType="i16";class B extends l{constructor(e,t=0,r,i){super(Int16Array,e,t,r,i),this.elementType="i16"}static fromTypedArray(e,t){return new B(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}B.ElementType="i16";class q extends d{constructor(e,t=0,r,i){super(Int16Array,e,t,r,i),this.elementType="i16"}static fromTypedArray(e,t){return new q(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}q.ElementType="i16";class G extends a{constructor(e,t=0,r,i){super(Int32Array,e,t,r,i),this.elementType="i32"}static fromTypedArray(e,t){return new G(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}G.ElementType="i32";class H extends o{constructor(e,t=0,r,i){super(Int32Array,e,t,r,i),this.elementType="i32"}static fromTypedArray(e,t){return new H(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}H.ElementType="i32";class W extends l{constructor(e,t=0,r,i){super(Int32Array,e,t,r,i),this.elementType="i32"}static fromTypedArray(e,t){return new W(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}W.ElementType="i32";class J extends d{constructor(e,t=0,r,i){super(Int32Array,e,t,r,i),this.elementType="i32"}static fromTypedArray(e,t){return new J(e.buffer,e.byteOffset,t,e.byteOffset+e.byteLength)}}J.ElementType="i32"},,,function(e,t,r){"use strict";var i=r(7),n=r(91),a=r(82),s=(r(80),r(89)),o=(r(81),r(85)),c=r(116),l=r(84),u=r(93),d=(r(83),r(86),r(87),r(107)),h=r(123),p=r(108),f=r(259),b=r(375),m=r(167),v=r(196),g={editing:!1,operations:{add:!0,update:!0,delete:!0}},y=d.a.ofType(b.a),O=class extends m.a{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities=Object(n.a)({},g),this.activeAttachmentInfo=null,this.attachmentInfos=new y,this.graphic=null,this.mode="view",this.handles.add([Object(p.a)(this,"graphic",(()=>this._graphicChanged()))])}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return Object(n.a)(Object(n.a)({},g),e)}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}getAttachments(){var e=this;return Object(i.a)((function*(){var{_attachmentLayer:t,attachmentInfos:r}=e;if(!t||"function"!=typeof t.queryAttachments)throw new u.a("invalid-layer","getAttachments(): A valid layer is required.");var i=e._getFeatureId(),n=new f.a({objectIds:[i],returnMetadata:!0}),a=[],s=t.queryAttachments(n).then((e=>e[i]||a)).catch((()=>a));e._getAttachmentsPromise=s,e.notifyChange("state");var o=yield s;return r.removeAll(),o.length&&r.addMany(o),e._getAttachmentsPromise=null,e.notifyChange("state"),o}))()}addAttachment(e){var t=this;return Object(i.a)((function*(){var{_attachmentLayer:r,attachmentInfos:i,graphic:n,abilities:a}=t;if(!e)throw new u.a("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!a.operations.add)throw new u.a("invalid-abilities","addAttachment(): add abilities are required.");if(!r||"function"!=typeof r.addAttachment)throw new u.a("invalid-layer","addAttachment(): A valid layer is required.");var s=r.addAttachment(n,e).then((e=>t._queryAttachment(e.objectId))),o=yield s;return i.add(o),o}))()}deleteAttachment(e){var t=this;return Object(i.a)((function*(){var{_attachmentLayer:r,attachmentInfos:i,graphic:n,abilities:a}=t;if(!e)throw new u.a("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!a.operations.delete)throw new u.a("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!r||"function"!=typeof r.deleteAttachments)throw new u.a("invalid-layer","deleteAttachment(): A valid layer is required.");var s=r.deleteAttachments(n,[e.id]).then((()=>e)),o=yield s;return i.remove(o),o}))()}updateAttachment(e,t=this.activeAttachmentInfo){var r=this;return Object(i.a)((function*(){var{_attachmentLayer:i,attachmentInfos:n,graphic:a,abilities:s}=r;if(!e)throw new u.a("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new u.a("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!s.operations.update)throw new u.a("invalid-abilities","updateAttachment(): Update abilities are required.");var o=n.findIndex((e=>e===t));if(!i||"function"!=typeof i.updateAttachment)throw new u.a("invalid-layer","updateAttachment(): A valid layer is required.");var c=i.updateAttachment(a,t.id,e).then((e=>r._queryAttachment(e.objectId))),l=yield c;return n.splice(o,1,l),l}))()}_queryAttachment(e){var t=this;return Object(i.a)((function*(){if(!e)throw new u.a("invalid-attachment-id","Could not query attachment.");var{_attachmentLayer:r}=t,i=t._getFeatureId(),n=new f.a({objectIds:[i],attachmentsWhere:"AttachmentId=".concat(e),returnMetadata:!0});return r.queryAttachments(n).then((e=>e[i][0]))}))()}_getFeatureId(){var{_attachmentLayer:e,graphic:t}=this;if(!e||!t)return null;var{objectIdField:r}=e,{attributes:i}=t;return i&&i[r]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})))}_setAttachmentLayer(){var{graphic:e}=this,t=Object(v.l)(e);this._attachmentLayer=t?"scene"===t.type&&Object(s.k)(t.associatedLayer)?t.associatedLayer:t:null}};Object(a.a)([Object(o.b)()],O.prototype,"abilities",void 0),Object(a.a)([Object(c.a)("abilities")],O.prototype,"castAbilities",null),Object(a.a)([Object(o.b)()],O.prototype,"activeAttachmentInfo",void 0),Object(a.a)([Object(o.b)({readOnly:!0,type:y})],O.prototype,"attachmentInfos",void 0),Object(a.a)([Object(o.b)({type:h.a})],O.prototype,"graphic",void 0),Object(a.a)([Object(o.b)()],O.prototype,"mode",void 0),Object(a.a)([Object(o.b)({readOnly:!0})],O.prototype,"state",null),Object(a.a)([Object(o.b)({readOnly:!0})],O.prototype,"supportsResizeAttachments",null);var j=O=Object(a.a)([Object(l.a)("esri.widgets.Attachments.AttachmentsViewModel")],O);t.a=j},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(437)),o=class extends s.a{constructor(e){super(e),this.description=null,this.title=null}};Object(i.a)([Object(n.b)()],o.prototype,"description",void 0),Object(i.a)([Object(n.b)()],o.prototype,"title",void 0);var c=o=Object(i.a)([Object(a.a)("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],o);t.a=c},function(e,t,r){"use strict";var i=r(7),n=r(82),a=(r(80),r(81),r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(97)),c=r(123),l=r(108),u=r(167),d=r(196),h=class extends(Object(u.b)(o.a)){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(Object(l.a)(this,"creator",(e=>{this._destroyContent(),this._createContent(e)})))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){var{created:e,graphic:t,destroyer:r}=this;e&&(Object(d.m)(r,{graphic:t}).catch((()=>null)),this._set("created",null))}_createContent(e){var t=this;return Object(i.a)((function*(){var{graphic:r}=t,i=Object(d.m)(e,{graphic:r}).catch((()=>null));t._loadingPromise=i,t.notifyChange("state");var n=yield i;i===t._loadingPromise&&(t._loadingPromise=null,t.notifyChange("state"),t._set("created",n))}))()}};Object(n.a)([Object(a.b)({readOnly:!0})],h.prototype,"created",void 0),Object(n.a)([Object(a.b)()],h.prototype,"creator",void 0),Object(n.a)([Object(a.b)()],h.prototype,"destroyer",void 0),Object(n.a)([Object(a.b)({type:c.a})],h.prototype,"graphic",void 0),Object(n.a)([Object(a.b)({readOnly:!0})],h.prototype,"state",null);var p=h=Object(n.a)([Object(s.a)("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],h);t.a=p},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(97)),o=r(296),c=r(637),l=r(196),u=class extends s.a{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){var{expressionInfos:e,fieldInfos:t}=this,r=[];return null==t||t.forEach((t=>{if(!t.hasOwnProperty("visible")||t.visible){var i=t.clone();i.label=Object(l.i)(i,e),r.push(i)}})),r}};Object(i.a)([Object(n.b)()],u.prototype,"attributes",void 0),Object(i.a)([Object(n.b)({type:[c.a]})],u.prototype,"expressionInfos",void 0),Object(i.a)([Object(n.b)()],u.prototype,"description",void 0),Object(i.a)([Object(n.b)({type:[o.a]})],u.prototype,"fieldInfos",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],u.prototype,"formattedFieldInfos",null),Object(i.a)([Object(n.b)()],u.prototype,"title",void 0);var d=u=Object(i.a)([Object(a.a)("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],u);t.a=d},function(e,t,r){"use strict";var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(97)),o=r(296),c=r(658),l=r(196),u=r(442),d=class extends s.a{constructor(e){super(e),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){var{formattedMediaInfoCount:t}=this,r=(e+t)%t;this.activeMediaInfoIndex=r}_pageContentElementMedia(e){var{activeMediaInfoIndex:t}=this,r=t+e;this._setContentElementMedia(r)}_formatMediaInfos(){var{attributes:e,mediaInfos:t,formattedAttributes:r,fieldInfoMap:i,layer:n}=this;return null==t?void 0:t.map((t=>{if(!t)return null;if(t.title=Object(l.s)({attributes:e,fieldInfoMap:i,globalAttributes:r,layer:n,text:t.title}),t.caption=Object(l.s)({attributes:e,fieldInfoMap:i,globalAttributes:r,layer:n,text:t.caption}),t.altText=Object(l.s)({attributes:e,fieldInfoMap:i,globalAttributes:r,layer:n,text:t.altText}),"image"===t.type){var{value:a}=t;return this._setImageValue({value:a,formattedAttributes:r,layer:n}),t.value.sourceURL?t:void 0}if("pie-chart"===t.type||"line-chart"===t.type||"column-chart"===t.type||"bar-chart"===t.type){var{value:s}=t;return this._setChartValue({value:s,chartType:t.type,attributes:e,formattedAttributes:r,layer:n}),t}return null})).filter(Boolean)}_setImageValue(e){var{fieldInfoMap:t}=this,{value:r,formattedAttributes:i,layer:n}=e,{linkURL:a,sourceURL:s}=r;if(s){var o=Object(l.c)(s,n);r.sourceURL=Object(l.r)({formattedAttributes:i,template:o,fieldInfoMap:t})}if(a){var c=Object(l.c)(a,n);r.linkURL=Object(l.r)({formattedAttributes:i,template:c,fieldInfoMap:t})}}_setChartValue(e){var{value:t,attributes:r,formattedAttributes:i,chartType:n,layer:a}=e,{popupTemplate:s,relatedInfos:o}=this,{fields:c,normalizeField:u}=t;if(t.fields=Object(l.k)(c,a),u&&(t.normalizeField=Object(l.j)(u,a)),c.some((e=>!!(null!=i[e]||Object(l.o)(e)&&o.size)))){var d=null==s?void 0:s.fieldInfos;c.forEach((e=>{if(Object(l.o)(e))t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:d,fieldName:e,formattedAttributes:i,chartType:n,value:t})];else{var a=this._getChartOption({value:t,attributes:r,chartType:n,formattedAttributes:i,fieldName:e,fieldInfos:d});t.series.push(a)}}))}}_getRelatedChartInfos(e){var t,{fieldInfos:r,fieldName:i,formattedAttributes:n,chartType:a,value:s}=e,o=[],c=Object(u.b)(i),{layerId:l,fieldName:d}=c,h=null==(t=this.relatedInfos)?void 0:t.get(l.toString());if(!h)return o;var{relatedFeatures:p,relation:f}=h;if(!f||!p)return o;var{cardinality:b}=f;return p.forEach((e=>{var{attributes:t}=e;t&&Object.keys(t).forEach((e=>{e===d&&o.push(this._getChartOption({value:s,attributes:t,formattedAttributes:n,fieldName:i,chartType:a,relatedFieldName:e,fieldInfos:r}))}))})),"one-to-many"===b||"many-to-many"===b?o:[o[0]]}_getTooltip({label:e,value:t,chartType:r}){return"pie-chart"===r?e:"".concat(e,": ").concat(t)}_getChartOption(e){var t,{value:r,attributes:i,formattedAttributes:n,fieldName:a,relatedFieldName:s,fieldInfos:d,chartType:h}=e,{layer:p}=this,{normalizeField:f,tooltipField:b}=r,m=f?Object(l.o)(f)?i[Object(u.b)(f).fieldName]:i[f]:null,v=s&&void 0!==i[s]?i[s]:void 0!==i[a]?i[a]:n[a],g=void 0===v?null:v&&m?v/m:v,y=new c.a({value:g});if(Object(l.o)(a)){var O=Object(u.b)(a),j=Object(u.b)(b),_=j?j.fieldName:null,w=Object(l.f)(g,{fieldInfos:d,fieldName:s,layer:p,preventPlacesFormatting:!!m}),x=O?O.label||O.fieldName:s,S=_&&void 0!==i[_]?i[_]:x;return y.tooltip=this._getTooltip({label:S,value:w,chartType:h}),y}var M=Object(l.h)(d,a),T=Object(l.j)(a,p),E=b&&void 0!==n[b]?n[b]:Object(l.i)(M||new o.a({fieldName:T}),null==(t=this.popupTemplate)?void 0:t.expressionInfos),P=n[T];return y.tooltip=this._getTooltip({label:E,value:P,chartType:h}),y}};Object(i.a)([Object(n.b)()],d.prototype,"activeMediaInfoIndex",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],d.prototype,"activeMediaInfo",null),Object(i.a)([Object(n.b)()],d.prototype,"attributes",void 0),Object(i.a)([Object(n.b)()],d.prototype,"description",void 0),Object(i.a)([Object(n.b)()],d.prototype,"fieldInfoMap",void 0),Object(i.a)([Object(n.b)()],d.prototype,"formattedAttributes",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],d.prototype,"formattedMediaInfos",null),Object(i.a)([Object(n.b)()],d.prototype,"layer",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],d.prototype,"formattedMediaInfoCount",null),Object(i.a)([Object(n.b)()],d.prototype,"mediaInfos",void 0),Object(i.a)([Object(n.b)()],d.prototype,"popupTemplate",void 0),Object(i.a)([Object(n.b)()],d.prototype,"relatedInfos",void 0),Object(i.a)([Object(n.b)()],d.prototype,"title",void 0);var h=d=Object(i.a)([Object(a.a)("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],d);t.a=h},function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return x})),r.d(t,"d",(function(){return S})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return M}));var i=r(7),n=r(81),a=r(93),s=r(94),o=r(118),c=r(106),l=r(246),u=r(132),d=r(224),h=r(462),p=r(196),f=n.a.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),b=new Map;function m(e){if(!Object(p.o)(e))return null;var[t,r]=e.split("/").slice(1);return{layerId:t,fieldName:r}}function v({originRelationship:e,relationships:t,layerId:r}){var i;return t&&t.some((t=>("".concat(t.relatedTableId)===r&&t.id===e.id&&(i=t),!!i))),i}function g(e,t){var r=t.toLowerCase();for(var i in e)if(i.toLowerCase()===r)return e[i];return null}function y(e,t){var r=function(e,t){if(!t.relationships)return null;var r=null,{relationships:i}=t;return i.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}(e,t);if(r){var i="".concat(t.url,"/").concat(r.relatedTableId);return{url:i,queryTask:new h.a({url:i,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}}function O(e,t){if(t&&e){var{features:r,statsFeatures:i}=e,n=r&&r.value;t.relatedFeatures=n?n.features:[];var a=i&&i.value;t.relatedStatsFeatures=a?a.features:[]}}function j(e,t,r,i){var n=new d.a;return n.outFields=["*"],n.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),n.objectIds=[e.attributes[r.objectIdField]],r.queryRelatedFeatures(n,i)}function _(e,t,r){for(var i=0,n=[];i<t.length;)n.push("".concat(e," IN (").concat(t.slice(i,r+i),")")),i+=r;return n.join(" OR ")}function w(){return(w=Object(i.a)((function*(e,t,r,i){var n=r.layerId.toString(),{layerInfo:a,queryTask:c,relation:l,relatedFields:d,outStatistics:h}=t,p=v({originRelationship:l,relationships:a.relationships,layerId:n});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){var f=(yield j(e,p,r,i))[e.attributes[r.objectIdField]];if(!f)return null;var b=f.features.map((e=>e.attributes[a.objectIdField]));if((null==h?void 0:h.length)>0&&a.supportsStatistics){var m=new u.a;m.where=_(a.objectIdField,b,1e3),m.outFields=d,m.outStatistics=h;var y={features:Promise.resolve(f),statsFeatures:c.execute(m)};return Object(s.j)(y)}}var O=null==p?void 0:p.keyField;if(O){var w=Object(o.v)(Object(o.q)(a.fields,O)),x=g(e.attributes,l.keyField),S=w?"".concat(O,"=").concat(x):"".concat(O,"='").concat(x,"'"),M=c.execute(new u.a({where:S,outFields:t.relatedFields}),i),T=t.outStatistics&&t.outStatistics.length>0&&a.supportsStatistics?c.execute(new u.a({where:S,outFields:t.relatedFields,outStatistics:t.outStatistics}),i):null,E={features:M};return T&&(E.statsFeatures=T),Object(s.j)(E)}return null}))).apply(this,arguments)}function x({relatedInfos:e,layer:t},r){var i={};return e.forEach(((e,n)=>{var{relation:s}=e;if(!s){var o=new a.a("relation-required","A relation is required on a layer to retrieve related records.");throw f.error(o),o}var{relatedTableId:l}=s;if("number"!=typeof l){var u=new a.a("A related table ID is required on a layer to retrieve related records.");throw f.error(u),u}var d="".concat(t.url,"/").concat(l),h=b.get(d),p=h||function(e,t){return Object(c.default)(e,{query:{f:"json"},signal:t&&t.signal})}(d,r);h||b.set(d,p),i[n]=p})),Object(s.j)(i)}function S({graphic:e,relatedInfos:t,layer:r},i){var n={};return t.forEach(((t,a)=>{t.layerInfo&&(n[a]=function(e,t,r,i){return w.apply(this,arguments)}(e,t,r,i))})),Object(s.j)(n)}function M({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){var i=new l.a({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(i)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return u}));var i=r(91),n=r(83),a=r(160),s=r(106),o=r(375),c=r(269);function l(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.keywords&&(t.keywords=t.keywords.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}function u(e,t){var r={};for(var i of e){var{parentObjectId:s,parentGlobalId:c,attachmentInfos:l}=i;for(var u of l){var{id:d}=u,h=Object(n.b)(Object(a.a)("".concat(t,"/").concat(s,"/attachments/").concat(d))),p=o.a.fromJSON(u);p.set({url:h,parentObjectId:s,parentGlobalId:c}),r[s]?r[s].push(p):r[s]=[p]}}return r}function d(e,t,r){var n={query:Object(c.a)(Object(i.a)(Object(i.a)({},e.query),{},{f:"json"},l(t)))};return r&&(n=Object(i.a)(Object(i.a)(Object(i.a)({},r),n),{},{query:Object(i.a)(Object(i.a)({},r.query),n.query)})),Object(s.default)(e.path+"/queryAttachments",n)}},,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var i=r(89),n=r(104),a=r(111),s=r(330),o=r(157),c=r(174),l=r(398),u=r(179),d=r(348),h=r(221),p=r(189);class f{constructor(){this._disposed=!1}get disposed(){return this._disposed}get shaderTransformation(){return this._shaderTransformation}acquire(e,t,r,i,n,a){this.id=Object(p.a)(),this.geometry=e,this.material=t,this.transformation=r,this.instanceParameters=i,this.origin=n,this._shaderTransformation=a,this._disposed=!1}release(){this._disposed=!1}dispose(){this._disposed=!0}getStaticTransformation(){return this.transformation}getShaderTransformation(){return Object(i.k)(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&(Object(a.l)(e,e,this.getStaticTransformation()),!0)}}f.pool=new h.a(f);var b=r(600),m=r(357);class v extends d.a{constructor(e={}){super(),this.type=1,this._geometryRecords=new Array,this._geometries=new Array,this._objectTransformation=Object(c.b)(),this._bvObjectSpace=new y,this._bvWorldSpace=new y,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.castShadow=null==e.castShadow||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new g),this.transformation=Object(c.b)();var{geometries:t,materials:r,transformations:i,origins:n}=e;if(Array.isArray(t)){Object(u.a)(r.length===t.length,"Object3D: materials don't match geometries"),Object(u.a)(i.length===t.length,"Object3D: transformations don't match geometries"),this._geometryRecords.length=t.length,this._geometries.length=t.length;for(var a=0;a<t.length;a++)this._geometries[a]=t[a],this._geometryRecords[a]=f.pool.acquire(t[a],r[a],Object(c.c)(i[a]),{highlights:null,occludees:null,visible:!0},n&&n[a])}}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get transformation(){return this._objectTransformation}set transformation(e){Object(o.c)(this._objectTransformation,e),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}dispose(){this._geometryRecords.length=0,this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(e){Object(u.a)(null==this._parentLayer||null==e,"Object3D can only be added to a single Layer"),this._parentLayer=e}getNumGeometryRecords(){return this._geometryRecords.length}getGeometryRecord(e){return Object(u.a)(e>=0&&e<this._geometryRecords.length,"Object3d.getGeometryDataByIndex: index out of range"),this._geometryRecords[e]}addGeometry(e,t,r,n,a,s){r=r||c.a,this._geometries.push(e);var o=f.pool.acquire(e,t,r,n||{highlights:null,occludees:null,visible:!0},a,s);return this._geometryRecords.push(o),this._hasVolatileTransformation=this._hasVolatileTransformation||Object(i.k)(o.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:o}),this._invalidateBoundingVolume(),o}removeGeometry(e){var t=this._geometryRecords.splice(e,1)[0];return this._hasVolatileTransformation=Object(i.k)(t.shaderTransformation)?this._geometryRecords.some((e=>Object(i.k)(e.shaderTransformation))):this._hasVolatileTransformation,t.dispose(),this._geometries.splice(e,1),this._emit("objectGeometryRemoved",{object:this,record:t}),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.getNumGeometryRecords()>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._emit("vertexAttrsUpdated",{object:this,record:this._geometryRecords[e]}),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){for(var t of(this._visible=e,this._geometryRecords))t.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)}maskOccludee(){var e=new b.a(1);for(var t of this._geometryRecords)t.instanceParameters.occludees=Object(m.b)(t.instanceParameters.occludees,e);return this._emit("occlusionChanged",this),e}removeOcclude(e){for(var t of this._geometryRecords)t.instanceParameters.occludees=Object(m.f)(t.instanceParameters.occludees,e);this._emit("occlusionChanged",this)}highlight(){var e=new b.a(0);for(var t of this._geometryRecords)t.instanceParameters.highlights=Object(m.b)(t.instanceParameters.highlights,e);return this._emit("highlightChanged",this),e}removeHighlight(e){for(var t of this._geometryRecords)t.instanceParameters.highlights=Object(m.f)(t.instanceParameters.highlights,e);this._emit("highlightChanged",this)}getCombinedStaticTransformation(e,t){return Object(o.l)(Object(i.r)(t,Object(c.b)()),this.transformation,e.getStaticTransformation())}getCombinedShaderTransformation(e,t){return t=t||Object(c.b)(),Object(o.l)(t,this.transformation,e.getShaderTransformation()),t}hasVolativeTransformation(){return this._hasVolatileTransformation}getBBMin(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMin:this._bvWorldSpace.bbMin}getBBMax(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bbMax:this._bvWorldSpace.bbMax}getBounds(e){return this._validateBoundingVolume(),e?this._bvObjectSpace.bounds:this._bvWorldSpace.bounds}_validateBoundingVolume(){if(this._bvDirty||this._hasVolatileTransformation){this._bvObjectSpace.init(),this._bvWorldSpace.init();for(var e=0;e<this._geometryRecords.length;++e){var t=this._geometries[e],r=this._geometryRecords[e],o=t.boundingInfo;Object(i.k)(o)&&(this._calculateTransformedBoundingVolume(o,this._bvObjectSpace,r.getShaderTransformation()),this._calculateTransformedBoundingVolume(o,this._bvWorldSpace,this.getCombinedShaderTransformation(r)))}Object(a.h)(this._bvObjectSpace.bounds,this._bvObjectSpace.bbMin,this._bvObjectSpace.bbMax,.5),Object(a.h)(this._bvWorldSpace.bounds,this._bvWorldSpace.bbMin,this._bvWorldSpace.bbMax,.5);for(var c=Object(n.e)(),l=Object(n.e)(),u=Object(s.f)(this.transformation),d=0;d<this._geometryRecords.length;++d){var h=this._geometries[d].boundingInfo;if(!Object(i.j)(h)){var p=this._geometryRecords[d].getShaderTransformation(),f=Object(s.f)(p);Object(a.l)(c,h.getCenter(),p);var b=Object(a.n)(c,this._bvObjectSpace.bounds),m=h.getBSRadius()*f;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],b+m),Object(a.l)(l,c,this.transformation);var v=Object(a.n)(l,this._bvWorldSpace.bounds),g=m*u;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],v+g)}}this._bvDirty=!1}}_calculateTransformedBoundingVolume(e,t,r){var i=e.getBBMin(),s=e.getBBMax(),o=Object(n.d)(i),c=Object(n.d)(s);Object(a.l)(o,o,r),Object(a.l)(c,c,r);for(var l=0;l<3;++l)t.bbMin[l]=Math.min(t.bbMin[l],o[l],c[l]),t.bbMax[l]=Math.max(t.bbMax[l],o[l],c[l]);for(var u=0;u<3;++u){Object(a.j)(o,i),Object(a.j)(c,s),o[u]=s[u],c[u]=i[u],Object(a.l)(o,o,r),Object(a.l)(c,c,r);for(var d=0;d<3;++d)t.bbMin[d]=Math.min(t.bbMin[d],o[d],c[d]),t.bbMax[d]=Math.max(t.bbMax[d],o[d],c[d])}}_invalidateBoundingVolume(){this._bvDirty=!0,Object(i.k)(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}_emit(e,t){Object(i.k)(this._parentLayer)&&this._parentLayer.events.emit(e,t)}get test(){var e=this;return{hasGeometry:t=>e._geometries.indexOf(t)>-1,getGeometryIndex:t=>e._geometries.indexOf(t)}}}class g{constructor(){this.bbMin=Object(n.g)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.bbMax=Object(n.g)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.bbMax[0]<this.bbMin[0]&&this.bbMax[1]<this.bbMin[1]&&this.bbMax[2]<this.bbMin[2]}}class y extends g{constructor(){super(...arguments),this.bounds=Object(l.b)()}init(){Object(a.v)(this.bbMin,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),Object(a.v)(this.bbMax,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),Object(l.a)(this.bounds)}}},,,,function(e,t,r){"use strict";function i(e,t,r,i){var n=null,a=1e3;"number"==typeof t?(a=t,i=r):(n=null!=t?t:null,a=r);var s,o=0,c=()=>{o=0,e.apply(i,s)},l=(...e)=>{n&&n.apply(i,e),s=e,a?o||(o=setTimeout(c,a)):c()};return l.remove=()=>{o&&(clearTimeout(o),o=0)},l.forceUpdate=()=>{o&&(clearTimeout(o),c())},l.hasPendingUpdates=()=>!!o,l}r.d(t,"a",(function(){return i}))},,function(e,t,r){"use strict";var i=r(89);t.a=class{constructor(e=(e=>e.values().next().value)){this._peeker=e,this._items=new Set}get length(){return this._items.size}clear(){this._items.clear()}peek(){if(0!==this._items.size)return this._peeker(this._items)}push(e){this.contains(e)||this._items.add(e)}contains(e){return this._items.has(e)}pop(){if(0!==this.length){var e=this.peek();return this._items.delete(Object(i.d)(e)),e}}remove(e){this._items.delete(e)}filter(e){return this._items.forEach((t=>{e(t)||this._items.delete(t)})),this}}},,function(e,t,r){"use strict";function i(){return new Float32Array(3)}function n(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(e,t,r){var i=new Float32Array(3);return i[0]=e,i[1]=t,i[2]=r,i}function s(){return i()}function o(){return a(1,1,1)}function c(){return a(1,0,0)}function l(){return a(0,1,0)}function u(){return a(0,0,1)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a}));var d=s(),h=o(),p=c(),f=l(),b=u();Object.freeze({__proto__:null,create:i,clone:n,fromValues:a,createView:function(e,t){return new Float32Array(e,t,3)},zeros:s,ones:o,unitX:c,unitY:l,unitZ:u,ZEROS:d,ONES:h,UNIT_X:p,UNIT_Y:f,UNIT_Z:b})},function(e,t,r){"use strict";var i=r(91),n=r(7),a=r(82),s=r(80),o=r(89),c=(r(81),r(88),r(85)),l=r(84),u=(r(83),r(86),r(87),r(146)),d=r(170),h=r(132),p=r(224),f=r(259),b=r(142),m=r(443);function v(){return(v=Object(n.a)((function*(e,t,r){var n=Object(b.c)(e);return Object(m.a)(n,f.a.from(t),Object(i.a)({},r)).then((e=>Object(m.b)(e.data.attachmentGroups,n.path)))}))).apply(this,arguments)}var g=r(190);function y(){return(y=Object(n.a)((function*(e,t,r){var n=Object(b.c)(e);return Object(g.executeQueryForCount)(n,h.a.from(t),Object(i.a)({},r)).then((e=>e.data.count))}))).apply(this,arguments)}var O=r(103);r(101);function j(){return(j=Object(n.a)((function*(e,t,r){var n=Object(b.c)(e);return Object(g.executeQueryForExtent)(n,h.a.from(t),Object(i.a)({},r)).then((e=>({count:e.data.count,extent:O.a.fromJSON(e.data.extent)})))}))).apply(this,arguments)}function _(){return(_=Object(n.a)((function*(e,t,r){var n=Object(b.c)(e);return Object(g.executeQueryForIds)(n,h.a.from(t),Object(i.a)({},r)).then((e=>e.data.objectIds))}))).apply(this,arguments)}function w(e,t,r){return x.apply(this,arguments)}function x(){return(x=Object(n.a)((function*(e,t,r){var n=Object(b.c)(e),a=Object(i.a)({},r),s=h.a.from(t),{data:o}=yield Object(g.executeQuery)(n,s,s.sourceSpatialReference,a);return o}))).apply(this,arguments)}var S=r(180),M=r(168),T=r(212);function E(e,t){return t}function P(e,t,r,i){switch(r){case 0:return R(e,t+i,0);case 1:return"lowerLeft"===e.originPosition?R(e,t+i,1):function({translate:e,scale:t},r,i){return e[i]-r*t[i]}(e,t+i,1)}}function C(e,t,r,i){switch(r){case 2:return R(e,t,2);default:return P(e,t,r,i)}}function I(e,t,r,i){switch(r){case 2:return R(e,t,3);default:return P(e,t,r,i)}}function A(e,t,r,i){switch(r){case 3:return R(e,t,3);default:return C(e,t,r,i)}}function R({translate:e,scale:t},r,i){return e[i]+r*t[i]}class F{constructor(e){this.options=e,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=E,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(e){if(this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,e.hasZ){var t=Object(T.a)(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(t)for(var r of e.features)t(r.geometry)}}createSpatialReference(){return{}}addField(e,t){e.fields.push(t);var r=e.fields.map((e=>e.name));this.AttributesConstructor=function(){for(var e of r)this[e]=null}}addFeature(e,t){e.features.push(t)}prepareFeatures(e){switch(this.transform=e.transform,this.options.applyTransform&&e.transform&&(this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"esriGeometryPoint":this.addCoordinate=(e,t,r)=>this.addCoordinatePoint(e,t,r),this.createGeometry=e=>this.createPointGeometry(e);break;case"esriGeometryPolygon":this.addCoordinate=(e,t,r)=>this.addCoordinatePolygon(e,t,r),this.createGeometry=e=>this.createPolygonGeometry(e);break;case"esriGeometryPolyline":this.addCoordinate=(e,t,r)=>this.addCoordinatePolyline(e,t,r),this.createGeometry=e=>this.createPolylineGeometry(e);break;case"esriGeometryMultipoint":this.addCoordinate=(e,t,r)=>this.addCoordinateMultipoint(e,t,r),this.createGeometry=e=>this.createMultipointGeometry(e);break;default:Object(S.a)(e.geometryType)}}createFeature(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this.AttributesConstructor}}allocateCoordinates(){}addLength(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)}addQueryGeometry(e,t){var{queryGeometry:r,queryGeometryType:n}=t,a=Object(M.z)(r.clone(),r,!1,!1,this.transform),s=Object(M.k)(a,n,!1,!1);e.queryGeometryType=n,e.queryGeometry=Object(i.a)({},s)}createPointGeometry(e){var t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}addCoordinatePoint(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t}}transformPathLikeValue(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)}addCoordinatePolyline(e,t,r){this.dehydratedAddPointsCoordinate(e.paths,t,r)}addCoordinatePolygon(e,t,r){this.dehydratedAddPointsCoordinate(e.rings,t,r)}addCoordinateMultipoint(e,t,r){0===r&&e.points.push([]);var i=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(i)}createPolygonGeometry(e){return{rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}createPolylineGeometry(e){return{paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}createMultipointGeometry(e){return{points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}dehydratedAddPointsCoordinate(e,t,r){0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var i=this.transformPathLikeValue(t,r),n=e[e.length-1];0===r&&(this.coordinateBufferPtr=0,this.coordinateBuffer=new Array(this.vertexDimension),n.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=i}deriveApplyTransform(e){var{hasZ:t,hasM:r}=e;return t&&r?A:t?C:r?I:P}}function L(e,t,r){return D.apply(this,arguments)}function D(){return(D=Object(n.a)((function*(e,t,r){var n=Object(b.c)(e),a=Object(i.a)({},r),s=h.a.from(t),o=!s.quantizationParameters,{data:c}=yield Object(g.executeQueryPBF)(n,s,new F({sourceSpatialReference:s.sourceSpatialReference,applyTransform:o}),a);return c}))).apply(this,arguments)}var k=r(106),z=r(269);function V(e,t){var r=e.toJSON();return r.objectIds&&(r.objectIds=r.objectIds.join(",")),r.orderByFields&&(r.orderByFields=r.orderByFields.join(",")),!r.outFields||null!=t&&t.returnCountOnly?delete r.outFields:-1!==r.outFields.indexOf("*")?r.outFields="*":r.outFields=r.outFields.join(","),r.outSpatialReference&&(r.outSR=r.outSR.wkid||JSON.stringify(r.outSR.toJSON()),delete r.outSpatialReference),r.dynamicDataSource&&(r.layer=JSON.stringify({source:r.dynamicDataSource}),delete r.dynamicDataSource),r}function N(e,t,r){return U.apply(this,arguments)}function U(){return(U=Object(n.a)((function*(e,t,r){var n=yield G(e,t,r),a=n.data,s=a.geometryType,o=a.spatialReference,c={};for(var l of a.relatedRecordGroups){var u={fields:void 0,objectIdFieldName:void 0,geometryType:s,spatialReference:o,hasZ:!!a.hasZ,hasM:!!a.hasM,features:l.relatedRecords};if(null!=l.objectId)c[l.objectId]=u;else for(var d in l)l.hasOwnProperty(d)&&"relatedRecords"!==d&&(c[l[d]]=u)}return Object(i.a)(Object(i.a)({},n),{},{data:c})}))).apply(this,arguments)}function B(e,t,r){return q.apply(this,arguments)}function q(){return(q=Object(n.a)((function*(e,t,r){var n=yield G(e,t,r,{returnCountOnly:!0}),a=n.data,s={};for(var o of a.relatedRecordGroups)null!=o.objectId&&(s[o.objectId]=o.count);return Object(i.a)(Object(i.a)({},n),{},{data:s})}))).apply(this,arguments)}function G(e,t){return H.apply(this,arguments)}function H(){return(H=Object(n.a)((function*(e,t,r={},n){var a=Object(z.a)(Object(i.a)(Object(i.a)(Object(i.a)({},e.query),{},{f:"json"},n),V(t,n)));return Object(k.default)(e.path+"/queryRelatedRecords",Object(i.a)(Object(i.a)({},r),{},{query:Object(i.a)(Object(i.a)({},r.query),a)}))}))).apply(this,arguments)}function W(){return(W=Object(n.a)((function*(e,t,r){return t=p.a.from(t),N(Object(b.c)(e),t,r).then((e=>{var t=e.data,r={};return Object.keys(t).forEach((e=>r[e]=u.default.fromJSON(t[e]))),r}))}))).apply(this,arguments)}function J(){return(J=Object(n.a)((function*(e,t,r){return t=p.a.from(t),B(Object(b.c)(e),t,Object(i.a)({},r)).then((e=>e.data))}))).apply(this,arguments)}var Z=r(324),X=class extends Z.a{constructor(e){super(e),this.dynamicDataSource=null,this.format="json",this.gdbVersion=null,this.sourceSpatialReference=null}execute(e,t){return this.executeJSON(e,t).then((e=>u.default.fromJSON(e)))}executeJSON(e,t){var r=this;return Object(n.a)((function*(){var n,a,o=Object(i.a)(Object(i.a)({},r.requestOptions),t),c=r._normalizeQuery(e),l=null!=(null==(n=e.outStatistics)?void 0:n[0]),u=Object(s.a)("featurelayer-pbf-statistics"),d=!l||u;if("pbf"===r.format&&d)try{a=yield L(r.url,c,o)}catch(h){if("query:parsing-pbf"!==h.name)throw h;r.format="json"}return"json"!==r.format&&d||(a=yield w(r.url,c,o)),r._normalizeFields(a.fields),a}))()}executeForCount(e,t){var r=Object(i.a)(Object(i.a)({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return y.apply(this,arguments)}(this.url,n,r)}executeForExtent(e,t){var r=Object(i.a)(Object(i.a)({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return j.apply(this,arguments)}(this.url,n,r)}executeForIds(e,t){var r=Object(i.a)(Object(i.a)({},this.requestOptions),t),n=this._normalizeQuery(e);return function(e,t,r){return _.apply(this,arguments)}(this.url,n,r)}executeRelationshipQuery(e,t){e=p.a.from(e);var r=Object(i.a)(Object(i.a)({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return W.apply(this,arguments)}(this.url,e,r)}executeRelationshipQueryForCount(e,t){e=p.a.from(e);var r=Object(i.a)(Object(i.a)({},this.requestOptions),t);return(this.gdbVersion||this.dynamicDataSource)&&((e=e.clone()).gdbVersion=e.gdbVersion||this.gdbVersion,e.dynamicDataSource=e.dynamicDataSource||this.dynamicDataSource),function(e,t,r){return J.apply(this,arguments)}(this.url,e,r)}executeAttachmentQuery(e,t){var r=Object(i.a)(Object(i.a)({},this.requestOptions),t);return function(e,t,r){return v.apply(this,arguments)}(this.url,e,r)}_normalizeQuery(e){var t=h.a.from(e);if(t.sourceSpatialReference=t.sourceSpatialReference||this.sourceSpatialReference,!this.gdbVersion&&!this.dynamicDataSource)return t;var r=t===e?t.clone():t;return r.gdbVersion=e.gdbVersion||this.gdbVersion,r.dynamicDataSource=e.dynamicDataSource?d.a.from(e.dynamicDataSource):this.dynamicDataSource,r}_normalizeFields(e){if(Object(o.k)(this.fieldsIndex)&&Object(o.k)(e))for(var t of e){var r=this.fieldsIndex.get(t.name);r&&Object.assign(t,r.toJSON())}}};Object(a.a)([Object(c.b)({type:d.a})],X.prototype,"dynamicDataSource",void 0),Object(a.a)([Object(c.b)()],X.prototype,"fieldsIndex",void 0),Object(a.a)([Object(c.b)()],X.prototype,"format",void 0),Object(a.a)([Object(c.b)()],X.prototype,"gdbVersion",void 0),Object(a.a)([Object(c.b)()],X.prototype,"sourceSpatialReference",void 0);var Y=X=Object(a.a)([Object(l.a)("esri.tasks.QueryTask")],X);t.a=Y},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(91),n=r(89),a=r(179),s=r(176),o=r(104),c=r(111);class l{constructor(e,t,r,i){this.primitiveIndices=e,this._numIndexPerPrimitive=t,this.indices=r,this.position=i,this.center=Object(o.e)(),Object(a.a)(e.length>=1),Object(a.a)(r.length%this._numIndexPerPrimitive==0),Object(a.a)(r.length>=e.length*this._numIndexPerPrimitive),Object(a.a)(3===i.size||4===i.size);var{data:n,size:s}=i,l=e.length,d=s*r[this._numIndexPerPrimitive*e[0]];u.clear(),u.push(d),this.bbMin=Object(o.g)(n[d],n[d+1],n[d+2]),this.bbMax=Object(o.d)(this.bbMin);for(var h=0;h<l;++h)for(var p=this._numIndexPerPrimitive*e[h],f=0;f<this._numIndexPerPrimitive;++f){d=s*r[p+f],u.push(d);var b=n[d];this.bbMin[0]=Math.min(b,this.bbMin[0]),this.bbMax[0]=Math.max(b,this.bbMax[0]),b=n[d+1],this.bbMin[1]=Math.min(b,this.bbMin[1]),this.bbMax[1]=Math.max(b,this.bbMax[1]),b=n[d+2],this.bbMin[2]=Math.min(b,this.bbMin[2]),this.bbMax[2]=Math.max(b,this.bbMax[2])}Object(c.h)(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);for(var m=this.radius*this.radius,v=0;v<u.length;++v){var g=n[d=u.getItemAt(v)]-this.center[0],y=n[d+1]-this.center[1],O=n[d+2]-this.center[2],j=g*g+y*y+O*O;if(!(j<=m)){var _=Math.sqrt(j),w=.5*(_-this.radius);this.radius=this.radius+w,m=this.radius*this.radius;var x=w/_;this.center[0]+=g*x,this.center[1]+=y*x,this.center[2]+=O*x}}u.clear()}getCenter(){return this.center}getBSRadius(){return this.radius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getChildren(){if(this._children)return this._children;if(Object(c.k)(this.bbMin,this.bbMax)>1){for(var e=Object(c.h)(Object(o.e)(),this.bbMin,this.bbMax,.5),t=this.primitiveIndices.length,r=new Uint8Array(t),i=new Array(8),n=0;n<8;++n)i[n]=0;for(var{data:a,size:s}=this.position,u=0;u<t;++u){for(var d=0,h=this._numIndexPerPrimitive*this.primitiveIndices[u],p=s*this.indices[h],f=a[p],b=a[p+1],m=a[p+2],v=1;v<this._numIndexPerPrimitive;++v){var g=a[p=s*this.indices[h+v]],y=a[p+1],O=a[p+2];g<f&&(f=g),y<b&&(b=y),O<m&&(m=O)}f<e[0]&&(d|=1),b<e[1]&&(d|=2),m<e[2]&&(d|=4),r[u]=d,++i[d]}for(var j=0,_=0;_<8;++_)i[_]>0&&++j;if(j<2)return;for(var w=new Array(8),x=0;x<8;++x)w[x]=i[x]>0?new Uint32Array(i[x]):void 0;for(var S=0;S<8;++S)i[S]=0;for(var M=0;M<t;++M){var T=r[M];w[T][i[T]++]=this.primitiveIndices[M]}this._children=new Array(8);for(var E=0;E<8;++E)void 0!==w[E]&&(this._children[E]=new l(w[E],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}static prune(){u.prune()}}var u=new s.a({deallocator:null}),d=r(348),h=r(378);class p extends d.a{constructor(e,t=[],r=0,n=-1){for(var[a,s]of(super(),this._primitiveType=r,this.edgeIndicesLength=n,this.type=2,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null,e))s&&this._vertexAttributes.set(a,Object(i.a)({},s));if(null==t||0===t.length){var o=function(e){var t=e.values().next().value;return null==t?0:t.data.length/t.size}(this._vertexAttributes),c=Object(h.d)(o);for(var l of(this.edgeIndicesLength=this.edgeIndicesLength<0?o:this.edgeIndicesLength,this._vertexAttributes.keys()))this._indices.set(l,c)}else for(var[u,d]of t)d&&(this._indices.set(u,f(d)),"position"===u&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(u).length:this.edgeIndicesLength))}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(e){var t=this._vertexAttributes.get(e);return t&&!t.exclusive&&(t.data=Array.from(t.data),t.exclusive=!0),t}get indices(){return this._indices}get indexCount(){var e=this._indices.values().next().value;return e?e.length:0}get primitiveType(){return this._primitiveType}get faceCount(){return this.indexCount/3}get boundingInfo(){return Object(n.j)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(e){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(e):this.computeAttachmentOriginPoints(e)}computeAttachmentOriginTriangles(e){var t=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(h.c)(r,t,e)}computeAttachmentOriginPoints(e){var t=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(h.b)(r,t,e)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){var e=this.indices.get("position");if(0===e.length)return null;var t=0===this.primitiveType?3:1;Object(a.a)(e.length%t==0,"Indexing error: "+e.length+" not divisible by "+t);var r=Object(h.d)(e.length/t),i=this.vertexAttributes.get("position");return new l(r,t,e,i)}}function f(e){if(e.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return e;for(var t of e)if(t>=65536)return e;return new Uint16Array(e)}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(82),n=(r(80),r(81),r(88),r(85),r(84)),a=(r(83),r(86),r(87),r(129)),s=r(389),o=e=>{var t=class extends e{constructor(){super(...arguments),this.renderNodeContent=e=>Object(s.b)(e)&&!e.destroyed?Object(a.a)("div",{key:e},e.render()):e instanceof HTMLElement?Object(a.a)("div",{key:e,bind:e,afterCreate:this._attachToNode}):Object(s.a)(e)?Object(a.a)("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null}_attachToNode(e){e.appendChild(this)}};return t=Object(i.a)([Object(n.a)("esri.widgets.Feature.ContentMixin")],t)}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return d}));var i=r(111),n=r(299),a=r(177),s=r(374);function o(e){return e?{ray:Object(s.b)(e.ray),c0:e.c0,c1:e.c1}:{ray:Object(s.b)(),c0:0,c1:Number.MAX_VALUE}}function c(e,t,r,i=o()){return Object(s.a)(e,i.ray),i.c0=t,i.c1=r,i}function l(e,t=o()){return Object(s.a)(e,t.ray),t.c0=0,t.c1=Number.MAX_VALUE,t}function u(e,t,r=o()){var n=Object(i.o)(e.vector);return Object(s.d)(e.origin,t,r.ray),r.c0=0,r.c1=n,r}function d(e,t){return p(e,e.c0,t)}function h(e,t){return p(e,e.c1,t)}function p(e,t,r){return Object(i.e)(r,e.ray.origin,Object(i.d)(r,e.ray.direction,t))}var f=new n.a((()=>({c0:0,c1:0,ray:null}))),b=Object.freeze({__proto__:null,create:o,wrap:function(e,t,r){var i=f.get();return i.ray=e,i.c0=t,i.c1=r,i},copy:function(e,t=o()){return c(e.ray,e.c0,e.c1,t)},fromValues:c,fromRay:l,fromLineSegment:function(e,t=o()){return u(e,Object(i.q)(a.d.get(),e.vector),t)},fromLineSegmentAndDirection:u,getStart:d,getEnd:h,getAt:p})},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r(89),n=r(157),a=r(174),s=r(453),o=r(509),c=r(517);class l extends c.a{constructor(e){super(e.view),this._resources=null,this._transform=Object(a.b)()}get object(){return Object(i.k)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(e){Object(n.c)(this._transform,e),Object(i.k)(this._resources)&&(this._resources.object.transformation=this._transform,this._resources.layer.commit())}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(!Object(i.j)(this._resources)){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries),this._resources.layer.commit()}}createResources(){this.destroyResources();var e=this.view._stage;if(e){var t=new o.a({isPickable:!1});e.add(t);var r=new s.a({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(r),t.add(r),t.commit(),this.visible||(r.setVisible(!1),t.commit()),this._resources={layer:t,object:r}}}destroyResources(){var e=this.view._stage;!Object(i.j)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((t=>{e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){Object(i.j)(this._resources)||(this._resources.object.setVisible(e),this._resources.layer.commit())}}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return U}));var i,n=r(91),a=r(89),s=r(81),o=r(110),c=r(105),l=r(104),u=r(111),d=r(135),h=r(368),p=r(255),f=r(179),b=r(378),m=r(357),v=r(388),g=r(379),y=r(332),O=r(461);(i||(i={})).Default={vvSizeEnabled:!1,vvSizeMinSize:Object(O.c)(1,1,1),vvSizeMaxSize:Object(O.c)(100,100,100),vvSizeOffset:Object(O.c)(0,0,0),vvSizeFactor:Object(O.c)(1,1,1),vvSizeValue:Object(O.c)(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:Object(y.a)()};var j=i,_=r(82),w=r(300),x=r(307),S=r(313),M=r(286),T=r(267),E=r(380),P=r(249),C=r(322),I=r(426),A=r(349),R=r(280),F=r(489),L=r(615),D={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};class k extends x.a{constructor(e,t){super(e,t),this.stipplePattern=null,this.stippleTextureBind=null,this.stippleTextureRepository=e.stippleTextureRepository}initializeProgram(e){var t=k.shader.get(),r=this.configuration,i=t.build({OITEnabled:0===r.transparencyPassType,output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,stippleEnabled:r.stippleEnabled,stippleOffColorEnabled:r.stippleOffColorEnabled,stippleUVMaxEnabled:r.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:r.stippleIntegerRepeatsEnabled,roundCaps:r.roundCaps,roundJoins:r.roundJoins,vvColor:r.vvColor,vvSize:r.vvSize,vvInstancingEnabled:!0,vvOpacity:r.vvOpacity,falloffEnabled:r.falloffEnabled,innerColorEnabled:r.innerColorEnabled,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new M.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),D)}dispose(){super.dispose(),this.stippleTextureRepository.release(this.stipplePattern),this.stipplePattern=null,this.stippleTextureBind=null}bindPass(e,t,r){if(E.a.bindProjectionMatrix(this.program,r.camera.projectionMatrix),4===this.configuration.output&&C.a.bindOutputHighlight(e,this.program,r),r.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",r.inverseViewport),Object(R.a)(this.program,e,r)),this.program.setUniform1f("intrinsicWidth",t.width),this.program.setUniform4fv("intrinsicColor",t.color),this.program.setUniform1f("miterLimit","miter"!==t.join?0:t.miterLimit),this.program.setUniform2fv("cameraNearFar",r.camera.nearFar),this.program.setUniform1f("pixelRatio",r.camera.pixelRatio),this.program.setUniform2f("screenSize",r.camera.fullViewport[2],r.camera.fullViewport[3]),I.a.bindUniformsWithOpacity(this.program,t),this.stipplePattern!==t.stipplePattern){var i=t.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,i),this.stipplePattern=i}if(this.configuration.stippleEnabled){var n=Object(a.k)(this.stippleTextureBind)?this.stippleTextureBind(e,0)*r.camera.pixelRatio:1;if(this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/n),this.configuration.stippleOffColorEnabled){var s=Object(a.q)(t.stippleOffColor);this.program.setUniform4f("stippleOffColor",s[0],s[1],s[2],s.length>3?s[3]:1)}}this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",t.falloff),this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",Object(a.r)(t.innerColor,t.color)),this.program.setUniform1f("innerWidth",t.innerWidth*r.camera.pixelRatio))}bindDraw(e){E.a.bindView(this.program,e),P.a.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e,t){var r=this.configuration,i=3===e,n=2===e;return Object(T.d)({blending:0===r.output||7===r.output?i?A.f:Object(A.a)(e):null,depthTest:{func:Object(A.b)(e)},depthWrite:i?!r.transparent&&r.writeDepth&&T.c:Object(A.c)(e),colorWrite:T.b,stencilWrite:r.sceneHasOcludees?F.h:null,stencilTest:r.sceneHasOcludees?t?F.d:F.c:null,polygonOffset:i||n?r.polygonOffset&&z:A.d})}initializePipeline(){var e=this.configuration,t=e.polygonOffset&&z;return e.occluder&&(this._occluderPipelineTransparent=Object(T.d)({blending:A.f,polygonOffset:t,depthTest:F.a,depthWrite:null,colorWrite:T.b,stencilWrite:null,stencilTest:F.f}),this._occluderPipelineOpaque=Object(T.d)({blending:A.f,polygonOffset:t,depthTest:F.a,depthWrite:null,colorWrite:T.b,stencilWrite:F.g,stencilTest:F.e}),this._occluderPipelineMaskWrite=Object(T.d)({blending:null,polygonOffset:t,depthTest:F.b,depthWrite:null,colorWrite:null,stencilWrite:F.h,stencilTest:F.d})),this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}get primitiveType(){return 5}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?11===e?this._occluderPipelineTransparent:10===e?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:this.pipeline}}k.shader=new w.a(L.a,(()=>r.e(301).then(r.bind(null,1184))));var z={factor:0,units:-4};class V extends S.a{constructor(){super(...arguments),this.output=0,this.occluder=!1,this.slicePlaneEnabled=!1,this.transparent=!1,this.polygonOffset=!1,this.writeDepth=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stippleIntegerRepeatsEnabled=!1,this.roundCaps=!1,this.roundJoins=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.falloffEnabled=!1,this.innerColorEnabled=!1,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}Object(_.a)([Object(S.b)({count:8})],V.prototype,"output",void 0),Object(_.a)([Object(S.b)()],V.prototype,"occluder",void 0),Object(_.a)([Object(S.b)()],V.prototype,"slicePlaneEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"transparent",void 0),Object(_.a)([Object(S.b)()],V.prototype,"polygonOffset",void 0),Object(_.a)([Object(S.b)()],V.prototype,"writeDepth",void 0),Object(_.a)([Object(S.b)()],V.prototype,"stippleEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"stippleOffColorEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"stippleIntegerRepeatsEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"roundCaps",void 0),Object(_.a)([Object(S.b)()],V.prototype,"roundJoins",void 0),Object(_.a)([Object(S.b)()],V.prototype,"vvSize",void 0),Object(_.a)([Object(S.b)()],V.prototype,"vvColor",void 0),Object(_.a)([Object(S.b)()],V.prototype,"vvOpacity",void 0),Object(_.a)([Object(S.b)()],V.prototype,"falloffEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"innerColorEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"sceneHasOcludees",void 0),Object(_.a)([Object(S.b)({count:4})],V.prototype,"transparencyPassType",void 0),Object(_.a)([Object(S.b)()],V.prototype,"multipassTerrainEnabled",void 0),Object(_.a)([Object(S.b)()],V.prototype,"cullAboveGround",void 0);var N=s.a.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");class U extends g.a{constructor(e){super(e,q),this._vertexAttributeLocations=D,this.techniqueConfig=new V,this.layout=this.createLayout()}isClosed(e,t){return J(this.params,e,t)}dispose(){}getPassParameters(){return this.params}getTechniqueConfig(e,t){this.techniqueConfig.output=e;var r=Object(a.k)(this.params.stipplePattern);return this.techniqueConfig.stippleEnabled=r,this.techniqueConfig.stippleIntegerRepeatsEnabled=r&&this.params.stippleIntegerRepeats,this.techniqueConfig.stippleOffColorEnabled=r&&Object(a.k)(this.params.stippleOffColor),this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.roundJoins="round"===this.params.join,this.techniqueConfig.roundCaps="round"===this.params.cap,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.innerColorEnabled=this.params.innerWidth>0&&Object(a.k)(this.params.innerColor),this.techniqueConfig.falloffEnabled=this.params.falloff>0,this.techniqueConfig.occluder=8===this.params.renderOccluded,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}intersect(e,t,r,i,n,a,s,o,c){c?this.intersectDrapedLineGeometry(e,i,a,s):this.intersectLineGeometry(e,t,r,i,this.params.width,s)}intersectDrapedLineGeometry(e,t,r,i){if(t.options.selectionMode){var n=e.vertexAttributes.get("position").data,a=e.vertexAttributes.get("size"),s=this.params.width;if(this.params.vvSizeEnabled){var c=e.vertexAttributes.get("sizeFeatureAttribute").data[0];s*=Object(o.d)(this.params.vvSizeOffset[0]+c*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else a&&(s*=a.data[0]);for(var l=r[0],u=r[1],d=(s/2+4)*e.screenToWorldRatio,h=Number.MAX_VALUE,p=0;p<n.length-5;p+=3){var f=n[p],b=n[p+1],m=l-f,v=u-b,g=n[p+3]-f,y=n[p+4]-b,O=Object(o.d)((g*m+y*v)/(g*g+y*y),0,1),j=g*O-m,_=y*O-v,w=j*j+_*_;w<h&&(h=w)}h<d*d&&i()}}intersectLineGeometry(e,t,r,i,n,a){if(i.options.selectionMode&&!Object(m.d)(t))if(Object(f.g)(r)){var s=e.vertexAttributes,c=s.get("position").data,l=n;if(this.params.vvSizeEnabled){var h=s.get("sizeFeatureAttribute").data[0];l*=Object(o.d)(this.params.vvSizeOffset[0]+h*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else s.has("size")&&(l*=s.get("size").data[0]);var b=i.camera,v=ee;Object(d.c)(v,i.point);var g=l*b.pixelRatio/2+4*b.pixelRatio;Object(u.v)(ue[0],v[0]-g,v[1]+g,0),Object(u.v)(ue[1],v[0]+g,v[1]+g,0),Object(u.v)(ue[2],v[0]+g,v[1]-g,0),Object(u.v)(ue[3],v[0]-g,v[1]-g,0);for(var y=0;y<4;y++)if(!b.unprojectFromRenderScreen(ue[y],de[y]))return;p.e.fromPoints(b.eye,de[0],de[1],he),p.e.fromPoints(b.eye,de[1],de[2],pe),p.e.fromPoints(b.eye,de[2],de[3],fe),p.e.fromPoints(b.eye,de[3],de[0],be);for(var O=Number.MAX_VALUE,j=W(this.params,s,e.indices)?c.length-2:c.length-5,_=0;_<j;_+=3){Y[0]=c[_]+r[12],Y[1]=c[_+1]+r[13],Y[2]=c[_+2]+r[14];var w=(_+3)%c.length;if(Q[0]=c[w]+r[12],Q[1]=c[w+1]+r[13],Q[2]=c[w+2]+r[14],!(p.e.signedDistance(he,Y)<0&&p.e.signedDistance(he,Q)<0||p.e.signedDistance(pe,Y)<0&&p.e.signedDistance(pe,Q)<0||p.e.signedDistance(fe,Y)<0&&p.e.signedDistance(fe,Q)<0||p.e.signedDistance(be,Y)<0&&p.e.signedDistance(be,Q)<0)){if(b.projectToRenderScreen(Y,te),b.projectToRenderScreen(Q,re),te[2]<0&&re[2]>0){Object(u.i)(K,Y,Q);var x=b.frustum,S=-p.e.signedDistance(x[4],Y)/Object(u.g)(K,p.e.normal(x[4]));Object(u.d)(K,K,S),Object(u.e)(Y,Y,K),b.projectToRenderScreen(Y,te)}else if(te[2]>0&&re[2]<0){Object(u.i)(K,Q,Y);var M=b.frustum,T=-p.e.signedDistance(M[4],Q)/Object(u.g)(K,p.e.normal(M[4]));Object(u.d)(K,K,T),Object(u.e)(Q,Q,K),b.projectToRenderScreen(Q,re)}else if(te[2]<0&&re[2]<0)continue;te[2]=0,re[2]=0;var E=p.d.distance2(p.d.fromPoints(te,re,ae),v);E<O&&(O=E,Object(u.j)(ie,Y),Object(u.j)(ne,Q))}}var P=i.rayBeginPoint,C=i.rayEndPoint;if(O<g*g){var I=Number.MAX_VALUE;if(p.d.closestLineSegmentPoint(p.d.fromPoints(ie,ne,ae),p.d.fromPoints(P,C,se),$)){Object(u.i)($,$,P);var A=Object(u.o)($);Object(u.d)($,$,1/A),I=A/Object(u.n)(P,C)}a(I,$)}}else N.error("intersection assumes a translation-only matrix")}computeAttachmentOrigin(e,t){var r=e.vertexAttributes;if(!r)return null;var i=e.indices,n=r.get("position");return Object(b.a)(n,i?i.get("position"):null,i&&W(this.params,r,i),t)}createLayout(){var e=Object(h.a)().vec3f("position").f32("subdivisionFactor").vec2f("uv0").vec3f("auxpos1").vec3f("auxpos2");return this.params.vvSizeEnabled?e.f32("sizeFeatureAttribute"):e.f32("size"),this.params.vvColorEnabled?e.f32("colorFeatureAttribute"):e.vec4f("color"),this.params.vvOpacityEnabled&&e.f32("opacityFeatureAttribute"),e}createBufferWriter(){return new G(this.layout,this.params)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output||1===e.output?new B(e):void 0}validateParameterValues(e){"miter"!==e.join&&(e.miterLimit=0),this.requiresTransparent(e)&&(e.transparent=!0)}requiresTransparent(e){return!!((e.color&&e.color[3])<1||e.innerWidth>0&&this.colorRequiresTransparent(e.innerColor)||e.stipplePattern&&this.colorRequiresTransparent(e.stippleOffColor)||e.falloff>0)}colorRequiresTransparent(e){return Object(a.k)(e)&&e[3]<1&&e[3]>0}}class B extends v.a{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(k,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){return this.technique.configuration.occluder?3===e||10===e||11===e:0===this.output||7===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,e===this.targetSlot):3===e}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}getPipelineState(e,t){return this.technique.getPipelineState(e,t)}}var q=Object(n.a)(Object(n.a)({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},g.b),j.Default);class G{constructor(e,t){switch(this.params=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e,this.params.join){case"miter":case"bevel":this.numJoinSubdivisions=t.stipplePattern?1:0;break;case"round":this.numJoinSubdivisions=X}}isClosed(e){return W(this.params,e.vertexAttributes,e.indices)}numCapSubdivisions(e){if(this.isClosed(e))return 0;switch(this.params.cap){case"butt":return 0;case"square":return 1;case"round":return Z}}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){var t=2*this.numCapSubdivisions(e)+2,r=e.indices.get("position").length/2+1,i=this.isClosed(e),n=i?2:2*t,a=i?0:1,s=i?r:r-1;if(e.vertexAttributes.has("subdivisions"))for(var o=e.vertexAttributes.get("subdivisions").data,c=a;c<s;++c)n+=4+2*o[c];else n+=(s-a)*(2*this.numJoinSubdivisions+4);return n+=2}write(e,t,r,i){var n=oe,a=ce,s=le,o=t.vertexAttributes.get("position").data,c=t.indices&&t.indices.get("position"),l=this.numCapSubdivisions(t);c&&c.length!==2*(o.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");var d=null;t.vertexAttributes.has("subdivisions")&&(d=t.vertexAttributes.get("subdivisions").data);var h=1,p=0;this.params.vvSizeEnabled?p=t.vertexAttributes.get("sizeFeatureAttribute").data[0]:t.vertexAttributes.has("size")&&(h=t.vertexAttributes.get("size").data[0]);var f=[1,1,1,1],b=0;this.params.vvColorEnabled?b=t.vertexAttributes.get("colorFeatureAttribute").data[0]:t.vertexAttributes.has("color")&&(f=t.vertexAttributes.get("color").data);var m=0;this.params.vvOpacityEnabled&&(m=t.vertexAttributes.get("opacityFeatureAttribute").data[0]);var v=o.length/3,g=e.transformation,y=new Float32Array(r.buffer),O=this.vertexBufferLayout.stride/4,j=i*O,_=j,w=(e,t,r,i,n,a,s)=>{if(y[j++]=t[0],y[j++]=t[1],y[j++]=t[2],y[j++]=i,y[j++]=n,y[j++]=a,y[j++]=e[0],y[j++]=e[1],y[j++]=e[2],y[j++]=r[0],y[j++]=r[1],y[j++]=r[2],this.params.vvSizeEnabled?y[j++]=p:y[j++]=h,this.params.vvColorEnabled)y[j++]=b;else{var o=Math.min(4*s,f.length-4);y[j++]=f[o+0],y[j++]=f[o+1],y[j++]=f[o+2],y[j++]=f[o+3]}this.params.vvOpacityEnabled&&(y[j++]=m)};j+=O,Object(u.v)(a,o[0],o[1],o[2]),g&&Object(u.l)(a,a,g);var x=this.isClosed(t);if(x){var S=o.length-3;Object(u.v)(n,o[S],o[S+1],o[S+2]),g&&Object(u.l)(n,n,g)}else{Object(u.j)(n,a),Object(u.v)(s,o[3],o[4],o[5]),g&&Object(u.l)(s,s,g);for(var M=0;M<l;++M){var T=1-M/l;w(n,a,s,T,1,-4,0),w(n,a,s,T,1,4,0)}w(n,a,s,0,0,-4,0),w(n,a,s,0,0,4,0),Object(u.j)(n,a),Object(u.j)(a,s)}for(var E=x?v:v-1,P=x?0:1;P<E;P++){var C=(P+1)%v*3;Object(u.v)(s,o[C+0],o[C+1],o[C+2]),g&&Object(u.l)(s,s,g),w(n,a,s,0,1,-1,P),w(n,a,s,0,1,1,P);for(var I=d?d[P]:this.numJoinSubdivisions,A=0;A<I;++A){var R=(A+1)/(I+1);w(n,a,s,R,1,-2,P),w(n,a,s,R,1,2,P)}w(n,a,s,1,0,-2,P),w(n,a,s,1,0,2,P),Object(u.j)(n,a),Object(u.j)(a,s)}if(x)j=H(y,_+O,y,j,2*O);else{w(n,a,s,0,1,-5,E),w(n,a,s,0,1,5,E);for(var F=0;F<l;++F){var L=(F+1)/l;w(n,a,s,L,1,-5,E),w(n,a,s,L,1,5,E)}}H(y,_+O,y,_,O),j=H(y,j-O,y,j,O)}}function H(e,t,r,i,n){for(var a=0;a<n;a++)r[i++]=e[t++];return i}function W(e,t,r){return J(e,t.get("position").data,r?r.get("position"):null)}function J(e,t,r){return!!e.isClosed&&(r?r.length>2:t.length>6)}var Z=3,X=1,Y=Object(l.e)(),Q=Object(l.e)(),K=Object(l.e)(),$=Object(l.e)(),ee=Object(l.e)(),te=Object(c.e)(),re=Object(c.e)(),ie=Object(l.e)(),ne=Object(l.e)(),ae=p.d.create(),se=p.d.create(),oe=Object(l.e)(),ce=Object(l.e)(),le=Object(l.e)(),ue=[Object(c.e)(),Object(c.e)(),Object(c.e)(),Object(c.e)()],de=[Object(l.e)(),Object(l.e)(),Object(l.e)(),Object(l.e)()],he=p.e.create(),pe=p.e.create(),fe=p.e.create(),be=p.e.create()},function(e,t,r){"use strict";var i=r(91),n=r(7),a=r(82),s=(r(80),r(89)),o=r(81),c=(r(88),r(85)),l=r(84),u=(r(83),r(86),r(87),r(94)),d=r(97),h=r(338),p=r(123),f=r(115),b=r(108),m=r(457),v=r(196),g=r(438),y=r(439),O=r(440),j=r(442),_=r(441),w=r(271),x=["$datastore","$map","$layer","$aggregatedfeatures"],S=o.a.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");function M(e){return'<ul class="esri-widget__list">'.concat(e.map((e=>"<li>".concat("string"==typeof e?Object(v.a)(Object(v.n)(e)):e,"</li>"))).join(""),"</ul>")}function T(e){return'<table class="esri-widget__table">'.concat(e.keys().map((t=>{var r=e.field(t);return"<tr><th>".concat(t,"</th><td>").concat("string"==typeof r?Object(v.a)(Object(v.n)(r)):r,"</td></tr>")})).join(""),"</table>")}function E({aggregatedFeatures:e,arcadeUtils:t,featureSetVars:r,context:n,viewInfo:a,map:s,graphic:o}){r.forEach((r=>{var c=r.toLowerCase(),l={map:s,spatialReference:a.sr};if("$map"===c&&(n.vars[c]=t.convertMapToFeatureSetCollection(l)),"$layer"===c&&(n.vars[c]=t.convertFeatureLayerToFeatureSet(o.sourceLayer,a.sr)),"$datastore"===c&&(n.vars[c]=t.convertServiceUrlToWorkspace(o.sourceLayer.url,a.sr)),"$aggregatedfeatures"===c){var u=o.layer,{fields:d,objectIdField:h,geometryType:p,spatialReference:f,displayField:b}=u,m=new w.default(Object(i.a)(Object(i.a)({fields:d,objectIdField:h,geometryType:p,spatialReference:f,displayField:b},"feature"===u.type?{templates:u.templates,typeIdField:u.typeIdField,types:u.types}:null),{},{source:e}));n.vars[c]=t.convertFeatureLayerToFeatureSet(m,a.sr)}}))}function P(){return r.e(31).then(r.bind(null,383))}function C(e){return I.apply(this,arguments)}function I(){return(I=Object(n.a)((function*({graphic:e,view:t}){var{isAggregate:r,layer:i}=e;if(!r||!i||"2d"!==(null==t?void 0:t.type))return[];var n=yield t.whenLayerView(i);if(!n.createQuery||!n.queryFeatures)return[];var a=n.createQuery();a.aggregateIds=[e.getObjectId()];var{features:s}=yield n.queryFeatures(a);return s}))).apply(this,arguments)}function A(e){return R.apply(this,arguments)}function R(){return(R=Object(n.a)((function*({expressionAttributes:e,info:t,arcadeUtils:r,spatialReference:i,map:n,graphic:a,view:s}){var o="expression/".concat(t.name),c=r.createSyntaxTree(t.expression),l=x.filter((e=>r.hasVariable(c,e)));yield r.loadScriptDependencies(c,!0,l);var u=r.getViewInfo({spatialReference:i}),d=r.createExecContext(a,u);d.useAsync=!0,E({aggregatedFeatures:yield C({graphic:a,view:s}),arcadeUtils:r,featureSetVars:l,context:d,viewInfo:u,map:n,graphic:a});var h=r.createFunction(c,d),p=yield r.executeAsyncFunction(h,d).catch((e=>S.error("arcade-execution-error",{error:e,graphic:a,expressionInfo:t})));e[o]="string"==typeof p?Object(v.a)(Object(v.n)(p)):Array.isArray(p)?M(p):p&&"esri.arcade.Dictionary"===p.declaredClass?T(p):p}))).apply(this,arguments)}function F(e){return L.apply(this,arguments)}function L(){return(L=Object(n.a)((function*({popupTemplate:e,spatialReference:t,graphic:r,map:i,view:n}){var a=e.expressionInfos,s=[],o={};if(!a||!a.length)return o;var c=yield P();for(var l of a)s.push(A({expressionAttributes:o,info:l,arcadeUtils:c,spatialReference:t,map:i,graphic:r,view:n}));return yield Object(u.j)(s),o}))).apply(this,arguments)}var D="esri.widgets.FeatureViewModel",k=o.a.getLogger(D),z=class extends d.a{constructor(e){super(e),this._handles=new f.a,this._featureAbortController=null,this.graphicChangedThrottled=Object(m.a)(this.graphicChanged,1,this),this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._handles.add(Object(b.a)(this,["graphic","_effectivePopupTemplate"],(()=>this.graphicChangedThrottled())))}destroy(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return Object(s.k)(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return Object(v.b)(Object(v.g)(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return Object(v.l)(this.graphic)}set graphic(e){this._set("graphic",e?e.clone():null)}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(e,t){var r=this.contentViewModels[e];r instanceof _.a&&r.setActiveMedia(t)}nextMedia(e){var t=this.contentViewModels[e];t instanceof _.a&&t.next()}previousMedia(e){var t=this.contentViewModels[e];t instanceof _.a&&t.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}graphicChanged(){var e=this;return Object(n.a)((function*(){e._cancelFeatureQuery(),e._clear();var{graphic:t}=e;if(t){var r=Object(u.d)();e._featureAbortController=r;try{yield e._queryFeature({signal:r.signal})}catch(i){k.error("error","error loading popupTemplate for graphic",{error:i,graphic:t})}e._featureAbortController===r&&(e._featureAbortController=null)}}))()}_cancelFeatureQuery(){var{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new h.a({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[])}_compileAttachments(e,t){var{graphic:r}=this,{description:n,title:a}=e;return this.contentViewModels[t]=new g.a(Object(i.a)({graphic:r},this._compileTitleAndDesc({title:a,description:n}))),e}_compileCustom(e,t){var{graphic:r}=this,{creator:i,destroyer:n}=e;return this.contentViewModels[t]=new y.a({graphic:r,creator:i,destroyer:n}),e}_compileTitleAndDesc({title:e,description:t}){var{_fieldInfoMap:r,_sourceLayer:i,graphic:n,formattedAttributes:a}=this,{attributes:s}=n,o=a.global;return{title:Object(v.s)({attributes:s,fieldInfoMap:r,globalAttributes:o,layer:i,text:e}),description:Object(v.s)({attributes:s,fieldInfoMap:r,globalAttributes:o,layer:i,text:t})}}_compileFields(e,t){var{_effectivePopupTemplate:r,formattedAttributes:n}=this,a=e.clone(),s=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),o=null==r?void 0:r.expressionInfos,c=Object(i.a)(Object(i.a)({},n.global),n.content[t]),{description:l,title:u}=a,d=new O.a(Object(i.a)({attributes:c,expressionInfos:o,fieldInfos:s},this._compileTitleAndDesc({title:u,description:l})));return this.contentViewModels[t]=d,a.fieldInfos=d.formattedFieldInfos.slice(0),a}_compileMedia(e,t){var{graphic:r,_fieldInfoMap:n,_effectivePopupTemplate:a,relatedInfos:s,_sourceLayer:o}=this,{attributes:c}=r,l=this.formattedAttributes.global,u=e.clone(),{description:d,mediaInfos:h,title:p}=u,f=new _.a(Object(i.a)({activeMediaInfoIndex:u.activeMediaInfoIndex||0,attributes:c,layer:o,fieldInfoMap:n,formattedAttributes:l,mediaInfos:h,popupTemplate:a,relatedInfos:s},this._compileTitleAndDesc({title:p,description:d})));return u.mediaInfos=f.formattedMediaInfos.slice(0),this.contentViewModels[t]=f,u}_compileText(e,t){var r=e.clone(),{graphic:i,_fieldInfoMap:n,_sourceLayer:a}=this;if(r&&r.text){var{attributes:s}=i,o=this.formattedAttributes.global;r.text=Object(v.s)({attributes:s,fieldInfoMap:n,globalAttributes:o,layer:a,text:r.text})}return this.contentViewModels[t]=new y.a({graphic:i,creator:r.text}),r}_compileLastEditInfo(){var{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(e){var{lastEditInfoEnabled:i}=e,n=null==t?void 0:t.editFieldsInfo;return i&&n?Object(v.e)(n,r.attributes):void 0}}_compileTitle(e){var{_fieldInfoMap:t,_sourceLayer:r,graphic:i}=this,{attributes:n}=i,a=this.formattedAttributes.global;return Object(v.s)({attributes:n,fieldInfoMap:t,globalAttributes:a,layer:r,text:e})}_getTitle(){var e=this;return Object(n.a)((function*(){var{_effectivePopupTemplate:t,graphic:r}=e,i=null==t?void 0:t.title;return Object(v.m)(i,{graphic:r})}))()}_getContent(){var e=this;return Object(n.a)((function*(){var{_effectivePopupTemplate:t,graphic:r}=e,i=null==t?void 0:t.content;return Object(v.m)(i,{graphic:r})}))()}_queryFeature(e){var t=this;return Object(n.a)((function*(){var{_featureAbortController:r,_sourceLayer:i,graphic:n,_effectivePopupTemplate:a,spatialReference:s,map:o,view:c}=t,{content:{value:l},title:{value:d}}=yield Object(u.j)({content:t._getContent(),title:t._getTitle()});if(r===t._featureAbortController&&n){var{expressionAttributes:{value:h}}=yield Object(u.j)({checkForRelatedFeatures:t._checkForRelatedFeatures(e),expressionAttributes:F({popupTemplate:t._effectivePopupTemplate,spatialReference:s,graphic:n,map:o,view:c}),queryUpdatedFeature:Object(v.p)({graphic:n,popupTemplate:a,layer:i,spatialReference:s},e)});r===t._featureAbortController&&n&&(t._set("formattedAttributes",t._createFormattedAttributes(l,h)),t._set("title",t._compileTitle(d)),t._set("lastEditInfo",t._compileLastEditInfo()||null),t._set("content",t._compileContent(l)||null))}}))()}_createFormattedAttributes(e,t){var{_effectivePopupTemplate:r,graphic:n,relatedInfos:a,_sourceLayer:s,_fieldInfoMap:o}=this,c=null==r?void 0:r.fieldInfos,l=Object(i.a)(Object(i.a)({},n.attributes),t),u={global:Object(v.d)({fieldInfos:c,graphic:n,attributes:l,layer:s,fieldInfoMap:o,relatedInfos:a}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(u.content[t]=Object(v.d)({fieldInfos:e.fieldInfos,graphic:n,attributes:l,layer:s,fieldInfoMap:o,relatedInfos:a}))})),u}_checkForRelatedFeatures(e){var{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,Object(v.g)(r),e)}_queryRelatedInfos(e,t,r){var i=this;return Object(n.a)((function*(){var{relatedInfos:n,_sourceLayer:a}=i;n.clear();var o=Object(s.k)(a.associatedLayer)?yield a.associatedLayer.load(r):a;if(o){var c=t.filter((e=>e&&Object(v.o)(e.fieldName)));if(c&&c.length){t.forEach((e=>i._configureRelatedInfo(e,o)));var l=yield Object(j.c)({relatedInfos:n,layer:o},r);Object.keys(l).forEach((e=>{var t,r=n.get(e.toString()),i=null==(t=l[e])?void 0:t.value;r&&i&&(r.layerInfo=i.data)}));var u=yield Object(j.d)({graphic:e,relatedInfos:n,layer:o},r);Object.keys(u).forEach((e=>{var t;Object(j.e)(null==(t=u[e])?void 0:t.value,n.get(e.toString()))}))}}}))()}_configureRelatedInfo(e,t){var{relatedInfos:r}=this,i=Object(j.b)(e.fieldName);if(i){var{layerId:n,fieldName:a}=i;if(n){var s=r.get(n.toString())||Object(j.a)(n,t);s&&(Object(j.f)({relatedInfo:s,fieldName:a,fieldInfo:e}),this.relatedInfos.set(n,s))}}}};Object(a.a)([Object(c.b)()],z.prototype,"_featureAbortController",void 0),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"_effectivePopupTemplate",null),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"_fieldInfoMap",null),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"_sourceLayer",null),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"content",void 0),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"contentViewModels",void 0),Object(a.a)([Object(c.b)({type:Boolean})],z.prototype,"defaultPopupTemplateEnabled",void 0),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"formattedAttributes",void 0),Object(a.a)([Object(c.b)({type:p.a,value:null})],z.prototype,"graphic",null),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"lastEditInfo",void 0),Object(a.a)([Object(c.b)()],z.prototype,"relatedInfos",void 0),Object(a.a)([Object(c.b)()],z.prototype,"spatialReference",null),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"title",void 0),Object(a.a)([Object(c.b)()],z.prototype,"map",null),Object(a.a)([Object(c.b)({readOnly:!0})],z.prototype,"waitingForContent",null),Object(a.a)([Object(c.b)()],z.prototype,"view",void 0);var V=z=Object(a.a)([Object(l.a)(D)],z);t.a=V},,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return o}));r(80);var i=r(295),n=(r(92),r(89)),a=r(100),s=(r(123),r(327));function o(e){return"declaredClass"in e}function c(e){return"declaredClass"in e}function l(e){return Object(n.j)(e)?null:o(e)?e:Object(a.a)(function(e){var t=e.spatialReference.toJSON();switch(e.type){case"point":var{x:r,y:i,z:n,m:a}=e;return{x:r,y:i,z:n,m:a,spatialReference:t};case"polygon":var{rings:s,hasZ:o,hasM:c}=e;return{rings:u(s),hasZ:o,hasM:c,spatialReference:t};case"polyline":var{paths:l,hasZ:p,hasM:f}=e;return{paths:u(l),hasZ:p,hasM:f,spatialReference:t};case"extent":var{xmin:b,xmax:m,ymin:v,ymax:g,zmin:y,zmax:O,mmin:j,mmax:_,hasZ:w,hasM:x}=e;return{xmin:b,xmax:m,ymin:v,ymax:g,zmin:y,zmax:O,mmin:j,mmax:_,hasZ:w,hasM:x,spatialReference:t};case"multipoint":var{points:S,hasZ:M,hasM:T}=e;return{points:h(S)?d(S):S,hasZ:M,hasM:T,spatialReference:t};default:return}}(e))}function u(e){return function(e){for(var t of e)if(0!==t.length)return h(t);return!1}(e)?e.map((e=>d(e))):e}function d(e){return e.map((e=>Object(i.n)(e)))}function h(e){return e.length&&(Object(i.d)(e[0])||Object(i.e)(e[0]))}function p(e,t){if(!e)return null;var r;if(c(e)){if(null==t)return e.clone();if(c(t))return t.copy(e)}return null!=t?((r=t).x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=null,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=null,r.hasM=!1)):(r=Object(s.d)(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r}},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var i=r(89);function n(e){return e&&"function"==typeof e.highlight}function a(e,t,r){return Object(i.j)(e)||e>r&&(0===t||e<t)}},function(e,t,r){"use strict";r.r(t),r.d(t,"hydratedAdapter",(function(){return c}));var i=r(113),n=r(103),a=r(225),s=r(130),o=r(141),c={convertToGEGeometry:function(e,t){if(null==t)return null;var r="cache"in t?t.cache._geVersion:void 0;return null==r&&(r=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=r)),r},exportPoint:function(e,t,r){var n=e.hasZ(t),a=e.hasM(t),s=new i.a({x:e.getPointX(t),y:e.getPointY(t),spatialReference:r});return n&&(s.z=e.getPointZ(t)),a&&(s.m=e.getPointM(t)),s.cache._geVersion=t,s},exportPolygon:function(e,t,r){var i=new s.a({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:r});return i.cache._geVersion=t,i},exportPolyline:function(e,t,r){var i=new o.a({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:r});return i.cache._geVersion=t,i},exportMultipoint:function(e,t,r){var i=new a.a({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:r});return i.cache._geVersion=t,i},exportExtent:function(e,t,r){var i=e.hasZ(t),a=e.hasM(t),s=new n.a({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:r});if(i){var o=e.getZExtent(t);s.zmin=o.vmin,s.zmax=o.vmax}if(a){var c=e.getMExtent(t);s.mmin=c.vmin,s.mmax=c.vmax}return s.cache._geVersion=t,s}}},function(e,t,r){"use strict";t.a=class{constructor(e,t){this._context=e,this._desc=t,this._context.instanceCounter.increment(5,this);var r=this._context.gl;this.glName=r.createRenderbuffer(),this._context.bindRenderbuffer(this),r.renderbufferStorage(r.RENDERBUFFER,t.internalFormat,t.width,t.height)}get descriptor(){return this._desc}resize(e,t){var r=this._desc;if(r.width!==e||r.height!==t){r.width=e,r.height=t;var i=this._context.gl;this._context.bindRenderbuffer(this),i.renderbufferStorage(i.RENDERBUFFER,r.internalFormat,r.width,r.height)}}dispose(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(5,this),this._context=null)}}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return c})),r.d(t,"i",(function(){return l}));var i=r(143),n=r(248),a=r(110),s=r(117);function o(e,t,r,i=2,a="abbr"){return"".concat(Object(n.b)(t,{minimumFractionDigits:i,maximumFractionDigits:i})," ").concat(function(e,t,r){return e.units[t][r]}(e,r,a))}function c(e,t,r,i=2,n="abbr"){var a=Object(s.v)(t,r);return o(e,Object(s.c)(t,r,a),a,i,n)}function l(e,t,r,i=2,n="abbr"){var a=Object(s.w)(t,r);return o(e,Object(s.c)(t,r,a),a,i,n)}function u(e,t,r,i=2,n="abbr"){var a=Object(s.s)(t,r);return o(e,Object(s.c)(t,r,a),a,i,n)}function d(e,t,r,i=2,n="abbr"){var a=Object(s.t)(t,r);return o(e,Object(s.c)(t,r,a),a,i,n)}function h(e,t,r,i=2,n="abbr"){var a=Object(s.u)(t,r);return o(e,Object(s.c)(t,r,a),a,i,n)}function p(e,t,r,i=2,n="abbr"){var a=Object(s.r)(t,r);return o(e,Object(s.c)(t,r,a),a,i,n)}function f(e,t,r=2){var i=Object(s.c)(e,t,"degrees"),n=i-Math.floor(i);i-=n;var a=(n*=60)-Math.floor(n);return n-=a,a*=60,"".concat(i.toFixed(),"\xb0 ").concat(n.toFixed(),"' ").concat(a.toFixed(r),'"')}var b=["B","kB","MB","GB","TB"];function m(e,t){var r=0===t?0:Math.floor(Math.log(t)/Math.log(1024));r=Object(a.d)(r,0,b.length-1);var s=Object(n.b)(t/Math.pow(1024,r),{maximumFractionDigits:2});return Object(i.c)(e.units.bytes[b[r]],{fileSize:s})}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return s})),r.d(t,"h",(function(){return a}));var i={func:513},n={func:519},a={mask:255},s={mask:0},o={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},c={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},l={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},u={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i,n,a=r(120),s=r(119),o=r(417);function c(e,t){e.fragment.include(o.a),3===t.output?(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["\n      float _calculateFragDepth(const in float depth) {\n        // calc polygon offset\n        const float SLOPE_SCALE = 2.0;\n        const float BIAS = 2.0 * .000015259;    // 1 / (2^16 - 1)\n        float m = max(abs(dFdx(depth)), abs(dFdy(depth)));\n        float result = depth + SLOPE_SCALE * m + BIAS;\n        return clamp(result, .0, .999999);\n      }\n\n      void outputDepth(float _linearDepth) {\n        gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));\n      }\n    "]))))):1===t.output&&e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n      void outputDepth(float _linearDepth) {\n        gl_FragColor = float2rgba(_linearDepth);\n      }\n    "]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return c}));var i=r(434),n=r(179);function a(e,t,r,i){var n=r.typedBuffer,a=r.typedBufferStride,s=e.length;i*=a;for(var o=0;o<s;++o){var c=2*e[o];n[i]=t[c],n[i+1]=t[c+1],i+=a}}function s(e,t,r,i,n){var a=r.typedBuffer,s=r.typedBufferStride,o=e.length;if(i*=s,null==n||1===n)for(var c=0;c<o;++c){var l=3*e[c];a[i]=t[l],a[i+1]=t[l+1],a[i+2]=t[l+2],i+=s}else for(var u=0;u<o;++u)for(var d=3*e[u],h=0;h<n;++h)a[i]=t[d],a[i+1]=t[d+1],a[i+2]=t[d+2],i+=s}function o(e,t,r,i,n=1){var a=r.typedBuffer,s=r.typedBufferStride,o=e.length;if(i*=s,1===n)for(var c=0;c<o;++c){var l=4*e[c];a[i]=t[l],a[i+1]=t[l+1],a[i+2]=t[l+2],a[i+3]=t[l+3],i+=s}else for(var u=0;u<o;++u)for(var d=4*e[u],h=0;h<n;++h)a[i]=t[d],a[i+1]=t[d+1],a[i+2]=t[d+2],a[i+3]=t[d+3],i+=s}function c(e,t,r,i,n,a=1){if(r){var o=i.typedBuffer,c=i.typedBufferStride,l=e.length,u=r[0],d=r[1],h=r[2],p=r[4],f=r[5],b=r[6],m=r[8],v=r[9],g=r[10],y=r[12],O=r[13],j=r[14];if(n*=c,1===a)for(var _=0;_<l;++_){var w=3*e[_],x=t[w],S=t[w+1],M=t[w+2];o[n]=u*x+p*S+m*M+y,o[n+1]=d*x+f*S+v*M+O,o[n+2]=h*x+b*S+g*M+j,n+=c}else for(var T=0;T<l;++T)for(var E=3*e[T],P=t[E],C=t[E+1],I=t[E+2],A=u*P+p*C+m*I+y,R=d*P+f*C+v*I+O,F=h*P+b*C+g*I+j,L=0;L<a;++L)o[n]=A,o[n+1]=R,o[n+2]=F,n+=c}else s(e,t,i,n,a)}function l(e,t,r,i,n,a){if(r){var o=r,c=i.typedBuffer,l=i.typedBufferStride,u=e.length,d=o[0],h=o[1],p=o[2],f=o[4],b=o[5],m=o[6],v=o[8],g=o[9],y=o[10],O=Math.abs(1-d*d+f*f+v*v)>1e-5||Math.abs(1-h*h+b*b+g*g)>1e-5||Math.abs(1-p*p+m*m+y*y)>1e-5,j=1e-6,_=1-j;if(n*=l,1===a)for(var w=0;w<u;++w){var x=3*e[w],S=t[x],M=t[x+1],T=t[x+2],E=d*S+f*M+v*T,P=h*S+b*M+g*T,C=p*S+m*M+y*T;if(O){var I=E*E+P*P+C*C;if(I<_&&I>j){var A=Math.sqrt(I);E/=A,P/=A,C/=A}}c[n+0]=E,c[n+1]=P,c[n+2]=C,n+=l}else for(var R=0;R<u;++R){var F=3*e[R],L=t[F],D=t[F+1],k=t[F+2],z=d*L+f*D+v*k,V=h*L+b*D+g*k,N=p*L+m*D+y*k;if(O){var U=z*z+V*V+N*N;if(U<_&&U>j){var B=Math.sqrt(U);z/=B,V/=B,N/=B}}for(var q=0;q<a;++q)c[n+0]=z,c[n+1]=V,c[n+2]=N,n+=l}}else s(e,t,i,n,a)}function u(e,t,r,i,n,a=1){var s=i.typedBuffer,o=i.typedBufferStride,c=e.length;if(n*=o,1===a){if(4===r)for(var l=0;l<c;++l){var u=4*e[l];s[n]=t[u],s[n+1]=t[u+1],s[n+2]=t[u+2],s[n+3]=t[u+3],n+=o}else if(3===r)for(var d=0;d<c;++d){var h=3*e[d];s[n]=t[h],s[n+1]=t[h+1],s[n+2]=t[h+2],s[n+3]=255,n+=o}}else if(4===r)for(var p=0;p<c;++p)for(var f=4*e[p],b=0;b<a;++b)s[n]=t[f],s[n+1]=t[f+1],s[n+2]=t[f+2],s[n+3]=t[f+3],n+=o;else if(3===r)for(var m=0;m<c;++m)for(var v=3*e[m],g=0;g<a;++g)s[n]=t[v],s[n+1]=t[v+1],s[n+2]=t[v+2],s[n+3]=255,n+=o}function d(e,t,r,s,d,h){for(var p of t.fieldNames){var f=e.vertexAttributes.get(p),b=e.indices.get(p);if(f&&b)switch(p){case"position":Object(n.a)(3===f.size);var m=d.getField(p,i.u);m&&c(b,f.data,r,m,h);break;case"normal":Object(n.a)(3===f.size);var v=d.getField(p,i.u);v&&l(b,f.data,s,v,h,1);break;case"uv0":Object(n.a)(2===f.size);var g=d.getField(p,i.m);g&&a(b,f.data,g,h);break;case"color":Object(n.a)(3===f.size||4===f.size);var y=d.getField(p,i.J);y&&u(b,f.data,f.size,y,h);break;case"symbolColor":Object(n.a)(3===f.size||4===f.size);var O=d.getField(p,i.J);O&&u(b,f.data,f.size,O,h);break;case"tangent":Object(n.a)(4===f.size);var j=d.getField(p,i.C);j&&o(b,f.data,j,h)}}}},,,,,,,,,,,function(e,t,r){"use strict";r.r(t),r.d(t,"buffer",(function(){return T})),r.d(t,"clip",(function(){return o})),r.d(t,"contains",(function(){return l})),r.d(t,"convexHull",(function(){return j})),r.d(t,"crosses",(function(){return u})),r.d(t,"cut",(function(){return c})),r.d(t,"densify",(function(){return k})),r.d(t,"difference",(function(){return _})),r.d(t,"disjoint",(function(){return m})),r.d(t,"distance",(function(){return d})),r.d(t,"equals",(function(){return h})),r.d(t,"extendedSpatialReferenceInfo",(function(){return s})),r.d(t,"flipHorizontal",(function(){return F})),r.d(t,"flipVertical",(function(){return L})),r.d(t,"generalize",(function(){return D})),r.d(t,"geodesicArea",(function(){return U})),r.d(t,"geodesicBuffer",(function(){return E})),r.d(t,"geodesicDensify",(function(){return z})),r.d(t,"geodesicLength",(function(){return B})),r.d(t,"intersect",(function(){return x})),r.d(t,"intersects",(function(){return p})),r.d(t,"isSimple",(function(){return y})),r.d(t,"nearestCoordinate",(function(){return P})),r.d(t,"nearestVertex",(function(){return C})),r.d(t,"nearestVertices",(function(){return I})),r.d(t,"offset",(function(){return M})),r.d(t,"overlaps",(function(){return v})),r.d(t,"planarArea",(function(){return V})),r.d(t,"planarLength",(function(){return N})),r.d(t,"relate",(function(){return g})),r.d(t,"rotate",(function(){return R})),r.d(t,"simplify",(function(){return O})),r.d(t,"symmetricDifference",(function(){return w})),r.d(t,"touches",(function(){return f})),r.d(t,"union",(function(){return S})),r.d(t,"within",(function(){return b}));var i=r(503),n=r(485);function a(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function s(e){return i.a.extendedSpatialReferenceInfo(e)}function o(e,t){return i.a.clip(n.hydratedAdapter,a(e),e,t)}function c(e,t){return i.a.cut(n.hydratedAdapter,a(e),e,t)}function l(e,t){return i.a.contains(n.hydratedAdapter,a(e),e,t)}function u(e,t){return i.a.crosses(n.hydratedAdapter,a(e),e,t)}function d(e,t,r){return i.a.distance(n.hydratedAdapter,a(e),e,t,r)}function h(e,t){return i.a.equals(n.hydratedAdapter,a(e),e,t)}function p(e,t){return i.a.intersects(n.hydratedAdapter,a(e),e,t)}function f(e,t){return i.a.touches(n.hydratedAdapter,a(e),e,t)}function b(e,t){return i.a.within(n.hydratedAdapter,a(e),e,t)}function m(e,t){return i.a.disjoint(n.hydratedAdapter,a(e),e,t)}function v(e,t){return i.a.overlaps(n.hydratedAdapter,a(e),e,t)}function g(e,t,r){return i.a.relate(n.hydratedAdapter,a(e),e,t,r)}function y(e){return i.a.isSimple(n.hydratedAdapter,a(e),e)}function O(e){return i.a.simplify(n.hydratedAdapter,a(e),e)}function j(e,t=!1){return i.a.convexHull(n.hydratedAdapter,a(e),e,t)}function _(e,t){return i.a.difference(n.hydratedAdapter,a(e),e,t)}function w(e,t){return i.a.symmetricDifference(n.hydratedAdapter,a(e),e,t)}function x(e,t){return i.a.intersect(n.hydratedAdapter,a(e),e,t)}function S(e,t=null){return i.a.union(n.hydratedAdapter,a(e),e,t)}function M(e,t,r,s,o,c){return i.a.offset(n.hydratedAdapter,a(e),e,t,r,s,o,c)}function T(e,t,r,s=!1){return i.a.buffer(n.hydratedAdapter,a(e),e,t,r,s)}function E(e,t,r,s,o,c){return i.a.geodesicBuffer(n.hydratedAdapter,a(e),e,t,r,s,o,c)}function P(e,t,r=!0){return i.a.nearestCoordinate(n.hydratedAdapter,a(e),e,t,r)}function C(e,t){return i.a.nearestVertex(n.hydratedAdapter,a(e),e,t)}function I(e,t,r,s){return i.a.nearestVertices(n.hydratedAdapter,a(e),e,t,r,s)}function A(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent.center:null}function R(e,t,r){var n;if(null==e)throw new Error("Illegal Argument Exception");var a=e.spatialReference;if(null==(r=null!=(n=r)?n:A(e)))throw new Error("Illegal Argument Exception");var s=e.constructor.fromJSON(i.a.rotate(e,t,r));return s.spatialReference=a,s}function F(e,t){var r;if(null==e)throw new Error("Illegal Argument Exception");var n=e.spatialReference;if(null==(t=null!=(r=t)?r:A(e)))throw new Error("Illegal Argument Exception");var a=e.constructor.fromJSON(i.a.flipHorizontal(e,t));return a.spatialReference=n,a}function L(e,t){var r;if(null==e)throw new Error("Illegal Argument Exception");var n=e.spatialReference;if(null==(t=null!=(r=t)?r:A(e)))throw new Error("Illegal Argument Exception");var a=e.constructor.fromJSON(i.a.flipVertical(e,t));return a.spatialReference=n,a}function D(e,t,r,s){return i.a.generalize(n.hydratedAdapter,a(e),e,t,r,s)}function k(e,t,r){return i.a.densify(n.hydratedAdapter,a(e),e,t,r)}function z(e,t,r,s=0){return i.a.geodesicDensify(n.hydratedAdapter,a(e),e,t,r,s)}function V(e,t){return i.a.planarArea(n.hydratedAdapter,a(e),e,t)}function N(e,t){return i.a.planarLength(n.hydratedAdapter,a(e),e,t)}function U(e,t,r){return i.a.geodesicArea(n.hydratedAdapter,a(e),e,t,r)}function B(e,t,r){return i.a.geodesicLength(n.hydratedAdapter,a(e),e,t,r)}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return v}));var i=r(104),n=r(111),a=r(299),s=r(135),o=r(177),c=r(424);function l(e){return e?{p0:Object(i.d)(e.p0),p1:Object(i.d)(e.p1),p2:Object(i.d)(e.p2)}:{p0:Object(i.e)(),p1:Object(i.e)(),p2:Object(i.e)()}}function u(e,t,r,i=l()){return Object(n.j)(i.p0,e),Object(n.j)(i.p1,t),Object(n.j)(i.p2,r),i}function d(e,t,r){var i=Object(s.i)(e,t),n=Object(s.i)(t,r),a=Object(s.i)(r,e),o=(i+n+a)/2,c=o*(o-i)*(o-n)*(o-a);return c<=0?0:Math.sqrt(c)}function h(e,t,r){return Object(n.i)(b,t,e),Object(n.i)(m,r,e),Object(n.o)(Object(n.f)(b,b,m))/2}var p=new a.a(c.a),f=new a.a((()=>({p0:null,p1:null,p2:null}))),b=Object(i.e)(),m=Object(i.e)(),v=Object.freeze({__proto__:null,create:l,wrap:function(e,t,r){var i=f.get();return i.p0=e,i.p1=t,i.p2=r,i},copy:function(e,t=l()){return u(e.p0,e.p1,e.p2,t)},fromValues:u,distance2:function(e,t){var r=e.p0,i=e.p1,a=e.p2,s=Object(n.i)(o.d.get(),i,r),l=Object(n.i)(o.d.get(),a,i),u=Object(n.i)(o.d.get(),r,a),d=Object(n.i)(o.d.get(),t,r),h=Object(n.i)(o.d.get(),t,i),f=Object(n.i)(o.d.get(),t,a),b=Object(n.f)(s,s,u),m=Object(n.g)(Object(n.f)(o.d.get(),s,b),d),v=Object(n.g)(Object(n.f)(o.d.get(),l,b),h),g=Object(n.g)(Object(n.f)(o.d.get(),u,b),f);if(m>0&&v>0&&g>0){var y=Object(n.g)(b,d);return y*y/Object(n.g)(b,b)}var O=Object(c.b)(Object(c.c)(r,s,p.get()),t),j=Object(c.b)(Object(c.c)(i,l,p.get()),t),_=Object(c.b)(Object(c.c)(a,u,p.get()),t);return Math.min(O,j,_)},intersectRay:function(e,t,r){var i=1e-5,{direction:a,origin:s}=t,{p0:o,p1:c,p2:l}=e,u=c[0]-o[0],d=c[1]-o[1],h=c[2]-o[2],p=l[0]-o[0],f=l[1]-o[1],b=l[2]-o[2],m=a[1]*b-f*a[2],v=a[2]*p-b*a[0],g=a[0]*f-p*a[1],y=u*m+d*v+h*g;if(y>-i&&y<i)return!1;var O=1/y,j=s[0]-o[0],_=s[1]-o[1],w=s[2]-o[2],x=O*(j*m+_*v+w*g);if(x<0||x>1)return!1;var S=_*h-d*w,M=w*u-h*j,T=j*d-u*_,E=O*(a[0]*S+a[1]*M+a[2]*T);return!(E<0||x+E>1)&&(r&&(Object(n.d)(r,a,O*(p*S+f*M+b*T)),Object(n.e)(r,s,r)),!0)},areaPoints2d:d,area2d:function(e){return d(e.p0,e.p1,e.p2)},areaPoints3d:h})},function(e,t,r){"use strict";r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return y}));var i,n,a,s,o,c,l,u,d,h,p=r(120),f=r(110),b=r(119),m=r(254),v=r(581),g=r(525),y=Object(f.f)(6);function O(e){var t=new m.a;return t.extensions.add("GL_OES_standard_derivatives"),t.include(v.a),t.include(g.a,e),t.fragment.uniforms.add("angleCutoff","vec2"),t.fragment.uniforms.add("globalAlpha","float"),e.heightManifoldEnabled&&t.fragment.uniforms.add("heightPlane","vec4"),e.pointDistanceEnabled&&t.fragment.uniforms.add("pointDistanceSphere","vec4"),e.lineVerticalPlaneEnabled&&t.fragment.uniforms.add("lineVerticalPlane","vec4").add("lineVerticalStart","vec3").add("lineVerticalEnd","vec3"),(e.heightManifoldEnabled||e.pointDistanceEnabled||e.lineVerticalPlaneEnabled)&&t.fragment.uniforms.add("maxPixelDistance","float"),e.intersectsLineEnabled&&t.fragment.uniforms.add("intersectsLineStart","vec3").add("intersectsLineEnd","vec3").add("intersectsLineDirection","vec3").add("intersectsLineRadius","float").add("perScreenPixelRatio","float"),(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)&&t.fragment.code.add(Object(b.a)(i||(i=Object(p.a)(["\n      float planeDistancePixels(vec4 plane, vec3 pos) {\n        float dist = dot(plane.xyz, pos) + plane.w;\n        float width = fwidth(dist);\n        dist /= min(width, maxPixelDistance);\n        return abs(dist);\n      }"])))),e.pointDistanceEnabled&&t.fragment.code.add(Object(b.a)(n||(n=Object(p.a)(["\n    float sphereDistancePixels(vec4 sphere, vec3 pos) {\n      float dist = distance(sphere.xyz, pos) - sphere.w;\n      float width = fwidth(dist);\n      dist /= min(width, maxPixelDistance);\n      return abs(dist);\n    }\n    "])))),e.intersectsLineEnabled&&t.fragment.code.add(Object(b.a)(a||(a=Object(p.a)(["\n    float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {\n      float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);\n      return abs(dist) - radius;\n    }\n    "])))),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&t.fragment.code.add(Object(b.a)(s||(s=Object(p.a)(["\n    bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {\n      vec3 dir = end - start;\n      float t2 = dot(dir, pos - start);\n      float l2 = dot(dir, dir);\n      return t2 >= 0.0 && t2 <= l2;\n    }\n    "])))),t.fragment.code.add(Object(b.a)(o||(o=Object(p.a)(["\n  void main() {\n    vec3 pos;\n    vec3 normal;\n    float depthDiscontinuityAlpha;\n\n    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\n      discard;\n    }\n\n    vec4 color = vec4(0, 0, 0, 0);\n  "])))),e.heightManifoldEnabled&&t.fragment.code.add(Object(b.a)(c||(c=Object(p.a)(["\n    {\n      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));\n      vec4 heightManifoldColor = laserlineProfile(planeDistancePixels(heightPlane, pos));\n      color = max(color, heightManifoldColor * heightManifoldAlpha);\n    }\n    "])))),e.pointDistanceEnabled&&t.fragment.code.add(Object(b.a)(l||(l=Object(p.a)(["\n    {\n      // distance to sphere\n      float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);\n      vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);\n      float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));\n\n      color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);\n    }\n    "])))),e.lineVerticalPlaneEnabled&&t.fragment.code.add(Object(b.a)(u||(u=Object(p.a)(["\n    {\n      if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {\n        float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);\n\n        vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);\n        float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));\n\n        color = max(color, lineVerticalColor * lineVerticalAlpha);\n      }\n    }\n    "])))),e.intersectsLineEnabled&&t.fragment.code.add(Object(b.a)(d||(d=Object(p.a)(["\n    {\n      if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {\n        float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);\n        vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);\n        float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));\n\n        color = max(color, intersectsLineColor * intersectsLineAlpha);\n      }\n    }\n    "])))),t.fragment.code.add(Object(b.a)(h||(h=Object(p.a)(["\n    gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);\n  }\n  "])))),t}var j=Object.freeze({__proto__:null,defaultAngleCutoff:y,build:O})},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return N}));var i=r(89),n=r(176),a=r(131),s=r(104),o=r(115),c=r(348),l=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"],u=r(221),d=r(111),h=r(255),p=r(179);class f{constructor(){this.bounds=h.g.create(),this.halfSize=0,this.initFrom(null,null,0,0)}init(e){return this.initFrom(e.node,e.bounds,e.halfSize,e.depth)}initFrom(e,t,r,n=this.depth){return this.node=Object(i.k)(e)?e:f.createEmptyNode(),Object(i.k)(t)&&h.g.copy(t,this.bounds),this.halfSize=r,this.depth=n,this}advance(e){var t=this.node.children[e];t||(t=f.createEmptyNode(),this.node.children[e]=t),this.node=t,this.halfSize/=2,this.depth++;var r=w[e];return this.bounds[0]+=r[0]*this.halfSize,this.bounds[1]+=r[1]*this.halfSize,this.bounds[2]+=r[2]*this.halfSize,this.bounds[3]=this.halfSize*S,this}advanceTo(e,t,r=!1){for(;;){if(this.isTerminalFor(e))return t&&t(this,-1),!0;if(this.isLeaf()){if(!r)return t&&t(this,-1),!1;this.node.residents=null}var i=this._childIndex(e);t&&t(this,i),this.advance(i)}}isLeaf(){return null!=this.node.residents}isTerminalFor(e){return e[3]>this.halfSize/2}_childIndex(e){var t=this.bounds;return(t[0]<e[0]?1:0)+(t[1]<e[1]?2:0)+(t[2]<e[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new n.a({shrink:!0}),residents:new n.a({shrink:!0})}}static acquire(){return f._pool.acquire()}static release(e){f._pool.release(e)}static clearPool(){f._pool.prune()}}function b(e,t){e[0]=Math.min(e[0],t[0]-t[3]),e[1]=Math.min(e[1],t[1]-t[3]),e[2]=Math.min(e[2],t[2]-t[3])}function m(e,t){e[0]=Math.max(e[0],t[0]+t[3]),e[1]=Math.max(e[1],t[1]+t[3]),e[2]=Math.max(e[2],t[2]+t[3])}function v(e,t,r){r[0]=e[0]+t,r[1]=e[1]+t,r[2]=e[2]+t}function g(e,t){return!h.c.intersectsSphere(t,e)}function y(e,t,r,i){if(1===t){var n=r(e[0]);h.g.copy(n,i)}else{P[0]=1/0,P[1]=1/0,P[2]=1/0,C[0]=-1/0,C[1]=-1/0,C[2]=-1/0;for(var a=0;a<t;a++){var s=r(e[a]);_(s[3])&&(b(P,s),m(C,s))}Object(d.h)(i,P,C,.5),i[3]=Math.max(C[0]-P[0],C[1]-P[1],C[2]-P[2])/2}}function O(e,t){for(var r=1/0,i=null,n=0;n<8;++n){var a=j(e,t,x[n]);a<r&&(r=a,i=x[n])}return i}function j(e,t,r){return t*(e[0]*r[0]+e[1]*r[1]+e[2]*r[2])}function _(e){return!isNaN(e)&&e!==-1/0&&e!==1/0&&e>0}f._pool=new u.a(f);var w=[Object(s.g)(-1,-1,-1),Object(s.g)(1,-1,-1),Object(s.g)(-1,1,-1),Object(s.g)(1,1,-1),Object(s.g)(-1,-1,1),Object(s.g)(1,-1,1),Object(s.g)(-1,1,1),Object(s.g)(1,1,1)],x=[Object(s.g)(-1,-1,-1),Object(s.g)(-1,-1,1),Object(s.g)(-1,1,-1),Object(s.g)(-1,1,1),Object(s.g)(1,-1,-1),Object(s.g)(1,-1,1),Object(s.g)(1,1,-1),Object(s.g)(1,1,1)],S=Math.sqrt(3),M=[null];var T=h.g.create(),E=Object(s.e)(),P=Object(s.e)(),C=Object(s.e)(),I=new n.a,A=h.g.create(),R=h.g.create(),F=h.g.create(),L=h.g.create(),D=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],k=new n.a,z=[0,0,0,0,0,0,0,0],V=class{constructor(e,t){this._objectToBoundingSphere=e,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new f,this._objectCount=0,t&&(void 0!==t.maximumObjectsPerNode&&(this._maximumObjectsPerNode=t.maximumObjectsPerNode),void 0!==t.maximumDepth&&(this._maximumDepth=t.maximumDepth))}get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}destroy(){this._degenerateObjects.clear(),f.clearPool(),M[0]=null,I.prune(),k.prune()}add(e,t=e.length){this._objectCount+=t,this._grow(e,t);for(var r=f.acquire(),i=0;i<t;i++){var n=e[i];this._isDegenerate(n)?this._degenerateObjects.add(n):(r.init(this._root),this._add(n,r))}f.release(r)}remove(e,t=null){this._objectCount-=e.length;var r=f.acquire();for(var n of e){var a=Object(i.k)(t)?t:h.g.copy(this._objectToBoundingSphere(n),A);_(a[3])?(r.init(this._root),this._remove(n,a,r)):this._degenerateObjects.delete(n)}f.release(r),this._shrink()}update(e,t){if(_(t[3])||!this._isDegenerate(e)){var r=function(e){return M[0]=e,M}(e);this.remove(r,t),this.add(r)}}forEachAlongRay(e,t,r){var i=h.f.wrap(e,t);this._forEachNode(this._root,(e=>{if(!this._intersectsNode(i,e))return!1;var t=e.node;return t.terminals.forAll((e=>{this._intersectsObject(i,e)&&r(e)})),null!==t.residents&&t.residents.forAll((e=>{this._intersectsObject(i,e)&&r(e)})),!0}))}forEachAlongRayWithVerticalOffset(e,t,r,i){var n=h.f.wrap(e,t);this._forEachNode(this._root,(e=>{if(!this._intersectsNodeWithOffset(n,e,i))return!1;var t=e.node;return t.terminals.forAll((e=>{this._intersectsObjectWithOffset(n,e,i)&&r(e)})),null!==t.residents&&t.residents.forAll((e=>{this._intersectsObjectWithOffset(n,e,i)&&r(e)})),!0}))}forEach(e){this._forEachNode(this._root,(t=>{var r=t.node;return r.terminals.forAll(e),null!==r.residents&&r.residents.forAll(e),!0})),this._degenerateObjects.forEach(e)}forEachDegenerateObject(e){this._degenerateObjects.forEach(e)}findClosest(e,t,r,i,n){return this._findClosest(e,"front-to-back"===t?1:-1,r,i,n)}forEachInDepthRange(e,t,r,i,n,a,s,o){this._forEachInDepthRange(e,t,"front-to-back"===r?1:-1,i,n,a,s,o)}forEachNode(e){this._forEachNode(this._root,(t=>e(t.node,t.bounds,t.halfSize)))}_intersectsNode(e,t){return v(t.bounds,2*-t.halfSize,P),v(t.bounds,2*t.halfSize,C),Object(p.i)(e.origin,e.direction,P,C)}_intersectsNodeWithOffset(e,t,r){return v(t.bounds,2*-t.halfSize,P),v(t.bounds,2*t.halfSize,C),r.applyToMinMax(P,C),Object(p.i)(e.origin,e.direction,P,C)}_intersectsObject(e,t){var r=this._objectToBoundingSphere(t);return!(r[3]>0)||h.g.intersectsRay(r,e)}_intersectsObjectWithOffset(e,t,r){var i=this._objectToBoundingSphere(t);return!(i[3]>0)||h.g.intersectsRay(r.applyToBoundingSphere(i),e)}_forEachNode(e,t){for(var r=f.acquire().init(e),i=[r];0!==i.length;){if(t(r=i.pop())&&!r.isLeaf())for(var n=0;n<r.node.children.length;n++)r.node.children[n]&&i.push(f.acquire().init(r).advance(n));f.release(r)}}_forEachNodeDepthOrdered(e,t,r,i=1){var n=f.acquire().init(e),a=[n];for(function(e,t,r){if(!k.length)for(var i=0;i<8;++i)k.push({index:0,distance:0});for(var n=0;n<8;++n){var a=w[n];k.data[n].index=n,k.data[n].distance=j(e,t,a)}k.sort(((e,t)=>e.distance-t.distance));for(var s=0;s<8;++s)r[s]=k.data[s].index}(r,i,z);0!==a.length;){if(t(n=a.pop())&&!n.isLeaf())for(var s=7;s>=0;--s){var o=z[s];o>=n.node.children.length||n.node.children[o]&&a.push(f.acquire().init(n).advance(o))}f.release(n)}}_findClosest(e,t,r,i,n){var a=1/0,s=1/0,o=null,c=O(e,t),l=0,u=n=>{if(++l,!i||i(n)){var c=this._objectToBoundingSphere(n);if(!r||!g(c,r)){var u=j(e,t,h.g.getCenter(c)),d=u-c[3],p=u+c[3];d<a&&(a=d,s=p,o=n)}}};return this._forEachNodeDepthOrdered(this._root,(i=>{if(null!=n&&l>=n)return!1;if(r&&g(i.bounds,r))return!1;if(Object(d.d)(E,c,i.halfSize),Object(d.e)(E,E,i.bounds),j(e,t,E)>s)return!1;var a=i.node;return a.terminals.forAll((e=>{u(e)})),null!==a.residents&&a.residents.forAll((e=>{u(e)})),!0}),e,t),o}_forEachInDepthRange(e,t,r,i,n,a,s,o){var c=-1/0,l=1/0,u={setRange:e=>{1===r?(c=Math.max(c,e.near),l=Math.min(l,e.far)):(c=Math.max(c,-e.far),l=Math.min(l,-e.near))}};u.setRange(i);var p=j(t,r,e),f=O(t,r),b=O(t,-1*r),m=0,v=e=>{if(++m,!s||s(e)){var i=this._objectToBoundingSphere(e),o=h.g.getCenter(i),d=j(t,r,o)-p,f=d-i[3],b=d+i[3];f>l||b<c||a&&g(i,a)||n(e,u)}};this._forEachNodeDepthOrdered(this._root,(e=>{if(null!=o&&m>=o)return!1;if(a&&g(e.bounds,a))return!1;if(Object(d.d)(E,f,e.halfSize),Object(d.e)(E,E,e.bounds),j(t,r,E)-p>l)return!1;if(Object(d.d)(E,b,e.halfSize),Object(d.e)(E,E,e.bounds),j(t,r,E)-p<c)return!1;var i=e.node;return i.terminals.forAll((e=>{v(e)})),null!==i.residents&&i.residents.forAll((e=>{v(e)})),!0}),t,r)}_remove(e,t,r){I.clear();var i=r.advanceTo(t,((e,t)=>{I.push(e.node),I.push(t)}))?r.node.terminals:r.node.residents;if(i.removeUnordered(e),0===i.length)for(var n=I.length-2;n>=0;n-=2){var a=I.data[n],s=I.data[n+1];if(!this._purge(a,s))break}}_nodeIsEmpty(e){if(0!==e.terminals.length)return!1;if(null!==e.residents)return 0===e.residents.length;for(var t=0;t<e.children.length;t++)if(e.children[t])return!1;return!0}_purge(e,t){return t>=0&&(e.children[t]=null),!!this._nodeIsEmpty(e)&&(null===e.residents&&(e.residents=new n.a({shrink:!0})),!0)}_add(e,t){t.advanceTo(this._objectToBoundingSphere(e))?t.node.terminals.push(e):(t.node.residents.push(e),t.node.residents.length>this._maximumObjectsPerNode&&t.depth<this._maximumDepth&&this._split(t))}_split(e){var t=e.node.residents;e.node.residents=null;for(var r=0;r<t.length;r++){var i=f.acquire().init(e);this._add(t.getItemAt(r),i),f.release(i)}}_grow(e,t){if(0!==t&&(y(e,t,(e=>this._objectToBoundingSphere(e)),R),_(R[3])&&!this._fitsInsideTree(R)))if(this._nodeIsEmpty(this._root.node))h.g.copy(R,this._root.bounds),this._root.halfSize=1.25*R[3];else{var r=this._rootBoundsForRootAsSubNode(R);this._placingRootViolatesMaxDepth(r)?this._rebuildTree(R,r):this._growRootAsSubNode(r),f.release(r)}}_rebuildTree(e,t){Object(d.j)(F,t.bounds),F[3]=t.halfSize,y([e,F],2,(e=>e),L);var r=f.acquire().init(this._root);this._root.initFrom(null,L,1.25*L[3]),this._forEachNode(r,(e=>(this.add(e.node.terminals.data,e.node.terminals.length),null!==e.node.residents&&this.add(e.node.residents.data,e.node.residents.length),!0))),f.release(r)}_placingRootViolatesMaxDepth(e){var t=Math.log(e.halfSize/this._root.halfSize)*Math.LOG2E,r=0;return this._forEachNode(this._root,(e=>(r=Math.max(r,e.depth))+t<=this._maximumDepth)),r+t>this._maximumDepth}_rootBoundsForRootAsSubNode(e){for(var t=e[3],r=e,i=-1/0,n=this._root.bounds,a=this._root.halfSize,s=0;s<3;s++){var o=n[s]-a-(r[s]-t),c=r[s]+t-(n[s]+a),l=Math.max(0,Math.ceil(o/(2*a))),u=Math.max(0,Math.ceil(c/(2*a)))+1,d=Math.pow(2,Math.ceil(Math.log(l+u)*Math.LOG2E));i=Math.max(i,d),D[s].min=l,D[s].max=u}for(var h=0;h<3;h++){var p=D[h].min,b=D[h].max,m=(i-(p+b))/2;p+=Math.ceil(m),b+=Math.floor(m);var v=n[h]-a-p*a*2;T[h]=v+(b+p)*a}return T[3]=i*a*S,f.acquire().initFrom(null,T,i*a,0)}_growRootAsSubNode(e){var t=this._root.node;Object(d.j)(R,this._root.bounds),R[3]=this._root.halfSize,this._root.init(e),e.advanceTo(R,null,!0),e.node.children=t.children,e.node.residents=t.residents,e.node.terminals=t.terminals}_shrink(){for(;;){var e=this._findShrinkIndex();if(-1===e)break;this._root.advance(e),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;for(var e=null,t=this._root.node.children,r=0,i=0;i<t.length&&null==e;)e=t[r=i++];for(;i<t.length;)if(t[i++])return-1;return r}_isDegenerate(e){return!_(this._objectToBoundingSphere(e)[3])}_fitsInsideTree(e){var t=this._root.bounds,r=this._root.halfSize;return e[3]<=r&&e[0]>=t[0]-r&&e[0]<=t[0]+r&&e[1]>=t[1]-r&&e[1]<=t[1]+r&&e[2]>=t[2]-r&&e[2]<=t[2]+r}};class N extends c.a{constructor(e,t=""){super(),this.apiLayerUid=t,this.type=0,this.events=new a.a,this.isSliceable=!1,this._objects=new n.a,this._stageHandles=new o.a,this.apiLayerUid=t,e=e||{},this.group=e.group||"",this.isVisible=null==e.isVisible||e.isVisible,this.isPickable=null==e.isPickable||e.isPickable,this.translation=e.translation?Object(s.d)(e.translation):Object(s.e)()}destroy(){this.detachStage(),this._stage=null}attachStage(e){var t=this;this.detachStage(),this._stage=e;var r=function(r){t._stageHandles.add(t.events.on(r,(t=>e.handleEvent(r,t))))};for(var i of l)r(i)}detachStage(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}getObjectIds(){return this._objects.map((e=>e.id))}getObjects(){return this._objects}add(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),Object(i.k)(this._octree)&&this._octree.add([e])}remove(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),Object(i.k)(this._octree)&&this._octree.remove([e]))}addMany(e){for(var t of(this._objects.pushArray(e),e))t.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:e}),Object(i.k)(this._octree)&&this._octree.add(e)}removeMany(e){var t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),0!==t.length){for(var r of t)r.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),Object(i.k)(this._octree)&&this._octree.remove(t)}}commit(){Object(i.k)(this._stage)&&this._stage.processDirtyLayer(this.id)}notifyObjectBBChanged(e,t){Object(i.k)(this._octree)&&this._octree.update(e,t)}getSpatialQueryAccelerator(){return Object(i.j)(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}shaderTransformationChanged(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}invalidateSpatialQueryAccelerator(){this._octree=Object(i.e)(this._octree)}_createOctree(){this._octree=new V((e=>e.getBounds())),this._octree.add(this._objects.data,this._objects.length)}}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return h}));var i=r(91),n=r(7),a=(r(80),r(89)),s=r(152),o=r(414),c=null;function l(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function u(e,t,r){var{backgroundColor:i,outline:n,dotSize:a}=e,s=r&&r.swatchSize||22,o=Math.round(s*s/Math.pow(a,2)*.8),u=window.devicePixelRatio,d=document.createElement("canvas"),h=s*u;d.width=h,d.height=h,d.style.width=d.width/u+"px",d.style.height=d.height/u+"px";var p=d.getContext("2d");if(i&&(p.fillStyle=i.toCss(!0),p.fillRect(0,0,h,h),p.fill()),p.fillStyle=t.toCss(!0),c&&c.length/2===o)for(var f=0;f<2*o;f+=2){var b=c[f],m=c[f+1];p.fillRect(b,m,a*u,a*u),p.fill()}else{c=[];for(var v=0;v<2*o;v+=2){var g=l(0,h),y=l(0,h);c.push(g,y),p.fillRect(g,y,a*u,a*u),p.fill()}}n&&(n.color&&(p.strokeStyle=n.color.toCss(!0)),p.lineWidth=n.width,p.strokeRect(0,0,h,h));var O=new Image(s,s);return O.src=d.toDataURL(),O}function d(e,t={}){var r="horizontal"===t.align,i=r?75:24,n=r?24:75,{width:a=i,height:s=n,gradient:o=!0}=t,c=window.devicePixelRatio,l=a*c,u=s*c,d=document.createElement("canvas");d.width=l,d.height=u,d.style.width="".concat(a,"px"),d.style.height="".concat(s,"px");var h=d.getContext("2d"),p=r?l:0,f=r?0:u;if(o){var b=h.createLinearGradient(0,0,p,f),m=1/(e.length-1);e.forEach(((e,t)=>b.addColorStop(t*m,e.toString()))),h.fillStyle=b,h.fillRect(0,0,l,u)}else{var v=r?l/e.length:l,g=r?u:u/e.length,y=0,O=0;for(var j of e)h.fillStyle=j.toString(),h.fillRect(y,O,v,g),y=r?y+v:0,O=r?0:O+g}var _=document.createElement("div");return _.style.width="".concat(a,"px"),_.style.height="".concat(s,"px"),_.appendChild(d),_}function h(e,t){return p.apply(this,arguments)}function p(){return(p=Object(n.a)((function*(e,t){switch(e.type){case"web-style":var{previewWebStyleSymbol:i}=yield r.e(281).then(r.bind(null,695));return i(e,h,t);case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":var{previewSymbol3D:n}=yield Promise.all([r.e(27),r.e(280)]).then(r.bind(null,614));return n(e,t);case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":var{previewSymbol2D:a}=yield Promise.all([r.e(27),r.e(279)]).then(r.bind(null,696));return a(e,t);case"cim":var{previewCIMSymbol:s}=yield Promise.all([r.e(17),r.e(133)]).then(r.bind(null,706));return s(e,t);default:return}}))).apply(this,arguments)}function f(e){return e&&"opacity"in e?e.opacity*f(e.parent):1}function b(e,t){return m.apply(this,arguments)}function m(){return(m=Object(n.a)((function*(e,t){if(e){var n=f(e.layer||e.sourceLayer);if(Object(a.k)(e.symbol)&&(!Object(a.k)(t)||!0!==t.ignoreGraphicSymbol)){var c="web-style"===e.symbol.type?yield e.symbol.fetchSymbol(Object(a.k)(t)?t.abortOptions:null):e.symbol.clone();return Object(o.a)(c,null,n),c}var l=Object(a.k)(t)&&t.renderer||e.get("layer.renderer")||e.get("sourceLayer.renderer"),u=yield l.getSymbolAsync(e,t);if(u){if(u="web-style"===u.type?yield u.fetchSymbol(Object(a.k)(t)?t.abortOptions:null):u.clone(),!("visualVariables"in l)||"visualVariables"in l&&!l.visualVariables||"visualVariables"in l&&l.visualVariables&&!l.visualVariables.length)return u;if(l.arcadeRequiredForVisualVariables&&(Object(a.j)(t)||Object(a.j)(t.arcade))){var d=Object(i.a)({},Object(a.q)(t));d.arcade=yield Object(s.e)(),t=d}var h=yield Promise.resolve().then(r.bind(null,277)),p=[],b=[],m=[],v=[];for(var g of l.visualVariables)switch(g.type){case"color":p.push(g);break;case"opacity":b.push(g);break;case"rotation":v.push(g);break;case"size":g.target||m.push(g)}var y=!!p.length&&p[p.length-1],O=y?h.getColor(y,e,t):null,j=!!b.length&&b[b.length-1],_=j?h.getOpacity(j,e,t):null;if(null!=n&&(_=null!=_?_*n:n),Object(o.a)(u,O,_),m.length){var w=h.getAllSizes(m,e,t);yield Object(o.d)(u,w)}for(var x of v)Object(o.c)(u,h.getRotationAngle(x,e,t),x.axis);return u}}}))).apply(this,arguments)}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));class i{constructor(e){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e,this.view.watch("ready",(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProps(e){var t=!1;for(var r in e)r in this?"attached"===r?t=e[r]:this[r]=e[r]:console.error("Cannot set unknown property",r);this.attached=t}destroy(){this.attached=!1}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i,n,a,s=r(120),o=r(119);function c(e,t){t.attributeColor?(e.attributes.add("color","vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(Object(o.a)(i||(i=Object(s.a)(["\n      void forwardVertexColor() { vColor = color; }\n    "])))),e.vertex.code.add(Object(o.a)(n||(n=Object(s.a)(["\n      void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }\n    "]))))):e.vertex.code.add(Object(o.a)(a||(a=Object(s.a)(["\n      void forwardVertexColor() {}\n      void forwardNormalizedVertexColor() {}\n    "]))))}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var i=r(306),n=r(325),a=r(205),s=r(326),o=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],c=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];function l(e,t=o,r=i.a,a=-1,l=1){var u=null;switch(t){case c:u=new Float32Array([a,a,0,0,l,a,1,0,a,l,0,1,l,l,1,1]);break;case o:default:u=new Float32Array([a,a,l,a,a,l,l,l])}return new s.a(e,r,{geometry:t},{geometry:n.a.createVertex(e,35044,u)})}function u(e){return new a.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var i,n,a,s,o,c,l,u=r(120),d=r(119),h=r(308);function p(e){e.fragment.uniforms.add("projInfo","vec4"),e.fragment.uniforms.add("zScale","vec2"),e.fragment.code.add(Object(d.a)(i||(i=Object(u.a)(["\n    vec3 reconstructPosition(vec2 fragCoord, float depth) {\n      return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);\n    }\n  "]))))}function f(e,t){e.extensions.add("GL_OES_standard_derivatives"),e.fragment.include(h.a),e.include(p),e.fragment.uniforms.add("glowColor","vec3"),e.fragment.uniforms.add("glowWidth","float"),e.fragment.uniforms.add("glowFalloff","float"),e.fragment.uniforms.add("innerColor","vec3"),e.fragment.uniforms.add("innerWidth","float"),e.fragment.uniforms.add("depthMap","sampler2D"),e.fragment.uniforms.add("nearFar","vec2"),e.fragment.uniforms.add("frameColor","sampler2D"),t.contrastControlEnabled&&e.fragment.uniforms.add("globalAlphaContrastBoost","float"),e.fragment.code.add(Object(d.a)(n||(n=Object(u.a)(["\n  vec4 blendPremultiplied(vec4 source, vec4 dest) {\n    float oneMinusSourceAlpha = 1.0 - source.a;\n\n    return vec4(\n      source.rgb + dest.rgb * oneMinusSourceAlpha,\n      source.a + dest.a * oneMinusSourceAlpha\n    );\n  }\n  "])))),e.fragment.code.add(Object(d.a)(a||(a=Object(u.a)(["\n  vec4 premultipliedColor(vec3 rgb, float alpha) {\n    return vec4(rgb * alpha, alpha);\n  }\n  "])))),e.fragment.code.add(Object(d.a)(s||(s=Object(u.a)(["\n  vec4 laserlineProfile(float dist) {\n    if (dist > glowWidth) {\n      return vec4(0.0);\n    }\n\n    float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));\n    float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);\n\n    return blendPremultiplied(\n      premultipliedColor(innerColor, innerAlpha),\n      premultipliedColor(glowColor, glowAlpha)\n    );\n  }\n  "])))),e.fragment.code.add(Object(d.a)(o||(o=Object(u.a)(["\n  bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {\n    float depth = linearDepthFromTexture(depthMap, uv, nearFar);\n\n    if (-depth == nearFar[0]) {\n      return false;\n    }\n\n    pos = reconstructPosition(gl_FragCoord.xy, depth);\n    normal = normalize(cross(dFdx(pos), dFdy(pos)));\n\n    float ddepth = fwidth(depth);\n    depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);\n\n    return true;\n  }\n  "])))),t.contrastControlEnabled?e.fragment.code.add(Object(d.a)(c||(c=Object(u.a)(["\n    float rgbToLuminance(vec3 color) {\n      return dot(vec3(0.2126, 0.7152, 0.0722), color);\n    }\n\n    vec4 laserlineOutput(vec4 color) {\n      float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);\n      float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);\n\n      return color * alpha;\n    }\n    "])))):e.fragment.code.add(Object(d.a)(l||(l=Object(u.a)(["\n    vec4 laserlineOutput(vec4 color) {\n      return color * globalAlpha;\n    }\n    "]))))}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return o}));var i=r(89),n=r(107),a=r(574);function s(e,t){var r=e.view;r&&(t&&r.ready&&r.activeTool!==e?(r.activeTool=e,Object(a.b)(r)&&r.focus()):t||r.activeTool!==e||(r.activeTool=null))}function o(e,t,r){var n=e.activeTool;t!==n&&(Object(i.k)(n)&&n.deactivate&&n.deactivate(),r(t),Object(i.k)(t)&&t.activate&&t.activate())}function c(){var e=new n.a;return e.on("after-add",(e=>{var t=e.item;t.view&&t.view.ready&&t.attach()})),e.on("after-remove",(e=>{var t=e.item;s(t,!1),t.destroyed||t.detach()})),e}function l(e){return!1!==e.visible&&!1!==e.editable&&(null==e.hasEditableFlag||e.hasEditableFlag(1))}function u(e){return Object(i.j)(e)?{}:"function"==typeof e?e():e}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var i=r(112),n=r(113),a=(r(101),r(104)),s=r(111),o=r(202),c=r(200),l=r(135),u=r(191),d=r(177);class h{constructor(e,t){this.spatialReference=e,this.viewingMode=t,this._unnormalizationInfo=v(e,t)}tag(e){return e}createNew(){return this.tag(Object(o.a)())}fromPoint(e){return this.tag(Object(o.e)(e.x,e.y))}fromArray(e){return this.tag(Object(o.e)(e[0],e[1]))}toArray(e){return[e[0],e[1]]}clone(e){return this.tag(Object(o.d)(e))}toPoint(e,t){return t.x=e[0],t.y=e[1],t.hasZ=!1,t.hasM=!1,t.spatialReference=this.spatialReference,t}createPoint(e){return new n.a({x:e[0],y:e[1],z:void 0,m:void 0,spatialReference:this.spatialReference})}createPointFromArray(e){return new n.a({x:e[0],y:e[1],z:void 0,m:void 0,spatialReference:this.spatialReference})}createDehydratedPoint(e){return{x:e[0],y:e[1],z:void 0,m:void 0,hasZ:!1,hasM:!1,spatialReference:this.spatialReference,type:"point"}}lerp(e,t,r,i){return Object(l.m)(i,e,t,r)}addDelta(e,t,r){e[0]+=t,e[1]+=r}scale(e,t,r,i){var n=d.c.get(),a=Object(l.d)(n,e,t),s=Object(l.a)(n,r,Object(l.g)(r,a));Object(l.o)(e,e,s,i-1)}rotate(e,t,r){Object(l.q)(e,e,t,r)}pointToArray(e){return[e.x,e.y]}getZ(e,t){return t}hasZ(){return!1}unnormalize(e){m(e,this._unnormalizationInfo)}fromXYZ(e){return this.tag(Object(o.e)(e[0],e[1]))}toXYZ(e,t=0){return Object(a.g)(e[0],e[1],t)}}class p{constructor(e,t,r){this.valueType=e,this.spatialReference=t,this._unnormalizationInfo=v(t,r)}tag(e){return e}createNew(){return this.tag(Object(a.e)())}fromPoint(e){return this.tag(Object(a.g)(e.x,e.y,0===this.valueType?e.z:e.m))}fromArray(e){return this.tag(Object(a.g)(e[0],e[1],e[2]||0))}toArray(e){return[e[0],e[1],e[2]]}clone(e){return this.tag(Object(a.f)(e))}toPoint(e,t){return t.x=e[0],t.y=e[1],0===this.valueType?(t.z=e[2],t.hasZ=!0,t.hasM=!1):(t.m=e[2],t.hasZ=!1,t.hasM=!0),t.spatialReference=this.spatialReference,t}createPoint(e){return new n.a({x:e[0],y:e[1],z:0===this.valueType?e[2]:void 0,m:1===this.valueType?e[2]:void 0,spatialReference:this.spatialReference})}createPointFromArray(e){return new n.a({x:e[0],y:e[1],z:0===this.valueType?e[2]:void 0,m:1===this.valueType?e[2]:void 0,spatialReference:this.spatialReference})}createDehydratedPoint(e){var t=0===this.valueType,r=1===this.valueType;return{x:e[0],y:e[1],z:t?e[2]:void 0,m:r?e[2]:void 0,hasZ:t,hasM:r,spatialReference:this.spatialReference,type:"point"}}lerp(e,t,r,i){return Object(s.h)(i,e,t,r)}addDelta(e,t,r,i){e[0]+=t,e[1]+=r,0===this.valueType&&(e[2]+=i)}scale(e,t,r,i){var n=d.c.get(),a=Object(l.d)(n,e,t),s=Object(l.a)(n,r,Object(l.g)(r,a));Object(l.o)(e,e,s,i-1)}rotate(e,t,r){Object(l.q)(e,e,t,r)}pointToArray(e){return 0===this.valueType?[e.x,e.y,e.z]:[e.x,e.y,e.m]}getZ(e,t){return 0===this.valueType?e[2]:t}hasZ(){return 0===this.valueType}unnormalize(e){m(e,this._unnormalizationInfo)}fromXYZ(e,t=0,r=0){return this.tag(Object(a.g)(e[0],e[1],0===this.valueType?e.length>2?e[2]:t:r))}toXYZ(e,t=0){return this.tag(Object(a.g)(e[0],e[1],0===this.valueType?e[2]:t))}}class f{constructor(e,t){this.spatialReference=e,this._unnormalizationInfo=v(e,t)}tag(e){return e}createNew(){return this.tag(Object(c.c)())}fromPoint(e){return this.tag(Object(c.d)(e.x,e.y,e.z,e.m))}fromArray(e){return this.tag(Object(c.d)(e[0],e[1],e[2]||0,e[3]||0))}toArray(e){return[e[0],e[1],e[2],e[3]]}clone(e){return this.tag(Object(c.g)(e))}toPoint(e,t){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.hasZ=!0,t.hasM=!0,t.spatialReference=this.spatialReference,t}createPoint(e){return new n.a({x:e[0],y:e[1],z:e[2],m:e[3],spatialReference:this.spatialReference})}createPointFromArray(e){return new n.a({x:e[0],y:e[1],z:e[2],m:e[3],spatialReference:this.spatialReference})}createDehydratedPoint(e){return{x:e[0],y:e[1],z:e[2],m:e[3],hasZ:!0,hasM:!0,spatialReference:this.spatialReference,type:"point"}}lerp(e,t,r,i){return Object(u.j)(i,e,t,r)}addDelta(e,t,r,i){e[0]+=t,e[1]+=r,e[2]+=i}scale(e,t,r,i){var n=d.c.get(),a=Object(l.d)(n,e,t),s=Object(l.a)(n,r,Object(l.g)(r,a));Object(l.o)(e,e,s,i-1)}rotate(e,t,r){Object(l.q)(e,e,t,r)}pointToArray(e){return[e.x,e.y,e.z,e.m]}getZ(e){return e[2]}hasZ(){return!0}unnormalize(e){m(e,this._unnormalizationInfo)}fromXYZ(e,t=0,r=0){return this.tag(Object(c.d)(e[0],e[1],e.length>2?e[2]:t,r))}toXYZ(e){return Object(a.g)(e[0],e[1],e[2])}}function b(e,t,r,i){return e&&t?new f(r,i):t?new p(1,r,i):e?new p(0,r,i):new h(r,i)}function m(e,t){if(t.supported){var r=1/0,i=-1/0,n=t.upperBoundX-t.lowerBoundX;e.forEach((e=>{for(var a=e.pos[0];a<t.lowerBoundX;)a+=n;for(;a>t.upperBoundX;)a-=n;r=Math.min(r,a),i=Math.max(i,a),e.pos[0]=a}));var a=i-r;n-a<a&&e.forEach((e=>{e.pos[0]<0&&(e.pos[0]+=n)}))}}function v(e,t){var r=Object(i.d)(e);return"global"===t&&r?{supported:!0,lowerBoundX:r.valid[0],upperBoundX:r.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r(82),n=(r(80),r(81),r(88),r(85)),a=r(84),s=(r(83),r(86),r(87),r(94)),o=r(97),c=r(528),l=r(631),u=class extends o.a{constructor(e){super(e),this.attached=!1,this.created=!1,this.completed=!1,this.manipulators=new l.a,this.deferCreation=!1,this._editableFlags=new Array,this._creationResolver=Object(s.g)()}get active(){return null!=this.view&&this.view.activeTool===this}get isSupported(){return!0}set visible(e){this._set("visible",e),e||Object(c.d)(this,!1),this.attached&&(e?this._show():this._hide())}get editable(){return this.hasEditableFlag(0)}set editable(e){this.setEditableFlag(0,e)}attach(){!this.attached&&this.isSupported&&(this.manipulators.attach(),this.onAttach(),this.visible&&this.onShow(),this._set("attached",!0))}detach(){this.attached&&(this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1))}handleInputEvent(e){this.attached&&this.onInputEvent(e)}handleInputEventAfter(e){this.attached&&this.onInputEventAfter(e)}destroy(){this.manipulators.destroy(),this._set("view",null),this._set("created",!1),this._set("completed",!1)}setEditableFlag(e,t){this._editableFlags[e]=t,this.manipulators.isToolEditable=this._editableFlags.every((e=>null==e||e)),this._updateManipulatorAttachment(),0===e&&this.notifyChange("editable"),this.onEditableChange()}hasEditableFlag(e){var t=this._editableFlags[e];return null==t||t}when(){return this._creationResolver.promise}rejectCreation(e){this._creationResolver.reject(e)}initialize(){this.deferCreation||this.complete()}onAttach(){}onDetach(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)}create(){this.created||(this._set("created",!0),this._creationResolver.resolve(this))}complete(){this.create(),this._set("completed",!0)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()}};Object(i.a)([Object(n.b)({constructOnly:!0})],u.prototype,"view",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],u.prototype,"active",null),Object(i.a)([Object(n.b)({value:!0})],u.prototype,"visible",null),Object(i.a)([Object(n.b)({value:!0})],u.prototype,"editable",null),Object(i.a)([Object(n.b)({readOnly:!0})],u.prototype,"attached",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],u.prototype,"created",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],u.prototype,"completed",void 0),Object(i.a)([Object(n.b)({readOnly:!0})],u.prototype,"manipulators",void 0),Object(i.a)([Object(n.b)({constructOnly:!0})],u.prototype,"deferCreation",void 0),u=Object(i.a)([Object(a.a)("esri.views.interactive.InteractiveToolBase")],u)},function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return C}));var i=r(104),n=r(184),a=r(111),s=r(332),o=r(396),c=r(191);function l(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function u(e,t){var r=2*Math.acos(t[3]),i=Math.sin(r/2);return i>n.a?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),r}function d(e,t,r){var i=t[0],n=t[1],a=t[2],s=t[3],o=r[0],c=r[1],l=r[2],u=r[3];return e[0]=i*u+s*o+n*l-a*c,e[1]=n*u+s*c+a*o-i*l,e[2]=a*u+s*l+i*c-n*o,e[3]=s*u-i*o-n*c-a*l,e}function h(e,t,r,i){var a,s,o,c,l,u=t[0],d=t[1],h=t[2],p=t[3],f=r[0],b=r[1],m=r[2],v=r[3];return(s=u*f+d*b+h*m+p*v)<0&&(s=-s,f=-f,b=-b,m=-m,v=-v),1-s>n.a?(a=Math.acos(s),o=Math.sin(a),c=Math.sin((1-i)*a)/o,l=Math.sin(i*a)/o):(c=1-i,l=i),e[0]=c*u+l*f,e[1]=c*d+l*b,e[2]=c*h+l*m,e[3]=c*p+l*v,e}function p(e,t){var r=t[0],i=t[1],n=t[2],a=t[3],s=r*r+i*i+n*n+a*a,o=s?1/s:0;return e[0]=-r*o,e[1]=-i*o,e[2]=-n*o,e[3]=a*o,e}function f(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function b(e,t){var r,i=t[0]+t[4]+t[8];if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var a=(n+1)%3,s=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*a+a]-t[3*s+s]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*a+s]-t[3*s+a])*r,e[a]=(t[3*a+n]+t[3*n+a])*r,e[s]=(t[3*s+n]+t[3*n+s])*r}return e}var m=c.c,v=c.l,g=c.a,y=d,O=c.b,j=c.d,_=c.j,w=c.e,x=w,S=c.f,M=S,T=c.k,E=c.g,P=c.h;function C(e,t,r){var i=Object(a.g)(t,r);return i<-.999999?(Object(a.f)(I,A,t),Object(a.m)(I)<1e-6&&Object(a.f)(I,R,t),Object(a.q)(I,I),l(e,I,Math.PI),e):i>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Object(a.f)(I,t,r),e[0]=I[0],e[1]=I[1],e[2]=I[2],e[3]=1+i,T(e,e))}var I=Object(i.e)(),A=Object(i.g)(1,0,0),R=Object(i.g)(0,1,0);var F=Object(o.a)(),L=Object(o.a)();var D=Object(s.a)();Object.freeze({__proto__:null,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:l,getAxisAngle:u,multiply:d,rotateX:function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c+s*o,e[1]=n*c+a*o,e[2]=a*c-n*o,e[3]=s*c-i*o,e},rotateY:function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c-a*o,e[1]=n*c+s*o,e[2]=a*c+i*o,e[3]=s*c-n*o,e},rotateZ:function(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],s=t[3],o=Math.sin(r),c=Math.cos(r);return e[0]=i*c+n*o,e[1]=n*c-i*o,e[2]=a*c+s*o,e[3]=s*c-a*o,e},calculateW:function(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e},slerp:h,random:function(e){var t=Object(n.b)(),r=Object(n.b)(),i=Object(n.b)(),a=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=a*Math.sin(2*Math.PI*r),e[1]=a*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*i),e[3]=s*Math.cos(2*Math.PI*i),e},invert:p,conjugate:f,fromMat3:b,fromEuler:function(e,t,r,i){var n=.5*Math.PI/180;t*=n,r*=n,i*=n;var a=Math.sin(t),s=Math.cos(t),o=Math.sin(r),c=Math.cos(r),l=Math.sin(i),u=Math.cos(i);return e[0]=a*c*u-s*o*l,e[1]=s*o*u+a*c*l,e[2]=s*c*l-a*o*u,e[3]=s*c*u+a*o*l,e},str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},copy:m,set:v,add:g,mul:y,scale:O,dot:j,lerp:_,length:w,len:x,squaredLength:S,sqrLen:M,normalize:T,exactEquals:E,equals:P,rotationTo:C,sqlerp:function(e,t,r,i,n,a){return h(F,t,n,a),h(L,r,i,a),h(e,F,L,2*a*(1-a)),e},setAxes:function(e,t,r,i){var n=D;return n[0]=r[0],n[3]=r[1],n[6]=r[2],n[1]=i[0],n[4]=i[1],n[7]=i[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],T(e,b(e,n))}})},,,function(e,t,r){"use strict";function i(e,t,r){var i,a,o,c,l,u=t&&t.length,d=u?t[0]*r:e.length,p=n(e,0,d,r,!0),f=new Array;if(!p||p.next===p.prev)return f;if(u&&(p=h(e,t,p,r)),e.length>80*r){i=o=e[0],a=c=e[1];for(var b=r;b<d;b+=r){var m=e[b],v=e[b+1];i=Math.min(i,m),a=Math.min(a,v),o=Math.max(o,m),c=Math.max(c,v)}l=0!==(l=Math.max(o-i,c-a))?1/l:0}return s(p,f,r,i,a,l),f}function n(e,t,r,i,n){var a;if(n===g(e,t,r,i)>0)for(var s=t;s<r;s+=i)a=l(s,e[s],e[s+1],a);else for(var o=r-i;o>=t;o-=i)a=l(o,e[o],e[o+1],a);return a&&_(a,a.next)&&(u(a),a=a.next),a}function a(e,t=e){if(!e)return e;var r,i=e;do{if(r=!1,i.steiner||!_(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(u(i),(i=t=i.prev)===i.next)break;r=!0}}while(r||i!==t);return t}function s(e,t,r,i,n,l,d=0){if(e){!d&&l&&(e=f(e,i,n,l));for(var h=e;e.prev!==e.next;){var p=e.prev,b=e.next;if(l?c(e,i,n,l):o(e))t.push(p.index/r),t.push(e.index/r),t.push(b.index/r),u(e),e=b.next,h=b.next;else if((e=b)===h){d?1===d?s(e=x(e,t,r),t,r,i,n,l,2):2===d&&S(e,t,r,i,n,l):s(a(e),t,r,i,n,l,1);break}}}}function o(e){var t=e.prev,r=e,i=e.next;if(m(t,r,i)>=0)return!1;for(var n=e.next.next,a=n,s=0;n!==e.prev&&(0===s||n!==a);){if(s++,y(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&m(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function c(e,t,r,i){var n=e.prev,a=e,s=e.next;if(m(n,a,s)>=0)return!1;for(var o=n.x<a.x?n.x<s.x?n.x:s.x:a.x<s.x?a.x:s.x,c=n.y<a.y?n.y<s.y?n.y:s.y:a.y<s.y?a.y:s.y,l=n.x>a.x?n.x>s.x?n.x:s.x:a.x>s.x?a.x:s.x,u=n.y>a.y?n.y>s.y?n.y:s.y:a.y>s.y?a.y:s.y,d=j(o,c,t,r,i),h=j(l,u,t,r,i),p=e.prevZ,f=e.nextZ;p&&p.z>=d&&f&&f.z<=h;){if(p!==e.prev&&p!==e.next&&y(n.x,n.y,a.x,a.y,s.x,s.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&y(n.x,n.y,a.x,a.y,s.x,s.y,f.x,f.y)&&m(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&y(n.x,n.y,a.x,a.y,s.x,s.y,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=h;){if(f!==e.prev&&f!==e.next&&y(n.x,n.y,a.x,a.y,s.x,s.y,f.x,f.y)&&m(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function l(e,t,r,i){var n=new E(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function u(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function d(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function h(e,t,r,i){for(var s=new Array,o=0,c=t.length;o<c;o++){var l=n(e,t[o]*i,o<c-1?t[o+1]*i:e.length,i,!1);l===l.next&&(l.steiner=!0),s.push(d(l))}for(var u of(s.sort(w),s))p(u,r),r=a(r,r.next);return r}function p(e,t){if(t=function(e,t){var r,i=t,n=e.x,a=e.y,s=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var o=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(o<=n&&o>s){if(s=o,o===n){if(a===i.y)return i;if(a===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!r)return null;if(n===s)return r.prev;var c,l=r,u=r.x,d=r.y,h=1/0;for(i=r.next;i!==l;)n>=i.x&&i.x>=u&&n!==i.x&&y(a<d?n:s,a,u,d,a<d?s:n,a,i.x,i.y)&&(((c=Math.abs(a-i.y)/(n-i.x))<h||c===h&&i.x>r.x)&&O(i,e)&&(r=i,h=c)),i=i.next;return r}(e,t)){var r=T(t,e);a(r,r.next)}}function f(e,t,r,i){for(var n;n!==e;n=n.next){if(null===(n=n||e).z&&(n.z=j(n.x,n.y,t,r,i)),n.prev.next!==n||n.next.prev!==n)return n.prev.next=n,n.next.prev=n,f(e,t,r,i);n.prevZ=n.prev,n.nextZ=n.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var i=void 0,n=e;e=null,t=null;for(var a=0;n;){a++,i=n;for(var s=0;s<r&&i;s++)i=i.nextZ;for(var o=r;s>0||o>0&&i;){var c=void 0;0===s?(c=i,i=i.nextZ,o--):0!==o&&i?n.z<=i.z?(c=n,n=n.nextZ,s--):(c=i,i=i.nextZ,o--):(c=n,n=n.nextZ,s--),t?t.nextZ=c:e=c,c.prevZ=t,t=c}n=i}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function b(e,t,r,i){var n=t&&t.length,a=n?t[0]*r:e.length,s=Math.abs(g(e,0,a,r));if(n)for(var o=0,c=t.length;o<c;o++){var l=t[o]*r,u=o<c-1?t[o+1]*r:e.length;s-=Math.abs(g(e,l,u,r))}for(var d=0,h=0;h<i.length;h+=3){var p=i[h]*r,f=i[h+1]*r,b=i[h+2]*r;d+=Math.abs((e[p]-e[b])*(e[f+1]-e[p+1])-(e[p]-e[f])*(e[b+1]-e[p+1]))}return 0===s&&0===d?0:Math.abs((d-s)/s)}function m(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function v(e,t,r,i){return!!(_(e,t)&&_(r,i)||_(e,i)&&_(r,t))||m(e,t,r)>0!=m(e,t,i)>0&&m(r,i,e)>0!=m(r,i,t)>0}function g(e,t,r,i){for(var n=0,a=t,s=r-i;a<r;a+=i)n+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return n}function y(e,t,r,i,n,a,s,o){return(n-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(i-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(n-s)*(i-o)>=0}function O(e,t){return m(e.prev,e,e.next)<0?m(e,t,e.next)>=0&&m(e,e.prev,t)>=0:m(e,t,e.prev)<0||m(e,e.next,t)<0}function j(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _(e,t){return e.x===t.x&&e.y===t.y}function w(e,t){return e.x-t.x}function x(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;!_(n,a)&&v(n,i,i.next,a)&&O(n,a)&&O(a,n)&&(t.push(n.index/r),t.push(i.index/r),t.push(a.index/r),u(i),u(i.next),i=e=a),i=i.next}while(i!==e);return i}function S(e,t,r,i,n,o){var c=e;do{for(var l=c.next.next;l!==c.prev;){if(c.index!==l.index&&M(c,l)){var u=T(c,l);return c=a(c,c.next),u=a(u,u.next),s(c,t,r,i,n,o),void s(u,t,r,i,n,o)}l=l.next}c=c.next}while(c!==e)}function M(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&v(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&O(e,t)&&O(t,e)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)}function T(e,t){var r=new E(e.index,e.x,e.y),i=new E(t.index,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,a.next=i,i.prev=a,i}r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return i}));class E{constructor(e,t,r){this.index=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}}},,,,,function(e,t,r){"use strict";var i=r(91),n=r(82),a=(r(80),r(81),r(85)),s=r(145),o=r(116),c=r(84),l=(r(83),r(86),r(87),r(281)),u=(r(171),r(108)),d=r(114),h=r(163),p=r(129),f=r(154),b=(r(88),r(93)),m=r(488),v=r(437),g=r(162);var y={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},O="esri-attachments",j="esri-attachments__loader-container",_="esri-attachments__loader",w="esri-attachments__container",x="esri-attachments__container--list",S="esri-attachments__container--preview",M="esri-attachments__actions",T="esri-attachments__delete-button",E="esri-attachments__add-attachment-button",P="esri-attachments__error-message",C="esri-attachments__items",I="esri-attachments__item",A="esri-attachments__item-button",R="esri-attachments__item-mask",F="esri-attachments__item-mask--icon",L="esri-attachments__image",D="esri-attachments__image--resizable",k="esri-attachments__label",z="esri-attachments__filename",V="esri-attachments__item-chevron-icon",N="esri-attachments__item-link",U="esri-attachments__item-link-overlay",B="esri-attachments__item-link-overlay-icon",q="esri-attachments__item-add-icon",G="esri-attachments__form-node",H="esri-attachments__file-fieldset",W="esri-attachments__file-label",J="esri-attachments__file-name",Z="esri-attachments__file-input",X="esri-attachments__metadata",Y="esri-attachments__metadata-fieldset",Q="esri-attachments__progress-bar",K="esri-widget",$="esri-button",ee="esri-button--disabled",te="esri-button--secondary",re="esri-button--tertiary",ie="esri-button--third",ne="esri-button--small",ae="esri-button--half",se="esri-widget__content--empty",oe="esri-icon-right",ce="esri-icon-left",le="esri-icon-plus",ue=window.CSS,de=class extends f.a{constructor(e,t){super(e,t),this.abilities=null,this.displayType="list",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new v.a,this.visibleElements=Object(i.a)({},y),this._supportsImageOrientation=ue&&ue.supports&&ue.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.own(Object(u.b)(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),Object(u.a)(this,"viewModel.mode",(()=>this._modeChanged())))}castVisibleElements(e){return Object(i.a)(Object(i.a)({},y),e)}addAttachment(){var{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new b.a("attachments:add-attachment",this.messages.addErrorMessage,e)),e}))}deleteAttachment(e){var{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((e=>{throw this._set("submitting",!1),this._set("error",new b.a("attachments:delete-attachment",this.messages.deleteErrorMessage,e)),e}))}updateAttachment(){var{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((e=>{throw this._set("submitting",!1),this._set("error",new b.a("attachments:update-attachment",this.messages.updateErrorMessage,e)),e}))}render(){var{submitting:e,viewModel:t}=this,{state:r}=t;return Object(p.a)("div",{class:this.classes(O,K)},e?this.renderProgressBar():null,"loading"===r?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){var{error:e,visibleElements:t}=this;return e&&t.errorMessage?Object(p.a)("div",{key:"error-message",class:P},e.message):null}renderAttachments(){var{mode:e,activeAttachmentInfo:t}=this.viewModel;return"add"===e?this.renderAddForm():"edit"===e?this.renderDetailsForm(t):this.renderAttachmentContainer()}renderLoading(){return Object(p.a)("div",{class:j,key:"loader"},Object(p.a)("div",{class:_}))}renderProgressBar(){return this.visibleElements.progressBar?Object(p.a)("div",{class:Q,key:"progress-bar"}):null}renderAddForm(){var{submitting:e,selectedFile:t}=this,r=e||!t,i=this.visibleElements.cancelAddButton?Object(p.a)("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes($,re,ne,ae,e&&ee)},this.messages.cancel):null,n=this.visibleElements.addSubmitButton?Object(p.a)("button",{type:"submit",disabled:r,class:this.classes($,te,ne,ae,{[ee]:r})},this.messages.add):null,a=t?Object(p.a)("span",{key:"file-name",class:J},t.name):null,s=Object(p.a)("form",{bind:this,afterCreate:d.i,afterRemoved:d.c,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},Object(p.a)("fieldset",{class:H},a,Object(p.a)("label",{class:this.classes(W,$,te)},t?this.messages.changeFile:this.messages.selectFile,Object(p.a)("input",{class:Z,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),n,i);return Object(p.a)("div",{key:"add-form-container",class:G},s)}renderDetailsForm(e){var{visibleElements:t,viewModel:r,selectedFile:i,submitting:n}=this,{contentType:a,size:s,url:o}=e,{abilities:c}=r,l=n||!i,u=c.editing&&c.operations.delete&&t.deleteButton?Object(p.a)("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:t=>this._submitDeleteAttachment(t,e),class:this.classes($,ne,re,T,{[ee]:n})},this.messages.delete):null,h=c.editing&&c.operations.update&&t.updateButton?Object(p.a)("button",{disabled:l,key:"update-button",type:"submit",class:this.classes($,ne,ie,{[ee]:l})},this.messages.update):null,f=this.visibleElements.cancelUpdateButton?Object(p.a)("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes($,ne,re,ie,{[ee]:n})},this.messages.cancel):null,b=i?Object(p.a)("span",{key:"file-name",class:J},i.name):null,v=c.editing&&c.operations.update?Object(p.a)("fieldset",{key:"file",class:H},b,Object(p.a)("label",{class:this.classes(W,$,te)},this.messages.changeFile,Object(p.a)("input",{class:Z,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,g=Object(p.a)("fieldset",{key:"size",class:Y},Object(p.a)("label",null,Object(m.c)(this.messagesUnits,s))),y=Object(p.a)("fieldset",{key:"content-type",class:Y},Object(p.a)("label",null,a)),O=Object(p.a)("form",{bind:this,afterCreate:d.i,afterRemoved:d.c,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},Object(p.a)("div",{class:X},g,y),v,Object(p.a)("div",{class:M},u,f,h));return Object(p.a)("div",{key:"edit-form-container",class:G},Object(p.a)("a",{class:N,href:o,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:e,size:400}),Object(p.a)("div",{class:U},Object(p.a)("span",{class:B},Object(p.a)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},Object(p.a)("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),Object(p.a)("path",{fill:"none",d:"M0 0h32v32H0z"}))))),O)}renderImageMask({attachmentInfo:e,size:t}){var{supportsResizeAttachments:r}=this.viewModel,{contentType:i,name:n,url:a}=e,s=r&&function(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t}(i),o=this._getCSSTransform(e,s),c=o?{transform:o,"image-orientation":"none"}:{},l=-1===a.indexOf("?")?"?":"&",u=s?"".concat(a).concat(l,"w=").concat(t):function(e){var t=Object(g.a)("esri/themes/base/images/files/");return e?"text/plain"===e?"".concat(t,"text-32.svg"):"application/pdf"===e?"".concat(t,"pdf-32.svg"):"text/csv"===e?"".concat(t,"csv-32.svg"):"application/gpx+xml"===e?"".concat(t,"gpx-32.svg"):"application/x-dwf"===e?"".concat(t,"cad-32.svg"):"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"".concat(t,"code-32.svg"):"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"".concat(t,"zip-32.svg"):-1!==e.indexOf("image/")?"".concat(t,"image-32.svg"):-1!==e.indexOf("audio/")?"".concat(t,"sound-32.svg"):-1!==e.indexOf("video/")?"".concat(t,"video-32.svg"):-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?"".concat(t,"excel-32.svg"):-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?"".concat(t,"word-32.svg"):-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?"".concat(t,"report-32.svg"):"".concat(t,"generic-32.svg"):"".concat(t,"generic-32.svg")}(i),d={[F]:!s},h={[D]:r};return Object(p.a)("div",{class:this.classes(d,R)},Object(p.a)("img",{styles:c,alt:n,src:u,class:this.classes(h,L)}))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){var{viewModel:r}=this,{abilities:i}=r,{name:n,url:a}=e,s=this.renderImageMask({attachmentInfo:e,size:"list"===t?48:400}),o=i.editing?Object(p.a)("span",{"aria-hidden":"true",class:this.classes(V,Object(d.f)()?ce:oe)}):null,c=[s,Object(p.a)("label",{class:k},Object(p.a)("span",{class:z},n||this.messages.noTitle),o)],l=i.editing?Object(p.a)("button",{key:"details-button",bind:this,class:A,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},c):Object(p.a)("a",{key:"details-link",class:A,href:a,target:"_blank"},c);return Object(p.a)("li",{class:I,key:e},l)}renderAttachmentContainer(){var{displayType:e,viewModel:t,visibleElements:r}=this,{attachmentInfos:i,abilities:n}=t,a=i&&i.length,s={[x]:"preview"!==e,[S]:"preview"===e},o=n.editing&&n.operations.add&&r.addButton?Object(p.a)("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes($,re,E),type:"button"},Object(p.a)("span",{"aria-hidden":"true",class:this.classes(q,le)}),this.messages.add):null,c=a?Object(p.a)("ul",{class:C},i.toArray().map((t=>this.renderAttachmentInfo({attachmentInfo:t,displayType:e})))):Object(p.a)("div",{class:se},this.messages.noAttachments);return Object(p.a)("div",{key:"attachments-container",class:this.classes(w,s)},c,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){var t=e.target,r=t&&t.files&&t.files.item(0);this._set("selectedFile",r)}_submitDeleteAttachment(e,t){e.preventDefault(),this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.addAttachment()}_submitUpdateAttachment(e){e.preventDefault(),this.updateAttachment()}_startEditAttachment(e){var{viewModel:t}=this;t.activeAttachmentInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e,t){var{orientationInfo:r}=e;return!this._supportsImageOrientation&&t&&r?[r.rotation?"rotate(".concat(r.rotation,"deg)"):"",r.mirrored?"scaleX(-1)":""].join(" "):""}};Object(n.a)([Object(s.a)("viewModel.abilities")],de.prototype,"abilities",void 0),Object(n.a)([Object(a.b)()],de.prototype,"displayType",void 0),Object(n.a)([Object(s.a)("viewModel.graphic")],de.prototype,"graphic",void 0),Object(n.a)([Object(a.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],de.prototype,"label",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/widgets/Attachments/t9n/Attachments")],de.prototype,"messages",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/core/t9n/Units")],de.prototype,"messagesUnits",void 0),Object(n.a)([Object(a.b)({readOnly:!0})],de.prototype,"selectedFile",void 0),Object(n.a)([Object(a.b)({readOnly:!0})],de.prototype,"submitting",void 0),Object(n.a)([Object(a.b)({readOnly:!0})],de.prototype,"error",void 0),Object(n.a)([Object(a.b)({type:v.a})],de.prototype,"viewModel",void 0),Object(n.a)([Object(a.b)()],de.prototype,"visibleElements",void 0),Object(n.a)([Object(o.a)("visibleElements")],de.prototype,"castVisibleElements",null);var he=de=Object(n.a)([Object(c.a)("esri.widgets.Attachments")],de),pe=r(438),fe="esri-feature-element-info",be="esri-feature-element-info__title",me="esri-feature-element-info__description",ve=class extends f.a{constructor(e,t){super(e,t),this.description=null,this.title=null}render(){return Object(p.a)("div",{class:fe},this.renderTitle(),this.renderDescription())}renderTitle(){var{title:e}=this;return e?Object(p.a)("h2",{key:"title",class:be},e):null}renderDescription(){var{description:e}=this;return e?Object(p.a)("div",{key:"description",class:me},e):null}};Object(n.a)([Object(a.b)()],ve.prototype,"description",void 0),Object(n.a)([Object(a.b)()],ve.prototype,"title",void 0);var ge=ve=Object(n.a)([Object(c.a)("esri.widgets.Feature.support.FeatureElementInfo")],ve),ye="esri-feature-attachments",Oe=class extends f.a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new he,this.description=null,this.displayType=null,this.graphic=null,this.title=null,this.viewModel=new pe.a}initialize(){this._featureElementInfo=new ge,Object(u.a)(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())),Object(u.a)(this,"viewModel.graphic",(e=>this.attachmentsWidget.graphic=e))}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}render(){var e,{attachmentsWidget:t}=this;return Object(p.a)("div",{class:ye},null==(e=this._featureElementInfo)?void 0:e.render(),null==t?void 0:t.render())}_setupFeatureElementInfo(){var{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}};Object(n.a)([Object(a.b)({readOnly:!0})],Oe.prototype,"attachmentsWidget",void 0),Object(n.a)([Object(s.a)("viewModel.description")],Oe.prototype,"description",void 0),Object(n.a)([Object(s.a)("attachmentsWidget.displayType")],Oe.prototype,"displayType",void 0),Object(n.a)([Object(s.a)("viewModel.graphic")],Oe.prototype,"graphic",void 0),Object(n.a)([Object(s.a)("viewModel.title")],Oe.prototype,"title",void 0),Object(n.a)([Object(a.b)({type:pe.a})],Oe.prototype,"viewModel",void 0);var je=Oe=Object(n.a)([Object(c.a)("esri.widgets.Feature.FeatureAttachments")],Oe),_e=r(389),we=r(196),xe=r(439),Se="esri-feature-content",Me="esri-feature-content__loader-container",Te="esri-feature-content__loader",Ee=class extends f.a{constructor(e,t){super(e,t),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{Object(we.q)(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}renderLoading(){return Object(p.a)("div",{class:Me,key:"loader"},Object(p.a)("div",{class:Te}))}renderCreated(){var e,t=null==(e=this.viewModel)?void 0:e.created;return t?t instanceof HTMLElement?Object(p.a)("div",{key:t,bind:t,afterCreate:this._attachToNode}):Object(_e.b)(t)?Object(p.a)("div",{key:t},!t.destroyed&&t.render()):Object(p.a)("div",{key:t,innerHTML:t,afterCreate:this._addTargetToAnchors}):null}render(){var e,t=null==(e=this.viewModel)?void 0:e.state;return Object(p.a)("div",{class:Se},"loading"===t?this.renderLoading():this.renderCreated())}_attachToNode(e){e.appendChild(this)}};Object(n.a)([Object(s.a)("viewModel.creator")],Ee.prototype,"creator",void 0),Object(n.a)([Object(s.a)("viewModel.graphic")],Ee.prototype,"graphic",void 0),Object(n.a)([Object(a.b)({type:xe.a})],Ee.prototype,"viewModel",void 0);var Pe=Ee=Object(n.a)([Object(c.a)("esri.widgets.Feature.FeatureContent")],Ee),Ce=r(440),Ie=r(143),Ae=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function Re(e,t){if("string"!=typeof t||!t)return t;var r=function(e){var t=null;return Ae.some((r=>(r.pattern.test(e)&&(t=r),!!t))),t}(t);if(!r)return t;var i=t.match(r.pattern),n=i&&i[2],a=Object(Ie.c)(Object(Ie.c)(r.label,{messages:e,hierPart:n}),{appName:r.appName}),s=r.target?' target="'.concat(r.target,'"'):"",o="_blank"===r.target?' rel="noreferrer"':"";return t.replace(r.pattern,"<a".concat(s,' href="$1"').concat(o,">").concat(a,"</a>"))}var Fe="esri-feature-fields",Le="esri-feature-fields__field-header",De="esri-feature-fields__field-data",ke="esri-feature-fields__field-data--date",ze="esri-widget__table",Ve=class extends f.a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new Ce.a,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new ge,Object(u.a)(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()))}destroy(){this._featureElementInfo.destroy()}renderFieldInfo(e,t){var{attributes:r}=this.viewModel,i=e.fieldName,n=e.label||i,a=r?null==r[i]?"":r[i]:"",s=!(!e.format||!e.format.dateFormat),o="number"!=typeof a||s?Re(this.messagesURIUtils,a):this._forceLTR(a),c={[ke]:s};return Object(p.a)("tr",{key:"fields-element-info-row-".concat(i,"-").concat(t)},Object(p.a)("th",{key:"fields-element-info-row-header-".concat(i,"-").concat(t),class:Le,innerHTML:n}),Object(p.a)("td",{key:"fields-element-info-row-data-".concat(i,"-").concat(t),class:this.classes(De,c),innerHTML:o}))}renderFields(){var{formattedFieldInfos:e}=this.viewModel;return e.length?Object(p.a)("table",{class:ze,summary:this.messages.fieldsSummary},Object(p.a)("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){var e;return Object(p.a)("div",{class:Fe},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){var{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return"&lrm;".concat(e)}};Object(n.a)([Object(s.a)("viewModel.attributes")],Ve.prototype,"attributes",void 0),Object(n.a)([Object(s.a)("viewModel.description")],Ve.prototype,"description",void 0),Object(n.a)([Object(s.a)("viewModel.expressionInfos")],Ve.prototype,"expressionInfos",void 0),Object(n.a)([Object(s.a)("viewModel.fieldInfos")],Ve.prototype,"fieldInfos",void 0),Object(n.a)([Object(s.a)("viewModel.title")],Ve.prototype,"title",void 0),Object(n.a)([Object(a.b)({type:Ce.a})],Ve.prototype,"viewModel",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/widgets/Feature/t9n/Feature")],Ve.prototype,"messages",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/widgets/support/t9n/uriUtils")],Ve.prototype,"messagesURIUtils",void 0);var Ne,Ue,Be=Ve=Object(n.a)([Object(c.a)("esri.widgets.Feature.FeatureFields")],Ve),qe=Be,Ge=r(7),He=r(165),We=r(441),Je=r(148),Ze=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Xe=[].concat(Ze.slice(30,39),Ze.slice(28,30).reverse()),Ye=[{name:"default",colors:Xe},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],Qe="en-us",Ke=new Map([["ar",()=>r.e(220).then(r.bind(null,1132)).then((function(e){return e.a}))],["bs-ba",()=>r.e(221).then(r.bind(null,1133)).then((function(e){return e.b}))],["ca-es",()=>r.e(222).then(r.bind(null,1134)).then((function(e){return e.c}))],["cs-cz",()=>r.e(223).then(r.bind(null,1135)).then((function(e){return e.c}))],["da-dk",()=>r.e(224).then(r.bind(null,1136)).then((function(e){return e.d}))],["de-de",()=>r.e(226).then(r.bind(null,1137)).then((function(e){return e.d}))],["de-ch",()=>r.e(225).then(r.bind(null,1138)).then((function(e){return e.d}))],["el-gr",()=>r.e(227).then(r.bind(null,1139)).then((function(e){return e.e}))],["en-us",()=>r.e(229).then(r.bind(null,1140)).then((function(e){return e.e}))],["en-ca",()=>r.e(228).then(r.bind(null,1141)).then((function(e){return e.e}))],["es-es",()=>r.e(230).then(r.bind(null,1142)).then((function(e){return e.e}))],["et-ee",()=>r.e(231).then(r.bind(null,1143)).then((function(e){return e.e}))],["fi-fi",()=>r.e(232).then(r.bind(null,1144)).then((function(e){return e.f}))],["fr-fr",()=>r.e(233).then(r.bind(null,1145)).then((function(e){return e.f}))],["he-il",()=>r.e(234).then(r.bind(null,1146)).then((function(e){return e.h}))],["hr-hr",()=>r.e(235).then(r.bind(null,1147)).then((function(e){return e.h}))],["hu-hu",()=>r.e(236).then(r.bind(null,1148)).then((function(e){return e.h}))],["id-id",()=>r.e(237).then(r.bind(null,1149)).then((function(e){return e.i}))],["it-it",()=>r.e(239).then(r.bind(null,1150)).then((function(e){return e.i}))],["ja-jp",()=>r.e(240).then(r.bind(null,1151)).then((function(e){return e.j}))],["ko-kr",()=>r.e(241).then(r.bind(null,1152)).then((function(e){return e.k}))],["lt-lt",()=>r.e(242).then(r.bind(null,1153)).then((function(e){return e.l}))],["lv-lv",()=>r.e(243).then(r.bind(null,1154)).then((function(e){return e.l}))],["nb-no",()=>r.e(244).then(r.bind(null,1155)).then((function(e){return e.n}))],["nl-nl",()=>r.e(245).then(r.bind(null,1156)).then((function(e){return e.n}))],["pl-pl",()=>r.e(246).then(r.bind(null,1157)).then((function(e){return e.p}))],["pt-br",()=>r.e(247).then(r.bind(null,1158)).then((function(e){return e.p}))],["pt-pt",()=>r.e(248).then(r.bind(null,1159)).then((function(e){return e.p}))],["ro-ro",()=>r.e(249).then(r.bind(null,1160)).then((function(e){return e.r}))],["ru-ru",()=>r.e(250).then(r.bind(null,1161)).then((function(e){return e.r}))],["sk-sk",()=>r.e(251).then(r.bind(null,1162)).then((function(e){return e.s}))],["sl-sl",()=>r.e(252).then(r.bind(null,1163)).then((function(e){return e.s}))],["sr-rs",()=>r.e(253).then(r.bind(null,1164)).then((function(e){return e.s}))],["sv-se",()=>r.e(254).then(r.bind(null,1165)).then((function(e){return e.s}))],["th-th",()=>r.e(255).then(r.bind(null,1166)).then((function(e){return e.t}))],["tr-tr",()=>r.e(256).then(r.bind(null,1167)).then((function(e){return e.t}))],["uk-ua",()=>r.e(257).then(r.bind(null,1168)).then((function(e){return e.u}))],["vi-vn",()=>r.e(258).then(r.bind(null,1169)).then((function(e){return e.v}))],["zh-cn",()=>r.e(259).then(r.bind(null,1170)).then((function(e){return e.z}))],["zh-hk",()=>r.e(49).then(r.bind(null,1171)).then((function(e){return e.z}))],["zh-tw",()=>r.e(49).then(r.bind(null,1171)).then((function(e){return e.z}))]]);function $e(e){return e?Ke.has(e.toLowerCase())?e.toLowerCase():function(e){var t=e.split("-")[0].toLowerCase(),r=null;for(var i of Ke.keys())if(i.startsWith(t)){r=i;break}return r}(e)||Qe:Qe}function et(){return(et=Object(Ge.a)((function*(e=Object(Je.b)()){if(e=$e(e),Ne&&e===Ue)return Ne;Ne=r.e(238).then(r.bind(null,1172)).then((function(e){return e.i})),Ue=e;try{var[t,i]=yield Promise.all([Ne,Ke.get(Ue)()]);Ue===e&&(t.am4core.options.defaultLocale=i.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0}catch(n){return Ne=null,Ue=null,null}return Ne}))).apply(this,arguments)}var tt="esri-feature-media",rt="esri-feature-media__container",it="esri-feature-media__item-container",nt="esri-feature-media__item",at="esri-feature-media__item-title",st="esri-feature-media__item-caption",ot="esri-feature-media__previous",ct="esri-feature-media__previous-icon",lt="esri-feature-media__previous-icon--rtl",ut="esri-feature-media__next",dt="esri-feature-media__next-icon",ht="esri-feature-media__next-icon--rtl",pt="esri-feature-media__chart",ft="esri-feature-media__button",bt="esri-feature-media__icon",mt="esri-icon-left-triangle-arrow",vt="esri-icon-right-triangle-arrow",gt=.05,yt=.95,Ot=class extends f.a{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new We.a,this.messages=null}initialize(){this._featureElementInfo=new ge,this.own(Object(u.a)(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),Object(u.a)(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())))}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}render(){var e;return Object(p.a)("div",{bind:this,class:tt,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}renderMedia(){var{formattedMediaInfoCount:e}=this.viewModel;return e?Object(p.a)("div",{key:"media-element-container",class:rt},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){var{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:r,formattedMediaInfoCount:i}=this.viewModel,{value:n,refreshInterval:a,altText:s,title:o,type:c}=e,{sourceURL:l,linkURL:u}=n,d=Object(we.q)(u)?"_blank":"_self",h="_blank"===d?"noreferrer":"",f=a?t:null,b=f?f.timestamp:0,m=f?f.sourceURL:l,v=Object(p.a)("img",{alt:s||o,key:"media-".concat(c,"-").concat(r,"-").concat(i,"-").concat(b),src:m});return(u?Object(p.a)("a",{title:o,href:u,rel:h,target:d},v):null)||v}renderChartMediaInfo(e){var{activeMediaInfoIndex:t,formattedMediaInfoCount:r}=this.viewModel;return Object(p.a)("div",{key:"media-".concat(e.type,"-").concat(t,"-").concat(r),bind:this,class:pt,afterCreate:this._getChartDependencies})}renderMediaInfoType(){var{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){var{activeMediaInfo:e}=this.viewModel,t=e.title?Object(p.a)("div",{key:"media-title",class:at,innerHTML:e.title}):null,r=e.caption?Object(p.a)("div",{key:"media-caption",class:st,innerHTML:e.caption}):null;return Object(p.a)("div",{key:"media-container",class:it},Object(p.a)("div",{key:"media-item-container",class:nt},this.renderMediaInfoType()),t,r)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;var t="previous"===e,r=t?this.messages.previous:this.messages.next,i=t?this.classes(ft,ot):this.classes(ft,ut),n=t?this.classes(bt,ct,mt):this.classes(bt,dt,vt),a=t?this.classes(bt,lt,vt):this.classes(bt,ht,mt),s=t?"media-previous":"media-next",o=t?this._previous:this._next;return Object(p.a)("button",{type:"button",key:s,title:r,"aria-label":r,tabIndex:0,class:i,bind:this,onclick:o},Object(p.a)("span",{"aria-hidden":"true",class:n}),Object(p.a)("span",{"aria-hidden":"true",class:a}))}_setupFeatureElementInfo(){var{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getChartDependencies(e){var t=this;return Object(Ge.a)((function*(){var r=yield function(){return et.apply(this,arguments)}(),{activeMediaInfo:i}=t.viewModel;t._renderChart({chartDiv:e,mediaInfo:i,chartsModule:r})}))()}_handleMediaKeyup(e){var t=Object(He.a)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){var{chartsModule:t,chartDiv:r,mediaInfo:i}=e,{value:n,type:a}=i,{am4core:s}=t,o=function(e,t="default"){var r=Ye.find((e=>e.name===t));return r?r.colors.map((t=>e.color(t))):null}(s);Object(d.e)()&&s.useTheme(t.am4themes_dark),s.useTheme(t.am4themes_animated),s.useTheme((function(e){e instanceof s.ColorSet&&o&&(e.list=o)}));var c="pie-chart"===a?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",i.altText||i.title),c.data=n.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==a||e.value>0))}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){var{chartDiv:t,chartsModule:r}=e,{am4core:i,am4charts:n}=r,a=i.create(t,n.PieChart);a.rtl=Object(d.f)();var s=a.series.push(new n.PieSeries);return s.labels.template.disabled=!0,s.ticks.template.disabled=!0,s.dataFields.value="value",s.dataFields.category="tooltip",this._customizeChartTooltip(s.tooltip,i),a}_getMinSeriesValue(e){var t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){var{chartsModule:r,mediaInfo:i}=t,{value:n}=i,{am4core:a,am4charts:s}=r,o=e.xAxes.push(new s.CategoryAxis);o.dataFields.category="tooltip",o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,a),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dy=-o.tooltip.contentHeight}));var c=e.yAxes.push(new s.ValueAxis),l=c.renderer.labels.template;c.renderer.minLabelPosition=gt,c.renderer.maxLabelPosition=yt,c.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(c.tooltip,a),l.wrap=!0;var u=e.series.push(new s.ColumnSeries);u.dataFields.valueY="value",u.dataFields.categoryX="tooltip",e.cursor=new s.XYCursor,n.series.length>15&&(e.scrollbarX=new a.Scrollbar)}_createBarChart(e,t){var{chartsModule:r,mediaInfo:i}=t,{value:n}=i,{am4core:a,am4charts:s}=r,o=e.yAxes.push(new s.CategoryAxis);o.dataFields.category="tooltip",o.renderer.inversed=!0,o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,a),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dx=o.tooltip.contentWidth}));var c=e.xAxes.push(new s.ValueAxis),l=c.renderer.labels.template;c.renderer.minLabelPosition=gt,c.renderer.maxLabelPosition=yt,c.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(c.tooltip,a),l.wrap=!0;var u=e.series.push(new s.ColumnSeries);u.dataFields.valueX="value",u.dataFields.categoryY="tooltip",e.cursor=new s.XYCursor,n.series.length>15&&(e.scrollbarY=new a.Scrollbar)}_createLineChart(e,t){var{chartsModule:r,mediaInfo:i}=t,{value:n}=i,{am4core:a,am4charts:s}=r,o=e.xAxes.push(new s.CategoryAxis);o.dataFields.category="tooltip",o.renderer.labels.template.disabled=!0,this._customizeChartTooltip(o.tooltip,a),o.tooltip.events.on("sizechanged",(()=>{o.tooltip.dy=-o.tooltip.contentHeight}));var c=e.yAxes.push(new s.ValueAxis),l=c.renderer.labels.template;c.renderer.minLabelPosition=gt,c.renderer.maxLabelPosition=yt,c.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(c.tooltip,a),l.wrap=!0;var u=e.series.push(new s.LineSeries);u.dataFields.categoryX="tooltip",u.dataFields.valueY="value",e.cursor=new s.XYCursor,n.series.length>15&&(e.scrollbarX=new a.Scrollbar)}_createXYChart(e){var{chartDiv:t,chartsModule:r,mediaInfo:i}=e,{type:n}=i,{am4core:a,am4charts:s}=r,o=a.create(t,s.XYChart);return o.rtl=Object(d.f)(),"column-chart"===n&&this._createColumnChart(o,e),"bar-chart"===n&&this._createBarChart(o,e),"line-chart"===n&&this._createLineChart(o,e),o}_clearMediaRefreshTimer(){var{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){var t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();var{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){var{refreshInterval:t,value:r}=e;if(t){var i=6e4*t;this._updateMediaInfoTimestamp(r.sourceURL);var n=setInterval((()=>{this._updateMediaInfoTimestamp(r.sourceURL)}),i);this._refreshTimer=n}}_getImageSource(e,t){var r=-1!==e.indexOf("?")?"&":"?",[i,n=""]=e.split("#");return"".concat(i).concat(r,"timestamp=").concat(t).concat(n?"#":"").concat(n)}};Object(n.a)([Object(s.a)("viewModel.attributes")],Ot.prototype,"attributes",void 0),Object(n.a)([Object(s.a)("viewModel.activeMediaInfoIndex")],Ot.prototype,"activeMediaInfoIndex",void 0),Object(n.a)([Object(s.a)("viewModel.description")],Ot.prototype,"description",void 0),Object(n.a)([Object(s.a)("viewModel.fieldInfoMap")],Ot.prototype,"fieldInfoMap",void 0),Object(n.a)([Object(s.a)("viewModel.layer")],Ot.prototype,"layer",void 0),Object(n.a)([Object(s.a)("viewModel.mediaInfos")],Ot.prototype,"mediaInfos",void 0),Object(n.a)([Object(s.a)("viewModel.popupTemplate")],Ot.prototype,"popupTemplate",void 0),Object(n.a)([Object(s.a)("viewModel.relatedInfos")],Ot.prototype,"relatedInfos",void 0),Object(n.a)([Object(s.a)("viewModel.title")],Ot.prototype,"title",void 0),Object(n.a)([Object(a.b)({type:We.a})],Ot.prototype,"viewModel",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/widgets/Feature/t9n/Feature")],Ot.prototype,"messages",void 0);var jt=Ot=Object(n.a)([Object(c.a)("esri.widgets.Feature.FeatureMedia")],Ot),_t=r(472),wt=r(465),xt="esri-icon-loading-indicator esri-rotating",St="esri-widget",Mt="esri-feature",Tt="esri-feature__size-container",Et="esri-feature__title",Pt="esri-feature__main-container",Ct="esri-feature__content-element",It="esri-feature__text",At="esri-feature__last-edited-info",Rt="esri-feature__loading-container",Ft="esri-feature__loading-spinner",Lt={title:!0,content:!0,lastEditedInfo:!0},Dt=class extends(Object(wt.a)(f.a)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements=Object(i.a)({},Lt),this.map=null,this.view=null,this.viewModel=new _t.a}initialize(){this.own(Object(u.a)(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())))}destroy(){this._destroyContentWidgets()}castVisibleElements(e){return Object(i.a)(Object(i.a)({},Lt),e)}render(){var{waitingForContent:e}=this.viewModel;return Object(p.a)("div",{class:this.classes(Mt,St)},Object(p.a)("div",{class:Tt},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t)}nextMedia(e){this.viewModel.nextMedia(e)}previousMedia(e){this.viewModel.previousMedia(e)}renderLoading(){return Object(p.a)("div",{key:"loading-container",class:Rt},Object(p.a)("span",{class:this.classes(xt,Ft)}))}renderContentContainer(){var{visibleElements:e}=this;return e.content?Object(p.a)("div",{class:Pt},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){var{visibleElements:e,title:t}=this;return e.title?Object(p.a)("h4",{class:Et,innerHTML:t}):null}renderContent(){var e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?Object(p.a)("div",{key:"".concat(t,"-content-elements")},e.map(this.renderContentElement,this)):null;if("string"==typeof e){var r=this._contentWidgets[0];return!r||r.destroyed?null:Object(p.a)("div",{key:"".concat(t,"-content")},r.render())}return this.renderNodeContent(e)}renderContentElement(e,t){var{visibleElements:r}=this;if("boolean"!=typeof r.content&&!r.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){var t=this._contentWidgets[e];if(!t||t.destroyed)return null;var{state:r,attachmentInfos:i}=t.viewModel;return"loading"===r||i.length>0?Object(p.a)("div",{key:this._buildKey("attachments-element",e),class:this.classes(Ct)},t.render()):null}renderCustom(e,t){var{creator:r}=e,i=this._contentWidgets[t];return!i||i.destroyed?null:r?Object(p.a)("div",{key:this._buildKey("custom-element",t),class:Ct},i.render()):null}renderFields(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(p.a)("div",{key:this._buildKey("fields-element",e),class:Ct},t.render())}renderMedia(e){var t=this._contentWidgets[e];return!t||t.destroyed?null:Object(p.a)("div",{key:this._buildKey("media-element",e),class:Ct},t.render())}renderLastEditInfo(){var{visibleElements:e,messages:t}=this,{lastEditInfo:r}=this.viewModel;if(!r||!e.lastEditedInfo)return null;var{date:i,user:n}=r,a="edit"===r.type?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,s=Object(l.a)(a,{date:i,user:n});return Object(p.a)("div",{key:"edit-info-element",class:this.classes(At,Ct)},s)}renderText(e,t){var r=e.text,i=this._contentWidgets[t];return!i||i.destroyed?null:r?Object(p.a)("div",{key:this._buildKey("text-element",t),class:this.classes(Ct,It)},i.render()):null}_buildKey(e,...t){return"".concat(e,"__").concat(this.get("viewModel.graphic.uid")||"0","-").concat(t.join("-"))}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy()})),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();var e=this.get("viewModel.content"),{contentViewModels:t}=this.viewModel;if(Array.isArray(e))e.forEach(((e,r)=>{"attachments"===e.type&&(this._contentWidgets[r]=new je({displayType:e.displayType,viewModel:t[r]})),"fields"===e.type&&(this._contentWidgets[r]=new qe({viewModel:t[r]})),"media"===e.type&&(this._contentWidgets[r]=new jt({viewModel:t[r]})),"text"===e.type&&(this._contentWidgets[r]=new Pe({viewModel:t[r]})),"custom"===e.type&&(this._contentWidgets[r]=new Pe({viewModel:t[r]}))}),this);else{var r=t[0];r&&!r.destroyed&&(this._contentWidgets[0]=new Pe({viewModel:r}))}this.scheduleRender()}};Object(n.a)([Object(s.a)("viewModel.graphic")],Dt.prototype,"graphic",void 0),Object(n.a)([Object(s.a)("viewModel.defaultPopupTemplateEnabled")],Dt.prototype,"defaultPopupTemplateEnabled",void 0),Object(n.a)([Object(a.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Dt.prototype,"label",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/widgets/Feature/t9n/Feature")],Dt.prototype,"messages",void 0),Object(n.a)([Object(a.b)(),Object(h.a)("esri/widgets/support/t9n/uriUtils")],Dt.prototype,"messagesURIUtils",void 0),Object(n.a)([Object(s.a)("viewModel.spatialReference")],Dt.prototype,"spatialReference",void 0),Object(n.a)([Object(s.a)("viewModel.title")],Dt.prototype,"title",void 0),Object(n.a)([Object(a.b)()],Dt.prototype,"visibleElements",void 0),Object(n.a)([Object(o.a)("visibleElements")],Dt.prototype,"castVisibleElements",null),Object(n.a)([Object(s.a)("viewModel.map")],Dt.prototype,"map",void 0),Object(n.a)([Object(s.a)("viewModel.view")],Dt.prototype,"view",void 0),Object(n.a)([Object(a.b)({type:_t.a})],Dt.prototype,"viewModel",void 0);var kt=Dt=Object(n.a)([Object(c.a)("esri.widgets.Feature")],Dt);t.a=kt},,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return G})),r.d(t,"b",(function(){return P}));r(80);var i=r(81),n=r(110),a=r(104),s=r(111),o=r(330),c=r(157),l=r(299),u=r(174),d=r(177),h=r(347),p=r(424),f=r(374),b=r(425),m=i.a.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");function v(e=D){return{plane:Object(b.c)(e.plane),origin:Object(a.d)(e.origin),basis1:Object(a.d)(e.basis1),basis2:Object(a.d)(e.basis2)}}function g(e,t=v()){return y(e.origin,e.basis1,e.basis2,t)}function y(e,t,r,i=v()){return Object(s.j)(i.origin,e),Object(s.j)(i.basis1,t),Object(s.j)(i.basis2,r),O(i),function(e,t){Math.abs(Object(s.g)(e.basis1,e.basis2)/(Object(s.o)(e.basis1)*Object(s.o)(e.basis2)))>1e-6&&m.warn(t,"Provided basis vectors are not perpendicular"),Math.abs(Object(s.g)(e.basis1,I(e)))>1e-6&&m.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-Object(s.g)(I(e),e.origin)-e.plane[3])>1e-6&&m.warn(t,"Plane offset is not consistent with plane origin")}(i,"fromValues()"),i}function O(e){Object(b.f)(e.basis2,e.basis1,e.origin,e.plane)}function j(e,t,r){e!==r&&g(e,r);var i=Object(s.d)(d.d.get(),I(e),t);return Object(s.e)(r.origin,r.origin,i),r.plane[3]-=t,r}function _(e,t=v()){var r=(e[2]-e[0])/2,i=(e[3]-e[1])/2;return Object(s.v)(t.origin,e[0]+r,e[1]+i,0),Object(s.v)(t.basis1,r,0,0),Object(s.v)(t.basis2,0,i,0),Object(b.b)(0,0,1,0,t.plane),t}function w(e,t,r){return!!Object(b.i)(e.plane,t,r)&&A(e,r)}function x(e,t,r){var i=k.get();L(e,t,i,k.get());var a=Number.POSITIVE_INFINITY;for(var c of U){var l=F(e,c,z.get()),u=d.d.get();if(Object(b.d)(i,l,u)){var h=Object(o.d)(d.d.get(),t.origin,u),p=Math.abs(Object(n.b)(Object(s.g)(t.direction,h)));p<a&&(a=p,Object(s.j)(r,u))}}return a===Number.POSITIVE_INFINITY?S(e,t,r):r}function S(e,t,r){if(w(e,t,r))return r;var i=k.get(),n=k.get();L(e,t,i,n);var a=Number.POSITIVE_INFINITY;for(var o of U){var c=F(e,o,z.get()),l=d.d.get();if(Object(b.e)(i,c,l)){var u=Object(f.c)(t,l);if(!Object(b.g)(n,l))continue;u<a&&(a=u,Object(s.j)(r,l))}}return E(e,t.origin)<a&&M(e,t.origin,r),r}function M(e,t,r){var i=Object(b.p)(e.plane,t,d.d.get()),n=Object(p.e)(R(e,e.basis1),i,-1,1,d.d.get()),a=Object(p.e)(R(e,e.basis2),i,-1,1,d.d.get());return Object(s.i)(r,Object(s.e)(d.d.get(),n,a),e.origin),r}function T(e,t,r){var{origin:i,basis1:n,basis2:a}=e,o=Object(s.i)(d.d.get(),t,i),c=Object(h.c)(n,o),l=Object(h.c)(a,o),u=Object(h.c)(I(e),o);return Object(s.v)(r,c,l,u)}function E(e,t){var r=T(e,t,d.d.get()),{basis1:i,basis2:n}=e,a=Object(s.o)(i),o=Object(s.o)(n),c=Math.max(Math.abs(r[0])-a,0),l=Math.max(Math.abs(r[1])-o,0),u=r[2];return c*c+l*l+u*u}function P(e,t){return Object(b.g)(e.plane,t)&&A(e,t)}function C(e,t){var r=-e.plane[3];return Object(h.c)(I(e),t)-r}function I(e){return Object(b.n)(e.plane)}function A(e,t){var r=Object(s.i)(d.d.get(),t,e.origin),i=Object(s.r)(e.basis1),n=Object(s.r)(e.basis2),a=Object(s.g)(e.basis1,r),o=Object(s.g)(e.basis2,r);return-a-i<0&&a-i<0&&-o-n<0&&o-n<0}function R(e,t){var r=z.get();return Object(s.j)(r.origin,e.origin),Object(s.j)(r.vector,t),r}function F(e,t,r){var{basis1:i,basis2:n,origin:a}=e,o=Object(s.d)(d.d.get(),i,t.origin[0]),c=Object(s.d)(d.d.get(),n,t.origin[1]);Object(s.e)(r.origin,o,c),Object(s.e)(r.origin,r.origin,a);var l=Object(s.d)(d.d.get(),i,t.direction[0]),u=Object(s.d)(d.d.get(),n,t.direction[1]);return Object(s.d)(r.vector,Object(s.e)(l,l,u),2),r}function L(e,t,r,i){var n=I(e);Object(b.f)(n,t.direction,t.origin,r),Object(b.f)(Object(b.n)(r),n,t.origin,i)}var D={plane:Object(b.c)(),origin:Object(a.g)(0,0,0),basis1:Object(a.g)(1,0,0),basis2:Object(a.g)(0,1,0)},k=new l.a(b.c),z=new l.a(p.a),V=Object(a.e)(),N=new l.a((()=>({origin:null,basis1:null,basis2:null,plane:null}))),U=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],B=Object(u.b)(),q=Object(u.b)(),G=Object.freeze({__proto__:null,BoundedPlaneClass:class{constructor(){this.plane=Object(b.c)(),this.origin=Object(a.e)(),this.basis1=Object(a.e)(),this.basis2=Object(a.e)()}},create:v,wrap:function(e,t,r){var i=N.get();return i.origin=e,i.basis1=t,i.basis2=r,i.plane=Object(b.s)(0,0,0,0),O(i),i},copy:g,copyWithoutVerify:function(e,t){Object(s.j)(t.origin,e.origin),Object(s.j)(t.basis1,e.basis1),Object(s.j)(t.basis2,e.basis2),Object(b.a)(e.plane,t.plane)},fromValues:y,updateUnboundedPlane:O,elevate:j,setExtent:function(e,t,r){return _(t,r),j(r,C(e,e.origin),r),r},fromAABoundingRect:_,intersectRay:w,intersectRayClosestSilhouette:function(e,t,r){if(w(e,t,r))return r;var i=x(e,t,d.d.get());return Object(s.e)(r,t.origin,Object(s.d)(d.d.get(),t.direction,Object(s.n)(t.origin,i)/Object(s.o)(t.direction))),r},closestPointOnSilhouette:x,closestPoint:S,projectPoint:M,projectPointLocal:T,distance2:E,distance:function(e,t){return Math.sqrt(E(e,t))},distanceToSilhouette:function(e,t){var r=Number.NEGATIVE_INFINITY;for(var i of U){var n=F(e,i,z.get()),a=Object(p.b)(n,t);a>r&&(r=a)}return Math.sqrt(r)},extrusionContainsPoint:P,axisAt:function(e,t,r,i){return function(e,t,r){switch(t){case 0:Object(s.j)(r,e.basis1),Object(s.q)(r,r);break;case 1:Object(s.j)(r,e.basis2),Object(s.q)(r,r);break;case 2:Object(s.j)(r,I(e))}return r}(e,r,i)},altitudeAt:C,setAltitudeAt:function(e,t,r,i){var n=C(e,t),a=Object(s.d)(V,I(e),r-n);return Object(s.e)(i,t,a),i},equals:function(e,t){return Object(s.p)(e.basis1,t.basis1)&&Object(s.p)(e.basis2,t.basis2)&&Object(s.p)(e.origin,t.origin)},transform:function(e,t,r){return e!==r&&g(e,r),Object(c.a)(B,t),Object(c.b)(B,B),Object(s.l)(r.basis1,e.basis1,B),Object(s.l)(r.basis2,e.basis2,B),Object(s.l)(Object(b.n)(r.plane),Object(b.n)(e.plane),B),Object(s.l)(r.origin,e.origin,t),Object(b.r)(r.plane,r.origin,r.plane),r},rotate:function(e,t,r,i){return e!==i&&g(e,i),Object(c.q)(q,Object(c.i)(q),t,r),Object(s.l)(i.basis1,e.basis1,q),Object(s.l)(i.basis2,e.basis2,q),O(i),i},normal:I,UP:D})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return l}));var i=r(110);function n(e,t,r){var i=r.parameters,n=r.paddingPixelsOverride;return u.scale=Math.min(i.divisor/(t-i.offset),1),u.factor=function(e){return Math.abs(e*e*e)}(e),u.minPixelSize=i.minPixelSize,u.paddingPixels=n,u}function a(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function s(e,t){return Math.max(Object(i.l)(e*t.scale,e,t.factor),a(e,t))}function o(e,t,r,i){i.scale=function(e,t,r){var i=n(e,t,r);return i.minPixelSize=0,i.paddingPixels=0,s(1,i)}(e,t,r),i.factor=0,i.minPixelSize=r.parameters.minPixelSize,i.paddingPixels=r.paddingPixelsOverride}function c(e,t,r=[0,0]){var i=Math.min(Math.max(t.scale,a(e[1],t)/e[1]),1);return r[0]=e[0]*i,r[1]=e[1]*i,r}function l(e,t,r,i){return s(e,n(t,r,i))}Object(i.f)(10),Object(i.f)(12),Object(i.f)(70),Object(i.f)(40);var u={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i,n,a=r(120),s=r(119);function o(e){e.vertex.code.add(Object(s.a)(i||(i=Object(a.a)(["\n    const float PI = 3.141592653589793;\n  "])))),e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    const float PI = 3.141592653589793;\n    const float LIGHT_NORMALIZATION = 1.0 / PI;\n    const float INV_PI = 0.3183098861837907;\n    const float HALF_PI = 1.570796326794897;\n    "]))))}},,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var i=r(91),n=r(388),a=r(328),s=r(379),o=r(349),c=r(585),l=r(82),u=r(300),d=r(307),h=r(313),p=r(306),f=r(286),b=r(267),m=r(380),v=r(249),g=r(322),y=r(280),O=r(489),j=r(619);class _ extends d.a{initializeProgram(e){var t=_.shader.get(),r=this.configuration,i=t.build({output:r.output,OITEnabled:0===r.transparencyPassType,attributeColor:r.vertexColors,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new f.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),p.a)}bindPass(e,t,r){m.a.bindProjectionMatrix(this.program,r.camera.projectionMatrix),this.program.setUniform4fv("eColor",t.color),4===this.configuration.output&&g.a.bindOutputHighlight(e,this.program,r),(1===this.configuration.output||r.multipassTerrainEnabled)&&this.program.setUniform2fv("cameraNearFar",r.camera.nearFar),r.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",r.inverseViewport),Object(y.a)(this.program,e,r))}bindDraw(e){m.a.bindView(this.program,e),v.a.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e,t){var r=this.configuration,i=3===e,n=2===e;return Object(b.d)({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?o.f:Object(o.a)(e),culling:(e=>0!==e&&{face:1===e?1028:1029,mode:2305})(r.cullFace),depthTest:{func:Object(o.b)(e)},depthWrite:i||n?r.writeDepth&&b.c:null,colorWrite:b.b,stencilWrite:r.sceneHasOcludees?O.h:null,stencilTest:r.sceneHasOcludees?t?O.d:O.c:null,polygonOffset:i||n?r.polygonOffset&&w:Object(o.g)(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}_.shader=new u.a(j.a,(()=>r.e(293).then(r.bind(null,1189))));var w={factor:1,units:1};class x extends h.a{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.vertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}Object(l.a)([Object(h.b)({count:8})],x.prototype,"output",void 0),Object(l.a)([Object(h.b)({count:3})],x.prototype,"cullFace",void 0),Object(l.a)([Object(h.b)()],x.prototype,"slicePlaneEnabled",void 0),Object(l.a)([Object(h.b)()],x.prototype,"vertexColors",void 0),Object(l.a)([Object(h.b)()],x.prototype,"transparent",void 0),Object(l.a)([Object(h.b)()],x.prototype,"polygonOffset",void 0),Object(l.a)([Object(h.b)()],x.prototype,"enableOffset",void 0),Object(l.a)([Object(h.b)()],x.prototype,"writeDepth",void 0),Object(l.a)([Object(h.b)()],x.prototype,"sceneHasOcludees",void 0),Object(l.a)([Object(h.b)({count:4})],x.prototype,"transparencyPassType",void 0),Object(l.a)([Object(h.b)()],x.prototype,"multipassTerrainEnabled",void 0),Object(l.a)([Object(h.b)()],x.prototype,"cullAboveGround",void 0);class S extends s.a{constructor(e){super(e,T),this.supportsEdges=!0,this.techniqueConfig=new x}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.vertexColors=this.params.vertexColors,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<o.e,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.params}intersect(e,t,r,i,n,s,o){Object(a.e)(e,t,i,n,s,void 0,o)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output||1===e.output&&this.params.writeLinearDepth?new M(e):void 0}createBufferWriter(){return new c.a(c.b)}}class M extends n.a{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(_,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){return 4===this.output?3===e:e===(this.technique.configuration.transparent?this.technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}getPipelineState(e,t){return this.technique.getPipelineState(t)}}var T=Object(i.a)({color:[1,1,1,1],transparent:!1,writeDepth:!0,writeLinearDepth:!1,vertexColors:!1,polygonOffset:!1,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1},s.b)},,,,,,,function(e,t,r){"use strict";function i(e,t){for(var[r,i]of e)if(t(i,r))return!0;return!1}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return c}));var i=r(276),n=r(210),a=r(125);function s(e,t,r,n){if(null==n||e.hasZ||(n=void 0),"point"===e.type)return e.x+=t,e.y+=r,e.hasZ&&null!=n&&(e.z+=n),e;if("multipoint"===e.type){for(var a=e.points,s=0;s<a.length;s++)a[s]=d(a[s],t,r,n);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=r,e.ymax+=r,null!=n&&(e.zmin+=n,e.zmax+=n),e;for(var o=Object(i.b)(e),c="polyline"===e.type?e.paths:e.rings,l=0;l<o.length;l++)for(var u=o[l],h=0;h<u.length;h++)u[h]=d(u[h],t,r,n);return"paths"in e?e.paths=c:e.rings=c,e}function o(e,t,r,n,a){var o=e.clone(),c=n.resolution;if("point"===o.type){if(a)s(o,t*c,-r*c);else{var l=n.state.transform,u=n.state.inverseTransform,d=l[0]*o.x+l[2]*o.y+l[4],p=l[1]*o.x+l[3]*o.y+l[5];o.x=u[0]*(d+t)+u[2]*(p+r)+u[4],o.y=u[1]*(d+t)+u[3]*(p+r)+u[5]}return o}if("multipoint"===o.type){if(a)s(o,t*c,-r*c);else for(var f=o.points,b=n.state.transform,m=n.state.inverseTransform,v=0;v<f.length;v++){var g=f[v],y=b[0]*g[0]+b[2]*g[1]+b[4],O=b[1]*g[0]+b[3]*g[1]+b[5],j=m[0]*(y+t)+m[2]*(O+r)+m[4],_=m[1]*(y+t)+m[3]*(O+r)+m[5];f[v]=h(g,j,_,void 0)}return o}if("extent"===o.type){if(a)s(o,t*c,-r*c);else{var w=n.state.transform,x=n.state.inverseTransform,S=w[0]*o.xmin+w[2]*o.ymin+w[4],M=w[1]*o.xmin+w[3]*o.ymin+w[5],T=w[0]*o.xmax+w[2]*o.ymax+w[4],E=w[1]*o.xmax+w[3]*o.ymax+w[5];o.xmin=x[0]*(S+t)+x[2]*(M+r)+x[4],o.ymin=x[1]*(S+t)+x[3]*(M+r)+x[5],o.xmax=x[0]*(T+t)+x[2]*(E+r)+x[4],o.ymax=x[1]*(T+t)+x[3]*(E+r)+x[5]}return o}if(a)s(o,t*c,-r*c);else{for(var P=Object(i.b)(o),C="polyline"===o.type?o.paths:o.rings,I=n.state.transform,A=n.state.inverseTransform,R=0;R<P.length;R++)for(var F=P[R],L=0;L<F.length;L++){var D=F[L],k=I[0]*D[0]+I[2]*D[1]+I[4],z=I[1]*D[0]+I[3]*D[1]+I[5],V=A[0]*(k+t)+A[2]*(z+r)+A[4],N=A[1]*(k+t)+A[3]*(z+r)+A[5];F[L]=h(D,V,N,void 0)}"paths"in o?o.paths=C:o.rings=C}return o}function c(e,t,r,s){if("point"===e.type){var{x:o,y:c}=e,l=s?s[0]:o,u=s?s[1]:c,d=e.clone(),p=(o-l)*t+l,f=(c-u)*r+u;return d.x=p,d.y=f,d}if("multipoint"===e.type){for(var b=Object(i.b)(e),m=Object(a.i)(),[v,g,y,O]=Object(n.d)(m,[b]),j=s?s[0]:(v+y)/2,_=s?s[1]:(O+g)/2,w=e.clone(),x=w.points,S=0;S<x.length;S++){var M=x[S],[T,E]=M,P=(T-j)*t+j,C=(E-_)*r+_;x[S]=h(M,P,C,void 0)}return w}if("extent"===e.type){var{xmin:I,xmax:A,ymin:R,ymax:F}=e,L=s?s[0]:(I+A)/2,D=s?s[1]:(F+R)/2,k=e.clone();if(k.xmin=(I-L)*t+L,k.ymax=(F-D)*r+D,k.xmax=(A-L)*t+L,k.ymin=(R-D)*r+D,k.xmin>k.xmax){var z=k.xmin,V=k.xmax;k.xmin=V,k.xmax=z}if(k.ymin>k.ymax){var N=k.ymin,U=k.ymax;k.ymin=U,k.ymax=N}return k}for(var B=Object(i.b)(e),q=Object(a.i)(),[G,H,W,J]=Object(n.d)(q,B),Z=s?s[0]:(G+W)/2,X=s?s[1]:(J+H)/2,Y=e.clone(),Q="polyline"===Y.type?Y.paths:Y.rings,K=0;K<B.length;K++)for(var $=B[K],ee=0;ee<$.length;ee++){var te=$[ee],[re,ie]=te,ne=(re-Z)*t+Z,ae=(ie-X)*r+X;Q[K][ee]=h(te,ne,ae,void 0)}return"paths"in Y?Y.paths=Q:Y.rings=Q,Y}function l(e,t,r,i,n,a){var s=Math.sqrt((r-e)*(r-e)+(i-t)*(i-t));return Math.sqrt((n-e)*(n-e)+(a-t)*(a-t))/s}function u(e,t,r,i,n,a){var s=180*Math.atan2(t-i,e-r)/Math.PI;return 180*Math.atan2(t-a,e-n)/Math.PI-s}function d(e,t,r,i){return h(e,e[0]+t,e[1]+r,null!=e[2]&&null!=i?e[2]+i:void 0)}function h(e,t,r,i){var n=[t,r];return e.length>2&&n.push(null!=i?i:e[2]),e.length>3&&n.push(e[3]),n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a}));var i=e=>class extends e{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(var e of null!=(t=this._managedDisposables)?t:[]){var t,r=this[e];this[e]=null,r&&"function"==typeof r.dispose&&r.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}};class n extends(i(class{})){}function a(){return(e,t)=>{var r,i;e.hasOwnProperty("_managedDisposables")||(e._managedDisposables=null!=(r=null==(i=e._managedDisposables)?void 0:i.slice())?r:[]),e._managedDisposables.unshift(t)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(91),n={divisor:0};function a(e,t={}){t=Object(i.a)(Object(i.a)({},n),t);var r=e.stride;return e.fieldNames.filter((t=>{var r=e.fields.get(t).optional;return!(r&&r.glPadding)})).map((i=>{var n=e.fields.get(i),a=n.constructor.ElementCount,o=s(n.constructor.ElementType),c=n.offset,l=!(!n.optional||!n.optional.glNormalized);return{name:i,stride:r,count:a,type:o,offset:c,normalized:l,divisor:t.divisor}}))}function s(e){var t=o[e];if(t)return t;throw new Error("BufferType not supported in WebGL")}var o={u8:5121,u16:5123,u32:5125,i8:5120,i16:5122,i32:5124,f32:5126}},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return cr})),r.d(t,"b",(function(){return lr}));var i=r(82),n=(r(80),r(81)),a=(r(88),r(85)),s=r(84),o=(r(83),r(86),r(87),r(241)),c=r(108),l=r(385),u=r(97),d=r(107),h=r(297),p=(r(302),r(367)),f=class extends u.a{constructor(){super(...arguments),this.items=new d.a,this._watchUpdatingTracking=new h.a,this._callbacks=new Map,this._projector=Object(p.a)(),this._hiddenProjector=Object(p.a)()}get needsRender(){return this.items.length>0}initialize(){var e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(e=>{e.added.map((e=>{var t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t)})),e.removed.map((e=>{var t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e)}))}))}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach((e=>this._projector.detach(e))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){var t=this._hiddenSurface,r=this._hiddenProjector,i=null,n=()=>i=e.render();r.append(t,n),r.renderNow();var a={left:0,top:0,right:0,bottom:0};if(i&&i.domNode){var s=i.domNode.getBoundingClientRect();a.left=s.left,a.top=s.top,a.right=s.right,a.bottom=s.bottom}for(r.detach(n);t.firstChild;)t.removeChild(t.firstChild);return a}overlaps(e,t){var r=this.computeBoundingRect(e),i=this.computeBoundingRect(t);return Math.max(r.left,i.left)<=Math.min(r.right,i.right)&&Math.max(r.top,i.top)<=Math.min(r.bottom,i.bottom)}get hasVisibleItems(){return this.items.some((e=>e.visible))}renderCanvas(e){if(this.items.some((e=>e.visible))){var t=e.getContext("2d");t.save(),t.font="10px ".concat(getComputedStyle(this.surface).fontFamily),this.items.forEach((e=>{t.save(),e.renderCanvas(t),t.restore()})),t.restore()}}};Object(i.a)([Object(a.b)({readOnly:!0})],f.prototype,"surface",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],f.prototype,"items",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],f.prototype,"needsRender",null),Object(i.a)([Object(a.b)({readOnly:!0})],f.prototype,"_watchUpdatingTracking",void 0),Object(i.a)([Object(a.b)({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],f.prototype,"updating",void 0);var b=f=Object(i.a)([Object(s.a)("esri.views.overlay.ViewOverlay")],f),m=r(91),v=r(89),g=r(145),y=r(116),O=r(288),j=r(165),_=r(281),w=(r(171),r(115)),x=r(457),S=r(114),M=r(261),T=r(163),E=r(301),P=r(129),C=r(154),I=r(465),A=r(541),R=r(94),F=r(131),L=class extends F.a.EventedAccessor{constructor(e){super(e),this._anchorHandles=new w.a,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([Object(c.d)(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),Object(c.d)(this,["view","view.ready"],(()=>this._wireUpView()))])}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null}_wireUpView(){var e="view";if(this._anchorHandles.remove(e),this._viewpointHandle=null,this.get("view.ready")){this._setScreenLocation();var{view:t}=this,r="3d"===t.type?"camera":"viewpoint",i=Object(c.c)(t,r,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint()}}_viewpointChange(){this._setScreenLocation(),this.emit("view-change")}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint()}_toggleWatchingViewpoint(){var{_viewpointHandle:e,location:t,screenLocationEnabled:r}=this;e&&(t&&r?e.resume():e.pause())}_setScreenLocation(){var{location:e,view:t,screenLocationEnabled:r}=this,i=this.get("view.ready"),n=r&&i&&Object(v.k)(e)?t.toScreen(e):null;this._set("screenLocation",n)}};Object(i.a)([Object(a.b)()],L.prototype,"location",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],L.prototype,"screenLocation",void 0),Object(i.a)([Object(a.b)()],L.prototype,"screenLocationEnabled",void 0),Object(i.a)([Object(a.b)()],L.prototype,"view",void 0);var D=L=Object(i.a)([Object(s.a)("esri.widgets.support.AnchorElementViewModel")],L),k=class extends D{constructor(e){super(e),this.visible=!1}};Object(i.a)([Object(a.b)()],k.prototype,"visible",void 0);var z=k=Object(i.a)([Object(s.a)("esri.widgets.CompassViewModel")],k),V="esri-spinner",N="esri-spinner--start",U="esri-spinner--finish",B=class extends C.a{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new z,this.visible=!1}initialize(){this.own([Object(c.d)(this,"visible",(e=>this._visibleChange(e)))])}destroy(){this._animationPromise=null}show(e){var{location:t,promise:r}=e;t&&(this.viewModel.location=t),this.visible=!0;r&&r.catch((()=>{})).then((()=>this.hide()))}hide(){this.visible=!1}render(){var{visible:e}=this,{screenLocation:t}=this.viewModel,r=!!t,i={[N]:e&&r,[U]:!e&&r},n=this._getPositionStyles();return Object(P.a)("div",{class:this.classes(V,i),styles:n})}_visibleChange(e){if(e)this.viewModel.screenLocationEnabled=!0;else{var t=Object(R.a)(this._animationDelay);this._animationPromise=t,t.catch((()=>{})).then((()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)}))}}_getPositionStyles(){var{screenLocation:e,view:t}=this.viewModel;if(!t||Object(v.j)(e))return{};var{padding:r}=t;return{left:e.x-r.left+"px",top:e.y-r.top+"px"}}};Object(i.a)([Object(g.a)("viewModel.location")],B.prototype,"location",void 0),Object(i.a)([Object(g.a)("viewModel.view")],B.prototype,"view",void 0),Object(i.a)([Object(a.b)({type:z})],B.prototype,"viewModel",void 0),Object(i.a)([Object(g.a)("viewModel.visible")],B.prototype,"visible",void 0);var q=B=Object(i.a)([Object(s.a)("esri.widgets.Spinner")],B),G=r(7),H=r(93),W=r(161),J=r(113),Z=(r(101),r(625)),X=r(566),Y=r(677),Q=r(211),K=(r(138),r(123)),$=r(218),ee=r(472),te=r(512),re=r(334),ie=r(484),ne="esri-icon-zoom-in-magnifying-glass",ae="esri-icon-trash",se="esri-icon-table",oe=new X.a({id:"zoom-to-feature",title:"{messages.zoom}",className:ne}),ce=new X.a({id:"remove-selected-feature",title:"{messages.remove}",className:ae}),le=new X.a({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:ne}),ue=new X.a({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:se}),de=n.a.getLogger("esri.widgets.Popup.PopupViewModel"),he=function(e){var{event:t,view:r}=e,{action:i}=t,n=r&&r.popup;if(!i)return Promise.reject(new H.a("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new H.a("trigger-action:missing-arguments","view.popup is missing"));var{disabled:a,id:s}=i;if(!s)return Promise.reject(new H.a("trigger-action:invalid-action","action.id is missing"));if(a)return Promise.reject(new H.a("trigger-action:invalid-action","Action is disabled"));if(s===oe.id)return function(e){return be.apply(this,arguments)}(n.viewModel);if(s===le.id)return function(e){return me.apply(this,arguments)}(n.viewModel);if(n.viewModel.browseClusterEnabled=!1,s===ue.id&&(n.featureMenuOpen=!0,n.viewModel.browseClusterEnabled=!0),s===ce.id){n.close();var{selectedFeature:o}=n;if(!o)return Promise.reject(new H.a("trigger-action:".concat(ce.id),"selectedFeature is required",{selectedFeature:o}));var{sourceLayer:c}=o;return c?c.remove(o):r.graphics.remove(o),Promise.resolve()}return Promise.resolve()};function pe(e){var{selectedFeature:t,location:r,view:i}=e;return i?"3d"===i.type?t||r:e.get("selectedFeature.geometry")||r:null}function fe(e,t){if("3d"!==(null==t?void 0:t.type)||!e||"esri.Graphic"!==e.declaredClass)return!0;var r=t.getViewForGraphic(e);if(r&&"whenGraphicBounds"in r){var i=!1;return r.whenGraphicBounds(e,{useViewElevation:!0}).then((e=>{i=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5]})).catch((()=>{var t=new H.a("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:e});de.error(t)})),i}return!0}function be(){return(be=Object(G.a)((function*(e){var{location:t,selectedFeature:r,view:i,zoomFactor:n}=e,a=pe(e);if(!a){var s=new H.a("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:a,view:i});return de.error(s),Promise.reject(s)}var o=i.scale/n,c=e.get("selectedFeature.geometry")||t,l=c&&"point"===c.type&&fe(r,i);oe.active=!0,oe.disabled=!0,yield e.view.goTo({target:a,scale:l?o:void 0}),oe.active=!1,oe.disabled=!1,e.zoomToLocation=null,l&&(e.location=c)}))).apply(this,arguments)}function me(){return(me=Object(G.a)((function*(e){var{selectedFeature:t,view:r}=e;if("2d"!==(null==r?void 0:r.type)){var i=new H.a("zoomToCluster:invalid-view","View must be 2d MapView.",{view:r});throw de.error(i),i}if(!t.isAggregate){var n=new H.a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:t});throw de.error(n),n}var a=t.sourceLayer,s=yield r.whenLayerView(a),o=s.createQuery();o.aggregateIds=[t.getObjectId()],le.active=!0,le.disabled=!0;var{extent:c}=yield s.queryExtent(o);yield r.goTo({target:c}),le.active=!1,le.disabled=!1}))).apply(this,arguments)}function ve(){return(ve=Object(G.a)((function*(e){var{selectedFeature:t,view:r}=e;if("2d"!==(null==r?void 0:r.type)){var i=new H.a("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:r});throw de.error(i),i}if(!t.isAggregate){var n=new H.a("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:t});throw de.error(n),n}var a=t.sourceLayer,s=yield r.whenLayerView(a),o=s.createQuery();o.aggregateIds=[t.getObjectId()];var{extent:c}=yield s.queryExtent(o);e.selectedClusterBoundaryFeature.geometry=c,r.graphics.add(e.selectedClusterBoundaryFeature)}))).apply(this,arguments)}function ge(){return(ge=Object(G.a)((function*(e){var{selectedFeature:t,view:r}=e;if("2d"!==(null==r?void 0:r.type)){var i=new H.a("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:r});throw de.error(i),i}if(!t.isAggregate){var n=new H.a("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:t});throw de.error(n),n}var a=t.sourceLayer,s=yield r.whenLayerView(a),o=s.createQuery();o.aggregateIds=[t.getObjectId()],ue.active=!0,ue.disabled=!0;var{features:c}=yield s.queryFeatures(o);ue.active=!1,ue.disabled=!1,e.features=[t].concat(c)}))).apply(this,arguments)}var ye=r(501),Oe=d.a.ofType({key:"type",defaultKeyValue:"button",base:Z.a,typeMap:{button:X.a,toggle:Y.a}}),je="esri.widgets.Popup.PopupViewModel",_e=n.a.getLogger(je),we=class extends(Object(ye.a)(D)){constructor(e){super(e),this._handles=new w.a,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.featuresPerPage=20,this.actions=new Oe,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new K.a({symbol:new Q.a({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([Object(c.a)(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),Object(c.d)(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),Object(c.d)(this,"view.animation.state",(e=>this._animationStateChange(e))),Object(c.d)(this,"location",(e=>this._locationChange(e))),Object(c.d)(this,"selectedFeature",(e=>this._selectedFeatureChange(e))),Object(c.d)(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),Object(c.d)(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),Object(c.d)(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>he({event:e,view:this.view}))),Object(c.f)(this,"waitingForResult",(()=>this._waitingForResultChange())),Object(c.d)(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),Object(c.d)(this,["view.scale"],this._viewScaleChange),Object(c.f)(this,"visible",(()=>this.browseClusterEnabled=!1)),Object(c.d)(this,"browseClusterEnabled",(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){var e=this._get("allActions")||new Oe;e.removeAll();var{actions:t,defaultActions:r,defaultPopupTemplateEnabled:i,includeDefaultActions:n,selectedFeature:a}=this,s=n?r.concat(t):t,o=a&&("function"==typeof a.getEffectivePopupTemplate&&a.getEffectivePopupTemplate(i)||a.popupTemplate),c=o&&o.actions,l=o&&o.overwriteActions?c:c?c.concat(s):s;return l&&l.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){var e,t=this._get("defaultActions")||new Oe;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?[le.clone(),ue.clone()]:[oe.clone()]),t}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){var t=e||[];this._set("features",t);var{pendingPromisesCount:r,promiseCount:i,selectedFeatureIndex:n}=this,a=i&&t.length;a&&r&&-1===n?this.selectedFeatureIndex=0:a&&-1!==n||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){var t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=Object(W.b)(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);e.then((t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e)}),(()=>this._updatePendingPromises(e)))})),this.notifyChange("pendingPromisesCount")}get selectedFeature(){var{features:e,selectedFeatureIndex:t}=this;return-1===t?null:e[t]||null}get selectedFeatureIndex(){var e=this._get("selectedFeatureIndex");return"number"==typeof e?e:-1}set selectedFeatureIndex(e){var{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){var{view:e}=this,t=pe(this);if(!t){var r=new H.a("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return _e.error(r),Promise.reject(r)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null})}fetchFeatures(e,t){var{view:r}=this;if(!r||!e){var i=new H.a("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:r});return _e.error(i),Promise.reject(i)}return r.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){var t=Object(m.a)(Object(m.a)({updateLocationEnabled:!1,promises:[],fetchFeatures:!1},e),{},{visible:!0}),{fetchFeatures:r}=t;delete t.fetchFeatures,r&&this._setFetchFeaturesPromises(t.location),this.set(t)}triggerAction(e){var t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){var e;(e=this).features=e.features.filter((e=>e.isAggregate)),this._clearBrowsedClusterGraphics()}enableClusterBrowsing(){var e=this;return Object(G.a)((function*(){yield function(e){return ve.apply(this,arguments)}(e),yield function(e){return ge.apply(this,arguments)}(e)}))()}_animationStateChange(e){this.zoomToLocation||(oe.disabled="waiting-for-target"===e)}_clearBrowsedClusterGraphics(){var e,t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){var e;(null!=(e=this.selectedFeature)&&e.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1)}_locationChange(e){var{selectedFeature:t,updateLocationEnabled:r}=this;r&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){var{features:e,featureCount:t,featurePage:r,featuresPerPage:i,featureViewModels:n}=this;if(null!==r){var a=((r-1)*i+t)%t,s=a+i;n.slice(a,s).forEach(((t,r)=>{t&&!t.graphic&&(t.graphic=e[a+r])}))}}_selectedFeatureChange(e){var t=this;return Object(G.a)((function*(){if(e){var{location:r,updateLocationEnabled:i,view:n}=t;if(t.browseClusterEnabled){if(t._selectedClusterFeature&&(n.graphics.remove(t._selectedClusterFeature),t._selectedClusterFeature=null),e.isAggregate)return;return e.symbol=yield Object(te.a)(e),t._selectedClusterFeature=e,void n.graphics.add(t._selectedClusterFeature)}!i&&r||!e.geometry?i&&!e.geometry&&t.centerAtLocation().then((()=>{t.location=n.center.clone()})):t.location=Object(v.q)(t._getPointFromGeometry(e.geometry))}}))()}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{var{clientOnlyGraphics:t,promisesPerLayerView:r}=e,i=Promise.resolve(t),n=r.map((e=>e.promise));this.promises=[i,...n]}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[])}_updateFeatureVMs(){var{selectedFeature:e,features:t,featureViewModels:r}=this;if(null!=e&&e.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),t&&t.length){var i=r.slice(0),n=[];t.forEach(((t,r)=>{if(t){var a=null;if(i.some(((e,r)=>(e&&e.graphic===t&&(a=e,i.splice(r,1)),!!a))),a)n[r]=a;else{var s,o,c=new ee.a({defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(s=this.view)?void 0:s.spatialReference,graphic:t===e?t:null,map:null==(o=this.view)?void 0:o.map,view:this.view});n[r]=c}}})),i.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",n)}}_getScreenPoint(e){var{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){var e="auto-fetch-features",{_handles:t,autoOpenEnabled:r}=this;if(t.remove(e),r&&this.view){var i=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e)}),re.b.WIDGET);t.add(i,e)}}_cancelFetchingFeatures(){var e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();var r=Object(R.d)(),{signal:i}=r;this._fetchFeaturesController=r,this.notifyChange("waitingForResult");var n=this.fetchFeatures(e,{signal:i,event:t});return n.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")})),n}_fetchFeaturesAndOpen(e){var{screenPoint:t,mapPoint:r}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{var{clientOnlyGraphics:t,promisesPerLayerView:n,location:a}=e,s=[Promise.resolve(t),...n.map((e=>e.promise))];return i.popup.open({location:a||r,promises:s}),e}))}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){return Object(v.j)(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}_getLayerView(e,t){return Object(G.a)((function*(){return yield e.when(),e.whenLayerView(t)}))()}_highlightFeature(){var e=this;return Object(G.a)((function*(){var t="highlight";e._handles.remove(t);var{selectedFeature:r,highlightEnabled:i,view:n,visible:a}=e;if(r&&n&&i&&a){var{layer:s,sourceLayer:o}=r;if(s&&s instanceof $.a){"map-notes"===(null==o?void 0:o.type)&&(s=o);var c=e._getLayerView(n,s);e._highlightPromise=c;var l=yield c;if(l&&Object(ie.a)(l)&&e._highlightPromise===c&&e.selectedFeature&&e.highlightEnabled&&e.visible){var u="objectIdField"in s&&s.objectIdField,d=r.attributes,h=d&&u&&d[u],p=l.highlight(h||r);e._handles.add(p,t)}}}}))()}_updateFeatures(e){var{features:t}=this;if(e&&e.length)if(t.length){var r=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(r)}else this.features=e}};Object(i.a)([Object(a.b)()],we.prototype,"featurePage",void 0),Object(i.a)([Object(a.b)()],we.prototype,"featuresPerPage",void 0),Object(i.a)([Object(a.b)()],we.prototype,"isLoadingFeature",null),Object(i.a)([Object(a.b)({type:Oe})],we.prototype,"actions",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"active",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"allActions",null),Object(i.a)([Object(a.b)({type:Boolean})],we.prototype,"defaultPopupTemplateEnabled",void 0),Object(i.a)([Object(a.b)()],we.prototype,"autoCloseEnabled",void 0),Object(i.a)([Object(a.b)()],we.prototype,"autoOpenEnabled",void 0),Object(i.a)([Object(a.b)()],we.prototype,"browseClusterEnabled",void 0),Object(i.a)([Object(a.b)()],we.prototype,"content",void 0),Object(i.a)([Object(a.b)({type:Oe,readOnly:!0})],we.prototype,"defaultActions",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"featureCount",null),Object(i.a)([Object(a.b)()],we.prototype,"features",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"featureViewModels",void 0),Object(i.a)([Object(a.b)()],we.prototype,"highlightEnabled",void 0),Object(i.a)([Object(a.b)()],we.prototype,"includeDefaultActions",void 0),Object(i.a)([Object(a.b)({type:J.a})],we.prototype,"location",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"pendingPromisesCount",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"selectedClusterBoundaryFeature",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"waitingForResult",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"promiseCount",null),Object(i.a)([Object(a.b)()],we.prototype,"promises",null),Object(i.a)([Object(a.b)({value:null,readOnly:!0})],we.prototype,"selectedFeature",null),Object(i.a)([Object(a.b)({value:-1})],we.prototype,"selectedFeatureIndex",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"selectedFeatureViewModel",null),Object(i.a)([Object(a.b)({readOnly:!0})],we.prototype,"state",null),Object(i.a)([Object(a.b)()],we.prototype,"title",void 0),Object(i.a)([Object(a.b)()],we.prototype,"updateLocationEnabled",void 0),Object(i.a)([Object(a.b)()],we.prototype,"view",void 0),Object(i.a)([Object(a.b)()],we.prototype,"visible",void 0),Object(i.a)([Object(a.b)()],we.prototype,"zoomFactor",void 0),Object(i.a)([Object(a.b)()],we.prototype,"zoomToLocation",void 0),Object(i.a)([Object(a.b)()],we.prototype,"centerAtLocation",null);var xe=we=Object(i.a)([Object(s.a)(je)],we),Se="selected-index",Me="popup-spinner",Te="esri-icon-left-triangle-arrow",Ee="esri-icon-right-triangle-arrow",Pe="esri-icon-maximize",Ce="esri-icon-dock-bottom",Ie="esri-icon-dock-left",Ae="esri-icon-dock-right",Re="esri-icon-close",Fe="esri-icon-minimize",Le="esri-icon-check-mark",De="esri-icon-loading-indicator",ke="esri-icon-default-action",ze="esri-icon-handle-horizontal",Ve="esri-rotating",Ne="esri-popup",Ue="esri-widget",Be="esri-popup__main-container",qe="esri-popup__loading-container",Ge="esri-popup--is-collapsible",He="esri-popup--is-collapsed",We="esri-popup--shadow",Je="esri-popup--is-docked",Ze="esri-popup--is-docked-top-left",Xe="esri-popup--is-docked-top-center",Ye="esri-popup--is-docked-top-right",Qe="esri-popup--is-docked-bottom-left",Ke="esri-popup--is-docked-bottom-center",$e="esri-popup--is-docked-bottom-right",et="esri-popup--aligned-top-center",tt="esri-popup--aligned-bottom-center",rt="esri-popup--aligned-top-left",it="esri-popup--aligned-bottom-left",nt="esri-popup--aligned-top-right",at="esri-popup--aligned-bottom-right",st="esri-popup--feature-menu-open",ot="esri-popup--actions-menu-open",ct="esri-popup--feature-updated",lt="esri-popup__header",ut="esri-popup__header-buttons",dt="esri-popup__header-container",ht="esri-popup__header-container--button",pt="esri-popup__header-title",ft="esri-popup__content",bt="esri-popup__footer",mt="esri-popup__footer--has-pagination",vt="esri-popup__footer--has-actions",gt="esri-popup__footer--has-actions-menu",yt="esri-popup__button",Ot="esri-popup__button--disabled",jt="esri-popup__button--dock",_t="esri-popup__icon",wt="esri-popup__icon--dock-icon",xt="esri-popup__inline-actions-container",St="esri-popup__actions-menu-button",Mt="esri-popup__actions",Tt="esri-popup__action",Et="esri-popup__action-image",Pt="esri-popup__action-text",Ct="esri-popup__action-toggle",It="esri-popup__action-toggle--on",At="esri-popup__pointer",Rt="esri-popup__pointer-direction",Ft="esri-popup__navigation",Lt="esri-popup__pagination-previous",Dt="esri-popup__pagination-next",kt="esri-popup__pagination-previous-icon",zt="esri-popup__pagination-previous-icon--rtl",Vt="esri-popup__pagination-next-icon",Nt="esri-popup__pagination-next-icon--rtl",Ut="esri-popup__feature-menu",Bt="esri-popup__feature-menu-list",qt="esri-popup__feature-menu-item",Gt="esri-popup__feature-menu-viewport",Ht="esri-popup__feature-menu-header",Wt="esri-popup__feature-menu-item--selected",Jt="esri-popup__feature-menu-button",Zt="esri-popup__feature-menu-title",Xt="esri-popup__feature-menu-observer",Yt="esri-popup__feature-menu-loader",Qt={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},Kt="esri-popup";function $t(e,t){return void 0===t?"".concat(Kt,"__").concat(e):"".concat(Kt,"__").concat(e,"-").concat(t)}var er="esri.widgets.Popup",tr=n.a.getLogger(er),rr={closeButton:!0,featureNavigation:!0},ir=class extends(Object(I.a)(C.a)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new w.a,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([e])=>{null!=e&&e.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=Object(x.a)((()=>this._displaySpinner()),0),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new xe,this.visible=null,this.visibleElements=Object(m.a)({},rr),this._addSelectedFeatureIndexHandle(),this.own([Object(c.d)(this,"viewModel.screenLocation",(()=>this._positionContainer())),Object(c.d)(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),Object(c.d)(this,"viewModel.screenLocation",((e,t)=>{!!e!=!!t&&this.reposition()})),Object(c.d)(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),Object(c.d)(this,"spinnerEnabled",(e=>this._spinnerEnabledChange(e))),Object(c.d)(this,"viewModel.view.size",((e,t)=>this._updateDockEnabledForViewSize(e,t))),Object(c.d)(this,"viewModel.view",((e,t)=>this._viewChange(e,t))),Object(c.d)(this,"viewModel.view.ready",((e,t)=>this._viewReadyChange(e,t))),Object(c.d)(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled()})),Object(c.d)(this,"selectedFeatureWidget.viewModel.title",(e=>this._setTitleFromFeatureWidget(e))),Object(c.d)(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],(()=>this._setContentFromFeatureWidget())),Object(c.f)(this,"collapsed",(()=>{var e,t;"xsmall"===(null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()})),Object(c.b)(this,"viewModel.allActions","change",(()=>this._watchActions())),Object(c.a)(this,"viewModel.allActions",(()=>this._watchActions())),Object(c.d)(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))])}destroy(){var e,t;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(e=this._handles)||e.destroy(),this._unobserveFeatureMenuObserver(),null==(t=this._featureMenuIntersectionObserver)||t.disconnect(),this._handles=null}get actionsMenuId(){return"".concat(this.id,"-actions-menu")}get actionsMenuButtonId(){return"".concat(this.id,"-actions-menu-button")}get featureMenuId(){return"".concat(this.id,"-feature-menu")}get titleId(){return"".concat(this.id,"-popup-title")}get contentId(){return"".concat(this.id,"-popup-content")}get hasContent(){var e,t,r,i,n;return!!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||(null==(r=this.selectedFeatureWidget)||null==(i=r.viewModel)?void 0:i.content):null==(n=this.viewModel)?void 0:n.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||Qt}set dockOptions(e){var t=Object(m.a)({},Qt),r=this.get("viewModel.view.breakpoints"),i={};r&&(i.width=r.xsmall,i.height=r.xsmall);var n=Object(m.a)(Object(m.a)({},t),e),a=Object(m.a)(Object(m.a)({},t.breakpoint),i),{breakpoint:s}=n;!0===s?n.breakpoint=a:"object"==typeof s&&(n.breakpoint=Object(m.a)(Object(m.a)({},a),s)),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition()}set featureNavigationEnabled(e){Object(O.c)(tr,"featureNavigationEnabled",{replacement:"visibleElements.featureNavigation",version:"4.15"}),this.visibleElements=Object(m.a)(Object(m.a)({},this.visibleElements),{},{featureNavigation:e})}get selectedFeatureWidget(){var{_feature:e,visibleElements:t}=this,{selectedFeatureViewModel:r}=this.viewModel,i=Object(m.a)(Object(m.a)({},t),{},{title:!1});return r?(e?(e.viewModel=r,e.visibleElements=i):this._feature=new A.a({viewModel:r,visibleElements:i}),this._feature):null}castVisibleElements(e){return Object(m.a)(Object(m.a)({},rr),e)}blur(){var{active:e}=this.viewModel;e||tr.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){var{active:e}=this.viewModel;e||tr.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var t,r;this._handles.remove(Se);var i=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,a={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:i};"xsmall"===(null==(t=this.viewModel)||null==(r=t.view)?void 0:r.widthBreakpoint)&&(a.collapsed=!0),this.set(a),this.viewModel.open(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){this.viewModel.triggerAction(e)}render(){var e,t,r,i,{actionsMenuOpen:n,dockEnabled:a,featureMenuVisible:s,dividedActions:o,currentAlignment:c,currentDockPosition:l}=this,{active:u}=this.viewModel,{menuActions:d}=o,h=u&&d.length>1&&n,p=u&&a,f=u&&!a,b=null==(e=this.selectedFeature)||null==(t=e.layer)?void 0:t.title,m=null==(r=this.selectedFeature)||null==(i=r.layer)?void 0:i.id,v={[et]:"top-center"===c,[tt]:"bottom-center"===c,[rt]:"top-left"===c,[it]:"bottom-left"===c,[nt]:"top-right"===c,[at]:"bottom-right"===c,[Je]:p,[We]:f,[Ze]:"top-left"===l,[Xe]:"top-center"===l,[Ye]:"top-right"===l,[Qe]:"bottom-left"===l,[Ke]:"bottom-center"===l,[$e]:"bottom-right"===l,[st]:s,[ot]:h};return Object(P.a)("div",{class:this.classes(Ne,v),role:"presentation","data-layer-title":b,"data-layer-id":m,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},u?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return Object(P.a)("span",{"aria-hidden":"true",class:this.classes(_t,De,Ve)})}renderNavigationLoading(){var{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?Object(P.a)("div",{key:$t("loading-container"),role:"presentation",class:qe,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){var e=Object(S.f)(),t={[Ee]:e,[zt]:e,[Te]:!e,[kt]:!e};return Object(P.a)("span",{"aria-hidden":"true",class:this.classes(_t,t)})}renderPreviousButton(){var{messages:e}=this;return Object(P.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(yt,Lt),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){var e=Object(S.f)(),t={[Te]:e,[Nt]:e,[Ee]:!e,[Vt]:!e};return Object(P.a)("span",{"aria-hidden":"true",class:this.classes(_t,t)})}renderNextButton(){var{messages:e}=this;return Object(P.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(yt,Dt),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){var{featureMenuOpen:e,featureMenuId:t,messagesCommon:r}=this,{featureCount:i,selectedFeatureIndex:n}=this.viewModel;return Object(P.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(yt,Jt),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":r.menu,title:r.menu},this._getPageText(i,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){var{dockEnabled:e}=this,t=this._wouldDockTo(),r={[Fe]:e,[wt]:!e,[Ae]:!e&&("top-right"===t||"bottom-right"===t),[Ie]:!e&&("top-left"===t||"bottom-left"===t),[Pe]:!e&&"top-center"===t,[Ce]:!e&&"bottom-center"===t};return Object(P.a)("span",{"aria-hidden":"true",class:this.classes(r,_t)})}renderDockButton(){var e,t,r,{dockEnabled:i,messages:n}=this,a=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,s=i?n.undock:n.dock;return"xsmall"!==a&&null!=(r=this.dockOptions)&&r.buttonEnabled?Object(P.a)("div",{role:"button","aria-label":s,title:s,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(yt,jt)},this.renderDockIcon()):null}renderTitle(){var{title:e}=this.viewModel,{titleId:t,collapsible:r,contentCollapsed:i,messagesCommon:n}=this,a={[ht]:r},s=Object(P.a)("h2",{class:pt,innerHTML:e}),o=r?Object(P.a)("button",{key:"".concat(e,"--collapsible"),id:t,title:i?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(dt,a),"aria-expanded":i?"false":"true",onclick:this._toggleCollapsed},s):Object(P.a)("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(dt,a)},s);return e?o:null}renderCloseIcon(){return Object(P.a)("span",{"aria-hidden":"true",class:this.classes(_t,Re)})}renderCloseButton(){var{visibleElements:e,messagesCommon:t}=this;return e.closeButton?Object(P.a)("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:yt,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return Object(P.a)("header",{class:lt},this.renderTitle(),Object(P.a)("div",{class:ut},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){var{contentId:e,hasContent:t,contentCollapsed:r}=this,{content:i}=this.viewModel;return t&&!r?Object(P.a)("article",{key:i,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:ft},this.renderContent()):null}renderActionsMenuButton(){var{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:r,dividedActions:i,messagesCommon:n}=this,a=r?n.close:n.open,{menuActions:s}=i;return s.length?Object(P.a)("div",{key:$t("actions-menu-button"),class:this.classes(yt,St),role:"button",id:t,"aria-haspopup":"true","aria-controls":r?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},Object(P.a)("span",{"aria-hidden":"true",class:ze})):null}renderMenuActions(){var{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:r,dividedActions:i}=this,{menuActions:n,inlineActions:a}=i;return n.length&&r?Object(P.a)("ul",{id:e,role:"menu","aria-labelledby":t,key:$t("actions"),class:Mt,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((e,t)=>this.renderAction({action:e,index:t+a.length,type:"menu-item"})))):null}renderInlineActions(){var{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(((e,t)=>this.renderAction({action:e,index:t,type:"inline"})))}renderInlineActionsContainer(){var{inlineActions:e,menuActions:t}=this.dividedActions,r=!!e.length,i=!!t.length;return r||i?Object(P.a)("div",{key:"inline-actions-container","data-inline-actions":r.toString(),"data-menu-actions":i.toString(),class:xt},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?Object(P.a)("section",{key:$t("navigation"),class:this.classes(Ft)},this.renderNavigationButtons()):null}renderFooter(){var{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:r,menuActions:i}=t,n=!!r.length,a=!!i.length,s={[mt]:e,[vt]:n,[gt]:a};return e||n?Object(P.a)("div",{key:$t("feature-buttons"),class:this.classes(bt,s)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){var{messages:e}=this,{featureViewModels:t,isLoadingFeature:r}=this.viewModel,i=Object(_.a)(e.selectedFeatures,{total:t.length});return Object(P.a)("section",{key:$t("menu"),class:Ut},Object(P.a)("h2",{class:Ht},i),Object(P.a)("nav",{bind:this,class:Gt,"data-node-ref":"_featureMenuViewportNode",afterCreate:S.i},this.renderFeatureMenu(),Object(P.a)("div",{class:Xt,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),r?Object(P.a)("div",{class:Yt},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:Object(P.a)("div",{key:$t("pointer"),class:At,role:"presentation"},Object(P.a)("div",{class:this.classes(Rt,We)}))}renderMainContainer(){var{dockEnabled:e,currentAlignment:t,currentDockPosition:r,titleId:i,contentId:n,collapsible:a,hasContent:s,contentCollapsed:o,visibleElements:c}=this,{title:l}=this.viewModel,u="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===r||"top-center"===r||"top-right"===r,d="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===r||"bottom-center"===r||"bottom-right"===r,h={[We]:e,[Ge]:a,[He]:o};return Object(P.a)("div",{class:this.classes(Be,Ue,h),tabIndex:c.closeButton?null:-1,role:"dialog","aria-labelledby":l?i:"","aria-describedby":s&&!o?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},u?this.renderFooter():null,u?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null)}renderContent(){var e,t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?Object(P.a)("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}renderActionText(e){return Object(P.a)("span",{key:"text",class:Pt},e)}renderActionIcon(e){var t=this._getActionClass(e),r=this._getActionImage(e),i={[De]:e.active,[Ve]:e.active,[_t]:!!t,[Et]:!e.active&&!!r};return t&&(i[t]=!e.active),Object(P.a)("span",{key:"icon","aria-hidden":"true",class:this.classes(_t,i),styles:this._getIconStyles(r)})}renderAction(e){var{action:t,index:r,type:i}=e,n=this._getActionTitle(t),a={[Tt]:"toggle"!==t.type,[Ct]:"toggle"===t.type,[It]:"toggle"===t.type&&t.value,[Ot]:t.disabled},s=[this.renderActionIcon(t),this.renderActionText(n)],o="menu-item"===i?Object(P.a)("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(yt,a),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":r,onclick:this._triggerAction,onkeydown:this._triggerAction},s):Object(P.a)("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(yt,a),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":r,onclick:this._triggerAction,onkeydown:this._triggerAction},s);return t.visible?o:null}renderFeatureMenuItem(e,t){var{messages:r,messagesCommon:i}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:a}=this.viewModel,s=e===a,o={[Wt]:s},c=s?Object(P.a)("span",{key:$t("feature-menu-selected-feature-".concat(n)),title:r.selectedFeature,"aria-label":r.selectedFeature,class:Le}):null,l=Object(P.a)("span",{innerHTML:e.title||i.untitled});return Object(P.a)("li",{role:"menuitem",tabIndex:-1,key:$t("feature-menu-feature-".concat(n)),class:this.classes(o,qt),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},Object(P.a)("span",{class:Zt},l,c))}renderFeatureMenu(){var{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?Object(P.a)("ol",{class:Bt,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter((e=>!!e.graphic)).map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){var{messages:t,selectedFeature:r,messagesCommon:i}=this,{id:n}=e,a=null==r?void 0:r.attributes,s="zoom-to-feature"===n?Object(_.a)(e.title,{messages:t}):"remove-selected-feature"===n?Object(_.a)(e.title,{messages:i}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?Object(_.a)(e.title,{messages:t}):e.title;return s&&a?Object(_.a)(s,a):s}_getActionClass(e){var{selectedFeature:t}=this,r=null==t?void 0:t.attributes,{className:i,image:n}=e,a=n||i?i:ke;return a&&r?Object(_.a)(a,r):a}_getActionImage(e){var{selectedFeature:t}=this,r=null==t?void 0:t.attributes,{image:i}=e;return i&&r?Object(_.a)(i,r):i}_createFeatureUpdatedAnimation(){return Object(S.b)("enter",ct)}_getInlineActionCount(){var{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;var r=Math.round(e);return Math.max(t?r-1:r,0)}_watchActions(){var{allActions:e}=this.viewModel;this.notifyChange("dividedActions");var t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(Object(c.d)(e,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),t)}))}_divideActions(){var{allActions:e}=this.viewModel,t=this._getInlineActionCount(),r=null===t,i=0===t;return{inlineActions:r?e.slice(0):i?new d.a:e.slice(0,t),menuActions:r?new d.a:i?e.slice(0):e.slice(t)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(e){var{selectedFeatureWidget:t}=this;t&&(this.viewModel.title=e||"")}_setContentFromFeatureWidget(){var{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){"Escape"===Object(j.a)(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){"Escape"===Object(j.a)(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_handleFeatureMenuItemKeyup(e){var t=Object(j.a)(e),{_featureMenuNode:r}=this,i=e.currentTarget["data-feature-index"];if(r){var n=r.querySelectorAll("li"),a=n.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),n[n.length-1].focus()):(e.stopPropagation(),n[0].focus()):(e.stopPropagation(),n[(i+1+a)%a].focus()):(e.stopPropagation(),n[(i-1+a)%a].focus())}}_handleActionMenuItemKeyup(e){var t=Object(j.a)(e),{_actionsMenuNode:r}=this,i=e.currentTarget["data-action-index"];if(r){var n=r.querySelectorAll("li"),a=n.length;"ArrowUp"!==t?"ArrowDown"!==t?"Home"!==t?"End"!==t||(e.stopPropagation(),n[n.length-1].focus()):(e.stopPropagation(),n[0].focus()):(e.stopPropagation(),n[(i+1+a)%a].focus()):(e.stopPropagation(),n[(i-1+a)%a].focus())}}_handleMainKeyup(e){var t=Object(j.a)(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),e){var t=this.get("viewModel.view");this._createSpinner(t)}}_hideSpinner(){var{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){var{_spinner:e}=this;if(e){var{location:t,waitingForResult:r}=this.viewModel;r?e.show({location:t}):e.hide()}}_getIconStyles(e){return{"background-image":e?"url(".concat(e,")"):""}}_addSelectedFeatureIndexHandle(){var e=Object(c.d)(this,"viewModel.selectedFeatureIndex",((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,Se)}_selectedFeatureIndexUpdated(e,t){var{featureCount:r}=this;r&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1)}_destroySelectedFeatureWidget(){var{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){var{popupHeight:t,popupWidth:r,screenLocation:i,side:n,view:a}=e;if(isNaN(r)||isNaN(t)||!a||!i)return!1;var s=a.padding;return"right"===n&&i.x+r/2>a.width-s.right||"left"===n&&i.x-r/2<s.left||"top"===n&&i.y-t<s.top||"bottom"===n&&i.y+t>a.height-s.bottom}_calculateAutoAlignment(e){if("auto"!==e)return e;var{_pointerOffsetInPx:t,_containerNode:r,_mainContainerNode:i,viewModel:n}=this,{screenLocation:a,view:s}=n;if(Object(v.j)(a)||!s||!r)return"top-center";if(!this._isScreenLocationWithinView(a,s))return this._get("currentAlignment")||"top-center";function o(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}var c=i?window.getComputedStyle(i,null):null,l=c?o(c.getPropertyValue("max-height")):0,u=c?o(c.getPropertyValue("height")):0,{height:d,width:h}=r.getBoundingClientRect(),p=h+t,f=Math.max(d,l,u)+t,b=this._isOutsideView({popupHeight:f,popupWidth:p,screenLocation:a,side:"right",view:s}),m=this._isOutsideView({popupHeight:f,popupWidth:p,screenLocation:a,side:"left",view:s}),g=this._isOutsideView({popupHeight:f,popupWidth:p,screenLocation:a,side:"top",view:s}),y=this._isOutsideView({popupHeight:f,popupWidth:p,screenLocation:a,side:"bottom",view:s});return m?g?"bottom-right":"top-right":b?g?"bottom-left":"top-left":g?y?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return"function"==typeof e?e.call(this):e}_getCurrentAlignment(){var{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){var t=["left","right"];return Object(S.f)()&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return"function"==typeof e?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var t;if("auto"!==e)return e;var r=null==(t=this.viewModel)?void 0:t.view,i=Object(S.f)()?"top-left":"top-right";if(!r)return i;var n=r.padding||{left:0,right:0,top:0,bottom:0},a=r.width-n.left-n.right,{breakpoints:s}=r;return s&&a<=s.xsmall?"bottom-center":i}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),e){var{screenLocation:t}=this.viewModel,{width:r}=e.getBoundingClientRect(),i=this._calculatePositionStyle(t,r);i&&(e.style.top=i.top,e.style.left=i.left,e.style.bottom=i.bottom,e.style.right=i.right)}}_calculateFullWidth(e){var{currentAlignment:t,_pointerOffsetInPx:r}=this;return"top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+r:e}_calculateAlignmentPosition(e,t,r,i){var{currentAlignment:n,_pointerOffsetInPx:a}=this,s=i/2,o=r.height-t,c=r.width-e,{padding:l}=this.view;return"bottom-center"===n?{top:t+a-l.top,left:e-s-l.left}:"top-left"===n?{bottom:o+a-l.bottom,right:c+a-l.right}:"bottom-left"===n?{top:t+a-l.top,right:c+a-l.right}:"top-right"===n?{bottom:o+a-l.bottom,left:e+a-l.left}:"bottom-right"===n?{top:t+a-l.top,left:e+a-l.left}:"top-center"===n?{bottom:o+a-l.bottom,left:e-s-l.left}:void 0}_calculatePositionStyle(e,t){var{dockEnabled:r,view:i}=this;if(i){if(r)return{left:"",top:"",right:"",bottom:""};if(!Object(v.j)(e)&&t){var n=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,i,n);return a?{top:void 0!==a.top?"".concat(a.top,"px"):"auto",left:void 0!==a.left?"".concat(a.left,"px"):"auto",bottom:void 0!==a.bottom?"".concat(a.bottom,"px"):"auto",right:void 0!==a.right?"".concat(a.right,"px"):"auto"}:void 0}}}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){var r=this.get("viewModel.view");this._wireUpView(r)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),e){var{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}}_dockingThresholdCrossed(e,t,r){var[i,n]=e,[a,s]=t,{width:o,height:c}=r;return i<=o&&a>o||i>o&&a<=o||n<=c&&s>c||n>c&&s<=c}_updateDockEnabledForViewSize(e,t){if(e&&t){var r=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},i=r.left+r.right,n=r.top+r.bottom,a=[],s=[];a[0]=e[0]-i,a[1]=e[1]-n,s[0]=t[0]-i,s[1]=t[1]-n;var{dockOptions:o}=this,c=o.breakpoint;this._dockingThresholdCrossed(a,s,c)&&this._setDockEnabledForViewSize(o),this._setCurrentDockPosition()}}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,e&&this._focusFirstFeature){this._focusFirstFeature=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,e&&this._focusFirstAction){this._focusFirstAction=!1;var t=e.querySelectorAll("li");t.length&&t[0].focus()}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){var{dockEnabled:e,viewModel:t}=this;if(t){var r=t.active&&!e;t.screenLocationEnabled=r}}_shouldDockAtCurrentViewSize(e){var t,r,i=e.breakpoint,n=null==(t=this.viewModel)||null==(r=t.view)?void 0:r.ui;if(!n)return!1;var{width:a,height:s}=n;if(isNaN(a)||isNaN(s))return!1;var o=i.hasOwnProperty("width")&&a<=i.width,c=i.hasOwnProperty("height")&&s<=i.height;return o||c}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?Object(_.a)(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){var{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,Me),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new q({view:e}),e.ui.add(this._spinner,{key:Me,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){var e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){var e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){var t=e.currentTarget["data-action-index"],r=this.viewModel.allActions.getItemAt(t);r&&"toggle"===r.type&&(r.value=!r.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t)}_selectFeature(e){var t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"actionsMenuId",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"actionsMenuButtonId",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"featureMenuId",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"titleId",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"contentId",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"hasContent",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"featureNavigationVisible",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"collapsible",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"featureMenuVisible",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"contentCollapsed",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"dividedActions",null),Object(i.a)([Object(g.a)("viewModel.actions")],ir.prototype,"actions",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"actionsMenuOpen",null),Object(i.a)([Object(a.b)()],ir.prototype,"alignment",void 0),Object(i.a)([Object(g.a)("viewModel.autoCloseEnabled")],ir.prototype,"autoCloseEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.autoOpenEnabled")],ir.prototype,"autoOpenEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.defaultPopupTemplateEnabled")],ir.prototype,"defaultPopupTemplateEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.content")],ir.prototype,"content",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"collapsed",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"collapseEnabled",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"currentAlignment",null),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"currentDockPosition",null),Object(i.a)([Object(a.b)()],ir.prototype,"dockOptions",null),Object(i.a)([Object(a.b)()],ir.prototype,"dockEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.featureCount")],ir.prototype,"featureCount",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"featureMenuOpen",void 0),Object(i.a)([Object(g.a)("viewModel.features")],ir.prototype,"features",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"featureNavigationEnabled",null),Object(i.a)([Object(g.a)("viewModel.goToOverride")],ir.prototype,"goToOverride",void 0),Object(i.a)([Object(g.a)("viewModel.highlightEnabled")],ir.prototype,"highlightEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.location")],ir.prototype,"location",void 0),Object(i.a)([Object(a.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],ir.prototype,"label",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"maxInlineActions",void 0),Object(i.a)([Object(a.b)(),Object(T.a)("esri/widgets/Popup/t9n/Popup")],ir.prototype,"messages",void 0),Object(i.a)([Object(a.b)(),Object(T.a)("esri/t9n/common")],ir.prototype,"messagesCommon",void 0),Object(i.a)([Object(g.a)("viewModel.promises")],ir.prototype,"promises",void 0),Object(i.a)([Object(g.a)("viewModel.selectedFeature")],ir.prototype,"selectedFeature",void 0),Object(i.a)([Object(g.a)("viewModel.selectedFeatureIndex")],ir.prototype,"selectedFeatureIndex",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],ir.prototype,"selectedFeatureWidget",null),Object(i.a)([Object(a.b)()],ir.prototype,"spinnerEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.title")],ir.prototype,"title",void 0),Object(i.a)([Object(g.a)("viewModel.updateLocationEnabled")],ir.prototype,"updateLocationEnabled",void 0),Object(i.a)([Object(g.a)("viewModel.view")],ir.prototype,"view",void 0),Object(i.a)([Object(a.b)({type:xe}),Object(E.a)(["triggerAction","trigger-action"])],ir.prototype,"viewModel",void 0),Object(i.a)([Object(g.a)("viewModel.visible")],ir.prototype,"visible",void 0),Object(i.a)([Object(a.b)()],ir.prototype,"visibleElements",void 0),Object(i.a)([Object(y.a)("visibleElements")],ir.prototype,"castVisibleElements",null),Object(i.a)([Object(M.a)()],ir.prototype,"_close",null),Object(i.a)([Object(M.a)()],ir.prototype,"_toggleDockEnabled",null),Object(i.a)([Object(M.a)()],ir.prototype,"_toggleFeatureMenu",null),Object(i.a)([Object(M.a)()],ir.prototype,"_toggleActionsMenu",null),Object(i.a)([Object(M.a)()],ir.prototype,"_triggerAction",null),Object(i.a)([Object(M.a)()],ir.prototype,"_selectFeature",null),Object(i.a)([Object(M.a)()],ir.prototype,"_next",null),Object(i.a)([Object(M.a)()],ir.prototype,"_previous",null);var nr=ir=Object(i.a)([Object(s.a)(er)],ir),ar=[0,0];function sr(e){e&&(Object(l.b)(e),e.parentNode&&e.parentNode.removeChild(e))}var or=750,cr=e=>{var t=class extends e{constructor(...e){super(...e),this._freqInfo={freq:16,time:or},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(e=>{var t=this.surface;t&&t.setAttribute("data-cursor",e)})),this.watch("interacting",(e=>{var t=this.surface;t&&t.setAttribute("data-interacting",e.toString())}))])}initialize(){this.handles.add(this.watch("ui",((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}set container(e){var t=this._get("container");if(t!==e){var r="dom-size";if(this.handles.remove(r),this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),sr(this.root),this._set("root",null),Object(l.e)(this.userContent,t),sr(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");var i=document.createElement("div");i.className="esri-view-user-storage",Object(l.e)(e,i),e.appendChild(i),this._set("userContent",i);var n=document.createElement("div");n.className="esri-view-root",e.insertBefore(n,e.firstChild),this._set("root",n);var a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,n.appendChild(a),this._set("surface",a);var s=new b;n.appendChild(s.surface),this._set("overlay",s),s.watch("needsRender",(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Object(o.a)({render:()=>{this.overlay.render()}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null)})),this.forceDOMReadyCycle(),this.handles.add(Object(c.a)(this,"size",(e=>{var[t,r]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||r>=document.body.clientHeight?a.classList.add(i):a.classList.remove(i)})),r),this._set("container",e),this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}}get focused(){var e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new nr({view:this})}set popup(e){var t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(e,t,r){var i=this.position;return e-=i[0],t-=i[1],r?(r[0]=e,r[1]=t):r=[e,t],r}containerToPage(e,t,r){var i=this.position;return e+=i[0],t+=i[1],r?(r[0]=e,r[1]=t):r=[e,t],r}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e)}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([Object(c.a)(this,"root",(t=>{e.container=t?function(e){var t=document.createElement("div");return e.appendChild(t),t}(t):null})),Object(c.a)(this,"popup",((t,r)=>{var i="popup";r&&e.remove(r,i),t&&(t.view=e.view,e.add(t,{key:i,position:"manual"}))}))],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){var e=this._freqInfo;e.freq=16,e.time=or,this.handles.add([(()=>{var t=()=>{e.freq=16,e.time=or};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t)}}})(),Object(o.a)({prepare:e=>{var t=this._measure(),r=this._freqInfo;if(r.time+=e.deltaTime,t&&(r.freq=16,this._get("resizing")||this._set("resizing",!0)),!(r.time<r.freq)){r.time=0;var i=this._position();r.freq=i||t?16:Math.min(or,2*r.freq),!t&&r.freq>=512&&this._get("resizing")&&this._set("resizing",!1)}}})],"measuring"),this._measure(),this._position()}_measure(){var e=this.container,t=e?e.clientWidth:0,r=e?e.clientHeight:0;if(0===t||0===r)return this.suspended||this._set("suspended",!0),!1;var i=this.width,n=this.height;return t===i&&r===n?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",r),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:n,width:t,height:r}),!0)}_position(){var e=this.container,t=this.position,r=function(e){var t=(e.ownerDocument||window.document).defaultView,r=e.getBoundingClientRect();return ar[0]=r.left+t.pageXOffset,ar[1]=r.top+t.pageYOffset,ar}(e);return(!t||r[0]!==t[0]||r[1]!==t[1])&&(this._set("position",[r[0],r[1]]),!0)}forceDOMReadyCycle(){}};return Object(i.a)([Object(a.b)({value:null,cast:e=>Object(l.a)(e)})],t.prototype,"container",null),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"focused",null),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"height",void 0),Object(i.a)([Object(a.b)({type:nr})],t.prototype,"popup",null),Object(i.a)([Object(a.b)({type:b})],t.prototype,"overlay",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"position",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"resizing",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"root",void 0),Object(i.a)([Object(a.b)({value:null,readOnly:!0})],t.prototype,"size",null),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"surface",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"suspended",void 0),Object(i.a)([Object(a.b)()],t.prototype,"ui",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"userContent",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],t.prototype,"width",void 0),Object(i.a)([Object(a.b)()],t.prototype,"widthBreakpoint",void 0),t=Object(i.a)([Object(s.a)("esri.views.DOMContainer")],t)};function lr(e){return e&&"focus"in e}},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return s}));r(80);function i(e){switch(e){case"u8":return 1;case"u16":return 2;case"u32":return 4;case"i8":return 1;case"i16":return 2;case"i32":case"f32":return 4;case"f64":return 8;default:return}}function n(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function a(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function s(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},function(e,t,r){"use strict";function i(e,t,r){for(var i=0;i<r;++i)t[2*i]=e[i],t[2*i+1]=e[i]-t[2*i]}function n(e,t,r,n){for(var o=0;o<n;++o)a[0]=e[o],i(a,s,1),t[o]=s[0],r[o]=s[1]}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var a=new Float64Array(1),s=new Float32Array(2)},function(e,t,r){"use strict";function i(){var e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}r.d(t,"a",(function(){return i}));var n=i();Object.freeze({__proto__:null,create:i,clone:function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},fromValues:function(e,t,r,i,n,a,s,o,c,l,u,d,h,p,f,b){var m=new Float32Array(16);return m[0]=e,m[1]=t,m[2]=r,m[3]=i,m[4]=n,m[5]=a,m[6]=s,m[7]=o,m[8]=c,m[9]=l,m[10]=u,m[11]=d,m[12]=h,m[13]=p,m[14]=f,m[15]=b,m},createView:function(e,t){return new Float32Array(e,t,16)},IDENTITY:n})},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i,n=r(120),a=r(119);function s(e){e.attributes.add("position","vec2"),e.varyings.add("uv","vec2"),e.vertex.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    void main(void) {\n      gl_Position = vec4(position, 0.0, 1.0);\n      uv = position * 0.5 + vec2(0.5);\n    }\n  "]))))}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return a}));var i=r(89),n=r(327);function a(e){return"array"in e}function s(e,t,r="ground"){if(Object(n.c)(t))return e.getElevation(t.x,t.y,t.z||0,t.spatialReference,r);if(a(t)){var s=t.offset;return e.getElevation(t.array[s++],t.array[s++],t.array[s]||0,Object(i.r)(t.spatialReference,e.spatialReference),r)}return e.getElevation(t[0],t[1],t[2]||0,e.spatialReference,r)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return p}));r(89);var i=r(276),n=r(411),a=r(110),s=(r(104),r(157),r(125),r(223)),o=(r(174),r(202)),c=(r(200),r(191),r(279),r(327)),l=r(480);function u(e,t){if("point"===e.type)return h(e,t,!1);if(Object(l.c)(e))switch(e.type){case"extent":return h(e.center,t,!1);case"polygon":return h(e.centroid,t,!1);case"polyline":return h(d(e),t,!0);case"mesh":return h(e.extent.center,t,!1)}else switch(e.type){case"extent":return h(function(e){var t=Object(a.j)(e.zmin);return Object(c.d)(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),t?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return h(function(e){var t=e.rings[0];if(!t||0===t.length)return null;var r=Object(n.b)(e.rings,e.hasZ);return Object(c.d)(r[0],r[1],r[2],e.spatialReference)}(e),t,!0);case"polyline":return h(d(e),t,!0)}}function d(e){var t=e.paths[0];if(!t||0===t.length)return null;var r=Object(i.f)(t,Object(i.e)(t)/2);return Object(c.d)(r[0],r[1],r[2],e.spatialReference)}function h(e,t,r){var i=r?e:Object(l.a)(e);return t&&e?Object(s.n)(e,i,t)?i:null:i}function p(e,t){for(var r=0;r<e.geometries.length;++r){var i=e.geometries[r].getMutableAttribute("auxpos1");i&&i.data[3]!==t&&(i.data[3]=t,e.geometryVertexAttrsUpdated(r))}}Object(o.e)(0,0),Object(o.e)(.5,0),Object(o.e)(1,0),Object(o.e)(0,.5),Object(o.e)(.5,.5),Object(o.e)(1,.5),Object(o.e)(0,1),Object(o.e)(.5,1),Object(o.e)(1,1)},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return s}));var i=r(368),n=r(491),a=Object(i.a)().vec3f("position"),s=Object(i.a)().vec3f("position").vec2f("uv0"),o=Object(i.a)().vec3f("position").vec4u8("color");class c{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get("position").length}write(e,t,r,i){Object(n.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i)}}},,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return a}));for(var i=r(80),n=r(165),a=Object(i.a)("mac")?"Meta":"Ctrl",s={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"},o=48;o<58;o++)s[o]=String.fromCharCode(o);for(var c=1;c<25;c++)s[111+c]="F".concat(c);for(var l=65;l<91;l++)s[l]=[String.fromCharCode(l+32),String.fromCharCode(l)];function u(e){if(void 0!==e.key)return Object(n.a)(e);var t=s[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}function d(e){switch(e){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}},function(e,t,r){"use strict";function i(e){return 32+e.length}function n(e){if(!e)return 0;var t=32;for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];switch(typeof n){case"string":t+=i(n);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function a(e,t){return 32+e.length*t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i,n,a,s,o=r(120),c=r(119);function l(e,t){e.constants.add("stippleAlphaColorDiscard","float",.001),e.constants.add("stippleAlphaHighlightDiscard","float",.5),t.stippleEnabled?function(e,t){e.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),t.stippleUVMaxEnabled&&e.varyings.add("stipplePatternUvMax","float"),e.varyings.add("stipplePatternUv","float"),e.fragment.uniforms.add("stipplePatternTexture","sampler2D"),t.stippleOffColorEnabled&&e.fragment.uniforms.add("stippleOffColor","vec4"),e.fragment.code.add(Object(c.a)(i||(i=Object(o.a)(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),t.stippleUVMaxEnabled?"stipplePatternUvClamped = clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":"")),t.stippleOffColorEnabled?e.fragment.code.add(Object(c.a)(n||(n=Object(o.a)(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "])))):e.fragment.code.add(Object(c.a)(a||(a=Object(o.a)(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "]))))}(e,t):function(e){e.fragment.code.add(Object(c.a)(s||(s=Object(o.a)(["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "]))))}(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(189);class n{constructor(e){this.channel=e,this.id=Object(i.a)()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return b}));var i,n,a=r(180),s=r(89),o=r(104),c=r(157),l=r(223),u=r(174),d=r(327),h=r(583),p=r(584);function f(e,t,r,i,n,a,s,o,c,u,d){var h,p,f=v[d.mode],b=0;if(Object(l.k)(e,t,r,i,c.spatialReference,n,o))return f.requiresAlignment(d)?(b=f.applyElevationAlignmentBuffer(i,n,a,s,o,c,u,d),h=a,p=s):(h=i,p=n),Object(l.k)(h,c.spatialReference,p,a,u.spatialReference,s,o)?b:void 0}function b(e,t,r,i,n){var o=(Object(d.c)(e)?e.z:Object(h.b)(e)?e.array[e.offset+2]:e[2])||0;switch(r.mode){case"on-the-ground":var c=Object(s.r)(Object(h.a)(t,e,"ground"),0);return n&&(n.verticalDistanceToGround=0,n.sampledElevation=c),c;case"relative-to-ground":var l=Object(s.r)(Object(h.a)(t,e,"ground"),0),u=r.geometryZWithOffset(o,i);return n&&(n.verticalDistanceToGround=u,n.sampledElevation=l),u+l;case"relative-to-scene":var p=Object(s.r)(Object(h.a)(t,e,"scene"),0),f=r.geometryZWithOffset(o,i);return n&&(n.verticalDistanceToGround=f,n.sampledElevation=p),f+p;case"absolute-height":var b=r.geometryZWithOffset(o,i);if(n){var m=Object(s.r)(Object(h.a)(t,e,"ground"),0);n.verticalDistanceToGround=b-m,n.sampledElevation=m}return b;default:return Object(a.a)(r.mode),0}}function m(e,t,r,i,n){var a=b(t,r,n,i,y);Object(p.b)(e,y.verticalDistanceToGround);var s=y.sampledElevation,o=Object(c.c)(g,e.transformation);return O[0]=t.x,O[1]=t.y,O[2]=a,Object(l.d)(t.spatialReference,O,o,i.spatialReference)?e.transformation=o:console.warn("Could not locate symbol object properly, it might be misplaced"),s}(n=i||(i={}))[n.NONE=0]="NONE",n[n.UPDATE=1]="UPDATE",n[n.RECREATE=2]="RECREATE";var v={"absolute-height":{applyElevationAlignmentBuffer:function(e,t,r,i,n,a,s,o){var c=o.calculateOffsetRenderUnits(s),l=o.featureExpressionInfoContext;t*=3,i*=3;for(var u=0;u<n;++u){var d=e[t+0],h=e[t+1],p=e[t+2];r[i+0]=d,r[i+1]=h,r[i+2]=null==l?p+c:c,t+=3,i+=3}return 0},requiresAlignment:function(e){var t=e.meterUnitOffset,r=e.featureExpressionInfoContext;return 0!==t||null!=r}},"on-the-ground":{applyElevationAlignmentBuffer:function(e,t,r,i,n,a){var o=0,c=a.spatialReference;t*=3,i*=3;for(var l=0;l<n;++l){var u=e[t+0],d=e[t+1],h=e[t+2],p=Object(s.r)(a.getElevation(u,d,h,c,"ground"),0);o+=p,r[i+0]=u,r[i+1]=d,r[i+2]=p,t+=3,i+=3}return o/n},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(e,t,r,i,n,a,o,c){var l=0,u=c.calculateOffsetRenderUnits(o),d=c.featureExpressionInfoContext,h=a.spatialReference;t*=3,i*=3;for(var p=0;p<n;++p){var f=e[t+0],b=e[t+1],m=e[t+2],v=Object(s.r)(a.getElevation(f,b,m,h,"ground"),0);l+=v,r[i+0]=f,r[i+1]=b,r[i+2]=null==d?m+v+u:v+u,t+=3,i+=3}return l/n},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(e,t,r,i,n,a,o,c){var l=0,u=c.calculateOffsetRenderUnits(o),d=c.featureExpressionInfoContext,h=a.spatialReference;t*=3,i*=3;for(var p=0;p<n;++p){var f=e[t+0],b=e[t+1],m=e[t+2],v=Object(s.r)(a.getElevation(f,b,m,h,"scene"),0);l+=v,r[i+0]=f,r[i+1]=b,r[i+2]=null==d?m+v+u:v+u,t+=3,i+=3}return l/n},requiresAlignment:()=>!0}},g=Object(u.b)(),y={verticalDistanceToGround:0,sampledElevation:0},O=Object(o.e)()},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var i=r(180),n=r(89),a=r(126),s=r(113),o=(r(101),r(131)),c=r(110),l=r(105),u=r(104),d=r(111),h=r(173),p=r(157),f=r(125),b=r(223),m=r(332),v=r(174),g=r(305),y=r(135),O=r(583),j=r(177),_=r(255),w=r(453),x=r(698),S=r(480),M=r(509);class T{constructor(e){for(var t in this.idHint=0,this.camera=new x.a,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=Object(v.b)(),this._worldFrame=null,this._renderLocation=Object(u.e)(),this._renderLocationDirty=!0,this._location=new s.a({x:0,y:0,z:0}),this._elevationAlignedLocation=new s.a,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=0,this._focused=!1,this.events=new o.a.EventEmitter,this._screenLocation={screenPointArray:Object(l.g)(),renderScreenPointArray:Object(l.e)(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference,e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:Object(a.d)((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){E(e)&&(this._screenLocationDirty=!0),Object(p.c)(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=Object(v.b)()),function(e,t,r){switch(e.viewingMode){case"local":return Object(p.i)(r),!0;case"global":var i=Object(h.e)(e.renderCoordsHelper.spatialReference);Object(b.t)(t,0,D,0,i.radius),Object(b.c)(Object(c.f)(D[1]),Object(c.f)(D[0]),r)}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){Object(S.a)(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){Object(S.a)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;var e=Object(n.k)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=this.location.spatialReference,this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this.ensureScreenLocation(),this._screenLocation}ensureScreenLocation(){if(this._screenLocationDirty){var e;if(this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,E(this._modelTransform)){var t=this._calculateModelTransformOffset(U);e=Object(d.e)(t,t,this.renderLocation)}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}intersectionDistance(e,t){if(!this.available)return null;var r=Object(l.j)(e,P),a=this._getCollisionRadius(t),s=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(Object(y.j)(this.screenLocation.screenPointArray,r)<a*a)return this.screenLocation.renderScreenPointArray[2]+s;break;case"line":var o=this.collisionType.paths,c=this._getWorldToScreenObjectScale(),h=this._calculateObjectTransform(c,F),p=a*this.screenLocation.pixelSize,f=_.f.fromScreen(this.camera,r,I);if(Object(n.j)(f))return null;for(var b of o)if(0!==b.length)for(var m=Object(d.l)(D,b[0],h),v=1;v<b.length;v++){var O=Object(d.l)(k,b[v],h),w=_.d.closestRayDistance2(_.d.fromPoints(m,O,C),f);if(null!=w&&w<p*p){var x=Object(d.e)(j.d.get(),m,O);Object(d.d)(x,x,.5);var S=Object(l.a)(j.d.get());return this.camera.projectToRenderScreen(x,S),S[2]+s}Object(d.j)(m,O)}break;case"disc":var M,T=this.collisionType.direction,E=null!=(M=this.collisionType.offset)?M:u.b,R=this._getWorldToScreenObjectScale(),U=this._calculateObjectTransform(R,F),B=a*this.screenLocation.pixelSize,q=_.f.fromScreen(this.camera,r,I);if(Object(n.j)(q))return null;var G=Object(g.d)(A,U),H=Object(d.w)(V,T,G),W=Object(d.l)(N,E,U);_.e.fromPositionAndNormal(W,H,L);var J=z;if(_.e.intersectRay(L,q,J)&&Object(d.k)(J,W)<B*B)return this.screenLocation.renderScreenPointArray[2]+s;break;case"ribbon":var{paths:Z,direction:X}=this.collisionType,Y=this._getWorldToScreenObjectScale(),Q=this._calculateObjectTransform(Y,F),K=a*this.camera.computeScreenPixelSizeAt(this.renderLocation),$=_.f.fromScreen(this.camera,r,I);if(Object(n.j)($))return null;var ee=Object(g.d)(A,Q),te=Object(d.w)(V,X,ee),re=this._calculateModelTransformPosition(N);_.e.fromPositionAndNormal(re,te,L);var ie=z;if(!_.e.intersectRay(L,$,ie))break;for(var ne of Z)if(0!==ne.length)for(var ae=Object(d.l)(D,ne[0],Q),se=1;se<ne.length;se++){var oe=Object(d.l)(k,ne[se],Q),ce=_.d.distance2(_.d.fromPoints(ae,oe,C),ie);if(null!=ce&&ce<K*K){var le=Object(d.e)(j.d.get(),ae,oe);Object(d.d)(le,le,.5);var ue=Object(l.a)(j.d.get());return this.camera.projectToRenderScreen(le,ue),ue[2]+s}Object(d.j)(ae,oe)}break;default:Object(i.a)(this.collisionType)}return null}attach(e={manipulator3D:{}}){var t;if(this.view._stage){var r=e.manipulator3D;if(Object(n.j)(r.engineLayerId)){var i=new M.a({isPickable:!1});this.view._stage.add(i),r.engineLayerId=i.id,this._engineLayer=i}else null!=(t=this.view._stage)&&t.getObject&&(this._engineLayer=this.view._stage.getObject(r.engineLayerId));r.engineLayerReferences=(r.engineLayerReferences||0)+1,this._materialIdReferences=r.materialIdReferences,Object(n.j)(this._materialIdReferences)&&(this._materialIdReferences=new Map,r.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),Object(b.b)(this._location.spatialReference,this.view.spatialReference)||(this.location=new s.a({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}}detach(e={manipulator3D:{}}){var t=e.manipulator3D;t.engineLayerReferences--;var r=0===t.engineLayerReferences;r&&(t.engineLayerId=null),this._removeResourcesFromStage(r),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){Object(b.n)(this.location,B,e.spatialReference),Object(f.f)(e.extent,B)&&(this.location=this._location)}_evaluateElevationAlignment(e=this.location){if(Object(n.j)(this.elevationInfo))return!1;var t=null,r=0,i=Object(n.r)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=Object(n.r)(Object(O.a)(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":r=Object(n.r)(Object(O.a)(this.view.elevationProvider,e,"ground"),0)+i;break;case"relative-to-scene":r=Object(n.r)(Object(O.a)(this.view.elevationProvider,e,"scene"),0)+i;break;case"absolute-height":r=i}return(r!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=r,this._elevation.override=t,!0)}_updateEngineObject(){if(this._attached)if(this.available){var e=this._getWorldToScreenObjectScale(),t=F;if(!0===this.autoScaleRenderObjects){var r=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(r,t)}else this._calculateObjectTransform(e,t);var{objectsByState:i}=this._ensureEngineResources(),a=(this.focused?2:1)|(this.selected?8:4),s=this._noDisplayCount>0;for(var{stateMask:o,objects:c}of i)if(s)for(var l of c)l.setVisible(!1);else{var u=!(0!=(15&o))||(a&o)==(15&o),d=!(0!=(65520&o))||(this.state&o)==(65520&o);if(u&&d)for(var h of c)h.setVisible(!0),h.transformation=t;else for(var p of c)p.setVisible(!1)}Object(n.k)(this._engineLayer)&&this._engineLayer.commit()}else this._removeResourcesFromStage()}_ensureEngineResources(){if(Object(n.j)(this._engineResources)){var e=Object(n.q)(this._engineLayer),t=[],r=new Set;this.renderObjects.forEach((({material:e})=>{r.has(e)||(t.push(e),r.add(e))}));var i=new Map;this._renderObjects.forEach((e=>{var t=new w.a({castShadow:!1});((e,t)=>{var{geometry:r,material:i,transform:n}=t;Array.isArray(r)?r.forEach((t=>e.addGeometry(t,i,n))):e.addGeometry(r,i,n)})(t,e);var r=e.stateMask||0,n=i.get(r)||[];n.push(t),i.set(r,n)}));var a=[];i.forEach(((e,t)=>a.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:a,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(!this._engineResourcesAddedToStage&&!Object(n.j)(this._engineResources)){var{objectsByState:e,layer:t,materials:r}=this._engineResources;r.forEach((e=>{var t=Object(n.q)(this._materialIdReferences),r=t.get(e.id)||0;0===r&&this.view._stage.add(e),t.set(e.id,r+1)})),e.forEach((({objects:e})=>e.forEach((e=>{t.add(e),this.view._stage.add(e)})))),this._engineResourcesAddedToStage=!0}}_removeResourcesFromStage(e=!1){if(this._engineResourcesAddedToStage&&!Object(n.j)(this._engineResources)){var{objectsByState:t,layer:r,materials:i}=this._engineResources;t.forEach((({objects:e})=>{r.removeMany(e),this.view._stage.removeMany(e)})),i.forEach((e=>{var t=Object(n.q)(this._materialIdReferences),r=t.get(e.id);1===r?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,r-1)})),e&&this.view._stage.remove(r),this._engineResourcesAddedToStage=!1}}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){var t=this._getWorldToScreenObjectScale(),r=this._calculateObjectTransform(t,R);return Object(d.v)(e,r[12],r[13],r[14])}_calculateModelTransformOffset(e){var t=this._calculateModelTransformPosition(e);return Object(d.i)(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return Object(p.d)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&Object(p.l)(t,t,this._worldFrame),Object(p.l)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,Object(n.k)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){var e=!1;if(Object(n.k)(this._engineResources))for(var t in this._engineResources.objectsByState){var r=this._engineResources.objectsByState[t];for(var i of r.objects)if(i.isVisible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function E(e){return 0!==e[12]||0!==e[13]||0!==e[14]}var P=Object(l.g)(),C=_.d.create(),I=_.f.create(),A=Object(m.a)(),R=Object(v.b)(),F=Object(v.b)(),L=_.e.create(),D=Object(u.e)(),k=Object(u.e)(),z=Object(u.e)(),V=Object(u.e)(),N=Object(u.e)(),U=Object(u.e)(),B=new s.a({x:0,y:0,z:0,spatialReference:null})},function(e,t,r){"use strict";r.d(t,"a",(function(){return J}));var i=r(89),n=r(104),a=r(111),s=r(255),o=r(517),c=r(506),l=r(110),u=r(202),d=r(200),h=r(191),p=r(179),f=r(523),b=r(328),m=r(82),v=r(157),g=r(174),y=r(300),O=r(307),j=r(313),_=r(286),w=r(267),x=r(616);class S extends O.a{initializeProgram(e){var t=S.shader.get(),r=this.configuration,i=t.build(r);return new _.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),S.attributeLocations)}bind(e,t,r){this.program.setUniform3fv("innerColor",e.innerColor),this.program.setUniform1f("innerWidth",e.innerWidth*r.pixelRatio),this.program.setUniform3fv("glowColor",e.glowColor),this.program.setUniform1f("glowWidth",e.glowWidth*r.pixelRatio),this.program.setUniform1f("glowFalloff",e.glowFalloff),this.program.setUniform1f("globalAlpha",e.globalAlpha),this.program.setUniform1f("perScreenPixelRatio",r.perScreenPixelRatio),this.program.setUniform2f("pixelToNDC",2/r.fullWidth,2/r.fullHeight),this.program.setUniformMatrix4fv("uProjectionMatrix",r.projectionMatrix),Object(v.s)(T,r.viewMatrix,t),this.program.setUniformMatrix4fv("uModelViewMatrix",T),this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=e.globalAlphaContrastBoost?e.globalAlphaContrastBoost:1)}initializePipeline(){return Object(w.d)({blending:Object(w.f)(1,771),colorWrite:w.b})}bindPipelineState(e){e.setPipelineState(this.pipeline)}}S.shader=new y.a(x.a,(()=>r.e(297).then(r.bind(null,1185)))),S.attributeLocations={start:0,end:1,up:2,extrude:3};class M extends j.a{constructor(){super(...arguments),this.contrastControlEnabled=!1}}Object(m.a)([Object(j.b)()],M.prototype,"contrastControlEnabled",void 0);var T=Object(g.b)(),E=(r(80),r(208),r(570)),P=r(368),C=r(325),I=r(326);r(192);class A{constructor(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=Object(n.e)(),this._dirty=!1,this._count=0,this._vao=null}set vertices(e){var t=new Float64Array(3*e.length),r=0;for(var i of e)t[r++]=i[0],t[r++]=i[1],t[r++]=i[2];this.buffers=[t]}set buffers(e){if(this._buffers=e,this._buffers.length>0){var t=this._buffers[0],r=3*Math.floor(t.length/3/2);Object(a.v)(this._origin,t[r+0],t[r+1],t[r+2])}else Object(a.v)(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(e){var t=this.ensureVAO(e);Object(i.k)(t)&&(e.bindVAO(t),e.drawArrays(4,0,this._count))}dispose(){Object(i.k)(this._vao)&&this._vao.dispose()}ensureVAO(e){return Object(i.j)(this._buffers)?null:(Object(i.j)(this._vao)&&(this._vao=this.createVAO(e,this._buffers)),this.ensureVertexData(this._vao,this._buffers),this._vao)}createVAO(e,t){var r=this.createDataBuffer(t);return this._dirty=!1,new I.a(e,S.attributeLocations,{data:Object(E.a)(L)},{data:C.a.createVertex(e,35044,r)})}ensureVertexData(e,t){if(this._dirty){var r=this.createDataBuffer(t);e.vertexBuffers.data.setData(r),this._dirty=!1}}numberOfRenderVertices(e){return 2*(e.length/3-1)*3}createDataBuffer(e){var t=e.reduce(((e,t)=>e+this.numberOfRenderVertices(t)),0);this._count=t;var r=L.createBuffer(t),i=this._origin,n=0,s=0;for(var o of e){for(var c=0;c<o.length;c+=3){var l=Object(a.v)(F,o[c+0],o[c+1],o[c+2]);0===c?s=this._renderCoordsHelper.getAltitude(l):this._renderCoordsHelper.setAltitude(s,l);var u=this._renderCoordsHelper.worldUpAtPosition(l,R),d=n+2*c,h=Object(a.i)(F,l,i);if(c<o.length-3){r.up.setVec(d,u),r.up.setVec(d+3,u),r.up.setVec(d+5,u);for(var p=0;p<6;p++)r.start.setVec(d+p,h);r.extrude.setValues(d+0,0,-1),r.extrude.setValues(d+1,1,-1),r.extrude.setValues(d+2,1,1),r.extrude.setValues(d+3,0,-1),r.extrude.setValues(d+4,1,1),r.extrude.setValues(d+5,0,1)}if(c>0){r.up.setVec(d-2,u),r.up.setVec(d-4,u),r.up.setVec(d-5,u);for(var f=-6;f<0;f++)r.end.setVec(d+f,h)}}n+=this.numberOfRenderVertices(o)}return r.buffer}}var R=Object(n.e)(),F=Object(n.e)(),L=Object(P.a)().vec3f("start").vec3f("end").vec3f("up").vec2f("extrude"),D=r(306);class k extends O.a{initializeProgram(e){var t=k.shader.get(),r=this.configuration,i=t.build(r);return new _.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),D.a)}bind(e,t){this.program.setUniform3fv("innerColor",e.innerColor),this.program.setUniform1f("innerWidth",e.innerWidth*t.pixelRatio),this.program.setUniform3fv("glowColor",e.glowColor),this.program.setUniform1f("glowWidth",e.glowWidth*t.pixelRatio),this.program.setUniform1f("glowFalloff",e.glowFalloff),this.program.setUniform1f("globalAlpha",e.globalAlpha),this.configuration.contrastControlEnabled&&this.program.setUniform1f("globalAlphaContrastBoost",null!=e.globalAlphaContrastBoost?e.globalAlphaContrastBoost:1);var r=null!=e.angleCutoff?e.angleCutoff:c.c;this.program.setUniform2f("angleCutoff",Math.cos(r),Math.cos(Math.max(0,r-Object(l.f)(2)))),this.configuration.intersectsLineEnabled&&this.program.setUniform1f("perScreenPixelRatio",t.perScreenPixelRatio)}initializePipeline(){return Object(w.d)({blending:Object(w.f)(1,771),colorWrite:w.b})}}k.shader=new y.a(c.a,(()=>r.e(298).then(r.bind(null,1186))));class z extends j.a{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1,this.contrastControlEnabled=!1}}Object(m.a)([Object(j.b)()],z.prototype,"heightManifoldEnabled",void 0),Object(m.a)([Object(j.b)()],z.prototype,"pointDistanceEnabled",void 0),Object(m.a)([Object(j.b)()],z.prototype,"lineVerticalPlaneEnabled",void 0),Object(m.a)([Object(j.b)()],z.prototype,"intersectsLineEnabled",void 0),Object(m.a)([Object(j.b)()],z.prototype,"contrastControlEnabled",void 0);var V=Object(n.e)(),N=Object(d.c)(),U={glowColor:[1,.5,0],glowWidth:8,glowFalloff:8,innerColor:[1,1,1],innerWidth:1,globalAlpha:.75,angleCutoff:Object(l.f)(6),globalAlphaContrastBoost:2};function B(e,t,r,i){var n=V,o=N;Object(a.l)(n,t,i),Object(a.j)(o,r),o[3]=0,Object(h.m)(o,o,i),s.e.fromPositionAndNormal(n,o,e)}class q{constructor(e,t={},r={contrastControlEnabled:!1}){this._renderCoordsHelper=e,this._config=r,this._technique=null,this._projInfo=Object(d.c)(),this._zScale=Object(u.a)(),this._heightManifoldEnabled=!1,this._heightManifoldTarget=Object(n.e)(),this._pointDistanceEnabled=!1,this._pointDistanceOrigin=Object(n.e)(),this._pointDistanceTarget=Object(n.e)(),this._lineVerticalPlaneEnabled=!1,this._lineVerticalPlaneSegment=s.d.create(),this._intersectsLineEnabled=!1,this._intersectsLineSegment=s.d.create(),this._intersectsLineRadius=3,this._intersectsLineInfinite=!1,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this.canRender=!0,this._tempNormal=Object(n.e)(),this._tempDir=Object(n.e)(),this._tempUp=Object(n.e)(),this._tempVec3A=Object(n.e)(),this._tempVec3B=Object(n.e)(),this._tempVec4=Object(d.c)(),this._tempPlane=s.e.create(),this._tempSphere=s.g.create(),this._params=Object(b.c)(t,U)}get renderSlots(){return[this._config.contrastControlEnabled?17:16]}get needsLinearDepth(){return!0}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender())}get heightManifoldTarget(){return this._heightManifoldTarget}set heightManifoldTarget(e){Object(a.j)(this._heightManifoldTarget,e),this._requestRender()}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender())}get pointDistanceTarget(){return this._pointDistanceTarget}set pointDistanceTarget(e){Object(a.j)(this._pointDistanceTarget,e),this._requestRender()}get pointDistanceOrigin(){return this._pointDistanceOrigin}set pointDistanceOrigin(e){Object(a.j)(this._pointDistanceOrigin,e),this._requestRender()}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender())}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){s.d.copy(e,this._lineVerticalPlaneSegment),this._requestRender()}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender())}get intersectsLineSegment(){return this._intersectsLineSegment}set intersectsLineSegment(e){s.d.copy(e,this._intersectsLineSegment),this._requestRender()}get intersectsLineRadius(){return this._intersectsLineRadius}set intersectsLineRadius(e){e!==this._intersectsLineRadius&&(this._intersectsLineRadius=e,this._requestRender())}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender())}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,Object(i.k)(this._pathVerticalPlaneData)&&this._requestRender())}set pathVerticalPlaneVertices(e){Object(i.j)(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new A(this._renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender()}set pathVerticalPlaneBuffers(e){Object(i.j)(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new A(this._renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender()}setParameterValues(e){Object(b.f)(this._params,e)&&this._requestRender()}initializeRenderContext(e){this._context=e;var t=e.renderContext.rctx;this._quadVAO=Object(f.b)(t),this._techniqueRepository=e.shaderTechniqueRep,this._techniqueConfig=new z,this._pathTechniqueConfig=new M}uninitializeRenderContext(){this._quadVAO=Object(i.f)(this._quadVAO),this._techniqueRepository.release(this._technique),this._technique=null,this._pathVerticalPlaneData=Object(i.f)(this._pathVerticalPlaneData),this._techniqueRepository.release(this._pathTechnique),this._pathTechnique=null}render(e){var t=this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled,r=this.pathVerticalPlaneEnabled;if(!t&&!r)return!0;var i=e.camera;return Object(p.f)(i.projectionMatrix,i.fullWidth,i.fullHeight,this._projInfo,this._zScale),t&&this.renderUnified(e),r&&this.renderPath(e),!0}renderUnified(e){var t=e.rctx,r=this._selectTechnique(),i=r.program;t.bindProgram(i),r.bindPipelineState(t),this.bindGlobalUniforms(e,i),this.bindHeightManifoldUniforms(e,i),this.bindPointDistanceUniforms(e,i),this.bindLineVerticalPlaneUniforms(e,i),this.bindIntersectsLineUniforms(e,i),r.bind(this._params,e.camera),t.bindVAO(this._quadVAO),t.drawArrays(5,0,4)}renderPath(e){if(!Object(i.j)(this._pathVerticalPlaneData)){this._pathTechniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquireAndReleaseExisting(S,this._pathTechniqueConfig,this._pathTechnique);var t=e.rctx,r=this._pathTechnique,n=r.program;t.bindProgram(n),r.bindPipelineState(t),this.bindGlobalUniforms(e,n),r.bind(this._params,this._pathVerticalPlaneData.origin,e.camera),this._pathVerticalPlaneData.draw(e.rctx)}}bindHeightManifoldUniforms(e,t){if(this.heightManifoldEnabled){var r=this._tempVec3A,i=this._tempPlane;this._renderCoordsHelper.worldUpAtPosition(this._heightManifoldTarget,r),B(i,this._heightManifoldTarget,r,e.camera.viewMatrix),t.setUniform4fv("heightPlane",i)}}bindPointDistanceUniforms(e,t){if(this._pointDistanceEnabled){var r=e.camera,i=this._tempSphere;Object(a.j)(i,this._pointDistanceOrigin),Object(a.l)(i,i,r.viewMatrix),i[3]=Object(a.n)(this._pointDistanceOrigin,this._pointDistanceTarget),t.setUniform4f("pointDistanceSphere",i[0],i[1],i[2],i[3])}}bindLineVerticalPlaneUniforms(e,t){if(this._lineVerticalPlaneEnabled){var r=this._renderCoordsHelper,i=e.camera,n=this._tempPlane,o=this._tempVec3A,c=this._tempUp,l=this._tempDir,u=this._tempNormal;s.d.pointAt(this._lineVerticalPlaneSegment,.5,o),r.worldUpAtPosition(o,c),Object(a.q)(l,this._lineVerticalPlaneSegment.vector),Object(a.f)(u,c,l),Object(a.q)(u,u),B(n,this._lineVerticalPlaneSegment.origin,u,i.viewMatrix),t.setUniform4fv("lineVerticalPlane",n);var d=this._tempVec3A;Object(a.j)(d,this._lineVerticalPlaneSegment.origin),r.setAltitude(0,d),Object(a.l)(d,d,i.viewMatrix),t.setUniform3fv("lineVerticalStart",d);var h=this._tempVec3B;Object(a.e)(h,this._lineVerticalPlaneSegment.origin,this._lineVerticalPlaneSegment.vector),r.setAltitude(0,h),Object(a.l)(h,h,i.viewMatrix),t.setUniform3fv("lineVerticalEnd",h)}}bindIntersectsLineUniforms(e,t){if(this._intersectsLineEnabled){var r=H,i=W;if(this._intersectsLineInfinite){var n=e.camera;if(s.b.fromRay(s.f.wrap(this._intersectsLineSegment.origin,this._intersectsLineSegment.vector),G),G.c0=-Number.MAX_VALUE,!s.c.intersectClipRay(n.frustum,G))return;s.b.getStart(G,r),s.b.getEnd(G,i)}else Object(a.j)(r,this._intersectsLineSegment.origin),Object(a.e)(i,this._intersectsLineSegment.origin,this._intersectsLineSegment.vector);var o=this._tempVec3A;Object(a.l)(o,r,e.camera.viewMatrix),t.setUniform3fv("intersectsLineStart",o);var c=this._tempVec4;Object(a.j)(c,this._intersectsLineSegment.vector),this._tempVec4[3]=0,Object(h.m)(this._tempVec4,this._tempVec4,e.camera.viewMatrix),Object(a.l)(i,i,e.camera.viewMatrix),t.setUniform3fv("intersectsLineEnd",i),Object(a.q)(c,c),t.setUniform3f("intersectsLineDirection",c[0],c[1],c[2]),t.setUniform1f("intersectsLineRadius",this._intersectsLineRadius)}}bindGlobalUniforms(e,t){var r=e.camera;t.setUniform4fv("projInfo",this._projInfo),t.setUniform2fv("zScale",this._zScale),t.setUniform2f("nearFar",r.near,r.far),this._heightManifoldEnabled?t.setUniform1f("maxPixelDistance",2*r.computeScreenPixelSizeAt(this._heightManifoldTarget)):this._pointDistanceEnabled?t.setUniform1f("maxPixelDistance",2*r.computeScreenPixelSizeAt(this._pointDistanceTarget)):this._lineVerticalPlaneEnabled&&t.setUniform1f("maxPixelDistance",2*r.computeScreenPixelSizeAt(this._lineVerticalPlaneSegment.origin)),t.setUniform1i("depthMap",0),e.rctx.bindTexture(e.offscreenRenderingHelper.linearDepthTexture,0),t.setUniform1i("frameColor",1),e.rctx.bindTexture(e.offscreenRenderingHelper.mainColorTexture,1)}_requestRender(){this._context&&this._context.requestRender()}_selectTechnique(){return this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._technique=this._techniqueRepository.acquireAndReleaseExisting(k,this._techniqueConfig,this._technique),this._technique}}var G=s.b.create(),H=Object(n.e)(),W=Object(n.e)();class J extends o.a{constructor(e){super(e.view),this._angleCutoff=c.c,this._style={},this._heightManifoldTarget=Object(n.e)(),this._heightManifoldEnabled=!1,this._intersectsLine=s.d.create(),this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._lineVerticalPlaneSegment=null,this._pathVerticalPlaneBuffers=null,this._pointDistanceLine=null,this.applyProps(e)}get testData(){return this.renderer}createResources(){this.ensureRenderer()}destroyResources(){this.disposeRenderer()}updateVisibility(){this.syncHeightManifold(),this.syncIntersectsLine(),this.syncPathVerticalPlane(),this.syncLineVerticalPlane(),this.syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(e){this._angleCutoff!==e&&(this._angleCutoff=e,this.syncAngleCutoff())}get style(){return this._style}set style(e){this._style=e,this.syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(e){Object(i.k)(e)?(Object(a.j)(this._heightManifoldTarget,e),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this.syncRenderer(),this.syncHeightManifold()}set intersectsWorldUpAtLocation(e){if(Object(i.j)(e))this.intersectsLine=null;else{var t=this.view.renderCoordsHelper.worldUpAtPosition(e,Z);this.intersectsLine=s.d.fromValues(e,t),this.intersectsLineInfinite=!0}}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(e){Object(i.k)(e)?(s.d.copy(e,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this.syncIntersectsLine(),this.syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){this._intersectsLineInfinite=e,this.syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){this._lineVerticalPlaneSegment=Object(i.k)(e)?s.d.copy(e):null,this.syncLineVerticalPlane(),this.syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(e){this._pathVerticalPlaneBuffers=e,this.syncPathVerticalPlane(),this.syncLineVerticalPlane(),this.syncPointDistance(),this.syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(e){this._pointDistanceLine=Object(i.k)(e)?{origin:Object(n.d)(e.origin),target:Object(n.d)(e.target)}:null,this.syncPointDistance(),this.syncRenderer()}syncRenderer(){this.attached&&(this._intersectsLineEnabled||this._heightManifoldEnabled||Object(i.k)(this._pointDistanceLine)||Object(i.k)(this._pathVerticalPlaneBuffers))?this.ensureRenderer():this.disposeRenderer()}ensureRenderer(){Object(i.k)(this.renderer)||(this.renderer=new q(this.view.renderCoordsHelper,void 0,{contrastControlEnabled:!0}),this.syncStyle(),this.syncHeightManifold(),this.syncIntersectsLine(),this.syncIntersectsLineInfinite(),this.syncPathVerticalPlane(),this.syncLineVerticalPlane(),this.syncPointDistance(),this.syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer))}syncStyle(){Object(i.j)(this.renderer)||(this.renderer.setParameterValues(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=this._style.intersectsLineRadius))}syncAngleCutoff(){Object(i.j)(this.renderer)||this.renderer.setParameterValues({angleCutoff:this._angleCutoff})}syncHeightManifold(){Object(i.j)(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget))}syncIntersectsLine(){Object(i.j)(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine))}syncIntersectsLineInfinite(){Object(i.j)(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite)}syncPathVerticalPlane(){Object(i.j)(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=Object(i.k)(this._pathVerticalPlaneBuffers)&&this.visible,Object(i.k)(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}syncLineVerticalPlane(){Object(i.j)(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=Object(i.k)(this._lineVerticalPlaneSegment)&&this.visible,Object(i.k)(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}syncPointDistance(){Object(i.j)(this.renderer)||(this.renderer.pointDistanceEnabled=Object(i.k)(this._pointDistanceLine)&&this.visible,Object(i.k)(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,this.renderer.pointDistanceTarget=this._pointDistanceLine.target))}disposeRenderer(){Object(i.k)(this.renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null)}}var Z=Object(n.e)()},,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return h}));var i=r(93),n=r(99),a=(r(113),r(130)),s=r(141),o=(r(101),r(117)),c=r(529);function l(e){if(!e)return null;if(e.isGeographic&&e.wkid){var t=c.c[e.wkid];if(t)return t}if(e.wkt){var r=c.a.exec(e.wkt);if(!r||2!==r.length)return null;var i=r[1].split(",");if(!i||i.length<3)return null;var n=parseFloat(i[1]),a=parseFloat(i[2]);return isNaN(n)||isNaN(a)?null:{a:n,f:0===a?0:1/a}}return null}function u(e){var t=l(e||n.a.WGS84);if(function(e){return"b"in e&&"eSq"in e&&"radius"in e}(t))return t;var r=t.a*(1-t.f);return Object.assign(t,{b:r,eSq:1-Math.pow(r/t.a,2),radius:(2*t.a+r)/3,densificationRatio:1e4/((2*t.a+r)/3)})}function d(e,t,r){var i,{a:n,eSq:a}=u(r),s=Math.sqrt(a),o=Math.sin(t[1]*c.d),l=n*t[0]*c.d;return i=a>0?n*((1-a)*(o/(1-a*(o*o))-1/(2*s)*Math.log((1-s*o)/(1+s*o))))*.5:n*o,e[0]=l,e[1]=i,e}function h(e){return null!==l(e)}function p(e,t="square-meters"){if(e.some((e=>!h(e.spatialReference))))throw new i.a("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var r=[],n=0;n<e.length;n++){var a=e[n],s=a.spatialReference,{radius:c,densificationRatio:l}=u(s),p=c*l;r.push(b(a,p))}for(var f=[],m=[0,0],v=[0,0],g=0;g<r.length;g++){for(var{rings:y,spatialReference:O}=r[g],j=0,_=0;_<y.length;_++){var w=y[_];d(m,w[0],O),d(v,w[w.length-1],O);for(var x=v[0]*m[1]-m[0]*v[1],S=0;S<w.length-1;S++)d(m,w[S+1],O),d(v,w[S],O),x+=v[0]*m[1]-m[0]*v[1];j+=x}j=Object(o.c)(j,"square-meters",t),f.push(j/-2)}return f}function f(e,t="meters"){var r=e,n=e;if(!r&&!n)throw new i.a("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(r?r.some((e=>!h(e.spatialReference))):n.some((e=>!h(e.spatialReference))))throw new i.a("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var a=[],s=0;s<e.length;s++){for(var c=e[s],{spatialReference:l}=c,u="polyline"===c.type?c.paths:c.rings,d=0,p=0;p<u.length;p++){for(var f=u[p],b=0,m=1;m<f.length;m++){var g=f[m-1][0],y=f[m][0],O=f[m-1][1],j=f[m][1];if(O!==j||g!==y){var _={distance:null};v(_,[g,O],[y,j],l),b+=_.distance}}d+=b}d=Object(o.c)(d,"meters",t),a.push(d)}return a}function b(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new i.a("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");var{spatialReference:r}=e;if(!h(r))throw new i.a("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var n="polyline"===e.type?e.paths:e.rings,o=[],c=[0,0],l={distance:null};for(var u of n){var d=[];o.push(d),d.push([u[0][0],u[0][1]]);for(var p=void 0,f=void 0,b=u[0][0],g=u[0][1],y=0;y<u.length-1;y++)if(p=u[y+1][0],f=u[y+1][1],b!==p||g!==f){var O=[b,g];v(l,[b,g],[p,f],r);var{azimuth:j,distance:_}=l,w=_/t;if(w>1){for(var x=1;x<=w-1;x++)m(c,O,j,x*t,r),d.push(c.slice(0));m(c,O,j,(_+Math.floor(w-1)*t)/2,r),d.push(c.slice(0))}m(c,O,j,_,r),d.push(c.slice(0)),b=c[0],g=c[1]}}return"polyline"===e.type?new s.a({paths:o,spatialReference:r}):new a.a({rings:o,spatialReference:r})}function m(e,t,r,i,n){for(var a,s,o,l=t[0],d=t[1],h=l*c.d,p=d*c.d,f=r*c.d,{a:b,b:m,f:v}=u(n),g=Math.sin(f),y=Math.cos(f),O=(1-v)*Math.tan(p),j=1/Math.sqrt(1+O*O),_=O*j,w=Math.atan2(O,y),x=j*g,S=x*x,M=1-S,T=M*(b*b-m*m)/(m*m),E=1+T/16384*(4096+T*(T*(320-175*T)-768)),P=T/1024*(256+T*(T*(74-47*T)-128)),C=i/(m*E),I=2*Math.PI;Math.abs(C-I)>1e-12;)o=Math.cos(2*w+C),I=C,C=i/(m*E)+P*(a=Math.sin(C))*(o+P/4*((s=Math.cos(C))*(2*o*o-1)-P/6*o*(4*a*a-3)*(4*o*o-3)));var A=_*a-j*s*y,R=Math.atan2(_*s+j*a*y,(1-v)*Math.sqrt(S+A*A)),F=Math.atan2(a*g,j*s-_*a*y),L=v/16*M*(4+v*(4-3*M)),D=R/c.d,k=(h+(F-(1-L)*v*x*(C+L*a*(o+L*s*(2*o*o-1)))))/c.d;return e[0]=k,e[1]=D,e}function v(e,t,r,i){var n,a,s,o,l,d,h,p,f,b,m=t[0]*c.d,v=t[1]*c.d,g=r[0]*c.d,y=r[1]*c.d,{a:O,b:j,f:_,radius:w}=u(i),x=g-m,S=Math.atan((1-_)*Math.tan(v)),M=Math.atan((1-_)*Math.tan(y)),T=Math.sin(S),E=Math.cos(S),P=Math.sin(M),C=Math.cos(M),I=1e3,A=x;do{if(h=Math.sin(A),p=Math.cos(A),0===(s=Math.sqrt(C*h*(C*h)+(E*P-T*C*p)*(E*P-T*C*p))))return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;l=T*P+E*C*p,d=Math.atan2(s,l),o=l-2*T*P/(a=1-(f=E*C*h/s)*f),isNaN(o)&&(o=0),n=A,A=x+(1-(b=_/16*a*(4+_*(4-3*a))))*_*f*(d+b*s*(o+b*l*(2*o*o-1)))}while(Math.abs(A-n)>1e-12&&--I>0);if(0===I){var R=w,F=Math.acos(Math.sin(v)*Math.sin(y)+Math.cos(v)*Math.cos(y)*Math.cos(g-m))*R,L=g-m,D=Math.sin(L)*Math.cos(y),k=Math.cos(v)*Math.sin(y)-Math.sin(v)*Math.cos(y)*Math.cos(L),z=Math.atan2(D,k);return e.azimuth=z/c.d,e.distance=F,e.reverseAzimuth=void 0,e}var V=a*(O*O-j*j)/(j*j),N=V/1024*(256+V*(V*(74-47*V)-128)),U=j*(1+V/16384*(4096+V*(V*(320-175*V)-768)))*(d-N*s*(o+N/4*(l*(2*o*o-1)-N/6*o*(4*s*s-3)*(4*o*o-3)))),B=Math.atan2(C*Math.sin(A),E*P-T*C*Math.cos(A)),q=Math.atan2(E*Math.sin(A),E*P*Math.cos(A)-T*C);return e.azimuth=B/c.d,e.distance=U,e.reverseAzimuth=q/c.d,e}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return G})),r.d(t,"b",(function(){return q}));var i,n,a,s,o,c,l,u,d,h,p,f,b,m,v,g,y,O,j,_,w,x,S,M,T,E,P,C,I=r(120),A=r(119),R=r(254),F=r(358),L=r(249),D=r(308),k=r(333),z=r(280),V=r(627),N=r(490),U=r(599),B=r(551);function q(e){var t=new R.a;t.extensions.add("GL_OES_standard_derivatives"),t.include(B.a),t.include(V.a,e),t.include(U.a,e),1===e.output&&t.include(N.a,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("cameraNearFar","vec2").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2"),t.attributes.add("position","vec3"),t.attributes.add("subdivisionFactor","float"),t.attributes.add("uv0","vec2"),t.attributes.add("auxpos1","vec3"),t.attributes.add("auxpos2","vec3"),t.varyings.add("vColor","vec4"),t.varyings.add("vpos","vec3"),t.varyings.add("linearDepth","float"),e.multipassTerrainEnabled&&t.varyings.add("depth","float");var r=e.falloffEnabled,q=e.innerColorEnabled;return q&&t.varyings.add("vLineDistance","float"),r&&t.varyings.add("vLineDistanceNorm","float"),e.falloffEnabled&&t.fragment.uniforms.add("falloff","float"),e.innerColorEnabled&&(t.fragment.uniforms.add("innerColor","vec4"),t.fragment.uniforms.add("innerWidth","float")),t.vertex.code.add(Object(A.a)(i||(i=Object(I.a)(["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s = sin(a);\n\t\t\tfloat c = cos(a);\n\t\t\tmat2 m = mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"])))),t.vertex.code.add(Object(A.a)(n||(n=Object(I.a)(["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc = proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *= screenSize / posNdc.w;\n      return posNdc;\n    }\n"])))),t.vertex.code.add(Object(A.a)(a||(a=Object(I.a)(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp = cameraNearFar[0] * 0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z > -cameraNearFar[0]) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z < -cameraNearFar[0]) {\n            pos = mix(prev, pos, interp(vnp, prev, pos));\n            next = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z < -cameraNearFar[0]) {\n            pos = mix(pos, next, interp(vnp, pos, next));\n            prev = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z > -cameraNearFar[0]) {\n          prev = mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z > -cameraNearFar[0]) {\n          next = mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      ","\n      linearDepth = (-pos.z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);\n\n      pos = projectAndScale(pos);\n      next = projectAndScale(next);\n      prev = projectAndScale(prev);\n    }\n"])),e.multipassTerrainEnabled?"depth = pos.z;":"")),t.vertex.code.add(Object(A.a)(s||(s=Object(I.a)(["\n  void main(void) {\n    float coverage = 1.0;\n    vpos = position;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y == 0.0) {\n      // Project out of clip space\n      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;\n      bool isJoin = abs(uv0.y)-3.0 < 0.0;\n\n      float lineWidth = getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth < 1.0) {\n        coverage = lineWidth;\n        lineWidth = 1.0;\n      }else{\n        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if\n        // larger than one for better quality. Note that we do render < 1 pixels more or less correctly\n        // so we only really care to round anything larger than 1.\n        lineWidth = floor(lineWidth + 0.5);\n      }\n\n      vec4 pos  = view * vec4(position.xyz, 1.0);\n      vec4 prev = view * vec4(auxpos1.xyz, 1.0);\n      vec4 next = view * vec4(auxpos2.xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left = (pos.xy - prev.xy);\n      vec2 right = (next.xy - pos.xy);\n\n      float leftLen = length(left);\n      float rightLen = length(right);\n  "])))),e.stippleEnabled&&t.vertex.code.add(Object(A.a)(o||(o=Object(I.a)(["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos->next, otherwise use prev->pos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection = stippleSegmentInfo.zw;\n    "])))),t.vertex.code.add(Object(A.a)(c||(c=Object(I.a)(['\n    left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir = vec2(0, 0);\n    vec2 joinDisplacementDir = vec2(0, 0);\n    float displacementLen = lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside = ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir = normalize(left + right);\n      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen > 0.001 && rightLen > 0.001) {\n        float nDotSeg = dot(joinDisplacementDir, left);\n        displacementLen /= length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside && (displacementLen > miterLimit * lineWidth)) {\n    '])))),e.roundJoins?t.vertex.code.add(Object(A.a)(l||(l=Object(I.a)(["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen < 0.001) {\n          startDir = right;\n        }\n        else{\n          startDir = left;\n        }\n        startDir = normalize(startDir);\n        startDir = PERPENDICULAR(startDir);\n\n        if (rightLen < 0.001) {\n          endDir = left;\n        }\n        else{\n          endDir = right;\n        }\n        endDir = normalize(endDir);\n        endDir = PERPENDICULAR(endDir);\n\n        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "])))):t.vertex.code.add(Object(A.a)(u||(u=Object(I.a)(["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen < 0.001) {\n          joinDisplacementDir = right;\n        }\n        else if (rightLen < 0.001) {\n          joinDisplacementDir = left;\n        }\n        else {\n          joinDisplacementDir = isStartVertex ? right : left;\n        }\n        joinDisplacementDir = normalize(joinDisplacementDir);\n        joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n  "])))),t.vertex.code.add(Object(A.a)(d||(d=Object(I.a)(["\n        displacementLen = lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen < 0.001) {\n      joinDisplacementDir = right;\n    }\n    else if (rightLen < 0.001) {\n      joinDisplacementDir = left;\n    }\n    else {\n      joinDisplacementDir = isStartVertex ? right : left;\n    }\n    joinDisplacementDir = normalize(joinDisplacementDir);\n    joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n    displacementLen = lineWidth;\n\n    capDisplacementDir = isStartVertex ? -right : left;\n  "])))),e.roundCaps?t.vertex.code.add(Object(A.a)(h||(h=Object(I.a)(["\n    float angle = subdivisionFactor*PI*0.5;\n    joinDisplacementDir *= cos(angle);\n    capDisplacementDir *= sin(angle);\n    "])))):t.vertex.code.add(Object(A.a)(p||(p=Object(I.a)(["\n    capDisplacementDir *= subdivisionFactor;\n    "])))),t.vertex.code.add(Object(A.a)(f||(f=Object(I.a)(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy += dpos;\n  "])),r||q?Object(A.a)(b||(b=Object(I.a)(["float lineDist = lineWidth * sign(uv0.y) * pos.w;"]))):"",q?Object(A.a)(m||(m=Object(I.a)(["vLineDistance = lineDist;"]))):"",r?Object(A.a)(v||(v=Object(I.a)(["vLineDistanceNorm = lineDist / lineWidth;"]))):"")),e.stippleEnabled&&(t.vertex.code.add(Object(A.a)(g||(g=Object(I.a)(["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec = pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength = length(stippleSegmentDirection);\n    "])))),e.stippleIntegerRepeatsEnabled&&t.vertex.code.add(Object(A.a)(y||(y=Object(I.a)(["\n      float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats = floor(numberOfPatternRepeats);\n      stipplePatternUvMax = roundedNumberOfPatternRepeats;\n      "])))),t.vertex.code.add(Object(A.a)(O||(O=Object(I.a)(["\n      if (stippleSegmentDirectionLength >= 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv = 1.0;\n        }\n      }\n    "])),e.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale = roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale = 1.0;"))),t.vertex.code.add(Object(A.a)(j||(j=Object(I.a)(["\n      // Convert back into NDC\n      pos.xy = pos.xy / screenSize * pos.w;\n\n      vColor = getColor();\n      vColor.a *= coverage;\n\n      gl_Position = pos;\n    }\n  }\n  "])))),e.multipassTerrainEnabled&&(t.fragment.include(D.a),t.include(z.b,e)),t.include(L.a,e),t.fragment.uniforms.add("intrinsicColor","vec4"),t.fragment.include(F.a),t.fragment.code.add(Object(A.a)(_||(_=Object(I.a)(["\n  void main() {\n    discardBySlice(vpos);\n    ","\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);\n\n    vec4 color = intrinsicColor * vColor;\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.innerColorEnabled&&(t.fragment.uniforms.add("pixelRatio","float"),t.fragment.code.add(Object(A.a)(w||(w=Object(I.a)(["\n    float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n    float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);\n    float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);\n    color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n    "]))))),t.fragment.code.add(Object(A.a)(x||(x=Object(I.a)(["\n    vec4 finalColor = blendStipple(color, stippleAlpha);\n  "])))),e.falloffEnabled&&t.fragment.code.add(Object(A.a)(S||(S=Object(I.a)(["\n    finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n    "])))),t.fragment.code.add(Object(A.a)(M||(M=Object(I.a)(["\n    if (finalColor.a < ",") {\n      discard;\n    }\n\n    ","\n    ","\n    ","\n    ","\n    ","\n  }\n  "])),A.a.float(k.c),7===e.output?Object(A.a)(T||(T=Object(I.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(A.a)(E||(E=Object(I.a)(["gl_FragColor = highlightSlice(finalColor, vpos);"]))):"",0===e.output&&e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":"",4===e.output?Object(A.a)(P||(P=Object(I.a)(["gl_FragColor = vec4(1.0);"]))):"",1===e.output?Object(A.a)(C||(C=Object(I.a)(["outputDepth(linearDepth);"]))):"")),t}var G=Object.freeze({__proto__:null,build:q})},function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return l}));var i,n,a=r(120),s=r(119),o=r(254),c=r(525);function l(e){var t=new o.a;return t.include(c.a,e),t.vertex.uniforms.add("uModelViewMatrix","mat4"),t.vertex.uniforms.add("uProjectionMatrix","mat4"),t.attributes.add("start","vec3"),t.attributes.add("end","vec3"),t.attributes.add("up","vec3"),t.attributes.add("extrude","vec2"),t.varyings.add("uv","vec2"),t.varyings.add("vViewStart","vec3"),t.varyings.add("vViewEnd","vec3"),t.varyings.add("vViewPlane","vec4"),t.vertex.uniforms.add("glowWidth","float"),t.vertex.uniforms.add("pixelToNDC","vec2"),t.vertex.code.add(Object(s.a)(i||(i=Object(a.a)(["\n  void main() {\n    vec3 pos = mix(start, end, extrude.x);\n\n    vec4 viewPos = uModelViewMatrix * vec4(pos, 1);\n    vec4 projPos = uProjectionMatrix * viewPos;\n    vec2 ndcPos = projPos.xy / projPos.w;\n\n    vec3 viewUp = (uModelViewMatrix * vec4(extrude.y * up, 0)).xyz;\n    vec4 projPosUp = uProjectionMatrix * vec4(viewPos.xyz + viewUp, 1);\n    vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);\n\n    vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);\n    ndcPos += length(lxy) * projExtrudeDir;\n\n    vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));\n    vec3 viewPlaneNormal = (uModelViewMatrix * vec4(worldPlaneNormal, 0)).xyz;\n\n    vViewStart = (uModelViewMatrix * vec4(start, 1)).xyz;\n    vViewEnd = (uModelViewMatrix * vec4(end, 1)).xyz;\n    vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));\n\n    // Add enough padding in the X screen space direction for glow\n    float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;\n    ndcPos.x += xPaddingPixels * pixelToNDC.x;\n\n    uv = ndcPos * 0.5 + 0.5;\n    gl_Position = vec4(ndcPos, 0, 1);\n  }\n  "])))),t.fragment.uniforms.add("globalAlpha","float"),t.fragment.uniforms.add("perScreenPixelRatio","float"),t.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n  float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {\n    vec3 origin = mix(start, end, 0.5);\n    vec3 basis = end - origin;\n    vec3 posAtOrigin = pos - origin;\n\n    float x = dot(normalize(basis), posAtOrigin);\n    float y = dot(plane.xyz, posAtOrigin);\n\n    float dx = max(abs(x) - length(basis), 0.0);\n    float dy = y;\n\n    float dist = length(vec2(dx, dy));\n\n    float width = fwidth(y);\n    float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;\n    float pixelDist = dist / min(width, maxPixelDistance);\n    return abs(pixelDist);\n  }\n\n  void main() {\n    vec3 pos;\n    vec3 normal;\n    float depthDiscontinuityAlpha;\n\n    if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {\n      discard;\n    }\n\n    float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);\n\n    vec4 color = laserlineProfile(distance);\n    float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));\n\n    gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);\n  }\n  "])))),t}var u=Object.freeze({__proto__:null,build:l})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7}},,function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return w}));var i,n,a,s,o,c,l,u,d=r(120),h=r(119),p=r(413),f=r(254),b=r(358),m=r(249),v=r(308),g=r(322),y=r(333),O=r(280),j=r(490),_=r(518);function w(e){var t=new f.a,r=1===e.output;return t.include(p.a,{linearDepth:r}),t.include(_.a,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.attributes.add("position","vec3"),t.varyings.add("vpos","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),r&&(t.include(j.a,e),t.vertex.uniforms.add("cameraNearFar","vec2"),t.varyings.add("linearDepth","float")),t.vertex.code.add(Object(h.a)(i||(i=Object(d.a)(["\n    void main(void) {\n      vpos = position;\n      forwardNormalizedVertexColor();\n      ","\n      gl_Position = ","\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",r?Object(h.a)(n||(n=Object(d.a)(["transformPositionWithDepth(proj, view, vpos, cameraNearFar, linearDepth);"]))):Object(h.a)(a||(a=Object(d.a)(["transformPosition(proj, view, vpos);"]))))),t.include(m.a,e),t.fragment.include(b.a),e.multipassTerrainEnabled&&(t.fragment.include(v.a),t.include(O.b,e)),t.fragment.uniforms.add("eColor","vec4"),4===e.output&&t.include(g.a),t.fragment.code.add(Object(h.a)(s||(s=Object(d.a)(["\n  void main() {\n    discardBySlice(vpos);\n    ","\n    vec4 color = ","\n\n    if (color.a < ",") {\n      discard;\n    }\n\n    ","\n\n    ","\n    ",";\n    ",";\n  }\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.attributeColor?"vColor * eColor;":"eColor;",h.a.float(y.c),7===e.output?Object(h.a)(o||(o=Object(d.a)(["gl_FragColor = vec4(color.a);"]))):"",0===e.output?Object(h.a)(c||(c=Object(d.a)(["gl_FragColor = highlightSlice(color, vpos); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"",4===e.output?Object(h.a)(l||(l=Object(d.a)(["outputHighlight();"]))):"",1===e.output?Object(h.a)(u||(u=Object(d.a)(["outputDepth(linearDepth);"]))):"")),t}var x=Object.freeze({__proto__:null,build:w})},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i,n,a=r(120),s=r(119),o=r(417);function c(e){e.fragment.include(o.a),e.fragment.uniforms.add("uShadowMapTex","sampler2D"),e.fragment.uniforms.add("uShadowMapNum","int"),e.fragment.uniforms.add("uShadowMapDistance","vec4"),e.fragment.uniforms.add("uShadowMapMatrix","mat4",4),e.fragment.uniforms.add("uDepthHalfPixelSz","float"),e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["\n    int chooseCascade(float _linearDepth, out mat4 mat) {\n      vec4 distance = uShadowMapDistance;\n      float depth = _linearDepth;\n\n      //choose correct cascade\n      int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;\n\n      mat = i == 0 ? uShadowMapMatrix[0] : i == 1 ? uShadowMapMatrix[1] : i == 2 ? uShadowMapMatrix[2] : uShadowMapMatrix[3];\n\n      return i;\n    }\n\n    vec3 lightSpacePosition(vec3 _vpos, mat4 mat) {\n      vec4 lv = mat * vec4(_vpos, 1.0);\n      lv.xy /= lv.w;\n      return 0.5 * lv.xyz + vec3(0.5);\n    }\n\n    vec2 cascadeCoordinates(int i, vec3 lvpos) {\n      return vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n    }\n\n    float readShadowMapDepth(vec2 uv, sampler2D _depthTex) {\n      return rgba2float(texture2D(_depthTex, uv));\n    }\n\n    float posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {\n      return readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;\n    }\n\n    float filterShadow(vec2 uv, vec3 lvpos, float halfPixelSize, sampler2D _depthTex) {\n      float texSize = 0.5 / halfPixelSize;\n\n      // filter, offset by half pixels\n      vec2 st = fract((vec2(halfPixelSize) + uv) * texSize);\n\n      float s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);\n      float s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);\n      float s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);\n      float s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);\n\n      return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n    }\n\n    float readShadowMap(const in vec3 _vpos, float _linearDepth) {\n      mat4 mat;\n      int i = chooseCascade(_linearDepth, mat);\n\n      if (i >= uShadowMapNum) { return 0.0; }\n\n      vec3 lvpos = lightSpacePosition(_vpos, mat);\n\n      // vertex completely outside? -> no shadow\n      if (lvpos.z >= 1.0) { return 0.0; }\n      if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }\n\n      // calc coord in cascade texture\n      vec2 uv = cascadeCoordinates(i, lvpos);\n\n      return filterShadow(uv, lvpos, uDepthHalfPixelSz, uShadowMapTex);\n    }\n  "]))))}(n=c||(c={})).bindUniforms=function(e,t,r){t.shadowMappingEnabled&&(t.shadowMap.bind(e,r),t.shadowMap.bindView(e,t.origin))},n.bindViewCustomOrigin=function(e,t,r){t.shadowMappingEnabled&&t.shadowMap.bindView(e,r)},n.bindView=function(e,t){t.shadowMappingEnabled&&t.shadowMap.bindView(e,t.origin)}},,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var i,n,a,s,o,c,l=r(120),u=r(119);function d(e,t){e.vertex.uniforms.add("intrinsicWidth","float"),t.vvSize?(e.attributes.add("sizeFeatureAttribute","float"),e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.code.add(Object(u.a)(i||(i=Object(l.a)(["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "]))))):(e.attributes.add("size","float"),e.vertex.code.add(Object(u.a)(n||(n=Object(l.a)(["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "]))))),t.vvOpacity?(e.attributes.add("opacityFeatureAttribute","float"),e.vertex.constants.add("vvOpacityNumber","int",8),e.vertex.code.add(Object(u.a)(a||(a=Object(l.a)(["\n    uniform float vvOpacityValues[vvOpacityNumber];\n    uniform float vvOpacityOpacities[vvOpacityNumber];\n\n    float interpolateOpacity( float value ){\n      if (value <= vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i = 1; i < vvOpacityNumber; ++i) {\n        if (vvOpacityValues[i] >= value) {\n          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[vvOpacityNumber - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "]))))):e.vertex.code.add(Object(u.a)(s||(s=Object(l.a)(["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "])))),t.vvColor?(e.attributes.add("colorFeatureAttribute","float"),e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(u.a)(o||(o=Object(l.a)(["\n    uniform float vvColorValues[vvColorNumber];\n    uniform vec4 vvColorColors[vvColorNumber];\n\n    vec4 interpolateColor( float value ) {\n      if (value <= vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i = 1; i < vvColorNumber; ++i) {\n        if (vvColorValues[i] >= value) {\n          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[vvColorNumber - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "]))))):(e.attributes.add("color","vec4"),e.vertex.code.add(Object(u.a)(c||(c=Object(l.a)(["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "])))))}},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(89),n=r(107);class a{constructor(){this._isToolEditable=!0,this._manipulators=new n.a,this._nextManipulatorId=0,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e,t=0){return this.addMany([e],t)[0]}addMany(e,t=0){return e.map((e=>{var r=this._nextManipulatorId++,i={id:r,manipulator:e,visibilityPredicate:t,attached:!1};return this._manipulators.add(i),this._attached&&this._updateManipulatorAttachment(i),r}))}remove(e){if("number"==typeof e){for(var t=e,r=0;r<this._manipulators.length;r++)if(this._manipulators.getItemAt(r).id===t){var i=this._manipulators.splice(r,1)[0];return this._detachManipulator(i),i.id}return null}for(var n=e,a=0;a<this._manipulators.length;a++)if(this._manipulators.getItemAt(a).manipulator===n){var s=this._manipulators.splice(a,1)[0];return this._detachManipulator(s),s.id}return null}removeAll(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((e=>{this._updateManipulatorAttachment(e)})),this._attached=!0}detach(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._attached=!1}destroy(){this._manipulators.forEach((({manipulator:e})=>{e.destroy&&e.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(e,t){return this._manipulators.on(e,(e=>{t(e)}))}forEach(e){for(var t of this._manipulators.items)e(t)}some(e){return this._manipulators.items.some(e)}toArray(){var e=[];return this.forEach((t=>e.push(t.manipulator))),e}intersect(e,t){var r=null,n=Number.MAX_VALUE;return this._manipulators.forEach((({id:a,manipulator:s,attached:o})=>{if(o&&s.interactive){var c=s.intersectionDistance(e,t);Object(i.k)(c)&&c<n&&(n=c,r={id:a,manipulator:s})}})),r}findById(e){if(Object(i.j)(e))return null;for(var t of this._manipulators.items)if(e===t.id)return t.manipulator;return null}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(e.attached){var t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}}_isManipulatorItemVisible(e){return 2===e.visibilityPredicate||(this._isToolEditable?0===e.visibilityPredicate:1===e.visibilityPredicate)}}},,,function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return y})),r.d(t,"e",(function(){return T})),r.d(t,"f",(function(){return M}));var i=r(89),n=r(104),a=r(111),s=r(157),o=r(332),c=r(174),l=r(396),u=r(200),d=r(305),h=r(191),p=r(533),f=r(461),b=r(398),m=(r(549),r(255)),v=r(453);class g{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=2}}class y{constructor(){this._transform=Object(c.b)(),this._transformInverse=new O({value:this._transform},s.a,c.b),this._transformInverseTranspose=new O(this._transformInverse,s.b,c.b),this._transformTranspose=new O({value:this._transform},s.b,c.b),this._transformInverseRotation=new O({value:this._transform},d.b,o.a)}invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(e){Object(s.c)(this._transform,e)}multiplyTransform(e){Object(s.l)(this._transform,this._transform,e)}set(e){Object(s.c)(this._transform,e),this.invalidateLazyTransforms()}setAndInvalidateLazyTransforms(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()}}class O{constructor(e,t,r){this.original=e,this.update=t,this.dirty=!0,this.transform=r()}invalidate(){this.dirty=!0}get value(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}class j{constructor(){this.min=new _,this.max=new _,this.hud=new _,this.ground=new _}init(e){this.min.init(e),this.max.init(e),this.hud.init(e),this.ground.init(e),this.all=[]}}class _{constructor(e){this.normal=Object(n.e)(),this.transformation=Object(c.b)(),this._ray=m.f.create(),this.init(e)}get ray(){return this._ray}get hasIntersectionPoint(){return null!=this.dist}get distanceInRenderSpace(){if(null!=this.dist)return Object(a.d)(E,this.ray.direction,this.dist),Object(a.o)(E)}getIntersectionPoint(e){return!!this.hasIntersectionPoint&&(Object(a.d)(E,this.ray.direction,this.dist),Object(a.e)(e,this.ray.origin,E),!0)}getTransformedNormal(e){return Object(a.j)(P,this.normal),P[3]=0,Object(h.m)(P,P,this.transformation),Object(a.j)(e,P),Object(a.q)(e,e),e}init(e){this.dist=void 0,this.target=void 0,this.name=void 0,this.drapedLayerOrder=void 0,this.drapedLayerGraphicOrder=void 0,this.center=null,this.geometryId=null,this.triangleNr=null,this.intersector="Stage",e?m.f.copy(e,this._ray):this._ray=m.f.create()}set(e,t,r,i,o,c,l,u,d,h){e instanceof v.a&&(e={type:"stage",obj:e}),this.dist=r,Object(a.j)(this.normal,i),Object(s.c)(this.transformation,o),this.target=e,this.name=t,this.drapedLayerOrder=c,this.center=l?Object(n.d)(l):null,this.geometryId=u,this.triangleNr=d,this.drapedLayerGraphicOrder=h}copyFrom(e){m.f.copy(e._ray,this._ray),this.dist=e.dist,this.target=e.target,this.name=e.name,this.drapedLayerOrder=e.drapedLayerOrder,this.center=e.center?Object(n.d)(e.center):null,this.geometryId=e.geometryId,this.triangleNr=e.triangleNr,this.intersector=e.intersector,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Object(a.j)(this.normal,e.normal),Object(s.c)(this.transformation,e.transformation)}toOwner(e){if(!this.target)return null;switch(this.target.type){case"stage":return w(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e,t){var r=e.metadata.layerUid;return null!=r?t.map.findLayerByUid(r):null}(this.target,e);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return w(this.target.metadata,e);case"TerrainRenderer":return e.map&&e.map.ground}}return null}toGraphic(e){if(!this.target)return null;switch(this.target.type){case"stage":return x(this.target.obj.metadata,e);case"external":switch(this.intersector){case"PointRenderer":return function(e){return e.metadata.createGraphic()}(this.target);case"I3S":case"IM":case"LodRenderer":case"OverlayRenderer":return x(this.target.metadata,e)}}return null}}function w(e,t){return Object(i.j)(e)||null==e.layerUid?null:Object(i.k)(t.graphicsView)&&e.layerUid===t.graphicsView.graphics3d.layer.id?t.graphics:t.map.findLayerByUid(e.layerUid)}function x(e,t){if(Object(i.j)(e))return null;var r=w(e,t);if(Object(i.j)(r))return null;if(r===t.graphics)return Object(i.k)(t.graphicsView)?Object(i.q)(t.graphicsView.getGraphicFromGraphicUid(e.graphicUid)):null;var n,a,s=t.allLayerViews.find((e=>e.layer===r));return s?(a=e,!(n=s)||n.suspended?null:"getGraphicFromIntersectorMetadata"in n&&a?n.getGraphicFromIntersectorMetadata(a):"getGraphicFromGraphicUid"in n&&null!=a.graphicUid?n.getGraphicFromGraphicUid(a.graphicUid):null):null}var S=new class{constructor(e=0){this.offset=e,this.sphere=Object(b.b)(),this.tmpVertex=Object(n.e)()}applyToVertex(e,t,r){var i=this.objectTransform.transform,n=i[0]*e+i[4]*t+i[8]*r+i[12],a=i[1]*e+i[5]*t+i[9]*r+i[13],s=i[2]*e+i[6]*t+i[10]*r+i[14],o=this.offset/Math.sqrt(n*n+a*a+s*s);n+=n*o,a+=a*o,s+=s*o;var c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*n+c[4]*a+c[8]*s+c[12],this.tmpVertex[1]=c[1]*n+c[5]*a+c[9]*s+c[13],this.tmpVertex[2]=c[2]*n+c[6]*a+c[10]*s+c[14],this.tmpVertex}applyToMinMax(e,t){var r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*r,e[1]+=e[1]*r,e[2]+=e[2]*r;var i=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*i,t[1]+=t[1]*i,t[2]+=t[2]*i}applyToAabb(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var r=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*r,e[4]+=e[4]*r,e[5]+=e[5]*r,e}applyToBoundingSphere(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/t;return this.sphere[0]=e[0]+e[0]*r,this.sphere[1]=e[1]+e[1]*r,this.sphere[2]=e[2]+e[2]*r,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}};function M(e){return Object(i.k)(e)?(S.offset=e,S):null}new class{constructor(e=0){this.offset=e,this.componentLocalOriginLength=0,this.tmpVertex=Object(n.e)(),this.mbs=Object(u.c)(),this.obb={center:Object(n.e)(),halfSize:Object(f.b)(),quaternion:null}}set localOrigin(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}applyToVertex(e,t,r){var i=e,n=t,a=r+this.componentLocalOriginLength,s=this.offset/Math.sqrt(i*i+n*n+a*a);return this.tmpVertex[0]=e+i*s,this.tmpVertex[1]=t+n*s,this.tmpVertex[2]=r+a*s,this.tmpVertex}applyToAabb(e){var t=e[0],r=e[1],i=e[2]+this.componentLocalOriginLength,n=e[3],a=e[4],s=e[5]+this.componentLocalOriginLength,o=this.offset/Math.sqrt(t*t+r*r+i*i);e[0]+=t*o,e[1]+=r*o,e[2]+=i*o;var c=this.offset/Math.sqrt(n*n+a*a+s*s);return e[3]+=n*c,e[4]+=a*c,e[5]+=s*c,e}applyToMbs(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=this.offset/t;return this.mbs[0]=e[0]+e[0]*r,this.mbs[1]=e[1]+e[1]*r,this.mbs[2]=e[2]+e[2]*r,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}applyToObb(e){var t=e.center,r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*r,this.obb.center[1]=t[1]+t[1]*r,this.obb.center[2]=t[2]+t[2]*r,Object(a.t)(this.obb.halfSize,e.halfSize,e.quaternion),Object(a.e)(this.obb.halfSize,this.obb.halfSize,e.center);var i=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*i,this.obb.halfSize[1]+=this.obb.halfSize[1]*i,this.obb.halfSize[2]+=this.obb.halfSize[2]*i,Object(a.i)(this.obb.halfSize,this.obb.halfSize,e.center),Object(p.a)(C,e.quaternion),Object(a.t)(this.obb.halfSize,this.obb.halfSize,C),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}};new class{constructor(e=0){this.offset=e,this.tmpVertex=Object(n.e)()}applyToVertex(e,t,r){var i=e+this.localOrigin[0],n=t+this.localOrigin[1],a=r+this.localOrigin[2],s=this.offset/Math.sqrt(i*i+n*n+a*a);return this.tmpVertex[0]=e+i*s,this.tmpVertex[1]=t+n*s,this.tmpVertex[2]=r+a*s,this.tmpVertex}applyToAabb(e){var t=e[0]+this.localOrigin[0],r=e[1]+this.localOrigin[1],i=e[2]+this.localOrigin[2],n=e[3]+this.localOrigin[0],a=e[4]+this.localOrigin[1],s=e[5]+this.localOrigin[2],o=this.offset/Math.sqrt(t*t+r*r+i*i);e[0]+=t*o,e[1]+=r*o,e[2]+=i*o;var c=this.offset/Math.sqrt(n*n+a*a+s*s);return e[3]+=n*c,e[4]+=a*c,e[5]+=s*c,e}};var T="terrain",E=(Object(n.e)(),Object(n.e)()),P=Object(u.c)(),C=Object(l.a)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return j})),r.d(t,"b",(function(){return _})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return y})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return O}));var i=r(91),n=r(89),a=r(110),s=r(105),o=r(104),c=r(111),l=r(223),u=r(340),d=r(177),h=r(255),p=r(634),f=r(758),b=r(397);function m(e,t){var r=Object(o.e)(),a=Object(o.e)(),c=!1;return o=>{if("start"===o.action){var l=Object(s.j)(o.screenStart,Object(s.c)(d.c.get())),u=h.f.fromScreen(e.state.camera,l,S);Object(n.k)(u)&&(c=h.e.intersectRay(t,u,r))}if(!c)return null;var p=Object(s.j)(o.screenEnd,Object(s.c)(d.c.get())),f=h.f.fromScreen(e.state.camera,p,S);return Object(n.j)(f)?null:h.e.intersectRay(t,f,a)?Object(i.a)(Object(i.a)({},o),{},{renderStart:r,renderEnd:a,plane:t,ray:f}):null}}function v(e,t,r,a=null,o=null){return function(e,t,r,a=null,o=null){var c=null;return u=>{if("start"===u.action&&(c=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(s.g)(u.screenStart.x,u.screenStart.y),t,r,o),Object(n.k)(c)&&Object(n.k)(a)&&!Object(l.n)(c,c,a)))return null;if(Object(n.j)(c))return null;var d=e.sceneIntersectionHelper.intersectElevationFromScreen(Object(s.g)(u.screenEnd.x,u.screenEnd.y),t,r,o);return Object(n.k)(d)?Object(n.k)(a)&&!Object(l.n)(d,d,a)?null:Object(i.a)(Object(i.a)({},u),{},{mapStart:c,mapEnd:d}):null}}(e,r,Object(u.f)(t,e,r),a,o)}function g(e,t,r,i=null,n=null){return v(e,r,Object(u.d)(t),i,n)}function y(e,t,r,i){var a=t.toMap(e.screenStart,{include:[r]});return Object(n.k)(a)?g(t,r,a,i):null}function O(e,t,r){var s=null,l=new b.a;return l.next(m(e,function(e,t){var r=w,i=x,n=h.e.create();e.renderCoordsHelper.worldUpAtPosition(t,r);var a=Object(c.f)(n,r,Object(c.i)(i,t,e.state.camera.eye));return Object(c.f)(a,a,r),h.e.fromPositionAndNormal(t,a,n)}(e,t))).next(function(e,t){var r=Object(o.e)(),i=Object(c.o)(t);e.renderCoordsHelper.worldUpAtPosition(t,r);var n=Object(o.e)(),s=Object(o.e)(),l=n=>(Object(c.i)(n,n,t),h.h.projectPoint(r,n,n),"global"===e.viewingMode&&Object(c.o)(n)*Object(a.r)(Object(c.g)(r,n))<.001-i&&Object(c.i)(n,Object(c.d)(n,r,.001),t),Object(c.e)(n,n,t),n);return e=>(e.renderStart=l(Object(c.j)(n,e.renderStart)),e.renderEnd=l(Object(c.j)(s,e.renderEnd)),e)}(e,t)).next(function(e,t){var r=e.renderCoordsHelper;return e=>{var a=r.fromRenderCoords(e.renderStart,t),s=r.fromRenderCoords(e.renderEnd,t);return Object(n.k)(a)&&Object(n.k)(s)?Object(i.a)(Object(i.a)({},e),{},{mapStart:a,mapEnd:s}):null}}(e,r)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,s=e})),e=>(s=null,l.execute(e),s)}function j(e){var t=null;return r=>{switch(r.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":Object(n.k)(t)&&(t.remove(),t=null)}return r}}function _(e,t=null){var r=new f.a(e.state.mode);r.options.selectionMode=!0,r.options.store=0;var a,c=Object(s.g)(),l={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},u=Object(o.e)(),d=Object(n.r)(t,e.spatialReference),h=t=>{e.map.ground&&e.map.ground.opacity<1?l.exclude.add(p.e):l.exclude.delete(p.e),e.sceneIntersectionHelper.intersectIntersectorScreen(Object(s.j)(t,c),r,l);var i,n=r.results.min;if(n.getIntersectionPoint(u))i="TerrainRenderer"===n.intersector?0:1;else{if(!r.results.ground.getIntersectionPoint(u))return null;i=0}return{location:e.renderCoordsHelper.fromRenderCoords(u,d),surfaceType:i}};return e=>{if("start"===e.action){var t=h(e.screenStart);a=Object(n.k)(t)?t.location:null}if(Object(n.j)(a))return null;var r=h(e.screenEnd);return Object(n.k)(r)&&Object(n.k)(r.location)?Object(i.a)(Object(i.a)({},e),{},{mapStart:a,mapEnd:r.location,surfaceType:r.surfaceType}):null}}var w=Object(o.e)(),x=Object(o.e)(),S=h.f.create()},,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return y})),r.d(t,"g",(function(){return O}));var i=r(89),n=r(111),a=r(157),s=r(200),o=r(177),c=r(370),l=r(480),u=r(584),d=r(560),h=r(605),p=r(802);function f(e,t=4){var r=Object(s.d)(e[0],e[1],e[2],e.length>3?e[3]:1),i=e[3]<1;return new p.a({color:r,transparent:i,writeDepth:!0,cullFace:2,renderOccluded:t})}function b(e,t=4){var r=Object(s.d)(e[0],e[1],e[2],4===e.length?e[3]:1);return new d.a({color:r,transparent:!0,writeDepth:!0,cullFace:1,renderOccluded:t})}function m(e,t,r){return new h.a({view:e,renderObjects:[{geometry:c.a.createSphereGeometry(1,32,32),material:f(Object(s.d)(t[0],t[1],t[2],null!=r?r:1))}]})}function v(e,t,r,i){var s=Object(n.i)(o.d.get(),e,r),c=g(s,Object(n.f)(o.d.get(),i,s),r,o.a.get());Object(a.a)(c,c);var l=Object(n.l)(o.d.get(),t,c);return Math.atan2(l[1],l[0])}function g(e,t,r,i){var a=Object(n.q)(o.d.get(),e),s=Object(n.q)(o.d.get(),t),c=Object(n.f)(o.d.get(),a,s);return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=0,i[4]=s[0],i[5]=s[1],i[6]=s[2],i[7]=0,i[8]=c[0],i[9]=c[1],i[10]=c[2],i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i}function y(e,t){var r=e.getViewForGraphic(t);return Object(i.k)(r)&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null}function O(e,t,r){var n=y(e,r);Object(i.k)(n)?t.elevationAlignedLocation=n:function(e,t){if(Object(i.j)(t))return;var r=Object(u.a)(t);Object(i.j)(r)||(e.location=Object(l.b)(r))}(t,r.geometry)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(89),n=r(264);class a{constructor(e,t,r){this.editGeometry=e,this.component=t,this.pos=r,this.addedVertex=null,this.originalEdge=null,this.left=null,this.right=null}apply(){var e="redo";if(Object(i.j)(this.addedVertex)&&(e="apply",this.addedVertex=new n.d(this.component)),0===this.component.vertices.length)this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{var t=Object(i.q)(this.component.getLastVertex()),r=null;t.right&&(this.originalEdge=t.right,r=this.originalEdge.right,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),1)),this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,Object(i.j)(this.left)&&(this.left=new n.b(this.component,t,this.addedVertex)),this.component.edges.push(this.left),t.right=this.left,Object(i.k)(this.originalEdge)&&Object(i.k)(r)&&(Object(i.j)(this.right)&&(this.right=new n.b(this.component,this.addedVertex,r)),this.component.edges.push(this.right),r.left=this.right),this.component.updateVertexIndex(this.addedVertex,t.index+1)}var a={addedVertices:[this.addedVertex],operation:e};this.editGeometry.emit("change",a)}undo(){if(Object(i.j)(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1),Object(i.k)(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.left.right=null),Object(i.k)(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),1),this.right.right.left=null),Object(i.k)(this.originalEdge)&&(this.component.edges.push(this.originalEdge),this.originalEdge.left.right=this.originalEdge,this.originalEdge.right.left=this.originalEdge),Object(i.k)(this.left)?this.component.updateVertexIndex(this.left.left,this.left.left.index):this.component.updateVertexIndex(this.addedVertex,0);var e={removedVertices:[this.addedVertex],operation:"undo"};this.editGeometry.emit("change",e)}accumulate(e){return!1}}},,,,,,,,,,function(e,t,r){"use strict";var i=r(89),n=r(110),a=r(105),s=r(104),o=r(111),c=r(330),l=r(157),u=r(174),d=r(202),h=r(200),p=r(135),f=r(191),b=r(347),m=r(255),v=r(179);class g{constructor(e=null,t=null,r=null){this._viewUp=Object(s.e)(),this._viewForward=Object(s.e)(),this._viewRight=Object(s.e)(),this._ray=m.f.createWrapper(),this._viewport=Object(h.d)(0,0,1,1),this._padding=Object(h.d)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=Object(d.e)(1,1e3),this._viewDirty=!0,this._viewMatrix=Object(u.b)(),this._projectionDirty=!0,this._projectionMatrix=Object(u.b)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=Object(u.b)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=Object(u.b)(),this._frustumDirty=!0,this._frustum=m.c.create(),this._fullViewport=Object(h.c)(),this.pixelRatio=1,this.relativeElevation=0,this._eye=Object(i.k)(e)?Object(s.d)(e):Object(s.e)(),this._center=Object(i.k)(t)?Object(s.d)(t):Object(s.e)(),this._up=Object(i.k)(r)?Object(s.d)(r):Object(s.g)(0,0,1)}get eye(){return this._eye}set eye(e){this._compareAndSetView(e,this._eye)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center)}get ray(){return this._ray.origin=this.eye,this._ray.direction||(this._ray.direction=Object(s.e)()),Object(o.i)(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up)}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){Object(l.c)(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),this._viewForward}get viewUp(){return this._ensureViewClean(),this._viewUp}get viewRight(){return this._ensureViewClean(),this._viewRight}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get x(){return this._viewport[0]}set x(e){e+=this._padding[3],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get y(){return this._viewport[1]}set y(e){e+=this._padding[2],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get fullWidth(){return this._viewport[2]+this._padding[1]+this._padding[3]}set fullWidth(e){this.width=e-(this._padding[1]+this._padding[3])}get fullHeight(){return this._viewport[3]+this._padding[0]+this._padding[2]}set fullHeight(e){this.height=e-(this._padding[0]+this._padding[2])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[3],this._fullViewport[1]=this._viewport[1]-this._padding[2],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){this._padding[0]===e[0]&&this._padding[1]===e[1]&&this._padding[2]===e[2]&&this._padding[3]===e[3]||(this._viewport[0]+=e[3]-this._padding[3],this._viewport[1]+=e[2]-this._padding[2],this._viewport[2]-=e[1]+e[3]-(this._padding[1]+this._padding[3]),this._viewport[3]-=e[0]+e[2]-(this._padding[0]+this._padding[2]),Object(f.c)(this._padding,e),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewProjectionMatrix(){return this._viewProjectionDirty&&(Object(l.l)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){if(this._projectionDirty){var e=this.width,t=this.height,r=this.near*Math.tan(this.fovY/2),i=r*this.aspect;Object(l.h)(this._projectionMatrix,-i*(1+2*this._padding[3]/e),i*(1+2*this._padding[1]/e),-r*(1+2*this._padding[2]/t),r*(1+2*this._padding[0]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix}set projectionMatrix(e){Object(l.c)(this._projectionMatrix,e),this._projectionDirty=!1,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fov(){return this._fov}set fov(e){this._fov=e,this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return Object(v.b)(this._fov,this.width,this.height)}set fovX(e){this._fov=Object(v.d)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return Object(v.c)(this._fov,this.width,this.height)}set fovY(e){this._fov=Object(v.e)(e,this.width,this.height),this._projectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return Object(o.n)(this._center,this._eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(Object(l.a)(this._viewInverseTransposeMatrix,this.viewMatrix),Object(l.b)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){var t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return this.relativeElevation&&this.relativeElevation>=0}copyFrom(e){var t=e;return Object(o.j)(this._eye,t._eye),Object(o.j)(this._center,t._center),Object(o.j)(this._up,t._up),Object(f.c)(this._viewport,t._viewport),Object(f.c)(this._padding,t._padding),Object(p.c)(this._nearFar,t._nearFar),this._fov=t._fov,this.relativeElevation=e.relativeElevation,this._viewDirty=t._viewDirty,this._viewDirty||(Object(l.c)(this._viewMatrix,t._viewMatrix),Object(o.j)(this._viewRight,t._viewRight),Object(o.j)(this._viewUp,t._viewUp),Object(o.j)(this._viewForward,t._viewForward)),t._projectionDirty?this._projectionDirty=!0:(Object(l.c)(this._projectionMatrix,t._projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(m.c.copy(t._frustum,this._frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(Object(l.c)(this._viewInverseTransposeMatrix,t._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Object(f.c)(this._fullViewport,t._fullViewport),this.pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up}clone(){return(new g).copyFrom(this)}equals(e){return Object(o.p)(this._eye,e._eye)&&Object(o.p)(this._center,e._center)&&Object(o.p)(this._up,e._up)&&Object(f.g)(this._viewport,e._viewport)&&Object(f.g)(this._padding,e._padding)&&Object(p.k)(this._nearFar,e._nearFar)&&this._fov===e._fov&&this.pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}almostEquals(e){if(this.pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;var t=5e-4;Object(o.u)(j,e.eye,e.center),Object(o.u)(_,this._eye,this._center);var r=Object(o.g)(j,_),i=Object(o.x)(j),n=Object(o.x)(_);return r*r>=(1-1e-10)*i*n&&Object(o.y)(e.eye,this._eye)<Math.max(i,n)*t*t&&Object(f.i)(e.padding,this._padding)<.5&&Object(f.i)(e.viewport,this._viewport)<.5}markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this.viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this.viewDirectionDistance(e))}viewDirectionDistance(e){return Math.abs(Object(b.c)(this.viewForward,Object(o.i)(j,e,this._eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=Object(a.g)()){return e[0]=(this.padding[3]+this.width/2)/this.pixelRatio,e[1]=(this.padding[0]+this.height/2)/this.pixelRatio,e}getRenderCenter(e,t=.5,r=.5){return e||(e=Object(a.e)()),e[0]=this.padding[3]+this.width*t,e[1]=this.padding[2]+this.height*r,e.length>2&&(e[2]=.5),e}setGLViewport(e){var t=this.viewport,r=this.padding;e.setViewport(t[0]-r[3],t[1]-r[2],t[2]+r[1]+r[3],t[3]+r[0]+r[2])}applyProjection(e,t,r=!1){e!==y&&Object(o.j)(y,e),y[3]=1,r&&(t[2]=-y[2]),Object(f.m)(y,y,this.projectionMatrix),Object(o.d)(y,y,1/Math.abs(y[3]));var i=this.fullViewport;return t[0]=Object(n.l)(0,i[0]+i[2],.5+.5*y[0]),t[1]=Object(n.l)(0,i[1]+i[3],.5+.5*y[1]),r||(t[2]=.5*(y[2]+1)),t}projectToScreen(e,t){return this.projectToRenderScreen(e,w),this.renderToScreen(w,t)}projectToRenderScreen(e,t){if(y[0]=e[0],y[1]=e[1],y[2]=e[2],y[3]=1,Object(f.m)(y,y,this.viewProjectionMatrix),0===y[3])return null;Object(o.d)(y,y,1/Math.abs(y[3]));var r=this.fullViewport;return"x"in t?(t.x=Object(n.l)(0,r[0]+r[2],.5+.5*y[0]),t.y=Object(n.l)(0,r[1]+r[3],.5+.5*y[1])):(t[0]=Object(n.l)(0,r[0]+r[2],.5+.5*y[0]),t[1]=Object(n.l)(0,r[1]+r[3],.5+.5*y[1]),t.length>2&&(t[2]=.5*(y[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,w),t)}unprojectFromRenderScreen(e,t){if(Object(l.l)(O,this.projectionMatrix,this.viewMatrix),!Object(l.a)(O,O))return null;var r=this.fullViewport;return y[0]=2*(e[0]-r[0])/r[2]-1,y[1]=2*(e[1]-r[1])/r[3]-1,y[2]=2*e[2]-1,y[3]=1,Object(f.m)(y,y,O),0===y[3]?null:(t[0]=y[0]/y[3],t[1]=y[1]/y[3],t[2]=y[2]/y[3],t)}constrainWindowSize(e,t,r,i=1){var n=e*this.pixelRatio,a=t*this.pixelRatio,s=Math.max(n-r*i/2,0),o=Math.max(this.fullHeight-a-r/2,0),c=-Math.min(n-r*i/2,0),l=-Math.min(this.fullHeight-a-r/2,0);return[s,o,r*i-c- -Math.min(this.fullWidth-n-r*i/2,0),r-l- -Math.min(a-r/2,0)]}computeUp(e){1===e?this.computeUpGlobal():this.computeUpLocal()}screenToRender(e,t){var r=e[0]*this.pixelRatio,i=this.fullHeight-e[1]*this.pixelRatio;return t[0]=r,t[1]=i,t}renderToScreen(e,t){var r=e[0]/this.pixelRatio,i=(this.fullHeight-e[1])/this.pixelRatio;return t[0]=r,t[1]=i,t}computeUpGlobal(){Object(o.i)(j,this.center,this.eye);var e=Object(o.o)(this.center);e<1?(Object(o.v)(this.up,0,0,1),this.markViewDirty()):Math.abs(Object(o.g)(j,this.center))>.9999*Object(o.o)(j)*e||(Object(o.f)(this.up,j,this.center),Object(o.f)(this.up,this.up,j),Object(o.q)(this.up,this.up),this.markViewDirty())}computeUpLocal(){Object(c.d)(j,this.eye,this.center),Math.abs(j[2])<=.9999&&(Object(o.d)(j,j,j[2]),Object(o.v)(this.up,-j[0],-j[1],1-j[2]),Object(o.q)(this.up,this.up),this.markViewDirty())}_compareAndSetView(e,t){Object(o.p)(e,t)||(Object(o.j)(t,e),this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0)}_recomputeFrustum(){this._frustumDirty&&(m.c.fromMatrix(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(Object(l.k)(this._viewMatrix,this._eye,this._center,this._up),Object(o.v)(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),Object(o.v)(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),Object(o.v)(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}}var y=Object(h.c)(),O=Object(u.b)(),j=Object(s.e)(),_=Object(s.e)(),w=Object(a.e)();t.a=g},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i,n,a,s=r(120),o=r(119);function c(e,t){0===t.output&&t.receiveShadows?(e.varyings.add("linearDepth","float"),e.vertex.code.add(Object(o.a)(i||(i=Object(s.a)(["\n      void forwardLinearDepth() { linearDepth = gl_Position.w; }\n    "]))))):1===t.output||3===t.output?(e.varyings.add("linearDepth","float"),e.vertex.uniforms.add("cameraNearFar","vec2"),e.vertex.code.add(Object(o.a)(n||(n=Object(s.a)(["\n      void forwardLinearDepth() {\n        linearDepth = (-position_view().z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);\n      }\n    "]))))):e.vertex.code.add(Object(o.a)(a||(a=Object(s.a)(["\n      void forwardLinearDepth() {}\n    "]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i,n,a=r(120),s=r(119);!function(e){e.builder=function(e,t){e.vertex.uniforms.add("camPos","vec3").add("perScreenPixelRatio","float").add("screenSize","float"),e.vertex.code.add(Object(s.a)(i||(i=Object(a.a)(["\n    float computeRenderPixelSizeAt( vec3 pWorld ){\n      vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);\n      float viewDirectionDistance = abs(dot(viewForward, pWorld - camPos));\n      return viewDirectionDistance*perScreenPixelRatio;\n    }\n\n    vec3 screenSizeScaling(vec3 position, vec3 anchor){\n      return position * screenSize * computeRenderPixelSizeAt(anchor) + anchor;\n    }\n  "]))))},e.bindPassUniforms=function(e,t,r){e.setUniform1f("perScreenPixelRatio",r.camera.perScreenPixelRatio),e.setUniform1f("screenSize",t.screenSize)}}(n||(n={}))},,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var i,n,a,s,o,c,l,u,d,h,p,f,b,m,v=r(120),g=r(119),y=r(551);function O(e){var t=e.fragment.code;t.add(Object(g.a)(i||(i=Object(v.a)(["\n    vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n    {\n      return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n    }\n    "])))),t.add(Object(g.a)(n||(n=Object(v.a)(["\n    float integratedRadiance(float cosTheta2, float roughness)\n    {\n      return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n    }\n    "])))),t.add(Object(g.a)(a||(a=Object(v.a)(["\n    vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n    {\n      float cosTheta2 = 1.0 - RdotNG * RdotNG;\n      float intRadTheta = integratedRadiance(cosTheta2, roughness);\n\n      // Calculate the integrated directional radiance of the ground and the sky\n      float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\n      float sky = 2.0 - ground;\n      return (ground * ambientGround + sky * ambientSky) * 0.5;\n    }\n    "]))))}function j(e,t){var r=e.fragment.code;e.include(y.a),3===t.pbrMode||4===t.pbrMode?(r.add(Object(g.a)(s||(s=Object(v.a)(["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent = ",";\n    "])),t.useCustomDTRExponentForWater?"2.2":"2.0")),r.add(Object(g.a)(o||(o=Object(v.a)(["\n    vec3 fresnelReflection(float angle, vec3 f0, float f90) {\n      return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n    }\n    "])))),r.add(Object(g.a)(c||(c=Object(v.a)(["\n    float normalDistributionWater(float NdotH, float roughness)\n    {\n      float r2 = roughness * roughness;\n      float NdotH2 = NdotH * NdotH;\n      float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\n      return r2 / denom;\n    }\n    "])))),r.add(Object(g.a)(l||(l=Object(v.a)(["\n    float geometricOcclusionKelemen(float LoH)\n    {\n        return 0.25 / (LoH * LoH);\n    }\n    "])))),r.add(Object(g.a)(u||(u=Object(v.a)(["\n    vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n    {\n      vec3  F = fresnelReflection(props.VdotH, F0, F0Max);\n      float dSun = normalDistributionWater(props.NdotH, roughness);\n      float V = geometricOcclusionKelemen(props.LdotH);\n\n      float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\n      float strengthSunHaze  = 1.2;\n      float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\n\n      return ((dSun + dSunHaze) * V) * F;\n    }\n\n    vec3 tonemapACES(const vec3 x) {\n      return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n    }\n    "]))))):1!==t.pbrMode&&2!==t.pbrMode||(e.include(O),r.add(Object(g.a)(d||(d=Object(v.a)(["\n    struct PBRShadingInfo\n    {\n        float NdotL;                  // cos angle between normal and light direction\n        float NdotV;                  // cos angle between normal and view direction\n        float NdotH;                  // cos angle between normal and half vector\n        float VdotH;                  // cos angle between view direction and half vector\n        float LdotH;                  // cos angle between view light direction and half vector\n        float NdotNG;                 // cos angle between normal and normal of the ground\n        float RdotNG;                 // cos angle between view direction reflected of the normal and normal of the ground\n        float NdotAmbDir;             // cos angle between view direction and the fill light in ambient illumination\n        float NdotH_Horizon;          // cos angle between normal and half vector defined with horizon illumination\n        vec3 skyRadianceToSurface;         // integrated radiance of the sky based on the surface roughness (used for specular reflection)\n        vec3 groundRadianceToSurface;      // integrated radiance of the ground based on the surface roughness (used for specular reflection)\n        vec3 skyIrradianceToSurface;       // irradiance of the sky (used for diffuse reflection)\n        vec3 groundIrradianceToSurface;    // irradiance of the ground (used for diffuse reflection)\n\n        float averageAmbientRadiance;      // average ambient radiance used to deduce black level in gamut mapping\n        float ssao;                   // ssao coefficient\n        vec3 albedoLinear;            // linear color of the albedo\n        vec3 f0;                      // fresnel value at normal incident light\n        vec3 f90;                     // fresnel value at 90o of incident light\n\n        vec3 diffuseColor;            // diffuse color of the material used in environment illumination\n        float metalness;              // metalness of the material\n        float roughness;              // roughness of the material\n    };\n    "])))),r.add(Object(g.a)(h||(h=Object(v.a)(["\n    float normalDistribution(float NdotH, float roughness)\n    {\n        float a = NdotH * roughness;\n        float b = roughness / (1.0 - NdotH * NdotH + a * a);\n        return b * b * INV_PI;\n    }\n    "])))),r.add(Object(g.a)(p||(p=Object(v.a)(["\n    const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);\n    const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);\n    const vec2 c2 = vec2(-1.04, 1.04);\n\n    vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\n        vec4 r = roughness * c0 + c1;\n        float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\n        return c2 * a004 + r.zw;\n    }\n    "])))),r.add(Object(g.a)(f||(f=Object(v.a)(["\n    vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\n      vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\n      vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\n\n      // From diffuse illumination calculate reflected color\n      vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;\n\n      // From specular illumination calculate reflected color\n      vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\n      vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;\n      vec3 specularComponent = specularColor * indirectSpecular;\n\n      return (diffuseComponent + specularComponent);\n    }\n    "])))),r.add(Object(g.a)(b||(b=Object(v.a)(["\n    float gamutMapChanel(float x, vec2 p){\n      return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n    }"])))),r.add(Object(g.a)(m||(m=Object(v.a)(["\n    vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\n      vec3 outColor;\n      vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\n      outColor.x = gamutMapChanel(inColor.x, p) ;\n      outColor.y = gamutMapChanel(inColor.y, p) ;\n      outColor.z = gamutMapChanel(inColor.z, p) ;\n      return outColor;\n    }\n    "])))))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return w})),r.d(t,"b",(function(){return _}));var i,n,a,s,o,c,l,u,d,h=r(120),p=r(119),f=r(413),b=r(254),m=r(358),v=r(249),g=r(308),y=r(333),O=r(280),j=r(700);function _(e){var t=new b.a;return t.include(f.a,{linearDepth:!1}),t.include(j.a.builder,{}),t.include(v.a,e),t.fragment.include(m.a),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.fragment.uniforms.add("color","vec4"),t.attributes.add("position","vec3"),t.varyings.add("vWorldPosition","vec3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add("offset","vec3"),e.shadingEnabled&&(t.vertex.uniforms.add("viewNormal","mat4"),t.fragment.uniforms.add("shadedColor","vec4").add("shadingDirection","vec3"),t.attributes.add("normal","vec3"),t.varyings.add("vViewNormal","vec3")),t.vertex.code.add(Object(p.a)(i||(i=Object(h.a)(["\n    void main(void) {\n      vWorldPosition = ",";\n  "])),e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position")),e.shadingEnabled&&t.vertex.code.add(Object(p.a)(n||(n=Object(h.a)(["\n      vec3 worldNormal = normal;\n      vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;\n    "])))),t.vertex.code.add(Object(p.a)(a||(a=Object(h.a)(["\n    ","\n    gl_Position = transformPosition(proj, view, vWorldPosition);\n  }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(vWorldPosition, 1.0)).z;":"")),e.multipassTerrainEnabled&&(t.fragment.include(g.a),t.include(O.b,e)),t.fragment.code.add(Object(p.a)(s||(s=Object(h.a)(["\n    void main() {\n      discardBySlice(vWorldPosition);\n      ","\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.shadingEnabled?t.fragment.code.add(Object(p.a)(o||(o=Object(h.a)(["\n      vec3 viewNormalNorm = normalize(vViewNormal);\n      float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);\n      vec4 finalColor = mix(color, shadedColor, shadingFactor);\n    "])))):t.fragment.code.add(Object(p.a)(c||(c=Object(h.a)(["\n      vec4 finalColor = color;\n    "])))),t.fragment.code.add(Object(p.a)(l||(l=Object(h.a)(["\n      if (finalColor.a < ",") {\n        discard;\n      }\n      ","\n\n      ","\n    }\n    "])),p.a.float(y.c),7===e.output?Object(p.a)(u||(u=Object(h.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(p.a)(d||(d=Object(h.a)(["gl_FragColor = highlightSlice(finalColor, vWorldPosition); ",""])),e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""):"")),t}var w=Object.freeze({__proto__:null,build:_})},function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));r(80);var i=r(89),n=r(104),a=r(111),s=r(174),o=r(255),c=r(357),l=r(634),u=1e-5;class d{constructor(e){this.options=new l.a,this.results=new l.c,this.transform=new l.d,this.performanceInfo={queryDuration:0,numObjectsTested:0},this.tolerance=u,this.verticalOffset=null,this._ray={origin:Object(n.e)(),direction:Object(n.e)()},this._rayEndPoint=Object(n.e)(),this._rayStartPointTransformed=Object(n.e)(),this._rayEndPointTransformed=Object(n.e)(),this.viewingMode=null==e?1:e}get ray(){return this._ray}get rayBeginPoint(){return this._ray.origin}get rayEndPoint(){return this._rayEndPoint}reset(e,t){this.resetWithRay(o.f.fromPoints(e,t,this._ray))}resetWithRay(e){e!==this._ray&&o.f.copy(e,this._ray),0!==this.options.verticalOffset?2===this.viewingMode?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,Object(a.e)(this._rayEndPoint,this._ray.origin,this._ray.direction),this._numObjectsTested=0,this.results.init(this._ray)}intersect(e,t,r,n,a,s){this.point=t,this.camera=r,this.filterPredicate=a,this.tolerance=null==n?u:n;var o=Object(l.f)(this.verticalOffset),c=s?e=>{s(e)&&this.intersectObject(e)}:e=>{this.intersectObject(e)};if(e&&e.length>0)for(var d of e){var h=d.getSpatialQueryAccelerator&&d.getSpatialQueryAccelerator();Object(i.k)(h)?(Object(i.k)(o)?h.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,c,o):h.forEachAlongRay(this._ray.origin,this._ray.direction,c),this.options.selectionMode&&this.options.hud&&h.forEachDegenerateObject(c)):d.getObjects().forAll((e=>c(e)))}this.sortResults()}intersectObject(e){var t=this;this._numObjectsTested++;var r=e.geometryRecords;if(r){var n,o=e.id,u=e.transformation,d=Object(l.f)(this.verticalOffset),h=function(r){var{geometry:h,material:p,instanceParameters:f}=r;if(Object(c.d)(f))return"continue";n=h.id,t.transform.setAndInvalidateLazyTransforms(u,r.getShaderTransformation()),Object(a.l)(t._rayStartPointTransformed,t._ray.origin,t.transform.inverse),Object(a.l)(t._rayEndPointTransformed,t._rayEndPoint,t.transform.inverse);var b=t.transform.transform;Object(i.k)(d)&&(d.objectTransform=t.transform),p.intersect(h,f,t.transform.transform,t,t._rayStartPointTransformed,t._rayEndPointTransformed,((r,a,c,u,d,h)=>{if(r>=0){if(Object(i.k)(t.filterPredicate)&&!t.filterPredicate(t._ray.origin,t._rayEndPoint,r))return;var p="Object3D ".concat(o);if(d)return void((null==t.results.hud.dist||r<t.results.hud.dist)&&t.results.hud.set(e,p,r,a,s.a,u,h,n,c));var f=t=>t.set(e,p,r,a,b,u,null,n,c);if((null==t.results.min.drapedLayerOrder||u>=t.results.min.drapedLayerOrder)&&(null==t.results.min.dist||r<t.results.min.dist)&&f(t.results.min),0!==t.options.store&&(null==t.results.max.drapedLayerOrder||u<t.results.max.drapedLayerOrder)&&(null==t.results.max.dist||r>t.results.max.dist)&&f(t.results.max),2===t.options.store){var m=new l.b(t._ray);f(m),t.results.all.push(m)}}}),r.shaderTransformation)};for(var p of r)h(p)}}sortResults(){this.results.all.sort(((e,t)=>e.dist!==t.dist?e.dist-t.dist:e.drapedLayerOrder!==t.drapedLayerOrder?(void 0!==e.drapedLayerOrder?e.drapedLayerOrder:Number.MAX_VALUE)-(void 0!==t.drapedLayerOrder?t.drapedLayerOrder:Number.MAX_VALUE):(void 0!==t.drapedLayerGraphicOrder?t.drapedLayerGraphicOrder:Number.MIN_VALUE)-(void 0!==e.drapedLayerGraphicOrder?e.drapedLayerGraphicOrder:Number.MIN_VALUE)))}}d.DEFAULT_TOLERANCE=u},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(91),n=r(7),a=r(82),s=(r(80),r(81),r(88),r(85)),o=r(84),c=r(93),l=(r(83),r(86),r(87),r(97)),u=r(115),d=r(108),h=r(528),p=class extends l.a{constructor(e){super(e),this.tool=null,this._baseHandles=new u.a,this._loggedUnsupportedErrorOnce=!1,this._creationAbortController=null,e&&null!=e.visible&&(this.visible=e.visible)}initialize(){this._baseHandles.add(Object(d.a)(this,["view.ready","isSupported"],(()=>{this.view&&this.view.ready&&!this.isSupported?this._loggedUnsupportedErrorOnce||(this.logUnsupportedError(),this._loggedUnsupportedErrorOnce=!0):this._loggedUnsupportedErrorOnce=!1})))}destroy(){this.removeTool(),this.view=null,this._baseHandles.destroy(),this._baseHandles=null}get isSupported(){return!this.view||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e!==this.view){this.removeTool(),this._set("view",e);var t="tools";this._baseHandles.remove(t),e&&this._baseHandles.add(e.tools.on("change",(e=>{if(this.tool)for(var t of e.removed)if(this.tool===t){t.destroyed||t.destroy(),this._set("tool",null);break}})),t)}}set visible(e){this._set("visible",e),this.tool&&(this.tool.visible=e),!e&&this._creationAbortController&&(this._creationAbortController.abort(),this._creationAbortController=null)}get active(){return null!=this._creationAbortController||null!=this.tool&&this.tool.active}get isDisabled(){return!this.view||!this.view.ready||!this.isSupported}get creatingTool(){return!!this._creationAbortController}createTool(){var e=this;return Object(n.a)((function*(){if(e.removeTool(),!e.isSupported)return Promise.reject(new c.a("tool:create","The view does not support the tool"));var t=e.createToolParams(),r=new AbortController,n=r.signal;e._creationAbortController=r;var a=()=>{r===e._creationAbortController&&(e._creationAbortController=null)};try{var s=yield e.view.createTool(t.toolConstructor,(()=>{var r=Object(h.b)(t.constructorArguments);return Object(i.a)({visible:e.visible},r)}),{signal:n});e._set("tool",s),a()}catch(o){throw a(),o}}))()}removeTool(){this._creationAbortController&&this._creationAbortController.abort(),this._creationAbortController=null;var e=this.tool;e&&(this.view&&this.view.tools&&this.view.tools.remove(e),e.destroyed||e.destroy(),this._set("tool",null))}};Object(a.a)([Object(s.b)({constructOnly:!0})],p.prototype,"tool",void 0),Object(a.a)([Object(s.b)()],p.prototype,"isSupported",null),Object(a.a)([Object(s.b)({value:null})],p.prototype,"view",null),Object(a.a)([Object(s.b)({type:Boolean,value:!0})],p.prototype,"visible",null),Object(a.a)([Object(s.b)()],p.prototype,"active",null),Object(a.a)([Object(s.b)()],p.prototype,"isDisabled",null),Object(a.a)([Object(s.b)()],p.prototype,"_creationAbortController",void 0),Object(a.a)([Object(s.b)({readOnly:!0})],p.prototype,"creatingTool",null),p=Object(a.a)([Object(o.a)("esri.widgets.support.InteractiveToolViewModel")],p)},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return h}));var i=r(91),n=r(92),a=r(105),s=r(104),o=r(111),c=(r(157),r(135));Object(s.e)();function l(e,t){return Object(i.a)(Object(i.a)({},e),Object(n.a)(t))}function u(e,t,r,i){for(;e.length<t;)e.push(r());if(i)for(;e.length>t;)i(e.pop());else e.length=t}function d(e,t){if(Object(o.v)(t,0,0,0),e.length>0){for(var r=0;r<e.length;++r)Object(o.e)(t,t,e[r]);Object(o.d)(t,t,1/e.length)}}function h(e,t,r,i){i.projectToRenderScreen(e,v),i.projectToRenderScreen(t,y),Object(c.d)(r,O,g),Object(c.e)(r,r)}function p(e,t,r){var i=r.state.camera;r.renderCoordsHelper.toRenderCoords(e,b),i.projectToRenderScreen(b,m),r.state.camera.renderToScreen(m,t)}function f(e,t,r){return p(e,j,r),p(t,_,r),Object(c.i)(j,_)}var b=Object(s.e)(),m=Object(a.e)(),v=Object(a.e)(),g=v,y=Object(a.e)(),O=y,j=(Object(a.g)(),Object(a.g)()),_=Object(a.g)()},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o}));r(80);var i=r(89),n=(r(208),r(263),r(205));r(192);class a{constructor(){this.cache=new Map}dispose(){this.cache.forEach((e=>{Object(i.k)(e.texture)&&(e.texture.dispose(),e.texture=null)})),this.cache.clear()}acquire(e){if(Object(i.j)(e))return null;var t=this.patternId(e),r=this.cache.get(t);if(r)return r.refCount++,r.bind;var a=this.patternToTextureData(e,2),s=a.length/2,o={refCount:1,texture:null,bind:(e,t)=>(Object(i.j)(o.texture)&&(o.texture=new n.a(e,{width:a.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},a)),e.bindTexture(o.texture,t),s)};return this.cache.set(t,o),o.bind}release(e){if(!Object(i.j)(e)){var t=this.patternId(e),r=this.cache.get(t);r&&(r.refCount--,0===r.refCount&&(Object(i.k)(r.texture)&&r.texture.dispose(),this.cache.delete(t)))}}swap(e,t){var r=this.acquire(t);return this.release(e),r}patternId(e){return e.join(",")}patternToTextureData(e,t){var r=e.reduce(((e,t)=>e+t))*t,i=new Uint8Array(r),n=!0,a=0;for(var s of e){for(var o=0;o<s*t;o++)i[a++]=n?255:0;n=!n}return i}}function s(e){return Object(i.j)(e)?e:e.slice()}function o(e){return[e,e]}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i,n=r(120),a=r(119),s=r(842);function o(e){e.fragment.uniforms.add("texWaveNormal","sampler2D"),e.fragment.uniforms.add("texWavePerturbation","sampler2D"),e.fragment.uniforms.add("waveParams","vec4"),e.fragment.uniforms.add("waveDirection","vec2"),e.include(s.b),e.fragment.code.add(Object(a.a)(i||(i=Object(n.a)(["\n      const vec2  FLOW_JUMP = vec2(6.0/25.0, 5.0/24.0);\n\n      vec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rg - 1.0;\n      }\n\n      float sampleNoiseTexture(vec2 _uv) {\n        return texture2D(texWavePerturbation, _uv).b;\n      }\n\n      vec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\n        return 2.0 * texture2D(_tex, _uv).rgb - 1.0;\n      }\n\n      float computeProgress(vec2 uv, float time) {\n        return fract(time);\n      }\n\n      float computeWeight(vec2 uv, float time) {\n        float progress = computeProgress(uv, time);\n        return 1.0 - abs(1.0 - 2.0 * progress);\n      }\n\n      vec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\n        float flowStrength = waveParams[2];\n        float flowOffset = waveParams[3];\n\n        vec2 flowVector = textureDenormalized2D(texFlow, uv) * flowStrength;\n\n        float progress = computeProgress(uv, time + phaseOffset);\n        float weight = computeWeight(uv, time + phaseOffset);\n\n        vec2 result = uv;\n        result -= flowVector * (progress + flowOffset);\n        result += phaseOffset;\n        result += (time - progress) * FLOW_JUMP;\n\n        return vec3(result, weight);\n      }\n\n      const float TIME_NOISE_TEXTURE_REPEAT = 0.3737;\n      const float TIME_NOISE_STRENGTH = 7.77;\n\n      vec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\n        float waveStrength = waveParams[0];\n\n        // overall directional shift in uv's for directional wave movement for\n        // now we do a hard coded scale for wave speed such that a unit length\n        // direction is not too fast.\n        vec2 waveMovement = time * -_waveDir;\n\n        float timeNoise = sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\n\n        // compute two perturbed uvs and blend weights\n        // then sample the wave normals at the two positions and blend\n        vec3 uv_A = computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\n        vec3 uv_B = computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\n\n        vec3 normal_A = textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\n        vec3 normal_B = textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\n\n        // logic to flatten the wave pattern\n        // scale xy components of the normal, then adjust z (up) component\n        vec3 mixNormal = normalize(normal_A + normal_B);\n        mixNormal.xy *= waveStrength;\n        mixNormal.z = sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\n\n        return mixNormal;\n      }\n\n      vec4 getSurfaceNormalAndFoam(vec2 _uv, float _time) {\n        float waveTextureRepeat = waveParams[1];\n        vec3 normal = getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\n        float foam  = normals2FoamIntensity(normal, waveParams[0]);\n        return vec4(normal, foam);\n      }\n    "]))))}(o||(o={})).bindUniforms=function(e,t){e.setUniform1i("texWaveNormal",0),e.setUniform1i("texWavePerturbation",1),e.setUniform4f("waveParams",t.waveStrength,t.waveTextureRepeat,t.flowStrength,t.flowOffset),e.setUniform2f("waveDirection",t.waveDirection[0]*t.waveVelocity,t.waveDirection[1]*t.waveVelocity)}},,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var i=r(91),n=r(104),a=r(111),s=r(434),o=r(279),c=r(368),l=r(179),u=r(388),d=r(328),h=r(379),p=r(491),f=r(82),b=r(200),m=r(300),v=r(307),g=r(313),y=r(286),O=r(267),j=r(380),_=r(249),w=r(349),x=r(280),S=r(700),M=r(757);class T extends v.a{initializeProgram(e){var t=T.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,screenSizeEnabled:r.screenSizeEnabled,shadingEnabled:r.shadingEnabled,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new y.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),P)}bindPass(e,t,r){var{screenSizeEnabled:i,shadingEnabled:n}=this.configuration,{color:a,shadingTint:s,shadingDirection:o}=t;j.a.bindProjectionMatrix(this.program,r.camera.projectionMatrix),this.program.setUniform4fv("color",a),r.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",r.camera.nearFar),this.program.setUniform2fv("inverseViewport",r.inverseViewport),Object(x.a)(this.program,e,r)),n&&(this.program.setUniform4fv("shadedColor",this.blendColor(C,s,a)),this.program.setUniform3fv("shadingDirection",o),this.program.setUniformMatrix4fv("viewNormal",r.camera.viewInverseTransposeMatrix)),i&&S.a.bindPassUniforms(this.program,t,r)}blendColor(e,t,r){var i=1-t[3],n=t[3]+r[3]*i;return 0===n?(e[3]=n,e):(e[0]=(t[0]*t[3]+r[0]*r[3]*i)/n,e[1]=(t[1]*t[3]+r[1]*r[3]*i)/n,e[2]=(t[2]*t[3]+r[2]*r[3]*i)/n,e[3]=r[3],e)}bindDraw(e){j.a.bindView(this.program,e),j.a.bindCamPosition(this.program,e.origin,e.camera.viewInverseTransposeMatrix),_.a.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e){var t=this.configuration,r=3===e,i=2===e;return Object(O.d)({blending:0!==t.output&&7!==t.output||!t.transparent?null:r?w.f:Object(w.a)(e),culling:(e=>0!==e&&{face:1===e?1028:1029,mode:2305})(t.cullFace),depthTest:{func:i?513:t.shadingEnabled?515:513},depthWrite:r?t.writeDepth&&O.c:Object(w.c)(e),colorWrite:O.b,polygonOffset:r||i?null:w.d})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}T.shader=new m.a(M.a,(()=>r.e(302).then(r.bind(null,1211))));class E extends g.a{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}Object(f.a)([Object(g.b)({count:8})],E.prototype,"output",void 0),Object(f.a)([Object(g.b)({count:3})],E.prototype,"cullFace",void 0),Object(f.a)([Object(g.b)()],E.prototype,"slicePlaneEnabled",void 0),Object(f.a)([Object(g.b)()],E.prototype,"transparent",void 0),Object(f.a)([Object(g.b)()],E.prototype,"writeDepth",void 0),Object(f.a)([Object(g.b)()],E.prototype,"screenSizeEnabled",void 0),Object(f.a)([Object(g.b)()],E.prototype,"shadingEnabled",void 0),Object(f.a)([Object(g.b)({count:4})],E.prototype,"transparencyPassType",void 0),Object(f.a)([Object(g.b)()],E.prototype,"multipassTerrainEnabled",void 0),Object(f.a)([Object(g.b)()],E.prototype,"cullAboveGround",void 0);var P={position:0,normal:1,offset:2},C=Object(b.c)();class I extends h.a{constructor(e){super(e,R),this.supportsEdges=!0,this.techniqueConfig=new E,this._vertexAttributeLocations=P}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.screenSizeEnabled=this.params.screenSizeEnabled,this.techniqueConfig.shadingEnabled=this.params.shadingEnabled,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}getPassParameters(){return this.params}intersect(e,t,r,i,n,s,c){if(this.params.screenSizeEnabled){var l=e.vertexAttributes.get("offset"),u={applyToVertex:(e,t,r,n)=>{var s=Object(a.v)(L,l.data[3*n+0],l.data[3*n+1],l.data[3*n+2]),o=Object(a.v)(D,e,t,r);return Object(a.d)(s,s,this.params.screenSize*i.camera.computeRenderPixelSizeAt(s)),Object(a.e)(o,o,s),[o[0],o[1],o[2]]},applyToAabb:e=>{var t=Object(o.b)(e,L);return Object(o.p)(e,this.params.screenSize*i.camera.computeRenderPixelSizeAt(t))}};Object(d.e)(e,t,i,n,s,u,c)}else Object(d.e)(e,t,i,n,s,void 0,c)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new A(e):void 0}createBufferWriter(){return new F(this.params.screenSizeEnabled)}}class A extends u.a{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(T,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){if(4===this.output)return 3===e;var t=3;return this.technique.configuration.transparent&&(t=this.technique.configuration.writeDepth?5:8),e===t}ensureParameters(e){this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}}var R=Object(i.a)({color:[1,1,1,1],shadingTint:[0,0,0,.25],shadingDirection:Object(a.q)(Object(n.e)(),[.5,-.5,-.5]),transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,screenSizeEnabled:!1,screenSize:14,shadingEnabled:!0},h.b);class F{constructor(e){this.screenSizeEnabled=e;var t=Object(c.a)().vec3f("position").vec3f("normal");this.screenSizeEnabled&&t.vec3f("offset"),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get("position").length}write(e,t,r,i){if(Object(p.c)(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i),this.screenSizeEnabled){if(!t.vertexAttributes.has("offset"))throw new Error("offset vertex attribute required for screenSizeEnabled ShadedColorMaterial");var n=t.vertexAttributes.get("offset"),a=t.indices.get("offset");Object(l.a)(3===n.size);var o=r.getField("offset",s.u);if(!o)throw new Error("unable to acquire view for offset");Object(p.e)(a,n.data,e.invTranspTransformation,o,i)}}}var L=Object(n.e)(),D=Object(n.e)()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(110);function n(e,t,r){var n,l=e.byteLength/(4*t),u=new Uint32Array(e,0,l*t),d=new Uint32Array(l),h=null!=(n=null==r?void 0:r.minReduction)?n:0,p=(null==r?void 0:r.originalIndices)||null,f=p?p.length:0,b=(null==r?void 0:r.componentOffsets)||null,m=0;if(b)for(var v=0;v<b.length-1;v++){var g=b[v+1]-b[v];g>m&&(m=g)}else m=l;var y=Math.floor(1.1*m)+1;(null==c||c.length<2*y)&&(c=new Uint32Array(Object(i.o)(2*y)));for(var O=0;O<2*y;O++)c[O]=0;for(var j=0,_=!!b&&!!p,w=_?f:l,x=_?new Uint32Array(f):null,S=1.96,M=0!==h?Math.ceil(4*S*S/(h*h)*h*(1-h)):w,T=1,E=b?b[1]:w,P=0;P<w;P++){if(P===M){var C=1-j/P;if(C+S*Math.sqrt(C*(1-C)/P)<h)return null;M*=2}if(P===E){for(var I=0;I<2*y;I++)c[I]=0;if(p)for(var A=b[T-1];A<b[T];A++)x[A]=d[p[A]];E=b[++T]}for(var R=_?p[P]:P,F=R*t,L=o(u,F,t),D=L%y,k=j;0!==c[2*D+1];){if(c[2*D]===L){var z=c[2*D+1]-1;if(a(u,F,z*t,t)){k=d[z];break}}++D>=y&&(D-=y)}k===j&&(c[2*D]=L,c[2*D+1]=R+1,j++),d[R]=k}if(0!==h&&1-j/l<h)return null;if(_){for(var V=b[T-1];V<x.length;V++)x[V]=d[p[V]];d=x}var N=new Uint32Array(t*j);j=0;for(var U=0;U<w;U++)d[U]===j&&(s(u,(_?p[U]:U)*t,N,j*t,t),j++);if(p&&!_){for(var B=new Uint32Array(f),q=0;q<B.length;q++)B[q]=d[p[q]];d=B}return{buffer:N.buffer,indices:d,uniqueCount:j}}function a(e,t,r,i){for(var n=0;n<i;n++)if(e[t+n]!==e[r+n])return!1;return!0}function s(e,t,r,i,n){for(var a=0;a<n;a++)r[i+a]=e[t+a]}function o(e,t,r){for(var i=0,n=0;n<r;n++)i=(i=e[t+n]+i|0)+(i<<11)+(i>>>2)|0;return i>>>0}var c=null},,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return o}));var i,n,a=r(120),s=r(119);function o(e){e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["\n    float normals2FoamIntensity(vec3 n, float waveStrength){\n      float normalizationFactor =  max(0.015, waveStrength);\n      return max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);\n    }\n  "]))))}function c(e){e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){\n      return foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;\n    }\n  "]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return P})),r.d(t,"b",(function(){return E}));var i,n,a,s,o,c,l,u,d,h,p=r(120),f=r(119),b=r(413),m=r(254),v=r(358),g=r(249),y=r(308),O=r(322),j=r(333),_=r(280),w=r(622),x=r(787),S=r(699),M=r(906),T=r(933);function E(e){var t=new m.a;return t.include(b.a,{linearDepth:!1}),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("localOrigin","vec3"),t.vertex.uniforms.add("waterColor","vec4"),0!==e.output&&7!==e.output||(t.include(M.a,e),t.include(S.a,e),t.varyings.add("vuv","vec2"),t.varyings.add("vpos","vec3"),t.varyings.add("vnormal","vec3"),t.varyings.add("vtbnMatrix","mat3"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.code.add(Object(f.a)(i||(i=Object(p.a)(["\n      void main(void) {\n        if (waterColor.a < ",") {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vuv = uv0;\n        vpos = position;\n\n        vnormal = getLocalUp(vpos, localOrigin);\n        vtbnMatrix = getTBNMatrix(vnormal);\n\n        ","\n\n        gl_Position = transformPosition(proj, view, vpos);\n        ","\n      }\n    "])),f.a.float(j.c),e.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":"",0===e.output?"forwardLinearDepth();":""))),e.multipassTerrainEnabled&&(t.fragment.include(y.a),t.include(_.b,e)),7===e.output&&(t.include(g.a,e),t.fragment.uniforms.add("waterColor","vec4"),t.fragment.code.add(Object(f.a)(n||(n=Object(p.a)(["\n        void main() {\n          discardBySlice(vpos);\n          ","\n\n          gl_FragColor = vec4(waterColor.a);\n        }\n      "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""))),0===e.output&&(t.include(x.a,e),t.include(g.a,e),e.receiveShadows&&t.include(w.a,e),t.include(T.a,e),t.fragment.uniforms.add("waterColor","vec4").add("lightingMainDirection","vec3").add("lightingMainIntensity","vec3").add("camPos","vec3").add("timeElapsed","float").add("view","mat4"),t.fragment.include(v.a),t.fragment.code.add(Object(f.a)(a||(a=Object(p.a)(["\n      void main() {\n        discardBySlice(vpos);\n        ","\n        vec3 localUp = vnormal;\n        // the created normal is in tangent space\n        vec4 tangentNormalFoam = getSurfaceNormalAndFoam(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n = normalize(vtbnMatrix * tangentNormalFoam.xyz);\n        vec3 v = -normalize(vpos - camPos);\n        vec3 l = normalize(-lightingMainDirection);\n        float shadow = ",";\n        vec4 vPosView = view*vec4(vpos, 1.0);\n        vec4 final = vec4(getSeaColor(n, v, l, waterColor.rgb, lightingMainIntensity, localUp, shadow, tangentNormalFoam.w, vPosView.xyz), waterColor.w);\n\n        // gamma correction\n        gl_FragColor = delinearizeGamma(final);\n        gl_FragColor = highlightSlice(gl_FragColor, vpos);\n        ","\n      }\n    "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.receiveShadows?Object(f.a)(s||(s=Object(p.a)(["1.0 - readShadowMap(vpos, linearDepth)"]))):"1.0",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""))),2===e.output&&(t.include(M.a,e),t.include(x.a,e),t.include(g.a,e),t.varyings.add("vpos","vec3"),t.varyings.add("vuv","vec2"),t.vertex.code.add(Object(f.a)(o||(o=Object(p.a)(["\n        void main(void) {\n          if (waterColor.a < ",") {\n            // Discard this vertex\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n            return;\n          }\n\n          vuv = uv0;\n          vpos = position;\n\n          gl_Position = transformPosition(proj, view, vpos);\n        }\n    "])),f.a.float(j.c))),t.fragment.uniforms.add("timeElapsed","float"),t.fragment.code.add(Object(f.a)(c||(c=Object(p.a)(["\n        void main() {\n          discardBySlice(vpos);\n\n          // the created normal is in tangent space and foam\n          vec4 tangentNormalFoam = getSurfaceNormalAndFoam(vuv, timeElapsed);\n          tangentNormalFoam.xyz = normalize(tangentNormalFoam.xyz);\n\n          gl_FragColor = vec4((tangentNormalFoam.xyz + vec3(1.0)) * 0.5, tangentNormalFoam.w);\n        }\n    "]))))),5===e.output&&(t.varyings.add("vpos","vec3"),t.vertex.code.add(Object(f.a)(l||(l=Object(p.a)(["\n        void main(void) {\n          if (waterColor.a < ",") {\n            // Discard this vertex\n            gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n            return;\n          }\n\n          vpos = position;\n          gl_Position = transformPosition(proj, view, vpos);\n        }\n    "])),f.a.float(j.c))),t.fragment.uniforms.add("waterColor","vec4"),t.fragment.code.add(Object(f.a)(u||(u=Object(p.a)(["\n        void main() {\n          gl_FragColor = waterColor;\n        }\n    "]))))),4===e.output&&(t.include(O.a),t.varyings.add("vpos","vec3"),t.vertex.code.add(Object(f.a)(d||(d=Object(p.a)(["\n      void main(void) {\n        if (waterColor.a < ",") {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vpos = position;\n        gl_Position = transformPosition(proj, view, vpos);\n      }\n    "])),f.a.float(j.c))),t.include(g.a,e),t.fragment.code.add(Object(f.a)(h||(h=Object(p.a)(["\n      void main() {\n        discardBySlice(vpos);\n        outputHighlight();\n      }\n    "]))))),t}var P=Object.freeze({__proto__:null,build:E})},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c}));var i,n=r(120),a=r(119),s=r(254),o=r(581);function c(){var e=new s.a;return e.include(o.a),e.fragment.uniforms.add("tex","sampler2D"),e.fragment.uniforms.add("color","vec4"),e.fragment.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    void main() {\n      vec4 texColor = texture2D(tex, uv);\n      gl_FragColor = texColor * color;\n    }\n  "])))),e}var l=Object.freeze({__proto__:null,build:c})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i,n,a=r(120),s=r(119),o=r(308);function c(e){e.fragment.uniforms.add("lastFrameColorMap","sampler2D"),e.fragment.uniforms.add("reprojectionMat","mat4"),e.fragment.uniforms.add("rpProjectionMat","mat4"),e.fragment.code.add(Object(s.a)(i||(i=Object(a.a)(["\n  vec2 reprojectionCoordinate(vec3 projectionCoordinate)\n  {\n    vec4 zw = rpProjectionMat * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);\n    vec4 reprojectedCoord = reprojectionMat * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);\n    reprojectedCoord.xy /= reprojectedCoord.w;\n    return reprojectedCoord.xy*0.5 + 0.5;\n  }\n  "]))))}function l(e,t){e.fragment.uniforms.add("nearFar","vec2"),e.fragment.uniforms.add("depthMapView","sampler2D"),e.fragment.uniforms.add("ssrViewMat","mat4"),e.fragment.uniforms.add("invResolutionHeight","float"),e.fragment.include(o.a),e.include(c),e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n  const int maxSteps = ","\n\n  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)\n  {\n    vec4 projectedCoord =  projectionMat * vec4(x, 1.0);\n    projectedCoord.xy /= projectedCoord.w;\n    projectedCoord.xy = projectedCoord.xy*0.5 + 0.5;\n    return projectedCoord;\n  }\n\n  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)\n  {\n    vec3 viewPos = startPosition;\n    vec3 viewPosEnd = startPosition;\n\n    // Project the start position to the screen\n    vec4 projectedCoordStart = applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q0 = viewPos / projectedCoordStart.w; // homogeneous camera space\n    float k0 = 1.0/ projectedCoordStart.w;\n\n    // advance the position in the direction of the reflection\n    viewPos += dir;\n\n    vec4 projectedCoordVanishingPoint = applyProjectionMat(rpProjectionMat, dir);\n\n    // Project the advanced position to the screen\n    vec4 projectedCoordEnd = applyProjectionMat(rpProjectionMat, viewPos);\n    vec3  Q1 = viewPos / projectedCoordEnd.w; // homogeneous camera space\n    float k1 = 1.0/ projectedCoordEnd.w;\n\n    // calculate the reflection direction in the screen space\n    vec2 projectedCoordDir = (projectedCoordEnd.xy - projectedCoordStart.xy);\n    vec2 projectedCoordDistVanishingPoint = (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);\n\n    float yMod = min(abs(projectedCoordDistVanishingPoint.y), 1.0);\n\n    float projectedCoordDirLength = length(projectedCoordDir);\n    float maxSt = float(maxSteps);\n\n    // normalize the projection direction depending on maximum steps\n    // this determines how blocky the reflection looks\n    vec2 dP = yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);\n\n    // Normalize the homogeneous camera space coordinates\n    vec3  dQ = yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);\n    float dk = yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);\n\n    // initialize the variables for ray marching\n    vec2 P = projectedCoordStart.xy;\n    vec3 Q = Q0;\n    float k = k0;\n    float rayStartZ = -startPosition.z; // estimated ray start depth value\n    float rayEndZ = -startPosition.z;   // estimated ray end depth value\n    float prevEstimateZ = -startPosition.z;\n    float rayDiffZ = 0.0;\n    float dDepth;\n    float depth;\n    float rayDiffZOld = 0.0;\n\n    // early outs\n    if (dot(normal, dir) < 0.0 || dot(-viewDir, normal) < 0.0)\n      return vec3(P, 0.0);\n\n    for(int i = 0; i < maxSteps-1; i++)\n    {\n      depth = -linearDepthFromTexture(depthMapView, P, nearFar); // get linear depth from the depth buffer\n\n      // estimate depth of the marching ray\n      rayStartZ = prevEstimateZ;\n      dDepth = -rayStartZ - depth;\n      rayEndZ = (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));\n      rayDiffZ = rayEndZ- rayStartZ;\n      prevEstimateZ = rayEndZ;\n\n      if(-rayEndZ > nearFar[1] || -rayEndZ < nearFar[0] || P.y < 0.0  || P.y > 1.0 )\n      {\n        return vec3(P, 0.);\n      }\n\n      // If we detect a hit - return the intersection point, two conditions:\n      //  - dDepth > 0.0 - sampled point depth is in front of estimated depth\n      //  - if difference between dDepth and rayDiffZOld is not too large\n      //  - if difference between dDepth and 0.025/abs(k) is not too large\n      //  - if the sampled depth is not behind far plane or in front of near plane\n\n      if((dDepth) < 0.025/abs(k) + abs(rayDiffZ) && dDepth > 0.0 && depth > nearFar[0] && depth < nearFar[1] && abs(P.y - projectedCoordStart.y) > invResolutionHeight)\n      {\n          return vec3(P, depth);\n      }\n\n      // continue with ray marching\n      P += dP;\n      Q.z += dQ.z;\n      k += dk;\n      rayDiffZOld = rayDiffZ;\n    }\n    return vec3(P, 0.0);\n  }\n  "])),t.highStepCount?"150;":"75;"))}(c||(c={})).bindUniforms=function(e,t,r){e.setUniform1i("lastFrameColorMap",r.lastFrameColorTextureUnit),t.bindTexture(r.lastFrameColorTexture,r.lastFrameColorTextureUnit),e.setUniformMatrix4fv("reprojectionMat",r.reprojectionMat),e.setUniformMatrix4fv("rpProjectionMat",r.camera.projectionMatrix)},(l||(l={})).bindUniforms=function(e,t,r){r.ssrEnabled&&(e.setUniform1i("depthMapView",r.linearDepthTextureUnit),t.bindTexture(r.linearDepthTexture,r.linearDepthTextureUnit),e.setUniform2fv("nearFar",r.camera.nearFar),e.setUniformMatrix4fv("ssrViewMat",r.camera.viewMatrix),e.setUniform1f("invResolutionHeight",1/r.camera.height),c.bindUniforms(e,t,r))}},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i,n,a,s,o=r(120),c=r(119);function l(e,t){1===t.viewingMode?e.vertex.code.add(Object(c.a)(i||(i=Object(o.a)(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return normalize(pos + origin);\n      }\n    "])))):e.vertex.code.add(Object(c.a)(n||(n=Object(o.a)(["\n      vec3 getLocalUp(in vec3 pos, in vec3 origin) {\n          return vec3(0.0, 0.0, 1.0); // WARNING: up-axis dependent code\n      }\n    "])))),1===t.viewingMode?e.vertex.code.add(Object(c.a)(a||(a=Object(o.a)(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t = normalize(cross(vec3(0.0, 0.0, 1.0), n));\n            vec3 b = normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "])))):e.vertex.code.add(Object(c.a)(s||(s=Object(o.a)(["\n        mat3 getTBNMatrix(in vec3 n) {\n            vec3 t = vec3(1.0, 0.0, 0.0);\n            vec3 b = normalize(cross(n, t));\n            return mat3(t, b, n);\n        }\n    "]))))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(89),n=r(104),a=r(111),s=r(157),o=r(174),c=r(191),l=r(373),u=r(471),d=r(920),h=r(468);class p extends h.a{constructor(e){super(e),this._renderOccluded=4,this._width=1,this._color=Object(l.c)(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stippleIntegerRepeats=!1,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this.applyProps(e)}setGeometryFromExtent(e){var t=this.view.spatialReference,r=Object(n.e)(),i=Object(n.e)(),s=100,o=[];Object(a.v)(r,e[0],e[1],s),this.view.renderCoordsHelper.toRenderCoords(r,t,i),o.push([i[0],i[1],i[2]]),Object(a.v)(r,e[2],e[1],s),this.view.renderCoordsHelper.toRenderCoords(r,t,i),o.push([i[0],i[1],i[2]]),Object(a.v)(r,e[2],e[3],s),this.view.renderCoordsHelper.toRenderCoords(r,t,i),o.push([i[0],i[1],i[2]]),Object(a.v)(r,e[0],e[3],s),this.view.renderCoordsHelper.toRenderCoords(r,t,i),o.push([i[0],i[1],i[2]]),Object(a.v)(r,e[0],e[1],s),this.view.renderCoordsHelper.toRenderCoords(r,t,i),o.push([i[0],i[1],i[2]]),Object(a.v)(r,e[0],e[1],s),this.view.renderCoordsHelper.toRenderCoords(r,t,i),o.push([i[0],i[1],i[2]]),this.geometry=[o]}setGeometryFromFrustum(e){var t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromSegment(e){var t=e.endRenderSpace;Object(s.i)(f),Object(s.s)(f,f,t),this.transform=f;var{points:r}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[r]}setGeometryFromSegments(e,t=n.b){Object(s.i)(f),Object(s.s)(f,f,t),this.transform=f,this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){Object(c.g)(e,this._color)||(Object(c.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){Object(i.k)(e)?!Object(i.j)(this._innerColor)&&Object(c.g)(e,this._innerColor)||(this._innerColor=Object(c.c)(Object(l.b)(),e),this._updateMaterial()):Object(i.k)(this._innerColor)&&(this._innerColor=null,this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){var t=Object(i.k)(e)!==Object(i.k)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){(Object(i.j)(e)||Object(i.j)(this._stippleOffColor)||!Object(c.g)(e,this._stippleOffColor))&&(this._stippleOffColor=Object(i.k)(e)?Object(l.a)(e):null,this._updateMaterial())}get stippleIntegerRepeats(){return this._stippleIntegerRepeats}set stippleIntegerRepeats(e){this._stippleIntegerRepeats!==e&&(this._stippleIntegerRepeats=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}createExternalResources(){this._material=new u.a(this.materialParameters)}destroyExternalResources(){this._material=null}createGeometries(e){var t=this._createLineGeometries();if(0!==t.length)for(var r=0;r<t.length;++r){var i=Object(d.a)(t[r]);e.addGeometry(i,this._material)}}forEachExternalMaterial(e){e(this._material)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,stippleIntegerRepeats:this._stippleIntegerRepeats,polygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateMaterial(){this.attached&&this._material.setParameterValues(this.materialParameters)}_createLineGeometries(){var e=this.geometry;if(Object(i.j)(e)||0===e.length)return[];var t=[];return e.forEach((e=>{var r=e.length,i=new Float64Array(3*r);e.forEach(((e,t)=>{i[3*t+0]=e[0],i[3*t+1]=e[1],i[3*t+2]=e[2]}));var n={attributeData:{position:i},removeDuplicateStartEnd:0};t.push(n)})),t}}var f=Object(o.b)()},,function(e,t,r){"use strict";var i=r(117);class n{constructor(e,t){this.measure=Object(i.o)(t),this.value=e,this.unit=t}get isBaseUnit(){return Object(i.k)(this.unit)}toUnit(e){return new n(Object(i.c)(this.value,this.unit,e),e)}toBaseUnit(){return this.toUnit(Object(i.b)(this.unit))}}t.a=n},,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return At})),r.d(t,"b",(function(){return Rt})),r.d(t,"c",(function(){return Lt}));var i=r(295),n=r(89),a=r(110),s=r(104),o=r(111),c=r(223),l=r(276);r(536),r(838);function u(e,t,r){for(var i=e.length,n=new Array(i),a=new Array(i),s=new Array(i),o=0,c=0,l=0,u=0,p=0;p<i;++p)u+=e[p].length;for(var f=new Float64Array(3*u),b=0,m=i-1;m>=0;m--){var v=e[m],g=1===r&&h(v);if(g&&1!==i)n[o++]=v;else{for(var y=v.length,O=0;O<o;++O)y+=n[O].length;var j={index:b,pathLengths:new Array(o+1),count:y,holeIndices:new Array(o)};j.pathLengths[0]=v.length,v.length>0&&(s[l++]={index:b,count:v.length}),b=g?d(v,v.length-1,-1,f,b,v.length,t):d(v,0,1,f,b,v.length,t);for(var _=0;_<o;++_){var w=n[_];j.holeIndices[_]=b,j.pathLengths[_+1]=w.length,w.length>0&&(s[l++]={index:b,count:w.length}),b=d(w,0,1,f,b,w.length,t)}o=0,j.count>0&&(a[c++]=j)}}for(var x=0;x<o;++x){var S=n[x];S.length>0&&(s[l++]={index:b,count:S.length}),b=d(S,0,1,f,b,S.length,t)}return c<i&&(a.length=c),l<i&&(s.length=l),{position:f,polygons:a,outlines:s}}function d(e,t,r,i,n,a,s){n*=3;for(var o=0;o<a;++o){var c=e[t];i[n++]=c[0],i[n++]=c[1],i[n++]=s?c[2]:0,t+=r}return n/3}function h(e){return!Object(l.g)(e,!1,!1)}var p=r(463),f=r(601),b=r(7),m=r(82),v=(r(80),r(81)),g=(r(88),r(85)),y=r(84),O=(r(83),r(86),r(87),r(176)),j=r(97),_=r(189),w=r(115),x=r(108),S=r(157),M=r(289),T=r(567),E=r(202),P=r(205),C=r(478),I=r(523);class A{constructor(e=Object(s.e)(),t=Object(s.g)(.57735,.57735,.57735),r=!0){this.intensity=e,this.direction=t,this.castShadows=r}}class R{constructor(e=Object(s.e)(),t=Object(s.g)(.57735,.57735,.57735)){this.intensity=Object(s.e)(),this.direction=Object(s.e)(),this.intensity=e,this.direction=t}}class F{constructor(e=Object(s.e)()){this.intensity=e}}class L{constructor(){this.sh={r:[0],g:[0],b:[0]}}}var D=r(634),k=r(698),z=class extends j.a{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.SCENEVIEW_LOCKING_LOG=!1,this.HIGHLIGHTS_GRID_OPTIMIZATION_ENABLED=!0,this.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_UPDATE_THRESHOLDS=!1,this.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1,this.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.ENABLE_PROFILE_DEPTH_RANGE=!1,this.DISABLE_FAST_UPDATES=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1}};Object(m.a)([Object(g.b)()],z.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),Object(m.a)([Object(g.b)()],z.prototype,"SCENEVIEW_LOCKING_LOG",void 0),Object(m.a)([Object(g.b)()],z.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_ENABLED",void 0),Object(m.a)([Object(g.b)()],z.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DECONFLICTOR_SHOW_GRID",void 0),Object(m.a)([Object(g.b)()],z.prototype,"LABELS_SHOW_BORDER",void 0),Object(m.a)([Object(g.b)()],z.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),Object(m.a)([Object(g.b)()],z.prototype,"OVERLAY_SHOW_CENTER",void 0),Object(m.a)([Object(g.b)()],z.prototype,"SHOW_POI",void 0),Object(m.a)([Object(g.b)()],z.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),Object(m.a)([Object(g.b)()],z.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"I3S_TREE_SHOW_TILES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"I3S_SHOW_MODIFICATIONS",void 0),Object(m.a)([Object(g.b)()],z.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0),Object(m.a)([Object(g.b)()],z.prototype,"DISABLE_FAST_UPDATES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),Object(m.a)([Object(g.b)()],z.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),Object(m.a)([Object(g.b)()],z.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);var V=new(z=Object(m.a)([Object(y.a)("esri.views.3d.support.DebugFlags")],z)),N=r(569),U=(r(208),r(263),r(192));class B{constructor(e,t){this.id=Object(_.a)(),this._renderTarget=null,this._renderTarget=new U.a(e,{colorTarget:0,depthStencilTarget:0},{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9987,hasMipmap:t,maxAnisotropy:8,width:0,height:0})}dispose(){this._renderTarget=Object(n.f)(this._renderTarget)}getTexture(){return this._renderTarget?this._renderTarget.colorTexture:null}isValid(){return null!==this._renderTarget}resize(e,t){this._renderTarget.resize(e,t)}bind(e){e.bindFramebuffer(this._renderTarget)}generateMipMap(){this._renderTarget.colorTexture.descriptor.hasMipmap&&this._renderTarget.colorTexture.generateMipmap()}disposeRenderTargetMemory(){this._renderTarget&&this._renderTarget.resize(0,0)}getGpuMemoryUsage(){var e=0;return this._renderTarget&&(e+=Object(C.c)(this._renderTarget)),e}}var q=r(125);class G{constructor(e,t){this.vec3=e,this.id=t}}function H(e,t,r,i){return new G(Object(s.g)(e,t,r),i)}class W{constructor(e){this.extent=Object(q.i)(),this.resolution=0,this.renderLocalOrigin=H(0,0,0,"O"),this.pixelRatio=1,this.renderTargets={color:{fbo:new B(e,!0),valid:!1,lastUsed:1/0},colorWithoutRasterImage:{fbo:new B(e,!0),valid:!1,lastUsed:1/0},highlight:{fbo:new B(e,!1),valid:!1,lastUsed:1/0},water:{fbo:new B(e,!0),valid:!1,lastUsed:1/0},occluded:{fbo:new B(e,!0),valid:!1,lastUsed:1/0}}}dispose(){this.renderTargets.color.fbo.dispose(),this.renderTargets.colorWithoutRasterImage.fbo.dispose(),this.renderTargets.highlight.fbo.dispose(),this.renderTargets.water.fbo.dispose(),this.renderTargets.occluded.fbo.dispose()}drawRenderTargets(e,t,r){var i=this.renderTargets;i.color.valid=e.drawPass(0,i.color.fbo,t),i.highlight.valid=e.drawPass(5,i.highlight.fbo,t),i.water.valid=e.drawPass(3,i.water.fbo,t),i.occluded.valid=e.drawPass(0,i.occluded.fbo,t,1),i.colorWithoutRasterImage.valid=r&&e.drawPass(0,i.colorWithoutRasterImage.fbo,t,2)}computeRenderTargetValidityBitfield(){var e=this.renderTargets;return+e.color.valid|+e.colorWithoutRasterImage.valid<<1|+e.highlight.valid<<2|+e.water.valid<<3|+e.occluded.valid<<4}validateUsage(e,t){if(e.valid)e.lastUsed=t;else if(t-e.lastUsed>J)e.fbo.disposeRenderTargetMemory(),e.lastUsed=1/0;else if(e.lastUsed<1/0)return!0;return!1}collectUnusedMemory(e){var t=!1;return t=this.validateUsage(this.renderTargets.color,e)||t,t=this.validateUsage(this.renderTargets.colorWithoutRasterImage,e)||t,t=this.validateUsage(this.renderTargets.highlight,e)||t,t=this.validateUsage(this.renderTargets.occluded,e)||t,t=this.validateUsage(this.renderTargets.water,e)||t}getGpuMemoryUsage(){return this.renderTargets.color.fbo.getGpuMemoryUsage()+this.renderTargets.colorWithoutRasterImage.fbo.getGpuMemoryUsage()+this.renderTargets.highlight.fbo.getGpuMemoryUsage()+this.renderTargets.water.fbo.getGpuMemoryUsage()+this.renderTargets.occluded.fbo.getGpuMemoryUsage()}}var J=1e3,Z=r(209);class X{constructor(){this._uniforms={proj:[],uShadowMapDistance:[],viewportPixelSz:[],lightingMainDirection:[]}}dispose(){this._uniforms=null}getPrograms(e){return this._uniforms[e]||[]}subscribeProgram(e){for(var t in this._uniforms)e.hasUniform(t)&&this._uniforms[t].push(e)}unsubscribeProgram(e){for(var t in this._uniforms)Object(Z.j)(this._uniforms[t],e)}}class Y{constructor(e){this.technique=e,this.refCount=0,this.refZeroFrame=0}}class Q{constructor(e){this._context=e,this._perConstructorInstances=new Map,this._frameCounter=0,this._keepAliveFrameCount=1200}get viewingMode(){return this._context.viewingMode}get constructionContext(){return this._context}dispose(){this._perConstructorInstances.forEach((e=>e.forEach((e=>e.technique.dispose())))),this._perConstructorInstances.clear()}acquire(e,t){var r=t.key,i=this._perConstructorInstances.get(e);i||(i=new Map,this._perConstructorInstances.set(e,i));var n=i.get(r);return void 0===n&&(n=new Y(new e(this._context,t)),i.set(r,n)),++n.refCount,n.technique}acquireAndReleaseExisting(e,t,r){return Object(n.j)(r)?this.acquire(e,t):t.key===r.key&&r instanceof e?r:(this.release(r),this.acquire(e,t))}release(e){if(!Object(n.j)(e)){var t=this._perConstructorInstances.get(e.constructor).get(e.key);t.refCount-=1,0===t.refCount&&(t.refZeroFrame=this._frameCounter)}}frameUpdate(){this._frameCounter++,this._perConstructorInstances.forEach(((e,t)=>{e.forEach(((t,r)=>{0===t.refCount&&t.refZeroFrame+this._keepAliveFrameCount<this._frameCounter&&(t.technique.dispose(),e.delete(r))})),0===e.size&&this._perConstructorInstances.delete(t)}))}getProgramsUsingUniform(e){return this._context.commonUniformStore.getPrograms(e)}hotReload(){var e=this;return Object(b.a)((function*(){var t=new Array;e._perConstructorInstances.forEach(((r,i)=>{var n=function(){var t=Object(b.a)((function*(t,r){var i=r.shader;i&&(yield i.reload(),t.forEach((t=>{t.technique.reload(e._context)})))}));return function(e,r){return t.apply(this,arguments)}}();t.push(n(r,i))})),yield Promise.all(t)}))()}}var K=r(179),$=[{output:0,name:"color"},{output:1,name:"depth"},{output:2,name:"normal"},{output:3,name:"depthShadowMap"},{output:4,name:"highlight"},{output:5,name:"draped"},{output:6,name:"occlusion"},{output:7,name:"alpha"}];function ee(e,t){return e+"_"+$.find((e=>e.output===t)).name}var te=v.a.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRep");class re{constructor(e){this.refCnt=0,this.glMaterial=e}incRefCnt(){++this.refCnt}decRefCnt(){--this.refCnt,Object(K.a)(this.refCnt>=0)}getRefCnt(){return this.refCnt}getGLMaterial(){return this.glMaterial}}var ie=class{constructor(e,t,r){this._textureRep=e,this._techniqueRep=t,this.onMaterialChanged=r,this._id2glMaterialRef=new Map}dispose(){this._textureRep.dispose()}acquire(e,t){this.ownMaterial(e);var r=ee(e.id,t),i=this._id2glMaterialRef.get(r);if(null==i){var n=e.getGLMaterial({material:e,techniqueRep:this._techniqueRep,textureRep:this._textureRep,output:t});return(i=new re(n)).incRefCnt(),this._id2glMaterialRef.set(r,i),n}return i.incRefCnt(),i.getGLMaterial()}release(e,t){var r=ee(e.id,t),i=this._id2glMaterialRef.get(r);if(i.decRefCnt(),0===i.getRefCnt()){var n=i.getGLMaterial();n&&n.dispose(),this._id2glMaterialRef.delete(r)}}materialChanged(e){for(var t of $)if(5!==t.output&&6!==t.output){var r=this._id2glMaterialRef.get(ee(e.id,t.output));if(r&&r.getGLMaterial()){var i=r.getGLMaterial();i.updateParameters&&i.updateParameters()}}this.onMaterialChanged&&this.onMaterialChanged(e)}ownMaterial(e){Object(n.k)(e.materialRepository)&&e.materialRepository!==this&&te.error("Material is already owned by a different material repository"),e.materialRepository=this}},ne=r(99),ae=r(174),se=r(453),oe=r(509),ce=r(471),le=0;class ue{constructor(){this.ROOT_ORIGIN_ID="rg_root_"+le++,this._origins=new Map,this._gridSize=42e5}getOrigin(e){var t=this._origins.get(this.ROOT_ORIGIN_ID);if(null==t){if(Object(n.k)(ue.testOrigin)){var r=ue.testOrigin;return this._origins.set(this.ROOT_ORIGIN_ID,H(r[0],r[1],r[2],this.ROOT_ORIGIN_ID)),this.getOrigin(e)}var i=H(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);return this._origins.set(this.ROOT_ORIGIN_ID,i),i}Object(o.i)(de,e,t.vec3),de[0]=Math.abs(de[0]),de[1]=Math.abs(de[1]),de[2]=Math.abs(de[2]);var a=this._gridSize;if(de[0]<a&&de[1]<a&&de[2]<a)return t;var s=Math.round(e[0]/a),c=Math.round(e[1]/a),l=Math.round(e[2]/a),u="".concat("rg_").concat(s,"/").concat(c,"/").concat(l),d=this._origins.get(u);return d||(d=H(s*a,c*a,l*a,u),this._origins.set(u,d)),d}_drawOriginBox(e){var t=window.view,r=t._stage;if(null==this._object){this._material=new ce.a({width:2,color:[0,1,0,1]}),r.add(this._material);var i=new oe.a({isPickable:!1});this._object=new se.a({castShadow:!1}),r.add(this._object),i.add(this._object),r.add(i)}for(var n=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],a=n.length,s=new Array(3*a),o=new Uint16Array(2*(a-1)),l=.5*this._gridSize,u=0;u<a;u++)s[3*u+0]=e[0]+(1&n[u]?l:-l),s[3*u+1]=e[1]+(2&n[u]?l:-l),s[3*u+2]=e[2]+(4&n[u]?l:-l),u>0&&(o[2*u+0]=u-1,o[2*u+1]=u);Object(c.k)(s,ne.a.WebMercator,0,s,t.spatialReference,0,a);var d=new p.a([["position",{size:3,data:s,exclusive:!0}]],[["position",o]],2);r.add(d),this._object.addGeometry(d,this._material,ae.a),console.log(this._origins.size,e)}}var de=Object(s.e)();(ue||(ue={})).testOrigin=null;var he=ue;var pe=13,fe=class{constructor(e,t,r,i,n,a){this.rctx=e,this.offscreenRenderingHelper=t,this.scenelightingData=r,this.shadowMap=i,this.ssaoHelper=n,this.sliceHelper=a,this.camera=null,this.lastFrameCamera=new k.a,this.pass=0,this.slot=0,this.highlightDepthTexture=null,this.renderOccludedMask=pe,this.hasOccludees=!1}resetRenderOccludedMask(){this.renderOccludedMask=pe}get isHighlightPass(){return 5===this.pass}},be=r(379);class me{constructor(){this.adds=new O.a,this.removes=new O.a,this.updates=new O.a({allocator:e=>e||new ve,deallocator:e=>(e.renderGeometry=null,e)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}}class ve{}class ge{constructor(){this.adds=new Array,this.removes=new Array,this.updates=new Array}}function ye(e){return e.data.indexCount>=1}var Oe=r(570),je=r(325),_e=r(326),we=r(357);class xe{constructor(e){null==e?e=16:e<65536&&(e=Object(a.o)(e)),this._array=new Float32Array(e),this._size=0}resize(e,t){if(this._size=e,this._size>this._array.length){for(var r=this._array.length||1;r<this._size;)r*=2;var i=new Float32Array(r);return t&&i.set(this._array),this._array=i,!0}var n=2*this._size;if(n<=this._array.length){for(var a=this._array.length;a>=n;)a=Math.floor(a/2);var s=new Float32Array(a);return t&&s.set(this._array.subarray(0,a)),this._array=s,!0}return!1}append(e){var t=this._size;this.resize(this._size+e.length,!0),this._array.set(e,t)}erase(e,t){for(var r=e;r<t;++r)this._array[r]=0}get array(){return this._array}get size(){return this._size}}var Se=r(388),Me=r(300),Te=r(307),Ee=r(313),Pe=r(306),Ce=r(286),Ie=r(267),Ae=r(380),Re=r(617),Fe=r(249),Le=r(322),De=r(349),ke=r(280),ze=r(622),Ve=r(880),Ne=r(787),Ue=r(843);class Be extends Te.a{constructor(e,t){super(e,t),this.waterTextureRepository=e.waterTextureRepository}initializeProgram(e){var t=Be.shader.get(),r=this.configuration,i=t.build({OITEnabled:0===r.transparencyPassType,output:r.output,viewingMode:e.viewingMode,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:r.receiveShadows,pbrMode:3,useCustomDTRExponentForWater:!0,ssrEnabled:r.useSSR,highStepCount:!0,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new Ce.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),Pe.a)}ensureResource(e){return this.waterTextureRepository.ready||this.waterTextureRepository.updating||this.waterTextureRepository.loadTextures(e),this.waterTextureRepository.ready?2:1}bindPass(e,t,r){Ae.a.bindProjectionMatrix(this.program,r.camera.projectionMatrix),r.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",r.camera.nearFar),this.program.setUniform2fv("inverseViewport",r.inverseViewport),Object(ke.a)(this.program,e,r)),0===this.configuration.output&&(r.lighting.setUniforms(this.program,!1),Ve.a.bindUniforms(this.program,e,r)),0!==this.configuration.output&&2!==this.configuration.output||(Ne.a.bindUniforms(this.program,t),this.waterTextureRepository.bindRepo(e)),this.program.setUniform4fv("waterColor",t.color),4===this.configuration.output&&Le.a.bindOutputHighlight(e,this.program,r)}bindDraw(e){Ae.a.bindView(this.program,e),0!==this.configuration.output&&7!==this.configuration.output||Ae.a.bindCamPosition(this.program,e.origin,e.camera.viewInverseTransposeMatrix),0===this.configuration.output&&ze.a.bindUniforms(this.program,e,Re.a.SHADOW_MAP),0!==this.configuration.output&&7!==this.configuration.output&&4!==this.configuration.output||Fe.a.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e){var t=this.configuration,r=3===e,i=2===e;return Object(Ie.d)({blending:2!==t.output&&4!==t.output&&t.transparent?r?De.f:Object(De.a)(e):null,depthTest:{func:Object(De.b)(e)},depthWrite:r?t.writeDepth&&Ie.c:Object(De.c)(e),colorWrite:Ie.b,polygonOffset:r||i?null:Object(De.g)(t.enableOffset)})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}Be.shader=new Me.a(Ue.a,(()=>r.e(304).then(r.bind(null,1209))));class qe extends Ee.a{constructor(){super(...arguments),this.output=0,this.receiveShadows=!1,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!1,this.useSSR=!1,this.isDraped=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}Object(m.a)([Object(Ee.b)({count:8})],qe.prototype,"output",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"receiveShadows",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"slicePlaneEnabled",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"transparent",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"enableOffset",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"writeDepth",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"useSSR",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"isDraped",void 0),Object(m.a)([Object(Ee.b)({count:4})],qe.prototype,"transparencyPassType",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"multipassTerrainEnabled",void 0),Object(m.a)([Object(Ee.b)()],qe.prototype,"cullAboveGround",void 0);class Ge extends Se.a{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(Be,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){if(2===this.output)return 22===e;if(5===this.output)return null==e;if(4===this.output)return 3===e;var t=3;return this.material.params.transparent&&(t=this.material.params.writeDepth?5:8),e===t}setElapsedTimeUniform(e){var t=.001*this.material.animation.time;e.setUniform1f("timeElapsed",t*this.material.params.animationSpeed)}_updateShadowState(e){e.shadowMappingEnabled!==this.material.params.receiveShadows&&this.material.setParameterValues({receiveShadows:e.shadowMappingEnabled})}_updateSSRState(e){e.ssrEnabled!==this.material.params.ssrEnabled&&this.material.setParameterValues({ssrEnabled:e.ssrEnabled})}ensureResources(e){return this.technique.ensureResource(e)}ensureParameters(e){0===this.output&&(this._updateShadowState(e),this._updateSSRState(e)),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.params,t),2!==this.output&&0!==this.output||this.setElapsedTimeUniform(this.technique.program)}}class He{constructor(e,t,r,i,n,a){this.from=e,this.to=t,this.isVisible=r,this.hasHighlights=i,this.hasOccludees=n,this.transformation=a,null!=a&&(this.transformationNormal=Object(ae.c)(a),Object(S.a)(this.transformationNormal,this.transformationNormal),Object(S.b)(this.transformationNormal,this.transformationNormal))}}function We(e,t){var r=e=>({first:e.from,count:e.to-e.from});if(0!==e.length){var i=e[e.length-1];if(function(e,t){return e.first+e.count>=t.from}(i,t)){var n=t.from-i.first+t.to-t.from;i.count=n}else e.push(r(t))}else e.push(r(t))}r(126);var Je=r(343);function Ze(e,t,r){Object(n.k)(r)&&(r.drawCalls+=e,r.triangles+=t)}Je.a;function Xe(e){return e.hasOccludees||e.hasHighlights||e.hasHiddenInstances}var Ye={begin:0,end:0},Qe=Object(ae.b)(),Ke=Object(ae.b)(),$e=Object(ae.b)(),et=class{constructor(e,t,r){this.type="MergedRenderer",this._dataByOrigin=new Map,this._hasHighlights=!1,this._hasOccludees=!1,this._rctx=e,this._material=r,this._materialRep=t,this._glMaterials=Object(we.a)(this._material,this._materialRep),this._bufferWriter=r.createBufferWriter()}dispose(){Object(we.e)(this._material,this._materialRep),this._dataByOrigin&&(this._dataByOrigin.forEach((e=>{e.vao.dispose(!0),e.vao=null})),this._dataByOrigin.clear(),this._dataByOrigin=null),this._glMaterials&&(this._glMaterials.forEach((e=>{e&&e.dispose()})),this._glMaterials.clear(),this._glMaterials=null)}get isEmpty(){return 0===this._dataByOrigin.size}get hasHighlights(){return this._hasHighlights}get hasOccludees(){return this._hasOccludees}get hasWater(){return!this.isEmpty&&Object(T.a)(this._glMaterials,(e=>e instanceof Ge))}get rendersOccluded(){return!this.isEmpty&&1!==this._material.renderOccluded}modify(e){this.updateGeometries(e.updates),this.addAndRemoveGeometries(e.adds,e.removes),this.updateRenderCommands()}addAndRemoveGeometries(e,t){var r=this._bufferWriter,i=r.vertexBufferLayout,n=i.stride/4,a=this._dataByOrigin,s=function(e,t,r,i){var n=new Map,a=t.vertexBufferLayout.stride/4,s=(r,i)=>{var s=r.origin,o=e.get(s.id),c=n.get(s.id);null==c&&(c={optimalCount:null==o?0:o.optimalCount,sparseCount:null==o?0:o.buffer.size,toAdd:[],toRemove:[],origin:s.vec3},n.set(s.id,c));var l=t.elementCount(r.data)*a;i?(c.optimalCount+=l,c.sparseCount+=l,c.toAdd.push(r)):(c.optimalCount-=l,c.toRemove.push(r))};for(var o of r)s(o,!0);for(var c of i)s(c,!1);return n}(a,r,e,t);s.forEach(((e,t)=>{s.delete(t);var r=e.optimalCount,o=e.sparseCount,c=a.get(t);if(null==c)Object(K.a)(r>0),c=this.createData(i,r,e.origin),a.set(t,c);else if(0===r)return c.vao.dispose(!0),c.vao=null,void a.delete(t);var l=r<e.sparseCount/2,u=l?r:o,d=Ye,h=c.buffer.size,p=c.buffer.array,f=c.buffer.resize(u,!1);l||f?this.removeAndRebuild(c,e.toRemove,n,p,d):e.toRemove.length>0?(this.removeByErasing(c,e.toRemove,n,d),e.toAdd.length>0&&(d.end=h)):(d.begin=h,d.end=h);var b=Qe;Object(K.j)(b,-e.origin[0],-e.origin[1],-e.origin[2]),this.append(c,e.toAdd,n,b,d);var m=c.vao.vertexBuffers.geometry;if(m.byteSize!==c.buffer.array.buffer.byteLength)m.setData(c.buffer.array);else{var{begin:v,end:g}=d;if(v<g){var y=c.buffer.array,O=4*v,j=4*g;m.setSubData(y,O,O,j)}}c.drawCommandsDirty=!0}))}updateGeometries(e){var t=this._bufferWriter,r=t.vertexBufferLayout.stride/4;for(var i of e){var n=i.updateType,a=i.renderGeometry,s=this._dataByOrigin.get(a.origin.id),o=s&&s.instances.get(a.id);if(!o)return;if(1&n&&(o.isVisible=a.instanceParameters.visible),9&n){var c=a.instanceParameters.visible;o.hasHighlights=!!a.instanceParameters.highlights&&c}if(16&n&&(o.hasOccludees=!!a.instanceParameters.occludees),6&n){var l=s.buffer.array,u=s.vao;Object(we.c)(a,Ke,$e),t.write({transformation:Ke,invTranspTransformation:$e},a.data,t.vertexBufferLayout.createView(l.buffer),o.from),Object(K.a)(o.from+t.elementCount(a.data)===o.to,"material VBO layout has changed"),u.vertexBuffers.geometry.setSubData(l,o.from*r*4,o.from*r*4,o.to*r*4)}s.drawCommandsDirty=!0}}updateRenderCommands(){this._hasHighlights=!1,this._hasOccludees=!1,this._dataByOrigin.forEach((e=>{e.hasHiddenInstances=!1,e.hasHighlights=!1,e.hasOccludees=!1,Object(T.a)(e.instances,(t=>(t.isVisible?(t.hasHighlights&&(this._hasHighlights=!0,e.hasHighlights=!0),t.hasOccludees&&(this._hasOccludees=!0,e.hasOccludees=!0)):e.hasHiddenInstances=!0,e.hasHiddenInstances&&e.hasHighlights&&e.hasOccludees)))}));this._dataByOrigin.forEach((e=>{e.drawCommandsDirty&&((e=>{if(e.drawCommandsDefault=null,e.drawCommandsHighlight=null,e.drawCommandsOccludees=null,e.drawCommandsShadowHighlightRest=null,e.stats={default:0,highlight:0,occludees:0,shadowHighlightRest:0},0!==e.instances.size){if(!Xe(e)){var t=4*e.buffer.size/Object(C.d)(e.vao.layout.geometry);return e.drawCommandsDefault=[{first:0,count:t}],void(e.stats={default:t,highlight:0,occludees:0,shadowHighlightRest:0})}var r=function(e){return e.sort(((e,t)=>e.from===t.from?e.to>t.to?1:e.to<t.to?-1:0:e.from>t.from?1:e.from<t.from?-1:0))}([...e.instances.values()]);for(var i of(e.drawCommandsDefault=[],e.drawCommandsHighlight=[],e.drawCommandsOccludees=[],e.drawCommandsShadowHighlightRest=[],r))i.isVisible&&(i.hasOccludees?We(e.drawCommandsOccludees,i):We(e.drawCommandsDefault,i),i.hasHighlights?We(e.drawCommandsHighlight,i):We(e.drawCommandsShadowHighlightRest,i));var n=e=>{var t=0;for(var r of e)t+=r.count;return t/3};e.stats={default:n(e.drawCommandsDefault),highlight:n(e.drawCommandsHighlight),occludees:n(e.drawCommandsOccludees),shadowHighlightRest:n(e.drawCommandsShadowHighlightRest)}}})(e),e.drawCommandsDirty=!1)}))}updateLogic(e){return this._material.update(e)}render(e,t,r,i){var a=this._rctx,s=this._glMaterials.get(t.pass),o=5===t.pass||7===t.pass,c=6===t.pass,l=!(o||c),u=e;if(3===t.pass&&null===u&&(u=22),!s||2!==s.ensureResources(a)||null!=u&&!s.beginSlot(u)||o&&!this._hasHighlights)return!1;s.ensureParameters(r);var d=s.getTechnique(),h=s.getPipelineState(u,!1);a.setPipelineState(h),s.bind(a,r);var p=!1;return this._dataByOrigin.forEach((e=>{if(!(Object(n.j)(e.drawCommandsDefault)&&Object(n.j)(e.drawCommandsHighlight)&&Object(n.j)(e.drawCommandsOccludees)&&Object(n.j)(e.drawCommandsShadowHighlightRest))&&(!o||e.hasHighlights)){r.origin=e.origin,d.bindDraw(r),d.ensureAttributeLocations(e.vao),a.bindVAO(e.vao);var t=d.primitiveType,f=o?e.drawCommandsHighlight:c&&Xe(e)?e.drawCommandsShadowHighlightRest:e.drawCommandsDefault,b=o?e.stats.highlight:c&&Xe(e)?e.stats.shadowHighlightRest:e.stats.default;if(Object(n.k)(f)&&(this.renderCommands(a,t,f),Ze(f.length,b,i),p=!0),l&&(f=e.drawCommandsOccludees,Object(n.k)(f))){var m=s.getPipelineState(u,!0);a.setPipelineState(m),this.renderCommands(a,t,f),a.setPipelineState(h),Ze(f.length,e.stats.occludees,i),p=!0}}})),p}renderCommands(e,t,r){for(var i=0;i<r.length;i++)e.drawArrays(t,r[i].first,r[i].count)}createData(e,t,r){return{instances:new Map,vao:new _e.a(this._rctx,this._material.vertexAttributeLocations,{geometry:Object(Oe.a)(e)},{geometry:je.a.createVertex(this._rctx,35044)}),buffer:new xe(t),optimalCount:0,origin:r,hasHiddenInstances:!1,hasHighlights:!1,hasOccludees:!1,drawCommandsDirty:!1,drawCommandsDefault:null,drawCommandsOccludees:null,drawCommandsHighlight:null,drawCommandsShadowHighlightRest:null,stats:{default:0,highlight:0,occludees:0,shadowHighlightRest:0}}}removeAndRebuild(e,t,r,i,n){for(var a of t){var s=a.id,o=e.instances.get(s);e.optimalCount-=(o.to-o.from)*r,e.instances.delete(s)}var c=0,l=e.buffer.array;n.begin=0,n.end=0;var u=-1,d=-1,h=0;e.instances.forEach((e=>{var t=e.from*r,n=e.to*r,a=n-t;u!==d&&d!==t?(l.set(i.subarray(u,d),h),h+=d-u,u=t):-1===u&&(u=t),d=n,e.from=c/r,c+=a,e.to=c/r})),u!==d&&l.set(i.subarray(u,d),h),n.end=c}removeByErasing(e,t,r,i){i.begin=1/0,i.end=-1/0;var n=-1,a=-1;for(var s of t){var o=s.id,c=e.instances.get(o),l=c.from*r,u=c.to*r;n!==a&&a!==l?(e.buffer.erase(n,a),n=l):-1===n&&(n=l),a=u,e.instances.delete(o),e.optimalCount-=u-l,l<i.begin&&(i.begin=l),u>i.end&&(i.end=u)}n!==a&&e.buffer.erase(n,a)}append(e,t,r,i,a){var s=this._bufferWriter;for(var o of t){var c=Object(n.k)(o.transformation)?Object(S.l)(Ke,i,o.transformation):i;Object(S.a)($e,c),Object(S.b)($e,$e);var l=a.end;s.write({transformation:c,invTranspTransformation:$e},o.data,s.vertexBufferLayout.createView(e.buffer.array.buffer),a.end/r);var u=s.elementCount(o.data)*r,d=l+u;Object(K.a)(null==e.instances.get(o.id));var h=o.instanceParameters.visible,p=!!o.instanceParameters.highlights&&h,f=!!o.instanceParameters.occludees,b=new He(l/r,d/r,h,p,f);e.instances.set(o.id,b),e.optimalCount+=u,a.end+=u}}get test(){return{material:this._material,glMaterials:this._glMaterials}}},tt=class extends j.a{constructor(){super(...arguments),this._pendingAddsRemoves=new Map,this._changes=new me,this._materialRenderers=new Map,this._sortedMaterialRenderers=new O.a,this._hasHighlights=!1,this._hasWater=!1}dispose(){this._changes.prune(),this._materialRenderers&&(this._materialRenderers.forEach((e=>e.dispose())),this._materialRenderers.clear(),this._sortedMaterialRenderers.clear())}get updating(){return this._pendingAddsRemoves.size>0||this._changes.updates.length>0}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return Object(T.a)(this._materialRenderers,(e=>e.rendersOccluded))}stopAnimationsAtTime(e){this._sortedMaterialRenderers.forAll((t=>Object(n.c)(t.material.animation,(t=>t.stopAtTime(e)))))}get isEmpty(){return!this.updating&&0===this._materialRenderers.size}commitChanges(){var e=!1;if(!this.updating)return!1;this.updateAddsRemoves();var t=function(e){var t=new Map,r=e=>{var r=t.get(e);return r||(r=new ge,t.set(e,r)),r};return e.adds.forAll((e=>{ye(e)&&r(e.material).adds.push(e)})),e.removes.forAll((e=>{ye(e)&&r(e.material).removes.push(e)})),e.updates.forAll((e=>{ye(e.renderGeometry)&&r(e.renderGeometry.material).updates.push(e)})),t}(this._changes),r=!1,i=!1;return t.forEach(((t,n)=>{var a=this._materialRenderers.get(n);if(!a&&t.adds.length>0&&(a=new et(this.rctx,this.materialRepository,n),this._materialRenderers.set(n,a),e=!0,r=!0,i=!0),a){var s=r||a.hasHighlights,o=i||a.hasWater;a.modify(t),r=r||s!==a.hasHighlights,i=i||o!==a.hasWater,a.isEmpty&&(this._materialRenderers.delete(n),a.dispose(),e=!0)}})),this._changes.clear(),this._pendingAddsRemoves.clear(),e&&this.updateSortedMaterialRenderers(),r&&(this._hasHighlights=Object(T.a)(this._materialRenderers,(e=>e.hasHighlights))),i&&(this._hasWater=Object(T.a)(this._materialRenderers,(e=>e.hasWater))),this.notifyChange("updating"),!0}add(e){if(0!==e.length){var t=0===this._pendingAddsRemoves.size;for(var r of e)this._pendingAddsRemoves.set(r,0);t&&this.notifyChange("updating")}}remove(e){var t=0===this._pendingAddsRemoves.size;for(var r of e){var i=this._pendingAddsRemoves.get(r);0===i?this._pendingAddsRemoves.set(r,2):2!==i&&this._pendingAddsRemoves.set(r,1)}t&&this._pendingAddsRemoves.size>0&&this.notifyChange("updating")}modify(e,t){var r=0===this._changes.updates.length;for(var i of e){var n=this._changes.updates.pushNew();n.renderGeometry=i,n.updateType=t}r&&this._changes.updates.length>0&&this.notifyChange("updating")}updateLogic(e){var t=!1;return this._sortedMaterialRenderers.forAll((({materialRenderer:r})=>{r.updateLogic&&r.updateLogic(e)&&(t=!0)})),t}draw(e,t){for(var r=0;r<this._sortedMaterialRenderers.length;r++){var i=this._sortedMaterialRenderers.data[r];Object(be.c)(i.material,e)&&i.materialRenderer.render(null,e,t,null)}}updateSortedMaterialRenderers(){this._sortedMaterialRenderers.clear();var e=0;this._materialRenderers.forEach(((t,r)=>{r.insertOrder=e++,this._sortedMaterialRenderers.push({material:r,materialRenderer:t})})),this._sortedMaterialRenderers.sort(((e,t)=>{var r=t.material.renderPriority-e.material.renderPriority;return 0!==r?r:e.material.insertOrder-t.material.insertOrder}))}updateAddsRemoves(){this._changes.adds.clear(),this._changes.removes.clear(),this._pendingAddsRemoves.forEach(((e,t)=>{switch(e){case 0:this._changes.adds.push(t);break;case 1:this._changes.removes.push(t)}}));for(var e=0;e<this._changes.updates.length;){var t=this._changes.updates.data[e].renderGeometry;this._pendingAddsRemoves.has(t)?this._changes.updates.removeUnorderedIndex(e):e++}}get test(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}}};Object(m.a)([Object(g.b)()],tt.prototype,"rctx",void 0),Object(m.a)([Object(g.b)()],tt.prototype,"materialRepository",void 0),Object(m.a)([Object(g.b)()],tt.prototype,"updating",null),tt=Object(m.a)([Object(y.a)("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],tt);var rt=r(844);class it extends Te.a{initializeProgram(e){var t=it.shader.get().build();return new Ce.a(e.rctx,t.generateSource("vertex"),t.generateSource("fragment"),Pe.a)}initializePipeline(){return this.configuration.hasAlpha?Object(Ie.d)({blending:Object(Ie.e)(770,1,771,771),colorWrite:Ie.b}):Object(Ie.d)({colorWrite:Ie.b})}}it.shader=new Me.a(rt.a,(()=>r.e(291).then(r.bind(null,1210))));class nt extends Ee.a{constructor(){super(...arguments),this.hasAlpha=!1}}function at(e,t,r){(r=r||e).length=e.length;for(var i=0;i<e.length;i++)r[i]=e[i]*t[i];return r}function st(e,t,r){(r=r||e).length=e.length;for(var i=0;i<e.length;i++)r[i]=e[i]*t;return r}function ot(e,t,r){(r=r||e).length=e.length;for(var i=0;i<e.length;i++)r[i]=e[i]+t[i];return r}function ct(e){return(e+1)*(e+1)}function lt(e,t,r){var i=e[0],n=e[1],a=e[2],s=r||[];return s.length=ct(t),t>=0&&(s[0]=.28209479177),t>=1&&(s[1]=.4886025119*i,s[2]=.4886025119*a,s[3]=.4886025119*n),t>=2&&(s[4]=1.09254843059*i*n,s[5]=1.09254843059*n*a,s[6]=.31539156525*(3*a*a-1),s[7]=1.09254843059*i*a,s[8]=.54627421529*(i*i-n*n)),s}function ut(e,t){var r=function(e){return Object(a.d)(Math.floor(Math.sqrt(e)-1),0,2)}(t.r.length);for(var i of e)Object(o.s)(vt,i.direction),lt(vt,r,bt),at(bt,gt),st(bt,i.intensity[0],mt),ot(t.r,mt),st(bt,i.intensity[1],mt),ot(t.g,mt),st(bt,i.intensity[2],mt),ot(t.b,mt);return t}function dt(e,t,r){(function(e,t){var r=ct(e),i=t||{r:[],g:[],b:[]};i.r.length=i.g.length=i.b.length=r;for(var n=0;n<r;n++)i.r[n]=i.g[n]=i.b[n]=0})(t,r.sphericalHarmonics.sh),Object(o.v)(r.main.intensity,0,0,0);var i=!1,n=ht,a=pt,s=ft;for(var c of(n.length=0,a.length=0,s.length=0,e))c instanceof A&&!i?(Object(o.j)(r.main.direction,c.direction),r.main.intensity[0]=c.intensity[0],r.main.intensity[1]=c.intensity[1],r.main.intensity[2]=c.intensity[2],r.main.castShadows=c.castShadows,i=!0):c instanceof A||c instanceof R?n.push(c):c instanceof F?a.push(c):c instanceof L&&s.push(c);for(var l of(ut(n,r.sphericalHarmonics.sh),function(e,t){for(var r of(lt(vt,0,bt),e))t.r[0]+=bt[0]*gt[0]*r.intensity[0]*4*Math.PI,t.g[0]+=bt[0]*gt[0]*r.intensity[1]*4*Math.PI,t.b[0]+=bt[0]*gt[0]*r.intensity[2]*4*Math.PI}(a,r.sphericalHarmonics.sh),s))ot(r.sphericalHarmonics.sh.r,l.sh.r),ot(r.sphericalHarmonics.sh.g,l.sh.g),ot(r.sphericalHarmonics.sh.b,l.sh.b)}Object(m.a)([Object(Ee.b)()],nt.prototype,"hasAlpha",void 0);var ht=[],pt=[],ft=[],bt=[0],mt=[0],vt=Object(s.e)(),gt=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398],yt=Object(s.e)();class Ot{constructor(){this._renderLighting={main:{intensity:Object(s.e)(),direction:Object(s.g)(1,0,0),castShadows:!1},sphericalHarmonics:{sh:{r:[0],g:[0],b:[0]}}},this._shOrder=2,this._oldSunlight={direction:Object(s.e)(),ambient:{color:Object(s.e)(),intensity:0},diffuse:{color:Object(s.e)(),intensity:0}}}setLightDirectionUniform(e){e.setUniform3fv("lightingMainDirection",this._renderLighting.main.direction)}setUniforms(e,t=!1){if(t){var r=(1-this._info.groundLightingFactor)*(1-this._info.globalFactor);e.setUniform1f("lightingFixedFactor",r)}else e.setUniform1f("lightingFixedFactor",0);e.setUniform1f("lightingGlobalFactor",this._info.globalFactor),this.setLightDirectionUniform(e),e.setUniform3fv("lightingMainIntensity",this._renderLighting.main.intensity),e.setUniform1f("ambientBoostFactor",.4);var i=this._renderLighting.sphericalHarmonics.sh;0===this._shOrder?e.setUniform3f("lightingAmbientSH0",i.r[0],i.g[0],i.b[0]):1===this._shOrder?(e.setUniform4f("lightingAmbientSH_R",i.r[0],i.r[1],i.r[2],i.r[3]),e.setUniform4f("lightingAmbientSH_G",i.g[0],i.g[1],i.g[2],i.g[3]),e.setUniform4f("lightingAmbientSH_B",i.b[0],i.b[1],i.b[2],i.b[3])):2===this._shOrder&&(e.setUniform3f("lightingAmbientSH0",i.r[0],i.g[0],i.b[0]),e.setUniform4f("lightingAmbientSH_R1",i.r[1],i.r[2],i.r[3],i.r[4]),e.setUniform4f("lightingAmbientSH_G1",i.g[1],i.g[2],i.g[3],i.g[4]),e.setUniform4f("lightingAmbientSH_B1",i.b[1],i.b[2],i.b[3],i.b[4]),e.setUniform4f("lightingAmbientSH_R2",i.r[5],i.r[6],i.r[7],i.r[8]),e.setUniform4f("lightingAmbientSH_G2",i.g[5],i.g[6],i.g[7],i.g[8]),e.setUniform4f("lightingAmbientSH_B2",i.b[5],i.b[6],i.b[7],i.b[8]))}set(e){this._info=e,dt(e.lights,this._shOrder,this._renderLighting),Object(o.s)(this._oldSunlight.direction,this._renderLighting.main.direction);var t=1/Math.PI;this._oldSunlight.ambient.color[0]=.282095*this._renderLighting.sphericalHarmonics.sh.r[0]*t,this._oldSunlight.ambient.color[1]=.282095*this._renderLighting.sphericalHarmonics.sh.g[0]*t,this._oldSunlight.ambient.color[2]=.282095*this._renderLighting.sphericalHarmonics.sh.b[0]*t,this._oldSunlight.ambient.intensity=1,this._oldSunlight.diffuse.color[0]=this._renderLighting.main.intensity[0]*t,this._oldSunlight.diffuse.color[1]=this._renderLighting.main.intensity[1]*t,this._oldSunlight.diffuse.color[2]=this._renderLighting.main.intensity[2]*t,this._oldSunlight.diffuse.intensity=1;var r=Object(o.j)(yt,this._oldSunlight.diffuse.color);Object(o.d)(r,r,.4*this._info.globalFactor),Object(o.e)(this._oldSunlight.ambient.color,this._oldSunlight.ambient.color,r)}get globalFactor(){return this._info.globalFactor}get old(){return this._oldSunlight}}var jt=r(786),_t=v.a.getLogger("esri.views.3d.webgl-engine.lib.OverlayRenderer"),wt=class extends(Object(N.b)(j.a)){constructor(e){super(e),this._overlays=null,this._hasHighlights=!1,this._rendersOccluded=!1,this._hasWater=!1,this._lighting=new Ot,this._localOrigins=new he,this._handles=new w.a,this._layerRenderers=new Map,this._sortedLayerRenderersDirty=!1,this._sortedLayerRenderers=new O.a,this._geometries=new Map,this.globalUnitScale=1,this.longitudeCyclical=null}initialize(){this._rctx=this.renderView.renderingContext,this._renderContext=new fe(this._rctx,null,null,null,null,null),this._stippleTextureRepository=new jt.a,this.waterTextureRepository=this.renderView.waterTextureRepository,this._shaderTechniqueRepository=new Q({rctx:this._rctx,viewingMode:2,commonUniformStore:new X,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:this.waterTextureRepository}),Object(x.a)(this.waterTextureRepository,"loadingState",(()=>this.emitContentChanged())),this._materialRepository=new ie(this.renderView.textureRepository,this._shaderTechniqueRepository),this._materialRepository.onMaterialChanged=e=>{(e.renderOccluded&Pt)>0!==this._rendersOccluded&&this.updateRendersOccluded(),this.emitContentChanged(),this.notifyChange("updating")},this._compositingHelper=this.renderView.compositingHelper,this._lighting.set({lights:[new F(Object(s.g)(1,1,1))],groundLightingFactor:1,globalFactor:0}),this._bindParameters={slot:null,highlightDepthTexture:Object(I.a)(this._rctx),camera:Mt,inverseViewport:Object(E.a)(),origin:null,screenToWorldRatio:null,screenToWorldRatioGlobalWM:null,shadowMappingEnabled:!1,slicePlane:null,ssaoEnabled:!1,hasOccludees:!1,linearDepthTexture:null,linearDepthTextureUnit:0,lastFrameColorTexture:null,lastFrameColorTextureUnit:0,reprojectionMat:null,ssrEnabled:!1,lighting:this._lighting,transparencyPassType:3,terrainLinearDepthTexture:null,geometryLinearDepthTexture:null,multipassTerrainEnabled:!1,cullAboveGround:!0,multipassGeometryEnabled:!1},this._handles.add(this.scheduler.registerTask(M.b.STAGE,(()=>this.commitChanges()),(()=>this.updating)))}dispose(){this._handles.destroy(),this._layerRenderers.forEach((e=>e.dispose())),this._layerRenderers.clear(),this._bindParameters.highlightDepthTexture=Object(n.f)(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=Object(n.f)(this._shaderTechniqueRepository),this._temporaryRenderTarget=Object(n.f)(this._temporaryRenderTarget),this._debugPatternTexture=Object(n.f)(this._debugPatternTexture),this._quadVAO=Object(n.f)(this._quadVAO)}get updating(){return this._sortedLayerRenderersDirty||Object(T.a)(this._layerRenderers,(e=>e.updating))||this.waterTextureRepository.updating}get hasOverlays(){return Object(n.k)(this._overlays)}get gpuMemoryUsage(){return Object(n.k)(this._overlays)?this._overlays[0].getGpuMemoryUsage()+this._overlays[1].getGpuMemoryUsage():0}get overlays(){return this._overlays}forEachOverlay(e){Object(n.k)(this._overlays)&&(e(this._overlays[0],0),e(this._overlays[1],1))}ensureOverlays(){if(Object(n.j)(this._overlays)){var e=this.renderView.renderingContext;this._overlays=[new W(e),new W(e)]}}disposeOverlays(){Object(n.k)(this._overlays)&&(this._overlays.forEach((e=>e.dispose())),this._overlays=null)}commitChanges(){var e=!1;this._layerRenderers.forEach(((t,r)=>{t.commitChanges()&&(e=!0),t.isEmpty&&(this._layerRenderers.delete(r),this._sortedLayerRenderersDirty=!0,this._handles.remove(r))})),this._sortedLayerRenderersDirty&&(this.updateSortedLayerRenderers(),e=!0),e&&(this.notifyChange("updating"),this.emitContentChanged(),this.updateHasHighlights(),this.updateRendersOccluded(),this.updateHasWater())}addGeometries(e,t,r){for(var i of e)null==i.origin&&(i.origin=this._localOrigins.getOrigin(i.boundingSphere)),Object(n.j)(i.id)&&(i.id=Object(_.a)()),this._geometries.set(i.id,i);this.ensureLayerRenderer(t).add(e),2===r&&this.notifyGraphicGeometryChanged(e,t)}removeGeometries(e,t,r){for(var i of e)this._geometries.delete(Object(n.q)(i.id));var a=this._layerRenderers.get(t);a&&(a.remove(e),2===r&&this.notifyGraphicGeometryChanged(e,t))}updateGeometries(e,t,r){var i=this._layerRenderers.get(t);if(i)switch(i.modify(e,r),r){case 4:case 2:return this.notifyGraphicGeometryChanged(e,t);case 1:return this.notifyGraphicVisibilityChanged(e,t)}else _t.warn("Attempted to update geometry for nonexistent layer")}notifyGraphicGeometryChanged(e,t){var r;if(!Object(n.j)(t.notifyGraphicGeometryChanged))for(var i of e){var a=i.graphicUid;a!==r&&(t.notifyGraphicGeometryChanged(a),r=a)}}notifyGraphicVisibilityChanged(e,t){var r;if(!Object(n.j)(t.notifyGraphicVisibilityChanged))for(var i of e){var a=i.graphicUid;a!==r&&(t.notifyGraphicVisibilityChanged(a),r=a)}}updateHighlights(e,t){var r=this._layerRenderers.get(t);r?r.modify(e,8):_t.warn("Attempted to update highlights for nonexistent layer")}isEmpty(){return 0===this._geometries.size&&!V.OVERLAY_DRAW_DEBUG_TEXTURE}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return this._rendersOccluded}updateLogic(e){var t=!1;return this._layerRenderers.forEach((r=>{r.updateLogic(e)&&(t=!0)})),t}updateLayerOrder(){this._sortedLayerRenderersDirty=!0}drawPass(e,t,r,i=0){if(0===r.numViews)return!1;if(this._screenToWorldRatio=r.pixelRatio*Math.abs(r.views[0].extent[2]-r.views[0].extent[0])/Math.abs(r.views[0].viewport[2]-r.views[0].viewport[0]),this.isEmpty()||5===e&&!this.hasHighlights||3===e&&!this.hasWater)return!1;if(!this.hasNonZeroSizedView(r))return!1;var a=r.width,s=r.height;if(!t.isValid())return!1;t.resize(a,s);var o=this._rctx;if(Mt.pixelRatio=r.pixelRatio||1,this._renderContext.pass=e,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToWorldRatioGlobalWM=this._screenToWorldRatio*this.globalUnitScale,t.bind(o),o.setClearColor(0,0,0,0),o.clearSafe(16384),1===i&&(this._renderContext.renderOccludedMask=Pt),V.OVERLAY_DRAW_DEBUG_TEXTURE&&1!==i)for(var c=0;c<r.numViews;c++)this.setViewParameters(r.views[c],Mt),this.drawDebugTexture(a,s,St[r.index%St.length]);return this._layerRenderers.size>0&&this._sortedLayerRenderers.forAll((({layerView:c,renderer:l})=>{if(2!==i||!Object(n.k)(c)||0!==c.drapeSourceType){var u=Object(n.k)(c)&&Object(n.k)(c.fullOpacity)&&c.fullOpacity<1&&0===e;u&&(this.bindTemporaryFramebuffer(this._rctx,a,s),o.clearSafe(16384));for(var d=0;d<r.numViews;d++)this.setViewParameters(r.views[d],Mt),l.draw(this._renderContext,this._bindParameters);u&&Object(n.k)(this._temporaryRenderTarget)&&(t.bind(o),this._compositingHelper.composite(this._temporaryRenderTarget.getTexture(),2,Object(n.q)(Object(n.q)(c).fullOpacity)))}})),o.bindFramebuffer(null),t.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}bindTemporaryFramebuffer(e,t,r){Object(n.j)(this._temporaryRenderTarget)&&(this._temporaryRenderTarget=new B(e,!1)),this._temporaryRenderTarget.resize(t,r),this._temporaryRenderTarget.bind(e)}reloadShaders(){var e=this;return Object(b.a)((function*(){yield e._shaderTechniqueRepository.hotReload()}))()}intersect(e,t,r){var i=0;this._geometries.forEach((n=>{if(!r||r(n)){this.intersectRenderGeometry(n,t,0,e,i);var a=this.longitudeCyclical;a&&(n.boundingSphere[0]-n.boundingSphere[3]<a.min&&this.intersectRenderGeometry(n,t,a.range,e,i),n.boundingSphere[0]+n.boundingSphere[3]>a.max&&this.intersectRenderGeometry(n,t,-a.range,e,i)),i++}}))}intersectRenderGeometry(e,t,r,i,a){if(e.instanceParameters.visible){var s=0;Object(n.k)(e.transformation)&&(r+=e.transformation[12],s=e.transformation[13]),Tt[0]=t[0]-r,Tt[1]=t[1]-s,Tt[2]=1,Et[0]=t[0]-r,Et[1]=t[1]-s,Et[2]=0,e.screenToWorldRatio=this._screenToWorldRatio,e.material.intersect(e,null,e.getShaderTransformation(),i,Tt,Et,((t,r,n)=>{this.addIntersectionResult(n,e.material.renderPriority,a,i,e.layerUid,e.graphicUid)}),e.calculateShaderTransformation,!0)}}addIntersectionResult(e,t,r,i,n,a){var s={type:"external",metadata:{layerUid:n,graphicUid:a}},o=n=>{n.set(s,null,i.results.ground.dist,i.results.ground.normal,i.results.ground.transformation,t,null,null,e,r),n.intersector="OverlayRenderer"};if((null==i.results.min.drapedLayerOrder||t>=i.results.min.drapedLayerOrder)&&(null==i.results.min.dist||i.results.ground.dist<=i.results.min.dist)&&o(i.results.min),0!==i.options.store&&(null==i.results.max.drapedLayerOrder||t<i.results.max.drapedLayerOrder)&&(null==i.results.max.dist||i.results.ground.dist>i.results.max.dist)&&o(i.results.max),2===i.options.store){var c=new D.b(i.ray);o(c),i.results.all.push(c)}}stopAnimationsAtTime(e){this._sortedLayerRenderers.forAll((t=>t.renderer.stopAnimationsAtTime(e)))}ensureLayerRenderer(e){var t=this._layerRenderers.get(e);return t||(t=new tt({rctx:this._rctx,materialRepository:this._materialRepository}),this._layerRenderers.set(e,t),this._sortedLayerRenderersDirty=!0,"fullOpacity"in e&&this._handles.add(e.watch("fullOpacity",(()=>this.emitContentChanged())),e),this._handles.add(Object(x.a)(t,"updating",(()=>this.notifyChange("updating"))),e)),t}updateSortedLayerRenderers(){if(this._sortedLayerRenderersDirty&&(this._sortedLayerRenderersDirty=!1,this._sortedLayerRenderers.clear(),0!==this._layerRenderers.size)){var[{view:{allLayerViews:e}}]=this._layerRenderers.keys(),t=new Set(this._layerRenderers.values());e.forEach((e=>{var r=e,i=this._layerRenderers.get(r);i&&(this._sortedLayerRenderers.push(new xt(r,i)),t.delete(i))})),t.forEach((e=>{this._sortedLayerRenderers.push(new xt(null,e))}))}}setViewParameters(e,t){t.viewport=e.viewport;var r=e.extent;Object(S.n)(t.projectionMatrix,0,r[2]-r[0],0,r[3]-r[1],t.near,t.far),Object(S.i)(t.viewMatrix),Object(S.s)(t.viewMatrix,t.viewMatrix,[-e.extent[0],-e.extent[1],0]),t.setGLViewport(this._rctx),this._renderContext.camera=t,this._bindParameters.camera=t,this._bindParameters.inverseViewport[0]=1/t.fullViewport[2],this._bindParameters.inverseViewport[1]=1/t.fullViewport[3]}hasNonZeroSizedView(e){for(var t=0;t<e.numViews;t++){var r=e.views[t];if(r.extent[0]!==r.extent[2]&&r.extent[1]!==r.extent[3])return!0}return!1}emitContentChanged(){this.onContentChanged&&this.onContentChanged()}updateHasWater(){var e=Object(T.a)(this._layerRenderers,(e=>e.hasWater));e!==this._hasWater&&(this._hasWater=e)}updateHasHighlights(){var e=Object(T.a)(this._layerRenderers,(e=>e.hasHighlights));e!==this._hasHighlights&&(this._hasHighlights=e,this.onHasHighlightsChanged&&this.onHasHighlightsChanged(this._hasHighlights))}updateRendersOccluded(){var e=Object(T.a)(this._layerRenderers,(e=>e.rendersOccluded));e!==this._rendersOccluded&&(this._rendersOccluded=e,this.onRendersOccludedChanged&&this.onRendersOccludedChanged(this.rendersOccluded))}drawDebugTexture(e,t,r){var i=this._rctx;this.ensureDebugPatternResources(e,t);var n=this._debugTextureTechnique.program;i.bindProgram(n),i.setPipelineState(this._debugTextureTechnique.pipeline),n.setUniform4f("color",r[0],r[1],r[2],1),n.setUniform1i("tex",0),i.bindTexture(this._debugPatternTexture,0),i.bindVAO(this._quadVAO),i.drawArrays(5,0,Object(C.f)(this._quadVAO,"geometry"))}ensureDebugPatternResources(e,t){if(!this._debugPatternTexture){for(var r=new Uint8Array(e*t*4),i=0,n=0;n<t;n++)for(var a=0;a<e;a++){var s=Math.floor(a/10),o=Math.floor(n/10);s<2||o<2||10*s>e-20||10*o>t-20?(r[i++]=255,r[i++]=255,r[i++]=255,r[i++]=255):(r[i++]=255,r[i++]=255,r[i++]=255,r[i++]=1&s&&1&o?1&a^1&n?0:255:1&s^1&o?0:128)}this._debugPatternTexture=new P.a(this._rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:e,height:t},r);var c=new nt;c.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquireAndReleaseExisting(it,c,this._debugTextureTechnique),this._quadVAO=Object(I.b)(this._rctx)}}get test(){return{layerRenderers:this._layerRenderers}}};Object(m.a)([Object(N.c)()],wt.prototype,"_shaderTechniqueRepository",void 0),Object(m.a)([Object(N.c)()],wt.prototype,"_stippleTextureRepository",void 0),Object(m.a)([Object(g.b)(),Object(N.c)()],wt.prototype,"waterTextureRepository",void 0),Object(m.a)([Object(g.b)({constructOnly:!0})],wt.prototype,"renderView",void 0),Object(m.a)([Object(g.b)({constructOnly:!0})],wt.prototype,"scheduler",void 0),Object(m.a)([Object(g.b)()],wt.prototype,"globalUnitScale",void 0),Object(m.a)([Object(g.b)({type:Boolean,readOnly:!0})],wt.prototype,"updating",null),wt=Object(m.a)([Object(y.a)("esri.views.3d.terrain.OverlayRenderer")],wt);class xt{constructor(e,t){this.layerView=e,this.renderer=t}}var St=[[1,.5,.5],[.5,.5,1],[.5,1,.5]],Mt=new k.a;Mt.near=1,Mt.far=1e4,Mt.relativeElevation=null;var Tt=Object(s.e)(),Et=Object(s.e)(),Pt=4,Ct=r(200),It=(Ct.b,Ct.a);function At(e){var t=[],r=[];!function(e,t,r){for(var{attributeData:{position:n},removeDuplicateStartEnd:a}=e,s=function(e){var t=e.length;return e[0]===e[t-3]&&e[1]===e[t-2]&&e[2]===e[t-1]}(n)&&1===a,o=n.length/3-(s?1:0),c=new Uint32Array(2*(o-1)),l=s?Object(i.m)(n,0,n.length-3):n,u=0,d=0;d<o-1;d++)c[u++]=d,c[u++]=d+1;t.push(["position",{size:3,data:l,exclusive:s}]),r.push(["position",c])}(e,r,t);var s=r[0][1].data,c=t[0][1].length,l=new Uint16Array(c);return function(e,t,r){var i=e.attributeData.mapPosition;Object(n.j)(i)||(r.push(["mapPos",r[0][1]]),t.push(["mapPos",{size:3,data:i}]))}(e,r,t),function(e,t,r,i){if(Object(n.k)(e.attributeData.colorFeature))return;var a=e.attributeData.color;t.push(["color",{size:4,data:Object(n.r)(a,It)}]),r.push(["color",i])}(e,r,t,l),function(e,t,r,i){if(Object(n.k)(e.attributeData.sizeFeature))return;var a=e.attributeData.size;t.push(["size",{size:1,data:[Object(n.r)(a,1)]}]),r.push(["size",i])}(e,r,t,l),function(e,t,r,i){var a=e.attributeData.colorFeature;Object(n.j)(a)||(t.push(["colorFeatureAttribute",{size:1,data:new Float32Array([a])}]),r.push(["color",i]))}(e,r,t,l),function(e,t,r,i){var a=e.attributeData.sizeFeature;Object(n.j)(a)||(t.push(["sizeFeatureAttribute",{size:1,data:new Float32Array([a])}]),r.push(["sizeFeatureAttribute",i]))}(e,r,t,l),function(e,t,r,i){var a=e.attributeData.opacityFeature;Object(n.j)(a)||(t.push(["opacityFeatureAttribute",{size:1,data:new Float32Array([a])}]),r.push(["opacityFeatureAttribute",i]))}(e,r,t,l),function(e,t,r,i){if("round"!==e.join)return;var s=i.length/3,c=new Float32Array(s),l=kt,u=zt;Object(o.v)(l,0,0,0);for(var d=Object(n.r)(e.uniformSize,1),h=-1;h<s;++h){var p=h<0?s+h:h,f=(h+1)%s;if(Object(o.v)(u,i[3*f+0]-i[3*p+0],i[3*f+1]-i[3*p+1],i[3*f+2]-i[3*p+2]),Object(o.q)(u,u),h>=0){var b=(Math.PI-Object(a.b)(Object(o.g)(l,u)))*Vt*1*Dt(d);c[h]=Math.max(Math.floor(b),0)}Object(o.d)(l,u,-1)}t.push(["subdivisions",{size:1,data:c}]),r.push(["subdivisions",r[0][1]])}(e,r,t,s),new p.a(r,t,2)}function Rt(e,t,r,i){var n="polygon"===e.type?1:0,a="polygon"===e.type?e.rings:e.paths,{position:s,outlines:o}=u(a,e.hasZ,n),c=new Float64Array(s.length),l=Object(f.b)(s,e.spatialReference,0,c,0,s,0,s.length/3,t,r,i),d=null!=l;return{lines:d?Ft(o,s,c):[],projectionSuccess:d,sampledElevation:l}}function Ft(e,t,r){var i=new Array;for(var{index:n,count:a}of e)if(!(a<=1)){var s=3*n,o=s+3*a;i.push({position:t.subarray(s,o),mapPosition:r?r.subarray(s,o):void 0})}return i}function Lt(e,t){for(var r="polygon"===e.type?1:0,i="polygon"===e.type?e.rings:e.paths,{position:n,outlines:a}=u(i,!1,r),s=Object(c.k)(n,e.spatialReference,0,n,t,0,n.length/3),o=2;o<n.length;o+=3)n[o]=-2;return{lines:s?Ft(a,n):[],projectionSuccess:s}}function Dt(e){return 1.863798+-2.0062872/Math.pow(1+e/18.2313,.8856294)}var kt=Object(s.e)(),zt=Object(s.e)(),Vt=4/Math.PI},,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i,n=r(120),a=r(119),s=r(880),o=r(842);function c(e){e.fragment.code.add(Object(a.a)(i||(i=Object(n.a)(["\n    const float GAMMA = 2.2;\n    const float INV_GAMMA = 0.4545454545;\n\n    vec4 delinearizeGamma(vec4 color) {\n      return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n    }\n\n    vec3 linearizeGamma(vec3 color) {\n      return pow(color, vec3(GAMMA));\n    }\n  "]))))}var l,u,d,h=r(710);function p(e,t){e.include(h.a,t),e.include(c),e.include(o.a),t.ssrEnabled&&e.include(s.a,t),e.fragment.constants.add("fresnelSky","vec3",[.02,1,15]).add("fresnelMaterial","vec2",[.02,.1]).add("roughness","float",.015).add("foamIntensityExternal","float",1.7).add("ssrIntensity","float",.65).add("ssrHeightFadeStart","float",3e5).add("ssrHeightFadeEnd","float",5e5).add("waterDiffusion","float",.775).add("waterSeeColorMod","float",.8).add("correctionViewingPowerFactor","float",.4).add("skyZenitColor","vec3",[.52,.68,.9]).add("skyColor","vec3",[.67,.79,.9]),e.fragment.code.add(Object(a.a)(l||(l=Object(n.a)(["\n    PBRShadingWater shadingInfo;\n\n    /*\n    *   This function is an approximation for the sky gradient reflected\n    *   the water surface and describes a combination of two fresnel terms.\n    *   @parameter: cosTheta = is the result of max(dot(n,v), 0.0)\n    *   @parameter: horizon = the dominant color of the sky horizon\n    *   @parameter: cosTheta = the dominant color of the sky zenit\n    */\n    vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\n      float exponent = pow((1.0 - cosTheta), fresnelSky[2]);\n      return mix(zenit, horizon, exponent);\n    }\n\n    /*\n    *   This function determines the water color per pixel.\n    *   @parameter: n = normal facing away from the surface\n    *   @parameter: v = view direction facing away from the surface.\n    *   @parameter: l = light direction facing away from the surface\n    *   @parameter: lightIntensity = light intensity, currently between 0...PI\n    *   @parameter: localUp = a normal for the general direction of the surface\n    *   @parameter: shadow = the amount of shadow at this pixel (0 = no shadow)\n    */\n    vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 positionView) {\n\n      float reflectionHit = 0.;\n      vec3 seaWaterColor = linearizeGamma(color);\n      // using half vector to determine the specular light\n      vec3 h = normalize(l + v);\n      shadingInfo.NdotL = clamp(dot(n, l), 0.0, 1.0);\n      shadingInfo.NdotV = clamp(dot(n, v), 0.001, 1.0);\n      shadingInfo.VdotN = clamp(dot(v, n), 0.001, 1.0);\n      shadingInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);\n      shadingInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);\n      shadingInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);\n\n      // angle between vertex normal and view direction\n      float upDotV = max(dot(localUp,v), 0.0);\n      // reflected sky color: the reflected sky color consists of two main colors, the\n      // reflected color at the horizon and the reflected color of the zenit.\n      // the reflected sky color is then an approximation based on the fresnel term.\n      vec3 skyHorizon = linearizeGamma(skyColor);\n      vec3 skyZenit = linearizeGamma(skyZenitColor);\n      vec3 skyColor = getSkyGradientColor(upDotV, skyHorizon, skyZenit );\n\n      // we use the upDotL to smoothen out the\n      // reflected color of the water\n      float upDotL = max(dot(localUp,l),0.0);\n\n      // The approximated sky color is adjusted according to the sun position.\n      // This is done as approximation for e.g. night views.\n      float daytimeMod = 0.1 + upDotL * 0.9;\n      skyColor *= daytimeMod;\n\n      // If a water surface is in shadow we just use a slight darkening of the\n      // water surface expressed with this shadowModifier.\n      float shadowModifier = clamp(shadow, 0.8, 1.0);\n\n      // The reflected sky color consists of the fresnel reflection multiplied with the approximated sky color.\n      // The shadow is influencing the frensel term to keep the shadow impression for really near views. As long\n      // as reflection are absent there is a need to have a slight shadow for depth perception.\n      vec3 fresnelModifier = fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);\n      vec3 reflSky = fresnelModifier * skyColor * shadowModifier;\n\n      // The reflected sea color is the input water color combined with the reflected sky color.\n      // The reflected sky color is modified by the incoming light.\n      vec3 reflSea = seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\n\n      vec3 specular = vec3(0.0);\n      // This prevents the specular light to be rendered when:\n      // - sun is behind a polygon (e.g. sundown for elevated polygons where nDotL might be still ok)\n      // - viewer is under water (for this localUp is better than n)\n      if(upDotV > 0.0 && upDotL > 0.0) {\n        // calculate the cook torrance BRDF but with simplified occlusion\n        vec3 specularSun = brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\n\n        // Normalize light intensity to be between 0...1. Shadow cancels out specular light here\n        vec3 incidentLight = lightIntensity * LIGHT_NORMALIZATION * shadow;\n\n        specular = shadingInfo.NdotL * incidentLight * specularSun;\n      }\n\n      vec3 foam = vec3(0.0);\n      if(upDotV > 0.0) {\n        foam = foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);\n      }\n      "])))),t.ssrEnabled?e.fragment.code.add(Object(a.a)(u||(u=Object(n.a)(["\n      // Convert the world position to view position\n      vec4 viewPosition = vec4(positionView.xyz, 1.0);\n      vec3 viewDir = normalize(viewPosition.xyz);\n      vec4 viewNormalVectorCoordinate = ssrViewMat *vec4(n, 0.0);\n      vec3 viewNormal = normalize(viewNormalVectorCoordinate.xyz);\n      vec4 viewUp = ssrViewMat *vec4(localUp, 0.0);\n\n      // at steeper viewing angles we use more of a vertex normal (in this case up) then the wave normal\n      // this removes some artifacts of normal mapping\n      float correctionViewingFactor = pow(max(dot(-viewDir, viewUp.xyz), 0.0), correctionViewingPowerFactor);\n      vec3 viewNormalCorrected = mix(viewUp.xyz, viewNormal, correctionViewingFactor);\n\n      vec3 reflected = normalize(reflect(viewDir, viewNormalCorrected));\n\n      // perform screen space reflection to detect hit\n      vec3 hitCoordinate = screenSpaceIntersection( normalize(reflected), viewPosition.xyz, viewDir, viewUp.xyz);\n      vec3 reflectedColor = vec3(0.0);\n\n      // if there is a hit with ssr find reflected color from the reprojeted frame\n      if (hitCoordinate.z > 0.0)\n      {\n        vec2 reprojectedCoordinate = reprojectionCoordinate(hitCoordinate);\n\n        // fade out if there if the hit is near end of Y axis\n        vec2 dCoords = smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));\n        float heightMod = smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -positionView.z);\n        reflectionHit = waterDiffusion * clamp(1.0 - (1.3*dCoords.y), 0.0, 1.0) * heightMod;\n\n        reflectedColor = linearizeGamma(texture2D(lastFrameColorMap, reprojectedCoordinate).xyz)* reflectionHit * fresnelModifier.y * ssrIntensity;\n      }\n      float seeColorMod =  mix(waterSeeColorMod, waterSeeColorMod*0.5, reflectionHit);\n      // combining reflected sky, reflected sea, specular highlight and SSR reflections.\n      return tonemapACES((1. - reflectionHit) * reflSky + reflectedColor + reflSea * seeColorMod + specular + foam);\n    }\n  "])))):e.fragment.code.add(Object(a.a)(d||(d=Object(n.a)(["\n      // combining reflected sky, reflected sea, specular highlight and SSR reflections.\n      return tonemapACES(reflSky + reflSea * waterSeeColorMod + specular + foam);\n    }\n  "]))))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return d}));var i,n,a=r(120),s=r(119),o=r(254),c=r(358),l=r(308),u=r(280);function d(e){var t=new o.a;return t.extensions.add("GL_OES_standard_derivatives"),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.varyings.add("vUV","vec2"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.code.add(Object(s.a)(i||(i=Object(a.a)(["\n    void main(void) {\n      vUV = uv0;\n      ","\n      gl_Position = proj * view * vec4(position, 1.0);\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(position, 1.0)).z;":"")),e.multipassTerrainEnabled&&(t.fragment.include(l.a),t.include(u.b,e)),t.fragment.uniforms.add("size","vec2").add("color1","vec4").add("color2","vec4"),t.fragment.include(c.a),t.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    void main() {\n      ","\n      vec2 uvScaled = vUV / (2.0 * size);\n\n      vec2 uv = fract(uvScaled - 0.25);\n      vec2 ab = clamp((abs(uv - 0.5) - 0.25) / fwidth(uvScaled), -0.5, 0.5);\n      float fade = smoothstep(0.25, 0.5, max(fwidth(uvScaled.x), fwidth(uvScaled.y)));\n      float t = mix(abs(ab.x + ab.y), 0.5, fade);\n\n      gl_FragColor = mix(color2, color1, t);\n      ","\n    }\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":"")),t}var h=Object.freeze({__proto__:null,build:d})},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return u}));var i=r(104),n=r(111),a=r(330),s=r(173),o=r(223),c=r(177);class l{constructor(e=Object(i.e)(),t=Object(i.e)()){this.startRenderSpace=e,this.endRenderSpace=t,this.type="euclidean"}eval(e,t,r){return Object(n.h)(t,this.startRenderSpace,this.endRenderSpace,e),r&&(Object(n.i)(r,this.endRenderSpace,this.startRenderSpace),Object(n.q)(r,r)),t}createRenderGeometry(e,t){var r=[],i=[],a=(t,a)=>{var s=h;Object(n.i)(s,t,e),r.push([s[0],s[1],s[2]]),i.push([a[0],a[1],a[2]])},s=t.worldUpAtPosition(this.eval(.5,d),c.d.get());return a(this.startRenderSpace,s),a(this.endRenderSpace,s),{points:r,normals:i}}}class u{constructor(e,t,r){this.startRenderSpace=e,this.endRenderSpace=t,this.renderSpatialReference=r,this.type="geodesic",this._start=Object(i.e)(),this._end=Object(i.e)(),this._pcpf=Object(s.g)(r),this._project=Object(o.b)(r,this._pcpf),this._projectIn(e,this._start),this._projectIn(t,this._end)}_projectIn(e,t){this._project?Object(o.r)(e,this.renderSpatialReference,t,this._pcpf):Object(n.j)(t,e)}eval(e,t,r){if(this._project)if(r){var i=h;Object(a.i)(this._start,this._end,e,t,i),Object(n.e)(p,t,i),Object(o.r)(t,this._pcpf,t,this.renderSpatialReference),Object(o.r)(p,this._pcpf,p,this.renderSpatialReference),Object(n.i)(r,p,t),Object(n.q)(r,r)}else Object(a.h)(this._start,this._end,e,t),Object(o.r)(t,this._pcpf,t,this.renderSpatialReference);else Object(n.h)(t,this._start,this._end,e),r&&(Object(n.i)(r,this._end,this._start),Object(n.q)(r,r));return t}createRenderGeometry(e,t){for(var r=[],i=[],a=(t,a)=>{var s=p;Object(n.i)(s,t,e),r.push([s[0],s[1],s[2]]),i.push([a[0],a[1],a[2]])},s=0;s<128;++s){var o=s/127,c=d,l=h;this.eval(o,c),t.worldUpAtPosition(c,l),a(c,l)}return{points:r,normals:i}}}var d=Object(i.e)(),h=Object(i.e)(),p=Object(i.e)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return a})),r.d(t,"f",(function(){return s}));var i=r(488);function n(e,t,r,n=2,a="abbr"){return Object(i.b)(e,t.toUnit(r).value,r,n,a)}function a(e,t,r=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(i.h)(e,t.value,t.unit,r,n)}function s(e,t,r=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(i.i)(e,t.value,t.unit,r,n)}function o(e,t,r=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(i.e)(e,t.value,t.unit,r,n)}function c(e,t,r=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(i.f)(e,t.value,t.unit,r,n)}function l(e){if("angle"!==e.measure)throw new Error("quantity is not an angle");return Object(i.a)(e.value,e.unit)}},function(e,t,r){"use strict";var i=r(117);t.a=class{constructor(e=null){this.spatialReference=e}get spatialReference(){return this._spatialReference}set spatialReference(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}normalizeDistance(e){return e*this._metersPerDistanceUnit}normalizeElevation(e){return e*this._metersPerElevationUnit}normalizeArea(e){return e*this._squareMetersPerAreaUnit}_updateNormalizationFactors(){this._metersPerDistanceUnit=Object(i.f)(this._spatialReference,1),this._metersPerElevationUnit=Object(i.f)(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return E}));var i=r(89),n=r(105),a=r(104),s=r(111),o=r(115),c=r(135),l=r(517),u=r(760),d=r(82),h=(r(80),r(81),r(88),r(85)),p=r(84),f=(r(83),r(86),r(87),r(97)),b=(r(302),(e,t,r)=>{for(var i=0,n=t.length;i<n;i++){var a=t[i];Array.isArray(a)?b(e,a,r):null!=a&&!1!==a&&("string"==typeof a&&(a={vnodeSelector:"",properties:void 0,children:void 0,text:a.toString(),domNode:null}),r.push(a))}});function m(e,t,r){if(Array.isArray(t))r=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||r&&("string"==typeof r||r.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");var i,n;return r&&1===r.length&&"string"==typeof r[0]?i=r[0]:r&&(b(e,r,n=[]),0===n.length&&(n=void 0)),{vnodeSelector:e,properties:t,children:n,text:""===i?void 0:i,domNode:null}}r(367);var v=class extends f.a{constructor(e){super(e),this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.width=1,this.color=[0,0,0,.5],this.visible=!0}get startPosition(){return[this.startX,this.startY]}set startPosition(e){this._set("startX",e[0]),this._set("startY",e[1])}get endPosition(){return[this.endX,this.endY]}set endPosition(e){this._set("endX",e[0]),this._set("endY",e[1])}get strokeStyle(){var e=this.color;return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3],")")}get lineCap(){return"round"}render(){var{height:e,left:t,top:r,width:i,x1:n,x2:a,y1:s,y2:o}=this.calculateCoordinates(g),c="stroke: ".concat(this.strokeStyle,"; stroke-width: ").concat(this.width,"; stroke-linecap: ").concat(this.lineCap,";");return m("div",{classes:{"esri-line-overlay-item":!0},styles:{left:t+"px",top:r+"px",width:i+"px",height:e+"px",visibility:this.visible?"visible":"hidden"}},[m("svg",{width:i,height:e},[m("line",{x1:n,y1:s,x2:a,y2:o,style:c})])])}renderCanvas(e){if(this.visible){e.strokeStyle=this.strokeStyle,e.lineWidth=this.width,e.lineCap=this.lineCap;var t=this.calculateCoordinates(g);e.beginPath(),e.moveTo(t.left+t.x1,t.top+t.y1),e.lineTo(t.left+t.x2,t.top+t.y2),e.stroke()}}calculateCoordinates(e){var t=Math.min(this.startX,this.endX),r=Math.max(this.startX,this.endX),i=Math.min(this.startY,this.endY),n=Math.max(this.startY,this.endY),a=this.width;return e.left=t-a,e.top=i-a,e.width=r-t+2*a,e.height=Math.max(20,n-i+2*a),e.x1=this.startX-t+a,e.y1=this.startY-i+a,e.x2=this.endX-t+a,e.y2=this.endY-i+a,e}};Object(d.a)([Object(h.b)()],v.prototype,"startX",void 0),Object(d.a)([Object(h.b)()],v.prototype,"startY",void 0),Object(d.a)([Object(h.b)()],v.prototype,"endX",void 0),Object(d.a)([Object(h.b)()],v.prototype,"endY",void 0),Object(d.a)([Object(h.b)()],v.prototype,"startPosition",null),Object(d.a)([Object(h.b)()],v.prototype,"endPosition",null),Object(d.a)([Object(h.b)()],v.prototype,"width",void 0),Object(d.a)([Object(h.b)()],v.prototype,"color",void 0),Object(d.a)([Object(h.b)()],v.prototype,"visible",void 0),Object(d.a)([Object(h.b)({readOnly:!0})],v.prototype,"strokeStyle",null),v=Object(d.a)([Object(p.a)("esri.views.overlay.LineOverlayItem")],v);var g={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},y=v,O={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"},j=class extends f.a{constructor(e){super(e),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.backgroundColor="rgba(0, 0, 0, 0.6)",this.textColor="white",this.textShadowColor=[0,0,0],this.textShadowSize=1}get position(){return[this.x,this.y]}set position(e){this._set("x",e[0]),this._set("y",e[1])}get padding(){return.5*this.fontSize}render(){return m("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 ".concat(this.textShadowSize,"px rgb(").concat(this.textShadowColor[0],", ").concat(this.textShadowColor[1],", ").concat(this.textShadowColor[2],")")}},[this.text])}renderCanvas(e){if(this.visible){var t=e.font.replace(/^(.*?)px/,"");e.font="".concat(this.fontSize,"px ").concat(t);var r=this.padding,i=this.padding,n=e.measureText(this.text).width,a=this.fontSize,s=_[this.anchor];e.textAlign="center",e.textBaseline="middle";var o=n+2*r,c=a+2*r,l=this.x+s.x*o,u=this.y+s.y*c;this.roundedRect(e,l,u,o,c,i),e.fillStyle=this.backgroundColor,e.fill();var d=this.x+(s.x+.5)*o,h=this.y+(s.y+.5)*c;this._renderTextShadow(e,this.text,d,h),e.fillStyle=this.textColor,e.fillText(this.text,d,h)}}_renderTextShadow(e,t,r,i){e.lineJoin="miter",e.fillStyle="rgba(".concat(this.textShadowColor[0],", ").concat(this.textShadowColor[1],", ").concat(this.textShadowColor[2],", ").concat(1/w.length,")");var n=this.textShadowSize;for(var[a,s]of w)e.fillText(t,r+n*a,i+n*s)}roundedRect(e,t,r,i,n,a){e.beginPath(),e.moveTo(t,r+a),e.arcTo(t,r,t+a,r,a),e.lineTo(t+i-a,r),e.arcTo(t+i,r,t+i,r+a,a),e.lineTo(t+i,r+n-a),e.arcTo(t+i,r+n,t+i-a,r+n,a),e.lineTo(t+a,r+n),e.arcTo(t,r+n,t,r+n-a,a),e.closePath()}_cssClasses(){var e={"esri-text-overlay-item":!0};for(var t in O)e[O[t]]=this.anchor===t;return e}};Object(d.a)([Object(h.b)()],j.prototype,"x",void 0),Object(d.a)([Object(h.b)()],j.prototype,"y",void 0),Object(d.a)([Object(h.b)()],j.prototype,"position",null),Object(d.a)([Object(h.b)()],j.prototype,"text",void 0),Object(d.a)([Object(h.b)()],j.prototype,"fontSize",void 0),Object(d.a)([Object(h.b)()],j.prototype,"anchor",void 0),Object(d.a)([Object(h.b)()],j.prototype,"visible",void 0),Object(d.a)([Object(h.b)()],j.prototype,"padding",null),j=Object(d.a)([Object(p.a)("esri.views.overlay.TextOverlayItem")],j);for(var _={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},w=[],x=0;x<360;x+=22.5)w.push([Math.cos(Math.PI*x/180),Math.sin(Math.PI*x/180)]);var S=j;class M extends l.a{constructor(e){super(e.view),this._handles=new o.a,this._textItem=null,this._calloutItem=null,this._showCallout=!0,this._showText=!0,this._geometry=null,this._text=null,this._fontSize=14,this._distance=25,this._anchor="right",this.applyProps(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._updateLabelPosition()}get textItem(){return this._textItem}get text(){return this._text}set text(e){this._text=e,this.attached&&(this._textItem.text=this._text)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e,this.attached&&(this._textItem.fontSize=this._fontSize)}get distance(){return this._distance}set distance(e){this._distance!==e&&(this._distance=e,this._updateLabelPosition())}get anchor(){return this._anchor}set anchor(e){this._anchor!==e&&(this._anchor=e,this._updateLabelPosition())}overlaps(e){return this.textItem.visible&&e.textItem.visible&&this.view.overlay.overlaps(this._textItem,e.textItem)}_updateLabelPosition(){if(this.attached){if(this._showText=!1,this._showCallout=!1,Object(i.k)(this.geometry)&&this.view._stage)switch(this.geometry.type){case"point":this._computeLabelPositionFromPoint(this.geometry,k)&&(this._textItem.position=[k[0],k[1]],this._textItem.anchor="center",this._showText=!0);break;case"corner":this._computeLabelPositionFromCorner(this.geometry,this._distance,k,z)&&(this._showCallout=this._updatePosition(k,z),this._showText=!0);break;case"segment":this._computeLabelPositionFromSegment(this.geometry,this._distance,this._anchor,k,z)&&(this._showText=!0,this._showCallout=this._updatePosition(k,z))}this.updateVisibility(this.visible)}}_computeLabelPositionFromPoint(e,t){this.view.renderCoordsHelper.toRenderCoords(e,L);var r=this.view._stage.camera;return r.projectToRenderScreen(L,D),!(D[2]<0||D[2]>1)&&(r.renderToScreen(D,t),!0)}_computeLabelPositionFromCorner(e,t,r,i){if(!e)return!1;var n=this.view._stage.camera;return T(e.left,1,n,A),Object(c.n)(A,A),T(e.right,0,n,R),Object(c.h)(F,A,R),Object(c.n)(F,F),Object(c.e)(F,F),n.projectToRenderScreen(e.left.endRenderSpace,D),!(D[2]<0||D[2]>1)&&(n.renderToScreen(D,r),Object(c.a)(F,F,t*n.pixelRatio),Object(c.h)(F,F,D),n.renderToScreen(F,i),!0)}_computeLabelPositionFromSegment(e,t,r,i,n){if(!e)return!1;var a=e.segment,s=this.view._stage.camera;Object(u.e)(a.startRenderSpace,a.endRenderSpace,A,s),Object(c.r)(F,-A[1],A[0]);var o=!1;switch(r){case"top":o=F[1]<0;break;case"bottom":o=F[1]>0;break;case"left":o=F[0]>0;break;case"right":o=F[0]<0}if(o&&Object(c.n)(F,F),0===Object(c.l)(F))switch(r){case"top":F[1]=1;break;case"bottom":F[1]=-1;break;case"left":F[0]=-1;break;case"right":F[0]=1}return a.eval(q[e.sampleLocation],L),s.projectToRenderScreen(L,D),!(D[2]<0||D[2]>1)&&(s.renderToScreen(D,i),Object(c.a)(F,F,t*s.pixelRatio),Object(c.h)(F,F,D),s.renderToScreen(F,n),!0)}_updatePosition(e,t){if(t){var r=t[0]-e[0],i=t[1]-e[1];return this._textItem.position=[t[0],t[1]],this._textItem.anchor=Math.abs(r)>Math.abs(i)?r>0?"left":"right":i>0?"top":"bottom",this._calloutItem.startPosition=[e[0],e[1]],this._calloutItem.endPosition=[t[0],t[1]],!0}return this._textItem.position=[e[0],e[1]],this._textItem.anchor="center",!1}createResources(){this._textItem=new S({visible:!0}),this._textItem.text=Object(i.q)(this._text),this._textItem.fontSize=this._fontSize,this._calloutItem=new y({visible:!0,width:2}),this._updateLabelPosition(),this.view.overlay.items.addMany([this._textItem,this._calloutItem]),this._handles.add(this.view.state.watch("camera",(()=>{this._updateLabelPosition()})))}destroyResources(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}updateVisibility(e){this._textItem.visible=this._showText&&e,this._calloutItem.visible=this._showCallout&&e}}function T(e,t,r,i){e.eval(t,P,I),Object(s.e)(C,P,I),r.projectToRenderScreen(P,V),r.projectToRenderScreen(C,U),Object(c.d)(i,B,N),Object(c.e)(i,i)}function E(e){switch(e){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}var P=Object(a.e)(),C=Object(a.e)(),I=Object(a.e)(),A=Object(n.d)(),R=Object(n.d)(),F=Object(n.d)(),L=Object(a.e)(),D=Object(n.e)(),k=Object(n.g)(),z=Object(n.g)(),V=Object(n.e)(),N=V,U=Object(n.e)(),B=U,q={start:0,center:.5,end:1}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t);var i=r(82),n=(r(80),r(81)),a=(r(88),r(85)),s=r(145),o=r(84),c=(r(83),r(86),r(87),r(94)),l=r(117),u=(r(114),r(261)),d=r(163),h=r(129),p=r(154),f=r(115),b=r(108),m=r(828),v=r(759),g=r(532),y=r(89),O=r(105),j=r(104),_=r(111),w=r(157),x=r(174),S=r(370),M=r(758),T=r(786),E=r(606),P=r(631),C=r(635),I=r(651),A=r(760),R=r(1057),F=r(907),L=r(463),D=r(468),k=r(91),z=r(388),V=r(328),N=r(379),U=r(585),B=r(300),q=r(307),G=r(313),H=r(306),W=r(286),J=r(267),Z=r(380),X=r(349),Y=r(280),Q=r(977);class K extends q.a{initializeProgram(e){var t=K.shader.get(),r=this.configuration,i=t.build({OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new W.a(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),H.a)}bindPass(e,t,r){Z.a.bindProjectionMatrix(this.program,r.camera.projectionMatrix),this.program.setUniform2fv("size",t.size),this.program.setUniform4fv("color1",t.color1),this.program.setUniform4fv("color2",t.color2),r.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",r.camera.nearFar),this.program.setUniform2fv("inverseViewport",r.inverseViewport),Object(Y.a)(this.program,e,r))}bindDraw(e){Z.a.bindView(this.program,e)}setPipelineState(e){var t=this.configuration,r=3===e,i=2===e;return Object(J.d)({blending:t.transparent?r?ee:Object(X.a)(e):null,depthTest:{func:Object(X.b)(e)},depthWrite:r?t.writeDepth&&J.c:Object(X.c)(e),colorWrite:J.b,polygonOffset:r||i?t.polygonOffset&&$:{factor:-1,units:-25}})}initializePipeline(){return this.setPipelineState(this.configuration.transparencyPassType)}}K.shader=new B.a(Q.a,(()=>r.e(292).then(r.bind(null,1215))));var $={factor:0,units:-25},ee=Object(J.e)(770,1,771,771);class te extends G.a{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.polygonOffset=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}Object(i.a)([Object(G.b)()],te.prototype,"transparent",void 0),Object(i.a)([Object(G.b)()],te.prototype,"writeDepth",void 0),Object(i.a)([Object(G.b)()],te.prototype,"polygonOffset",void 0),Object(i.a)([Object(G.b)({count:4})],te.prototype,"transparencyPassType",void 0),Object(i.a)([Object(G.b)()],te.prototype,"multipassTerrainEnabled",void 0),Object(i.a)([Object(G.b)()],te.prototype,"cullAboveGround",void 0);class re extends N.a{constructor(e){super(e,ne),this.techniqueConfig=new te}dispose(){}getPassParameters(){return this.params}getTechniqueConfig(e){return this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.transparencyPassType=e?e.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!e&&e.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!e||e.cullAboveGround,this.techniqueConfig}intersect(e,t,r,i,n,a,s){return Object(V.e)(e,t,i,n,a,void 0,s)}getGLMaterial(e){return 0===e.output||7===e.output?new ie(e):void 0}createBufferWriter(){return new U.a(U.d)}}class ie extends z.a{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(K,this.material.getTechniqueConfig(e),this.technique)}beginSlot(e){var t=3;return this.technique.configuration.transparent&&(t=this.technique.configuration.writeDepth?5:8),e===t}ensureParameters(e){this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}}var ne=Object(k.a)({size:[1,1],color1:[.75,.75,.75,1],color2:[.5,.5,.5,1],transparent:!1,writeDepth:!0,polygonOffset:!1},N.b);class ae extends D.a{constructor(e){super(e),this._checkerBoardMaterial=null,this._renderOccluded=4,this._geometry=null,this._size=[1,1],this._color1=[1,.5,0,.5],this._color2=[1,1,1,.5],this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this.updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.geometryChanged()}get size(){return this._size}set size(e){this._size=e,this.updateMaterial()}get color1(){return this._color1}set color1(e){this._color1=e,this.updateMaterial()}get color2(){return this._color2}set color2(e){this._color2=e,this.updateMaterial()}updateMaterial(){Object(y.k)(this._checkerBoardMaterial)&&this._checkerBoardMaterial.setParameterValues({size:this._size,color1:this._color1,color2:this._color2,renderOccluded:this._renderOccluded})}createExternalResources(){this._checkerBoardMaterial=new re({size:this._size,color1:this._color1,color2:this._color2,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:4})}destroyExternalResources(){this._checkerBoardMaterial=null}forEachExternalMaterial(e){Object(y.k)(this._checkerBoardMaterial)&&e(this._checkerBoardMaterial)}createGeometries(e){if(!Object(y.j)(this._geometry)&&!Object(y.j)(this._checkerBoardMaterial)){var t=se;Object(w.m)(t,this.transform);var r=this._geometry,i=[],n=Object(j.e)();r.position.forEach((e=>{Object(_.i)(n,e,t),i.push(n[0],n[1],n[2])}));var a=[];r.uv.forEach((e=>{a.push(e[0],e[1])}));var s=new L.a([["position",{size:3,data:i,exclusive:!0}],["uv0",{size:2,data:a,exclusive:!0}]],[["position",r.triangleIndices],["uv0",r.triangleIndices]]);e.addGeometry(s,this._checkerBoardMaterial)}}geometryChanged(){this.recreateGeometry()}}var se=Object(j.e)(),oe=r(978),ce={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};class le{constructor(e,t=new P.a,r={}){this._model=e,this._manipulators=t,this.vertexManipulators=[],this._visible=!1,this._path=null,this._intersectedPath=null,this._perimeter=null,this._intersectedPerimeter=null,this._projectionLines=null,this._laserLine=null,this._measurementArea=null,this._areaLabel=null,this._pathLengthLabel=null,this._cursorSegmentLengthLabel=null,this._perimeterLengthLabel=null,this._cursorManipulator=null,this._pathSegments=[],this._perimeterSegments=[],this._cursorSegment=null,this._listenerHandles=null,this._origin=Object(j.e)(),this._originTransform=Object(x.b)(),this._tempHandlePosition=Object(j.e)(),this._cursorPositionRenderSpace=Object(j.e)(),this._view=this._model.sceneView,this._params=Object(A.a)(ce,r),this._intersector=new M.a(this._view.state.mode),this._intersector.options.store=0;var i=Object(I.e)(this._view,this._params.handleColor,this._params.handleOpacity);i.available=!1,i.radius=this._params.handleRadius,i.interactive=!1,this._manipulators.add(i),this._cursorManipulator=i,this._path=new F.a({view:this._view,attached:!0,width:this._params.pathLineWidth,color:this._params.pathLineColor,polygonOffset:!0,renderOccluded:4}),this._intersectedPath=new F.a({view:this._view,attached:!0,width:this._params.pathLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0,renderOccluded:4}),this._perimeter=new F.a({view:this._view,attached:!0,width:this._params.perimeterLineWidth,color:this._params.perimeterLineColor,polygonOffset:!0,renderOccluded:4}),this._intersectedPerimeter=new F.a({view:this._view,attached:!0,width:this._params.perimeterLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0,renderOccluded:4}),this._projectionLines=new F.a({view:this._view,attached:!0,width:this._params.projectionLineWidth,color:this._params.projectionLineColor,stipplePattern:Object(T.c)(this._params.projectionLineStippleSize),stippleIntegerRepeats:!1,polygonOffset:!0,renderOccluded:4}),this._laserLine=new E.a({view:this._view,attached:!0,style:{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,glowFalloff:this._params.laserLineGlowFalloff,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha}}),this._measurementArea=new ae({view:this._view,attached:!0,color1:this._params.areaColor1,color2:this._params.areaColor2}),this._areaLabel=new R.a({view:this._view,attached:!0,fontSize:16}),this._pathLengthLabel=new R.a({view:this._view,attached:!0,fontSize:12}),this._cursorSegmentLengthLabel=new R.a({view:this._view,attached:!0,fontSize:12}),this._perimeterLengthLabel=new R.a({view:this._view,attached:!0,fontSize:12})}destroy(){this.hide(),this._laserLine.destroy(),this._laserLine=null,this._measurementArea.destroy(),this._measurementArea=null,this._path.destroy(),this._path=null,this._intersectedPath.destroy(),this._intersectedPath=null,this._perimeter.destroy(),this._perimeter=null,this._intersectedPerimeter.destroy(),this._intersectedPerimeter=null,this._areaLabel.destroy(),this._areaLabel=null,this._pathLengthLabel.destroy(),this._pathLengthLabel=null,this._cursorSegmentLengthLabel.destroy(),this._cursorSegmentLengthLabel=null,this._perimeterLengthLabel.destroy(),this._perimeterLengthLabel=null}get requiresCursorPoint(){return("initial"===this._model.state||"drawing"===this._model.state)&&this._model.active}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){var e=this._laserLine.testData;return{labels:{area:this._areaLabel,pathLength:this._pathLengthLabel,cursorSegmentLength:this._cursorSegmentLengthLabel,perimeterLength:this._perimeterLengthLabel},laserLineRenderer:Object(y.k)(e)?{heightManifoldEnabled:e.heightManifoldEnabled,heightManifoldTarget:e.heightManifoldTarget,pointDistanceEnabled:e.pointDistanceEnabled,pointDistanceOrigin:e.pointDistanceOrigin,pointDistanceTarget:e.pointDistanceTarget,lineVerticalPlaneEnabled:e.lineVerticalPlaneEnabled}:{heightManifoldEnabled:!1,heightManifoldTarget:null,pointDistanceEnabled:!1,pointDistanceOrigin:null,pointDistanceTarget:null,lineVerticalPlaneEnabled:!1}}}show(){this._visible||(this._visible=!0,this._path.visible=!0,this._intersectedPath.visible=!0,this._perimeter.visible=!0,this._intersectedPerimeter.visible=!0,this._projectionLines.visible=!0,this._laserLine.visible=!0,this._measurementArea.visible=!0,this._areaLabel.visible=!0,this._pathLengthLabel.visible=!0,this._cursorSegmentLengthLabel.visible=!0,this._perimeterLengthLabel.visible=!0,this._initializeListeners(),this._updateAll(this._model.viewData))}hide(){this._visible&&(this._visible=!1,this._path.visible=!1,this._intersectedPath.visible=!1,this._perimeter.visible=!1,this._projectionLines.visible=!1,this._intersectedPerimeter.visible=!1,this._laserLine.visible=!1,this._measurementArea.visible=!1,this._areaLabel.visible=!1,this._pathLengthLabel.visible=!1,this._cursorSegmentLengthLabel.visible=!1,this._perimeterLengthLabel.visible=!1,this._destroyListeners(),this.vertexManipulators.forEach((e=>{this._removeVertexManipulator(e.manipulator)})),this.vertexManipulators=[],this._view.cursor=null)}vertexHandleAt(e,t){var r=this._manipulators.intersect(e,t);return Object(y.k)(r)?r.manipulator.metadata:null}manipulatorToVertex(e){return e.metadata}pick(e){var t=this._view.spatialReference,r=Object(O.j)(e.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(r,this._intersector);var i=this._intersector.results.min,n=Object(j.e)();if(!i.getIntersectionPoint(n))return new le.PickResult;var a=this._view.renderCoordsHelper.fromRenderCoords(n,t);if(Object(y.j)(a))return new le.PickResult;var s="TerrainRenderer"===i.intersector?"surface":"feature";return new le.PickResult(s,n,a)}overlappingHandles(e,t){return Object(A.c)(e,t,this._view)<=this._params.handleRadius}screenToMap3D(){return Object(C.b)(this._view)}_updateOrigin(e){Object(A.b)(e.positionsRenderCoords,this._origin),Object(w.i)(this._originTransform),Object(w.s)(this._originTransform,this._originTransform,this._origin),this._measurementArea.transform=this._originTransform,this._projectionLines.transform=this._originTransform}_updateAll(e){this._visible&&(this._updateOrigin(e),this._updatePathSegments(e),this._updatePerimeterSegments(e),this._updateVertexManipulators(e),this._updateArea(e),this._updateProjectionLines(e),this._updateLabels(e),this._updateLaserLine())}_createSegments(e,t){for(var r=e.path,i=this._view.renderCoordsHelper.spatialReference,n=this._model.measurementMode,a=[],s=[],o=[],c=e.validMeasurement?r.numVertices:r.numVertices-1,l=0;l<c;++l){var u=e[t][l],d=e[t][(l+1)%r.numVertices],h=null;switch(n){case"euclidean":h=new oe.a(u,d);break;case"geodesic":h=new oe.b(u,d,i)}e.intersectingSegments.has(l)?o.push(h):s.push(h),a.push(h)}return{all:a,nonIntersecting:s,intersecting:o}}_updatePathSegments(e){var t=this._createSegments(e,"positionsRenderCoords"),r=e.path,i=this._view.renderCoordsHelper,n=i.spatialReference,a=this._model.measurementMode;if(this._cursorSegment=null,r.numVertices>0&&"drawing"===this._model.state&&Object(y.k)(this._model.cursorPoint)&&i.toRenderCoords(this._model.cursorPoint,this._cursorPositionRenderSpace)){var s=e.positionsRenderCoords[r.numVertices-1],o=this._cursorPositionRenderSpace,c=null;switch(a){case"euclidean":c=new oe.a(s,o);break;case"geodesic":c=new oe.b(s,o,n)}t.nonIntersecting.push(c),this._cursorSegment=c}this._path.setGeometryFromSegments(t.nonIntersecting,this._origin),this._intersectedPath.setGeometryFromSegments(t.intersecting,this._origin),this._pathSegments=t.all}_updatePerimeterSegments(e){var t=this._createSegments(e,"positionsFittedRenderCoords");this._perimeter.setGeometryFromSegments(t.nonIntersecting,this._origin),this._intersectedPerimeter.setGeometryFromSegments(t.intersecting,this._origin),this._perimeterSegments=t.all}_createVertexManipulator(){var e=Object(I.e)(this._view,this._params.handleColor,this._params.handleOpacity);return e.radius=this._params.handleRadius,{id:this._manipulators.add(e),manipulator:e}}_removeVertexManipulator(e){this._manipulators.remove(e)}_updateVertexManipulators(e){var t=this._model.path.vertices,r=this.vertexManipulators;Object(A.d)(r,t.length,(()=>this._createVertexManipulator()),(e=>this._removeVertexManipulator(e.manipulator))),r.forEach(((r,i)=>{r.manipulator.metadata=t[i],r.manipulator.renderLocation=e.positionsRenderCoords[i]})),"drawing"===this._model.state&&Object(y.k)(this._model.cursorPoint)?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._model.cursorPoint):this._cursorManipulator.available=!1}_updateArea(e){switch(this._model.measurementMode){case"euclidean":this._updateAreaEuclidean(e);break;case"geodesic":this._updateAreaGeodesic()}}_updateAreaEuclidean(e){e.validMeasurement&&0===e.intersectingSegments.size&&e.triangleIndices?(this._measurementArea.geometry={uv:e.positionsProjected,position:e.positionsFittedRenderCoords,triangleIndices:e.triangleIndices},this._measurementArea.size=[e.checkerSize,e.checkerSize],this._measurementArea.visible=!0,this._perimeter.visible=!0,this._projectionLines.visible=!0):(this._measurementArea.visible=!1,this._perimeter.visible=!1,this._projectionLines.visible=!1)}_updateAreaGeodesic(){this._measurementArea.visible=!1,this._perimeter.visible=!1,this._projectionLines.visible=!1}_updateProjectionLines(e){var t=e.path;if(t.numVertices>0&&e.validMeasurement&&"euclidean"===this._model.measurementMode){for(var r=[],i=0;i<t.numVertices;++i){var n=Object(j.e)();Object(_.i)(n,this._model.viewData.positionsRenderCoords[i],this._origin);var a=Object(j.e)();Object(_.i)(a,this._model.viewData.positionsFittedRenderCoords[i],this._origin),r.push([n,a])}this._projectionLines.geometry=r}else this._projectionLines.geometry=null}_updateLabels(e){if(this._visible){var t=this._model,r=this._view,i="drawing"===t.state;if(this._areaLabel.geometry=r.renderCoordsHelper.fromRenderCoords(e.areaCentroid,r.spatialReference),this._areaLabel.text=t.areaLabel,this._areaLabel.visible=e.validMeasurement&&0===e.intersectingSegments.size&&null!=t.areaLabel,e.pathLengthLabelSegmentIndex>=0&&e.pathLengthLabelSegmentIndex<this._pathSegments.length){var n=this._pathSegments[e.pathLengthLabelSegmentIndex],a=Object(y.k)(this._cursorSegment)?this._cursorSegment:ue;this._pathLengthLabel.distance=this._params.labelDistance,this._pathLengthLabel.geometry={type:"corner",left:n,right:a},this._pathLengthLabel.text=t.pathLengthLabel,this._pathLengthLabel.visible=i&&t.path.numVertices>0}else this._pathLengthLabel.visible=!1;this._cursorSegmentLengthLabel.distance=this._params.labelDistance,this._cursorSegmentLengthLabel.geometry=Object(y.k)(this._cursorSegment)?{type:"segment",segment:this._cursorSegment,sampleLocation:"end"}:null,this._cursorSegmentLengthLabel.anchor="bottom",this._cursorSegmentLengthLabel.text=t.cursorSegmentLengthLabel,this._cursorSegmentLengthLabel.visible=i&&!!t.cursorSegmentLength&&0!==t.cursorSegmentLength.value,this._cursorSegmentLengthLabel.overlaps(this._pathLengthLabel)&&(this._cursorSegmentLengthLabel.visible=!1),this._pathLengthLabel.overlaps(this._areaLabel)&&(this._pathLengthLabel.visible=!1),this._updatePerimeterLabel(this._model.viewData)}}_updatePerimeterLabel(e){var t=this._model,r="geodesic"===t.measurementMode;if(t.validMeasurement&&0===e.intersectingSegments.size){this._perimeterLengthLabel.distance=this._params.labelDistance,this._perimeterLengthLabel.anchor="top",this._perimeterLengthLabel.text=t.perimeterLengthLabel,this._perimeterLengthLabel.visible=!0;for(var i=!0,n=0;n<e.path.numVertices;++n){var a=(e.perimeterLengthLabelSegmentIndex+n)%e.path.numVertices,s=r?this._pathSegments[a]:this._perimeterSegments[a];if(i=!0,this._perimeterLengthLabel.geometry={type:"segment",segment:s,sampleLocation:"center"},!this._perimeterLengthLabel.overlaps(this._areaLabel))break;i=!1}this._perimeterLengthLabel.visible=i}else this._perimeterLengthLabel.visible=!1}_getFocusPoint(){var e=this._model,t=this._model.lastDraggedVertex;switch(e.state){case"drawing":return Object(y.k)(e.cursorPoint)?e.cursorPoint:Object(y.k)(t)?e.path.getVertexPositionAsPoint(t):Object(y.q)(e.path.lastPoint);case"editing":return Object(y.k)(t)?e.path.getVertexPositionAsPoint(t):null;default:return e.cursorPoint}}_updateLaserLine(){var e=this._model,t=this._params.laserLineEnabled&&"measured"!==e.state&&e.active,r=this._getFocusPoint();if(t&&Object(y.k)(r)){var i=this._tempHandlePosition;this._view.renderCoordsHelper.toRenderCoords(r,i),this._laserLine.heightManifoldTarget=i}else this._laserLine.heightManifoldTarget=null}_initializeListeners(){this._listenerHandles=new f.a,this._listenerHandles.add([this._model.watch(["state","lastDraggedVertex"],(()=>this._updateLaserLine())),this._model.watch(["cursorPoint","unit","measurementMode","active","viewData"],(()=>this._updateAll(this._model.viewData))),this._model.watch(["areaLabel","cursorSegmentLengthLabel","pathLengthLabel","perimeterLengthLabel"],(()=>{this._updateAll(this._model.viewData)})),this._view.state.watch("camera",(()=>this._updatePerimeterLabel(this._model.viewData)))])}_destroyListeners(){this._listenerHandles.destroy(),this._listenerHandles=null}}le._handleGeometry=S.a.createSphereGeometry(1,32,32),function(e){e.PickRequest=class{};e.PickResult=class{constructor(e=null,t=null,r=null){this.type=e,this.scenePoint=t,this.mapPoint=r}}}(le||(le={}));var ue=new oe.a(Object(j.e)(),Object(j.e)()),de=le,he=r(363),pe=r(480),fe=r(397);function be(e){return"mouse"!==e.pointerType||0===e.button}var me=class{constructor(e,t,r){this._manipulators=r,this._handles=new f.a,this._tempPickRequest=new de.PickRequest,this.model=e,this.view=t,this.model.reset(),this._setupManipulators()}destroy(){this._handles.destroy(),this._handles=null}handleInputEvent(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"drag":this._handleDrag(e);break;case"key-down":this._handleKeyDown(e)}}_setupManipulators(){var e=e=>"manipulator-".concat(e),t=0,r=e=>r=>("start"===r.action&&(t++,this.model.lastDraggedVertex=Object(y.q)(this.view.manipulatorToVertex(e)),"measured"===this.model.state&&(this.model.state="editing")),r),i=()=>e=>"end"===e.action?(0===--t&&"editing"===this.model.state&&(this.model.state="measured"),null):e,n=(t,n)=>{this._handles.add([Object(fe.e)(n,((e,t,n)=>{var a=Object(C.a)(e),s=Object(y.q)(this.view.manipulatorToVertex(e));t.next(r(e)).next(a).next(i()).next(this.view.screenToMap3D()).next((t=>{e.location=t.mapEnd,this.model.path.setVertexPosition(s,Object(pe.a)(t.mapEnd))}));var o=Object(pe.a)(this.model.path.getVertexPositionAsPoint(s));n.next(a).next((()=>{this.model.path.setVertexPosition(s,o),e.location=o}))})),n.events.on("double-click",(e=>{be(e)&&("drawing"===this.model.state&&this.model.finishMeasurement(),e.stopPropagation())}))],e(t))},a=t=>{this._handles.remove(e(t))};this._manipulators.forEach((({id:e,manipulator:t})=>{n(e,t)})),this._handles.add([this._manipulators.on("after-add",(({item:{id:e,manipulator:t}})=>{n(e,t)})),this._manipulators.on("after-remove",(({item:{id:e}})=>{a(e)}))])}_handleDrag(e){"editing"===this.model.state&&e.stopPropagation()}_handleImmediateClick(e){if(be(e)){var t=Object(he.a)(e);if(this.model.active)switch(this.model.state){case"initial":this._addVertexAt(t)&&(this.model.state="drawing",e.stopPropagation());break;case"drawing":var r=this.view.vertexHandleAt(t,e.pointerType);if(Object(y.j)(r)){if(this._addVertexAt(t))return}else 0===r.index&&(this.model.finishMeasurement(),e.stopPropagation())}"mouse"===e.pointerType&&this._hoverAt(t)}}_handlePointerMove(e){if("mouse"===e.pointerType){var t=Object(he.a)(e);this._hoverAt(t)}}_handleKeyDown(e){"Enter"===e.key&&"drawing"===this.model.state&&(this.model.finishMeasurement(),e.stopPropagation())}_hoverAt(e){if(this.view.requiresCursorPoint){var t=this._pick(e);t.mapPoint&&(this.model.cursorPoint=t.mapPoint)}else this.model.cursorPoint=null}_addVertexAt(e){var t=this._pick(e);return!!t.mapPoint&&(this.model.path.add(t.mapPoint),!0)}_pick(e){var t=this._tempPickRequest;return t.screenPoint=e,this.view.pick(t)}},ve=r(7),ge=r(97),ye=r(148),Oe=r(110),je=r(206),_e=(r(171),r(173)),we=r(223),xe=r(909),Se=r(979),Me=class extends ge.a{constructor(){super(...arguments),this.result=null}destroy(){this.result=null}set geometry(e){this.result=null,this._set("geometry",Object(y.k)(e)?e.clone():null)}};Object(i.a)([Object(a.b)({value:null})],Me.prototype,"geometry",null),Object(i.a)([Object(a.b)()],Me.prototype,"result",void 0),Me=Object(i.a)([Object(o.a)("esri.views.3d.interactive.graphics.AreaMeasurement3D")],Me);var Te=r(113),Ee=(r(101),r(131)),Pe=r(531),Ce=r(264),Ie=r(688);class Ae{constructor(e,t,r){this.editGeometry=e,this.vertex=t,this.pos=r}apply(){var e="redo";Object(y.j)(this.originalPosition)&&(e="apply",this.originalPosition=this.vertex.pos),this._apply(e)}undo(){this.vertex.pos=Object(y.q)(this.originalPosition);var e={updatedVertices:[this.vertex],operation:"undo"};this.editGeometry.emit("change",e)}accumulate(e){return e instanceof Ae&&e.vertex===this.vertex&&(this.pos=e.pos,this._apply("apply"),!0)}_apply(e){this.vertex.pos=this.pos,this.editGeometry.components.forEach((e=>e.unnormalizeVertexPositions()));var t={updatedVertices:[this.vertex],operation:e};this.editGeometry.emit("change",t)}}class Re extends Ee.a{constructor(){super(),this._handles=new f.a,this._dirty=!0,this._model=null,this._view=null,this._version=0,this._internalGeometryChange=!1}set model(e){this._model=e,Object(y.k)(this._model)&&Object(y.k)(this._view)&&this._initialize(this._model,this._view)}get model(){return this._model}get view(){return this._view}set view(e){this._view=e,Object(y.k)(this._model)&&Object(y.k)(this._view)&&this._initialize(this._model,this._view)}get initialized(){return Object(y.k)(this._model)&&Object(y.k)(this._view)}get version(){return this._version}_initialize(e,t){this._handles.removeAll(),this._handles.add(Object(b.a)(e,"geometry",(()=>this._updateEditGeometryFromModelGeometry(e,t)),!0))}_updateEditGeometryFromModelGeometry(e,t){this._version++,this._internalGeometryChange||(this._handles.remove("EditGeometry"),this._editGeometry=Object(y.k)(e.geometry)?Ce.c.fromGeometry(e.geometry,t.viewingMode):new Ce.c(Object(Pe.a)(!0,!1,t.spatialReference,t.viewingMode)),this.emit("clear",{type:"clear"}),this._handles.add(this._editGeometry.on("change",(t=>{this._internalGeometryChange=!0,e.geometry=this.numVertices>0?this._editGeometry.toPolygon():null,this._internalGeometryChange=!1})),"EditGeometry"))}get vertices(){var e=[];return this.forEachVertex((t=>{e.push(t)})),e}get numVertices(){return this.initialized&&this._editGeometry.components.length>0?this._editGeometry.components[0].vertices.length:0}get lastPoint(){if(this.initialized&&this._editGeometry.components.length>0){var e=this._editGeometry.components[0].getLastVertex();if(Object(y.k)(e))return this._editGeometry.coordinateHelper.createPoint(e.pos)}return null}getVertex(e){if(!this.initialized||0===this._editGeometry.components.length||0===this._editGeometry.components[0].vertices.length)return null;var t=this._editGeometry.components[0].vertices[0],r=t;do{if(r.index===e)return r;r=r.right.right}while(r!==t&&null!=r);return null}getVertexPositionAsPoint(e){return this._editGeometry.coordinateHelper.createPoint(e.pos)}getVertexPositionAsPointFromIndex(e){return this._editGeometry.coordinateHelper.createPoint(this.getVertex(e).pos)}forEachVertex(e){this.initialized&&this._editGeometry.components.length>0&&this._editGeometry.components[0].iterateVertices(e)}forEachVertexPosition(e){var t=this._editGeometry.coordinateHelper;this.forEachVertex(((r,i)=>{t.toPoint(r.pos,De),e(De,i)}))}clear(){Object(y.k)(this.model)&&(this.model.geometry=null)}add(e){if(!this.initialized)return null;0===this._editGeometry.components.length&&this._editGeometry.components.push(new Ce.a(this._editGeometry));var t=new Ie.a(this._editGeometry,this._editGeometry.components[0],this._editGeometry.coordinateHelper.fromPoint(e));return this._editGeometry.apply(t),this.emit("vertex-update",{type:"vertex-update"}),t}ensureContains(e,t=""){var r=!1;if(this._editGeometry.components.forEach((t=>{t.iterateVertices((t=>{t===e&&(r=!0)}))})),!r)throw new Error("vertex doesnt exist ".concat(t));return r}setVertexPosition(e,t){if(!this.initialized)return null;var r=new Ae(this._editGeometry,e,this._editGeometry.coordinateHelper.fromPoint(t));return this._editGeometry.apply(r),this.emit("vertex-update",{type:"vertex-update"}),r}}var Fe,Le,De=new Te.a,ke=r(99),ze=r(130),Ve=r(330),Ne=r(612),Ue=r(502);(Le=Fe||(Fe={})).boundingSphere=function(e,t){var r=t.center;Object(_.v)(r,0,0,0);for(var i=0;i<e.length;++i)Object(_.e)(r,r,e[i]);Object(_.d)(r,r,1/e.length);for(var n=0,a=0;a<e.length;++a)n=Math.max(n,Object(_.k)(r,e[a]));t.radius=Math.sqrt(n)},Le.bestFitPlane=function(e,t){if(e.length<3)throw new Error("need at least 3 points to fit a plane");Object(Ve.g)(e[0],e[1],e[2],t)},Le.planePointDistance=function(e,t){return Object(_.g)(e,t)+e[3]},Le.segmentLengthEuclidean=function(e,t,r){return Object(we.o)(e,Be,r)&&Object(we.o)(t,qe,r)?Object(_.n)(Be,qe):0},Le.segmentLengthGeodesic=function(e,t){if(!Object(we.p)(e,Be)||!Object(we.p)(t,qe))return 0;var r={distance:null};return Object(Ne.e)(r,[Be[0],Be[1]],[qe[0],qe[1]]),r.distance},Le.segmentLengthGeodesicVector=function(e,t,r){var i={distance:null};return Object(Ne.e)(i,[e[0],e[1]],[t[0],t[1]],r),i.distance},Le.triangleAreaEuclidean=function(e,t,r){var i=t[0]-e[0],n=t[1]-e[1],a=r[0]-e[0],s=r[1]-e[1];return.5*Math.abs(i*s-n*a)},Le.triangleAreaGeodesic=function(e,t,r,i){var n=He;return Object(we.s)(e,i,Be)&&Object(we.s)(t,i,qe)&&Object(we.s)(r,i,Ge)?(n.setPoint(0,0,Be),n.setPoint(0,1,qe),n.setPoint(0,2,Ge),Math.abs(Object(Ue.geodesicArea)(n,"square-meters"))):0},Le.tangentFrame=function(e,t,r){Math.abs(e[0])>Math.abs(e[1])?Object(_.v)(t,0,1,0):Object(_.v)(t,1,0,0),Object(_.f)(r,e,t),Object(_.q)(t,t),Object(_.f)(t,r,e),Object(_.q)(r,r)},Le.fitHemisphere=function(e,t=null,r=!0){var i=(e,t)=>{if(0===t[0]&&0===t[1]&&0===t[2])return!1;for(var r=0;r<e.length;++r)if(Object(_.g)(t,e[r])<-1e-6)return!1;return!0};if(0===e.length)return!1;if(1===e.length)return t&&Object(_.j)(t,e[0]),!0;Object(_.v)(We,0,0,0);for(var n=0;n<e.length;++n)Object(_.e)(We,We,e[n]);if(Object(_.q)(We,We),i(e,We))return t&&Object(_.j)(t,We),!0;if(!r)return!1;for(var a=0;a<e.length;++a)for(var s=0;s<e.length;++s)if(a!==s&&(Object(_.f)(We,e[a],e[s]),Object(_.q)(We,We),i(e,We)))return t&&Object(_.j)(t,We),!0;return!1},Le.compareSets=function(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(var r=0;r<e.size;++r)if(!t.has(e[r]))return!1;return!0};var Be=Object(j.e)(),qe=Object(j.e)(),Ge=Object(j.e)(),He=new ze.a({rings:[[Be,qe,Ge]],spatialReference:ke.a.WGS84}),We=Object(j.e)(),Je=Fe,Ze=r(354),Xe=r(202),Ye=r(200),Qe=r(536),Ke=r(135);function $e(e,t){for(var r=new Float64Array(e.length*t),i=0;i<e.length;++i)for(var n=e[i],a=0;a<t;++a)r[i*t+a]=n[a];return r}var et=class{constructor(){this.positionsWorldCoords=[],this.positionsRenderCoords=[],this.positionsProjectedWorldCoords=[],this.positionsFittedRenderCoords=[],this.positionsGeographic=[],this.positionsSpherical=[],this.positionsStereographic=[],this.pathSegmentLengths=[],this.geodesicPathSegmentLengths=[],this.perimeterSegmentLengths=[],this.intersectingSegments=new Set,this.geodesicIntersectingSegments=new Set,this.areaCentroidWorldCoords=Object(j.e)(),this.areaCentroidRenderCoords=Object(j.e)(),this.geodesicAreaCentroidRenderCoords=Object(j.e)(),this._length=0,this._centroidRenderCoords=Object(j.e)(),this._planeWorldCoords=Object(Ye.c)(),this._worldUp=Object(j.e)(),this._worldTangent=Object(j.e)(),this._frame=[Object(j.e)(),Object(j.e)(),Object(j.e)()],this._pathVersion=-1,this._validMeasurement=!1,this._tempU=Object(j.e)(),this._tempV=Object(j.e)(),this._tempVec3=Object(j.e)(),this._tempSphere={center:Object(j.e)(),radius:0}}update(e,t,r,i,n,a,s){if(this._pathVersion!==e.version||this._validMeasurement!==i){this._pathVersion=e.version,this._validMeasurement=i;var o=e.numVertices;this._resize(o);var c=Object(_e.g)(t.spatialReference),l=Object(we.b)(t.spatialReference,c)&&Object(we.a)(t.spatialReference),u=this.positionsGeographic,d=this.positionsWorldCoords,h=this.positionsRenderCoords,p=this.positionsSpherical;e.forEachVertexPosition(((e,t)=>{Object(we.o)(e,d[t],a),Object(we.o)(e,h[t],n),l&&(Object(we.p)(e,u[t]),Object(we.o)(e,p[t],c),Object(_.q)(p[t],p[t]))}));var f=this._updatePathLengths(i);if(this.pathLength=this._length>0?new xe.a(r.normalizeDistance(f),"meters"):null,l){var b=this._updateGeodesicPathLengths(i,a);this.geodesicPathLength=this._length>0?new xe.a(b,"meters"):null}else this.geodesicPathLength=null;if(!i)return this.area=null,this.geodesicArea=null,this.perimeterLength=null,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.intersectingSegments.clear(),void this.geodesicIntersectingSegments.clear();this._updateArea(t,r,n,a,s),l&&this._updateGeodesicArea(t)}}_resize(e){for(e<this._length&&(this.positionsWorldCoords.length=e,this.positionsRenderCoords.length=e,this.positionsProjectedWorldCoords.length=e,this.positionsFittedRenderCoords.length=e,this.positionsGeographic.length=e,this.positionsSpherical.length=e,this.positionsStereographic.length=e,this.pathSegmentLengths.length=e,this.geodesicPathSegmentLengths.length=e,this.perimeterSegmentLengths.length=e,this._length=e);this._length<e;)this.positionsWorldCoords.push(Object(j.e)()),this.positionsRenderCoords.push(Object(j.e)()),this.positionsProjectedWorldCoords.push(Object(Xe.a)()),this.positionsFittedRenderCoords.push(Object(j.e)()),this.positionsGeographic.push(Object(j.e)()),this.positionsSpherical.push(Object(j.e)()),this.positionsStereographic.push(Object(Xe.a)()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),this.perimeterSegmentLengths.push(0),++this._length}_updatePathLengths(e){for(var t=this.positionsWorldCoords,r=this.pathSegmentLengths,i=0,n=0;n<this._length;++n){var a=r[n]=Object(_.n)(t[n],t[(n+1)%this._length]);(n<this._length-1||e)&&(i+=a)}return i}_updateGeodesicPathLengths(e,t){for(var r=this.positionsGeographic,i=this.geodesicPathSegmentLengths,n=0,a=0;a<this._length;++a){var s=i[a]=Je.segmentLengthGeodesicVector(r[a],r[(a+1)%this._length],t);(a<this._length-1||e)&&(n+=s)}return n}_updateArea(e,t,r,i,n){var a=e.renderCoordsHelper,s=this.positionsWorldCoords,o=this.positionsRenderCoords,c=this.positionsProjectedWorldCoords,l=this.positionsFittedRenderCoords,u=this._planeWorldCoords,d=this._centroidRenderCoords;Object(A.b)(o,d),a.worldUpAtPosition(d,this._worldUp),a.worldBasisAtPosition(d,0,this._worldTangent),Object(we.l)(d,this._worldUp,r,this._worldUp,i),Object(we.l)(d,this._worldTangent,r,this._worldTangent,i),s.length>2&&Je.bestFitPlane(s,u),this.fittingMode=this._selectFittingMode(u,s,this._worldUp,n);var h=0;if("horizontal"===this.fittingMode){var p=-1/0;o.forEach(((e,t)=>{var r=a.getAltitude(o[t]);r>p&&(p=r,h=t)}))}var f=s[h],b=u,m=this._worldTangent;"horizontal"===this.fittingMode?b=this._worldUp:"vertical"===this.fittingMode&&(b=this._tempVec3,m=this._worldUp,Object(Ve.e)(u,this._worldUp,b)),Object(_.j)(this._frame[2],b),Object(Ve.e)(m,b,this._frame[0]),Object(_.f)(this._frame[1],this._frame[0],this._frame[2]),Object(_.s)(this._frame[1],this._frame[1]);for(var v=this._tempVec3,g=this._tempU,y=this._tempV,O=0;O<this._length;++O){var j=c[O],w=l[O];Object(_.i)(v,s[O],f),Object(Ke.r)(j,Object(_.g)(this._frame[0],v),Object(_.g)(this._frame[1],v)),Object(_.d)(g,this._frame[0],j[0]),Object(_.d)(y,this._frame[1],j[1]),Object(_.e)(v,g,y),Object(_.e)(v,v,f),Object(we.r)(v,i,w,r)}this.perimeterLength=this._length>0?new xe.a(t.normalizeDistance(this._updatePerimeterLengths()),"meters"):null,Object(A.b)(l,this.areaCentroidRenderCoords),Object(we.r)(this.areaCentroidRenderCoords,r,this.areaCentroidWorldCoords,i),this._updateIntersectingSegments(),this.area=0===this.intersectingSegments.size?new xe.a(t.normalizeArea(this._computeArea()),"square-meters"):null}_updateGeodesicArea(e){var t=e.renderCoordsHelper,r=this.positionsSpherical,i=this.positionsStereographic,n=this._tempVec3,a=Je.fitHemisphere(r,n);if(a){var s=this._tempU,o=this._tempV;Object(Ve.j)(n,s,o);for(var c=0;c<this._length;++c){var l=Object(_.g)(r[c],s),u=Object(_.g)(r[c],o),d=Object(_.g)(r[c],n);Object(Ke.r)(i[c],l/d,u/d)}Object(_.d)(n,n,Object(_e.e)(e.spatialReference).radius),t.toRenderCoords(n,Object(_e.g)(e.spatialReference),this.geodesicAreaCentroidRenderCoords),this._updateGeodesicIntersectingSegments(),this.geodesicArea=a&&0===this.geodesicIntersectingSegments.size?new xe.a(this._computeGeodesicArea(),"square-meters"):null}else this.geodesicArea=null}_updatePerimeterLengths(){for(var e=this.positionsProjectedWorldCoords,t=this.perimeterSegmentLengths,r=0,i=0;i<this._length;++i)r+=t[i]=Object(Ke.i)(e[i],e[(i+1)%this._length]);return r}_updateIntersectingSegments(){var e=this.positionsProjectedWorldCoords,t=this.intersectingSegments;t.clear();for(var r=0;r<this._length;++r)for(var i=r+2;i<this._length;++i)if((i+1)%this._length!==r){var n=e[r],a=e[(r+1)%this._length],s=e[i],o=e[(i+1)%this._length];Object(Ze.d)(n,a,s,o)&&(t.add(r),t.add(i))}}_computeArea(){for(var e=this.positionsProjectedWorldCoords,t=$e(e,2),r=this.triangleIndices=new Uint32Array(Object(Qe.b)(t,[],2)),i=0,n=0;n<r.length;n+=3)i+=Je.triangleAreaEuclidean(e[r[n]],e[r[n+1]],e[r[n+2]]);return i}_updateGeodesicIntersectingSegments(){var e=this.positionsStereographic,t=this.geodesicIntersectingSegments;t.clear();for(var r=0;r<this._length;++r)for(var i=r+2;i<this._length;++i)if((i+1)%this._length!==r){var n=e[r],a=e[(r+1)%this._length],s=e[i],o=e[(i+1)%this._length];Object(Ze.d)(n,a,s,o)&&(t.add(r),t.add(i))}}_computeGeodesicArea(){for(var e=this.positionsGeographic,t=$e(this.positionsStereographic,2),r=this.geodesicTriangleIndices=new Uint32Array(Object(Qe.b)(t,[],2)),i=0,n=0;n<r.length;n+=3)i+=Je.triangleAreaGeodesic(e[r[n]],e[r[n+1]],e[r[n+2]],ke.a.WGS84);return i}_selectFittingMode(e,t,r,i){var n=t.map((t=>Math.abs(Je.planePointDistance(e,t)))).reduce(((e,t)=>Math.max(e,t)),0);Je.boundingSphere(t,this._tempSphere);var a=n/(2*this._tempSphere.radius),s=a<i.maxRelativeErrorCoplanar,o=a<i.maxRelativeErrorAlmostCoplanar,c="horizontal";return s?c="oblique":o&&(c=Math.abs(Object(_.g)(r,e))>Math.cos(Object(Oe.f)(i.verticalAngleThreshold))?"horizontal":"vertical"),c}},tt=r(980),rt=class extends ge.a{constructor(){super(...arguments),this._unitNormalizer=new tt.a,this._measurementData=new et,this._handles=new f.a,this.dataObject=new Me,this.path=new Re,this.cursorPoint=null,this.state="initial",this.lastDraggedVertex=null,this.mode="auto",this.unit="metric",this.active=!1,this.fittingSettings={maxRelativeErrorCoplanar:.005,maxRelativeErrorAlmostCoplanar:.01,verticalAngleThreshold:80},this.geodesicMeasurementDistanceThreshold=1e5}initialize(){var e=this;this.path.model=this.dataObject,Object(je.a)("esri/core/t9n/Units").then((e=>{this.messages=e})),this._handles.add(Object(ye.c)(Object(ve.a)((function*(){e.messages=yield Object(je.a)("esri/core/t9n/Units")})))),this._handles.add(Object(b.k)(this.sceneView,"ready",(()=>{var{spatialReference:e}=this.sceneView,t=Object(_e.g)(e),r=t===_e.a?_e.d:t,i=!e||Object(we.b)(e,r)?r:e;this._worldSpatialReference=i,this._unitNormalizer.spatialReference=i,this.path.view=this.sceneView})),"scene-view"),this.reset(),this._handles.add(this.path.on("clear",(()=>{this.notifyChange("numVertices"),this._updateMeasurementData()}))),this._handles.add(this.path.on("vertex-update",(()=>{this.notifyChange("numVertices"),this._updateMeasurementData()}))),this._handles.add(this.watch("state",(()=>this._updateMeasurementData()),!0)),this._handles.add(this.watch("fittingSettings",(()=>this._updateMeasurementData())))}destroy(){this._handles.destroy(),this._handles=null}get validMeasurement(){return this.numVertices>=3&&"measured"===this.state||"editing"===this.state}get numVertices(){return this.path.numVertices}get measurementData(){return this._measurementData}_updateMeasurementData(){var e=this._measurementData;e.update(this.path,this.sceneView,this._unitNormalizer,this.validMeasurement,this.sceneView.renderSpatialReference,this._worldSpatialReference,this.fittingSettings),this.dataObject.result={area:e.area,geodesicArea:e.geodesicArea,pathLength:e.pathLength,geodesicPathLength:e.geodesicPathLength,perimeterLength:e.perimeterLength},this.notifyChange("measurementData")}get area(){return this.measurementData.area}get geodesicArea(){return this.measurementData.geodesicArea}get areaLabel(){return this._formatAreaLabel(this.messages,"geodesic"===this.measurementMode?this.measurementData.geodesicArea:this.measurementData.area,this.unit)}get pathLength(){return this.measurementData.pathLength}get geodesicPathLength(){return this.measurementData.geodesicPathLength}get pathLengthLabel(){return this._formatLengthLabel(this.messages,"geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.pathLength,this.unit)}get perimeterLength(){return this.measurementData.perimeterLength}get geodesicPerimeterLength(){return this.measurementData.geodesicPathLength}get perimeterLengthLabel(){return this.measurementData.perimeterLength&&this._formatLengthLabel(this.messages,"geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.perimeterLength,this.unit)}get cursorSegmentLength(){var e=this.path.lastPoint;return Object(y.k)(e)&&Object(y.k)(this.cursorPoint)?new xe.a(this._unitNormalizer.normalizeDistance(Je.segmentLengthEuclidean(e,this.cursorPoint,this._worldSpatialReference)),"meters"):null}get geodesicCursorSegmentLength(){var e=this.path.lastPoint;return Object(y.k)(e)&&Object(y.k)(this.cursorPoint)?new xe.a(Je.segmentLengthGeodesic(e,this.cursorPoint),"meters"):null}get cursorSegmentLengthLabel(){return this._formatLengthLabel(this.messages,"geodesic"===this.measurementMode?this.geodesicCursorSegmentLength:this.cursorSegmentLength,this.unit)}get viewData(){var e=this.measurementData,t="geodesic"===this.measurementMode,r=t?this.geodesicArea:this.area,i=1;if(r){var n=this._toPreferredAreaUnit(r,this.unit);i=Object(Oe.n)(Math.sqrt(n.value)/Math.sqrt(300)),i*=Math.sqrt(Object(l.c)(1,n.unit,"square-meters")),i/=this._unitNormalizer.normalizeDistance(1)}return{validMeasurement:this.validMeasurement,path:this.path,positionsGeographic:e.positionsGeographic,positionsRenderCoords:e.positionsRenderCoords,positionsProjected:e.positionsProjectedWorldCoords,positionsFittedRenderCoords:e.positionsFittedRenderCoords,intersectingSegments:t?e.geodesicIntersectingSegments:e.intersectingSegments,triangleIndices:t?e.geodesicTriangleIndices:e.triangleIndices,fittingMode:e.fittingMode,areaCentroid:t?e.geodesicAreaCentroidRenderCoords:e.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:this.validMeasurement?0:this.path.numVertices-2,perimeterLengthLabelSegmentIndex:0,checkerSize:i}}get measurementMode(){var e=this.mode;return"auto"===e&&(e="euclidean",(this.geodesicPathLength?this.geodesicPathLength.value:0)+(!this.validMeasurement&&this.geodesicCursorSegmentLength?this.geodesicCursorSegmentLength.value:0)>this.geodesicMeasurementDistanceThreshold&&(e="geodesic")),null==this.geodesicPathLength&&(e="euclidean"),e}reset(){this.clearMeasurement(),this._updateMeasurementData()}clearMeasurement(){this.path.clear(),this.state="initial",this.cursorPoint=null}finishMeasurement(){this.path.numVertices<3?this.clearMeasurement():this.state="measured"}_preferredAreaUnit(e,t){switch(t){case"metric":return Object(l.u)(e.value,e.unit);case"imperial":return Object(l.r)(e.value,e.unit);default:return t}}_preferredLengthUnit(e,t){var r=this._deriveLengthUnitFromAreaUnit(t);switch(r){case"metric":return Object(l.v)(e.value,e.unit);case"imperial":return Object(l.s)(e.value,e.unit);default:return r}}_toPreferredAreaUnit(e,t){return e.toUnit(this._preferredAreaUnit(e,t))}_toPreferredLengthUnit(e,t){return e.toUnit(this._preferredLengthUnit(e,t))}_formatAreaLabel(e,t,r){return e&&t&&Object(Se.b)(e,t,this._preferredAreaUnit(t,r))}_formatLengthLabel(e,t,r){return e&&t&&Object(Se.b)(e,t,this._preferredLengthUnit(t,r))}_deriveLengthUnitFromAreaUnit(e){switch(e){case"metric":return"metric";case"imperial":return"imperial";case"square-inches":return"inches";case"square-feet":return"feet";case"square-yards":return"yards";case"square-miles":return"miles";case"square-us-feet":return"us-feet";case"square-millimeters":return"millimeters";case"square-centimeters":return"centimeters";case"square-decimeters":return"decimeters";case"square-meters":return"meters";case"square-kilometers":return"kilometers";case"acres":return"imperial";case"ares":case"hectares":return"metric"}throw new Error("unhandled area unit")}};Object(i.a)([Object(a.b)()],rt.prototype,"messages",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"dataObject",void 0),Object(i.a)([Object(a.b)({constructOnly:!0})],rt.prototype,"sceneView",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"path",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"cursorPoint",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"state",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"lastDraggedVertex",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"mode",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"unit",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"active",void 0),Object(i.a)([Object(a.b)()],rt.prototype,"fittingSettings",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"validMeasurement",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"numVertices",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"measurementData",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"area",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"geodesicArea",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"areaLabel",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"pathLength",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"geodesicPathLength",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"pathLengthLabel",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"perimeterLength",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"geodesicPerimeterLength",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"perimeterLengthLabel",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"cursorSegmentLength",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"geodesicCursorSegmentLength",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"cursorSegmentLengthLabel",null),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"viewData",null),Object(i.a)([Object(a.b)()],rt.prototype,"geodesicMeasurementDistanceThreshold",void 0),Object(i.a)([Object(a.b)({readOnly:!0})],rt.prototype,"measurementMode",null);var it=rt=Object(i.a)([Object(o.a)("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DModel")],rt),nt=class extends g.a{constructor(e){super(e),this._handles=new f.a,this.deferCreation=!0,this.model=new it({sceneView:e.view})}initialize(){this._view=new de(this.model,this.manipulators),this._controller=new me(this.model,this._view,this.manipulators),this._handles.add(Object(b.a)(this,"state",(e=>{switch(e){case"measured":return this.complete();case"ready":break;default:return this.create()}}),!0))}destroy(){this.detach(),this._view.destroy(),this._view=null,this._controller.destroy(),this._controller=null,this._handles.destroy(),this._handles=null}get state(){switch(this.model.state){case"initial":return this.model.numVertices>=1?"measuring":"ready";case"drawing":case"editing":return"measuring";case"measured":return"measured"}}get isSupported(){return"3d"===this.get("view.type")}get cursor(){return!this.model.active||"initial"!==this.model.state&&"drawing"!==this.model.state?null:"crosshair"}activate(){this.model.active=!0}deactivate(){this.model.active=!1}onShow(){this._view.show()}onHide(){this._view.hide()}onDetach(){this.model.reset()}onInputEvent(e){this._controller.handleInputEvent(e)}};Object(i.a)([Object(a.b)({readOnly:!0})],nt.prototype,"state",null),Object(i.a)([Object(a.b)({readOnly:!0})],nt.prototype,"isSupported",null),Object(i.a)([Object(a.b)({readOnly:!0})],nt.prototype,"cursor",null),Object(i.a)([Object(a.b)({constructOnly:!0})],nt.prototype,"model",void 0),Object(i.a)([Object(s.a)("model.mode")],nt.prototype,"mode",void 0),Object(i.a)([Object(s.a)("model.unit")],nt.prototype,"unit",void 0),Object(i.a)([Object(s.a)("model.areaLabel")],nt.prototype,"areaLabel",void 0),Object(i.a)([Object(s.a)("model.area")],nt.prototype,"area",void 0),Object(i.a)([Object(s.a)("model.geodesicArea")],nt.prototype,"geodesicArea",void 0),Object(i.a)([Object(s.a)("model.pathLengthLabel")],nt.prototype,"pathLengthLabel",void 0),Object(i.a)([Object(s.a)("model.pathLength")],nt.prototype,"pathLength",void 0),Object(i.a)([Object(s.a)("model.geodesicPathLength")],nt.prototype,"geodesicPathLength",void 0),Object(i.a)([Object(s.a)("model.perimeterLengthLabel")],nt.prototype,"perimeterLengthLabel",void 0),Object(i.a)([Object(s.a)("model.perimeterLength")],nt.prototype,"perimeterLength",void 0),Object(i.a)([Object(s.a)("model.geodesicPerimeterLength")],nt.prototype,"geodesicPerimeterLength",void 0),Object(i.a)([Object(s.a)("model.validMeasurement")],nt.prototype,"validMeasurement",void 0),Object(i.a)([Object(s.a)("model.viewData")],nt.prototype,"viewData",void 0);var at=nt=Object(i.a)([Object(o.a)("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],nt),st=n.a.getLogger("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel"),ot=class extends v.a{constructor(e){super(e),this.supportedViewType="3d",this._handles=new f.a,this._userUnitOptions=null,this._userUnit=null,this.tool=null}initialize(){this._handles.add([Object(b.a)(this,"unit",(e=>{this.tool&&(this.tool.model.unit=e)}))])}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}get state(){return this.isDisabled?"disabled":this.tool?this.tool.state:"ready"}get measurement(){if(!this.tool||this.isDisabled)return null;var e=this.tool.model,t=e.measurementMode,r=e.measurementData,i=e.validMeasurement,n=0===("euclidean"===t?r.intersectingSegments:r.geodesicIntersectingSegments).size,a=n?i?"available":"unavailable":"invalid";return{mode:t,area:{text:n&&i?e.areaLabel:null,state:a},perimeterLength:{text:n&&i?e.perimeterLengthLabel:null,state:a}}}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}start(){return this.createTool()}clear(){this.removeTool()}createToolParams(){return{toolConstructor:at,constructorArguments:()=>({unit:this.unit})}}logUnsupportedError(){st.error("AreaMeasurement3D widget is not implemented for MapView")}logError(...e){st.error(...e)}_findSelectableUnit(e,t){var r=this.unitOptions;return-1!==r.indexOf(e)?e:t?this._findSelectableUnit(t):r[0]}_filteredOrAllUnits(e){if(!e)return l.p.slice();var t=e.filter((e=>-1!==l.p.indexOf(e)));return 0===t.length?l.p.slice():t}};Object(i.a)([Object(a.b)({readOnly:!0})],ot.prototype,"state",null),Object(i.a)([Object(a.b)({readOnly:!0})],ot.prototype,"measurement",null),Object(i.a)([Object(a.b)({constructOnly:!0})],ot.prototype,"tool",void 0),Object(i.a)([Object(a.b)(m.a)],ot.prototype,"defaultUnit",void 0),Object(i.a)([Object(a.b)()],ot.prototype,"unitOptions",null),Object(i.a)([Object(a.b)()],ot.prototype,"unit",null);var ct=ot=Object(i.a)([Object(o.a)("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],ot),lt="esri-area-measurement-3d",ut={buttonDisabled:"esri-button--disabled",base:"".concat(lt," esri-widget esri-widget--panel"),container:"".concat(lt,"__container"),hint:"".concat(lt,"__hint"),hintText:"".concat(lt,"__hint-text"),panelError:"".concat(lt,"__panel--error"),measurement:"".concat(lt,"__measurement"),measurementItem:"".concat(lt,"__measurement-item"),measurementItemDisabled:"".concat(lt,"__measurement-item--disabled"),measurementItemTitle:"".concat(lt,"__measurement-item-title"),measurementItemValue:"".concat(lt,"__measurement-item-value"),settings:"".concat(lt,"__settings"),units:"".concat(lt,"__units"),unitsLabel:"".concat(lt,"__units-label"),unitsSelect:"".concat(lt,"__units-select esri-select"),unitsSelectWrapper:"".concat(lt,"__units-select-wrapper"),actionSection:"".concat(lt,"__actions"),newMeasurementButton:"".concat(lt,"__clear-button esri-button esri-button--primary"),widgetIcon:"esri-icon-measure-area"},dt=class extends p.a{constructor(e,t){super(e,t),this.view=null,this.visible=null,this.iconClass=ut.widgetIcon,this.label=void 0,this.messages=null,this.messagesUnits=null,this.viewModel=new ct,this.unitOptions=null,this.unit=null}render(){var{isSupported:e,active:t,measurement:r,state:i,unit:n}=this.viewModel,a="disabled"===i,s="ready"===i,o="measuring"===i||"measured"===i,{messages:c,messagesUnits:u}=this,d=t&&s?Object(h.a)("section",{key:"esri-area-measurement-3d__hint",class:ut.hint},Object(h.a)("p",{class:ut.hintText},c.hint)):null,p=e?null:Object(h.a)("section",{key:"esri-area-measurement-3d__unsupported",class:ut.panelError},Object(h.a)("p",null,c.unsupported)),f=(e,t,r)=>{switch(t.state){case"available":return Object(h.a)("div",{key:"".concat(r,"-enabled"),class:ut.measurementItem},Object(h.a)("span",{class:ut.measurementItemTitle},e),Object(h.a)("span",{class:ut.measurementItemValue},t.text));case"unavailable":return Object(h.a)("div",{key:"".concat(r,"-disabled"),class:this.classes(ut.measurementItem,ut.measurementItemDisabled)},Object(h.a)("span",{class:ut.measurementItemTitle},e));case"invalid":return Object(h.a)("div",{key:"".concat(r,"-enabled"),class:ut.measurementItem},Object(h.a)("span",{class:ut.measurementItemTitle},e),Object(h.a)("span",{class:ut.measurementItemValue},c.notApplicable))}},b=o?Object(h.a)("section",{key:"esri-area-measurement-3d__measurement",class:ut.measurement},f(c.area,r.area,"area"),f(c.perimeterLength,r.perimeterLength,"perimeter-length")):null,m="".concat(this.id,"__units"),v=Object(h.a)("label",{class:ut.unitsLabel,for:m},c.unit),g=Object(h.a)("div",{class:ut.unitsSelectWrapper},Object(h.a)("select",{class:ut.unitsSelect,id:m,onchange:this._changeUnit,bind:this,value:n},this.viewModel.unitOptions.map((e=>{var t;return Object(h.a)("option",{key:e,value:e},Object(l.l)(e)?u.systems[e]:null==(t=u.units[e])?void 0:t.pluralCapitalized)})))),y=o?Object(h.a)("section",{key:"esri-area-measurement-3d__units",class:ut.units},v,g):null,O=o?Object(h.a)("div",{key:"settings",class:ut.settings},y):null,j=!e||t&&!o?null:Object(h.a)("div",{class:ut.actionSection},Object(h.a)("button",{disabled:a,class:this.classes(ut.newMeasurementButton,a&&ut.buttonDisabled),bind:this,onclick:this._newMeasurement,type:"button"},c.newMeasurement)),_=this.visible?Object(h.a)("div",{class:ut.container},p,d,O,b,j):null;return Object(h.a)("div",{key:this,class:ut.base,role:"presentation"},_)}_newMeasurement(){Object(c.l)(this.viewModel.start())}_changeUnit(e){var t=e.target,r=t.options[t.selectedIndex];r&&(this.unit=r.value)}};Object(i.a)([Object(s.a)("viewModel.view")],dt.prototype,"view",void 0),Object(i.a)([Object(s.a)("viewModel.visible")],dt.prototype,"visible",void 0),Object(i.a)([Object(s.a)("viewModel.active")],dt.prototype,"active",void 0),Object(i.a)([Object(a.b)()],dt.prototype,"iconClass",void 0),Object(i.a)([Object(a.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],dt.prototype,"label",void 0),Object(i.a)([Object(a.b)(),Object(d.a)("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],dt.prototype,"messages",void 0),Object(i.a)([Object(a.b)(),Object(d.a)("esri/core/t9n/Units")],dt.prototype,"messagesUnits",void 0),Object(i.a)([Object(a.b)({type:ct})],dt.prototype,"viewModel",void 0),Object(i.a)([Object(s.a)("viewModel.unitOptions")],dt.prototype,"unitOptions",void 0),Object(i.a)([Object(s.a)("viewModel.unit")],dt.prototype,"unit",void 0),Object(i.a)([Object(u.a)()],dt.prototype,"_newMeasurement",null),Object(i.a)([Object(u.a)()],dt.prototype,"_changeUnit",null);var ht=dt=Object(i.a)([Object(o.a)("esri.widgets.AreaMeasurement3D")],dt);t.default=ht}])]);
//# sourceMappingURL=61.5801a031.chunk.js.map