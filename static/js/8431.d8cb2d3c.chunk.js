"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[8431],{79347:(t,e,n)=>{n.d(e,{e:()=>a});var i,r,s,o={exports:{}};i=o,r=function(){function t(t,n,r){r=r||2;var s,o,a,c,u,h,p,d=n&&n.length,_=d?n[0]*r:t.length,g=e(t,0,_,r,!0),v=[];if(!g||g.next===g.prev)return v;if(d&&(g=l(t,n,g,r)),t.length>80*r){s=a=t[0],o=c=t[1];for(var f=r;f<_;f+=r)(u=t[f])<s&&(s=u),(h=t[f+1])<o&&(o=h),u>a&&(a=u),h>c&&(c=h);p=0!==(p=Math.max(a-s,c-o))?1/p:0}return i(g,v,r,s,o,p),v}function e(t,e,n,i,r){var s,o;if(r===R(t,e,n,i)>0)for(s=e;s<n;s+=i)o=w(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=w(s,t[s],t[s+1],o);if(o&&y(o,o.next)){var a=o.next;S(o),o=a}return o}function n(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{var r=i.prev;if(S(i),(i=e=r)===i.next)break;n=!0}}while(n||i!==e);return e}function i(t,e,l,c,u,h,p){if(t){!p&&h&&d(t,c,u,h);for(var _,g,v=t;t.prev!==t.next;)if(_=t.prev,g=t.next,h?s(t,c,u,h):r(t))e.push(_.i/l),e.push(t.i/l),e.push(g.i/l),S(t),t=g.next,v=g.next;else if((t=g)===v){p?1===p?i(t=o(n(t),e,l),e,l,c,u,h,2):2===p&&a(t,e,l,c,u,h):i(n(t),e,l,c,u,h,1);break}}}function r(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(v(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&m(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function s(t,e,n,i){var r=t.prev,s=t,o=t.next;if(m(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=_(a,l,e,n,i),p=_(c,u,e,n,i),d=t.prevZ,g=t.nextZ;d&&d.z>=h&&g&&g.z<=p;){if(d!==t.prev&&d!==t.next&&v(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,g!==t.prev&&g!==t.next&&v(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&v(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;g&&g.z<=p;){if(g!==t.prev&&g!==t.next&&v(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function o(t,e,i){var r=t;do{var s=r.prev,o=r.next.next;!y(s,o)&&x(s,r,r.next,o)&&C(s,o)&&C(o,s)&&(e.push(s.i/i),e.push(r.i/i),e.push(o.i/i),S(r),S(r.next),r=t=o),r=r.next}while(r!==t);return n(r)}function a(t,e,r,s,o,a){var l=t;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&f(l,c)){var u=E(l,c);return l=n(l,l.next),u=n(u,u.next),i(l,e,r,s,o,a),void i(u,e,r,s,o,a)}c=c.next}l=l.next}while(l!==t)}function l(t,i,r,s){var o,a,l,u=[];for(o=0,a=i.length;o<a;o++)(l=e(t,i[o]*s,o<a-1?i[o+1]*s:t.length,s,!1))===l.next&&(l.steiner=!0),u.push(g(l));for(u.sort(c),o=0;o<u.length;o++)r=n(r=h(u[o],r),r.next);return r}function c(t,e){return t.x-e.x}function u(t){if(t.next.prev===t)return t;let e=t;for(;;){const n=e.next;if(n.prev===e||n===e||n===t)break;e=n}return e}function h(t,e){var i=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var l,c=n,u=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&v(s<h?r:o,s,u,h,s<h?o:r,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(r-i.x),C(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&p(n,i)))&&(n=i,d=l)),i=i.next}while(i!==c);return n}(t,e);if(!i)return e;var r=E(i,t),s=n(i,i.next);let o=u(r);return n(o,o.next),s=u(s),u(e===i?s:e)}function p(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,n,i){var r=t;do{null===r.z&&(r.z=_(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}function _(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function f(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&x(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(C(t,e)&&C(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,n,i){var r=b(m(t,e,n)),s=b(m(t,e,i)),o=b(m(n,i,t)),a=b(m(n,i,e));return r!==s&&o!==a||!(0!==r||!T(t,n,e))||!(0!==s||!T(t,i,e))||!(0!==o||!T(n,t,i))||!(0!==a||!T(n,e,i))}function T(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function C(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function E(t,e){var n=new I(t.i,t.x,t.y),i=new I(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function w(t,e,n,i){var r=new I(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}return t.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(R(t,0,s,n));if(r)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(R(t,c,u,n))}var h=0;for(a=0;a<i.length;a+=3){var p=i[a]*n,d=i[a+1]*n,_=i[a+2]*n;h+=Math.abs((t[p]-t[_])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[_+1]-t[p+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},t.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},t},void 0!==(s=r())&&(i.exports=s);const a=o.exports},89494:(t,e,n)=>{function i(){return[1,0,0,1,0,0]}function r(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}n.d(e,{a:()=>r,c:()=>i});Object.freeze(Object.defineProperty({__proto__:null,create:i,clone:r,fromValues:function(t,e,n,i,r,s){return[t,e,n,i,r,s]},createView:function(t,e){return new Float64Array(t,e,6)}},Symbol.toStringTag,{value:"Module"}))},58935:(t,e,n)=>{n.d(e,{N9:()=>x,Pr:()=>C,SP:()=>y,Se:()=>E,cy:()=>m,i_:()=>T,ym:()=>b});var i=n(92026),r=n(47898),s=n(5163);function o(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return(0,s.VG)(t,(0,r.nn)(e,n).value,n,i,o)}function a(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return(0,s.LO)(t,(0,r.nn)(e,n).value,n,i,o)}function l(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.Rd)(t,e.value,e.unit,n,i)}function c(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.mg)(t,e.value,e.unit,n,i)}function u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.Wv)(t,e.value,e.unit,n,i)}function h(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.h9)(t,e.value,e.unit,n,i)}function p(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.ld)(t,e.value,e.unit,n,i)}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.Ud)(t,e.value,e.unit,n,i)}function _(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.q6)(t,e.value,e.unit,n,i)}function g(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.Zv)(t,e.value,e.unit,n,i)}function v(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.aC)(t,e.value,e.unit,n,i)}function f(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";return(0,s.yc)(t,e.value,e.unit,n,i)}function m(t,e,n){return(0,s.L4)(t.value,t.unit,t.rotationType,e,n)}function y(t,e,n){return(0,s._o)(t.value,t.unit,t.rotationType,e,n)}function x(t,e,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(r=(0,i.Pt)(r,2),n){case"imperial":return d(t,e,r,s);case"metric":return l(t,e,r,s);default:return o(t,e,n,r,s)}}function T(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return _(t,e,i,r);case"metric":return c(t,e,i,r);default:return a(t,e,n,i,r)}}function b(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return g(t,e,i,r);case"metric":return u(t,e,i,r);default:return o(t,e,n,i,r)}}function C(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return v(t,e,i,r);case"metric":return h(t,e,i,r);default:return a(t,e,n,i,r)}}function E(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";switch(n){case"imperial":return f(t,e,i,r);case"metric":return p(t,e,i,r);default:return o(t,e,n,i,r)}}},47898:(t,e,n)=>{n.d(e,{Fp:()=>c,GJ:()=>a,ne:()=>o,nn:()=>l,yG:()=>s,yP:()=>u});var i=n(92026),r=n(68860);function s(t,e){return{type:(0,r.UF)(e),value:t,unit:e}}function o(t,e){return{type:(0,r.UF)(e),value:t,unit:e}}function a(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arithmetic";return{type:(0,r.UF)(e),value:t,unit:e,rotationType:n}}function l(t,e){return function(t,e){return{type:(0,r.UF)(e),value:t,unit:e}}((0,r.En)(t.value,t.unit,e),e)}function c(t,e){return(0,i.Wi)(t)?e:(0,i.Wi)(e)||t.value>(0,r.En)(e.value,e.unit,t.unit)?t:e}const u=s(0,"meters")},69674:(t,e,n)=>{n.d(e,{w:()=>W});var i=n(27366),r=n(91505),s=n(41691),o=n(84652),a=n(92026),l=n(66978),c=n(47898),u=n(94172),h=n(17842),p=n(68860),d=n(49861),_=(n(25243),n(69912)),g=n(70178),v=n(74509),f=n(50951),m=n(78005);class y{constructor(t){let{grabbableForEvent:e}=t;this.events=new r.Z,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=e}intersectionDistance(t,e){return 0}attach(){}detach(){}}var x=n(14813),T=n(74229),b=n(84954),C=n(87268),E=n(52349),w=n(61920),S=n(34019),I=n(80151),R=n(71040),k=n(4943);let O=class extends k.h{constructor(t){super(t),this.type="draw-point"}};(0,i._)([(0,d.Cb)()],O.prototype,"type",void 0),(0,i._)([(0,d.Cb)()],O.prototype,"elevation",void 0),O=(0,i._)([(0,_.j)("esri.views.interactive.tooltip.DrawPointTooltipInfo")],O);let P=class extends k.h{constructor(t){super(t),this.type="draw-polyline"}};(0,i._)([(0,d.Cb)()],P.prototype,"type",void 0),(0,i._)([(0,d.Cb)()],P.prototype,"elevation",void 0),(0,i._)([(0,d.Cb)()],P.prototype,"totalLength",void 0),P=(0,i._)([(0,_.j)("esri.views.interactive.tooltip.DrawPolylineTooltipInfo")],P);let L=class extends k.h{constructor(t){super(t),this.type="draw-polygon"}};(0,i._)([(0,d.Cb)()],L.prototype,"type",void 0),(0,i._)([(0,d.Cb)()],L.prototype,"elevation",void 0),(0,i._)([(0,d.Cb)()],L.prototype,"area",void 0),L=(0,i._)([(0,_.j)("esri.views.interactive.tooltip.DrawPolygonTooltipInfo")],L);var A=n(72189),M=n(71353),D=n(21971),U=n(59418),F=n(12611);function V(t,e){const n=(t=>(0,U.Ul)(t,e))(t),i=t.paths[0]?.[t.paths[0]?.length-1]??null,{hasZ:r,spatialReference:s}=t,o=i?(0,M.f)(i[0],i[1],r?i[2]:0):null;return t=>{if((0,a.Wi)(t)||(0,a.Wi)(n)||(0,a.Wi)(o))return n;G[0]=t.x,G[1]=t.y,G[2]=r?t.z:0;const i=((t,n,i)=>(0,U.MU)(t,n,i,e))(o,G,s);return(0,a.Wi)(i)?n:(0,c.yG)(n.value+i.value,n.unit)}}const G=(0,M.c)();let W=class extends(r.Z.EventedMixin(s.r)){constructor(t){super(t),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingPipeline=new I.n,this._tooltip=null,this._tooltipContext={calculateElevation:null,calculateTotalLength:null,calculateArea:null},this.isDraped=!0,this.labelOptions=new E.Z,this.tooltipOptions=new w.Z,this.snapToSceneEnabled=null,(0,a.Wi)(t.elevationInfo)&&(this.elevationInfo={mode:t.hasZ?"absolute-height":"on-the-ground",offset:0})}initialize(){const{geometryType:t,view:e}=this,{spatialReference:n}=e,i="viewingMode"in e.state?e.state.viewingMode:f.JY.Local,r="segment"===t||"multipoint"===t?"polyline":t;this.coordinateHelper=(0,x.Y6)(this.hasZ,this.hasM,n),this._editGeometryOperations=new C.c(new b.XE(r,this.coordinateHelper)),this._snappingOperation=new R.y({view:e}),this.handles.add((0,u.YP)((()=>this.stagedVertex),((t,e)=>{(0,a.pC)(this._tooltip)&&((0,a.pC)(e)!==(0,a.pC)(t)?this._tooltip.info=this._getTooltipInfo():this._updateTooltipInfo()),(0,a.Wi)(t)||this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(t)}],operation:"apply",type:"vertex-update"})}),{sync:!0,equals:(t,e)=>(0,a._W)(t,e,g.k)})),this._activeComponent=new b.wA(n,i),this._editGeometryOperations.data.components.push(this._activeComponent);const s=this.segmentLabels;(0,a.pC)(s)&&(s.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.handles.add([(0,u.YP)((()=>this.labelOptions.enabled),(t=>{s.visible=t}),u.tX),this.on("cursor-update",(()=>{const t=this.stagedVertex;s.stagedVertex=(0,a.pC)(t)?this.coordinateHelper.pointToVector(t):null}))])),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(t=>{const e=t.vertices.map((t=>({componentIndex:0,vertexIndex:t.index,coordinates:this.coordinateHelper.vectorToArray(t.pos)}))),n=e.map((t=>t.coordinates));switch(t.type){case"vertex-add":this.emit(t.type,{...t,added:n,vertices:e});break;case"vertex-update":this.emit(t.type,{...t,updated:n,vertices:e});break;case"vertex-remove":this.emit(t.type,{...t,removed:n,vertices:e})}}))),this._manipulator=new y({grabbableForEvent:t=>"click"!==this.drawingMode||"touch"===t.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==t,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(t=>this._onImmediateClick(t))),this._manipulator.events.on("immediate-double-click",(t=>this._onImmediateDoubleClick(t))),(0,u.YP)((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new A.u({view:e,info:this._getTooltipInfo()}):(0,a.SC)(this._tooltip)}),u.nn),this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(()=>(0,a.yw)(this._tooltip,(t=>{t.info=this._getTooltipInfo()}))))])}destroy(){(0,a.SC)(this.segmentLabels),(0,a.SC)(this._snappingOperation),this._tooltip=(0,a.SC)(this._tooltip),this._editGeometryOperations=(0,a.SC)(this._editGeometryOperations)}get _snappingEnabled(){return(0,a.pC)(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}get _defaultElevation(){return(0,c.yG)(this.defaultZ,"meters")}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((t=>this.coordinateHelper.vectorToArray(t.pos)))}set drawingMode(t){this._set("drawingMode",t??m.n)}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return(0,a.pC)(this.stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get stagedVertex(){return this._snappingOperation.stagedPoint}set stagedVertex(t){this._snappingOperation.stagedPoint=(0,o.d9)(t)}get updating(){return this.updatingHandles.updating}get vertices(){const t=this.committedVertices;return(0,a.pC)(this.stagedVertex)&&t.push(this.coordinateHelper.pointToArray(this.stagedVertex)),t}get stagedOrLastVertex(){if((0,a.pC)(this.stagedVertex))return this.stagedVertex;const t=this._activeComponent.getLastVertex();return(0,a.Wi)(t)?null:this._editGeometryOperations.data.coordinateHelper.vectorToDehydratedPoint(t.pos)}cancel(){this.complete({aborted:!0})}commitStagedVertex(){if(this._snappingOperation.abort(),(0,a.pC)(this.stagedVertex)){const{stagedVertex:t}=this;this.stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}}complete(t){const e=t&&t.aborted||!1;this._snappingOperation.abort(),(0,a.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.stagedVertex=null;const n="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!n,(this.isCompleted||e)&&this.emit("complete",{vertices:this.vertices.map(((t,e)=>({componentIndex:0,vertexIndex:e,coordinates:t}))),aborted:e,type:"complete"})}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){(0,a.pC)(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_closeOnClickVertexIndex(t){const e=this._activeComponent;if("polygon"===this.geometryType&&e.vertices.length>2){if(this._vertexWithinPointerDistance(e.vertices[0].pos,t))return 0;if(this._vertexWithinPointerDistance(e.vertices[e.vertices.length-1].pos,t))return e.vertices.length-1}return null}_createManipulatorDragPipeline(t){switch((0,a.Wg)(this.drawingMode)){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return(0,T.Xd)(t,((t,e,n,i)=>{const r="touch"===i&&this._snappingEnabled;!this.isCompleted&&r&&(e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this.stagedVertex=t.mapStart,("segment"===this.geometryType||r&&0===this.numVertices)&&this.commitStagedVertex()),t))).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>r,cancel:n,snappingManager:this.snappingManager,snappingContext:new S.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:i,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next((t=>(r&&(this.stagedVertex=t.mapEnd,"end"===t.action&&this.commitStagedVertex()),t))).next((t=>("end"===t.action&&("segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),t))),n.next((()=>{r&&(0,a.pC)(this.snappingManager)&&this.snappingManager.doneSnapping()})))}))}_createManipulatorDragPipelineFreehand(t){return(0,T.Xd)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&((0,a.Wi)(this.stagedVertex)&&(this.stagedVertex=t.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this.stagedVertex=t.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return t}))}))}_createManipulatorDragPipelineHybrid(t){return(0,T.Xd)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&((0,a.Wi)(this.stagedVertex)&&(this.stagedVertex=t.mapStart),this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this.stagedVertex=t.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return t}))}))}_getDrawSurface(){if((0,a.Wi)(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ)return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let t=this.defaultZ,e=!1;(0,a.pC)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(e=!0),(0,a.pC)(this.snapToSceneEnabled)&&(e=this.snapToSceneEnabled),(0,a.pC)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(e=!1);const n=this._activeComponent.vertices.length;return("segment"===this.geometryType||"polygon"===this.geometryType)&&n>0&&(t=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),e=!1),e?this.drawSurface:(this.elevationDrawSurface.defaultZ=t,this.elevationDrawSurface)}_mapToScreen(t){return this._getDrawSurface().mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===t.pointerType&&this._snappingEnabled&&(this.stagedVertex=t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if("mouse"===t.pointerType&&2===t.button||this._manipulator.dragging)return;const e=this._activeComponent,n=this._closeOnClickVertexIndex(t.screenPoint);if((0,a.pC)(n))return t.stopPropagation(),void this.complete();const i=this._screenToMap(t.screenPoint);if((0,a.pC)(i))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&((0,a.pC)(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i)),this.complete());break;case"click":case"hybrid":this._snappingOperation.abort(),(0,a.pC)(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i)),("point"===this.geometryType||"segment"===this.geometryType&&2===e.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===e.vertices.length)&&this.complete()}t.stopPropagation()}_onImmediateDoubleClick(t){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),t.stopPropagation())}_onPointerMove(t){const e=(0,h.vW)(t.x,t.y);if(this._manipulator.dragging||this._pointerDownStates.has(t.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return void this._snappingOperation.abort();t.stopPropagation();const n=this._closeOnClickVertexIndex(e);if((0,a.pC)(n))return this._closeOnVertex(n),void this._snappingOperation.abort();const i=this._screenToMap(e);if(this._manipulator.cursor=(0,a.pC)(i)?"crosshair":null,(0,a.Wi)(i))return void this._snappingOperation.abort();if((0,a.Wi)(this.snappingManager))return this.stagedVertex=i,void this._snappingOperation.abort();const r=this.snappingManager,s=new S.N({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t.pointerType,visualizer:this.snappingVisualizer});this.updatingHandles.addPromise((0,l.R8)(this._snappingOperation.snap(i,r,s)))}_closeOnVertex(t){this.stagedVertex=null;const e={componentIndex:0,vertexIndex:t,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[t].pos)};this.emit("cursor-update",{updated:null,vertices:[e],operation:"apply",type:"vertex-update"})}_screenToMap(t){return this._getDrawSurface().screenToMap(t)}_screenToMapDragEventStep(){let t=null;return e=>{if("start"===e.action&&(t=this._screenToMap(e.screenStart)),(0,a.Wi)(t))return null;const n=this._screenToMap(e.screenEnd);return(0,a.pC)(n)?{...e,mapStart:t,mapEnd:n}:null}}_vertexWithinPointerDistance(t,e){const n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return!!(0,a.pC)(n)&&function(t,e,n){const i=t.x-e.x,r=t.y-e.y;return i*i+r*r<=n}(n,e,25)}_calculateVertexTooltipElevation(t){const{tooltipOptions:e,view:n}=this;if((0,a.Wi)(t)||"2d"===n.type)return this._defaultElevation;const i=this.elevationInfo,r=e.elevation.mode,{spatialReference:s}=t,o=(0,p._R)(s),l=(0,v.vQ)(n,t,i,{mode:r,offset:0});return(0,c.yG)(l*o,"meters")}_getTooltipInfo(){const{tooltipOptions:t,stagedOrLastVertex:e}=this;if((0,a.Wi)(e))return null;this._tooltipContext.calculateElevation=t=>this._calculateVertexTooltipElevation(t);const n=this._elevationTooltipDetail(e);switch(this.geometryType){case"point":return new O({tooltipOptions:t,elevation:n});case"polyline":return this._tooltipContext.calculateTotalLength=V(this._editGeometryOperations.data.geometry,this.isDraped?"on-the-ground":"absolute-height"),new P({tooltipOptions:t,elevation:n,totalLength:this._totalLengthTooltipDetail(e)});case"polygon":return this._tooltipContext.calculateArea=function(t,e){const n=(0,F.ln)(),i=t=>(0,D.M)(t,e,n);return e=>{if((0,a.Wi)(e)||t.rings.length<1||t.rings[0].length<2)return i(t);const n=t.clone();return n.rings[0].push([e.x,e.y]),i(n)}}(this._editGeometryOperations.data.geometry,this.isDraped),new L({tooltipOptions:t,elevation:n,area:this._areaTooltipDetail(e)});default:return null}}_elevationTooltipDetail(t){return{mode:this.elevationInfo.mode,...(0,a.Wg)(this._tooltipContext.calculateElevation)(t)}}_totalLengthTooltipDetail(t){return{...(0,a.Pt)((0,a.Wg)(this._tooltipContext.calculateTotalLength)(t),(0,c.yG)(0,"meters"))}}_areaTooltipDetail(t){return{...(0,a.Pt)((0,a.Wg)(this._tooltipContext.calculateArea)(t),(0,c.ne)(0,"square-meters"))}}_updateTooltipInfo(){const t=this._tooltip;if((0,a.Wi)(t))return;const{stagedOrLastVertex:e}=this,n=this._elevationTooltipDetail(e);switch(this.geometryType){case"point":t.info.elevation=n;break;case"polyline":{const i=t.info;i.elevation=n,i.totalLength=this._totalLengthTooltipDetail(e);break}case"polygon":{const i=t.info;i.elevation=n,i.area=this._areaTooltipDetail(e);break}}}get test(){return{tooltip:this._tooltip}}};(0,i._)([(0,d.Cb)()],W.prototype,"_defaultElevation",null),(0,i._)([(0,d.Cb)()],W.prototype,"defaultZ",void 0),(0,i._)([(0,d.Cb)()],W.prototype,"isDraped",void 0),(0,i._)([(0,d.Cb)({value:m.n})],W.prototype,"drawingMode",null),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"elevationDrawSurface",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"elevationInfo",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0,type:E.Z})],W.prototype,"labelOptions",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0,type:w.Z})],W.prototype,"tooltipOptions",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"geometryType",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"hasM",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"hasZ",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"manipulators",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"drawSurface",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"segmentLabels",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"snappingManager",void 0),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"snappingVisualizer",void 0),(0,i._)([(0,d.Cb)()],W.prototype,"snapToSceneEnabled",void 0),(0,i._)([(0,d.Cb)()],W.prototype,"_snappingOperation",void 0),(0,i._)([(0,d.Cb)()],W.prototype,"stagedVertex",null),(0,i._)([(0,d.Cb)()],W.prototype,"updating",null),(0,i._)([(0,d.Cb)({constructOnly:!0})],W.prototype,"view",void 0),W=(0,i._)([(0,_.j)("esri.views.draw.DrawOperation")],W)},78005:(t,e,n)=>{n.d(e,{A:()=>i,n:()=>r});const i=["freehand","hybrid","click"],r="click"},54016:(t,e,n)=>{n.d(e,{aL:()=>a,hP:()=>c,iW:()=>l});var i=n(92026),r=n(17842),s=n(65618),o=n(74509);class a{constructor(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.elevationInfo=t,this.defaultZ=e,this.view=n,this.excludeGraphics=i}screenToMap(t){if((0,i.pC)(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(t.x,t.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);const e=this.view.sceneIntersectionHelper.intersectElevationFromScreen((0,r.s1)(t.x,t.y),this.elevationInfo,0,this.excludeGraphics);return(0,i.pC)(e)&&(e.z=void 0),e}mapToScreen(t){const e=(0,s.Tx)(t.x,t.y,(0,o.vQ)(this.view,t,this.elevationInfo),t.spatialReference);return this.view.toScreen(e)}}class l{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.view=t,this.elevationInfo=e,this.exclude=n}screenToMap(t){const e=this.view.toMap(t,{exclude:this.exclude});return(0,i.pC)(e)&&(e.z=(0,o.Ou)(e,this.view,this.elevationInfo)),e}mapToScreen(t){let e=t;return(0,i.pC)(this.elevationInfo)&&(e=(0,s.Tx)(t.x,t.y,(0,o.vQ)(this.view,t,this.elevationInfo),t.spatialReference)),this.view.toScreen(e)}}class c{constructor(t){this.view=t,this.screenToMap=e=>t.toMap(e),this.mapToScreen=e=>t.toScreen(e)}}},3826:(t,e,n)=>{n.d(e,{Gn:()=>f,Q8:()=>d});n(59486);var i=n(92026),r=n(22018),s=n(89494),o=n(48976),a=n(98131),l=n(11186),c=n(71353),u=n(14320),h=n(7882);function p(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,i.pC)(n)?[t,e,n]:[t,e]}function d(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,i.pC)(n)?{x:t,y:e,z:n}:{x:t,y:e}}class _{constructor(t){this.spatialReference=t}mapToLocalMultiple(t){return(0,i.lV)(t.map((t=>this.mapToLocal(t))))}get doUnnormalization(){return!1}}class g extends _{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e),this.defaultZ=n,this.transform=(0,s.c)(),this.transformInv=(0,s.c)(),this.transform=(0,s.a)(t),(0,r.b)(this.transformInv,this.transform)}makeMapPoint(t,e){return p(t,e,this.defaultZ)}mapToLocal(t){return d(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return p(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this.defaultZ)}}class v extends _{constructor(t,e){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=(0,c.c)(),this.tangentFrameUpWS=(0,c.c)(),this.tangentFrameRightWS=(0,c.c)(),this.tangentFrameForwardWS=(0,c.c)(),this.localFrameRightWS=(0,c.c)(),this.localFrameUpWS=(0,c.c)(),this.worldToLocalTransform=(0,a.a)(),this.localToWorldTransform=(0,a.a)(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=e,this.defaultZ=e.hasZ?e.z:null;const n=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,u.R.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,u.R.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,u.R.Z,this.tangentFrameForwardWS);const i=(0,c.c)();(0,l.g)(i,this.tangentFrameForwardWS,(0,l.e)(n,this.tangentFrameForwardWS)),(0,l.b)(this.localFrameRightWS,n,i),(0,l.n)(this.localFrameRightWS,this.localFrameRightWS),(0,l.f)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,o.r)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,o.i)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(t,e){return p(t,e,this.defaultZ)}mapToLocal(t){const e=(0,c.c)();this.view.renderCoordsHelper.toRenderCoords(new h.Z({x:t[0],y:t[1],spatialReference:this.spatialReference}),e),(0,l.q)(e,e,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return(0,i.pC)(n)?d(n.x/this.scale,n.y/this.scale):null}localToMap(t){const e=(0,c.c)();this.view.renderCoordsHelper.toRenderCoords(new h.Z({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),e),(0,l.q)(e,e,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return(0,i.pC)(n)?p(n.x,n.y,this.defaultZ):null}}function f(t,e){if("2d"===t.type)return new g(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if("3d"===t.type){const n=e.length>2?new h.Z({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new h.Z({x:e[0],y:e[1],spatialReference:t.spatialReference});return new v(t,n)}return null}},80151:(t,e,n)=>{n.d(e,{n:()=>c});var i=n(92026),r=n(66978),s=n(70178),o=n(74229),a=n(34019),l=n(99912);class c{constructor(){this.next=new o.hM}createSnapDragEventPipelineStep(t){let{predicate:e=(()=>!0),cancel:n,snappingManager:c,snappingContext:u,updatingHandles:h}=t;if((0,i.Wi)(c))return t=>t;let p=null,d=null;const _=()=>{p=(0,i.IM)(p),c.doneSnapping(),(0,i.pC)(d)&&d.frameTask.remove(),d=null};n.next((t=>(_(),t))),this.next=new o.hM;const g=(0,r.Ds)((async(t,e)=>{let{frameTask:n,point:i,context:r,event:o,dx:a,dy:l}=t;const u=await n.schedule((()=>c.snap(i,r,e)),e);if(u.valid){let t=await n.schedule((()=>u.apply()),e);i!==v&&(t=c.update(v,r)),(0,s.k)(t,f)||(o.mapEnd.x=t.x+a,o.mapEnd.y=t.y+l,this.next.execute(o))}}));let v,f;return t=>{if(!e(t))return t;if("start"===t.action){const e="3d"===c.view.type?c.view.resourceController.scheduler.registerTask(l.T8.SNAPPING):l.sq;d={context:new a.N({editGeometryOperations:u.editGeometryOperations,elevationInfo:u.elevationInfo,pointer:u.pointer,vertexHandle:(0,i.pC)(t.info)?t.info.handle:null,excludeFeature:u.excludeFeature,visualizer:u.visualizer}),originalPos:(0,i.pC)(t.snapOrigin)?u.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,frameTask:e}}if((0,i.pC)(d)){const e=d.context.coordinateHelper.vectorToDehydratedPoint(d.context.coordinateHelper.arrayToVector([d.originalPos.x,d.originalPos.y,d.originalPos.z]));e.x+=t.mapEnd.x-t.mapStart.x,e.y+=t.mapEnd.y-t.mapStart.y;const n=t.mapStart.x-d.originalPos.x,s=t.mapStart.y-d.originalPos.y,o={...t,action:"update"},a=d.context,l=c.update(e,d.context);if(f=l,t.mapEnd.x=l.x+n,t.mapEnd.y=l.y+s,v=e,"end"!==t.action){const t=d.frameTask;(0,i.pC)(p)||(p=new AbortController),h.addPromise((0,r.R8)(g({frameTask:t,event:o,context:a,point:e,dx:n,dy:s},p.signal)))}}return"end"===t.action&&_(),t}}}},71040:(t,e,n)=>{n.d(e,{y:()=>u});var i=n(27366),r=n(85015),s=n(92026),o=n(66978),a=n(49861),l=(n(63780),n(93169),n(25243),n(69912)),c=n(99912);let u=class extends r.Z{constructor(t){super(t),this.stagedPoint=null,this._abortController=null,this._snap=(0,o.Ds)((async(t,e,n,i)=>{const r=await this._frameTask.schedule((()=>e.snap(t,n,i)),i);r.valid&&await this._frameTask.schedule((()=>{this.stagedPoint=r.apply(),t!==this._snapMapPoint&&(this.stagedPoint=e.update(this._snapMapPoint,n))}),i)}))}initialize(){const t="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=(0,s.pC)(t)?t.registerTask(c.T8.SNAPPING):c.sq}destroy(){this._abortController=(0,s.IM)(this._abortController),this._frameTask=(0,s.hw)(this._frameTask)}async snap(t,e,n){return this.stagedPoint=e.update(t,n),this._snapMapPoint=t,(0,s.Wi)(this._abortController)&&(this._abortController=new AbortController),this._snap(t,e,n,this._abortController.signal)}abort(){this._abortController=(0,s.IM)(this._abortController)}};(0,i._)([(0,a.Cb)({constructOnly:!0})],u.prototype,"view",void 0),(0,i._)([(0,a.Cb)()],u.prototype,"stagedPoint",void 0),u=(0,i._)([(0,l.j)("esri.views.interactive.snapping.SnappingOperation")],u)},4943:(t,e,n)=>{n.d(e,{h:()=>a});var i=n(27366),r=n(85015),s=n(49861),o=(n(63780),n(93169),n(25243),n(69912));let a=class extends r.Z{constructor(t){super(t)}};(0,i._)([(0,s.Cb)()],a.prototype,"tooltipOptions",void 0),a=(0,i._)([(0,o.j)("esri.views.interactive.tooltip.SketchTooltipInfo")],a)},72189:(t,e,n)=>{n.d(e,{u:()=>B});var i=n(27366),r=n(85015),s=n(92026),o=n(94172),a=n(49861),l=(n(63780),n(93169),n(25243),n(69912));const c="esri-tooltip",u=`${c}-content`;n(32718),n(75366),n(59166);var h=n(58935),p=n(68860),d=n(69407),_=n(80975),g=n(80532),v=n(6291);let f=class extends d.Z{constructor(){super(...arguments),this._messagesUnits=null,this._messagesTooltip=null}get _units(){const t=(0,p.RG)(this.tooltip.view);return{length:t,verticalLength:t,area:t}}_formatScale(t){return(0,v.uf)(t,{style:"percent",maximumFractionDigits:0})}_formatRelativeOrientation(t){return(0,v.uf)(t,{maximumFractionDigits:2,minimumFractionDigits:2,signDisplay:"exceptZero"})}_formatLength(t,e,n){return(0,h.N9)(this._messagesUnits,t,(0,s.Pt)(e,this._units.length),n)}_formatRelativeLength(t){return(0,h.i_)(this._messagesUnits,t,this._units.length)}_formatVerticalLength(t){return(0,h.ym)(this._messagesUnits,t,this._units.verticalLength)}_formatRelativeVerticalLength(t){return(0,h.Pr)(this._messagesUnits,t,this._units.verticalLength)}_formatTotalLength(t){return(0,h.N9)(this._messagesUnits,t,this._units.length)}_formatArea(t){return(0,h.Se)(this._messagesUnits,t,this._units.area)}_formatPercentage(t){return(0,v.uf)(t.value,{style:"percent"})}};(0,i._)([(0,a.Cb)()],f.prototype,"info",void 0),(0,i._)([(0,a.Cb)()],f.prototype,"tooltip",void 0),(0,i._)([(0,a.Cb)()],f.prototype,"_units",null),(0,i._)([(0,g.H)("esri/core/t9n/Units"),(0,a.Cb)()],f.prototype,"_messagesUnits",void 0),(0,i._)([(0,g.H)("esri/views/interactive/tooltip/t9n/Tooltip"),(0,a.Cb)()],f.prototype,"_messagesTooltip",void 0),f=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContent")],f);var m=n(67005);const y=`${c}-field`,x={base:y,title:`${y}__title`,value:`${y}__value`};let T=class extends d.Z{render(){return(0,m.u)("div",{class:x.base},(0,m.u)("div",{class:x.title},this.title),(0,m.u)("div",{class:x.value},this.value))}};(0,i._)([(0,a.Cb)()],T.prototype,"title",void 0),(0,i._)([(0,a.Cb)()],T.prototype,"value",void 0),T=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.support.TooltipField")],T);const b={base:`${u} ${u}--draw-point`};let C=class extends f{render(){const{elevation:t}=this.info,e=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:b.base},(0,m.u)(T,{title:e?.elevation,value:this._formatVerticalLength(t)}))}};C=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],C);const E={base:`${u} ${u}--draw-polygon`};let w=class extends f{render(){const{area:t,elevation:e}=this.info,n=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:E.base},(0,m.u)(T,{title:n?.elevation,value:this._formatVerticalLength(e)}),(0,m.u)(T,{title:n?.area,value:this._formatArea(t)}))}};w=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],w);const S={base:`${u} ${u}--draw-polyline`};let I=class extends f{render(){const{elevation:t,totalLength:e}=this.info,n=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:S.base},(0,m.u)(T,{title:n?.elevation,value:this._formatVerticalLength(t)}),(0,m.u)(T,{title:n?.totalLength,value:this._formatLength(e)}))}};I=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],I);const R={base:`${u} ${u}--extent-rotate`};let k=class extends f{render(){const{angle:t}=this.info,e=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:R.base},(0,m.u)(T,{title:e?.rotation,value:this._formatRelativeOrientation(t)}))}};k=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],k);const O={base:`${c}-value-by-value`};let P=class extends d.Z{constructor(){super(...arguments),this.divider="\xd7"}render(){return(0,m.u)("div",{class:O.base},(0,m.u)("span",null,this.left),(0,m.u)("span",null,this.divider),(0,m.u)("span",null,this.right))}};(0,i._)([(0,a.Cb)()],P.prototype,"left",void 0),(0,i._)([(0,a.Cb)()],P.prototype,"divider",void 0),(0,i._)([(0,a.Cb)()],P.prototype,"right",void 0),P=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.support.ValueByValue")],P);const L={base:`${u} ${u}--extent-scale`};let A=class extends f{render(){const{xScale:t,yScale:e,xSize:n,ySize:i}=this.info,r=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:L.base},(0,m.u)(T,{title:r?.size,value:(0,m.u)(P,{left:this._formatLength(n),right:this._formatLength(i)})}),(0,m.u)(T,{title:r?.scale,value:(0,m.u)(P,{left:this._formatScale(t),right:this._formatScale(e)})}))}};A=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],A);const M={base:`${u} ${u}--reshape-edge-offset`};let D=class extends f{render(){const{distance:t}=this.info,e=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:M.base},(0,m.u)(T,{title:e?.distance,value:this._formatRelativeLength(t)}))}};D=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],D);const U={base:`${u} ${u}--reshape-move-graphic`};let F=class extends f{render(){const{distance:t}=this.info,e=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:U.base},(0,m.u)(T,{title:e?.distance,value:this._formatLength(t)}))}};F=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentReshapeMoveGraphic")],F);const V={base:`${u} ${u}--transform-absolute`};let G=class extends f{render(){const{orientation:t,orientationEnabled:e,orientationPrecision:n,rotationType:i,size:r,sizeEnabled:s,sizeUnit:o,sizePrecision:a}=this.info,l=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:V.base},e&&(0,m.u)(T,{title:l?.orientation,value:(0,h.cy)(t,i,n)}),s&&(0,m.u)(T,{title:l?.size,value:this._formatLength(r,o,a)}))}};G=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentTransformAbsolute")],G);const W={base:`${u} ${u}--transform-rotate`};let Z=class extends f{render(){const{rotation:t,rotationPrecision:e,orientation:n,orientationPrecision:i,rotationType:r}=this.info,s=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:W.base},(0,m.u)(T,{title:s?.rotation,value:(0,h.SP)(t,r,e)}),(0,m.u)(T,{title:s?.orientation,value:(0,h.cy)(n,r,i)}))}};Z=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentTransformRotate")],Z);const N={base:`${u} ${u}--transform-scale`};let H=class extends f{render(){const{scale:t,size:e,sizePrecision:n,sizeUnit:i}=this.info,r=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:N.base},(0,m.u)(T,{title:r?.scale,value:this._formatPercentage(t)}),(0,m.u)(T,{title:r?.size,value:this._formatLength(e,i,n)}))}};H=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentTransformScale")],H);const z={base:`${u} ${u}--translate-vertex`};let j=class extends f{render(){const{area:t,distance:e,elevation:n,totalLength:i}=this.info,r=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:z.base},(0,m.u)(T,{title:r?.distance,value:this._formatLength(e)}),(0,s.pC)(n)&&(0,m.u)(T,{title:r?.elevation,value:this._formatVerticalLength(n)}),(0,s.pC)(t)&&(0,m.u)(T,{title:r?.area,value:this._formatArea(t)}),(0,s.pC)(i)&&(0,m.u)(T,{title:r?.totalLength,value:this._formatLength(i)}))}};j=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],j);const $={base:`${u} ${u}--extent-move-z`};let Q=class extends f{render(){const{distance:t}=this.info,e=this._messagesTooltip?.sketch;return(0,m.u)("div",{class:$.base},(0,m.u)(T,{title:e?.distance,value:this._formatRelativeVerticalLength(t)}))}};Q=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.content.TooltipContentTranslateZ")],Q);const q={base:`${c}`};let B=class extends r.Z{constructor(t){super(t),this.info=null,this._contentContainer=(()=>{const t=document.createElement("div");return t.classList.add(q.base),t})(),this._contentWidget=null}initialize(){const t=this._contentContainer;this.own([(0,o.YP)((()=>this.view.overlay?.surface),(e=>{t.remove(),(0,s.yw)(e,(e=>e.appendChild(t)))}),o.tX),(0,o.YP)((()=>this.info),((e,n)=>{(0,s.pC)(this._contentWidget)&&(0,s.pC)(e)&&(0,s.pC)(n)&&e.type===n.type?this._contentWidget.info=e:(this._contentWidget=(0,s.SC)(this._contentWidget),(0,s.yw)(function(t,e){if((0,s.Wi)(e))return null;const n=document.createElement("div");switch(e.type){case"draw-point":return new C({tooltip:t,info:e,container:n});case"draw-polygon":return new w({tooltip:t,info:e,container:n});case"draw-polyline":return new I({tooltip:t,info:e,container:n});case"extent-rotate":return new k({tooltip:t,info:e,container:n});case"extent-scale":return new A({tooltip:t,info:e,container:n});case"reshape-edge-offset":return new D({tooltip:t,info:e,container:n});case"transform-absolute":return new G({tooltip:t,info:e,container:n});case"transform-rotate":return new Z({tooltip:t,info:e,container:n});case"transform-scale":return new H({tooltip:t,info:e,container:n});case"translate-graphic":return new F({tooltip:t,info:e,container:n});case"translate-vertex":return new j({tooltip:t,info:e,container:n});case"translate-z":return new Q({tooltip:t,info:e,container:n})}}(this,e),(e=>{this._contentWidget=e,t.appendChild(e.container)})))}),o.tX),(0,o.YP)((()=>({container:this._contentContainer,contentWidget:this._contentWidget,screenPoint:this.view.inputManager?.latestPointerLocation})),Y,o.tX)])}destroy(){this._contentWidget=(0,s.SC)(this._contentWidget),this._contentContainer.remove()}clear(){this.info=null}get test(){return{contentContainer:this._contentContainer}}};function Y(t){let{container:e,contentWidget:n,screenPoint:i}=t;const{style:r}=e;if((0,s.pC)(i)&&(0,s.pC)(n)){r.display="block";const t=(0,_.dZ)(e),n=`translate(${Math.round(i.x)+X[0]*(t?-1:1)}px, ${Math.round(i.y)+X[1]}px)`;r.transform=t?`translate(-100%, 0) ${n}`:n}else r.display="none"}(0,i._)([(0,a.Cb)({nonNullable:!0})],B.prototype,"view",void 0),(0,i._)([(0,a.Cb)()],B.prototype,"info",void 0),(0,i._)([(0,a.Cb)()],B.prototype,"_contentContainer",void 0),(0,i._)([(0,a.Cb)()],B.prototype,"_contentWidget",void 0),B=(0,i._)([(0,l.j)("esri.views.interactive.tooltip.Tooltip")],B);const X=[20,20]},99912:(t,e,n)=>{n.d(e,{sq:()=>P,T8:()=>y,G5:()=>O});var i=n(27366),r=n(85015),s=n(100),o=n(32718),a=n(92026),l=n(90941),c=n(27546),u=n(66978),h=n(94172),p=n(38499),d=n(49861),_=(n(63780),n(93169),n(25243),n(69912));let g=class extends r.Z{constructor(){super(...arguments),this._tasks=new Array,this.running=!1}get length(){return this._tasks.length}destroy(){this.cancelAll()}runTask(t){for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,n){return this.running=!0,new Promise(((i,r)=>this._tasks.push(new v(i,r,t,e,n))))}unshift(t,e,n){return this.running=!0,new Promise(((i,r)=>this._tasks.unshift(new v(i,r,t,e,n))))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const n=(0,u.Hc)(e.signal);if(n&&!e.abortCallback)e.reject((0,u.zE)());else{const i=n?e.abortCallback((0,u.zE)()):e.callback(t);(0,u.y8)(i)?i.then(e.resolve,e.reject):e.resolve(i)}}catch(n){e.reject(n)}return this.running=this._tasks.length>0,!0}cancelAll(){const t=(0,u.zE)();for(const e of this._tasks)if(e.abortCallback){const n=e.abortCallback(t);e.resolve(n)}else e.reject(t);this._tasks.length=0,this.running=!1}};(0,i._)([(0,d.Cb)()],g.prototype,"running",void 0),g=(0,i._)([(0,_.j)("esri.layers.support.PromiseQueue")],g);class v{constructor(t,e,n,i,r){this.resolve=t,this.reject=e,this.callback=n,this.signal=i,this.abortCallback=r}}var f=n(32609);const m=o.Z.getLogger("esri.views.support.Scheduler");var y;!function(t){t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="cloud generator",t[t.TEST_PRIO=1]="TEST_PRIO"}(y||(y={}));const x=new Map([[y.RESOURCE_CONTROLLER,0],[y.SLIDE,0],[y.STREAM_DATA_LOADER,0],[y.ELEVATION_QUERY,0],[y.TERRAIN_SURFACE,1],[y.SURFACE_GEOMETRY_UPDATES,1],[y.GRAPHICS_CORE,2],[y.I3S_CONTROLLER,2],[y.POINT_CLOUD_LAYER,2],[y.FEATURE_TILE_FETCHER,2],[y.OVERLAY,4],[y.STAGE,4],[y.GRAPHICS_DECONFLICTOR,4],[y.FILTER_VISIBILITY,4],[y.SCALE_VISIBILITY,4],[y.FRUSTUM_VISIBILITY,4],[y.POINT_OF_INTEREST_FREQUENT,6],[y.POINT_OF_INTEREST_INFREQUENT,30],[y.LABELER,8],[y.FEATURE_QUERY_ENGINE,8],[y.FEATURE_TILE_TREE,16],[y.FEATURE_TILE_TREE_ACTIVE,0],[y.ELEVATION_ALIGNMENT,12],[y.TEXT_TEXTURE_ATLAS,12],[y.CLOUDS_GENERATOR,12],[y.TEXTURE_UNLOAD,12],[y.LINE_OF_SIGHT_TOOL,16],[y.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[y.SNAPPING,0],[y.SHADOW_ACCUMULATOR,30]]);function T(t){return x.has(t)?x.get(t):"number"==typeof t?t:1}var b;!function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"}(b||(b={}));const C=(0,p.HA)(6.5),E=(0,p.HA)(1),w=(0,p.HA)(30),S=(0,p.HA)(1e3/30),I=(0,p.HA)(100);var R,k;!function(t){let e=class extends r.Z{constructor(){super(),this.updating=!0,this._microTaskQueued=!1,this.performanceInfo={total:new l.Z("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new o,this._state=b.INTERACTING,this._tasks=new c.Z,this._runQueue=new c.Z,this._load=0,this._idleStateCallbacks=new c.Z,this._idleUpdatesStartFired=!1,this._maxReschedule=L,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,h.YP)((()=>f.Z.SCHEDULER_LOG_SLOW_TASKS),(t=>this._debug=t),h.nn);for(const n of Object.keys(y))this.performanceInfo.tasks.set(y[n],new l.Z(y[n]));let t;const e=this;this._test={get state(){return(0,a.Pt)(t,e._state)},set state(e){t=e},FRAME_SAFETY_BUDGET:C,INTERACTING_BUDGET:S,IDLE_BUDGET:I,get availableBudget(){return e._budget.budget},usedBudget:0,getBudget:()=>e._budget,setBudget:t=>e._budget=t,updateTask:t=>this._updateTask(t),getState:t=>this._getState(t),getRuntime:t=>this._getRuntime(t),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach((t=>t.remove())),this._tasks.clear(),(0,a.hw)(this._debugHandle),this._microTaskQueued=!1,this.updating=!1}activate(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=L,this._schedule(),this.frame()))})))}registerTask(t,e){const i=T(t),r=new n(this,t,e,i);return this._tasks.push(r),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new l.Z(t)),r}registerIdleStateCallbacks(t,e){const n={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(n),this.state===b.IDLE&&this._idleUpdatesStartFired&&n.idleBegin();const i=this;return{remove:()=>this._removeIdleStateCallbacks(n),set idleBegin(t){i._idleUpdatesStartFired&&(n.idleEnd(),i._state===b.IDLE&&t()),n.idleBegin=t},set idleEnd(t){n.idleEnd=t}}}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,this.state!==b.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return(0,a.Wi)(this._test.state)?this._state:this._test.state}updateBudget(t){this._test.usedBudget=0;let e=C,n=t.frameDuration,i=E;switch(this.state){case b.IDLE:e=(0,p.HA)(0),n=(0,p.HA)(Math.max(I,t.frameDuration)),i=w;break;case b.INTERACTING:n=(0,p.HA)(Math.max(S,t.frameDuration));case b.ANIMATING:}return n=(0,p.HA)(n-t.elapsedFrameTime-e),this.state!==b.IDLE&&n<E&&!this._forceTask?(this._forceTask=!0,!1):(n=(0,p.HA)(Math.max(n,i)),this._budget.reset(n,this.state),this._maxReschedule=L,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case b.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case b.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset((0,p.HA)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t)}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return k.SCHEDULED;let e=k.IDLE;return this._tasks.forAll((n=>{n.name===t&&n.needsUpdate&&(n.schedulePriority<=1?e=k.READY:e!==k.READY&&(e=k.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((n=>{n.name===t&&(e+=n.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,n)=>{e+=t>1?` ${t}x ${n}`:` ${n}`})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=.9*this._load+t*(1-.9)}_schedule(){if(this._maxReschedule<=0)return!1;for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{0===t.basePriority&&t.needsUpdate&&!this._runQueue.includes(t)&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1,e=0;if(this._tasks.forAll((n=>{n.needsUpdate&&0!==n.schedulePriority&&0!==n.basePriority&&(t=!0,e=Math.max(e,n.basePriority),1===n.schedulePriority?(n.schedulePriority=0,this._runQueue.push(n)):--n.schedulePriority)})),!t)return this.updating=!1,!1;this._maxReschedule===L&&(this._maxReschedule=e),--this._maxReschedule}return this.updating=!0,!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const n=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)}catch(e){m.error(`Exception in task "${i.name}"`,e)}i.schedulePriority=i.basePriority;const r=this._budget.now()-n;if(i.runtime+=r,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+r),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",i.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this.updating=this._tasks.some((t=>t.needsUpdate)),void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this.updating=this._tasks.some((t=>t.needsUpdate)),this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(y))this._frameTaskTimes.set(y[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).record(t))),this.performanceInfo.total.record(t)}get test(){return this._test}};(0,i._)([(0,d.Cb)()],e.prototype,"updating",void 0),e=(0,i._)([(0,_.j)("esri.views.support.Scheduler")],e),t.Scheduler=e;let n=class extends r.Z{constructor(t,e,n,i){super({}),this._scheduler=t,this.name=e,this._basePriority=i,this.runtime=0,this._queue=new g,this._handles=new s.Z,this.schedulePriority=this._basePriority,this.task=(0,a.pC)(n)?n:this._queue,this._handles.add((0,h.gx)((()=>this.task.running),(()=>t.activate())))}get updating(){return this._queue.running}normalizeCtorArgs(){return{}}remove(){this.processQueue(O),this._scheduler.removeTask(this),this.schedule=P.schedule,this.reschedule=P.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){this.name=t;const e=T(t);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,n){return this._queue.push(t,e,n)}reschedule(t,e,n){return this._queue.unshift(t,e,n)}processQueue(t){this._queue.runTask(t)}};(0,i._)([(0,d.Cb)({constructOnly:!0})],n.prototype,"task",void 0),(0,i._)([(0,d.Cb)({readOnly:!0})],n.prototype,"updating",null),n=(0,i._)([(0,_.j)("esri.views.support.SchedulerTask")],n);class o{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=b.IDLE,this._didWork=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&(this._didWork=!0),!0)}get done(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}get budget(){return this._budget}madeProgress(){this._didWork=!0}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this._didWork=!1}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._didWork=!1}get hasProgressed(){return this._didWork}}t.Budget=o}(R||(R={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(k||(k={}));const O=(()=>{const t=new R.Budget;return t.enabled=!1,t})();const P=new class{remove(){}processQueue(){}schedule(t,e,n){try{if((0,u.Hc)(e)){const t=(0,u.zE)();return n?Promise.resolve(n(t)):Promise.reject(t)}return(0,u.gx)(t(O))}catch(i){return Promise.reject(i)}}reschedule(t,e,n){return this.schedule(t,e,n)}},L=Number.MAX_SAFE_INTEGER},21971:(t,e,n)=>{n.d(e,{M:()=>g});var i=n(92026),r=n(12611),s=(n(59486),n(47898)),o=n(2170),a=n(79803),l=n(15559),c=n(47072),u=n(78952);function h(t){const{spatialReference:e}=t;return(0,c.T)(e,p,d,_,t)}function p(t){return(0,s.ne)(Math.abs((0,l.p8)([t],"square-meters")[0]),"square-meters")}function d(t){try{return(0,s.ne)(Math.abs((0,o.geodesicArea)(t,"square-meters")),"square-meters")}catch(e){return null}}function _(t){const e=[];return(0,a.K2)(t,e)?(0,s.ne)(Math.abs((0,l.p8)([{type:"polygon",rings:e,spatialReference:u.Z.WGS84}],"square-meters")[0]),"square-meters"):null}function g(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,r.ln)();if(e){const e=h(t);return(0,i.pC)(e)?e:(0,r.X)(t,n)}return(0,r.oN)(t,n)}},59418:(t,e,n)=>{n.d(e,{GQ:()=>l,MU:()=>a,Ul:()=>o,bZ:()=>c});var i=n(92026),r=n(4914),s=n(13615);function o(t,e){return u(r.qS,s.kQ,r.Sx,e,t)}function a(t,e,n,i){return u(r.FN,s.FB,r.qj,i,t,e,n)}function l(t,e,n){return u(r.xI,s.RT,r.xI,n,t,e)}function c(t,e,n,i){return u(r.qj,s.FB,r.qj,i,t,e,n)}function u(t,e,n,r){for(var s=arguments.length,o=new Array(s>4?s-4:0),a=4;a<s;a++)o[a-4]=arguments[a];if("on-the-ground"===r){const t=e.apply(void 0,o);return(0,i.pC)(t)?t:n.apply(void 0,o)}return t.apply(void 0,o)}},32609:(t,e,n)=>{n.d(e,{Z:()=>l});var i=n(27366),r=n(85015),s=n(49861),o=(n(63780),n(93169),n(25243),n(69912));let a=class extends r.Z{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,i._)([(0,s.Cb)()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,i._)([(0,s.Cb)()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=(0,i._)([(0,o.j)("esri.views.support.DebugFlags")],a);const l=new a},12611:(t,e,n)=>{n.d(e,{X:()=>g,ln:()=>m,oN:()=>_});var i=n(92026),r=n(47898),s=n(68860),o=n(79347),a=n(11186),l=n(71353),c=n(79803),u=n(55652),h=n(74702),p=n(11185),d=n(25003);function _(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]};return v(t,e)}function g(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]};return v(t,e,!1)}function v(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.hasZ;const o=(0,d.m)(t.spatialReference),_=(0,s.oq)(o);if((0,i.Wi)(_))return null;const g=(t,e)=>!(e.length<2)&&((0,a.s)(t,e[0],e[1],n&&e[2]||0),!0);let v=0;for(const i of t.rings){if(i.length<3)continue;const{positionsWorldCoords:n}=e;for(;n.length<i.length;)n.push((0,l.c)());const r=f;for(let e=0;e<3;e++){if(!g(r,i[e]))return null;if(!(0,c.SH)(r,t.spatialReference,n[e],o))return null}if((0,a.k)(n[0],n[1])||(0,a.k)(n[0],n[2])||(0,a.k)(n[1],n[2]))continue;const s=(0,u.zk)(n[0],n[1],n[2],(0,u.re)()),d=(0,a.c)(p.WM.get(),n[0]);for(let t=0;t<3;t++)(0,u.tx)(s,d,n[t],n[t]);for(let e=3;e<i.length;e++){if(!g(r,i[e]))return null;(0,c.SH)(r,t.spatialReference,n[e],o),(0,u.tx)(s,d,n[e],n[e])}const _=y(n);for(let t=0;t<_.length;t+=3)v+=(0,h.wu)(n[_[t]],n[_[t+1]],n[_[t+2]])}return(0,r.ne)(v,_)}const f=(0,l.c)();function m(){return{positionsWorldCoords:[]}}function y(t){return(0,o.e)(function(t){const e=new Float64Array(2*t.length);for(let n=0;n<t.length;++n){const i=t[n],r=2*n;e[r+0]=i[0],e[r+1]=i[1]}return e}(t),[],2)}},4914:(t,e,n)=>{n.d(e,{Cr:()=>y,FN:()=>f,Sx:()=>p,_e:()=>g,g1:()=>v,qS:()=>h,qj:()=>m,xI:()=>_});var i=n(92026),r=n(47898),s=n(68860),o=n(11186),a=n(71353),l=n(79803),c=n(92975),u=n(25003);function h(t){return d(t,"direct")}function p(t){return d(t,"horizontal")}function d(t,e){const{hasZ:n,spatialReference:o}=t,a=(0,u.m)(o);let l=0;const c=(0,s.j5)(a);if((0,i.Wi)(c))return null;const h="direct"===e?f:m;for(const r of t.paths){if(r.length<2)continue;const t=r.length-1;for(let e=0;e<t;++e){const t=r[e];T[0]=t[0],T[1]=t[1],T[2]=n?t[2]:0;const s=r[e+1];b[0]=s[0],b[1]=s[1],b[2]=n?s[2]:0;const a=h(T,b,o);if((0,i.Wi)(a))return null;l+=a.value}}return(0,r.yG)(l,c)}function _(t,e){const{spatialReference:n}=t;return(0,c.fS)(n,e.spatialReference)?(T[0]=t.x,T[1]=t.y,T[2]=t.hasZ?t.z:0,b[0]=e.x,b[1]=e.y,b[2]=e.hasZ?e.z:0,m(T,b,n)):null}function g(t,e){const{spatialReference:n}=t;return(0,c.fS)(n,e.spatialReference)?(T[0]=t.x,T[1]=t.y,T[2]=t.hasZ?t.z:0,b[0]=e.x,b[1]=e.y,b[2]=e.hasZ?e.z:0,y(T,b,n)):null}function v(t){return T[0]=t.x,T[1]=t.y,T[2]=t.hasZ?t.z:0,function(t,e){const n=(0,s.y)(e);return(0,i.pC)(n)?(0,r.yG)(t[2],n):null}(T,t.spatialReference)}function f(t,e,n){const s=x(t,e,n,"direct");return(0,i.pC)(s)?(0,r.yG)(s.direct,s.unit):null}function m(t,e,n){const s=x(t,e,n,"horizontal");return(0,i.pC)(s)?(0,r.yG)(s.horizontal,s.unit):null}function y(t,e,n){const s=x(t,e,n,"vertical");return(0,i.pC)(s)?(0,r.yG)(s.verticalSigned,s.unit):null}function x(t,e,n,r){const a=(0,u.m)(n),c=(0,s.j5)(a);if((0,i.Wi)(c))return null;const h=e[2]-t[2];if("vertical"===r)return{verticalSigned:h,unit:c};if(!(0,l.SH)(t,n,C,a)||!(0,l.SH)(e,n,E,a))return null;if("direct"===r)return{direct:(0,o.i)(E,C),unit:c};if((0,o.s)(w,t[0],t[1],e[2]),!(0,l.SH)(w,n,w,a))return null;const p=(0,o.i)(w,E);return"horizontal"===r?{horizontal:p,unit:c}:{direct:(0,o.i)(E,C),horizontal:p,vertical:Math.abs(h),unit:c}}const T=(0,a.c)(),b=(0,a.c)(),C=(0,a.c)(),E=(0,a.c)(),w=(0,a.c)()},13615:(t,e,n)=>{n.d(e,{FB:()=>p,RT:()=>h,kQ:()=>u});var i=n(47898),r=n(71353),s=n(2170),o=n(79803),a=n(15559),l=n(92975),c=n(47072);function u(t){const{spatialReference:e}=t;return(0,c.T)(e,v,f,m,t)}function h(t,e){if(!(0,l.fS)(t.spatialReference,e.spatialReference))return null;const{spatialReference:n}=t;return x[0]=t.x,x[1]=t.y,x[2]=t.hasZ?t.z:0,T[0]=e.x,T[1]=e.y,T[2]=e.hasZ?e.z:0,p(x,T,n)}function p(t,e,n){return(0,c.T)(n,d,_,g,t,e,n)}function d(t,e,n){return(0,i.yG)((0,a.cA)(y,t,e,n).distance,"meters")}function _(t,e,n){return(0,i.yG)((0,s.geodesicLength)(function(t,e,n){return{type:"polyline",spatialReference:n,paths:[[[...t],[...e]]]}}(t,e,n),"meters"),"meters")}function g(t,e,n){return(0,o.ke)(t,n,b)&&(0,o.ke)(e,n,C)?(0,i.yG)((0,a.cA)(y,b,C).distance,"meters"):null}function v(t){return(0,i.yG)((0,a.Jf)([t],"meters")[0],"meters")}function f(t){return(0,i.yG)((0,s.geodesicLength)(t,"meters"),"meters")}function m(t){const e=[];if(!(0,o.bi)(t,e))return null;let n=0;for(const i of e){let t=0;for(let e=1;e<i.length;++e)t+=(0,a.cA)(y,i[e-1],i[e]).distance;n+=t}return(0,i.yG)(n,"meters")}const y={distance:null},x=(0,r.c)(),T=(0,r.c)(),b=(0,r.c)(),C=(0,r.c)()},47072:(t,e,n)=>{n.d(e,{T:()=>s});var i=n(15559),r=n(92975);function s(t,e,n,s){for(var o=arguments.length,a=new Array(o>4?o-4:0),l=4;l<o;l++)a[l-4]=arguments[l];return(0,r.sT)(t)&&(0,i.Gb)(t)?e.apply(void 0,a):(0,r.sS)(t)?n.apply(void 0,a):s.apply(void 0,a)}},25003:(t,e,n)=>{n.d(e,{m:()=>s});var i=n(79803),r=n(92183);function s(t){const e=(0,r.rS)(t),n=e===r.GG?r.wY:e;return(0,i.Up)(t,n)?n:t}}}]);
//# sourceMappingURL=8431.d8cb2d3c.chunk.js.map