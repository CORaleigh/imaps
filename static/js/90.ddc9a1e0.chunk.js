/*! For license information please see 90.ddc9a1e0.chunk.js.LICENSE.txt */
(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[90,205,284],{101:function(e,t,r){"use strict";function n(){return[0,0,0]}function o(e){return[e[0],e[1],e[2]]}function i(e,t,r){return[e,t,r]}function a(e){const t=[0,0,0],r=Math.min(3,e.length);for(let n=0;n<r;++n)t[n]=e[n];return t}function s(e,t){return new Float64Array(e,t,3)}function l(){return[0,0,0]}function c(){return i(1,1,1)}function u(){return i(1,0,0)}function d(){return i(0,1,0)}function p(){return i(0,0,1)}r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return o})),r.d(t,"e",(function(){return n})),r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return i}));const h=[0,0,0],b=c(),f=u(),m=d(),g=p();Object.freeze({__proto__:null,create:n,clone:o,fromValues:i,fromArray:a,createView:s,zeros:l,ones:c,unitX:u,unitY:d,unitZ:p,ZEROS:h,ONES:b,UNIT_X:f,UNIT_Y:m,UNIT_Z:g})},1045:function(e,t,r){"use strict";var n=r(80),o=(r(78),r(87)),i=r(79),a=r(86),s=r(83),l=r(93),c=r(82),u=r(92),d=r(89),p=r(81),h=(r(84),r(85),r(203)),b=r(91),f=r(192),m=r(95),g=r(153),v=r(106),y=r(154),O=r(230),w=r(157),j=r(181),_=r(465),k=r(234),S=r(571),E=r(605),I=r(863),T=r(506),x=r(180),A=r(109),M=r(673),C=r(182),N=r(653),B=r(88);let D=class extends B.a{constructor(e){super(e),this.layerId=null,this.facilityIdField=null,this.siteIdField=null,this.nameField=null}};Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],D.prototype,"layerId",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],D.prototype,"facilityIdField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],D.prototype,"siteIdField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],D.prototype,"nameField",void 0),D=Object(n.a)([Object(c.a)("esri.layers.support.FacilityLayerInfo")],D);var F=D;let P=class extends B.a{constructor(e){super(e),this.layerId=null,this.levelIdField=null,this.facilityIdField=null,this.longNameField=null,this.shortNameField=null,this.levelNumberField=null,this.verticalOrderField=null}};Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"layerId",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"levelIdField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"facilityIdField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"longNameField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"shortNameField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"levelNumberField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"verticalOrderField",void 0),P=Object(n.a)([Object(c.a)("esri.layers.support.LevelLayerInfo")],P);var L=P;let R=class extends B.a{constructor(e){super(e),this.layerId=null,this.siteIdField=null,this.nameField=null}};Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],R.prototype,"layerId",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],R.prototype,"siteIdField",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],R.prototype,"nameField",void 0),R=Object(n.a)([Object(c.a)("esri.layers.support.SiteLayerInfo")],R);var U=R;let V=class extends B.a{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};Object(n.a)([Object(s.b)({type:L,json:{write:!0,origins:{"web-scene":{write:!1}}}})],V.prototype,"levelLayer",void 0),Object(n.a)([Object(s.b)({type:F,json:{write:!0,origins:{"web-scene":{write:!1}}}})],V.prototype,"facilityLayer",void 0),Object(n.a)([Object(s.b)({type:U,json:{write:!0,origins:{"web-scene":{write:!1}}}})],V.prototype,"siteLayer",void 0),V=Object(n.a)([Object(c.a)("esri.support.MapFloorInfo")],V);var W,q=V,G=r(540),z=r(90);let J=W=class extends B.a{constructor(e){super(e),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new W(Object(z.a)({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};Object(n.a)([Object(s.b)({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],J.prototype,"activeRange",void 0),Object(n.a)([Object(s.b)({type:[Number],json:{write:!0}})],J.prototype,"currentRangeExtent",void 0),Object(n.a)([Object(s.b)({type:[Number],json:{write:!0}})],J.prototype,"fullRangeExtent",void 0),J=W=Object(n.a)([Object(c.a)("esri.webdoc.RangeInfo")],J);var Y,H=J;let $=Y=class extends B.a{constructor(e){super(e),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new Y(Object(z.a)({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};Object(n.a)([Object(s.b)({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],$.prototype,"enabled",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],$.prototype,"longNames",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],$.prototype,"minimized",void 0),Object(n.a)([Object(s.b)({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],$.prototype,"pinnedLevels",void 0),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"site"},write:{target:"site"}}})],$.prototype,"site",void 0),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],$.prototype,"facility",void 0),Object(n.a)([Object(s.b)({type:String,json:{read:{source:"level"},write:{target:"level"}}})],$.prototype,"level",void 0),$=Y=Object(n.a)([Object(c.a)("esri.webdoc.widgets.FloorFilter")],$);var X,K=$;const Z=new(r(97).a)({slider:"slider",picker:"picker"});let Q=X=class extends B.a{constructor(e){super(e),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new X({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};Object(n.a)([Object(s.b)({type:Z.apiValues,nonNullable:!0,json:{type:Z.jsonValues,default:null,read:{reader:Z.read},write:{isRequired:!0,writer:Z.write}}})],Q.prototype,"interactionMode",void 0),Object(n.a)([Object(s.b)({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const e=null!=this.stopInterval;return{enabled:!e,isRequired:!e}}}}})],Q.prototype,"numStops",void 0),Object(n.a)([Object(s.b)({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],Q.prototype,"stopInterval",void 0),Q=X=Object(n.a)([Object(c.a)("esri.webdoc.widgets.Range")],Q);var ee,te=Q,re=r(121),ne=r(164),oe=r(226);let ie=ee=class extends B.a{constructor(e){super(e),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(e){if(!e)return;const t=null!=e[0]?new Date(e[0]):null,r=null!=e[1]?new Date(e[1]):null;return new ne.a({start:t,end:r})}writeCurrentTimeExtent(e,t,r){e&&Object(re.c)(r,[e.start?e.start.getTime():null,e.end?e.end.getTime():null],t)}readFullTimeExtent(e,t){const r=t.properties;if(!r)return;const n=null!=r.endTime?new Date(r.endTime):null,o=null!=r.startTime?new Date(r.startTime):null;return new ne.a({start:o,end:n})}writeFullTimeExtent(e,t){if(!e)return;const r=t.properties=t.properties||{},n=e.end,o=e.start;n&&(r.endTime=n?n.getTime():null),o&&(r.startTime=o?o.getTime():null)}readStopInterval(e,t,r){return e?oe.a.fromJSON({value:e.interval,unit:e.units},r):null}writeStopInterval(e,t,r,n){if(!e)return;const o=e.toJSON(n);Object(re.c)(r,{interval:o.value,units:o.unit},t)}readStops(e){return e&&e.length?e.map((e=>new Date(e))):null}writeStops(e,t,r){e&&e.length&&Object(re.c)(r,e.map((e=>e.getTime())),t)}clone(){return new ee(Object(z.a)({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};Object(n.a)([Object(s.b)({type:ne.a,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],ie.prototype,"currentTimeExtent",void 0),Object(n.a)([Object(l.a)("currentTimeExtent")],ie.prototype,"readCurrentTimeExtent",null),Object(n.a)([Object(u.a)("currentTimeExtent")],ie.prototype,"writeCurrentTimeExtent",null),Object(n.a)([Object(s.b)({type:ne.a,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],ie.prototype,"fullTimeExtent",void 0),Object(n.a)([Object(l.a)("fullTimeExtent")],ie.prototype,"readFullTimeExtent",null),Object(n.a)([Object(u.a)("fullTimeExtent")],ie.prototype,"writeFullTimeExtent",null),Object(n.a)([Object(s.b)({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],ie.prototype,"loop",void 0),Object(n.a)([Object(s.b)({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var e;const t=!!this.stopInterval,r=!(null==(e=this.stops)||!e.length),n=!(t||r);return{enabled:n,isRequired:n}}}}})],ie.prototype,"numStops",void 0),Object(n.a)([Object(s.b)({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],ie.prototype,"numThumbs",void 0),Object(n.a)([Object(s.b)({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],ie.prototype,"stopDelay",void 0),Object(n.a)([Object(s.b)({type:oe.a,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){var e;const t=null!=this.numStops,r=!(null==(e=this.stops)||!e.length);return{enabled:!r,isRequired:!(t||r)}}}}})],ie.prototype,"stopInterval",void 0),Object(n.a)([Object(l.a)("stopInterval")],ie.prototype,"readStopInterval",null),Object(n.a)([Object(u.a)("stopInterval")],ie.prototype,"writeStopInterval",null),Object(n.a)([Object(s.b)({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],ie.prototype,"stops",void 0),Object(n.a)([Object(l.a)("stops")],ie.prototype,"readStops",null),Object(n.a)([Object(u.a)("stops")],ie.prototype,"writeStops",null),ie=ee=Object(n.a)([Object(c.a)("esri.webdoc.widgets.TimeSlider")],ie);var ae,se=ie;let le=ae=class extends B.a{constructor(e){super(e),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new ae(Object(z.a)({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};Object(n.a)([Object(s.b)({type:te,json:{write:!0}})],le.prototype,"range",void 0),Object(n.a)([Object(s.b)({type:se,json:{write:!0}})],le.prototype,"timeSlider",void 0),Object(n.a)([Object(s.b)({type:K,json:{write:!0}})],le.prototype,"floorFilter",void 0),le=ae=Object(n.a)([Object(c.a)("esri.webdoc.Widgets")],le);var ce=le;const ue={width:600,height:400},de=1.5;function pe(e){return{enabled:!(null==e||!e.length)}}var he,be=r(103),fe=r(237);let me=he=class extends B.a{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new he({exactMatch:this.exactMatch,type:this.type,name:this.name})}};Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],me.prototype,"exactMatch",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],me.prototype,"name",void 0),Object(n.a)([Object(be.a)(fe.a)],me.prototype,"type",void 0),me=he=Object(n.a)([Object(c.a)("esri.webdoc.applicationProperties.SearchLayerField")],me);var ge,ve=me;let ye=ge=class extends B.a{constructor(e){super(e),this.field=null,this.id=null,this.subLayer=null}clone(){return new ge(Object(z.a)({field:this.field,id:this.id,subLayer:this.subLayer}))}};Object(n.a)([Object(s.b)({type:ve,json:{write:{isRequired:!0}}})],ye.prototype,"field",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:{isRequired:!0}}})],ye.prototype,"id",void 0),Object(n.a)([Object(s.b)({type:a.a,json:{write:!0}})],ye.prototype,"subLayer",void 0),ye=ge=Object(n.a)([Object(c.a)("esri.webdoc.applicationProperties.SearchLayer")],ye);var Oe,we=ye;let je=Oe=class extends B.a{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new Oe({exactMatch:this.exactMatch,type:this.type,name:this.name})}};Object(n.a)([Object(s.b)({type:Boolean,json:{write:!0}})],je.prototype,"exactMatch",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],je.prototype,"name",void 0),Object(n.a)([Object(be.a)(fe.a)],je.prototype,"type",void 0),je=Oe=Object(n.a)([Object(c.a)("esri.webdoc.applicationProperties.SearchTableField")],je);var _e,ke=je;let Se=_e=class extends B.a{constructor(e){super(e),this.field=null,this.id=null}clone(){return new _e(Object(z.a)({field:this.field,id:this.id}))}};Object(n.a)([Object(s.b)({type:ke,json:{write:{isRequired:!0}}})],Se.prototype,"field",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:{isRequired:!0}}})],Se.prototype,"id",void 0),Se=_e=Object(n.a)([Object(c.a)("esri.webdoc.applicationProperties.SearchTable")],Se);var Ee,Ie=Se;const Te=v.a.ofType(we),xe=v.a.ofType(Ie);let Ae=Ee=class extends B.a{constructor(e){super(e),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new Te,this.tables=new xe}readAddressSearchEnabled(e){return!e}writeAddressSearchEnabled(e,t,r){t[r]=!e}clone(){return new Ee(Object(z.a)({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};Object(n.a)([Object(s.b)({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],Ae.prototype,"addressSearchEnabled",void 0),Object(n.a)([Object(l.a)("addressSearchEnabled")],Ae.prototype,"readAddressSearchEnabled",null),Object(n.a)([Object(u.a)("addressSearchEnabled")],Ae.prototype,"writeAddressSearchEnabled",null),Object(n.a)([Object(s.b)({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],Ae.prototype,"enabled",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:!0}})],Ae.prototype,"hintText",void 0),Object(n.a)([Object(s.b)({type:Te,json:{write:{overridePolicy:pe},origins:{"web-scene":{write:{isRequired:!0}}}}})],Ae.prototype,"layers",void 0),Object(n.a)([Object(s.b)({type:xe,json:{read:!0,write:{overridePolicy:pe},origins:{"web-scene":{read:!1,write:!1}}}})],Ae.prototype,"tables",void 0),Ae=Ee=Object(n.a)([Object(c.a)("esri.webdoc.applicationProperties.Search")],Ae);var Me,Ce=Ae;let Ne=Me=class extends B.a{constructor(e){super(e),this.search=null}clone(){return new Me(Object(z.a)({search:this.search}))}};Object(n.a)([Object(s.b)({type:Ce,json:{write:!0}})],Ne.prototype,"search",void 0),Ne=Me=Object(n.a)([Object(c.a)("esri.webdoc.applicationProperties.Viewing")],Ne);var Be,De=Ne;let Fe=Be=class extends B.a{constructor(e){super(e),this.editing=null,this.offline=null,this.viewing=null}clone(){return new Be(Object(z.a)({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};Object(n.a)([Object(s.b)({json:{write:!0}})],Fe.prototype,"editing",void 0),Object(n.a)([Object(s.b)({json:{write:!0}})],Fe.prototype,"offline",void 0),Object(n.a)([Object(s.b)({type:De,json:{write:!0}})],Fe.prototype,"viewing",void 0),Fe=Be=Object(n.a)([Object(c.a)("esri.webmap.ApplicationProperties")],Fe);var Pe,Le=Fe,Re=r(881),Ue=r(768),Ve=r(94);let We=Pe=class extends Ve.a{constructor(e){super(e),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.viewpoint=null}clone(){return new Pe(Object(z.a)({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}};Object(n.a)([Object(s.b)({type:Ue.a})],We.prototype,"background",void 0),Object(n.a)([Object(s.b)({type:H})],We.prototype,"rangeInfo",void 0),Object(n.a)([Object(s.b)({type:m.a})],We.prototype,"spatialReference",void 0),Object(n.a)([Object(s.b)({type:T.a})],We.prototype,"viewpoint",void 0),We=Pe=Object(n.a)([Object(c.a)("esri.webmap.InitialViewProperties")],We);var qe=We,Ge=r(591);class ze extends Ge.a{constructor(e,t){super(e,t,"webmap")}}const Je=new ze(2,20),Ye="Web Map",He=v.a.ofType(Re.a),$e=i.a.getLogger("esri.WebMap"),Xe=new Map;Xe.set("image/jpeg","jpeg"),Xe.set("image/jpg","jpg"),Xe.set("image/png","png"),Xe.set("image/gif","gif");const Ke="ArcGIS API for JavaScript",Ze="CollectorDisabled",Qe="Collector",et="Data Editing",tt="OfflineDisabled",rt="Offline",nt="Workforce Project",ot="Workforce Worker",it="Workforce Dispatcher",at="DeveloperBasemap",st=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map((e=>e.toLowerCase()));let lt=class extends(Object(x.a)(w.a.LoadableMixin(Object(O.b)(I.a)))){constructor(e){super(e),this.applicationProperties=null,this.bookmarks=new He,this.floorInfo=null,this.initialViewProperties=new qe,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){const e=this.portalItem;this.portalItem=null,null==e||e.destroy()}initialize(){if(this.when().catch((e=>{$e.error("#load()","Failed to load web map",e)})),this.resourceInfo){let t;try{t=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(t)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp=Ke}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=y.d}readInitialViewProperties(e,t){var r;const n=new qe;t.background&&(n.background=Ue.a.fromJSON(t.background));const o=null==(r=t.initialState)?void 0:r.viewpoint;return o&&(o.rotation&&ze.parse(t.version||"","webmap").lessThan(2,20)&&"ArcGIS Pro"===t.authoringApp&&(o.rotation*=-1),n.viewpoint=T.a.fromJSON(o)),t.mapRangeInfo&&(n.rangeInfo=H.fromJSON(t.mapRangeInfo)),t.spatialReference&&(n.spatialReference=m.a.fromJSON(t.spatialReference)),n}writeInitialViewProperties(e,t,r,n){if(!e)return;const o=e.background;o&&o.color&&(t.background=o.write(null,n)),e.viewpoint&&(t.initialState={viewpoint:e.viewpoint.write(null,n)}),e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(n)),e.spatialReference&&(t.spatialReference=e.spatialReference.write(null,n))}writeLayers(e,t,r,n){t[r]=this._writeLayers(e,n,"operational-layers")}readSourceVersion(e,t){const[r,n]=t.version.split(".");return new ze(parseInt(r,10),parseInt(n,10))}writeSourceVersion(e,t,r){t[r]=`${Je.major}.${Je.minor}`}writeTables(e,t,r,n){const o=this._writeLayers(e,n,"tables");o.length&&(t[r]=o)}get thumbnailUrl(){return this.portalItem&&this.portalItem.thumbnailUrl||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}load(e){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}loadAll(){return Object(_.a)(this,(e=>{e(this.ground,this.basemap,this.layers,this.tables)}))}read(e,t){t={...t,origin:"web-map"};const r=this._getAuthoringPropsState();Object(f.b)(this,e,(t=>super.read(e,t)),t),this._restoreAuthoringPropsFromState(r)}write(e,t){if("loaded"!==this.loadStatus){const e=new d.a("webmap:not-loaded","Web map must be loaded before it can be serialized");throw $e.error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),e}return this._removeDanglingLayerRefs(),t={...t,origin:"web-map",restrictedWebMapWriting:!0,webmap:this},super.write(e,t)}async save(e){e=e||{},this._validateItem(),await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),await this._beforeSave(),this._validateMap();const t=this.portalItem,r={origin:"web-map",messages:[],writtenProperties:[],url:t.itemUrl&&Object(p.J)(t.itemUrl),portal:t.portal||j.a.getDefault()},n=this.write(null,r);return this._validateJSONForWriting(r,e),await this._updateItemProperties(t),await this._updateItem(t,n,r),await this._updateItemThumbnail(),t}async saveAs(e,t){t=t||{};const r=this._getPortalItem(e);await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),await this._beforeSave(),this._validateMap();const n={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:r.portal},o=this.write(null,n);this._validateJSONForWriting(n,t),await this._updateItemPropertiesForSaveAs(r);const i=this._getThumbnailState();return await this._createItem(r,o,n,t),this._restoreThumbnailFromState(i),await this._updateItemThumbnail(),r}async updateFrom(e,t){const r=this._updateFromInternal(e,t);this._updateFromPromise=r,await r,r===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){var t,r,n,o;const i=this.resourceInfo;return this._collectAllLayersJSON(Object(h.d)([null==i||null==(t=i.baseMap)?void 0:t.baseMapLayers,null==i?void 0:i.operationalLayers,null==(r=this.basemap)||null==(n=r.resourceInfo)||null==(o=n.data)?void 0:o.baseMapLayers])).find((t=>t.id===e.id))}_collectAllLayersJSON(e){return e.reduce(((e,t)=>(e.push(t),"GroupLayer"===t.layerType&&(e=e.concat(this._collectAllLayersJSON(t.layers||[]))),e)),[])}_writeLayers(e,t,r){return t={...t,layerContainerType:r},e.map((e=>Object(o.q)(Object(S.a)(e,"tables"===r?null:this.getLayerJSONFromResourceInfo(e),t)))).filter(Boolean).toArray()}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):Promise.resolve(null)}_loadFromItem(e){return e.load().catch((e=>{throw new d.a("webmap:load-portal-item","Failed to load portal item",{error:e})})).then((()=>{if("Web Map"!==e.type)throw new d.a("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:e.type})})).then((()=>e.fetchData())).then((t=>(this.resourceInfo=t,this._readAndLoadFromJSON(t,{origin:"web-map",portal:e.portal||j.a.getDefault()})))).then((()=>this._computeInitialViewpoint()))}_readAndLoadFromJSON(e,t){const r=this._validateJSON(e);return this.read(r,t),this._loadFromJSON(r,t)}_validateJSON(e){const t=ze.parse(e.version||"","webmap");return Je.validate(t),e.version=`${t.major}.${t.minor}`,e}_loadFromJSON(e,t){const n={context:{...t,layerContainerType:"operational-layers"}};return this.portalItem&&(n.context.portal=this.portalItem.portal||j.a.getDefault()),r.e(44).then(r.bind(null,869)).then((({populateOperationalLayers:t})=>{const r=[],o=e.operationalLayers;o&&o.length&&r.push(t(this.layers,o,n));const i={...n,context:{...n.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},a=e.tables;return a&&a.length&&r.push(t(this.tables,a,i)),Object(b.j)(r).then((()=>{}))}))}async _computeInitialViewpoint(){var e,t;let r=this.initialViewProperties;if(null==(e=r)||null==(t=e.viewpoint)?void 0:t.targetGeometry)return;const n=await this._getExtentFromItem();n&&(r=r?r.clone():new qe,r.viewpoint=new T.a,r.viewpoint.targetGeometry=n,this.initialViewProperties=r)}async _getExtentFromItem(){var e,t;const n=null==(e=this.initialViewProperties)?void 0:e.spatialReference,o=null==(t=this.portalItem)?void 0:t.extent;return n&&o?n.isWGS84?o.clone():n.isWebMercator?Object(g.b)(o):(await r.e(30).then(r.bind(null,1076))).create(this.portalItem).then((e=>{const t=new G.a;return t.geometries=[o],t.outSpatialReference=n,e.project(t)})).then((e=>e[0])).catch((e=>($e.error("Error projecting item's extent:",e),null))):null}_removeDanglingLayerRefs(){const e=this.applicationProperties,t=e&&e.viewing&&e.viewing.search,r=e=>!!this.allLayers.find((t=>t.id===e));t&&t.layers&&(t.layers=t.layers.filter((e=>r(e.id)))),t&&t.tables&&(t.tables=t.tables.filter((e=>!!this.tables.find((t=>t.id===e.id)))));const n=e&&e.editing&&e.editing.locationTracking;n&&n.info&&!r(n.info.layerId)&&(e.editing=null);const o=this.presentation&&this.presentation.slides;o&&o.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>r(e.id))))}))}_validateMap(){if(!this.basemap||!this.basemap.baseLayers.length)throw new d.a("webmap:save","Map does not have a valid basemap with a base layer.")}_validateItem(){if(!this.portalItem)throw $e.error("save: requires the portalItem property to be set"),new d.a("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem)}_validateItemType(e){if(e.type!==Ye)throw new d.a("webmap:portal-item-wrong-type",`Portal item needs to have type "${Ye}"`)}_loadLayerContainers(){const e=[];return this.basemap&&e.push(this.basemap.load()),this.ground&&e.push(this.ground.load()),Object(b.j)(e).then((()=>{}))}async _beforeSave(){const e=[];for(const t of this.allLayers)if("beforeSave"in t&&"function"==typeof t.beforeSave){const r=t.beforeSave();r&&e.push(r)}await Object(b.j)(e)}_loadAllLayers(){const e=this._getAllLayersAndTables().map((e=>e.load()));return Object(b.j)(e).then((()=>{}))}_getAllLayersAndTables(){return this.allLayers.concat(this.allTables)}_validateJSONForWriting(e,t){let r=e.messages.filter((e=>"error"===e.type)).map((e=>new d.a(e.name,e.message,e.details)));if(t.ignoreUnsupported&&(r=r.filter((e=>"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name))),r.length>0)throw new d.a("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:r})}async _updateItemProperties(e){e.extent=await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry),await this._updateTypeKeywords(e)}async _updateItemPropertiesForSaveAs(e){Object(N.c)(e,Ze),Object(N.c)(e,tt),Object(N.c)(e,nt),Object(N.c)(e,ot),Object(N.c)(e,it),Object(N.c)(e,"Offline Map Areas"),Object(N.c)(e,"FieldMapsDisabled"),await this._updateItemProperties(e)}async _getWGS84Extent(e){const t=e.clone().normalize();let r;if(t.length>1)for(const n of t)r?n.width>r.width&&(r=n):r=n;else r=t[0];return this._projectToWGS84(r)}async _projectToWGS84(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return Object(g.e)(e);const n=await r.e(30).then(r.bind(null,1076)),o=await n.create(this.portalItem),i=new G.a;return i.geometries=[e],i.outSpatialReference=m.a.WGS84,(await o.project(i))[0]}async _updateTypeKeywords(e){Object(N.a)(e,Ke),await this._loadAllLayers(),this._evalCollectorKeyword(e),this._evalDataEditingKeyword(e),this._evalOfflineKeyword(e),this._evalDeveloperBasemapKeyword(e),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}_evalCollectorKeyword(e){Object(N.b)(e,Ze)||Object(N.b)(e,nt)||Object(N.b)(e,ot)||Object(N.b)(e,it)||!this._hasEditableFeatureLayer()?Object(N.c)(e,Qe):Object(N.a)(e,Qe)}_evalDataEditingKeyword(e){this._hasEditableFeatureLayer()?Object(N.a)(e,et):Object(N.c)(e,et)}_evalOfflineKeyword(e){!Object(N.b)(e,tt)&&this._isOfflineCapableMap()?Object(N.a)(e,rt):Object(N.c)(e,rt)}_evalDeveloperBasemapKeyword(e){Object(E.f)(this.basemap)?Object(N.a)(e,at):Object(N.c)(e,at)}_hasEditableFeatureLayer(){return this._getAllLayersAndTables().some((e=>e.loaded&&this._isFeatureServiceLayer(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled))}_isFeatureServiceLayer(e){return!("feature"!==e.type||!e.source||"feature-layer"!==e.source.type)}_isOfflineCapableMap(){return this._getAllLayersAndTables().filter((e=>"group"!==e.type)).every((e=>e.loaded&&this._isOfflineCapableLayer(e)))}_isOfflineCapableLayer(e){return this._isFeatureServiceLayer(e)&&e.capabilities.operations.supportsSync||("tile"===e.type||"vector-tile"===e.type)&&(e.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(e)||Object(E.g)(e))&&e.spatialReference.equals(this.initialViewProperties.spatialReference)}_isExportableAGOLTileLayer(e){return"tile"===e.type&&Object(C.d)(e.url)&&st.some((t=>e.url.toLowerCase().indexOf("/"+t+"/")>-1))}async _updateItem(e,t,r){await e.update({data:t}),this._syncUpInstanceWithItem(e,t,r)}async _createItem(e,t,r,n){const o=this.portalItem,i=!!(o&&o.id&&o.portal.user),a=e.portal;if(await a._signIn(),!await this._canCopyItem(o,i,a))throw new d.a("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");await a.user.addItem({item:e,folder:n.folder,data:t}),this.portalItem=e,this._syncUpInstanceWithItem(e,t,r)}async _canCopyItem(e,t,r){return!(Object(o.k)(e)&&e.id&&e.typeKeywords&&e.typeKeywords.indexOf("useOnly")>-1)||e.portal.portalHostname===r.portalHostname&&(t||await e.reload(),"admin"===e.itemControl||"update"===e.itemControl)}_syncUpInstanceWithItem(e,t,r){x.b.prototype.read.call(this,{version:t.version,authoringApp:t.authoringApp,authoringAppVersion:t.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:e.itemUrl&&Object(p.J)(e.itemUrl)}),Object(M.a)(r),this.resourceInfo=t}async _updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}_getPortalItem(e){let t=k.default.from(e);return t.id&&(t=t.clone(),t.id=null),t.type||(t.type=Ye),t.portal||(t.portal=j.a.getDefault()),this._validateItemType(t),t}async _updateFromInternal(e,t){t=t||{},await Object(A.l)(e,"ready"),this._updateInitialViewProperties(e,t),await this._updateThumbnailUrl(e,t)}_updateInitialViewProperties(e,t){var r;if(t.backgroundExcluded||(this.initialViewProperties.background=null==(r=e.background)?void 0:r.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),t.viewpointExcluded||(this.initialViewProperties.viewpoint=new T.a({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded)for(const n of e.persistableViewModels)n.updateWebDocument(this)}_getViewExtent(e){const t=e.center.clone().normalize(),r=e.extent.clone(),n=r.width/2;return r.xmin=t.x-n,r.xmax=t.x+n,r}async _updateThumbnailUrl(e,t){if(t.thumbnailExcluded)return;const r=function(e,t){t=t||ue;let{width:r,height:n}=t;const o=r/n;return o<de?n=r/de:o>de&&(r=n*de),r>e.width&&(n*=e.width/r,r=e.width),n>e.height&&(r*=e.height/n,n=e.height),{width:Math.round(r),height:Math.round(n)}}(e,t.thumbnailSize),n=await e.takeScreenshot({format:"png",width:r.width,height:r.height});this._setAutoGeneratedThumbnail(n.dataUrl)}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if(Object(p.u)(e)){const t=Object(p.i)(e),r=t&&t.mediaType,n=r&&Xe.get(r.toLowerCase())||null,o=`thumbnail${Date.now()}`;return n?`${o}.${n}`:o}return null}_getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:Object(p.d)(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}_restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(e){const t=e;if(!t)throw new d.a("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:t})}};lt.VERSION=Je,Object(n.a)([Object(s.b)({type:Le,json:{write:!0}})],lt.prototype,"applicationProperties",void 0),Object(n.a)([Object(s.b)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],lt.prototype,"authoringApp",null),Object(n.a)([Object(u.a)("authoringApp")],lt.prototype,"writeAuthoringApp",null),Object(n.a)([Object(s.b)({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],lt.prototype,"authoringAppVersion",null),Object(n.a)([Object(u.a)("authoringAppVersion")],lt.prototype,"writeAuthoringAppVersion",null),Object(n.a)([Object(s.b)({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],lt.prototype,"basemap",void 0),Object(n.a)([Object(s.b)({type:He,json:{write:{overridePolicy:e=>({enabled:!!(e&&e.length>0),ignoreOrigin:!0})}}})],lt.prototype,"bookmarks",void 0),Object(n.a)([Object(s.b)({type:q,json:{read:{source:"mapFloorInfo"},write:{target:"mapFloorInfo"}}})],lt.prototype,"floorInfo",void 0),Object(n.a)([Object(s.b)({type:qe,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:Ue.a},"initialState.viewpoint":{type:T.a},mapRangeInfo:{type:H},spatialReference:{type:m.a}}}}})],lt.prototype,"initialViewProperties",void 0),Object(n.a)([Object(l.a)("initialViewProperties")],lt.prototype,"readInitialViewProperties",null),Object(n.a)([Object(u.a)("initialViewProperties")],lt.prototype,"writeInitialViewProperties",null),Object(n.a)([Object(s.b)({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],lt.prototype,"layers",void 0),Object(n.a)([Object(u.a)("layers")],lt.prototype,"writeLayers",null),Object(n.a)([Object(s.b)({type:k.default})],lt.prototype,"portalItem",void 0),Object(n.a)([Object(s.b)({json:{write:!0}})],lt.prototype,"presentation",void 0),Object(n.a)([Object(s.b)()],lt.prototype,"resourceInfo",void 0),Object(n.a)([Object(s.b)({readOnly:!0,type:ze,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],lt.prototype,"sourceVersion",void 0),Object(n.a)([Object(l.a)("sourceVersion")],lt.prototype,"readSourceVersion",null),Object(n.a)([Object(u.a)("sourceVersion")],lt.prototype,"writeSourceVersion",null),Object(n.a)([Object(s.b)({json:{read:!1,write:{ignoreOrigin:!0}}})],lt.prototype,"tables",void 0),Object(n.a)([Object(u.a)("tables")],lt.prototype,"writeTables",null),Object(n.a)([Object(s.b)()],lt.prototype,"thumbnailUrl",null),Object(n.a)([Object(s.b)({type:ce,json:{write:!0}})],lt.prototype,"widgets",void 0),lt=Object(n.a)([Object(c.a)("esri.WebMap")],lt);var ct=lt;t.a=ct},108:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return S})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return O})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return w})),r.d(t,"i",(function(){return c})),r.d(t,"j",(function(){return a})),r.d(t,"k",(function(){return f})),r.d(t,"l",(function(){return j})),r.d(t,"m",(function(){return B})),r.d(t,"n",(function(){return b})),r.d(t,"o",(function(){return i})),r.d(t,"p",(function(){return T})),r.d(t,"q",(function(){return v})),r.d(t,"r",(function(){return m})),r.d(t,"s",(function(){return g})),r.d(t,"t",(function(){return k})),r.d(t,"u",(function(){return x})),r.d(t,"v",(function(){return s})),r.d(t,"w",(function(){return _})),r.d(t,"x",(function(){return D})),r.d(t,"y",(function(){return N})),r.d(t,"z",(function(){return C}));var n=r(101),o=r(179);function i(e){const t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function l(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function c(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function u(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function d(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function p(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function h(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function b(e,t){const r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(r*r+n*n+o*o)}function f(e,t){const r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return r*r+n*n+o*o}function m(e){const t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function g(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function v(e,t){const r=t[0],n=t[1],o=t[2];let i=r*r+n*n+o*o;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e}function y(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function O(e,t,r){const n=t[0],o=t[1],i=t[2],a=r[0],s=r[1],l=r[2];return e[0]=o*l-i*s,e[1]=i*a-n*l,e[2]=n*s-o*a,e}function w(e,t,r,n){const o=t[0],i=t[1],a=t[2];return e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a),e}function j(e,t,r){const n=t[0],o=t[1],i=t[2];return e[0]=r[0]*n+r[4]*o+r[8]*i+r[12],e[1]=r[1]*n+r[5]*o+r[9]*i+r[13],e[2]=r[2]*n+r[6]*o+r[10]*i+r[14],e}function _(e,t,r){const n=t[0],o=t[1],i=t[2];return e[0]=n*r[0]+o*r[3]+i*r[6],e[1]=n*r[1]+o*r[4]+i*r[7],e[2]=n*r[2]+o*r[5]+i*r[8],e}function k(e,t,r){const n=r[0],o=r[1],i=r[2],a=r[3],s=t[0],l=t[1],c=t[2];let u=o*c-i*l,d=i*s-n*c,p=n*l-o*s,h=o*p-i*d,b=i*u-n*p,f=n*d-o*u;const m=2*a;return u*=m,d*=m,p*=m,h*=2,b*=2,f*=2,e[0]=s+u+h,e[1]=l+d+b,e[2]=c+p+f,e}function S(e,t,r,n){const o=[],i=[];return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],i[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),i[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),i[2]=o[2],e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}const E=Object(n.e)(),I=Object(n.e)();function T(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}const x=c,A=u,M=d,C=b,N=f,B=i,D=m;Object.freeze({__proto__:null,length:i,copy:a,set:s,add:l,subtract:c,multiply:u,divide:d,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},min:function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},max:function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},scale:p,scaleAndAdd:h,distance:b,squaredDistance:f,squaredLength:m,negate:g,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},normalize:v,dot:y,cross:O,lerp:w,hermite:function(e,t,r,n,o,i){const a=i*i,s=a*(2*i-3)+1,l=a*(i-2)+i,c=a*(i-1),u=a*(3-2*i);return e[0]=t[0]*s+r[0]*l+n[0]*c+o[0]*u,e[1]=t[1]*s+r[1]*l+n[1]*c+o[1]*u,e[2]=t[2]*s+r[2]*l+n[2]*c+o[2]*u,e},bezier:function(e,t,r,n,o,i){const a=1-i,s=a*a,l=i*i,c=s*a,u=3*i*s,d=3*l*a,p=l*i;return e[0]=t[0]*c+r[0]*u+n[0]*d+o[0]*p,e[1]=t[1]*c+r[1]*u+n[1]*d+o[1]*p,e[2]=t[2]*c+r[2]*u+n[2]*d+o[2]*p,e},random:function(e,t){t=t||1;const r=2*Object(o.b)()*Math.PI,n=2*Object(o.b)()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e},transformMat4:j,transformMat3:_,transformQuat:k,rotateX:function(e,t,r,n){const o=[],i=[];return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],i[0]=o[0],i[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),i[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e},rotateY:function(e,t,r,n){const o=[],i=[];return o[0]=t[0]-r[0],o[1]=t[1]-r[1],o[2]=t[2]-r[2],i[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),i[1]=o[1],i[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e},rotateZ:S,angle:function(e,t){a(E,e),a(I,t),v(E,E),v(I,I);const r=y(E,I);return r>1?0:r<-1?Math.PI:Math.acos(r)},str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},exactEquals:T,equals:function(e,t){const r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],l=t[2];return Math.abs(r-a)<=o.a*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=o.a*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=o.a*Math.max(1,Math.abs(i),Math.abs(l))},sub:x,mul:A,div:M,dist:C,sqrDist:N,len:B,sqrLen:D})},1109:function(e,t,r){"use strict";var n=r(80),o=(r(78),r(79)),i=r(83),a=r(141),s=r(119),l=r(286),c=r(82),u=(r(81),r(84),r(85),r(184)),d=r(115),p=r(109),h=r(809),b=(r(111),r(165)),f=r(299),m=r(127),g=r(151),v=r(947),y=(r(86),r(94));let O=class extends y.a{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};Object(n.a)([Object(i.b)()],O.prototype,"bookmark",void 0),Object(n.a)([Object(i.b)({readOnly:!0})],O.prototype,"editedBookmark",null),Object(n.a)([Object(i.b)()],O.prototype,"state",null),Object(n.a)([Object(i.b)()],O.prototype,"validationState",void 0),Object(n.a)([Object(i.b)()],O.prototype,"loading",void 0),O=Object(n.a)([Object(c.a)("esri.widgets.Bookmarks.UserState")],O);var w=O,j=r(89),_=r(123),k=r(106),S=r(506),E=r(881),I=r(498);const T="esri.widgets.Bookmarks.BookmarksViewModel",x=o.a.getLogger(T),A=k.a.ofType(E.a),M={width:128,height:128,format:"png"},C={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0};let N=class extends(Object(I.a)(_.a.EventedAccessor)){constructor(e){super(e),this.activeBookmark=null}destroy(){this.view=null,this._set("activeBookmark",null)}set bookmarks(e){void 0!==e?this._override("bookmarks",e):this._clearOverride("bookmarks")}get bookmarks(){return this.get("view.map.bookmarks")||new A}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...C,...e})}get defaultCreateOptions(){return C}set defaultEditOptions(e){this._set("defaultEditOptions",{...C,...e})}get defaultEditOptions(){return C}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}get view(){return this._get("view")}set view(e){e&&"2d"!==e.type&&x.error(new j.a("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e)}async createBookmark(e){const{view:t,defaultCreateOptions:r}=this;if(!t){const e=new j.a("create-bookmark:invalid-view","Cannot create a bookmark without a view.");return x.error(e),Promise.reject(e)}const{takeScreenshot:n,screenshotSettings:o,captureExtent:i,captureViewpoint:a,captureRotation:s,captureScale:l}={...r,...e},c=n?await this._createThumbnail(o):void 0;return new E.a({...c&&{thumbnail:c},...(a||i)&&{viewpoint:this._createViewpoint({view:t,captureScale:l,captureRotation:s})}})}async editBookmark(e,t){const{view:r,defaultEditOptions:n}=this;if(!r){const e=new j.a("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");return x.error(e),Promise.reject(e)}const{takeScreenshot:o,screenshotSettings:i,captureExtent:a,captureViewpoint:s,captureRotation:l,captureScale:c}={...n,...t},u=o?await this._createThumbnail(i):void 0;return u&&(e.thumbnail=u),(s||a)&&(e.viewpoint=this._createViewpoint({view:r,captureScale:c,captureRotation:l})),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{view:t}=this;if(!t){const e=new j.a("go-to:invalid-view","Cannot go to a bookmark without a view");return x.error(e),Promise.reject(e)}const r=null==e?void 0:e.viewpoint;if(!r){const t=new j.a("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});return x.error(t),Promise.reject(t)}this._set("activeBookmark",e);const n={target:r},o=this.callGoTo(n);return this.emit("select-bookmark",{bookmark:e}),this.emit("bookmark-select",{bookmark:e}),o.catch((()=>{})).then((()=>this._set("activeBookmark",null))),o}async _createThumbnail(e){const t=await this.view.takeScreenshot({...M,...e});return new h.a({url:t.dataUrl})}_createViewpoint({view:e,captureRotation:t,captureScale:r}){var n,o;const i=null==(n=e.viewpoint)?void 0:n.clone();return new S.a({targetGeometry:null==(o=e.extent)?void 0:o.clone(),rotation:t&&(null==i?void 0:i.rotation)||0,scale:r&&(null==i?void 0:i.scale)||0})}};Object(n.a)([Object(i.b)({readOnly:!0})],N.prototype,"activeBookmark",void 0),Object(n.a)([Object(i.b)({type:A})],N.prototype,"bookmarks",null),Object(n.a)([Object(i.b)()],N.prototype,"defaultCreateOptions",null),Object(n.a)([Object(i.b)()],N.prototype,"defaultEditOptions",null),Object(n.a)([Object(i.b)({readOnly:!0})],N.prototype,"state",null),Object(n.a)([Object(i.b)({value:null})],N.prototype,"view",null),N=Object(n.a)([Object(c.a)(T)],N);var B=N,D=r(776),F=r(799);const P="data-bookmark-uid",L="esri-bookmarks esri-widget--panel",R="esri-bookmarks__loader-container",U="esri-bookmarks__loader",V="esri-bookmarks__list",W="esri-bookmarks__list--sortable",q="esri-bookmarks__bookmark",G="esri-bookmarks__bookmark-button",z="esri-bookmarks__bookmark-image-container",J="esri-bookmarks__bookmark-edit-button",Y="esri-bookmarks_bookmark-drag-handle",H="esri-bookmarks_bookmark-drag-handle-icon",$="esri-bookmarks__bookmark-icon",X="esri-bookmarks__image",K="esri-bookmarks__bookmark-name",Z="esri-bookmarks__bookmark--active",Q="esri-widget__content--empty",ee="esri-bookmarks__no-bookmarks-heading",te="esri-widget__no-bookmark-icon",re="esri-bookmarks__no-bookmarks-description",ne="esri-bookmarks__adding-bookmark",oe="esri-bookmarks__add-bookmark",ie="esri-bookmarks__add-bookmark-button",ae="esri-bookmarks__add-bookmark-icon",se="esri-bookmarks__authoring-card",le="esri-bookmarks__authoring-container",ce="esri-bookmarks__authoring-form",ue="esri-bookmarks__authoring-label",de="esri-bookmarks__authoring-actions",pe="esri-bookmarks__authoring-input--invalid",he="esri-bookmarks__authoring-delete-button",be="esri-bookmarks__authoring-cancel-button",fe="esri-widget",me="esri-widget--disabled",ge="esri-button",ve="esri-button--tertiary",ye="esri-input",Oe="esri-icon-handle-vertical",we="esri-icon-plus",je="esri-icon-edit",_e="esri-icon-handle-horizontal",ke="esri-icon-refresh",Se="esri-icon-link",Ee="esri-icon-erase",Ie="esri-icon-bookmark",Te="esri-widget__heading",xe="esri-icon-loading-indicator",Ae="esri-rotating",Me={addBookmark:!0,thumbnail:!0},Ce=/^https:\/\/.*/i,Ne="esri.widgets.Bookmarks",Be=o.a.getLogger(Ne);let De=class extends g.a{constructor(e,t){super(e,t),this._handles=new d.a,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._userState=null,this.defaultCreateOptions=null,this.defaultEditOptions=null,this.bookmarks=null,this.disabled=!1,this.editingEnabled=!1,this.goToOverride=null,this.iconClass=Ie,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.view=null,this.viewModel=new B,this.visibleElements={...Me}}initialize(){this.own([Object(p.a)(this,"viewModel.bookmarks",(()=>this._bookmarksInitialized())),Object(p.a)(this,"editingEnabled",(()=>this._toggleSorting()))])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}get _editMenuItems(){var e,t;const{messages:r,_userState:n}=this,o=null==n||null==(e=n.editedBookmark)||null==(t=e.thumbnail)?void 0:t.url;return[new D.a({label:null==r?void 0:r.menu.refreshThumbnail,iconClass:ke,clickFunction:()=>this._refreshThumbnail()}),new D.a({label:Ce.test(o)?null==r?void 0:r.menu.editImageUrl:null==r?void 0:r.menu.useImageUrl,iconClass:Se,clickFunction:()=>this._startUseImageUrl()}),o?new D.a({label:null==r?void 0:r.menu.removeThumbnail,iconClass:Ee,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t}=this,r=this._get("_editMenu");r&&r.destroy();const n=new F.a({iconClass:_e,label:null==t?void 0:t.menu.label});return n.items=e,n}get bookmarkCreationOptions(){return Object(l.c)(Be,"bookmarkCreationOptions",{replacement:"defaultCreateOptions",version:"4.18"}),this.viewModel.defaultCreateOptions}set bookmarkCreationOptions(e){void 0!==e.captureExtent&&Object(l.c)(Be,"bookmarkCreationOptions.captureExtent",{replacement:"defaultCreateOptions.captureViewpoint",version:"4.17"}),Object(l.c)(Be,"bookmarkCreationOptions",{replacement:"defaultCreateOptions",version:"4.18"}),this.viewModel.defaultCreateOptions=e}castVisibleElements(e){return{...Me,...e}}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t="loading"===e?this.renderLoading():this.renderBookmarks();return Object(m.a)("div",{class:this.classes(L,fe,{[me]:this.disabled})},t)}startAddBookmark(){this._userState=new w({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return Object(m.a)("div",{class:R,key:"loader"},Object(m.a)("div",{class:U}))}renderNoBookmarksContainer(){const{messages:e}=this;return Object(m.a)("div",{class:Q,key:"no-bookmarks"},Object(m.a)("span",{"aria-hidden":"true",class:this.classes(te,Ie)}),Object(m.a)("h1",{class:this.classes(Te,ee)},null==e?void 0:e.noBookmarksHeading),Object(m.a)("p",{class:re},null==e?void 0:e.noBookmarksDescription))}renderAddBookmarkLoading(){var e;return Object(m.a)("div",{key:"adding-bookmark",class:ne},Object(m.a)("span",{"aria-hidden":"true",class:this.classes(xe,Ae)}),null==(e=this.messages)?void 0:e.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:r}=this;return e.map((e=>r&&e&&t&&("edit"===t.state||"edit-thumbnail"===t.state)&&t.bookmark===e?"edit-thumbnail"===t.state?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(e))).toArray()}renderBookmarksContainer(e){var t;const{_userState:r,editingEnabled:n}=this,o="add"===(null==r?void 0:r.state),i=n&&!o?this.renderAddBookmarkButton():null,a=n?o&&r.loading?this.renderAddBookmarkLoading():"add"===(null==r?void 0:r.state)?this.renderAddingBookmark():null:null;return[Object(m.a)("ul",{key:"bookmark-list","aria-label":null==(t=this.messages)?void 0:t.widgetLabel,class:this.classes(V,{[W]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this},this.renderBookmarkItems(e)),i,a]}renderAddBookmarkButton(){var e;return this.visibleElements.addBookmark?Object(m.a)("div",{key:"add-bookmark-item",class:oe},Object(m.a)("button",{class:this.classes(ge,ve,ie),onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},Object(m.a)("span",{"aria-hidden":"true",class:this.classes(ae,we)}),null==(e=this.messages)?void 0:e.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),r=t&&t.length,n=r||this.editingEnabled?this.renderBookmarksContainer(t):null;return[r?null:this.renderNoBookmarksContainer(),n]}renderEditContainer(e){const{messagesCommon:t}=this;return Object(m.a)("div",{key:"edit-container"},Object(m.a)("button",{title:null==t?void 0:t.edit,"aria-label":null==t?void 0:t.edit,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:J,type:"button"},Object(m.a)("span",{"aria-hidden":"true",class:je})))}renderDragHandle(e){const{messagesCommon:t}=this,r={[P]:e.uid};return Object(m.a)("div",Object.assign({role:"button",tabIndex:0,key:"drag-handle",bind:this,class:Y,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":null==t?void 0:t.dragHandleLabel,title:null==t?void 0:t.dragHandleTitle},r),Object(m.a)("span",{"aria-hidden":"true",class:this.classes(H,Oe)}))}renderBookmarkImageIcon(){return Object(m.a)("span",{"aria-hidden":"true",class:this.classes($,Ie)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:r}=e,n=r&&r.url||"";return t.thumbnail&&n?Object(m.a)("img",{src:n,alt:"",class:X}):null}renderBookmarkButton(e){const{messagesCommon:t}=this,{name:r}=e,n=r||(null==t?void 0:t.untitled),o=Object(m.a)("div",{class:z},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon());return Object(m.a)("button",{key:"bookmark-button",class:G,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},o,Object(m.a)("span",{class:K},n))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,r={[Z]:t===e},n=this.editingEnabled?this.renderEditContainer(e):null,o={[P]:e.uid},i=this.editingEnabled?this.renderDragHandle(e):null;return Object(m.a)("li",Object.assign({key:e,class:this.classes(q,r)},o),i,this.renderBookmarkButton(e),n)}renderEditingBookmarkName(e){const{messages:t,_userState:r}=this,n="name-required"===r.validationState;return Object(m.a)("label",{class:ue},null==t?void 0:t.title,n?Object(m.a)("strong",null,null==t?void 0:t.invalidTitle):null,Object(m.a)("input",{required:!0,bind:this,class:this.classes(ye,n?pe:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:null==t?void 0:t.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e}=this;return Object(m.a)("div",{class:de},Object(m.a)("input",{type:"button",value:null==e?void 0:e.back,class:this.classes(ge,ve),onclick:this._closeUrlEditBookmarkForm,bind:this}),Object(m.a)("input",{class:ge,type:"submit",value:null==e?void 0:e.add}))}renderEditingBookmarkActions(){const{messagesCommon:e}=this,{bookmark:t}=this._userState;return Object(m.a)("div",{class:de},Object(m.a)("input",{type:"button",value:null==e?void 0:e.delete,class:this.classes(ge,ve,he),"data-bookmark":t,onclick:this._deleteBookmark,bind:this}),Object(m.a)("input",{type:"button",value:null==e?void 0:e.cancel,class:this.classes(ge,ve),onclick:this._closeEditBookmarkForm,bind:this}),Object(m.a)("input",{class:ge,type:"submit",value:null==e?void 0:e.save}))}renderEditingBookmarkUrlInput(e){var t;const{messages:r,_userState:n}=this,o=null==(t=e.thumbnail)?void 0:t.url,i=Ce.test(o)?o:null,a="absolute-url-required"===n.validationState;return Object(m.a)("label",{class:ue},a?Object(m.a)("strong",null,null==r?void 0:r.invalidImageUrl):null,Object(m.a)("input",{required:!0,bind:this,class:this.classes(ye,a?pe:null),type:"text",value:i,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:null==r?void 0:r.imageUrlTooltip,placeholder:null==r?void 0:r.imageUrlPlaceholder}))}renderEditingBookmarkUrl(e){const t={[P]:e.uid};return Object(m.a)("li",Object.assign({key:"edit-bookmark-url-form",class:se},t),Object(m.a)("form",{class:ce,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[P]:e.uid};return Object(m.a)("li",Object.assign({key:"edit-bookmark-form",class:se},t),Object(m.a)("form",{class:ce,onsubmit:this._editBookmarkSubmit,bind:this},Object(m.a)("div",{class:le},Object(m.a)("div",{class:z},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t}=this,r="name-required"===e.validationState;return Object(m.a)("label",{class:ue},null==t?void 0:t.title,r?Object(m.a)("strong",null,null==t?void 0:t.invalidTitle):null,Object(m.a)("input",{required:!0,bind:this,class:this.classes(ye,r?pe:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:null==t?void 0:t.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e}=this;return Object(m.a)("div",{class:this.classes(de)},Object(m.a)("input",{type:"button",value:null==e?void 0:e.cancel,class:this.classes(ge,ve,be),onclick:this._endAddBookmark.bind(this),bind:this}),Object(m.a)("input",{class:ge,type:"submit",value:null==e?void 0:e.add}))}renderAddingBookmark(){return Object(m.a)("div",{key:"add-bookmark-form",class:se},Object(m.a)("form",{class:ce,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,r=Object(u.a)(e);if(-1===["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].indexOf(r))return;const{_sortable:n,_selectedSortUid:o}=this,i=n.toArray(),a=e.target.getAttribute(P),s=i.indexOf(a);if(" "===r||"Enter"===r){const e=o&&o===a;return this._selectedSortUid=e?null:a,this._sortableSavedItems=e?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===r)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===r&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,n,a),void this.scheduleRender();if(-1===s||!o)return;const l="ArrowUp"===r?s-1:s+1;l>=i.length||l<=-1||(function(e,t,r){e.splice(r,0,e.splice(t,1)[0])}(i,s,l),this._updateSortItems(i,n,a))}_updateSortItems(e,t,r){t.sort(e),this._sortBookmarks(t),this._focusSortUid=r,this._selectedSortUid=r}_focusDragHandle(e){const{_focusSortUid:t}=this;e&&t&&e.getAttribute(P)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:r}=this;if(t)if(e)e.option("disabled",!r);else{const e=v.a.create(t,{dataIdAttr:P,handle:`.${Y}`,group:"bookmarks",disabled:!r,onSort:()=>this._sortBookmarks(e)});this._sortable=e}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const r=e.toArray();t.sort(((e,t)=>{const n=r.indexOf(e.uid),o=r.indexOf(t.uid);return n>o?1:n<o?-1:0}))}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add(Object(p.b)(this,"viewModel.bookmarks","change",(()=>this._bookmarksChanged())),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:r}=this;r.remove(e);const n=t.map((e=>Object(p.d)(e,["active","name","thumbnail.url"],(()=>this.scheduleRender()))));r.add(n,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._focusEditInputBox=!0,this._userState=new w({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:r}=this,n=t&&t.value.trim();n?(r.loading=!0,this.viewModel.createBookmark().then((e=>{e.name=n,this.viewModel.bookmarks.add(e),this._endAddBookmark()}))):r.validationState="name-required"}async _editBookmarkAndClose(e,t){await this.viewModel.editBookmark(e,t),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:r}=this,n=t&&t.value.trim();n?(r.bookmark.name=n,r.bookmark.thumbnail=r.editedBookmark.thumbnail,this._editBookmarkAndClose(r.bookmark,{takeScreenshot:!1})):r.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:r}=this;e.validationState=void 0,await r.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureExtent:!1,captureViewpoint:!1,captureRotation:!1,captureScale:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:r}=this,n=t.value;Ce.test(n)?(n&&(r.editedBookmark.thumbnail=new h.a({url:n})),this._closeUrlEditBookmarkForm()):r.validationState="absolute-url-required"}};Object(n.a)([Object(i.b)({type:w})],De.prototype,"_userState",void 0),Object(n.a)([Object(i.b)({readOnly:!0})],De.prototype,"_editMenuItems",null),Object(n.a)([Object(i.b)({readOnly:!0})],De.prototype,"_editMenu",null),Object(n.a)([Object(i.b)()],De.prototype,"bookmarkCreationOptions",null),Object(n.a)([Object(a.a)("viewModel.defaultCreateOptions")],De.prototype,"defaultCreateOptions",void 0),Object(n.a)([Object(a.a)("viewModel.defaultEditOptions")],De.prototype,"defaultEditOptions",void 0),Object(n.a)([Object(a.a)("viewModel.bookmarks")],De.prototype,"bookmarks",void 0),Object(n.a)([Object(i.b)()],De.prototype,"disabled",void 0),Object(n.a)([Object(i.b)()],De.prototype,"editingEnabled",void 0),Object(n.a)([Object(a.a)("viewModel.goToOverride")],De.prototype,"goToOverride",void 0),Object(n.a)([Object(i.b)()],De.prototype,"iconClass",void 0),Object(n.a)([Object(i.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],De.prototype,"label",void 0),Object(n.a)([Object(i.b)(),Object(b.a)("esri/widgets/Bookmarks/t9n/Bookmarks")],De.prototype,"messages",void 0),Object(n.a)([Object(i.b)(),Object(b.a)("esri/t9n/common")],De.prototype,"messagesCommon",void 0),Object(n.a)([Object(i.b)(),Object(b.a)("esri/core/t9n/Units")],De.prototype,"messagesUnits",void 0),Object(n.a)([Object(a.a)("viewModel.view")],De.prototype,"view",void 0),Object(n.a)([Object(i.b)({type:B}),Object(f.a)(["select-bookmark","bookmark-edit","bookmark-select"])],De.prototype,"viewModel",void 0),Object(n.a)([Object(i.b)()],De.prototype,"visibleElements",void 0),Object(n.a)([Object(s.a)("visibleElements")],De.prototype,"castVisibleElements",null),Object(n.a)([Object(i.b)()],De.prototype,"endAddBookmark",null),Object(n.a)([Object(i.b)()],De.prototype,"startAddBookmark",null),De=Object(n.a)([Object(c.a)(Ne)],De);var Fe=De;t.a=Fe},121:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a}));var n=r(90);function o(e,t,r=!1){return l(e,t,r)}function i(e,t){if(null!=t)return t[e]||s(e.split("."),!1,t)}function a(e,t,r){const n=e.split("."),o=n.pop(),i=s(n,!0,r);i&&o&&(i[o]=t)}function s(e,t,r){let n=r;for(const o of e){if(null==n)return;if(!(o in n)){if(!t)return;n[o]={}}n=n[o]}return n}function l(e,t,r){return t?Object.keys(t).reduce((function(e,o){let i=e[o],a=t[o];return i===a?e:void 0===i?(e[o]=Object(n.a)(a),e):(Array.isArray(a)||Array.isArray(e)?(i=i?Array.isArray(i)?e[o]=i.concat():e[o]=[i]:e[o]=[],a&&(Array.isArray(a)||(a=[a]),r?a.forEach((e=>{-1===i.indexOf(e)&&i.push(e)})):e[o]=a.concat())):a&&"object"==typeof a?e[o]=l(i,a,r):e.hasOwnProperty(o)&&!t.hasOwnProperty(o)||(e[o]=a),e)}),e||{}):e}},137:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return c}));var n=r(121);const o=/\{([^\}]+)\}/g;function i(e){return null==e?"":e}function a(e,t){return e.replace(o,"object"==typeof t?(e,r)=>i(Object(n.b)(r,t)):(e,r)=>i(t(r)))}function s(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(e=>t&&-1!==t.indexOf(e)?e:`\\${e}`))}function l(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}function c(e){return(new DOMParser).parseFromString(e||"","text/html").body.innerText||""}},138:function(e,t,r){"use strict";var n=r(152),o=(r(78),r(121));const i={apiKey:void 0,applicationUrl:n.a.location&&n.a.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(n.a.esriConfig&&(Object(o.a)(i,n.a.esriConfig,!0),delete i.has),!i.assetsPath){const e="4.19.0";i.assetsPath=`https://js.arcgis.com/${e.slice(0,-2)}/@arcgis/core/assets`}i.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(i,"baseUrl",{set(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath")}}),i.request.corsEnabledServers=[],i.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0},t.a=i},152:function(e,t,r){"use strict";(function(e){const r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof e?e:void 0;t.a=r}).call(this,r(172))},161:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c}));var n=r(80),o=r(83),i=r(82),a=r(94),s=r(115),l=r(294);const c=e=>{let t=class extends e{destroy(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}get handles(){return this._get("handles")||new s.a}get updatingHandles(){return this._get("updatingHandles")||new l.a}};return Object(n.a)([Object(o.b)({readOnly:!0})],t.prototype,"handles",null),Object(n.a)([Object(o.b)({readOnly:!0})],t.prototype,"updatingHandles",null),t=Object(n.a)([Object(i.a)("esri.core.HandleOwner")],t),t};let u=class extends(c(a.a)){};u=Object(n.a)([Object(i.a)("esri.core.HandleOwner")],u)},164:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(79),r(86),r(83)),a=r(93),s=r(82),l=r(92),c=(r(81),r(84),r(85),r(88)),u=r(167);let d=n=class extends c.a{constructor(e){super(e),this.end=null,this.start=null}static get allTime(){return p}static get empty(){return h}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?e.getTime():null}get isAllTime(){return this.equals(n.allTime)}get isEmpty(){return this.equals(n.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?e.getTime():null}clone(){return new n({end:this.end,start:this.start})}expandTo(e){if(this.isEmpty||this.isAllTime)return this.clone();const t=this.start?Object(u.e)(this.start,e):null,r=this.end?Object(u.c)(Object(u.e)(this.end,e),1,e):null;return new n({start:t,end:r})}intersection(e){var t,r,o,i,a,s,l,c;if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return n.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const u=null!=(t=null==(r=this.start)?void 0:r.getTime())?t:-1/0,d=null!=(o=null==(i=this.end)?void 0:i.getTime())?o:1/0,p=null!=(a=null==(s=e.start)?void 0:s.getTime())?a:-1/0,h=null!=(l=null==(c=e.end)?void 0:c.getTime())?l:1/0;let b,f;if(p>=u&&p<=d?b=p:u>=p&&u<=h&&(b=u),d>=p&&d<=h?f=d:h>=u&&h<=d&&(f=h),!isNaN(b)&&!isNaN(f)){const e=new n;return e.start=b===-1/0?null:new Date(b),e.end=f===1/0?null:new Date(f),e}return n.empty}offset(e,t){if(this.isEmpty||this.isAllTime)return this.clone();const r=new n,{start:o,end:i}=this;return o&&(r.start=Object(u.c)(o,e,t)),i&&(r.end=Object(u.c)(i,e,t)),r}equals(e){if(!e)return!1;const t=this.start?this.start.getTime():this.start,r=this.end?this.end.getTime():this.end,n=e.start?e.start.getTime():e.start,o=e.end?e.end.getTime():e.end;return t===n&&r===o}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return p.clone();const t=this.start&&e.start?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end&&e.end?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new n({start:t,end:r})}};Object(o.a)([Object(i.b)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0),Object(o.a)([Object(a.a)("end")],d.prototype,"readEnd",null),Object(o.a)([Object(l.a)("end")],d.prototype,"writeEnd",null),Object(o.a)([Object(i.b)({readOnly:!0,json:{read:!1}})],d.prototype,"isAllTime",null),Object(o.a)([Object(i.b)({readOnly:!0,json:{read:!1}})],d.prototype,"isEmpty",null),Object(o.a)([Object(i.b)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0),Object(o.a)([Object(a.a)("start")],d.prototype,"readStart",null),Object(o.a)([Object(l.a)("start")],d.prototype,"writeStart",null),d=n=Object(o.a)([Object(s.a)("esri.TimeExtent")],d);const p=new d,h=new d({start:void 0,end:void 0});var b=d;t.a=b},167:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return a})),r.d(t,"e",(function(){return c}));r(78);var n=r(97);function o(e){return e}const i={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}},a=Object(n.b)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});function s(e,t,r){const n=new Date(e.getTime());if(t&&r){const e=i[r],{getter:o,setter:a,multiplier:s}=e;n[a](n[o]()+t*s)}return n}const l={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function c(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return null}}},172:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(n){"object"===typeof window&&(r=window)}e.exports=r},175:function(e,t,r){"use strict";var n=r(80),o=(r(78),r(138)),i=r(79),a=(r(86),r(83)),s=r(82),l=r(89),c=r(81),u=(r(84),r(85),r(91)),d=r(95),p=r(99),h=(r(98),r(123)),b=r(205),f=r(100),m=r(157);let g=0;const v=i.a.getLogger("esri.layers.Layer");let y=class extends(h.a.EventedMixin(Object(b.a)(m.a))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new p.a(-180,-90,180,90,d.a.WGS84),this.id=Date.now().toString(16)+"-layer-"+g++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=d.a.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(e){const t="string"==typeof e?{url:e}:e,n=await r.e(185).then(r.bind(null,362));try{return await n.fromUrl(t)}catch(o){throw v.error("#fromArcGISServerUrl({ url: '"+t.url+"'})","Failed to create layer from arcgis server url",o),o}}static async fromPortalItem(e){const t="portalItem"in e?e:{portalItem:e},n=await r.e(186).then(r.bind(null,341));try{return await n.fromItem(t)}catch(i){const e=t&&t.portalItem,r=e&&e.id||"unset",n=e&&e.portal&&e.portal.url||o.a.portalUrl;throw v.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+n+"', id: '"+r+"')",i),i}}initialize(){this.when().catch((e=>{var t,r;Object(u.m)(e)||i.a.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${null!=(t=this.title)?t:"no title"}', id: '${null!=(r=this.id)?r:"no id"}')`,{error:e})}))}destroy(){if(this.parent){const e=this,t=this.parent;"layers"in t&&t.layers.includes(e)?t.layers.remove(e):"tables"in t&&t.tables.includes(e)?t.tables.remove(e):"baseLayers"in t&&t.baseLayers.includes(e)?t.baseLayers.remove(e):"baseLayers"in t&&t.referenceLayers.includes(e)&&t.referenceLayers.remove(e)}}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){const e=this.url;return e?Object(c.J)(e):null}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await Object(f.default)(e,{query:{f:"json"},responseType:"json"})).data;throw new l.a("layer:no-attribution-data","Layer does not have attribution data")}};Object(n.a)([Object(a.b)({type:String})],y.prototype,"attributionDataUrl",void 0),Object(n.a)([Object(a.b)({type:p.a})],y.prototype,"fullExtent",void 0),Object(n.a)([Object(a.b)({readOnly:!0})],y.prototype,"hasAttributionData",null),Object(n.a)([Object(a.b)({type:String})],y.prototype,"id",void 0),Object(n.a)([Object(a.b)({type:Boolean,nonNullable:!0})],y.prototype,"legendEnabled",void 0),Object(n.a)([Object(a.b)({type:["show","hide","hide-children"]})],y.prototype,"listMode",void 0),Object(n.a)([Object(a.b)({type:Number,range:{min:0,max:1},nonNullable:!0})],y.prototype,"opacity",void 0),Object(n.a)([Object(a.b)()],y.prototype,"parent",void 0),Object(n.a)([Object(a.b)({readOnly:!0})],y.prototype,"parsedUrl",null),Object(n.a)([Object(a.b)({type:Boolean})],y.prototype,"popupEnabled",void 0),Object(n.a)([Object(a.b)({type:Boolean})],y.prototype,"attributionVisible",void 0),Object(n.a)([Object(a.b)({type:d.a})],y.prototype,"spatialReference",void 0),Object(n.a)([Object(a.b)({type:String})],y.prototype,"title",void 0),Object(n.a)([Object(a.b)({type:String,readOnly:!0,json:{read:!1}})],y.prototype,"type",void 0),Object(n.a)([Object(a.b)()],y.prototype,"url",void 0),Object(n.a)([Object(a.b)({type:Boolean,nonNullable:!0})],y.prototype,"visible",void 0),y=Object(n.a)([Object(s.a)("esri.layers.Layer")],y);var O=y;t.a=O},178:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));r(78);function n(e){}function o(e){return()=>e}},179:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return s}));const n=1e-6,o=Math.random,i=Math.PI/180,a=180/Math.PI;function s(e){return e*i}function l(e){return e*a}Object.freeze({__proto__:null,EPSILON:n,RANDOM:o,toRadian:s,toDegree:l,equals:function(e,t){return Math.abs(e-t)<=n*Math.max(1,Math.abs(e),Math.abs(t))}})},180:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return O}));var n=r(80),o=r(117),i=r(82),a=r(139),s=r(94),l=r(156),c=r(87),u=r(192),d=r(90);class p{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(a.a),this._values=new Map}clone(e){const t=new p,r=this._originStores[0];r&&r.forEach(((e,r)=>{t.set(r,Object(d.a)(e),0)}));for(let n=2;n<a.a;n++){const r=this._originStores[n];r&&r.forEach(((r,o)=>{e&&e.has(o)||t.set(o,Object(d.a)(r),n)}))}return t}get(e,t){const r=void 0===t?this._values:this._originStores[t];return r?r.get(e):void 0}keys(e){const t=null==e?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,r=6){let n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(e,t),!this._values.has(e)||Object(c.d)(this._propertyOriginMap.get(e))<=r){const n=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),n!==t}return!1}delete(e,t=6){const r=this._originStores[t];if(!r)return;const n=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(let r=t-1;r>=0;r--){const t=this._originStores[r];if(t&&t.has(e)){this._values.set(e,t.get(e)),this._propertyOriginMap.set(e,r);break}}}return n}has(e,t){const r=void 0===t?this._values:this._originStores[t];return!!r&&r.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;const r=this._originStores[t],n=r&&r.get(e),o=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,t),o!==n}originOf(e){return this._propertyOriginMap.get(e)||0}forEach(e){this._values.forEach(e)}}var h=p;const b=e=>{let t=class extends e{constructor(...e){super(...e);const t=Object(c.d)(Object(o.a)(this)),r=t.metadatas,n=t.store,i=new h;t.store=i,n.keys().forEach((e=>{i.set(e,n.get(e),0)})),Object.keys(r).forEach((e=>{t.internalGet(e)&&i.set(e,t.internalGet(e),0)}))}read(e,t){Object(u.a)(this,e,t)}getAtOrigin(e,t){const r=f(this),n=Object(a.d)(t);if("string"==typeof e)return r.get(e,n);const o={};return e.forEach((e=>{o[e]=r.get(e,n)})),o}originOf(e){return Object(a.b)(this.originIdOf(e))}originIdOf(e){return f(this).originOf(e)}revert(e,t){const r=f(this),n=Object(a.d)(t),i=Object(o.a)(this);let s;s="string"==typeof e?"*"===e?r.keys(n):[e]:e,s.forEach((e=>{i.propertyInvalidated(e),r.revert(e,n),i.propertyCommitted(e)}))}};return t=Object(n.a)([Object(i.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function f(e){return Object(o.a)(e).store}let m=class extends(b(s.a)){};m=Object(n.a)([Object(i.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],m);const g=e=>{let t=class extends e{constructor(...e){super(...e)}clear(e,t="user"){return v(this).delete(e,Object(a.d)(t))}write(e={},t){return Object(l.b)(this,e=e||{},t),e}setAtOrigin(e,t,r){Object(o.a)(this).setAtOrigin(e,t,Object(a.d)(r))}removeOrigin(e){const t=v(this),r=Object(a.d)(e),n=t.keys(r);for(const o of n)t.originOf(o)===r&&t.set(o,t.get(o,r),6)}updateOrigin(e,t){const r=v(this),n=Object(a.d)(t),o=this.get(e);for(let i=n+1;i<a.a;++i)r.delete(e,i);r.set(e,o,n)}toJSON(e){return this.write({},e)}};return t=Object(n.a)([Object(i.a)("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function v(e){return Object(o.a)(e).store}const y=e=>{let t=class extends(g(b(e))){constructor(...e){super(...e)}};return t=Object(n.a)([Object(i.a)("esri.core.MultiOriginJSONSupport")],t),t};let O=class extends(y(s.a)){};O=Object(n.a)([Object(i.a)("esri.core.MultiOriginJSONSupport")],O)},182:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return p})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return g})),r.d(t,"j",(function(){return b})),r.d(t,"k",(function(){return v}));var n=r(87),o=r(81),i=r(199);const a=["MapServer","ImageServer","FeatureServer","SceneServer","StreamServer","VectorTileServer"],s=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${a.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),l=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${a.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),c=/(.*)\/(\d+)\/?$/i;function u(e){return!!s.test(e)}function d(e){const t=Object(o.J)(e),r=t.path.match(s)||t.path.match(l);if(!r)return null;const[,n,i,a,c]=r,u=i.indexOf("/");return{title:h(-1!==u?i.slice(u+1):i),serverType:a,sublayer:null!=c&&""!==c?parseInt(c,10):null,url:{path:n}}}function p(e){const t=Object(o.J)(e).path.match(c);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function h(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function b(e,t){const r=[];if(e){const t=d(e);Object(n.k)(t)&&t.title&&r.push(t.title)}if(t){const e=h(t);r.push(e)}if(2===r.length){if(-1!==r[0].toLowerCase().indexOf(r[1].toLowerCase()))return r[0];if(-1!==r[1].toLowerCase().indexOf(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function f(e){if(!e)return!1;const t=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),r=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return t&&r}function m(e,t){return e?Object(o.H)(Object(o.G)(e,t)):e}function g(e){let{url:t}=e;if(!t)return{url:t};t=Object(o.G)(t,e.logger);const r=Object(o.J)(t),i=d(r.path);let a;if(Object(n.k)(i))null!=i.sublayer&&null==e.layer.layerId&&(a=i.sublayer),t=i.url.path;else if(e.nonStandardUrlAllowed){const e=p(r.path);Object(n.k)(e)&&(t=e.serviceUrl,a=e.sublayerId)}return{url:Object(o.H)(t),layerId:a}}function v(e,t,r,n,a){Object(i.f)(t,n,"url",a),n.url&&null!=e.layerId&&(n.url=Object(o.y)(n.url,r,e.layerId.toString()))}function y(e){if(!e)return!1;const t=e.toLowerCase(),r=-1!==t.indexOf("/services/"),n=-1!==t.indexOf("/mapserver/wmsserver"),o=-1!==t.indexOf("/imageserver/wmsserver"),i=-1!==t.indexOf("/wmsserver");return r&&(n||o||i)}function O(e){if(!e)return!1;const t=new o.a(Object(o.z)(e)).authority.toLowerCase();return"server.arcgisonline.com"===t||"services.arcgisonline.com"===t}},184:function(e,t,r){"use strict";function n(e){return e&&("function"==typeof e.on||"function"==typeof e.addEventListener)}function o(e,t,r){if(!n(e))throw new TypeError("target is not a Evented or EventTarget object");if("on"in e)return e.on(t,r);if(Array.isArray(t)){const n=t.slice();for(const t of n)e.addEventListener(t,r);return{remove(){for(const t of n)e.removeEventListener(t,r)}}}return e.addEventListener(t,r),{remove(){e.removeEventListener(t,r)}}}function i(e,t,r){if(!n(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,r);const i=o(e,t,(t=>{i.remove(),r.call(e,t)}));return{remove(){i.remove()}}}r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return i}));const a={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function s({key:e}){return a[e]||e}},226:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(79),r(86),r(83)),a=r(82),s=(r(81),r(84),r(85),r(88)),l=r(167);let c=n=class extends s.a{constructor(e){super(e),this.value=0,this.unit="milliseconds"}toMilliseconds(){return this.value*l.b[this.unit]}clone(){return new n({value:this.value,unit:this.unit})}};Object(o.a)([Object(i.b)({type:Number,json:{write:!0},nonNullable:!0})],c.prototype,"value",void 0),Object(o.a)([Object(i.b)({type:l.d.apiValues,json:{type:l.d.jsonValues,read:l.d.read,write:l.d.write},nonNullable:!0})],c.prototype,"unit",void 0),c=n=Object(o.a)([Object(a.a)("esri.TimeInterval")],c);var u=c;t.a=u},237:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n=new(r(97).a)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},291:function(e,t,r){"use strict";function n(e,t){if(e.forEach)e.forEach(t);else for(let r=0;r<e.length;r++)t(e[r],r,e)}function o(e,t,r){if(e.slice)return e.slice(t,r);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===r?r=e.length:(r<0&&(r+=e.length),r=Math.min(e.length,Math.max(0,r)));const n=Math.max(0,r-t),o=new(0,e.constructor)(n);for(let i=0;i<n;i++)o[i]=e[t+i];return o}function i(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name}function a(e){return e instanceof Int8Array||e&&e.constructor&&"Int8Array"===e.constructor.name}function s(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name}function l(e){return e instanceof Uint8ClampedArray||e&&e.constructor&&"Uint8ClampedArray"===e.constructor.name}function c(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name}function u(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name}function d(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name}function p(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name}function h(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name}function b(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name}function f(e){const t=new Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r];return t}function m(e){return e?128+e.buffer.byteLength+64:0}r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return a})),r.d(t,"i",(function(){return u})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return s})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return o})),r.d(t,"n",(function(){return f}))},294:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(80),o=r(87),i=r(229),a=r(83),s=r(82),l=r(240),c=r(335),u=r(94),d=r(115),p=r(109);let h=class extends u.a{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new d.a,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(e,t,r,n=0){const o=0!=(1&n),i=++this.handleId;o||this.installSyncUpdatingWatch(e,t,i);const a=0!=(2&n)?Object(p.a)(e,t,r,o):e.watch(t,r,o);return this.handles.add(a,i),{remove:()=>{this.handles.remove(i)}}}addOnCollectionPropertyChange(e,t,r,n=0){const o=0!=(2&n),i=++this.handleId;return this.handles.add([Object(p.b)(e,t,"after-changes",this.createSyncUpdatingCallback()),Object(p.b)(e,t,"change",r,o?e=>{r({added:e.items,removed:[],moved:[],target:e})}:void 0)],i),{remove:()=>{this.handles.remove(i)}}}addOnCollectionChange(e,t,r=0){const n=0!=(2&r),o=++this.handleId;return this.handles.add([e.on("after-changes",this.createSyncUpdatingCallback()),e.on("change",t)],o),n&&t({added:e.items,removed:[],moved:[],target:e}),{remove:()=>{this.handles.remove(o)}}}addPromise(e){if(Object(o.j)(e))return e;const t=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(b)||this._set("updating",!1))}},t),this.pendingPromises.add(e),this._set("updating",!0);const r=()=>this.handles.remove(t);return e.then(r,r),e}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}installSyncUpdatingWatch(e,t,r){const n=this.createSyncUpdatingCallback(),o=Object(c.a)((()=>Object(i.c)(e,t)),n);return this.handles.add(o,r),o}createSyncUpdatingCallback(){return()=>{this.handles.remove(b),++this.scheduleHandleId;const e=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add(Object(l.b)((()=>{e===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove(b))})),b)}}};Object(n.a)([Object(a.b)({readOnly:!0})],h.prototype,"updating",void 0),h=Object(n.a)([Object(s.a)("esri.views.support.WatchUpdatingTracking")],h);const b=-42},299:function(e,t,r){"use strict";function n(e){return t=>{t.hasOwnProperty("_delegatedEventNames")||(t._delegatedEventNames=t._delegatedEventNames?t._delegatedEventNames.slice():[]);const r=t._delegatedEventNames,n=Array.isArray(e)?e:function(e){return e.split(",").map((e=>e.trim()))}(e);r.push(...n)}}r.d(t,"a",(function(){return n}))},317:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return s})),r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return b})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"j",(function(){return l}));var n=r(104),o=r(101),i=r(108);function a(e){const t=e[0]*e[0]+e[4]*e[4]+e[8]*e[8],r=e[1]*e[1]+e[5]*e[5]+e[9]*e[9],n=e[2]*e[2]+e[6]*e[6]+e[10]*e[10];return Math.sqrt(Math.max(Math.max(t,r),n))}function s(e,t,r){r=r||e;const n=Object(i.g)(e,t);Object(i.v)(r,e[0]-n*t[0],e[1]-n*t[1],e[2]-n*t[2]),Object(i.q)(r,r)}function l(e,t,r){Math.abs(e[0])>Math.abs(e[1])?Object(i.v)(t,0,1,0):Object(i.v)(t,1,0,0),Object(i.f)(r,e,t),Object(i.q)(t,t),Object(i.f)(t,r,e),Object(i.q)(r,r)}function c(e,t){const r=Object(i.o)(e),o=Object(n.c)(e[2]/r),a=Math.atan2(e[1]/r,e[0]/r);return Object(i.v)(t,r,o,a),t}function u(e,t,r){const n=r[0]-t[0],o=r[1]-t[1],i=r[2]-t[2];let a=n*n+o*o+i*i;return a?(a=1/Math.sqrt(a),e[0]=n*a,e[1]=o*a,e[2]=i*a,e):(e[0]=0,e[1]=0,e[2]=0,e)}function d(e,t,r,n=Object(o.e)()){const a=Object(i.o)(e),s=Object(i.o)(t),l=Object(i.g)(e,t)/(a*s);if(l<.9999999999999999){const o=Math.acos(l),c=((1-r)*a+r*s)/Math.sin(o),u=c/a*Math.sin((1-r)*o),d=c/s*Math.sin(r*o);return Object(i.d)(O,e,u),Object(i.d)(w,t,d),Object(i.e)(n,O,w)}return Object(i.h)(n,e,t,r)}function p(e,t,r,n=Object(o.e)(),a=Object(o.e)()){const s=Object(i.o)(e),l=Object(i.o)(t),c=Object(i.g)(e,t)/(s*l);if(c<.9999999999999999){const o=Math.acos(c),u=Math.sin(o),d=Math.sin(r*o),p=Math.sin((1-r)*o),h=(1-r)*s+r*l;{const r=h/u,o=r/l*d;Object(i.d)(O,e,r/s*p),Object(i.d)(w,t,o),Object(i.e)(n,O,w)}{const n=1/s*(-Math.cos((1-r)*o)*o*h+p*(-s+l));Object(i.d)(O,e,n);const c=1/l*(Math.cos(r*o)*o*h+d*(-s+l));Object(i.d)(w,t,c),Object(i.e)(a,O,w),Object(i.d)(a,a,1/u)}return a}return Object(i.h)(n,e,t,r),Object(i.i)(a,t,e),Object(i.q)(a,a),a}class h{constructor(e,t){this.min=e,this.max=t,this.range=t-e}ndiff(e,t=0){return Math.ceil((e-t)/this.range)*this.range+t}_normalize(e,t,r,n=0,o=!1){return(r-=n)<e?r+=this.ndiff(e-r):r>t&&(r-=this.ndiff(r-t)),o&&r===t&&(r=e),r+n}normalize(e,t=0,r=!1){return this._normalize(this.min,this.max,e,t,r)}clamp(e,t=0){return Object(n.d)(e-t,this.min,this.max)+t}monotonic(e,t,r){return e<t?t:t+this.ndiff(e-t,r)}minimalMonotonic(e,t,r){return this._normalize(e,e+this.range,t,r)}center(e,t,r){return t=this.monotonic(e,t,r),this.normalize((e+t)/2,r)}diff(e,t,r){return this.monotonic(e,t,r)-e}shortestSignedDiff(e,t){e=this.normalize(e);const r=(t=this.normalize(t))-e,n=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(r)<Math.abs(n)?r:n}contains(e,t,r){return t=this.minimalMonotonic(e,t),(r=this.minimalMonotonic(e,r))>e&&r<t}}function b(e,t,r,n){Object(i.i)(f,t,e),Object(i.i)(m,r,e),Object(i.f)(n,f,m),Object(i.q)(n,n),n[3]=-Object(i.g)(e,n)}const f=Object(o.e)(),m=Object(o.e)();function g(e){for(const t in e){const r=e[t];r instanceof Function&&(e[t]=r.bind(e))}return e}g(new h(0,2*Math.PI));const v=g(new h(-Math.PI,Math.PI)),y=g(new h(0,360)),O=(Object(o.e)(),Object(o.e)()),w=Object(o.e)()},399:function(e,t,r){"use strict";var n=r(121);class o{constructor(e,t,r){this.name=e,this.details=r,this.message=void 0,this instanceof o&&(this.message=t&&function(e,t){return e.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(e,r){if(""===r)return"$";const o=Object(n.b)(r,t),i=null==o?"":o;if(void 0===i)throw new Error(`could not find key "${r}" in template`);return i.toString()}))}(t,r)||"")}toString(){return"["+this.name+"]: "+this.message}}t.a=o},455:function(e,t,r){"use strict";var n=r(152);var o,i=(o=n.a,{setTimeout:(e,t)=>{const r=o.setTimeout(e,t);return{remove:()=>o.clearTimeout(r)}}});t.a=i},496:function(e,t,r){"use strict";var n=r(80),o=r(83),i=r(82),a=r(106),s=r(115);let l=class extends a.a{constructor(e){super(e),this._handles=new s.a,this.root=null}initialize(){this._handles.add(this.rootCollectionNames.map((e=>this.watch("root."+e,(()=>this.updateCollections()),!0)))),this.updateCollections()}destroy(){this.root=null,this.refresh(),this._handles.destroy(),this._handles=null}updateCollections(){this._collections=this.rootCollectionNames.map((e=>this.get("root."+e))).filter((e=>null!=e)),this.refresh()}refresh(){const e=this._handles;e.remove("collections");const t=new Array;let r=0;for(const n of this._collections)r=this._processCollection(t,r,n);this.splice(r,this.length);for(const n of t)e.add(n.on("after-changes",(()=>this.refresh())),"collections")}_createNewInstance(e){return new a.a(e)}_processCollection(e,t,r){return r?(e.push(r),r.forEach((r=>{if(r){if(!this.itemFilterFunction||this.itemFilterFunction(r)){const e=this.indexOf(r,t);e>=0?e!==t&&this.reorder(r,t):this.add(r,t),++t}this.getChildrenFunction&&(t=this._processCollection(e,t,this.getChildrenFunction(r)))}})),t):t}};Object(n.a)([Object(o.b)()],l.prototype,"rootCollectionNames",void 0),Object(n.a)([Object(o.b)()],l.prototype,"root",void 0),Object(n.a)([Object(o.b)()],l.prototype,"getChildrenFunction",void 0),Object(n.a)([Object(o.b)()],l.prototype,"itemFilterFunction",void 0),l=Object(n.a)([Object(i.a)("esri.core.CollectionFlattener")],l);var c=l;t.a=c},498:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(80),o=(r(78),r(79),r(86),r(83)),i=r(82);r(81),r(84),r(85);const a=e=>{let t=class extends e{constructor(...e){super(...e),this.goToOverride=null,this.view=null}callGoTo(e){const{view:t}=this;return this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}};return Object(n.a)([Object(o.b)()],t.prototype,"goToOverride",void 0),Object(n.a)([Object(o.b)()],t.prototype,"view",void 0),t=Object(n.a)([Object(i.a)("esri.widgets.support.GoTo")],t),t}},506:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(87)),a=(r(79),r(83)),s=r(119),l=r(82),c=(r(81),r(84),r(85),r(88)),u=r(96),d=r(98),p=r(86),h=r(93),b=r(92),f=r(112),m=r(104),g=r(317);let v=n=class extends c.a{constructor(...e){super(...e),this.position=new f.a([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,r,n){if(e&&"object"==typeof e&&("x"in e||Array.isArray(e))){const o={position:e};return null!=t&&(o.heading=t),null!=r&&(o.tilt=r),null!=n&&(o.fov=n),o}return e}writePosition(e,t,r,n){const o=e.clone();o.x=Object(p.i)(e.x||0),o.y=Object(p.i)(e.y||0),o.z=e.hasZ?Object(p.i)(e.z||0):e.z,t[r]=o.write(null,n)}readPosition(e,t){const r=new f.a;return r.read(e,t),r.x=Object(p.i)(r.x||0),r.y=Object(p.i)(r.y||0),r.z=r.hasZ?Object(p.i)(r.z||0):r.z,r}equals(e){return!!e&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}clone(){return new n({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};Object(o.a)([Object(a.b)({type:f.a,json:{write:{isRequired:!0}}})],v.prototype,"position",void 0),Object(o.a)([Object(b.a)("position")],v.prototype,"writePosition",null),Object(o.a)([Object(h.a)("position")],v.prototype,"readPosition",null),Object(o.a)([Object(a.b)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Object(s.a)((e=>g.b.normalize(Object(p.i)(e))))],v.prototype,"heading",void 0),Object(o.a)([Object(a.b)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Object(s.a)((e=>Object(m.d)(Object(p.i)(e),-180,180)))],v.prototype,"tilt",void 0),Object(o.a)([Object(a.b)({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],v.prototype,"fov",void 0),v=n=Object(o.a)([Object(l.a)("esri.Camera")],v);var y,O=v;let w=y=class extends c.a{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new y({rotation:this.rotation,scale:this.scale,targetGeometry:Object(i.k)(this.targetGeometry)?this.targetGeometry.clone():null,camera:Object(i.k)(this.camera)?this.camera.clone():null})}};function j(){return{enabled:!this.camera}}Object(o.a)([Object(a.b)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:j}}}}})],w.prototype,"rotation",void 0),Object(o.a)([Object(s.a)("rotation")],w.prototype,"castRotation",null),Object(o.a)([Object(a.b)({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:j}}}}})],w.prototype,"scale",void 0),Object(o.a)([Object(a.b)({types:d.a,json:{read:u.a,write:!0,origins:{"web-scene":{read:u.a,write:{overridePolicy:j}}}}})],w.prototype,"targetGeometry",void 0),Object(o.a)([Object(a.b)({type:O,json:{write:!0}})],w.prototype,"camera",void 0),w=y=Object(o.a)([Object(l.a)("esri.Viewpoint")],w);var _=w;t.a=_},540:function(e,t,r){"use strict";var n=r(80),o=(r(78),r(79),r(86),r(83)),i=r(82),a=(r(81),r(84),r(85),r(88)),s=r(96);let l=class extends a.a{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map((function(e){return e.toJSON()})),t=this.geometries[0],r={};return r.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),r.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),r.geometries=JSON.stringify({geometryType:Object(s.c)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}};Object(n.a)([Object(o.b)()],l.prototype,"geometries",void 0),Object(n.a)([Object(o.b)({json:{read:{source:"outSR"}}})],l.prototype,"outSpatialReference",void 0),Object(n.a)([Object(o.b)()],l.prototype,"transformation",void 0),Object(n.a)([Object(o.b)()],l.prototype,"transformForward",void 0),l=Object(n.a)([Object(i.a)("esri.tasks.support.ProjectParameters")],l);var c=l;t.a=c},591:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(89);class o{constructor(e,t,r=""){this.major=e,this.minor=t,this._context=r}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}since(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",r=this._context&&this._context+" ";throw new n.a(t+"unsupported-version",`Required major ${r}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new o(this.major,this.minor,this._context)}static parse(e,t=""){const[r,i]=e.split("."),a=/^\s*\d+\s*$/;if(!r||!r.match||!r.match(a))throw new n.a((t&&t+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!i||!i.match||!i.match(a))throw new n.a((t&&t+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const s=parseInt(r,10),l=parseInt(i,10);return new o(s,l,t)}}},605:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return f})),r.d(t,"g",(function(){return m}));var n=r(79),o=r(86),i=r(81),a=r(106),s=r(619),l=r(558);const c=n.a.getLogger("esri.support.basemapUtils");function u(){return{}}function d(e){for(const t in e){const r=e[t];!1===(null==r?void 0:r.destroyed)&&r.destroy(),delete e[t]}}function p(e,t){var r;let n;if("string"==typeof e){if(!(e in s.a)){const t=Object.keys(s.a).map((e=>`"${e}"`)).join(", ");return c.warn(`Unable to find basemap definition for: ${e}. Try one of these: ${t}`),null}t&&(n=t[e]),n||(n=l.default.fromId(e),t&&(t[e]=n))}else n=Object(o.m)(l.default,e);return null!=(r=n)&&r.destroyed&&(c.warn("The provided basemap is already destroyed",{basemap:n}),n=null),n}function h(e){let t=null;const r=y(e),n=!r.baseLayers.length;for(const o in s.a){const e=k(r,j(s.a[o]),{mustMatchReferences:n});if("equal"===e){t=o;break}"base-layers-equal"===e&&(t=o)}return t}function b(e,t){return e===t||"equal"===k(y(e),y(t),{mustMatchReferences:!0})}function f(e){return!(null==e||!e.baseLayers.concat(e.referenceLayers).some(m))}function m(e){if(v(e.url))return!0;if("vector-tile"===e.type)for(const t in e.sourceNameToSource){const r=e.sourceNameToSource[t];if(v(null==r?void 0:r.sourceUrl))return!0}return!1}const g=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function v(e){if(!e)return!1;const t=new i.a(Object(i.z)(e));return g.test(t.authority)}function y(e){return e?!e.loaded&&e.resourceInfo?j(e.resourceInfo.data):{baseLayers:O(e.baseLayers),referenceLayers:O(e.referenceLayers)}:null}function O(e){return(a.a.isCollection(e)?e.toArray():e).map(w)}function w(e){return{type:e.type,url:I("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible}}function j(e){return e?{baseLayers:_(e.baseMapLayers.filter((e=>!e.isReference))),referenceLayers:_(e.baseMapLayers.filter((e=>e.isReference)))}:null}function _(e){return e.map((e=>function(e){let t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;default:t="unknown"}return{type:t,url:I(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility}}(e)))}function k(e,t,r){return null!=e!=(null!=t)?"not-equal":e?S(e.baseLayers,t.baseLayers)?S(e.referenceLayers,t.referenceLayers)?"equal":r.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function S(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!E(e[r],t[r]))return!1;return!0}function E(e,t){return e.type===t.type&&e.url===t.url&&e.minScale===t.minScale&&e.maxScale===t.maxScale&&e.visible===t.visible&&e.opacity===t.opacity}function I(e){return e?Object(i.C)(e).replace(/^\s*https?:/i,"").toLowerCase():""}},620:function(e,t,r){"use strict";function n(e){return e&&"getAtOrigin"in e&&"originOf"in e}r.d(t,"a",(function(){return n}))},653:function(e,t,r){"use strict";function n(e,t){if(!o(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function o(e,t){return!!e.typeKeywords&&e.typeKeywords.indexOf(t)>-1}function i(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i}))},671:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(80),o=(r(78),r(79)),i=(r(86),r(83)),a=r(82),s=(r(81),r(84),r(85),r(91)),l=r(106),c=r(292),u=r(175);function d(e){return e&&"group"===e.type}function p(e,t,r){let n,o;if(e)for(let i=0,a=e.length;i<a;i++){if(n=e.getItemAt(i),n[t]===r)return n;if(d(n)&&(o=p(n.layers,t,r),o))return o}}const h=o.a.getLogger("esri.support.LayersMixin"),b=e=>{let t=class extends e{constructor(...e){super(...e),this.layers=new l.a;const t=e=>{e.parent=this,this.layerAdded(e),"elevation"!==e.type&&"base-elevation"!==e.type||h.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as an operational layer and will therefore be ignored.`)},r=e=>{e.parent=null,this.layerRemoved(e)};this.layers.on("before-add",(e=>(e=>{e.parent&&"remove"in e.parent&&e.parent.remove(e)})(e.item))),this.layers.on("after-add",(e=>t(e.item))),this.layers.on("after-remove",(e=>r(e.item)))}destroy(){const e=this.layers.removeAll();for(const t of e)this.layerRemoved(t),t.destroy();this.layers.destroy()}set layers(e){this._set("layers",Object(c.b)(e,this._get("layers")))}add(e,t){const r=this.layers;t=r.getNextIndex(t),e instanceof u.a?e.parent===this?this.reorder(e,t):r.add(e,t):Object(s.o)(e)?e.then((e=>{this.destroyed||this.add(e,t)})):h.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(e,t){const r=this.layers;t=r.getNextIndex(t),e.slice().forEach((e=>{e.parent!==this?(r.add(e,t),t+=1):this.reorder(e,t)}))}findLayerById(e){return p(this.layers,"id",e)}findLayerByUid(e){return p(this.layers,"uid",e)}remove(e){return this.layers.remove(e)}removeMany(e){return this.layers.removeMany(e)}removeAll(){return this.layers.removeAll()}reorder(e,t){return this.layers.reorder(e,t)}layerAdded(e){}layerRemoved(e){}};return Object(n.a)([Object(i.b)()],t.prototype,"layers",null),t=Object(n.a)([Object(a.a)("esri.support.LayersMixin")],t),t}},672:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r(80),o=(r(78),r(79)),i=(r(86),r(83)),a=r(82),s=(r(81),r(84),r(85),r(106)),l=r(292);const c="esri.support.TablesMixin",u=o.a.getLogger(c);function d(e){return e&&"group"===e.type}function p(e,t,r){if(e)for(let n=0,o=e.length;n<o;n++){const o=e.getItemAt(n);if(o[t]===r)return o;if(d(o)){const e=p(o.tables,t,r);if(e)return e}}}const h=e=>{let t=class extends e{constructor(...e){super(...e),this.tables=new s.a,this.tables.on("after-add",(e=>{const t=e.item;t.parent&&t.parent!==this&&"tables"in t.parent&&t.parent.tables.remove(t),t.parent=this,"feature"!==t.type&&u.error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(e=>{e.item.parent=null}))}destroy(){const e=this.tables.removeAll();for(const t of e)t.destroy();this.tables.destroy()}set tables(e){this._set("tables",Object(l.b)(e,this._get("tables")))}findTableById(e){return p(this.tables,"id",e)}findTableByUid(e){return p(this.tables,"uid",e)}};return Object(n.a)([Object(i.b)()],t.prototype,"tables",null),t=Object(n.a)([Object(a.a)(c)],t),t}},673:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(620);function o(e){e&&e.writtenProperties&&e.writtenProperties.forEach((e=>{const t=e.target;e.newOrigin&&e.oldOrigin!==e.newOrigin&&Object(n.a)(t)&&t.updateOrigin(e.propName,e.newOrigin)}))}},768:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(90)),a=(r(79),r(86),r(83)),s=r(82),l=(r(81),r(84),r(85),r(88)),c=r(105);let u=n=class extends l.a{constructor(e){super(e),this.color=new c.a([0,0,0,1])}clone(){return new n(Object(i.a)({color:this.color}))}};Object(o.a)([Object(a.b)({type:c.a,json:{write:!0}})],u.prototype,"color",void 0),u=n=Object(o.a)([Object(s.a)("esri.webmap.background.ColorBackground")],u);var d=u;t.a=d},78:function(e,t,r){"use strict";var n,o,i=r(152);let a;var s,l;function c(e){return"function"==typeof a[e]?a[e]=a[e](i.a):a[e]}a=null!=(n=i.a.dojoConfig)&&n.has||null!=(o=i.a.esriConfig)&&o.has?{...null==(s=i.a.dojoConfig)?void 0:s.has,...null==(l=i.a.esriConfig)?void 0:l.has}:{},c.add=(e,t,r,n)=>((n||void 0===a[e])&&(a[e]=t),r&&c(e)),c.cache=a,c.add("esri-deprecation-warnings",!0),(()=>{c.add("host-webworker",void 0!==i.a.WorkerGlobalScope&&self instanceof i.a.WorkerGlobalScope);const e="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(c.add("host-browser",e),c.add("host-node","object"==typeof i.a.process&&i.a.process.versions&&i.a.process.versions.node&&i.a.process.versions.v8),c.add("dom",e),c("host-browser")){const e=navigator,t=e.userAgent,r=e.appVersion,n=parseFloat(r);if(c.add("wp",parseFloat(t.split("Windows Phone")[1])||void 0),c.add("msapp",parseFloat(t.split("MSAppHost/")[1])||void 0),c.add("khtml",r.indexOf("Konqueror")>=0?n:void 0),c.add("edge",parseFloat(t.split("Edge/")[1])||void 0),c.add("opr",parseFloat(t.split("OPR/")[1])||void 0),c.add("webkit",!c("wp")&&!c("edge")&&parseFloat(t.split("WebKit/")[1])||void 0),c.add("chrome",!c("edge")&&!c("opr")&&parseFloat(t.split("Chrome/")[1])||void 0),c.add("android",!c("wp")&&parseFloat(t.split("Android ")[1])||void 0),c.add("safari",!(r.indexOf("Safari")>=0)||c("wp")||c("chrome")||c("android")||c("edge")||c("opr")?void 0:parseFloat(r.split("Version/")[1])),c.add("mac",r.indexOf("Macintosh")>=0),c.add("quirks","BackCompat"===document.compatMode),!c("wp")&&t.match(/(iPhone|iPod|iPad)/)){const e=RegExp.$1.replace(/P/,"p"),r=t.match(/OS ([\d_]+)/)?RegExp.$1:"1",n=parseFloat(r.replace(/_/,".").replace(/_/g,""));c.add(e,n),c.add("ios",n)}c.add("trident",parseFloat(r.split("Trident/")[1])||void 0),c.add("svg","undefined"!=typeof SVGAngle),c("webkit")||(t.indexOf("Opera")>=0&&c.add("opera",n>=9.8&&parseFloat(t.split("Version/")[1])||n),!(t.indexOf("Gecko")>=0)||c("wp")||c("khtml")||c("trident")||c("edge")||c.add("mozilla",n),c("mozilla")&&c.add("ff",parseFloat(t.split("Firefox/")[1]||t.split("Minefield/")[1])||void 0))}})(),(()=>{if(i.a.navigator){const e=navigator.userAgent,t=e.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),r=e.match(/iPhone/i);t&&c.add("esri-mobile",t),r&&c.add("esri-iPhone",r),c.add("esri-geolocation",!!navigator.geolocation)}c.add("esri-canvas-svg-support",!c("trident")),c.add("esri-wasm","WebAssembly"in i.a),c.add("esri-shared-array-buffer",(()=>{const e="SharedArrayBuffer"in i.a,t=!1===i.a.crossOriginIsolated;return e&&!t})),c.add("esri-atomics","Atomics"in i.a),c.add("esri-workers","Worker"in i.a),c.add("esri-text-decoder","TextDecoder"in i.a),c.add("esri-text-encoder","TextEncoder"in i.a),c.add("featurelayer-snapshot-enabled",!0),c.add("featurelayer-snapshot-point-min-threshold",8e4),c.add("featurelayer-snapshot-point-max-threshold",4e5),c.add("featurelayer-snapshot-point-coverage",.1),c.add("featurelayer-advanced-symbols",!1),c.add("featurelayer-pbf",!0),c.add("featurelayer-pbf-statistics",!1),c.add("feature-layers-workers",!0),c.add("mapview-transitions-duration",200),c.add("mapserver-pbf-enabled",!1),c("host-webworker")||c("host-browser")&&(c.add("csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),c.add("esri-image-decode",(()=>{if("decode"in new Image){const e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then((()=>{c.add("esri-image-decode",!0,!0,!0)})).catch((()=>{c.add("esri-image-decode",!1,!0,!0)}))}return!1})),c.add("esri-url-encodes-apostrophe",(()=>{const e=i.a.document.createElement("a");return e.href="?'",e.href.indexOf("?%27")>-1})),c.add("vectortilelayer-max-buffers",(()=>c("ff")?160:Number.POSITIVE_INFINITY)))})(),t.a=c},79:function(e,t,r){"use strict";r(78);var n=r(138),o=r(87),i=r(137);const a={info:0,warn:1,error:2,none:3};class s{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=e.level&&(this.level=e.level),null!=e.writer&&(this.writer=e.writer),this._module=e.module,s._loggers[this.module]=this;const t=this.module.lastIndexOf(".");-1!==t&&(this._parent=s.getLogger(this.module.slice(0,t)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(e={}){const t=s._loggers;return s._loggers=e,t},set throttlingDisabled(e){s._throttlingDisabled=e}}}static getLogger(e){let t=s._loggers[e];return t||(t=new s({module:e})),t}_log(e,t,...r){if(this._matchLevel(e)){if("always"!==t&&!s._throttlingDisabled){const n=this._argsToKey(r),o=this._loggedMessages[e].get(n);if("once"===t&&null!=o||"oncePerTick"===t&&o&&o>=s._tickCounter)return;this._loggedMessages[e].set(n,s._tickCounter),s._scheduleTickCounterIncrement()}for(const t of n.a.log.interceptors)if(t(e,this.module,...r))return;this._inheritedWriter()(e,this.module,...r)}}_parentWithMember(e,t){let r=this;for(;Object(o.k)(r);){const t=r[e];if(Object(o.k)(t))return t;r=r.parent}return t}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,t,...r){console[e](`[${t}]`,...r)}_matchLevel(e){const t=n.a.log.level?n.a.log.level:"warn";return a[this._parentWithMember("level",t)]<=a[e]}_argsToKey(...e){return Object(i.b)(JSON.stringify(e,((e,t)=>"object"!=typeof t||Array.isArray(t)?t:"[Object]")))}static _scheduleTickCounterIncrement(){s._tickCounterScheduled||(s._tickCounterScheduled=!0,Promise.resolve().then((()=>{s._tickCounter++,s._tickCounterScheduled=!1})))}}s._loggers={},s._tickCounter=0,s._tickCounterScheduled=!1,s._throttlingDisabled=!1,t.a=s},809:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(79),r(86),r(83)),a=r(82),s=(r(81),r(84),r(85),r(88));let l=n=class extends s.a{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}clone(){return new n({url:this.url})}};Object(o.a)([Object(i.b)({type:String,json:{write:{isRequired:!0}}})],l.prototype,"url",void 0),l=n=Object(o.a)([Object(a.a)("esri.webdoc.support.Thumbnail")],l);var c=l;t.a=c},863:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(79)),a=r(83),s=r(119),l=r(82),c=(r(81),r(84),r(85),r(94)),u=r(123),d=r(558),p=r(178),h=r(90),b=r(86),f=r(92),m=r(89),g=r(91),v=r(88),y=r(106),O=r(105),w=r(300),j=r(292),_=r(157),k=r(465),S=r(103);let E=n=class extends v.a{constructor(e){super(e),this.type="none"}clone(){return new n({type:this.type})}};var I;Object(o.a)([Object(S.a)({none:"none",stayAbove:"stay-above"})],E.prototype,"type",void 0),E=n=Object(o.a)([Object(l.a)("esri.ground.NavigationConstraint")],E);const T=i.a.getLogger("esri.Ground");let x=I=class extends(Object(v.b)(_.a)){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new y.a;const t=e=>{e.parent&&e.parent!==this&&"remove"in e.parent&&e.parent.remove(e),e.parent=this,"elevation"!==e.type&&"base-elevation"!==e.type&&T.error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)};this.layers.on("after-add",(e=>t(e.item))),this.layers.on("after-remove",(e=>(e=>{e.parent=null})(e.item)))}initialize(){this.when().catch((e=>{T.error("#load()","Failed to load ground",e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)t.destroy();this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set layers(e){this._set("layers",Object(j.b)(e,this._get("layers")))}writeLayers(e,t,r,n){const o=[];e?(n={...n,layerContainerType:"ground"},e.forEach((e=>{if("write"in e){const t={};Object(p.b)(e)().write(t,n)&&o.push(t)}else n&&n.messages&&n.messages.push(new m.a("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in the ground`,{layer:e}))})),t.layers=o):t.layers=o}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return Object(k.a)(this,(e=>{e(this.layers)}))}async queryElevation(e,t){await this.load({signal:null==t?void 0:t.signal});const{ElevationQuery:n}=await Promise.all([r.e(10),r.e(43)]).then(r.bind(null,1110));Object(g.u)(t);const o=new n,i=this.layers.filter(A).toArray();return o.queryAll(i,e,t)}async createElevationSampler(e,t){await this.load({signal:null==t?void 0:t.signal});const{ElevationQuery:n}=await Promise.all([r.e(10),r.e(43)]).then(r.bind(null,1110));Object(g.u)(t);const o=new n,i=this.layers.filter(A).toArray();return o.createSamplerAll(i,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:Object(h.a)(this.surfaceColor),navigationConstraint:Object(h.a)(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new I({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve(null)}_loadLayersFromJSON(e,t,n){const o=t&&t.origin||"web-scene",i=t&&t.portal||null,a=t&&t.url||null;return r.e(44).then(r.bind(null,869)).then((({populateOperationalLayers:t})=>{Object(g.u)(n);const r=[];if(e.layers&&Array.isArray(e.layers)){const n={context:{origin:o,url:a,portal:i,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};r.push(t(this.layers,e.layers,n))}return Object(g.j)(r)})).then((()=>{}))}};function A(e){return"elevation"===e.type||function(e){return e&&"createElevationSampler"in e}(e)}Object(o.a)([Object(a.b)({json:{read:!1}})],x.prototype,"layers",null),Object(o.a)([Object(f.a)("layers")],x.prototype,"writeLayers",null),Object(o.a)([Object(a.b)({readOnly:!0})],x.prototype,"resourceInfo",void 0),Object(o.a)([Object(a.b)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:b.a,read:{reader:w.b,source:"transparency"},write:{writer:(e,t)=>{t.transparency=Object(w.a)(e)},target:"transparency"}}})],x.prototype,"opacity",void 0),Object(o.a)([Object(a.b)({type:O.a,json:{type:[b.a],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],x.prototype,"surfaceColor",void 0),Object(o.a)([Object(a.b)({type:E,json:{write:!0}})],x.prototype,"navigationConstraint",void 0),x=I=Object(o.a)([Object(l.a)("esri.Ground")],x);var M=x,C=r(496),N=r(605);const B=i.a.getLogger("esri.support.groundUtils"),D={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};var F=r(671),P=r(672);const L=i.a.getLogger("esri.Map");let R=class extends(Object(P.a)(Object(F.a)(u.a.EventedMixin(c.a)))){constructor(e){super(e),this.allLayers=new C.a({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:e=>e.layers}),this.allTables=this._createTablesFlattener(this),this.basemap=null,this.ground=new M,this._basemapCache=Object(N.b)()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),null==(e=this.ground)||e.destroy(),null==(t=this.basemap)||t.destroy(),Object(N.c)(this._basemapCache),this._basemapCache=null}castBasemap(e){return Object(N.d)(e,this._basemapCache)}castGround(e){return function(e){let t;"string"==typeof e?e in D?t=new M({resourceInfo:{data:{layers:[D[e]]}}}):B.warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`):t=Object(b.m)(M,e);return t}(e)||(L.error("Map.ground may not be set to null or undefined"),this._get("ground"))}findLayerById(e){return this.allLayers.find((t=>t.id===e))}findTableById(e){return this.allTables.find((t=>t.id===e))}_createTablesFlattener(e){return new C.a({root:e,rootCollectionNames:["tables","layers"],getChildrenFunction:e=>e&&"group"===e.type?this._createTablesFlattener(e):null,itemFilterFunction:e=>this._isMapOrGroupLayer(e.parent)&&e.parent.tables.includes(e)})}_isMapOrGroupLayer(e){return e&&(e===this||this._isGroupLayer(e))}_isGroupLayer(e){return e&&"group"===e.type}};Object(o.a)([Object(a.b)({readOnly:!0,dependsOn:[]})],R.prototype,"allLayers",void 0),Object(o.a)([Object(a.b)({readOnly:!0})],R.prototype,"allTables",void 0),Object(o.a)([Object(a.b)({type:d.default})],R.prototype,"basemap",void 0),Object(o.a)([Object(s.a)("basemap")],R.prototype,"castBasemap",null),Object(o.a)([Object(a.b)({type:M,nonNullable:!0})],R.prototype,"ground",void 0),Object(o.a)([Object(s.a)("ground")],R.prototype,"castGround",null),R=Object(o.a)([Object(l.a)("esri.Map")],R);var U=R;t.a=U},87:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return w})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return y})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return O})),r.d(t,"j",(function(){return o})),r.d(t,"k",(function(){return n})),r.d(t,"l",(function(){return i})),r.d(t,"m",(function(){return f})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return p})),r.d(t,"q",(function(){return s})),r.d(t,"r",(function(){return c})),r.d(t,"s",(function(){return l}));function n(e){return null!=e}function o(e){return null==e}function i(e){return void 0===e}function a(e,t){return n(e)?t(e):null}function s(e){return e}function l(e,t){if(o(e))throw new Error(t);return e}function c(e,t){return n(e)?e:"function"==typeof t?t():t}function u(e){return n(e)&&e.destroy(),null}function d(e){return n(e)&&e.dispose(),null}function p(e){return n(e)&&e.remove(),null}function h(e){return n(e)&&e.abort(),null}function b(e){return null}function f(e,t){const r=new Array;for(const n of e)r.push(g(n,null,t));return r}function m(e,t){for(const r of e)g(r,null,t)}function g(e,t,r){return n(e)?r(e):t}function v(e,t){return n(e)?t(e):null}function y(e){return e.filter((e=>n(e)))}function O(e,...t){let r=e,n=0;for(;n<t.length&&r;)r=r[t[n++]];return r}function w(e){return e}},881:function(e,t,r){"use strict";var n,o=r(80),i=(r(78),r(90)),a=r(87),s=r(79),l=r(86),c=r(83),u=r(119),d=r(286),p=r(93),h=r(82),b=r(89),f=(r(81),r(84),r(85),r(88)),m=r(99),g=r(205),v=r(506),y=r(809);const O="esri.webmap.Bookmark",w=s.a.getLogger(O);let j=n=class extends(Object(g.a)(f.a)){constructor(e){super(e),this.name=null,this.thumbnail=new y.a}set extent(e){Object(d.c)(w,"extent",{replacement:"viewpoint",version:"4.17"}),this._set("viewpoint",new v.a({targetGeometry:e.clone()})),this._set("extent",e)}castThumbnail(e){return"string"==typeof e?new y.a({url:e}):Object(l.m)(y.a,e)}set viewpoint(e){const t=e.targetGeometry;if(Object(a.j)(t)||"extent"!==t.type){const t=new b.a("invalid-viewpoint","'viewpoint.targetGeometry' should be an extent",{viewpoint:e});w.error(t)}else this._set("extent",t.clone()),this._set("viewpoint",e)}readViewpoint(e,t){const{extent:r,viewpoint:n}=t;return v.a.fromJSON(n||{targetGeometry:r})}clone(){return new n(Object(i.a)({name:this.name,thumbnail:this.thumbnail,viewpoint:this.viewpoint}))}};Object(o.a)([Object(c.b)({type:m.a,nonNullable:!0,json:{read:!1,write:{isRequired:!0}}})],j.prototype,"extent",null),Object(o.a)([Object(c.b)({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],j.prototype,"name",void 0),Object(o.a)([Object(c.b)({type:y.a,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.url)})}}})],j.prototype,"thumbnail",void 0),Object(o.a)([Object(u.a)("thumbnail")],j.prototype,"castThumbnail",null),Object(o.a)([Object(c.b)({type:v.a,nonNullable:!0,json:{write:!0}})],j.prototype,"viewpoint",null),Object(o.a)([Object(p.a)("viewpoint",["extent","viewpoint"])],j.prototype,"readViewpoint",null),j=n=Object(o.a)([Object(h.a)(O)],j);var _=j;t.a=_},89:function(e,t,r){"use strict";var n=r(90),o=r(79),i=r(399);class a extends i.a{constructor(e,t,r){if(super(e,t,r),!(this instanceof a))return new a(e,t,r)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((e,t)=>{if(t&&"object"==typeof t&&"function"==typeof t.toJSON)return t;try{return Object(n.a)(t)}catch(a){return"[object]"}})))}}catch(e){throw o.a.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new a(e.name,e.message,e.details)}}a.prototype.type="error",t.a=a},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o}));r(78);var n=r(291);function o(e,t){let r;if(t)for(r in e)e.hasOwnProperty(r)&&(void 0===e[r]?delete e[r]:e[r]instanceof Object&&o(e[r],!0));else for(r in e)e.hasOwnProperty(r)&&void 0===e[r]&&delete e[r];return e}function i(e){if(!e||"object"!=typeof e||"function"==typeof e)return e;if(Object(n.h)(e)||Object(n.k)(e)||Object(n.l)(e)||Object(n.f)(e)||Object(n.i)(e)||Object(n.g)(e)||Object(n.j)(e)||Object(n.d)(e)||Object(n.e)(e))return Object(n.m)(e);if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){const t=new Map;return e.forEach(((e,r)=>{t.set(r,i(e))})),t}if(e instanceof Set){const t=new Set;return e.forEach((e=>{t.add(i(e))})),t}let t;const r=e;if("function"==typeof r.clone)t=r.clone();else if("function"==typeof r.map&&"function"==typeof r.forEach)t=r.map(i);else if("function"==typeof r.notifyChange&&"function"==typeof r.watch)t=r.clone();else{t={};for(const r of Object.getOwnPropertyNames(e))t[r]=i(e[r])}return t}function a(e,t){return e===t||"number"==typeof e&&isNaN(e)&&"number"==typeof t&&isNaN(t)||"function"==typeof(e||{}).getTime&&"function"==typeof(t||{}).getTime&&e.getTime()===t.getTime()||!1}},91:function(e,t,r){"use strict";r.d(t,"a",(function(){return E})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return A})),r.d(t,"h",(function(){return M})),r.d(t,"i",(function(){return x})),r.d(t,"j",(function(){return j})),r.d(t,"k",(function(){return _})),r.d(t,"l",(function(){return O})),r.d(t,"m",(function(){return y})),r.d(t,"n",(function(){return h})),r.d(t,"o",(function(){return I})),r.d(t,"p",(function(){return m})),r.d(t,"q",(function(){return g})),r.d(t,"r",(function(){return k})),r.d(t,"s",(function(){return S})),r.d(t,"t",(function(){return b})),r.d(t,"u",(function(){return d})),r.d(t,"v",(function(){return f})),r.d(t,"w",(function(){return T})),r.d(t,"x",(function(){return v}));var n=r(87),o=(r(79),r(89)),i=r(455),a=r(184);function s(e){return Promise.all(e)}function l(e){return new Promise(((t,r)=>{try{e(t,r)}catch(n){Promise.resolve().then((()=>r(n)))}}))}function c(e="Aborted"){return new o.a("AbortError",e)}function u(){return new AbortController}function d(e){if(h(e))throw c()}function p(e){return Object(n.k)(e)?"aborted"in e?e:e.signal:e}function h(e){const t=p(e);return Object(n.k)(t)&&t.aborted}function b(e){if(y(e))throw e}function f(e){if(!y(e))throw e}function m(e,t){const r=p(e);if(!Object(n.j)(r)){if(!r.aborted)return Object(a.d)(r,"abort",(()=>t()));t()}}function g(e,t){const r=p(e);if(!Object(n.j)(r))return d(r),Object(a.d)(r,"abort",(()=>t(c())))}function v(e,t){const r=p(t);return Object(n.j)(r)?e:new Promise(((r,o)=>{let i=m(t,(()=>o(c())));const a=()=>i=Object(n.p)(i);e.then(a,a),e.then(r,o)}))}function y(e){return e&&"AbortError"===e.name}function O(e){return e.catch((e=>{if(!y(e))throw e}))}function w(){let e=null;const t=new Promise(((t,r)=>{e={promise:void 0,resolve:t,reject:r}}));return e.promise=t,e}function j(e){if(!e)return;if("function"!=typeof e.forEach){const t=Object.keys(e);return j(t.map((t=>e[t]))).then((e=>{const r={};return t.forEach(((t,n)=>r[t]=e[n])),r}))}const t=e;return Promise.allSettled(t).then((e=>Array.from(t,((t,r)=>{const n=e[r];return"fulfilled"===n.status?{promise:t,value:n.value}:{promise:t,error:n.reason}}))))}function _(e){return j(e).then((e=>e.filter((e=>!!e.value)).map((e=>e.value))))}function k(e){return Promise.reject(e)}function S(e){return Promise.resolve(e)}function E(e,t,r){const n=u();return m(r,(()=>n.abort())),new Promise(((r,o)=>{let i=setTimeout((()=>{i=0,r(t)}),e);m(n,(()=>{i&&(clearTimeout(i),o(c()))}))}))}function I(e){return e&&"function"==typeof e.then}function T(e){return e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then?e:Promise.resolve(e)}function x(e,t=-1){let r,o,i,a,s=null;const l=(...d)=>{if(r){o=d,a&&a.reject(c()),a=w();const e=Object(n.d)(a.promise);if(s){const e=s;s=null,e.abort()}return e}if(i=a||w(),a=null,t>0){const n=u();r=T(e(...d,n.signal));const o=r;E(t).then((()=>{r===o&&(a?n.abort():s=n)}))}else r=1,r=T(e(...d));const p=()=>{const e=o;o=i=r=s=null,null!=e&&l(...e)},h=r,b=i;return h.then(p,p),h.then(b.resolve,b.reject),Object(n.d)(b.promise)};return l}function A(){let e,t;const r=new Promise(((r,n)=>{e=r,t=n})),n=t=>{e(t)};return n.resolve=t=>e(t),n.reject=e=>t(e),n.timeout=(e,t)=>i.a.setTimeout((()=>n.reject(t)),e),n.promise=r,n}function M(e){let t=u();const r=e(t.signal);let n={promise:r,finished:!1,abort:()=>{t&&(t.abort(),t=null)}};const o=()=>{n&&(n.finished=!0,n=null),t=null};return r.then(o,o),n}},947:function(e,t,r){"use strict";function n(e){return(n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}function s(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function l(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var c=l(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),u=l(/Edge/i),d=l(/firefox/i),p=l(/safari/i)&&!l(/chrome/i)&&!l(/android/i),h=l(/iP(ad|od|hone)/i),b=l(/chrome/i)&&l(/android/i),f={capture:!1,passive:!1};function m(e,t,r){e.addEventListener(t,r,!c&&f)}function g(e,t,r){e.removeEventListener(t,r,!c&&f)}function v(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(r){return!1}return!1}}function y(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function O(e,t,r,n){if(e){r=r||document;do{if(null!=t&&(">"===t[0]?e.parentNode===r&&v(e,t):v(e,t))||n&&e===r)return e;if(e===r)break}while(e=y(e))}return null}var w,j=/\s+/g;function _(e,t,r){if(e&&t)if(e.classList)e.classList[r?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(j," ").replace(" "+t+" "," ");e.className=(n+(r?" "+t:"")).replace(j," ")}}function k(e,t,r){var n=e&&e.style;if(n){if(void 0===r)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(r=e.currentStyle),void 0===t?r:r[t];t in n||-1!==t.indexOf("webkit")||(t="-webkit-"+t),n[t]=r+("string"===typeof r?"":"px")}}function S(e,t){var r="";if("string"===typeof e)r=e;else do{var n=k(e,"transform");n&&"none"!==n&&(r=n+" "+r)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(r)}function E(e,t,r){if(e){var n=e.getElementsByTagName(t),o=0,i=n.length;if(r)for(;o<i;o++)r(n[o],o);return n}return[]}function I(){var e=document.scrollingElement;return e||document.documentElement}function T(e,t,r,n,o){if(e.getBoundingClientRect||e===window){var i,a,s,l,u,d,p;if(e!==window&&e.parentNode&&e!==I()?(a=(i=e.getBoundingClientRect()).top,s=i.left,l=i.bottom,u=i.right,d=i.height,p=i.width):(a=0,s=0,l=window.innerHeight,u=window.innerWidth,d=window.innerHeight,p=window.innerWidth),(t||r)&&e!==window&&(o=o||e.parentNode,!c))do{if(o&&o.getBoundingClientRect&&("none"!==k(o,"transform")||r&&"static"!==k(o,"position"))){var h=o.getBoundingClientRect();a-=h.top+parseInt(k(o,"border-top-width")),s-=h.left+parseInt(k(o,"border-left-width")),l=a+i.height,u=s+i.width;break}}while(o=o.parentNode);if(n&&e!==window){var b=S(o||e),f=b&&b.a,m=b&&b.d;b&&(l=(a/=m)+(d/=m),u=(s/=f)+(p/=f))}return{top:a,left:s,bottom:l,right:u,width:p,height:d}}}function x(e,t,r){for(var n=B(e,!0),o=T(e)[t];n;){var i=T(n)[r];if(!("top"===r||"left"===r?o>=i:o<=i))return n;if(n===I())break;n=B(n,!1)}return!1}function A(e,t,r){for(var n=0,o=0,i=e.children;o<i.length;){if("none"!==i[o].style.display&&i[o]!==Pe.ghost&&i[o]!==Pe.dragged&&O(i[o],r.draggable,e,!1)){if(n===t)return i[o];n++}o++}return null}function M(e,t){for(var r=e.lastElementChild;r&&(r===Pe.ghost||"none"===k(r,"display")||t&&!v(r,t));)r=r.previousElementSibling;return r||null}function C(e,t){var r=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Pe.clone||t&&!v(e,t)||r++;return r}function N(e){var t=0,r=0,n=I();if(e)do{var o=S(e),i=o.a,a=o.d;t+=e.scrollLeft*i,r+=e.scrollTop*a}while(e!==n&&(e=e.parentNode));return[t,r]}function B(e,t){if(!e||!e.getBoundingClientRect)return I();var r=e,n=!1;do{if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var o=k(r);if(r.clientWidth<r.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||r.clientHeight<r.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!r.getBoundingClientRect||r===document.body)return I();if(n||t)return r;n=!0}}}while(r=r.parentNode);return I()}function D(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function F(e,t){return function(){if(!w){var r=arguments,n=this;1===r.length?e.call(n,r[0]):e.apply(n,r),w=setTimeout((function(){w=void 0}),t)}}}function P(e,t,r){e.scrollLeft+=t,e.scrollTop+=r}function L(e){var t=window.Polymer,r=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):r?r(e).clone(!0)[0]:e.cloneNode(!0)}var R="Sortable"+(new Date).getTime();function U(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==k(e,"display")&&e!==Pe.ghost){t.push({target:e,rect:T(e)});var r=a({},t[t.length-1].rect);if(e.thisAnimationDuration){var n=S(e,!0);n&&(r.top-=n.f,r.left-=n.e)}e.fromRect=r}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var r in e)if(e.hasOwnProperty(r))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[r][n])return Number(r);return-1}(t,{target:e}),1)},animateAll:function(r){var n=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof r&&r());var o=!1,i=0;t.forEach((function(e){var t=0,r=e.target,a=r.fromRect,s=T(r),l=r.prevFromRect,c=r.prevToRect,u=e.rect,d=S(r,!0);d&&(s.top-=d.f,s.left-=d.e),r.toRect=s,r.thisAnimationDuration&&D(l,s)&&!D(a,s)&&(u.top-s.top)/(u.left-s.left)===(a.top-s.top)/(a.left-s.left)&&(t=function(e,t,r,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-r.top,2)+Math.pow(t.left-r.left,2))*n.animation}(u,l,c,n.options)),D(s,a)||(r.prevFromRect=a,r.prevToRect=s,t||(t=n.options.animation),n.animate(r,u,s,t)),t&&(o=!0,i=Math.max(i,t),clearTimeout(r.animationResetTimer),r.animationResetTimer=setTimeout((function(){r.animationTime=0,r.prevFromRect=null,r.fromRect=null,r.prevToRect=null,r.thisAnimationDuration=null}),t),r.thisAnimationDuration=t)})),clearTimeout(e),o?e=setTimeout((function(){"function"===typeof r&&r()}),i):"function"===typeof r&&r(),t=[]},animate:function(e,t,r,n){if(n){k(e,"transition",""),k(e,"transform","");var o=S(this.el),i=o&&o.a,a=o&&o.d,s=(t.left-r.left)/(i||1),l=(t.top-r.top)/(a||1);e.animatingX=!!s,e.animatingY=!!l,k(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),k(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),k(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){k(e,"transition",""),k(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),n)}}}}var V=[],W={initializeByDefault:!0},q={mount:function(e){for(var t in W)W.hasOwnProperty(t)&&!(t in e)&&(e[t]=W[t]);V.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),V.push(e)},pluginEvent:function(e,t,r){var n=this;this.eventCanceled=!1,r.cancel=function(){n.eventCanceled=!0};var o=e+"Global";V.forEach((function(n){t[n.pluginName]&&(t[n.pluginName][o]&&t[n.pluginName][o](a({sortable:t},r)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](a({sortable:t},r)))}))},initializePlugins:function(e,t,r,n){for(var o in V.forEach((function(n){var o=n.pluginName;if(e.options[o]||n.initializeByDefault){var a=new n(e,t,e.options);a.sortable=e,a.options=e.options,e[o]=a,i(r,a.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var a=this.modifyOption(e,o,e.options[o]);"undefined"!==typeof a&&(e.options[o]=a)}},getEventProperties:function(e,t){var r={};return V.forEach((function(n){"function"===typeof n.eventProperties&&i(r,n.eventProperties.call(t[n.pluginName],e))})),r},modifyOption:function(e,t,r){var n;return V.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"===typeof o.optionListeners[t]&&(n=o.optionListeners[t].call(e[o.pluginName],r))})),n}};function G(e){var t=e.sortable,r=e.rootEl,n=e.name,o=e.targetEl,i=e.cloneEl,s=e.toEl,l=e.fromEl,d=e.oldIndex,p=e.newIndex,h=e.oldDraggableIndex,b=e.newDraggableIndex,f=e.originalEvent,m=e.putSortable,g=e.extraEventProperties;if(t=t||r&&r[R]){var v,y=t.options,O="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||c||u?(v=document.createEvent("Event")).initEvent(n,!0,!0):v=new CustomEvent(n,{bubbles:!0,cancelable:!0}),v.to=s||r,v.from=l||r,v.item=o||r,v.clone=i,v.oldIndex=d,v.newIndex=p,v.oldDraggableIndex=h,v.newDraggableIndex=b,v.originalEvent=f,v.pullMode=m?m.lastPutMode:void 0;var w=a({},g,q.getEventProperties(n,t));for(var j in w)v[j]=w[j];r&&r.dispatchEvent(v),y[O]&&y[O].call(t,v)}}var z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.evt,o=s(r,["evt"]);q.pluginEvent.bind(Pe)(e,t,a({dragEl:Y,parentEl:H,ghostEl:$,rootEl:X,nextEl:K,lastDownEl:Z,cloneEl:Q,cloneHidden:ee,dragStarted:he,putSortable:ae,activeSortable:Pe.active,originalEvent:n,oldIndex:te,oldDraggableIndex:ne,newIndex:re,newDraggableIndex:oe,hideGhostForTarget:Ne,unhideGhostForTarget:Be,cloneNowHidden:function(){ee=!0},cloneNowShown:function(){ee=!1},dispatchSortableEvent:function(e){J({sortable:t,name:e,originalEvent:n})}},o))};function J(e){G(a({putSortable:ae,cloneEl:Q,targetEl:Y,rootEl:X,oldIndex:te,oldDraggableIndex:ne,newIndex:re,newDraggableIndex:oe},e))}var Y,H,$,X,K,Z,Q,ee,te,re,ne,oe,ie,ae,se,le,ce,ue,de,pe,he,be,fe,me,ge,ve=!1,ye=!1,Oe=[],we=!1,je=!1,_e=[],ke=!1,Se=[],Ee="undefined"!==typeof document,Ie=h,Te=u||c?"cssFloat":"float",xe=Ee&&!b&&!h&&"draggable"in document.createElement("div"),Ae=function(){if(Ee){if(c)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Me=function(e,t){var r=k(e),n=parseInt(r.width)-parseInt(r.paddingLeft)-parseInt(r.paddingRight)-parseInt(r.borderLeftWidth)-parseInt(r.borderRightWidth),o=A(e,0,t),i=A(e,1,t),a=o&&k(o),s=i&&k(i),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+T(o).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+T(i).width;if("flex"===r.display)return"column"===r.flexDirection||"column-reverse"===r.flexDirection?"vertical":"horizontal";if("grid"===r.display)return r.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&"none"!==a.float){var u="left"===a.float?"left":"right";return!i||"both"!==s.clear&&s.clear!==u?"horizontal":"vertical"}return o&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=n&&"none"===r[Te]||i&&"none"===r[Te]&&l+c>n)?"vertical":"horizontal"},Ce=function(e){function t(e,r){return function(n,o,i,a){var s=n.options.group.name&&o.options.group.name&&n.options.group.name===o.options.group.name;if(null==e&&(r||s))return!0;if(null==e||!1===e)return!1;if(r&&"clone"===e)return e;if("function"===typeof e)return t(e(n,o,i,a),r)(n,o,i,a);var l=(r?n:o).options.group.name;return!0===e||"string"===typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var r={},o=e.group;o&&"object"==n(o)||(o={name:o}),r.name=o.name,r.checkPull=t(o.pull,!0),r.checkPut=t(o.put),r.revertClone=o.revertClone,e.group=r},Ne=function(){!Ae&&$&&k($,"display","none")},Be=function(){!Ae&&$&&k($,"display","")};Ee&&document.addEventListener("click",(function(e){if(ye)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),ye=!1,!1}),!0);var De=function(e){if(Y){var t=function(e,t){var r;return Oe.some((function(n){if(!M(n)){var o=T(n),i=n[R].options.emptyInsertThreshold,a=e>=o.left-i&&e<=o.right+i,s=t>=o.top-i&&t<=o.bottom+i;return i&&a&&s?r=n:void 0}})),r}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);r.target=r.rootEl=t,r.preventDefault=void 0,r.stopPropagation=void 0,t[R]._onDragOver(r)}}},Fe=function(e){Y&&Y.parentNode[R]._isOutsideThisEl(e.target)};function Pe(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=i({},t),e[R]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Me(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Pe.supportPointer&&"PointerEvent"in window&&!p,emptyInsertThreshold:5};for(var n in q.initializePlugins(this,e,r),r)!(n in t)&&(t[n]=r[n]);for(var o in Ce(t),this)"_"===o.charAt(0)&&"function"===typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&xe,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?m(e,"pointerdown",this._onTapStart):(m(e,"mousedown",this._onTapStart),m(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(m(e,"dragover",this),m(e,"dragenter",this)),Oe.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),i(this,U())}function Le(e,t,r,n,o,i,a,s){var l,d,p=e[R],h=p.options.onMove;return!window.CustomEvent||c||u?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=r,l.draggedRect=n,l.related=o||t,l.relatedRect=i||T(t),l.willInsertAfter=s,l.originalEvent=a,e.dispatchEvent(l),h&&(d=h.call(p,l,a)),d}function Re(e){e.draggable=!1}function Ue(){ke=!1}function Ve(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,r=t.length,n=0;r--;)n+=t.charCodeAt(r);return n.toString(36)}function We(e){return setTimeout(e,0)}function qe(e){return clearTimeout(e)}Pe.prototype={constructor:Pe,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(be=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,Y):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,r=this.el,n=this.options,o=n.preventOnFilter,i=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=n.filter;if(function(e){Se.length=0;var t=e.getElementsByTagName("input"),r=t.length;for(;r--;){var n=t[r];n.checked&&Se.push(n)}}(r),!Y&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||n.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!p||!s||"SELECT"!==s.tagName.toUpperCase())&&(!(s=O(s,n.draggable,r,!1))||!s.animated)&&Z!==s){if(te=C(s),ne=C(s,n.draggable),"function"===typeof c){if(c.call(this,e,s,this))return J({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:r,fromEl:r}),z("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(n){if(n=O(l,n.trim(),r,!1))return J({sortable:t,rootEl:n,name:"filter",targetEl:s,fromEl:r,toEl:r}),z("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());n.handle&&!O(l,n.handle,r,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,r){var n,o=this,i=o.el,a=o.options,s=i.ownerDocument;if(r&&!Y&&r.parentNode===i){var l=T(r);if(X=i,H=(Y=r).parentNode,K=Y.nextSibling,Z=r,ie=a.group,Pe.dragged=Y,se={target:Y,clientX:(t||e).clientX,clientY:(t||e).clientY},de=se.clientX-l.left,pe=se.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Y.style["will-change"]="all",n=function(){z("delayEnded",o,{evt:e}),Pe.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!d&&o.nativeDraggable&&(Y.draggable=!0),o._triggerDragStart(e,t),J({sortable:o,name:"choose",originalEvent:e}),_(Y,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){E(Y,e.trim(),Re)})),m(s,"dragover",De),m(s,"mousemove",De),m(s,"touchmove",De),m(s,"mouseup",o._onDrop),m(s,"touchend",o._onDrop),m(s,"touchcancel",o._onDrop),d&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Y.draggable=!0),z("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(u||c))n();else{if(Pe.eventCanceled)return void this._onDrop();m(s,"mouseup",o._disableDelayedDrag),m(s,"touchend",o._disableDelayedDrag),m(s,"touchcancel",o._disableDelayedDrag),m(s,"mousemove",o._delayedDragTouchMoveHandler),m(s,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&m(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(n,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Y&&Re(Y),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._disableDelayedDrag),g(e,"touchend",this._disableDelayedDrag),g(e,"touchcancel",this._disableDelayedDrag),g(e,"mousemove",this._delayedDragTouchMoveHandler),g(e,"touchmove",this._delayedDragTouchMoveHandler),g(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?m(document,"pointermove",this._onTouchMove):m(document,t?"touchmove":"mousemove",this._onTouchMove):(m(Y,"dragend",this),m(X,"dragstart",this._onDragStart));try{document.selection?We((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(r){}},_dragStarted:function(e,t){if(ve=!1,X&&Y){z("dragStarted",this,{evt:t}),this.nativeDraggable&&m(document,"dragover",Fe);var r=this.options;!e&&_(Y,r.dragClass,!1),_(Y,r.ghostClass,!0),Pe.active=this,e&&this._appendGhost(),J({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(le){this._lastX=le.clientX,this._lastY=le.clientY,Ne();for(var e=document.elementFromPoint(le.clientX,le.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(le.clientX,le.clientY))!==t;)t=e;if(Y.parentNode[R]._isOutsideThisEl(e),t)do{if(t[R]){if(t[R]._onDragOver({clientX:le.clientX,clientY:le.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Be()}},_onTouchMove:function(e){if(se){var t=this.options,r=t.fallbackTolerance,n=t.fallbackOffset,o=e.touches?e.touches[0]:e,i=$&&S($,!0),a=$&&i&&i.a,s=$&&i&&i.d,l=Ie&&ge&&N(ge),c=(o.clientX-se.clientX+n.x)/(a||1)+(l?l[0]-_e[0]:0)/(a||1),u=(o.clientY-se.clientY+n.y)/(s||1)+(l?l[1]-_e[1]:0)/(s||1);if(!Pe.active&&!ve){if(r&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<r)return;this._onDragStart(e,!0)}if($){i?(i.e+=c-(ce||0),i.f+=u-(ue||0)):i={a:1,b:0,c:0,d:1,e:c,f:u};var d="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");k($,"webkitTransform",d),k($,"mozTransform",d),k($,"msTransform",d),k($,"transform",d),ce=c,ue=u,le=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!$){var e=this.options.fallbackOnBody?document.body:X,t=T(Y,!0,Ie,!0,e),r=this.options;if(Ie){for(ge=e;"static"===k(ge,"position")&&"none"===k(ge,"transform")&&ge!==document;)ge=ge.parentNode;ge!==document.body&&ge!==document.documentElement?(ge===document&&(ge=I()),t.top+=ge.scrollTop,t.left+=ge.scrollLeft):ge=I(),_e=N(ge)}_($=Y.cloneNode(!0),r.ghostClass,!1),_($,r.fallbackClass,!0),_($,r.dragClass,!0),k($,"transition",""),k($,"transform",""),k($,"box-sizing","border-box"),k($,"margin",0),k($,"top",t.top),k($,"left",t.left),k($,"width",t.width),k($,"height",t.height),k($,"opacity","0.8"),k($,"position",Ie?"absolute":"fixed"),k($,"zIndex","100000"),k($,"pointerEvents","none"),Pe.ghost=$,e.appendChild($),k($,"transform-origin",de/parseInt($.style.width)*100+"% "+pe/parseInt($.style.height)*100+"%")}},_onDragStart:function(e,t){var r=this,n=e.dataTransfer,o=r.options;z("dragStart",this,{evt:e}),Pe.eventCanceled?this._onDrop():(z("setupClone",this),Pe.eventCanceled||((Q=L(Y)).draggable=!1,Q.style["will-change"]="",this._hideClone(),_(Q,this.options.chosenClass,!1),Pe.clone=Q),r.cloneId=We((function(){z("clone",r),Pe.eventCanceled||(r.options.removeCloneOnHide||X.insertBefore(Q,Y),r._hideClone(),J({sortable:r,name:"clone"}))})),!t&&_(Y,o.dragClass,!0),t?(ye=!0,r._loopId=setInterval(r._emulateDragOver,50)):(g(document,"mouseup",r._onDrop),g(document,"touchend",r._onDrop),g(document,"touchcancel",r._onDrop),n&&(n.effectAllowed="move",o.setData&&o.setData.call(r,n,Y)),m(document,"drop",r),k(Y,"transform","translateZ(0)")),ve=!0,r._dragStartId=We(r._dragStarted.bind(r,t,e)),m(document,"selectstart",r),he=!0,p&&k(document.body,"user-select","none"))},_onDragOver:function(e){var t,r,n,o,i=this.el,s=e.target,l=this.options,c=l.group,u=Pe.active,d=ie===c,p=l.sort,h=ae||u,b=this,f=!1;if(!ke){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=O(s,l.draggable,i,!0),F("dragOver"),Pe.eventCanceled)return f;if(Y.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||b._ignoreWhileAnimating===s)return U(!1);if(ye=!1,u&&!l.disabled&&(d?p||(n=!X.contains(Y)):ae===this||(this.lastPutMode=ie.checkPull(this,u,Y,e))&&c.checkPut(this,u,Y,e))){if(o="vertical"===this._getDirection(e,s),t=T(Y),F("dragOverValid"),Pe.eventCanceled)return f;if(n)return H=X,L(),this._hideClone(),F("revert"),Pe.eventCanceled||(K?X.insertBefore(Y,K):X.appendChild(Y)),U(!0);var m=M(i,l.draggable);if(!m||function(e,t,r){var n=T(M(r.el,r.options.draggable)),o=10;return t?e.clientX>n.right+o||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+o}(e,o,this)&&!m.animated){if(m===Y)return U(!1);if(m&&i===e.target&&(s=m),s&&(r=T(s)),!1!==Le(X,i,Y,t,s,r,e,!!s))return L(),i.appendChild(Y),H=i,V(),U(!0)}else if(s.parentNode===i){r=T(s);var g,v,y,w=Y.parentNode!==i,j=!function(e,t,r){var n=r?e.left:e.top,o=r?e.right:e.bottom,i=r?e.width:e.height,a=r?t.left:t.top,s=r?t.right:t.bottom,l=r?t.width:t.height;return n===a||o===s||n+i/2===a+l/2}(Y.animated&&Y.toRect||t,s.animated&&s.toRect||r,o),S=o?"top":"left",E=x(s,"top","top")||x(Y,"top","top"),I=E?E.scrollTop:void 0;if(be!==s&&(v=r[S],we=!1,je=!j&&l.invertSwap||w),0!==(g=function(e,t,r,n,o,i,a,s){var l=n?e.clientY:e.clientX,c=n?r.height:r.width,u=n?r.top:r.left,d=n?r.bottom:r.right,p=!1;if(!a)if(s&&me<c*o){if(!we&&(1===fe?l>u+c*i/2:l<d-c*i/2)&&(we=!0),we)p=!0;else if(1===fe?l<u+me:l>d-me)return-fe}else if(l>u+c*(1-o)/2&&l<d-c*(1-o)/2)return function(e){return C(Y)<C(e)?1:-1}(t);if((p=p||a)&&(l<u+c*i/2||l>d-c*i/2))return l>u+c/2?1:-1;return 0}(e,s,r,o,j?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,je,be===s))){var A=C(Y);do{A-=g,y=H.children[A]}while(y&&("none"===k(y,"display")||y===$))}if(0===g||y===s)return U(!1);be=s,fe=g;var N=s.nextElementSibling,B=!1,D=Le(X,i,Y,t,s,r,e,B=1===g);if(!1!==D)return 1!==D&&-1!==D||(B=1===D),ke=!0,setTimeout(Ue,30),L(),B&&!N?i.appendChild(Y):s.parentNode.insertBefore(Y,B?N:s),E&&P(E,0,I-E.scrollTop),H=Y.parentNode,void 0===v||je||(me=Math.abs(v-T(s)[S])),V(),U(!0)}if(i.contains(Y))return U(!1)}return!1}function F(l,c){z(l,b,a({evt:e,isOwner:d,axis:o?"vertical":"horizontal",revert:n,dragRect:t,targetRect:r,canSort:p,fromSortable:h,target:s,completed:U,onMove:function(r,n){return Le(X,i,Y,t,r,T(r),e,n)},changed:V},c))}function L(){F("dragOverAnimationCapture"),b.captureAnimationState(),b!==h&&h.captureAnimationState()}function U(t){return F("dragOverCompleted",{insertion:t}),t&&(d?u._hideClone():u._showClone(b),b!==h&&(_(Y,ae?ae.options.ghostClass:u.options.ghostClass,!1),_(Y,l.ghostClass,!0)),ae!==b&&b!==Pe.active?ae=b:b===Pe.active&&ae&&(ae=null),h===b&&(b._ignoreWhileAnimating=s),b.animateAll((function(){F("dragOverAnimationComplete"),b._ignoreWhileAnimating=null})),b!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(s===Y&&!Y.animated||s===i&&!s.animated)&&(be=null),l.dragoverBubble||e.rootEl||s===document||(Y.parentNode[R]._isOutsideThisEl(e.target),!t&&De(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function V(){re=C(Y),oe=C(Y,l.draggable),J({sortable:b,name:"change",toEl:i,newIndex:re,newDraggableIndex:oe,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){g(document,"mousemove",this._onTouchMove),g(document,"touchmove",this._onTouchMove),g(document,"pointermove",this._onTouchMove),g(document,"dragover",De),g(document,"mousemove",De),g(document,"touchmove",De)},_offUpEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._onDrop),g(e,"touchend",this._onDrop),g(e,"pointerup",this._onDrop),g(e,"touchcancel",this._onDrop),g(document,"selectstart",this)},_onDrop:function(e){var t=this.el,r=this.options;re=C(Y),oe=C(Y,r.draggable),z("drop",this,{evt:e}),H=Y&&Y.parentNode,re=C(Y),oe=C(Y,r.draggable),Pe.eventCanceled||(ve=!1,je=!1,we=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),qe(this.cloneId),qe(this._dragStartId),this.nativeDraggable&&(g(document,"drop",this),g(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),p&&k(document.body,"user-select",""),k(Y,"transform",""),e&&(he&&(e.cancelable&&e.preventDefault(),!r.dropBubble&&e.stopPropagation()),$&&$.parentNode&&$.parentNode.removeChild($),(X===H||ae&&"clone"!==ae.lastPutMode)&&Q&&Q.parentNode&&Q.parentNode.removeChild(Q),Y&&(this.nativeDraggable&&g(Y,"dragend",this),Re(Y),Y.style["will-change"]="",he&&!ve&&_(Y,ae?ae.options.ghostClass:this.options.ghostClass,!1),_(Y,this.options.chosenClass,!1),J({sortable:this,name:"unchoose",toEl:H,newIndex:null,newDraggableIndex:null,originalEvent:e}),X!==H?(re>=0&&(J({rootEl:H,name:"add",toEl:H,fromEl:X,originalEvent:e}),J({sortable:this,name:"remove",toEl:H,originalEvent:e}),J({rootEl:H,name:"sort",toEl:H,fromEl:X,originalEvent:e}),J({sortable:this,name:"sort",toEl:H,originalEvent:e})),ae&&ae.save()):re!==te&&re>=0&&(J({sortable:this,name:"update",toEl:H,originalEvent:e}),J({sortable:this,name:"sort",toEl:H,originalEvent:e})),Pe.active&&(null!=re&&-1!==re||(re=te,oe=ne),J({sortable:this,name:"end",toEl:H,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){z("nulling",this),X=Y=H=$=K=Q=Z=ee=se=le=he=re=oe=te=ne=be=fe=ae=ie=Pe.dragged=Pe.ghost=Pe.clone=Pe.active=null,Se.forEach((function(e){e.checked=!0})),Se.length=ce=ue=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Y&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],r=this.el.children,n=0,o=r.length,i=this.options;n<o;n++)O(e=r[n],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||Ve(e));return t},sort:function(e,t){var r={},n=this.el;this.toArray().forEach((function(e,t){var o=n.children[t];O(o,this.options.draggable,n,!1)&&(r[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){r[e]&&(n.removeChild(r[e]),n.appendChild(r[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return O(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var r=this.options;if(void 0===t)return r[e];var n=q.modifyOption(this,e,t);r[e]="undefined"!==typeof n?n:t,"group"===e&&Ce(r)},destroy:function(){z("destroy",this);var e=this.el;e[R]=null,g(e,"mousedown",this._onTapStart),g(e,"touchstart",this._onTapStart),g(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(g(e,"dragover",this),g(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Oe.splice(Oe.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ee){if(z("hideClone",this),Pe.eventCanceled)return;k(Q,"display","none"),this.options.removeCloneOnHide&&Q.parentNode&&Q.parentNode.removeChild(Q),ee=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(ee){if(z("showClone",this),Pe.eventCanceled)return;Y.parentNode!=X||this.options.group.revertClone?K?X.insertBefore(Q,K):X.appendChild(Q):X.insertBefore(Q,Y),this.options.group.revertClone&&this.animate(Y,Q),k(Q,"display",""),ee=!1}}else this._hideClone()}},Ee&&m(document,"touchmove",(function(e){(Pe.active||ve)&&e.cancelable&&e.preventDefault()})),Pe.utils={on:m,off:g,css:k,find:E,is:function(e,t){return!!O(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},throttle:F,closest:O,toggleClass:_,clone:L,index:C,nextTick:We,cancelNextTick:qe,detectDirection:Me,getChild:A},Pe.get=function(e){return e[R]},Pe.mount=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Pe.utils=a({},Pe.utils,e.utils)),q.mount(e)}))},Pe.create=function(e,t){return new Pe(e,t)},Pe.version="1.13.0";var Ge,ze,Je,Ye,He,$e,Xe=[],Ke=!1;function Ze(){Xe.forEach((function(e){clearInterval(e.pid)})),Xe=[]}function Qe(){clearInterval($e)}var et=F((function(e,t,r,n){if(t.scroll){var o,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=I(),u=!1;ze!==r&&(ze=r,Ze(),Ge=t.scroll,o=t.scrollFn,!0===Ge&&(Ge=B(r,!0)));var d=0,p=Ge;do{var h=p,b=T(h),f=b.top,m=b.bottom,g=b.left,v=b.right,y=b.width,O=b.height,w=void 0,j=void 0,_=h.scrollWidth,S=h.scrollHeight,E=k(h),x=h.scrollLeft,A=h.scrollTop;h===c?(w=y<_&&("auto"===E.overflowX||"scroll"===E.overflowX||"visible"===E.overflowX),j=O<S&&("auto"===E.overflowY||"scroll"===E.overflowY||"visible"===E.overflowY)):(w=y<_&&("auto"===E.overflowX||"scroll"===E.overflowX),j=O<S&&("auto"===E.overflowY||"scroll"===E.overflowY));var M=w&&(Math.abs(v-i)<=s&&x+y<_)-(Math.abs(g-i)<=s&&!!x),C=j&&(Math.abs(m-a)<=s&&A+O<S)-(Math.abs(f-a)<=s&&!!A);if(!Xe[d])for(var N=0;N<=d;N++)Xe[N]||(Xe[N]={});Xe[d].vx==M&&Xe[d].vy==C&&Xe[d].el===h||(Xe[d].el=h,Xe[d].vx=M,Xe[d].vy=C,clearInterval(Xe[d].pid),0==M&&0==C||(u=!0,Xe[d].pid=setInterval(function(){n&&0===this.layer&&Pe.active._onTouchMove(He);var t=Xe[this.layer].vy?Xe[this.layer].vy*l:0,r=Xe[this.layer].vx?Xe[this.layer].vx*l:0;"function"===typeof o&&"continue"!==o.call(Pe.dragged.parentNode[R],r,t,e,He,Xe[this.layer].el)||P(Xe[this.layer].el,r,t)}.bind({layer:d}),24))),d++}while(t.bubbleScroll&&p!==c&&(p=B(p,!1)));Ke=u}}),30),tt=function(e){var t=e.originalEvent,r=e.putSortable,n=e.dragEl,o=e.activeSortable,i=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=r||o;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,u=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(u)&&(i("spill"),this.onSpill({dragEl:n,putSortable:r}))}};function rt(){}function nt(){}rt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,r=e.putSortable;this.sortable.captureAnimationState(),r&&r.captureAnimationState();var n=A(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),r&&r.animateAll()},drop:tt},i(rt,{pluginName:"revertOnSpill"}),nt.prototype={onSpill:function(e){var t=e.dragEl,r=e.putSortable||this.sortable;r.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),r.animateAll()},drop:tt},i(nt,{pluginName:"removeOnSpill"});Pe.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?m(document,"dragover",this._handleAutoScroll):this.options.supportPointer?m(document,"pointermove",this._handleFallbackAutoScroll):t.touches?m(document,"touchmove",this._handleFallbackAutoScroll):m(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):(g(document,"pointermove",this._handleFallbackAutoScroll),g(document,"touchmove",this._handleFallbackAutoScroll),g(document,"mousemove",this._handleFallbackAutoScroll)),Qe(),Ze(),clearTimeout(w),w=void 0},nulling:function(){He=ze=Ge=Ke=$e=Je=Ye=null,Xe.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var r=this,n=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(n,o);if(He=e,t||u||c||p){et(e,this.options,i,t);var a=B(i,!0);!Ke||$e&&n===Je&&o===Ye||($e&&Qe(),$e=setInterval((function(){var i=B(document.elementFromPoint(n,o),!0);i!==a&&(a=i,Ze()),et(e,r.options,i,t)}),10),Je=n,Ye=o)}else{if(!this.options.bubbleScroll||B(i,!0)===I())return void Ze();et(e,this.options,B(i,!1),!1)}}},i(e,{pluginName:"scroll",initializeByDefault:!0})}),Pe.mount(nt,rt),t.a=Pe}}]);
//# sourceMappingURL=90.ddc9a1e0.chunk.js.map