{"version":3,"file":"static/js/8178.e1c29128.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/layers/graphics/sources/WFSSourceWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.24/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import t from\"../../../core/Logger.js\";import{isSome as r,unwrap as s}from\"../../../core/maybe.js\";import{throwIfAborted as a,createTask as i,isAbortError as o}from\"../../../core/promiseUtils.js\";import{equals as n,WGS84 as u}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as p,convertToGeometry as h}from\"../featureConversionUtils.js\";import y from\"../data/FeatureStore.js\";import{project as c,checkProjectionSupport as m}from\"../data/projectionSupport.js\";import{QueryEngine as l}from\"../data/QueryEngine.js\";import{validateGeoJSON as g,createOptimizedFeatures as _}from\"./geojson/geojson.js\";import{mixAttributes as f}from\"./support/sourceUtils.js\";import{getFeature as d}from\"../../ogc/wfsUtils.js\";import w from\"../../support/FieldsIndex.js\";class E{constructor(){this._queryEngine=null,this._customParameters=null,this._snapshotFeatures=async e=>{const{objectIdField:t}=this._queryEngine,s=await d(this._getFeatureUrl,this._featureType.typeName,this._getFeatureOutputFormat,{customParameters:this._customParameters,dateFields:this._queryEngine.fieldsIndex.dateFields.map((e=>e.name)),signal:e});await g(s),a(e);const i=_(s,{geometryType:this._queryEngine.geometryType,hasZ:!1,objectIdField:t});if(!n(this._queryEngine.spatialReference,u))for(const a of i)r(a.geometry)&&(a.geometry=p(c(h(a.geometry,this._queryEngine.geometryType,!1,!1),u,this._queryEngine.spatialReference)));let o=1;for(const r of i){const e={};f(this._fieldsIndex,e,r.attributes,!0),r.attributes=e,null==r.attributes[t]&&(r.objectId=r.attributes[t]=o++)}return i}}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(e,t){const{getFeatureUrl:r,getFeatureOutputFormat:i,spatialReference:o,fields:n,geometryType:u,featureType:p,objectIdField:h,customParameters:c}=e;this._featureType=p,this._customParameters=c,this._getFeatureUrl=r,this._getFeatureOutputFormat=i,this._fieldsIndex=new w(n),await this._checkProjection(o),a(t),this._queryEngine=new l({fields:n,geometryType:u,hasM:!1,hasZ:!1,objectIdField:h,spatialReference:o,timeInfo:null,featureStore:new y({geometryType:u,hasM:!1,hasZ:!1})});const m=await this._snapshotFeatures(s(t.signal));return this._queryEngine.featureStore.addMany(m),{extent:this._queryEngine.fullExtent}}async applyEdits(){throw new e(\"wfs-source:editing-not-supported\",\"applyEdits() is not supported on WFSLayer\")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(e,t.signal)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(e,t.signal)}async refresh(r){return this._customParameters=r,this._snapshotTask?.abort(),this._snapshotTask=i(this._snapshotFeatures),this._snapshotTask.promise.then((e=>{this._queryEngine.featureStore.clear(),e&&this._queryEngine.featureStore.addMany(e)}),(r=>{this._queryEngine.featureStore.clear(),o(r)||t.getLogger(\"esri.layers.WFSLayer\").error(new e(\"wfs-layer:getfeature-error\",\"An error occurred during the GetFeature request\",{error:r}))})),await this._waitSnapshotComplete(),{extent:this._queryEngine.fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _checkProjection(t){try{await m(u,t)}catch{throw new e(\"unsupported-projection\",\"Projection not supported\",{spatialReference:t})}}}export{E as default};\n"],"names":["E","constructor","this","_queryEngine","_customParameters","_snapshotFeatures","async","objectIdField","t","s","d","_getFeatureUrl","_featureType","typeName","_getFeatureOutputFormat","customParameters","dateFields","fieldsIndex","map","e","name","signal","g","a","i","_","geometryType","hasZ","n","spatialReference","u","r","geometry","p","c","h","o","f","_fieldsIndex","attributes","objectId","destroy","getFeatureUrl","getFeatureOutputFormat","fields","featureType","w","_checkProjection","l","hasM","timeInfo","featureStore","y","m","addMany","extent","fullExtent","_waitSnapshotComplete","executeQuery","executeQueryForCount","executeQueryForIds","executeQueryForExtent","executeQueryForSnapping","_snapshotTask","abort","promise","then","clear","error","finished"],"sourceRoot":""}