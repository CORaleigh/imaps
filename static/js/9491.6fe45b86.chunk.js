"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[9491],{80573:(e,t,i)=>{i.d(t,{Z:()=>_});var s=i(27366),n=i(85015),r=i(11582),a=i(79056),o=i(46784),l=i(92026),u=i(49861),h=(i(63780),i(93169),i(25243),i(69912));let c=0,d=class extends((0,o.eC)((0,r.J)((0,a.IG)(n.Z)))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${c++}`,this.title=null}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if((0,l.pC)(t))switch(t.type){case"line-of-sight":t.removeAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this)}this._set("parent",e)}get isEditable(){return this.requiredPropertiesForEditing.every(l.pC)}};(0,s._)([(0,u.Cb)({type:String,constructOnly:!0,clonable:!1})],d.prototype,"id",void 0),(0,s._)([(0,u.Cb)({type:String})],d.prototype,"title",void 0),(0,s._)([(0,u.Cb)({constructOnly:!0})],d.prototype,"type",void 0),(0,s._)([(0,u.Cb)({clonable:!1,value:null})],d.prototype,"parent",null),(0,s._)([(0,u.Cb)({readOnly:!0})],d.prototype,"extent",void 0),(0,s._)([(0,u.Cb)({readOnly:!0})],d.prototype,"isEditable",null),(0,s._)([(0,u.Cb)({readOnly:!0})],d.prototype,"requiredPropertiesForEditing",void 0),(0,s._)([(0,u.Cb)({readOnly:!0})],d.prototype,"nonEditableMessage",void 0),d=(0,s._)([(0,h.j)("esri.analysis.Analysis")],d);const _=d},58971:(e,t,i)=>{i.d(t,{G6:()=>C,Ie:()=>A,J9:()=>w,RF:()=>f,U1:()=>E,vY:()=>l,ym:()=>v});var s=i(92026),n=i(77981);const r=(e,t,i)=>[t,i],a=(e,t,i)=>[t,i,e[2]],o=(e,t,i)=>[t,i,e[2],e[3]];function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,s.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function u(e,t){let{scale:i,translate:s}=e;return Math.round((t-s[0])/i[0])}function h(e,t){let{scale:i,translate:s}=e;return Math.round((s[1]-t)/i[1])}function c(e,t,i){const s=[];let n,r,a,o;for(let l=0;l<i.length;l++){const c=i[l];l>0?(a=u(e,c[0]),o=h(e,c[1]),a===n&&o===r||(s.push(t(c,a-n,o-r)),n=a,r=o)):(n=u(e,c[0]),r=h(e,c[1]),s.push(t(c,n,r)))}return s.length>0?s:null}function d(e,t){let{scale:i,translate:s}=e;return t*i[0]+s[0]}function _(e,t){let{scale:i,translate:s}=e;return s[1]-t*i[1]}function p(e,t,i){const s=new Array(i.length);if(!i.length)return s;const[n,r]=e.scale;let a=d(e,i[0][0]),o=_(e,i[0][1]);s[0]=t(i[0],a,o);for(let l=1;l<i.length;l++){const e=i[l];a+=e[0]*n,o-=e[1]*r,s[l]=t(e,a,o)}return s}function y(e,t,i){const s=new Array(i.length);for(let n=0;n<i.length;n++)s[n]=p(e,t,i[n]);return s}function g(e,t,i,s,n){return t.points=function(e,t,i,s){return c(e,i?s?o:a:s?a:r,t)}(e,i.points,s,n),t}function f(e,t,i,s,n){return t.x=u(e,i.x),t.y=h(e,i.y),t!==i&&(s&&(t.z=i.z),n&&(t.m=i.m)),t}function b(e,t,i,s,n){const l=function(e,t,i,s){const n=[],l=i?s?o:a:s?a:r;for(let r=0;r<t.length;r++){const i=c(e,l,t[r]);i&&i.length>=3&&n.push(i)}return n.length?n:null}(e,i.rings,s,n);return l?(t.rings=l,t):null}function m(e,t,i,s,n){const l=function(e,t,i,s){const n=[],l=i?s?o:a:s?a:r;for(let r=0;r<t.length;r++){const i=c(e,l,t[r]);i&&i.length>=2&&n.push(i)}return n.length?n:null}(e,i.paths,s,n);return l?(t.paths=l,t):null}function v(e,t){return e&&t?(0,n.wp)(t)?f(e,{},t,!1,!1):(0,n.l9)(t)?m(e,{},t,!1,!1):(0,n.oU)(t)?b(e,{},t,!1,!1):(0,n.aW)(t)?g(e,{},t,!1,!1):(0,n.YX)(t)?function(e,t,i,s,n){return t.xmin=u(e,i.xmin),t.ymin=h(e,i.ymin),t.xmax=u(e,i.xmax),t.ymax=h(e,i.ymax),t!==i&&(s&&(t.zmin=i.zmin,t.zmax=i.zmax),n&&(t.mmin=i.mmin,t.mmax=i.mmax)),t}(e,{},t,!1,!1):null:null}function w(e,t,i,n,l){return(0,s.pC)(i)&&(t.points=function(e,t,i,s){return p(e,i?s?o:a:s?a:r,t)}(e,i.points,n,l)),t}function E(e,t,i,n,r){return(0,s.Wi)(i)||(t.x=d(e,i.x),t.y=_(e,i.y),t!==i&&(n&&(t.z=i.z),r&&(t.m=i.m))),t}function A(e,t,i,n,l){return(0,s.pC)(i)&&(t.rings=function(e,t,i,s){return y(e,i?s?o:a:s?a:r,t)}(e,i.rings,n,l)),t}function C(e,t,i,n,l){return(0,s.pC)(i)&&(t.paths=function(e,t,i,s){return y(e,i?s?o:a:s?a:r,t)}(e,i.paths,n,l)),t}},74509:(e,t,i)=>{i.d(t,{Lt:()=>u,Ou:()=>c,RL:()=>l,VW:()=>a,Zz:()=>r,vQ:()=>d,vu:()=>o,zx:()=>_});var s=i(92026),n=i(88152);function r(e,t){return(0,s.Wi)(t)||!t.mode?e?"absolute-height":"on-the-ground":t.mode}function a(e,t){return r(!!(0,s.pC)(e)&&e.hasZ,t)}function o(e){const t=h(e);return a(e.geometry,t)}function l(e){const t=h(e),i=a(e.geometry,t);return{mode:i,offset:(0,s.pC)(t)&&"on-the-ground"!==i?(0,s.Pt)(t.offset,0)*(0,n.Z7)((0,s.Pt)(t.unit,"meters")):0}}function u(e){if("on-the-ground"===o(e))return!1;const t=h(e),i=(0,s.pC)(t)&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!i||"0"===i)}function h(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function c(e,t,i){if((0,s.Wi)(i)||!i.mode)return;const n=e.hasZ?e.z:0,r=(0,s.pC)(i.offset)?i.offset:0;switch(i.mode){case"absolute-height":return n-r;case"on-the-ground":return 0;case"relative-to-ground":return n-((0,s.Pt)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+r);case"relative-to-scene":return n-((0,s.Pt)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+r)}}function d(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return p(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,s)}function _(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return p(e,t[0],t[1],t.length>2?t[2]:0,i,s,n)}function p(e,t,i,n,r,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if((0,s.Wi)(a))return;const l=(0,s.pC)(o)?o.mode:"absolute-height";if("on-the-ground"===l)return 0;const{absoluteZ:u}=y(t,i,n,r,e,a);return g(u,t,i,n,r,e,o,l)}function y(e,t,i,n,r,a){const o=(0,s.pC)(a.offset)?a.offset:0;switch(a.mode){case"absolute-height":return{absoluteZ:i+o,elevation:0};case"on-the-ground":{const i=(0,s.Pt)(r.elevationProvider.getElevation(e,t,0,n,"ground"),0);return{absoluteZ:i,elevation:i}}case"relative-to-ground":{const a=(0,s.Pt)(r.elevationProvider.getElevation(e,t,i,n,"ground"),0);return{absoluteZ:i+a+o,elevation:a}}case"relative-to-scene":{const a=(0,s.Pt)(r.elevationProvider.getElevation(e,t,i,n,"scene"),0);return{absoluteZ:i+a+o,elevation:a}}}}function g(e,t,i,n,r,a,o,l){const u=(0,s.pC)(o)&&(0,s.pC)(o.offset)?o.offset:0;switch(l){case"absolute-height":return e-u;case"relative-to-ground":return e-((0,s.Pt)(a.elevationProvider.getElevation(t,i,n,r,"ground"),0)+u);case"relative-to-scene":return e-((0,s.Pt)(a.elevationProvider.getElevation(t,i,n,r,"scene"),0)+u)}}},48681:(e,t,i)=>{i.d(t,{y1:()=>a});i(11186);var s=i(71353),n=(i(2170),i(80885)),r=(i(79803),i(78952));i(15559),i(80064);function a(e){return"mouse"!==e.pointerType||0===e.button}const o=(0,s.c)(),l=(0,s.c)(),u=(0,s.c)();new n.Z({rings:[[o,l,u]],spatialReference:r.Z.WGS84}),(0,s.c)()},92382:(e,t,i)=>{i.d(t,{G:()=>n,e:()=>s});class s{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.screenPoint=e,this.result=t}}class n{constructor(e,t){this.scenePoint=e,this.mapPoint=t}}},86509:(e,t,i)=>{i.d(t,{f:()=>l});var s=i(27366),n=i(94172),r=i(49861),a=(i(63780),i(93169),i(25243),i(69912)),o=i(45900);let l=class extends o.m{constructor(e){super(e)}initialize(){this.own((0,n.YP)((()=>this.analysisViewData.visible),(e=>this.visible=e),n.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};(0,s._)([(0,r.Cb)({constructOnly:!0})],l.prototype,"analysis",void 0),(0,s._)([(0,r.Cb)()],l.prototype,"analysisViewData",void 0),l=(0,s._)([(0,a.j)("esri.views.interactive.AnalysisToolBase")],l)},44070:(e,t,i)=>{i.d(t,{f:()=>c});var s=i(63780),n=i(32718),r=i(92026),a=i(18722),o=i(37825),l=i(49800),u=i(8548);const h=n.Z.getLogger("esri.views.webgl.BufferObject");class c{constructor(e,t,i,s){this._context=e,this.bufferType=t,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(u._g.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,o.zu)(this._context.gl),s&&this.setData(s)}static createIndex(e,t,i){return new c(e,u.w0.ELEMENT_ARRAY_BUFFER,t,i)}static createVertex(e,t,i){return new c(e,u.w0.ARRAY_BUFFER,t,i)}static createUniform(e,t,i){if(e.type!==l.zO.WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new c(e,u.w0.UNIFORM_BUFFER,t,i)}static createPixelPack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.l1.STREAM_READ,i=arguments.length>2?arguments[2]:void 0;if(e.type!==l.zO.WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");const s=new c(e,u.w0.PIXEL_PACK_BUFFER,t);return i&&s.setSize(i),s}static createPixelUnpack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.l1.STREAM_DRAW,i=arguments.length>2?arguments[2]:void 0;if(e.type!==l.zO.WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new c(e,u.w0.PIXEL_UNPACK_BUFFER,t,i)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get byteSize(){return this.bufferType===u.w0.ELEMENT_ARRAY_BUFFER?this._indexType===u.g.UNSIGNED_INT?4*this._size:2*this._size:this._size}get _isVAOAware(){return this.bufferType===u.w0.ELEMENT_ARRAY_BUFFER||this.bufferType===u.w0.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(u._g.BufferObject,this),this._context=null):this._glName&&h.warn("Leaked WebGL buffer object")}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e<=0&&h.error("Buffer size needs to be positive!"),this.bufferType===u.w0.ELEMENT_ARRAY_BUFFER&&(0,r.pC)(t))switch(this._indexType=t,t){case u.g.UNSIGNED_SHORT:e*=2;break;case u.g.UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===u.w0.ELEMENT_ARRAY_BUFFER&&((0,a.Uc)(e)&&(t/=2,this._indexType=u.g.UNSIGNED_SHORT),(0,a.ZY)(e)&&(t/=4,this._indexType=u.g.UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._size=e;const i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const s=this._context.gl;(0,r.pC)(t)?s.bufferData(this.bufferType,t,this.usage):s.bufferData(this.bufferType,e,this.usage),(0,o.zu)(s),this._isVAOAware&&this._context.bindVAO(i)}setSubData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength;if(!e)return;(t<0||t>=this._size)&&h.error("offset is out of range!");let n=t,r=i,l=s,c=e.byteLength;this.bufferType===u.w0.ELEMENT_ARRAY_BUFFER&&((0,a.Uc)(e)?(c/=2,n*=2,r*=2,l*=2):(0,a.ZY)(e)&&(c/=4,n*=4,r*=4,l*=4)),void 0===s&&(s=c-1),i>=s&&h.error("end must be bigger than start!"),t+i-s>this._size&&h.error("An attempt to write beyond the end of the buffer!");const d=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const _=this._context.gl,p=ArrayBuffer.isView(e)?e.buffer:e,y=0===r&&l===e.byteLength?p:p.slice(r,l);_.bufferSubData(this.bufferType,n,y),(0,o.zu)(_),this._isVAOAware&&this._context.bindVAO(d)}setSubDataFromView(e,t,i,s){if(!e)return;(t<0||t>=this._size)&&h.error("offset is out of range!"),i>=s&&h.error("end must be bigger than start!"),t+i-s>this._size&&h.error("An attempt to write beyond the end of the buffer!");const n=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const r=this._context.gl;if(this._context.type===l.zO.WEBGL2)r.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,i,s-i);else{const n=0===i&&s===e.length?e:e.subarray(i,s);r.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,n)}(0,o.zu)(r),this._isVAOAware&&this._context.bindVAO(n)}getSubData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(this._context.type!==l.zO.WEBGL2)return void h.error("Get buffer subdata is supported in WebGL2 only!");if(i<0||n<0)return void h.error("Problem getting subdata: offset and length were less than zero!");const r=function(e){return(0,s.zG)(e)}(e)?e.BYTES_PER_ELEMENT:1;if(r*((i??0)+(n??0))>e.byteLength)return void h.error("Problem getting subdata: offset and length exceeded destination size!");t+r*(n??0)>this.byteSize&&h.warn("Potential problem getting subdata: requested data exceeds buffer size!");const a=this._context.gl;this._context.bindBuffer(this,u.w0.COPY_READ_BUFFER),a.getBufferSubData(u.w0.COPY_READ_BUFFER,t,e,i,n),this._context.unbindBuffer(u.w0.COPY_READ_BUFFER)}async getSubDataAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this._context.type===l.zO.WEBGL2?(await this._context.clientWaitAsync(),this.getSubData(e,t,i,s)):h.error("Get buffer subdata is supported in WebGL2 only!")}}},3384:(e,t,i)=>{i.d(t,{HH:()=>r,RG:()=>u,UF:()=>l,XP:()=>o,_V:()=>a,un:()=>h});i(93169);var s=i(92026),n=i(8548);function r(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"A numeric argument is out of range";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(e,t){return e.vertexBuffers[t].size/function(e){return e[0].stride}(e.layout[t])}function o(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const r=e.gl,a=e.capabilities.instancing;e.bindBuffer(i);for(const o of s){const e=t.get(o.name);void 0===e&&console.error(`There is no location for vertex attribute '${o.name}' defined.`);const i=n*o.stride;if(o.count<=4)r.vertexAttribPointer(e,o.count,o.type,o.normalized,o.stride,o.offset+i),r.enableVertexAttribArray(e),o.divisor>0&&a&&a.vertexAttribDivisor(e,o.divisor);else if(9===o.count)for(let t=0;t<3;t++)r.vertexAttribPointer(e+t,3,o.type,o.normalized,o.stride,o.offset+12*t+i),r.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else if(16===o.count)for(let t=0;t<4;t++)r.vertexAttribPointer(e+t,4,o.type,o.normalized,o.stride,o.offset+16*t+i),r.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count)}}function l(e,t,i,s){const r=e.gl,a=e.capabilities.instancing;e.bindBuffer(i);for(const n of s){const e=t.get(n.name);if(n.count<=4)r.disableVertexAttribArray(e),n.divisor&&n.divisor>0&&a&&a.vertexAttribDivisor(e,0);else if(9===n.count)for(let t=0;t<3;t++)r.disableVertexAttribArray(e+t),n.divisor&&n.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else if(16===n.count)for(let t=0;t<4;t++)r.disableVertexAttribArray(e+t),n.divisor&&n.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else console.error("Unsupported vertex attribute element count: "+n.count)}e.unbindBuffer(n.w0.ARRAY_BUFFER)}function u(e){switch(e){case n.VI.ALPHA:case n.VI.LUMINANCE:case n.VI.RED:case n.VI.RED_INTEGER:case n.lP.R8:case n.lP.R8I:case n.lP.R8UI:case n.lP.R8_SNORM:case n.Tg.STENCIL_INDEX8:return 1;case n.VI.LUMINANCE_ALPHA:case n.VI.RG:case n.VI.RG_INTEGER:case n.lP.RGBA4:case n.lP.R16F:case n.lP.R16I:case n.lP.R16UI:case n.lP.RG8:case n.lP.RG8I:case n.lP.RG8UI:case n.lP.RG8_SNORM:case n.lP.RGB565:case n.lP.RGB5_A1:case n.Tg.DEPTH_COMPONENT16:return 2;case n.VI.DEPTH_COMPONENT:case n.VI.RGB:case n.VI.RGB_INTEGER:case n.lP.RGB8:case n.lP.RGB8I:case n.lP.RGB8UI:case n.lP.RGB8_SNORM:case n.lP.SRGB8:case n.Tg.DEPTH_COMPONENT24:return 3;case n.VI.DEPTH_STENCIL:case n.VI.RGBA:case n.VI.RGBA_INTEGER:case n.lP.RGBA8:case n.lP.R32F:case n.lP.R11F_G11F_B10F:case n.lP.RG16F:case n.lP.R32I:case n.lP.R32UI:case n.lP.RG16I:case n.lP.RG16UI:case n.lP.RGBA8I:case n.lP.RGBA8UI:case n.lP.RGBA8_SNORM:case n.lP.SRGB8_ALPHA8:case n.lP.RGB9_E5:case n.lP.RGB10_A2UI:case n.lP.RGB10_A2:case n.Tg.DEPTH_STENCIL:case n.Tg.DEPTH_COMPONENT32F:case n.Tg.DEPTH24_STENCIL8:return 4;case n.Tg.DEPTH32F_STENCIL8:return 5;case n.lP.RGB16F:case n.lP.RGB16I:case n.lP.RGB16UI:return 6;case n.lP.RG32F:case n.lP.RG32I:case n.lP.RG32UI:case n.lP.RGBA16F:case n.lP.RGBA16I:case n.lP.RGBA16UI:return 8;case n.lP.RGB32F:case n.lP.RGB32I:case n.lP.RGB32UI:return 12;case n.lP.RGBA32F:case n.lP.RGBA32I:case n.lP.RGBA32UI:return 16;case n.q_.COMPRESSED_RGB_S3TC_DXT1_EXT:case n.q_.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case n.q_.COMPRESSED_RGBA_S3TC_DXT3_EXT:case n.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case n.q_.COMPRESSED_R11_EAC:case n.q_.COMPRESSED_SIGNED_R11_EAC:case n.q_.COMPRESSED_RGB8_ETC2:case n.q_.COMPRESSED_SRGB8_ETC2:case n.q_.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case n.q_.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case n.q_.COMPRESSED_RG11_EAC:case n.q_.COMPRESSED_SIGNED_RG11_EAC:case n.q_.COMPRESSED_RGBA8_ETC2_EAC:case n.q_.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}function h(e){if((0,s.Wi)(e))return 0;if("descriptor"in e)return e.glName?h(e.descriptor):0;const t=e.internalFormat||"pixelFormat"in e&&e.pixelFormat;if(!t)return 0;const i="hasMipmap"in e&&e.hasMipmap?1.3:1,n=e.width*e.height;return u(t)*n*i}},45412:(e,t,i)=>{i.d(t,{U:()=>l});var s=i(32718),n=i(92026),r=i(8548),a=i(3384);const o=s.Z.getLogger("esri.views.webgl.VertexArrayObject");class l{constructor(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._context=e,this._locations=t,this._layout=i,this._buffers=s,this._indexBuffer=n,this._glName=null,this._initialized=!1,e.instanceCounter.increment(r._g.VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce(((e,t)=>e+this._buffers[t].size),(0,n.pC)(this._indexBuffer)?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._context){if(this._glName){const e=this._context?.capabilities?.vao;e?(e.deleteVertexArray(this._glName),this._glName=null):o.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(const e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer=(0,n.O3)(this._indexBuffer)}this._context.instanceCounter.decrement(r._g.VertexArrayObject,this),this._context=null}else(this._glName||e&&Object.getOwnPropertyNames(this._buffers).length>0)&&o.warn("Leaked WebGL VAO")}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:i}=this;e||o.error("Vertex buffer dictionary is empty!");const s=this._context.gl;for(const n in e){const i=e[n];i||o.error("Vertex buffer is uninitialized!");const s=t[n];s||o.error("Vertex element descriptor is empty!"),(0,a.XP)(this._context,this._locations,i,s)}(0,n.pC)(i)&&(this._context.capabilities.vao?s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:e,_layout:t}=this;e||o.error("Vertex buffer dictionary is empty!");for(const i in e){const s=e[i];s||o.error("Vertex buffer is uninitialized!");const n=t[i];(0,a.UF)(this._context,this._locations,s,n)}(0,n.pC)(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}},96211:(e,t,i)=>{i.r(t),i.d(t,{default:()=>q});var s=i(27366),n=i(66978),r=i(68860),a=i(8025),o=i(63780),l=(i(93169),i(25243),i(49861)),u=i(69912),h=i(69407),c=i(80573),d=i(32718),_=i(92026),p=i(80885);const y=d.Z.getLogger("esri.analysis.AreaMeasurementAnalysis");let g=class extends c.Z{constructor(e){super(e),this.type="area-measurement",this.extent=null,this.unit=null,this.nonEditableMessage="Assign a closed polygon geometry containing more than two points to the analysis to allow editing."}set geometry(e){if((0,_.Wi)(e))return this._set("geometry",null),void this._set("extent",null);e.rings.length>1&&y.warn("Measuring polygons with multiple rings is not supported."),this._set("geometry",e.clone()),this._set("extent",e.extent)}get requiredPropertiesForEditing(){if((0,_.pC)(this.geometry)&&1===this.geometry.rings.length){const e=this.geometry.rings[0];if(e.length<=2||!(0,o.fS)(e[0],e[e.length-1]))return[null]}return[this.geometry]}clear(){this.geometry=null}};(0,s._)([(0,l.Cb)({type:["area-measurement"]})],g.prototype,"type",void 0),(0,s._)([(0,l.Cb)({value:null,type:p.Z})],g.prototype,"geometry",null),(0,s._)([(0,l.Cb)({readOnly:!0})],g.prototype,"extent",void 0),(0,s._)([(0,l.Cb)({type:r.fN,value:null})],g.prototype,"unit",void 0),(0,s._)([(0,l.Cb)({readOnly:!0})],g.prototype,"requiredPropertiesForEditing",null),(0,s._)([(0,l.Cb)({readOnly:!0})],g.prototype,"nonEditableMessage",void 0),g=(0,s._)([(0,u.j)("esri.analysis.AreaMeasurementAnalysis")],g);const f=g;var b=i(55785),m=i(100),v=i(94172),w=i(37818),E=i(48681),A=i(51328),C=i(84652),V=i(17842),x=i(71353),R=i(83639),P=i(92382),T=i(62389),O=i(70619),D=i(81268),S=i(54463),I=i(92853);const M={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25};class B{constructor(e){this.vertexManipulators=[],this._analysisViewData=null,this._destroyed=!1,this._isManipulatorsOwner=!0,this._visible=!0,this._laserLine=null,this._cursorManipulator=null,this._listenerHandles=null,this._tempHandlePosition=(0,x.c)();const{analysisViewData:t,manipulators:i,toolState:s,view:n,visible:r}=e;this._analysisViewData=t,this._toolState=s,null!=i?(this._manipulators=i,this._isManipulatorsOwner=!1):this._manipulators=new I.D,this._view=n;const a=this._style=function(e,t){return{...e,...(0,C.d9)(t)}}(M,e.style);this._intersector=(0,D.Z8)(n.state.viewingMode),this._intersector.options.store=S.eC.MIN;const o=(0,R.aD)(n,a.handleColor,a.handleOpacity);o.available=!1,o.radius=a.handleRadius,o.interactive=!1,this._manipulators.add(o),this._cursorManipulator=o,this._laserLine=new T.W({view:n,attached:!0,style:{glowColor:a.laserLineGlowColor,glowWidth:a.laserLineGlowWidth,glowFalloff:a.laserLineGlowFalloff,innerColor:a.laserLineInnerColor,innerWidth:a.laserLineInnerWidth,globalAlpha:a.laserLineGlobalAlpha}}),this._updateVisibility(r||!0)}destroy(){this._listenerHandles=(0,_.SC)(this._listenerHandles),this._isManipulatorsOwner?this._manipulators=(0,_.SC)(this._manipulators):this._manipulators=null,this._laserLine=(0,_.SC)(this._laserLine),this._destroyed=!0}get destroyed(){return this._destroyed}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){const e=this._laserLine.testData;return{laserLineRenderer:(0,_.pC)(e)?{heightManifoldEnabled:e.heightManifoldEnabled,heightManifoldTarget:e.heightManifoldTarget,pointDistanceEnabled:e.pointDistanceEnabled,pointDistanceOrigin:e.pointDistanceOrigin,pointDistanceTarget:e.pointDistanceTarget,lineVerticalPlaneEnabled:e.lineVerticalPlaneEnabled}:{heightManifoldEnabled:!1,heightManifoldTarget:null,pointDistanceEnabled:!1,pointDistanceOrigin:null,pointDistanceTarget:null,lineVerticalPlaneEnabled:!1}}}show(){this._setVisibility(!0)}hide(){this._setVisibility(!1)}_setVisibility(e){this._destroyed||this._visible===e||this._updateVisibility(e)}_updateVisibility(e){this._visible=e,this._laserLine.visible=e,e?(this._initializeListeners(),this._updateAll()):(this._destroyListeners(),this.vertexManipulators.forEach((e=>{this._removeVertexManipulator(e.manipulator)})),this.vertexManipulators=[],this._view.cursor=null)}vertexHandleAt(e,t){const i=this._manipulators.intersect(e,t);return(0,_.pC)(i)?i.manipulator.metadata:null}pick(e){const t=this._view.spatialReference,i=(0,V.md)(e.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(i,this._intersector);const s=this._intersector.results.min,n=(0,x.c)();if(!s.getIntersectionPoint(n))return null;const r=this._view.renderCoordsHelper.fromRenderCoords(n,t);return(0,_.Wi)(r)?null:new P.G(n,r)}_updateAll(){this._visible&&(this._updateVertexManipulators(),this._updateLaserLine())}_createVertexManipulator(){const e=(0,R.aD)(this._view,this._style.handleColor,this._style.handleOpacity);return e.radius=this._style.handleRadius,{id:this._manipulators.add(e),manipulator:e}}_removeVertexManipulator(e){this._manipulators.remove(e)}_updateVertexManipulators(){const{viewData:e}=this._analysisViewData,t=this._analysisViewData.path?this._analysisViewData.path.vertices:[],i=this.vertexManipulators;(function(e,t,i,s){for(;e.length<t;)e.push(i());if(s)for(;e.length>t;)s(e.pop());else e.length=t})(i,t.length,(()=>this._createVertexManipulator()),(e=>this._removeVertexManipulator(e.manipulator))),i.forEach(((i,s)=>{i.manipulator.metadata=t[s],i.manipulator.renderLocation=e.positionsRenderCoords[s]})),"drawing"===this._toolState.polygonState&&(0,_.pC)(this._analysisViewData.cursorPoint)?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._analysisViewData.cursorPoint):this._cursorManipulator.available=!1}_getFocusPoint(){const{lastDraggedVertex:e}=this._analysisViewData;switch(this._toolState.polygonState){case"drawing":return(0,_.pC)(this._analysisViewData.cursorPoint)?this._analysisViewData.cursorPoint:(0,_.pC)(e)?this._analysisViewData.path.getVertexPositionAsPoint(e):(0,_.Wg)(this._analysisViewData.path.lastPoint);case"editing":return(0,_.pC)(e)?this._analysisViewData.path.getVertexPositionAsPoint(e):null;default:return this._analysisViewData.cursorPoint}}_updateLaserLine(){const e=this._style.laserLineEnabled&&"measured"!==this._toolState.polygonState&&this._toolState.active,t=this._getFocusPoint();if(e&&(0,_.pC)(t)){const e=this._tempHandlePosition;this._view.renderCoordsHelper.toRenderCoords(t,e),this._laserLine.heightManifoldTarget=e}else this._laserLine.heightManifoldTarget=null}_initializeListeners(){this._listenerHandles=new m.Z,this._listenerHandles.add([(0,v.YP)((()=>this._toolState.polygonState),(()=>this._updateLaserLine())),(0,v.YP)((()=>this._analysisViewData.viewData),(()=>this._updateAll()),v.Z_),(0,v.YP)((()=>({lastDraggedVertex:this._analysisViewData.lastDraggedVertex,cursorPoint:this._analysisViewData.cursorPoint})),(()=>this._updateLaserLine())),(0,v.YP)((()=>this._toolState.active),(()=>this._updateAll()))])}_destroyListeners(){this._listenerHandles=(0,_.SC)(this._listenerHandles)}}B._handleGeometry=O.Z.createSphereGeometry(1,32,32);var L=i(86509),G=i(74229),N=i(72612);let U=class extends L.f{constructor(e){super(e),this._handles=new m.Z,this.polygonState="initial",this.analysisViewData=null}initialize(){const{view:e,analysisViewData:t,manipulators:i,visible:s}=this;this.measurementView=new B({view:e,analysisViewData:t,toolState:this,manipulators:i,visible:s}),this._setupManipulators(),this._handles.add((0,v.YP)((()=>this.state),(e=>{"measured"===e&&this.finishToolCreation()}),v.tX))}destroy(){this.measurementView.destroy(),this._set("measurementView",null),this._handles=(0,_.SC)(this._handles)}get state(){return 0===this.analysisViewData.path.numVertices?"ready":this.analysisViewData.validMeasurement&&"editing"!==this.polygonState?"measured":"measuring"}get cursor(){return"ready"===this.state||"drawing"===this.polygonState?"crosshair":null}finishMeasurement(){const{path:e}=this.analysisViewData;e.numVertices<3?(e.clear(),this.polygonState="initial"):(e.close(),this.polygonState="measured"),this.analysisViewData.cursorPoint=null}onShow(){this.measurementView.show()}onHide(){this.measurementView.hide()}onInputEvent(e){switch(e.type){case"immediate-double-click":this._handleImmediateDoubleClick(e);break;case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"drag":this._handleDrag(e);break;case"key-down":this._handleKeyDown(e)}}_setupManipulators(){const e=e=>`manipulator-${e}`,t=e=>e.events.on("grab-changed",(()=>{if(this.analysisViewData.validMeasurement){const e=this.manipulators.some((e=>e.manipulator.grabbing));this.polygonState=e?"editing":"measured"}})),i=(i,s)=>{this._handles.add([(0,G.Xd)(s,((e,t,i)=>{const s=(0,A.J4)(e),n=(0,_.Wg)(e.metadata);t.next(s).next((0,A.gv)(this.view)).next((t=>{e.location=t.mapEnd,this.analysisViewData.path.setVertexPosition(n,(0,w.WG)(t.mapEnd))}));const r=(0,w.WG)(this.analysisViewData.path.getVertexPositionAsPoint(n));i.next(s).next((()=>{this.analysisViewData.path.setVertexPosition(n,r),e.location=r}))})),t(s)],e(i))},s=t=>{this._handles.remove(e(t))};this.manipulators.forEach((e=>{let{id:t,manipulator:s}=e;i(t,s)})),this._handles.add([this.manipulators.on("after-add",(e=>{let{item:{id:t,manipulator:s}}=e;i(t,s)})),this.manipulators.on("after-remove",(e=>{let{item:{id:t}}=e;s(t)}))])}_handleImmediateDoubleClick(e){(0,E.y1)(e)&&("drawing"===this.polygonState&&this.finishMeasurement(),e.stopPropagation())}_handleDrag(e){"editing"===this.polygonState&&e.stopPropagation()}_handleImmediateClick(e){if(!(0,E.y1)(e))return;const t=(0,N.vT)(e);if(this.active)switch(this.polygonState){case"initial":if(this._addVertexAt(t))return this.analysisViewData.cursorPoint=null,this.polygonState="drawing",void e.stopPropagation();break;case"drawing":{const i=this.measurementView.vertexHandleAt(t,e.pointerType);if((0,_.Wi)(i)){if(this._addVertexAt(t))return this.analysisViewData.cursorPoint=null,void e.stopPropagation()}else 0===i.index&&(this.finishMeasurement(),e.stopPropagation());break}}"mouse"===e.pointerType&&this._hoverAt(t)}_handlePointerMove(e){if("mouse"===e.pointerType){const t=(0,N.vT)(e);this._hoverAt(t)}}_handleKeyDown(e){"Enter"===e.key&&"drawing"===this.polygonState&&(this.finishMeasurement(),e.stopPropagation())}_hoverAt(e){if(!this.active||"initial"!==this.polygonState&&"drawing"!==this.polygonState)this.analysisViewData.cursorPoint=null;else{const t=this._pick(e);(0,_.pC)(t)&&(this.analysisViewData.cursorPoint=t.mapPoint)}}_addVertexAt(e){const t=this._pick(e);return!(!(0,_.pC)(t)||!(0,_.pC)(t.mapPoint))&&(this.analysisViewData.path.add(t.mapPoint),!0)}_pick(e){const t=new P.e(e);return this.measurementView.pick(t)}};(0,s._)([(0,l.Cb)({readOnly:!0})],U.prototype,"state",null),(0,s._)([(0,l.Cb)()],U.prototype,"polygonState",void 0),(0,s._)([(0,l.Cb)({readOnly:!0})],U.prototype,"cursor",null),(0,s._)([(0,l.Cb)()],U.prototype,"measurementView",void 0),(0,s._)([(0,l.Cb)({constructOnly:!0})],U.prototype,"view",void 0),(0,s._)([(0,l.Cb)()],U.prototype,"analysis",void 0),(0,s._)([(0,l.Cb)({constructOnly:!0})],U.prototype,"analysisViewData",void 0),U=(0,s._)([(0,u.j)("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],U);const F=U;var z=i(40085);let W=class extends z.O{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="AreaMeasurement3DViewModel is only supported in 3D views.",this._userUnitOptions=null,this._userUnit=null}initialize(){this.analysis.unit=this.unit}get state(){return this.disabled||!this.ready?"disabled":(0,_.Wi)(this.tool)?"ready":this.tool.state}get measurement(){if((0,_.Wi)(this.tool)||this.disabled||this.tool.destroyed)return null;const{analysisView:e}=this;if((0,_.Wi)(e))return null;const t=e.analysisVisualization,i=t.viewData,s=i.measurementData,n=e.validMeasurement,r="euclidean"===i.mode,a=0===(r?s.intersectingSegments:s.geodesicIntersectingSegments).size,o=a?n?"available":"unavailable":"invalid";return{mode:r?"euclidean":"geodesic",area:{text:a&&n?t.areaLabel:null,state:o},perimeterLength:{text:a&&n?t.perimeterLengthLabel:null,state:o}}}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.analysis.unit=this._userUnit}get unit(){return(0,_.pC)(this._userUnit)?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}constructAnalysis(){return new f}constructTool(){return new F({view:(0,_.Wg)(this.view),analysis:this.analysis,analysisViewData:(0,_.Wg)(this.analysisView),visible:this.visible})}_findSelectableUnit(e,t){const{unitOptions:i}=this;return i.includes(e)?e:(0,_.pC)(t)?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){if((0,_.Wi)(e))return r.fN.slice();const t=e.filter((e=>r.fN.includes(e)));return 0===t.length?r.fN.slice():t}};(0,s._)([(0,l.Cb)({type:f})],W.prototype,"analysis",void 0),(0,s._)([(0,l.Cb)({readOnly:!0})],W.prototype,"state",null),(0,s._)([(0,l.Cb)({readOnly:!0})],W.prototype,"measurement",null),(0,s._)([(0,l.Cb)()],W.prototype,"unitOptions",null),(0,s._)([(0,l.Cb)()],W.prototype,"unit",null),(0,s._)([(0,l.Cb)(b.Y)],W.prototype,"defaultUnit",void 0),(0,s._)([(0,l.Cb)()],W.prototype,"_userUnit",void 0),W=(0,s._)([(0,u.j)("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],W);const k=W;var H=i(78088),Y=i(80532),Z=i(67005);i(80975);const $="esri-area-measurement-3d",j={buttonDisabled:"esri-button--disabled",base:`${$} esri-widget esri-widget--panel`,container:`${$}__container`,hint:`${$}__hint`,hintText:`${$}__hint-text`,panelError:`${$}__panel--error`,measurement:`${$}__measurement`,measurementItem:`${$}__measurement-item`,measurementItemDisabled:`${$}__measurement-item--disabled`,measurementItemTitle:`${$}__measurement-item-title`,measurementItemValue:`${$}__measurement-item-value`,settings:`${$}__settings`,units:`${$}__units`,unitsLabel:`${$}__units-label`,unitsSelect:`${$}__units-select esri-select`,unitsSelectWrapper:`${$}__units-select-wrapper`,actionSection:`${$}__actions`,newMeasurementButton:`${$}__clear-button esri-button esri-button--primary`,widgetIcon:"esri-icon-measure-area"};let X=class extends h.Z{constructor(e,t){super(e,t),this.view=null,this.visible=null,this.iconClass=j.widgetIcon,this.label=void 0,this.messages=null,this.messagesUnits=null,this.viewModel=new k,this.unitOptions=null,this.unit=null}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}render(){const{supported:e,active:t,measurement:i,state:s,unit:n}=this.viewModel,a="disabled"===s,o="ready"===s,l="measuring"===s||"measured"===s,{messages:u,messagesUnits:h}=this,c=t&&o?(0,Z.u)("section",{key:"esri-area-measurement-3d__hint",class:j.hint},(0,Z.u)("p",{class:j.hintText},u.hint)):null,d=e?null:(0,Z.u)("section",{key:"esri-area-measurement-3d__unsupported",class:j.panelError},(0,Z.u)("p",null,u.unsupported)),_=(e,t,i)=>{switch(t.state){case"available":return(0,Z.u)("div",{key:`${i}-enabled`,class:j.measurementItem},(0,Z.u)("span",{class:j.measurementItemTitle},e),(0,Z.u)("span",{class:j.measurementItemValue},t.text));case"unavailable":return(0,Z.u)("div",{key:`${i}-disabled`,class:this.classes(j.measurementItem,j.measurementItemDisabled)},(0,Z.u)("span",{class:j.measurementItemTitle},e));case"invalid":return(0,Z.u)("div",{key:`${i}-enabled`,class:j.measurementItem},(0,Z.u)("span",{class:j.measurementItemTitle},e),(0,Z.u)("span",{class:j.measurementItemValue},u.notApplicable))}},p=l?(0,Z.u)("section",{key:"esri-area-measurement-3d__measurement",class:j.measurement},_(u.area,i.area,"area"),_(u.perimeterLength,i.perimeterLength,"perimeter-length")):null,y=`${this.id}__units`,g=(0,Z.u)("label",{class:j.unitsLabel,for:y},u.unit),f=(0,Z.u)("div",{class:j.unitsSelectWrapper},(0,Z.u)("select",{class:j.unitsSelect,id:y,onchange:this._changeUnit,bind:this,value:n},this.viewModel.unitOptions.map((e=>(0,Z.u)("option",{key:e,value:e},(0,r.ZO)(e)?h.systems[e]:h.units[e]?.pluralCapitalized))))),b=l?(0,Z.u)("section",{key:"esri-area-measurement-3d__units",class:j.units},g,f):null,m=l?(0,Z.u)("div",{key:"settings",class:j.settings},b):null,v=!e||t&&!l?null:(0,Z.u)("div",{class:j.actionSection},(0,Z.u)("button",{disabled:a,class:this.classes(j.newMeasurementButton,a&&j.buttonDisabled),bind:this,onclick:this._newMeasurement,type:"button"},u.newMeasurement)),w=this.visible?(0,Z.u)("div",{class:j.container},d,c,m,p,v):null;return(0,Z.u)("div",{key:this,class:j.base,role:"presentation"},w)}_newMeasurement(){(0,n.R8)(this.viewModel.start())}_changeUnit(e){const t=e.target,i=t.options[t.selectedIndex];i&&(this.unit=i.value)}};(0,s._)([(0,a.B)("viewModel.view")],X.prototype,"view",void 0),(0,s._)([(0,a.B)("viewModel.visible")],X.prototype,"visible",void 0),(0,s._)([(0,a.B)("viewModel.active")],X.prototype,"active",void 0),(0,s._)([(0,l.Cb)({constructOnly:!0,nonNullable:!0})],X.prototype,"analysis",null),(0,s._)([(0,l.Cb)()],X.prototype,"iconClass",void 0),(0,s._)([(0,l.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],X.prototype,"label",void 0),(0,s._)([(0,l.Cb)(),(0,Y.H)("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],X.prototype,"messages",void 0),(0,s._)([(0,l.Cb)(),(0,Y.H)("esri/core/t9n/Units")],X.prototype,"messagesUnits",void 0),(0,s._)([(0,l.Cb)()],X.prototype,"uiStrings",void 0),(0,s._)([(0,l.Cb)({type:k})],X.prototype,"viewModel",void 0),(0,s._)([(0,a.B)("viewModel.unitOptions")],X.prototype,"unitOptions",void 0),(0,s._)([(0,a.B)("viewModel.unit")],X.prototype,"unit",void 0),(0,s._)([(0,H.h)()],X.prototype,"_newMeasurement",null),(0,s._)([(0,H.h)()],X.prototype,"_changeUnit",null),X=(0,s._)([(0,u.j)("esri.widgets.AreaMeasurement3D")],X);const q=X},40085:(e,t,i)=>{i.d(t,{O:()=>d});var s,n=i(27366),r=i(100),a=i(92026),o=i(66978),l=i(94172),u=i(49861),h=(i(63780),i(93169),i(25243),i(69912)),c=i(32845);!function(e){e[e.PENDING=0]="PENDING",e[e.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",e[e.RUNNING=2]="RUNNING"}(s||(s={}));let d=class extends c.V{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.analysisView=null,this._reconnectViewTask=null,this._analysisBaseHandles=new r.Z,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=e?.analysis;(0,a.pC)(t)?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0))}normalizeCtorArgs(e){const{analysis:t,...i}=e;return i}initialize(){this._analysisBaseHandles.add([(0,l.YP)((()=>(0,a.yw)(this.analysis,(e=>{let{parent:t}=e;return t}))),(e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()}),l.Z_),(0,l.YP)((()=>({view:this.view,ready:(0,a.pC)(this.view)&&this.view.ready,supported:this.supported})),((e,t)=>{let{view:i}=e,{view:s}=t;i!==s&&(this._startUserOperation=(0,a.IM)(this._startUserOperation),this._disconnectFromView(s)),this._scheduleViewReconnect()}),l.tX),(0,l.YP)((()=>this.analysis.isEditable),((e,t)=>{(0,a.Wi)(this.analysisView)||(e&&!t&&(0,a.Wi)(this.tool)?this.createTool():!e&&t&&(0,a.pC)(this.tool)&&!this.tool.active&&this.removeTool())}))])}destroy(){this._analysisBaseHandles=(0,a.SC)(this._analysisBaseHandles),this._reconnectViewTask=(0,a.IM)(this._reconnectViewTask),this._startUserOperation=(0,a.IM)(this._startUserOperation),(0,a.pC)(this.analysisView)&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),(0,a.pC)(this.analysis)&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,a.IM)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return(0,a.pC)(this.analysisView)&&!this.connectingToView}get connectingToView(){return(0,a.pC)(this._reconnectViewTask)}get isAnalysisOwner(){return this._get("isAnalysisOwner")}set visible(e){this._set("visible",e),(0,a.pC)(this.analysisView)&&(this.analysisView.visible=e)}async start(){this.clear();const e={task:null,abort:null,state:s.PENDING},t=(0,o.vr)((async t=>{e.state=s.WAIT_FOR_VIEW_READY,await(0,l.N1)((()=>this.ready),t),e.state=s.RUNNING,this.createTool({interactive:!0})}));return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}clear(){this._startUserOperation=(0,a.IM)(this._startUserOperation),this.removeTool(),this.analysis.clear()}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,a.IM)(this._reconnectViewTask);const e=(0,o.vr)((async t=>{try{await this._reconnectView(t)}catch(i){if((0,o.k_)(t),!(0,o.D_)(i))return void this.logger.warn("Failed to use analysis in view model",i);throw i}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=(0,a.pC)(t)&&t.ready&&this.supported,s=this.analysis;if(this._startUserOperation=_(this._startUserOperation),this._disconnectFromView(t),i&&!(0,a.Wi)(t)&&!(0,a.Wi)(s)){if(this.isAnalysisOwner){if((0,a.pC)(s.parent))return void this.logError("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(s)}this.analysisView=await t.whenAnalysisView(s),(0,o.Hc)(e)?this._startUserOperation=_(this._startUserOperation):(this.analysisView.visible=this.visible,this.onConnectToAnalysisView(this.analysisView),this.createTool())}}_disconnectFromView(e){this.removeTool(),(0,a.pC)(e)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,e.analyses.remove(this.analysis),this.analysis.clear()),this.analysisView=null,this.onDisconnectFromAnalysisView()}_setExternalAnalysis(e){if((0,a.pC)(this.analysisView)&&!this.isAnalysisOwner&&(this.analysisView.visible=!0),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1,!e.isEditable){const t=e.nonEditableMessage;this.logger.warn(`The assigned ${e.type} analysis object will not be editable in the view. ${t}`)}}get testInfo(){return{analysisView:this.analysisView}}};function _(e){return(0,a.pC)(e)&&e.state>=s.RUNNING?(e.abort(),null):e}(0,n._)([(0,u.Cb)({nonNullable:!0})],d.prototype,"analysis",null),(0,n._)([(0,u.Cb)()],d.prototype,"analysisView",void 0),(0,n._)([(0,u.Cb)()],d.prototype,"ready",null),(0,n._)([(0,u.Cb)()],d.prototype,"connectingToView",null),(0,n._)([(0,u.Cb)({readOnly:!0})],d.prototype,"isAnalysisOwner",null),(0,n._)([(0,u.Cb)({type:Boolean,value:!0})],d.prototype,"visible",null),(0,n._)([(0,u.Cb)()],d.prototype,"_reconnectViewTask",void 0),d=(0,n._)([(0,h.j)("esri.widgets.support.InteractiveAnalysisViewModel")],d)},32845:(e,t,i)=>{i.d(t,{V:()=>c});var s=i(27366),n=i(85015),r=i(100),a=i(32718),o=i(92026),l=i(94172),u=i(49861),h=(i(63780),i(93169),i(25243),i(69912));let c=class extends n.Z{constructor(e){super(e),this.tool=null,this._baseHandles=new r.Z,this._loggedUnsupportedErrorOnce=!1,this.logger=a.Z.getLogger(this.declaredClass),e&&null!=e.visible&&(this.visible=e.visible)}initialize(){this._baseHandles.add((0,l.YP)((()=>({ready:(0,o.pC)(this.view)&&this.view.ready,supported:this.supported})),(e=>{let{ready:t,supported:i}=e;!t||i||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)}),l.tX))}destroy(){this.removeTool(),this.view=null,this._baseHandles=(0,o.SC)(this._baseHandles)}get supported(){return(0,o.Wi)(this.view)||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const t="tools";this._baseHandles.remove(t),(0,o.Wi)(e)||this._baseHandles.add(e.tools.on("after-remove",(e=>{e.item===this.tool&&this._set("tool",null)})),t)}set visible(e){this._set("visible",e),(0,o.pC)(this.tool)&&(this.tool.visible=e)}get active(){return(0,o.pC)(this.tool)&&this.tool.active}get disabled(){return(0,o.Wi)(this.view)||!this.view.ready||!this.supported}createTool(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{interactive:!1};if(this.removeTool(),(0,o.Wi)(this.view)||!this.view.ready||!this.supported)return;const t=this.constructTool();t.created?(this._set("tool",t),this.view.tools.add(t)):e.interactive?(this._set("tool",t),this.view.addAndActivateTool(t),(0,l.gx)((()=>t.created),(()=>{t.active&&(0,o.pC)(this.view)&&(this.view.activeTool=null)}),{initial:!0,once:!0})):t.destroy()}removeTool(){const e=this.tool;if((0,o.Wi)(e))return;const t=(0,o.yw)(this.view,(e=>e.tools));(0,o.pC)(t)?t.remove(e):e.destroy(),this._set("tool",null)}logError(){this.logger.error(...arguments)}};(0,s._)([(0,u.Cb)({constructOnly:!0})],c.prototype,"tool",void 0),(0,s._)([(0,u.Cb)()],c.prototype,"supported",null),(0,s._)([(0,u.Cb)({value:null})],c.prototype,"view",null),(0,s._)([(0,u.Cb)({type:Boolean,value:!0})],c.prototype,"visible",null),(0,s._)([(0,u.Cb)()],c.prototype,"active",null),(0,s._)([(0,u.Cb)()],c.prototype,"disabled",null),c=(0,s._)([(0,h.j)("esri.widgets.support.InteractiveToolViewModel")],c)}}]);
//# sourceMappingURL=9491.6fe45b86.chunk.js.map