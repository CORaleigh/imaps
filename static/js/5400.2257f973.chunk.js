"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[5400],{95400:(e,t,i)=>{i.r(t),i.d(t,{default:()=>C});var l=i(85580),a=i(72791),n=i(10064),r=i(15075),o=i(585),s=i(78952);function c(){return(0,r.i)()}function d(){return(0,r.l)()}function u(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const l=[[e.x,e.y]],a=[],n=v(e.spatialReference);let o=0;switch(t){case"dd":o=r.P.geogToDd(n,1,l,i,a);break;case"ddm":o=r.P.geogToDdm(n,1,l,i,a);break;case"dms":o=r.P.geogToDms(n,1,l,i,a);break;default:return console.warn(`invalid format: ${t}`),null}return o?a[0]:null}function v(e){let t=null;if(e||(e=s.Z.WGS84),e.wkid){if(t=r.e.geogcs(e.wkid),!t)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!e.wkt)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(t=r.e.fromString(r.f.PE_TYPE_GEOGCS,e.wkt),!t)throw new n.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return t}var p=i(79803),f=i(91946),h=i(93655);let g,w;const m=new f.Z({url:"assets/pin.svg",height:36,width:36}),k=new h.Z({id:"coordinate-widget"}),x=e=>{const t=(0,a.useRef)(!1),i=(0,a.useRef)(null),l=(0,a.useRef)(null),[n,f]=(0,a.useState)(!1),[h,x]=(0,a.useState)(!1),b=(0,a.useRef)(null),N=(0,a.useRef)(null),C=[{value:"dd",label:"Decimal Degrees",placeholder:"35.7582196 -78.8079653"},{value:"dms",label:"Degrees Minutes Seconds",placeholder:"35\xb0 45' 29.7116777\"N 78\xb0 48' 31.524W"},{value:"spft",label:"Stateplane Feet",placeholder:"731166.165 2056872.973"},{value:"usng",label:"US National Grid",placeholder:"17S PV 98178 59368"}],[S,y]=(0,a.useState)(C[0]),j=(0,a.useRef)(C[0]),A=(0,a.useCallback)((e=>{f((e=>!e))}),[]),R=(0,a.useCallback)((e=>{x((e=>!e))}),[]),F=(0,a.useCallback)((t=>{var i,l,a;(t.target.active=!t.target.active,t.target.active)?(null===(i=g)||void 0===i||i.remove(),G(e.view,e.clickActivated)):(null===(l=w)||void 0===l||l.remove(),e.view.popup.autoOpenEnabled=!0,null===(a=document.querySelector(".identify-widget"))||void 0===a||a.classList.add("active"),E())}),[]),Z=(0,a.useCallback)((e=>{i.current&&(i.current.value="");const t=C.find((t=>t.value===e.target.value));t&&(y(t),j.current.value=t.value)}),[j]),$=(0,a.useCallback)((async t=>{c()||await d(),p.kR()||await p.zD();let l=new o.Z;if("dd"===j.current.value){var a,n,u;let e=null===(a=i.current)||void 0===a?void 0:a.value.replace(","," ").split(" ");var f;if(2!==(null===(n=e)||void 0===n?void 0:n.length))e=null===(f=i.current)||void 0===f?void 0:f.value.split(", ");if(2===(null===(u=e)||void 0===u?void 0:u.length)){let t=!isNaN(parseFloat(e[1]))&&parseFloat(e[1])<0?parseFloat(e[1]):!isNaN(parseFloat(e[0]))&&parseFloat(e[0])<0?parseFloat(e[0]):NaN,a=!isNaN(parseFloat(e[0]))&&parseFloat(e[0])>0?parseFloat(e[0]):!isNaN(parseFloat(e[1]))&&parseFloat(e[1])>0?parseFloat(e[1]):NaN;var h,g;if(isNaN(t)||isNaN(a))null===(h=i.current)||void 0===h||h.setAttribute("status","invalid");else l=new o.Z({x:t,y:a,spatialReference:{wkid:4326}}),null===(g=i.current)||void 0===g||g.setAttribute("status","valid")}}var w,x,b;"dms"===j.current.value&&(i.current&&(l=function(e,t){const i=[];e=(e=(e=e.replace(/[\u00B0\u00BA]/g,"^")).replace(/\u2032/g,"'")).replace(/\u2033/g,'"');const l=v(t);return r.P.dmsToGeog(l,1,[e],i)?new o.Z(i[0][0],i[0][1],t||s.Z.WGS84):null}(null===(w=i.current)||void 0===w?void 0:w.value.replace(/\s\s+/g," ")),l||null===(x=i.current)||void 0===x||x.setAttribute("status","invalid")));if("spft"===j.current.value){var C,S;const t=null===(C=i.current)||void 0===C?void 0:C.value.replace(/\s\s+/g," ");let a=null===t||void 0===t?void 0:t.split(" ");var y,A;if(2!==(null===(S=a)||void 0===S?void 0:S.length))if(a=null===t||void 0===t?void 0:t.split(","),2!==(null===(y=a)||void 0===y?void 0:y.length))return void(null===(A=i.current)||void 0===A||A.setAttribute("status","invalid"));const n=parseFloat(a[1]),r=parseFloat(a[2]);var R;if(isNaN(n)||isNaN(r))return void(null===(R=i.current)||void 0===R||R.setAttribute("status","invalid"));l=new o.Z({x:n,y:r,spatialReference:{wkid:4326}}),l=p.iV(l,e.view.spatialReference)}(i.current&&"usng"===j.current.value&&(l=function(e,t){const i=[];!t&&/\(.+27/.test(e)&&(t=s.Z.GCS_NAD_1927);const l=v(t);return r.c.usngToGeog(l,1,[e],i)?new o.Z(i[0][0],i[0][1],t||s.Z.WGS84):null}(i.current.value)),e.view.constraints.geometry.contains(l))||(null===(b=N.current)||void 0===b||b.setAttribute("open",!0),setTimeout((()=>{var e;null===(e=N.current)||void 0===e||e.removeAttribute("open")}),3e3));e.view.map.findLayerById("coordinate-widget")||e.view.map.add(k),k.removeAll(),k.add({geometry:l,attributes:null,symbol:m}),e.view.goTo(l)}),[]),T=async t=>{let i;c()||await d(),p.kR()||await p.zD(),i="point"===t.type?t:e.view.toMap({x:t.x,y:t.y});const a=new o.Z({x:i.longitude,y:i.latitude,spatialReference:{wkid:4326}});if("dd"===j.current.value){let e=u(a,"dd",7).replaceAll("078.","78.").split(" ");e[0].includes("S")&&(e[0]=`-${e[0].replace("S","")}`),e[0].includes("N")&&(e[0]=`${e[0].replace("N","")}`),e[1].includes("W")&&(e[1]=`-${e[1].replace("W","")}`),e[1].includes("E")&&(e[1]=`${e[1].replace("N","")}`),l.current.innerHTML=e.join(" ")}else if("dms"===j.current.value){const e=u(a,"dms",7).split(" "),t=`${e[0]}\xb0 ${e[1]}' ${e[2].replace("N",'"N')} ${e[3].substring(1)}\xb0 ${e[4]}' ${e[5].replace("W",'"W')}`;l.current.innerHTML=t}else if("usng"===j.current.value)l.current.innerHTML=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=[[e.x,e.y]],a=[],n=v(e.spatialReference);return r.c.geogToUsng(n,1,l,t,!1,i,a)?a[0]:null}(a,5,!0);else if("spft"===j.current.value){const e=p.iV(i,{wkid:2264});l.current.innerHTML=`${e.y.toFixed(3)}N ${e.x.toFixed(3)}E`}},G=(t,i)=>{var l;i(t),e.view.popup.autoOpenEnabled=!1,null===(l=document.querySelector(".identify-widget"))||void 0===l||l.classList.remove("active"),w=e.view.on("click",(e=>{T(e)}))},E=async()=>{c()||await d(),T(e.view.extent.center),g=e.view.on("pointer-move",(e=>{T(e)}))};return(0,a.useEffect)((()=>{if(!t.current&&e.view)return t.current=!0,e.expand&&(e.expand.hasHandles()||e.expand.watch("expanded",(t=>{var i,l;t?b.current.getAttribute("active")?E():G(e.view,e.clickActivated):(null===(i=g)||void 0===i||i.remove(),null===(l=w)||void 0===l||l.remove())}))),E(),()=>{}}),[]),{loaded:t,settingsClicked:A,showSettings:n,formats:C,formatChanged:Z,searchClicked:R,showSearch:h,selectedFormat:S,searchCoordinates:$,coordInput:i,modeClicked:F,coordinateRef:l,modeActionRef:b,noticeRef:N}};var b=i(80184);function N(e){var t;const{loaded:i,settingsClicked:a,showSettings:n,formats:r,formatChanged:o,searchClicked:s,showSearch:c,selectedFormat:d,searchCoordinates:u,coordInput:v,modeClicked:p,coordinateRef:f,modeActionRef:h,noticeRef:g}=x(e);return(0,b.jsxs)("div",{id:"coordinatesWidget",children:[(0,b.jsx)(l.JA,{scale:"s",ref:g,kind:"danger",closable:!0,children:(0,b.jsx)("div",{slot:"message",children:"Location outside of county"})}),(0,b.jsx)("div",{hidden:!n||void 0,children:(0,b.jsx)(l.ko,{scale:"m",label:"Coordinate Systems",onCalciteSelectChange:o,children:r.map((e=>(0,b.jsx)(l.GB,{value:e.value,children:e.label},e.value)))})}),(0,b.jsx)("div",{hidden:!c||void 0,children:(0,b.jsxs)(l.ZK,{children:[(0,b.jsxs)("div",{className:"coordinate-input",children:[(0,b.jsx)(l.e,{scale:"m",ref:v,id:"coordInput",placeholder:d.placeholder}),(0,b.jsx)(l.ln,{onClick:u,width:"full",scale:"m",iconEnd:"search"})]}),(0,b.jsx)(l.Bi,{hidden:"invalid"!==(null===(t=v.current)||void 0===t?void 0:t.getAttribute("status"))||void 0,status:"invalid",children:"Value is not valid"})]})}),(0,b.jsxs)("div",{className:"coordinates-row",children:[(0,b.jsx)("div",{ref:f,className:"coordinates-text"}),(0,b.jsx)(l.G1,{id:"coordinateSearch",text:"",icon:"search",active:!!c||void 0,onClick:s}),(0,b.jsx)(l.$A,{closeOnClick:!0,label:"Search Coordinates",referenceElement:"coordinateSearch",children:"Search Coordinates"}),(0,b.jsx)(l.G1,{id:"coordinateUnits",text:"",icon:"gear",onClick:a,active:!!n||void 0}),(0,b.jsx)(l.$A,{closeOnClick:!0,label:"Set Units",referenceElement:"coordinateUnits",children:"Set Units"}),(0,b.jsx)(l.G1,{id:"coordinateMode",ref:h,text:"",icon:"pin",onClick:p}),(0,b.jsx)(l.$A,{closeOnClick:!0,label:"Set Mode",referenceElement:"coordinateMode",children:"Set Mode"})]})]})}const C=a.memo(N)}}]);
//# sourceMappingURL=5400.2257f973.chunk.js.map