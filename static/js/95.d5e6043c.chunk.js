(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[95],{110:function(t,e,r){"use strict";function n(t,...e){let r="";for(let n=0;n<e.length;n++)r+=t[n]+e[n];return r+=t[t.length-1],r}r.d(e,"a",(function(){return n})),function(t){t.int=function(t){return Math.round(t).toString()},t.float=function(t){return t.toPrecision(8)}}(n||(n={}))},140:function(t,e,r){"use strict";r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return a})),r.d(e,"e",(function(){return c})),r.d(e,"f",(function(){return D})),r.d(e,"g",(function(){return A})),r.d(e,"h",(function(){return o})),r.d(e,"i",(function(){return s})),r.d(e,"j",(function(){return p})),r.d(e,"k",(function(){return w})),r.d(e,"l",(function(){return j})),r.d(e,"m",(function(){return l})),r.d(e,"n",(function(){return x})),r.d(e,"o",(function(){return S})),r.d(e,"p",(function(){return I})),r.d(e,"q",(function(){return b})),r.d(e,"r",(function(){return g})),r.d(e,"s",(function(){return h})),r.d(e,"t",(function(){return f})),r.d(e,"u",(function(){return T})),r.d(e,"v",(function(){return v})),r.d(e,"w",(function(){return y})),r.d(e,"x",(function(){return _}));var n=r(99),i=r(222);function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function o(t,e,r,n,i,a,o,s,c,u,l,f,h,d,m,p,g){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=u,t[9]=l,t[10]=f,t[11]=h,t[12]=d,t[13]=m,t[14]=p,t[15]=g,t}function s(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function c(t,e){if(t===e){const r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function u(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],h=e[10],d=e[11],m=e[12],p=e[13],g=e[14],b=e[15],v=r*s-n*o,x=r*c-i*o,_=r*u-a*o,M=n*c-i*s,O=n*u-a*s,T=i*u-a*c,y=l*p-f*m,w=l*g-h*m,S=l*b-d*m,j=f*g-h*p,P=f*b-d*p,A=h*b-d*g;let D=v*A-x*P+_*j+M*S-O*w+T*y;return D?(D=1/D,t[0]=(s*A-c*P+u*j)*D,t[1]=(i*P-n*A-a*j)*D,t[2]=(p*T-g*O+b*M)*D,t[3]=(h*O-f*T-d*M)*D,t[4]=(c*S-o*A-u*w)*D,t[5]=(r*A-i*S+a*w)*D,t[6]=(g*_-m*T-b*x)*D,t[7]=(l*T-h*_+d*x)*D,t[8]=(o*P-s*S+u*y)*D,t[9]=(n*S-r*P-a*y)*D,t[10]=(m*O-p*_+b*v)*D,t[11]=(f*_-l*O-d*v)*D,t[12]=(s*w-o*j-c*y)*D,t[13]=(r*j-n*w+i*y)*D,t[14]=(p*x-m*M-g*v)*D,t[15]=(l*M-f*x+h*v)*D,t):null}function l(t,e,r){const n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],h=e[9],d=e[10],m=e[11],p=e[12],g=e[13],b=e[14],v=e[15];let x=r[0],_=r[1],M=r[2],O=r[3];return t[0]=x*n+_*s+M*f+O*p,t[1]=x*i+_*c+M*h+O*g,t[2]=x*a+_*u+M*d+O*b,t[3]=x*o+_*l+M*m+O*v,x=r[4],_=r[5],M=r[6],O=r[7],t[4]=x*n+_*s+M*f+O*p,t[5]=x*i+_*c+M*h+O*g,t[6]=x*a+_*u+M*d+O*b,t[7]=x*o+_*l+M*m+O*v,x=r[8],_=r[9],M=r[10],O=r[11],t[8]=x*n+_*s+M*f+O*p,t[9]=x*i+_*c+M*h+O*g,t[10]=x*a+_*u+M*d+O*b,t[11]=x*o+_*l+M*m+O*v,x=r[12],_=r[13],M=r[14],O=r[15],t[12]=x*n+_*s+M*f+O*p,t[13]=x*i+_*c+M*h+O*g,t[14]=x*a+_*u+M*d+O*b,t[15]=x*o+_*l+M*m+O*v,t}function f(t,e,r){const n=r[0],i=r[1],a=r[2];let o,s,c,u,l,f,h,d,m,p,g,b;return e===t?(t[12]=e[0]*n+e[4]*i+e[8]*a+e[12],t[13]=e[1]*n+e[5]*i+e[9]*a+e[13],t[14]=e[2]*n+e[6]*i+e[10]*a+e[14],t[15]=e[3]*n+e[7]*i+e[11]*a+e[15]):(o=e[0],s=e[1],c=e[2],u=e[3],l=e[4],f=e[5],h=e[6],d=e[7],m=e[8],p=e[9],g=e[10],b=e[11],t[0]=o,t[1]=s,t[2]=c,t[3]=u,t[4]=l,t[5]=f,t[6]=h,t[7]=d,t[8]=m,t[9]=p,t[10]=g,t[11]=b,t[12]=o*n+l*i+m*a+e[12],t[13]=s*n+f*i+p*a+e[13],t[14]=c*n+h*i+g*a+e[14],t[15]=u*n+d*i+b*a+e[15]),t}function h(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function d(t,e,r,n){let a,o,s,c,u,l,f,h,d,m,p,g,b,v,x,_,M,O,T,y,w,S,j,P,A=n[0],D=n[1],I=n[2],F=Math.sqrt(A*A+D*D+I*I);return F<i.a?null:(F=1/F,A*=F,D*=F,I*=F,a=Math.sin(r),o=Math.cos(r),s=1-o,c=e[0],u=e[1],l=e[2],f=e[3],h=e[4],d=e[5],m=e[6],p=e[7],g=e[8],b=e[9],v=e[10],x=e[11],_=A*A*s+o,M=D*A*s+I*a,O=I*A*s-D*a,T=A*D*s-I*a,y=D*D*s+o,w=I*D*s+A*a,S=A*I*s+D*a,j=D*I*s-A*a,P=I*I*s+o,t[0]=c*_+h*M+g*O,t[1]=u*_+d*M+b*O,t[2]=l*_+m*M+v*O,t[3]=f*_+p*M+x*O,t[4]=c*T+h*y+g*w,t[5]=u*T+d*y+b*w,t[6]=l*T+m*y+v*w,t[7]=f*T+p*y+x*w,t[8]=c*S+h*j+g*P,t[9]=u*S+d*j+b*P,t[10]=l*S+m*j+v*P,t[11]=f*S+p*j+x*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function m(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[4],o=e[5],s=e[6],c=e[7],u=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+u*n,t[5]=o*i+l*n,t[6]=s*i+f*n,t[7]=c*i+h*n,t[8]=u*i-a*n,t[9]=l*i-o*n,t[10]=f*i-s*n,t[11]=h*i-c*n,t}function p(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],c=e[3],u=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-u*n,t[1]=o*i-l*n,t[2]=s*i-f*n,t[3]=c*i-h*n,t[8]=a*n+u*i,t[9]=o*n+l*i,t[10]=s*n+f*i,t[11]=c*n+h*i,t}function g(t,e,r){const n=Math.sin(r),i=Math.cos(r),a=e[0],o=e[1],s=e[2],c=e[3],u=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+u*n,t[1]=o*i+l*n,t[2]=s*i+f*n,t[3]=c*i+h*n,t[4]=u*i-a*n,t[5]=l*i-o*n,t[6]=f*i-s*n,t[7]=h*i-c*n,t}function b(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function v(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function x(t,e){const r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,e){const r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function M(t,e,r){const n=e[0],i=e[1],a=e[2],o=e[3],s=n+n,c=i+i,u=a+a,l=n*s,f=n*c,h=n*u,d=i*c,m=i*u,p=a*u,g=o*s,b=o*c,v=o*u;return t[0]=1-(d+p),t[1]=f+v,t[2]=h-b,t[3]=0,t[4]=f-v,t[5]=1-(l+p),t[6]=m+g,t[7]=0,t[8]=h+b,t[9]=m-g,t[10]=1-(l+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}const O=Object(n.e)();function T(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function y(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,c=i+i,u=r*o,l=n*o,f=n*s,h=i*o,d=i*s,m=i*c,p=a*o,g=a*s,b=a*c;return t[0]=1-f-m,t[1]=l+b,t[2]=h-g,t[3]=0,t[4]=l-b,t[5]=1-u-m,t[6]=d+p,t[7]=0,t[8]=h+g,t[9]=d-p,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w(t,e,r,n,i,a,o){const s=1/(r-e),c=1/(i-n),u=1/(a-o);return t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*c,t[6]=0,t[7]=0,t[8]=(r+e)*s,t[9]=(i+n)*c,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t}function S(t,e,r,n,i,a,o){const s=1/(e-r),c=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*c,t[14]=(o+a)*u,t[15]=1,t}function j(t,e,r,n){let a,o,c,u,l,f,h,d,m,p;const g=e[0],b=e[1],v=e[2],x=n[0],_=n[1],M=n[2],O=r[0],T=r[1],y=r[2];return Math.abs(g-O)<i.a&&Math.abs(b-T)<i.a&&Math.abs(v-y)<i.a?s(t):(h=g-O,d=b-T,m=v-y,p=1/Math.sqrt(h*h+d*d+m*m),h*=p,d*=p,m*=p,a=_*m-M*d,o=M*h-x*m,c=x*d-_*h,p=Math.sqrt(a*a+o*o+c*c),p?(p=1/p,a*=p,o*=p,c*=p):(a=0,o=0,c=0),u=d*c-m*o,l=m*a-h*c,f=h*o-d*a,p=Math.sqrt(u*u+l*l+f*f),p?(p=1/p,u*=p,l*=p,f*=p):(u=0,l=0,f=0),t[0]=a,t[1]=u,t[2]=h,t[3]=0,t[4]=o,t[5]=l,t[6]=d,t[7]=0,t[8]=c,t[9]=f,t[10]=m,t[11]=0,t[12]=-(a*g+o*b+c*v),t[13]=-(u*g+l*b+f*v),t[14]=-(h*g+d*b+m*v),t[15]=1,t)}function P(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function A(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function D(t,e){const r=t[0],n=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],h=t[9],d=t[10],m=t[11],p=t[12],g=t[13],b=t[14],v=t[15],x=e[0],_=e[1],M=e[2],O=e[3],T=e[4],y=e[5],w=e[6],S=e[7],j=e[8],P=e[9],A=e[10],D=e[11],I=e[12],F=e[13],z=e[14],E=e[15];return Math.abs(r-x)<=i.a*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(n-_)<=i.a*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(a-M)<=i.a*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(o-O)<=i.a*Math.max(1,Math.abs(o),Math.abs(O))&&Math.abs(s-T)<=i.a*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(c-y)<=i.a*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-w)<=i.a*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(l-S)<=i.a*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(f-j)<=i.a*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(h-P)<=i.a*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-A)<=i.a*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(m-D)<=i.a*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(p-I)<=i.a*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(g-F)<=i.a*Math.max(1,Math.abs(g),Math.abs(F))&&Math.abs(b-z)<=i.a*Math.max(1,Math.abs(b),Math.abs(z))&&Math.abs(v-E)<=i.a*Math.max(1,Math.abs(v),Math.abs(E))}function I(t){const e=i.a,r=t[0],n=t[1],a=t[2],o=t[4],s=t[5],c=t[6],u=t[8],l=t[9],f=t[10];return Math.abs(1-(r*r+o*o+u*u))<=e&&Math.abs(1-(n*n+s*s+l*l))<=e&&Math.abs(1-(a*a+c*c+f*f))<=e}const F=l,z=P;Object.freeze({__proto__:null,copy:a,set:o,identity:s,transpose:c,invert:u,adjoint:function(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],h=e[10],d=e[11],m=e[12],p=e[13],g=e[14],b=e[15];return t[0]=s*(h*b-d*g)-f*(c*b-u*g)+p*(c*d-u*h),t[1]=-(n*(h*b-d*g)-f*(i*b-a*g)+p*(i*d-a*h)),t[2]=n*(c*b-u*g)-s*(i*b-a*g)+p*(i*u-a*c),t[3]=-(n*(c*d-u*h)-s*(i*d-a*h)+f*(i*u-a*c)),t[4]=-(o*(h*b-d*g)-l*(c*b-u*g)+m*(c*d-u*h)),t[5]=r*(h*b-d*g)-l*(i*b-a*g)+m*(i*d-a*h),t[6]=-(r*(c*b-u*g)-o*(i*b-a*g)+m*(i*u-a*c)),t[7]=r*(c*d-u*h)-o*(i*d-a*h)+l*(i*u-a*c),t[8]=o*(f*b-d*p)-l*(s*b-u*p)+m*(s*d-u*f),t[9]=-(r*(f*b-d*p)-l*(n*b-a*p)+m*(n*d-a*f)),t[10]=r*(s*b-u*p)-o*(n*b-a*p)+m*(n*u-a*s),t[11]=-(r*(s*d-u*f)-o*(n*d-a*f)+l*(n*u-a*s)),t[12]=-(o*(f*g-h*p)-l*(s*g-c*p)+m*(s*h-c*f)),t[13]=r*(f*g-h*p)-l*(n*g-i*p)+m*(n*h-i*f),t[14]=-(r*(s*g-c*p)-o*(n*g-i*p)+m*(n*c-i*s)),t[15]=r*(s*h-c*f)-o*(n*h-i*f)+l*(n*c-i*s),t},determinant:function(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],u=t[8],l=t[9],f=t[10],h=t[11],d=t[12],m=t[13],p=t[14],g=t[15];return(e*o-r*a)*(f*g-h*p)-(e*s-n*a)*(l*g-h*m)+(e*c-i*a)*(l*p-f*m)+(r*s-n*o)*(u*g-h*d)-(r*c-i*o)*(u*p-f*d)+(n*c-i*s)*(u*m-l*d)},multiply:l,translate:f,scale:h,rotate:d,rotateX:m,rotateY:p,rotateZ:g,fromTranslation:b,fromScaling:v,fromRotation:function(t,e,r){let n,a,o,s=r[0],c=r[1],u=r[2],l=Math.sqrt(s*s+c*c+u*u);return l<i.a?null:(l=1/l,s*=l,c*=l,u*=l,n=Math.sin(e),a=Math.cos(e),o=1-a,t[0]=s*s*o+a,t[1]=c*s*o+u*n,t[2]=u*s*o-c*n,t[3]=0,t[4]=s*c*o-u*n,t[5]=c*c*o+a,t[6]=u*c*o+s*n,t[7]=0,t[8]=s*u*o+c*n,t[9]=c*u*o-s*n,t[10]=u*u*o+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:x,fromYRotation:function(t,e){const r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:_,fromRotationTranslation:M,fromQuat2:function(t,e){const r=O,n=-e[0],i=-e[1],a=-e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=n*n+i*i+a*a+o*o;return f>0?(r[0]=2*(s*o+l*n+c*a-u*i)/f,r[1]=2*(c*o+l*i+u*n-s*a)/f,r[2]=2*(u*o+l*a+s*i-c*n)/f):(r[0]=2*(s*o+l*n+c*a-u*i),r[1]=2*(c*o+l*i+u*n-s*a),r[2]=2*(u*o+l*a+s*i-c*n)),M(t,e,r),t},getTranslation:T,getScaling:function(t,e){const r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],c=e[8],u=e[9],l=e[10];return t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(a*a+o*o+s*s),t[2]=Math.sqrt(c*c+u*u+l*l),t},getRotation:function(t,e){const r=e[0]+e[5]+e[10];let n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t},fromRotationTranslationScale:function(t,e,r,n){const i=e[0],a=e[1],o=e[2],s=e[3],c=i+i,u=a+a,l=o+o,f=i*c,h=i*u,d=i*l,m=a*u,p=a*l,g=o*l,b=s*c,v=s*u,x=s*l,_=n[0],M=n[1],O=n[2];return t[0]=(1-(m+g))*_,t[1]=(h+x)*_,t[2]=(d-v)*_,t[3]=0,t[4]=(h-x)*M,t[5]=(1-(f+g))*M,t[6]=(p+b)*M,t[7]=0,t[8]=(d+v)*O,t[9]=(p-b)*O,t[10]=(1-(f+m))*O,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,e,r,n,i){const a=e[0],o=e[1],s=e[2],c=e[3],u=a+a,l=o+o,f=s+s,h=a*u,d=a*l,m=a*f,p=o*l,g=o*f,b=s*f,v=c*u,x=c*l,_=c*f,M=n[0],O=n[1],T=n[2],y=i[0],w=i[1],S=i[2],j=(1-(p+b))*M,P=(d+_)*M,A=(m-x)*M,D=(d-_)*O,I=(1-(h+b))*O,F=(g+v)*O,z=(m+x)*T,E=(g-v)*T,U=(1-(h+p))*T;return t[0]=j,t[1]=P,t[2]=A,t[3]=0,t[4]=D,t[5]=I,t[6]=F,t[7]=0,t[8]=z,t[9]=E,t[10]=U,t[11]=0,t[12]=r[0]+y-(j*y+D*w+z*S),t[13]=r[1]+w-(P*y+I*w+E*S),t[14]=r[2]+S-(A*y+F*w+U*S),t[15]=1,t},fromQuat:y,frustum:w,perspective:function(t,e,r,n,i){const a=1/Math.tan(e/2);let o;return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(n-i),t[10]=(i+n)*o,t[14]=2*i*n*o):(t[10]=-1,t[14]=-2*n),t},perspectiveFromFieldOfView:function(t,e,r,n){const i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),c=2/(o+s),u=2/(i+a);return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-s)*c*.5,t[9]=(i-a)*u*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t},ortho:S,lookAt:j,targetTo:function(t,e,r,n){const i=e[0],a=e[1],o=e[2],s=n[0],c=n[1],u=n[2];let l=i-r[0],f=a-r[1],h=o-r[2],d=l*l+f*f+h*h;d>0&&(d=1/Math.sqrt(d),l*=d,f*=d,h*=d);let m=c*h-u*f,p=u*l-s*h,g=s*f-c*l;return d=m*m+p*p+g*g,d>0&&(d=1/Math.sqrt(d),m*=d,p*=d,g*=d),t[0]=m,t[1]=p,t[2]=g,t[3]=0,t[4]=f*g-h*p,t[5]=h*m-l*g,t[6]=l*p-f*m,t[7]=0,t[8]=l,t[9]=f,t[10]=h,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)},add:function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},subtract:P,multiplyScalar:function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},multiplyScalarAndAdd:function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t},exactEquals:A,equals:D,isOrthoNormal:I,mul:F,sub:z})},150:function(t,e,r){"use strict";function n(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function a(t,e,r,n,i,a,o,s,c,u,l,f,h,d,m,p){return[t,e,r,n,i,a,o,s,c,u,l,f,h,d,m,p]}function o(t,e){return new Float64Array(t,e,16)}r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return n})),r.d(e,"e",(function(){return a}));const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,createView:o,IDENTITY:s})},164:function(t,e,r){"use strict";var n=r(107),i=r(83),a=r(167),o=r(325);class s{constructor(t,e,r=null){this._context=t,this.type="texture",this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,t.instanceCounter.increment(a.b.Texture,this),this._descriptor={target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1,...e},this.setData(r)}get glName(){return this._glName}get descriptor(){return this._descriptor}dispose(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(a.b.Texture,this))}release(){this.dispose()}resize(t,e){const r=this._descriptor;r.width===t&&r.height===e||(r.width=t,r.height=e,this.setData(null))}setData(t){if(!this._context||!this._context.gl)return;const e=this._context.gl;this._glName||(this._glName=e.createTexture()),void 0===t&&(t=null),null===t&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);const r=this._context.bindTexture(this,s.TEXTURE_UNIT_FOR_UPDATES),n=this._descriptor;s._validateTexture(this._context,n),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipped?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.preMultiplyAlpha?1:0);const a=n.pixelFormat;let o=n.internalFormat?n.internalFormat:a;if(t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){let r=t.width,i=t.height;t instanceof HTMLVideoElement&&(r=t.videoWidth,i=t.videoHeight),n.width&&n.height,e.texImage2D(e.TEXTURE_2D,0,o,a,n.dataType,t),n.hasMipmap&&this.generateMipmap(),void 0===n.width&&(n.width=r),void 0===n.height&&(n.height=i)}else{null!=n.width&&null!=n.height||console.error("Width and height must be specified!"),e.DEPTH24_STENCIL8&&o===e.DEPTH_STENCIL&&(o=e.DEPTH24_STENCIL8);let r=n.width,s=n.height;if(function(t){return Object(i.k)(t)&&"type"in t&&"compressed"===t.type}(t)){const i=Math.round(Math.log(Math.max(r,s))/Math.LN2)+1;n.hasMipmap=n.hasMipmap&&i===t.levels.length;for(let a=0;;++a){const i=t.levels[Math.min(a,t.levels.length-1)];if(e.compressedTexImage2D(e.TEXTURE_2D,a,o,r,s,0,i),1===r&&1===s||!n.hasMipmap)break;r=Math.max(1,r>>1),s=Math.max(1,s>>1)}}else if(Object(i.k)(t))e.texImage2D(e.TEXTURE_2D,0,o,r,s,0,a,n.dataType,t),n.hasMipmap&&this.generateMipmap();else for(let t=0;e.texImage2D(e.TEXTURE_2D,t,o,r,s,0,a,n.dataType,null),(1!==r||1!==s)&&n.hasMipmap;++t)r=Math.max(1,r>>1),s=Math.max(1,s>>1)}s._applySamplingMode(e,this._descriptor),s._applyWrapMode(e,this._descriptor),s._applyAnisotropicFilteringParameters(this._context,this._descriptor),this._context.bindTexture(r,s.TEXTURE_UNIT_FOR_UPDATES)}updateData(t,e,r,n,i,a){a||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const o=this._context.gl,c=this._descriptor,u=this._context.bindTexture(this,s.TEXTURE_UNIT_FOR_UPDATES);(e<0||r<0||n>c.width||i>c.height||e+n>c.width||r+i>c.height)&&console.error("An attempt to update out of bounds of the texture!"),o.pixelStorei(o.UNPACK_ALIGNMENT,c.unpackAlignment),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,c.flipped?1:0),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c.preMultiplyAlpha?1:0),a instanceof ImageData||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement?o.texSubImage2D(o.TEXTURE_2D,t,e,r,c.pixelFormat,c.dataType,a):o.texSubImage2D(o.TEXTURE_2D,t,e,r,n,i,c.pixelFormat,c.dataType,a),this._context.bindTexture(u,s.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const t=this._descriptor;t.hasMipmap||(t.hasMipmap=!0,this._samplingModeDirty=!0,s._validateTexture(this._context,t)),9729===t.samplingMode?(this._samplingModeDirty=!0,t.samplingMode=9985):9728===t.samplingMode&&(this._samplingModeDirty=!0,t.samplingMode=9984);const e=this._context.bindTexture(this,s.TEXTURE_UNIT_FOR_UPDATES),r=this._context.gl;r.generateMipmap(r.TEXTURE_2D),this._context.bindTexture(e,s.TEXTURE_UNIT_FOR_UPDATES)}setSamplingMode(t){t!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=t,this._samplingModeDirty=!0)}setWrapMode(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,s._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const t=this._context.gl,e=this._descriptor;this._samplingModeDirty&&(s._applySamplingMode(t,e),this._samplingModeDirty=!1),this._wrapModeDirty&&(s._applyWrapMode(t,e),this._wrapModeDirty=!1)}static _validateTexture(t,e){(e.width<0||e.height<0)&&console.error("Negative dimension parameters are not allowed!");const r=Object(n.l)(e.width)&&Object(n.l)(e.height);Object(o.a)(t.gl)||r||("number"==typeof e.wrapMode?33071!==e.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===e.wrapMode.s&&33071===e.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),e.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}static _applySamplingMode(t,e){let r=e.samplingMode,n=e.samplingMode;9985===r||9987===r?(r=9729,e.hasMipmap||(n=9729)):9984!==r&&9986!==r||(r=9728,e.hasMipmap||(n=9728)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n)}static _applyWrapMode(t,e){"number"==typeof e.wrapMode?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,e.wrapMode.t))}static _applyAnisotropicFilteringParameters(t,e){var r;const n=t.capabilities.textureFilterAnisotropic;if(!n)return;const i=t.gl;i.texParameterf(i.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY,null!=(r=e.maxAnisotropy)?r:1)}}s.TEXTURE_UNIT_FOR_UPDATES=0,e.a=s},167:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i}));const n=33984;var i;!function(t){t[t.Texture=0]="Texture",t[t.Buffer=1]="Buffer",t[t.VAO=2]="VAO",t[t.Program=3]="Program",t[t.Framebuffer=4]="Framebuffer",t[t.Renderbuffer=5]="Renderbuffer",t[t.COUNT=6]="COUNT"}(i||(i={}))},175:function(t,e,r){"use strict";function n(){return[0,0]}function i(t){return[t[0],t[1]]}function a(t,e){return[t,e]}function o(t){const e=[0,0],r=Math.min(2,t.length);for(let n=0;n<r;++n)e[n]=t[n];return e}function s(t,e){return new Float64Array(t,e,2)}function c(){return[0,0]}function u(){return a(1,1)}function l(){return a(1,0)}function f(){return a(0,1)}r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return a}));const h=[0,0],d=u(),m=l(),p=f();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,fromArray:o,createView:s,zeros:c,ones:u,unitX:l,unitY:f,ZEROS:h,ONES:d,UNIT_X:m,UNIT_Y:p})},176:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return d})),r.d(e,"c",(function(){return m})),r.d(e,"d",(function(){return f})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return M})),r.d(e,"g",(function(){return l})),r.d(e,"h",(function(){return p})),r.d(e,"i",(function(){return c})),r.d(e,"j",(function(){return u})),r.d(e,"k",(function(){return g}));var n=r(107),i=(r(140),r(131)),a=(r(175),r(99),r(189),r(181));Object(a.e)();class o{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function s(t,e){if(!t){e=e||"assert";const t=new Error(e);throw t.stack&&console.log(t.stack),new o(e)}}function c(t,e,r,n){let i,a=(r[0]-t[0])/e[0],o=(n[0]-t[0])/e[0];a>o&&(i=a,a=o,o=i);let s=(r[1]-t[1])/e[1],c=(n[1]-t[1])/e[1];if(s>c&&(i=s,s=c,c=i),a>c||s>o)return!1;s>a&&(a=s),c<o&&(o=c);let u=(r[2]-t[2])/e[2],l=(n[2]-t[2])/e[2];return u>l&&(i=u,u=l,l=i),!(a>l||u>o)&&(l<o&&(o=l),!(o<0))}function u(t,e,r,n){t[12]=e,t[13]=r,t[14]=n}function l(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}function f(t,e,r){return 2*Math.atan(Math.sqrt(e*e+r*r)*Math.tan(.5*t)/e)}function h(t,e,r){return 2*Math.atan(Math.sqrt(e*e+r*r)*Math.tan(.5*t)/r)}function d(t,e,r){return 2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(e*e+r*r))}function m(t,e,r){return 2*Math.atan(r*Math.tan(.5*t)/Math.sqrt(e*e+r*r))}function p(t,e,r=0){const i=Object(n.e)(t,0,x);for(let n=0;n<4;n++)e[r+n]=Math.floor(256*_(i*b[n]))}function g(t,e=0){let r=0;for(let n=0;n<4;n++)r+=t[e+n]*v[n];return r}const b=[1,256,65536,16777216],v=[1/256,1/65536,1/16777216,1/4294967296],x=g(new Uint8ClampedArray([255,255,255,255]));function _(t){return t-Math.floor(t)}function M(t,e,r,n,a){const o=t;0===t[11]?(n[0]=2/(e*o[0]),n[1]=2/(r*o[5]),n[2]=(1+o[12])/o[0],n[3]=(1+o[13])/o[5],Object(i.s)(a,0,1)):(n[0]=-2/(e*o[0]),n[1]=-2/(r*o[5]),n[2]=(1-o[8])/o[0],n[3]=(1-o[9])/o[5],Object(i.s)(a,1,0))}},181:function(t,e,r){"use strict";function n(){return[0,0,0,0]}function i(t){return[t[0],t[1],t[2],t[3]]}function a(t,e,r,n){return[t,e,r,n]}function o(t){const e=[0,0,0,0],r=Math.min(4,t.length);for(let n=0;n<r;++n)e[n]=t[n];return e}function s(t,e){return new Float64Array(t,e,4)}function c(){return[0,0,0,0]}function u(){return a(1,1,1,1)}function l(){return a(1,0,0,0)}function f(){return a(0,1,0,0)}function h(){return a(0,0,1,0)}function d(){return a(0,0,0,1)}r.d(e,"a",(function(){return p})),r.d(e,"b",(function(){return m})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return n})),r.d(e,"f",(function(){return i})),r.d(e,"g",(function(){return a}));const m=[0,0,0,0],p=u(),g=l(),b=f(),v=h(),x=d();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,fromArray:o,createView:s,zeros:c,ones:u,unitX:l,unitY:f,unitZ:h,unitW:d,ZEROS:m,ONES:p,UNIT_X:g,UNIT_Y:b,UNIT_Z:v,UNIT_W:x})},206:function(t,e,r){"use strict";r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return b})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return m})),r.d(e,"e",(function(){return p}));var n=r(83),i=r(337),a=r(281),o=r(150),s=r(357),c=r(175),u=r(99),l=r(181);class f{constructor(t,e,r){this.itemByteSize=t,this.itemCreate=e,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(r/this.itemByteSize),this.tickHandle=i.a.before((()=>this.reset()))}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(n.p)(this.tickHandle)),this.itemsPtr=0,this.items=Object(n.p)(this.items),this.buffers=Object(n.p)(this.buffers)}get(){0===this.itemsPtr&&Object(i.a)((()=>{}));const t=Math.floor(this.itemsPtr/this.itemsPerBuffer);for(;this.buffers.length<=t;){const t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize);for(let e=0;e<this.itemsPerBuffer;++e)this.items.push(this.itemCreate(t,e*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}reset(){const t=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);for(;this.buffers.length>t;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}static createVec2f64(t=h){return new f(16,c.c,t)}static createVec3f64(t=h){return new f(24,u.d,t)}static createVec4f64(t=h){return new f(32,l.c,t)}static createMat3f64(t=h){return new f(72,a.a,t)}static createMat4f64(t=h){return new f(128,o.b,t)}static createQuatf64(t=h){return new f(32,s.d,t)}get test(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}const h=4096,d=f.createVec2f64(),m=f.createVec3f64(),p=f.createVec4f64(),g=(f.createMat3f64(),f.createMat4f64()),b=f.createQuatf64()},235:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var n=r(83),i=r(101),a=r(99),o=r(110);function s(t,e){if(e.slicePlaneEnabled){t.extensions.add("GL_OES_standard_derivatives"),e.sliceEnabledForVertexPrograms&&(t.vertex.uniforms.add("slicePlaneOrigin","vec3"),t.vertex.uniforms.add("slicePlaneBasis1","vec3"),t.vertex.uniforms.add("slicePlaneBasis2","vec3")),t.fragment.uniforms.add("slicePlaneOrigin","vec3"),t.fragment.uniforms.add("slicePlaneBasis1","vec3"),t.fragment.uniforms.add("slicePlaneBasis2","vec3");const r=o.a`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,n=o.a`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
if (sliceByFactors(factors)) {
return color;
}
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`,i=e.sliceHighlightDisabled?o.a`#define highlightSlice(_color_, _pos_) (_color_)`:o.a`
        ${n}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `;e.sliceEnabledForVertexPrograms&&t.vertex.code.add(r),t.fragment.code.add(r),t.fragment.code.add(i)}else{const r=o.a`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`;e.sliceEnabledForVertexPrograms&&t.vertex.code.add(r),t.fragment.code.add(r)}}function c(t,e,r){u(t,e,r.slicePlane,r.origin)}function u(t,e,r,o){e.slicePlaneEnabled&&(Object(n.k)(r)?(o?(Object(i.j)(l,r.origin,o),t.setUniform3fv("slicePlaneOrigin",l)):t.setUniform3fv("slicePlaneOrigin",r.origin),t.setUniform3fv("slicePlaneBasis1",r.basis1),t.setUniform3fv("slicePlaneBasis2",r.basis2)):(t.setUniform3fv("slicePlaneBasis1",a.b),t.setUniform3fv("slicePlaneBasis2",a.b),t.setUniform3fv("slicePlaneOrigin",a.b)))}const l=Object(a.e)()},246:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));const n=r(78).a.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class i{constructor(){this.includedModules=new Map}include(t,e){this.includedModules.has(t)?this.includedModules.get(t)!==e&&n.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(t,e),t(this.builder,e))}}class a extends i{constructor(){super(...arguments),this.vertex=new c,this.fragment=new c,this.attributes=new u,this.varyings=new l,this.extensions=new f,this.constants=new h}get fragmentUniforms(){return this.fragment.uniforms}get builder(){return this}generateSource(t){const e=this.extensions.generateSource(t),r=this.attributes.generateSource(t),n=this.varyings.generateSource(),i="vertex"===t?this.vertex:this.fragment,a=i.uniforms.generateSource(),o=i.code.generateSource(),s="vertex"===t?m:d,c=this.constants.generateSource().concat(i.constants.generateSource());return`\n${e.join("\n")}\n\n${s}\n\n${c.join("\n")}\n\n${a.join("\n")}\n\n${r.join("\n")}\n\n${n.join("\n")}\n\n${o.join("\n")}`}}class o{constructor(){this._entries=new Map}add(t,e,r){const n=`${t}_${e}_${r}`;return this._entries.set(n,{name:t,type:e,arraySize:r}),this}generateSource(){return Array.from(this._entries.values()).map((t=>`uniform ${t.type} ${t.name}${(t=>t?`[${t}]`:"")(t.arraySize)};`))}get entries(){return Array.from(this._entries.values())}}class s{constructor(){this._entries=new Array}add(t){this._entries.push(t)}generateSource(){return this._entries}}class c extends i{constructor(){super(...arguments),this.uniforms=new o,this.code=new s,this.constants=new h}get builder(){return this}}class u{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map((t=>`attribute ${t[1]} ${t[0]};`))}}class l{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(){return this._entries.map((t=>`varying ${t[1]} ${t[0]};`))}}class f{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?f.ALLOWLIST_VERTEX:f.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((t=>e.includes(t))).map((t=>`#extension ${t} : enable`))}}f.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],f.ALLOWLIST_VERTEX=[];class h{constructor(){this._entries=[]}add(t,e,r){let n="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":n=h.numberToFloatStr(r);break;case"int":n=h.numberToIntStr(r);break;case"bool":n=r.toString();break;case"vec2":n=`vec2(${h.numberToFloatStr(r[0])},                            ${h.numberToFloatStr(r[1])})`;break;case"vec3":n=`vec3(${h.numberToFloatStr(r[0])},                            ${h.numberToFloatStr(r[1])},                            ${h.numberToFloatStr(r[2])})`;break;case"vec4":n=`vec4(${h.numberToFloatStr(r[0])},                            ${h.numberToFloatStr(r[1])},                            ${h.numberToFloatStr(r[2])},                            ${h.numberToFloatStr(r[3])})`;break;case"ivec2":n=`ivec2(${h.numberToIntStr(r[0])},                             ${h.numberToIntStr(r[1])})`;break;case"ivec3":n=`ivec3(${h.numberToIntStr(r[0])},                             ${h.numberToIntStr(r[1])},                             ${h.numberToIntStr(r[2])})`;break;case"ivec4":n=`ivec4(${h.numberToIntStr(r[0])},                             ${h.numberToIntStr(r[1])},                             ${h.numberToIntStr(r[2])},                             ${h.numberToIntStr(r[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${e}(${Array.prototype.map.call(r,(t=>h.numberToFloatStr(t))).join(", ")})`}return this._entries.push(`const ${e} ${t} = ${n};`),this}static numberToIntStr(t){return t.toFixed(0)}static numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}const d="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",m="precision highp float;\nprecision highp sampler2D;"},254:function(t,e,r){"use strict";r.d(e,"a",(function(){return d})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return h})),r.d(e,"e",(function(){return l})),r.d(e,"f",(function(){return f})),r.d(e,"g",(function(){return c}));var n=r(322),i=r(101),a=r(99),o=r(206);function s(t){return t?{origin:Object(a.c)(t.origin),direction:Object(a.c)(t.direction)}:{origin:Object(a.e)(),direction:Object(a.e)()}}function c(t,e){const r=m.get();return r.origin=t,r.direction=e,r}function u(t,e=s()){return f(t.origin,t.direction,e)}function l(t,e,r=s()){return Object(i.k)(r.origin,t),Object(i.j)(r.direction,e,t),r}function f(t,e,r=s()){return Object(i.k)(r.origin,t),Object(i.k)(r.direction,e),r}function h(t,e){const r=Object(i.g)(o.d.get(),Object(i.r)(o.d.get(),t.direction),Object(i.j)(o.d.get(),e,t.origin));return Object(i.h)(r,r)}function d(t,e,r){const n=Object(i.h)(t.direction,Object(i.j)(r,e,t.origin));return Object(i.f)(r,t.origin,Object(i.e)(r,t.direction,n)),r}const m=new n.a((function(){return{origin:null,direction:null}}))},257:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return i}));var n=r(110);function i(t,e){t.fragment.uniforms.add("terrainDepthTexture","sampler2D"),t.fragment.uniforms.add("cameraNearFar","vec2"),t.fragment.uniforms.add("inverseViewport","vec2"),t.fragment.code.add(n.a`
    // Compare the linearized depths of fragment and terrain. Discard fragments on the wrong side of the terrain.
    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){

      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);
      if(fragmentDepth ${e.cullAboveGround?">":"<="} terrainDepth){
        discard;
      }
    }
  `)}function a(t,e){e.multipassTerrainEnabled&&e.terrainLinearDepthTexture&&t.bindTexture(e.terrainLinearDepthTexture,"terrainDepthTexture")}},276:function(t,e,r){"use strict";r.d(e,"a",(function(){return p})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return l})),r.d(e,"d",(function(){return h})),r.d(e,"e",(function(){return c})),r.d(e,"f",(function(){return i})),r.d(e,"g",(function(){return b})),r.d(e,"h",(function(){return d})),r.d(e,"i",(function(){return u})),r.d(e,"j",(function(){return m})),r.d(e,"k",(function(){return f})),r.d(e,"l",(function(){return a})),r.d(e,"m",(function(){return s}));var n=r(222);function i(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function a(t,e,r,n,i,a,o,s,c,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=c,t[8]=u,t}function o(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function s(t,e){if(t===e){const r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function c(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=l*o-s*u,h=-l*a+s*c,d=u*a-o*c;let m=r*f+n*h+i*d;return m?(m=1/m,t[0]=f*m,t[1]=(-l*n+i*u)*m,t[2]=(s*n-i*o)*m,t[3]=h*m,t[4]=(l*r-i*c)*m,t[5]=(-s*r+i*a)*m,t[6]=d*m,t[7]=(-u*r+n*c)*m,t[8]=(o*r-n*a)*m,t):null}function u(t,e,r){const n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],h=r[0],d=r[1],m=r[2],p=r[3],g=r[4],b=r[5],v=r[6],x=r[7],_=r[8];return t[0]=h*n+d*o+m*u,t[1]=h*i+d*s+m*l,t[2]=h*a+d*c+m*f,t[3]=p*n+g*o+b*u,t[4]=p*i+g*s+b*l,t[5]=p*a+g*c+b*f,t[6]=v*n+x*o+_*u,t[7]=v*i+x*s+_*l,t[8]=v*a+x*c+_*f,t}function l(t,e,r){const n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],h=r[0],d=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=c,t[6]=h*n+d*o+u,t[7]=h*i+d*s+l,t[8]=h*a+d*c+f,t}function f(t,e,r){const n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],f=e[8],h=Math.sin(r),d=Math.cos(r);return t[0]=d*n+h*o,t[1]=d*i+h*s,t[2]=d*a+h*c,t[3]=d*o-h*n,t[4]=d*s-h*i,t[5]=d*c-h*a,t[6]=u,t[7]=l,t[8]=f,t}function h(t,e,r){const n=r[0],i=r[1],a=r[2];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=a*e[6],t[7]=a*e[7],t[8]=a*e[8],t}function d(t,e,r){const n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t}function m(t,e){const r=e[0],n=e[1],i=e[2],a=e[4],o=e[5],s=e[6],c=e[8],u=e[9],l=e[10],f=l*o-s*u,h=-l*a+s*c,d=u*a-o*c,m=r*f+n*h+i*d;if(!m)return null;const p=1/m;return t[0]=f*p,t[1]=(-l*n+i*u)*p,t[2]=(s*n-i*o)*p,t[3]=h*p,t[4]=(l*r-i*c)*p,t[5]=(-s*r+i*a)*p,t[6]=d*p,t[7]=(-u*r+n*c)*p,t[8]=(o*r-n*a)*p,t}function p(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8],f=e[9],h=e[10],d=e[11],m=e[12],p=e[13],g=e[14],b=e[15],v=r*s-n*o,x=r*c-i*o,_=r*u-a*o,M=n*c-i*s,O=n*u-a*s,T=i*u-a*c,y=l*p-f*m,w=l*g-h*m,S=l*b-d*m,j=f*g-h*p,P=f*b-d*p,A=h*b-d*g;let D=v*A-x*P+_*j+M*S-O*w+T*y;return D?(D=1/D,t[0]=(s*A-c*P+u*j)*D,t[1]=(c*S-o*A-u*w)*D,t[2]=(o*P-s*S+u*y)*D,t[3]=(i*P-n*A-a*j)*D,t[4]=(r*A-i*S+a*w)*D,t[5]=(n*S-r*P-a*y)*D,t[6]=(p*T-g*O+b*M)*D,t[7]=(g*_-m*T-b*x)*D,t[8]=(m*O-p*_+b*v)*D,t):null}function g(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function b(t){const e=n.a,r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8];return Math.abs(1-(r*r+o*o+u*u))<=e&&Math.abs(1-(i*i+s*s+l*l))<=e&&Math.abs(1-(a*a+c*c+f*f))<=e}const v=u,x=g;Object.freeze({__proto__:null,fromMat4:i,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},set:a,identity:o,transpose:s,invert:c,adjoint:function(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8];return t[0]=o*l-s*u,t[1]=i*u-n*l,t[2]=n*s-i*o,t[3]=s*c-a*l,t[4]=r*l-i*c,t[5]=i*a-r*s,t[6]=a*u-o*c,t[7]=n*c-r*u,t[8]=r*o-n*a,t},determinant:function(t){const e=t[0],r=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],u=t[8];return e*(u*a-o*c)+r*(-u*i+o*s)+n*(c*i-a*s)},multiply:u,translate:l,rotate:f,scale:h,scaleByVec2:d,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},fromRotation:function(t,e){const r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},fromQuat:function(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=r+r,s=n+n,c=i+i,u=r*o,l=n*o,f=n*s,h=i*o,d=i*s,m=i*c,p=a*o,g=a*s,b=a*c;return t[0]=1-f-m,t[3]=l-b,t[6]=h+g,t[1]=l+b,t[4]=1-u-m,t[7]=d-p,t[2]=h-g,t[5]=d+p,t[8]=1-u-f,t},normalFromMat4Legacy:m,normalFromMat4:p,projection:function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)},add:function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},subtract:g,multiplyScalar:function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},multiplyScalarAndAdd:function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},equals:function(t,e){const r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],f=t[8],h=e[0],d=e[1],m=e[2],p=e[3],g=e[4],b=e[5],v=e[6],x=e[7],_=e[8];return Math.abs(r-h)<=n.a*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-d)<=n.a*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-m)<=n.a*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(o-p)<=n.a*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-g)<=n.a*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-b)<=n.a*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(u-v)<=n.a*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(l-x)<=n.a*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(f-_)<=n.a*Math.max(1,Math.abs(f),Math.abs(_))},isOrthoNormal:b,mul:v,sub:x})},278:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(387),i=r(110);function a(t){t.include(n.a),t.code.add(i.a`float linearDepthFromFloat(float depth, vec2 nearFar) {
return -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);
}
float linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {
return linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);
}`)}},281:function(t,e,r){"use strict";function n(){return[1,0,0,0,1,0,0,0,1]}function i(t,e){return new Float64Array(t,e,9)}r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n}));Object.freeze({__proto__:null,create:n,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},fromValues:function(t,e,r,n,i,a,o,s,c){return[t,e,r,n,i,a,o,s,c]},createView:i})},292:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));class n{constructor(t,e){this._module=t,this._loadModule=e}get(){return this._module}async reload(){return this._module=await this._loadModule(),this._module}}},293:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(83),i=r(171),a=r(486),o=r(194);class s extends a.a{constructor(t,e,r){super(t,e.generateSource("vertex"),e.generateSource("fragment"),r),this._textures=new Map,this._freeTextureUnits=new i.a({deallocator:null}),this._fragmentUniforms=Object(o.b)()?e.fragmentUniforms.entries:null}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(t,e){if(Object(n.j)(t)||null==t.glName){const t=this._textures.get(e);return t&&(this._context.bindTexture(null,t.unit),this._freeTextureUnit(t),this._textures.delete(e)),null}let r=this._textures.get(e);return null==r?(r=this._allocTextureUnit(t),this._textures.set(e,r)):r.texture=t,this._context.useProgram(this),this.setUniform1i(e,r.unit),this._context.bindTexture(t,r.unit),r.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach(((t,e)=>{this._context.bindTexture(t.texture,t.unit),this.setUniform1i(e,t.unit)})),Object(n.k)(this._fragmentUniforms)&&this._fragmentUniforms.forEach((t=>{if(("sampler2D"===t.type||"samplerCube"===t.type)&&!this._textures.has(t.name))throw new Error(`Texture sampler ${t.name} has no bound texture`)}))}_allocTextureUnit(t){return{texture:t,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(t){this._freeTextureUnits.push(t.unit)}}},299:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(83);class i{constructor(t,e,r=(()=>this.dispose())){this.release=r,e&&(this._config=e.snapshot()),this._program=this.initializeProgram(t),this._pipeline=this.initializePipeline(t)}dispose(){this._program=Object(n.f)(this._program),this._pipeline=this._config=null}reload(t){Object(n.f)(this._program),this._program=this.initializeProgram(t)}get program(){return this._program}get pipeline(){return this._pipeline}get key(){return this._config.key}get configuration(){return this._config}bindPass(t,e){}bindMaterial(t,e){}bindDraw(t,e,r){}bindPipelineState(t){t.setPipelineState(this.pipeline)}ensureAttributeLocations(t){this.program.assertCompatibleVertexAttributeLocations(t)}get primitiveType(){return 4}}},300:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));const n=new Map([["position",0],["normal",1],["uv0",2],["color",3],["size",4],["tangent",4],["auxpos1",5],["symbolColor",5],["auxpos2",6],["featureAttribute",6],["instanceFeatureAttribute",6],["instanceColor",7],["model",8],["modelNormal",12],["modelOriginHi",11],["modelOriginLo",15]])},301:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return c}));var n=r(181),i=r(110);const a=Object(n.g)(1,1,0,1),o=Object(n.g)(1,0,1,1);function s(t){t.fragment.uniforms.add("depthTex","sampler2D"),t.fragment.uniforms.add("highlightViewportPixelSz","vec4"),t.fragment.constants.add("occludedHighlightFlag","vec4",a).add("unoccludedHighlightFlag","vec4",o),t.fragment.code.add(i.a`void outputHighlight() {
vec4 fragCoord = gl_FragCoord;
float sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;
if (fragCoord.z > sceneDepth + 5e-7) {
gl_FragColor = occludedHighlightFlag;
}
else {
gl_FragColor = unoccludedHighlightFlag;
}
}`)}function c(t,e){t.bindTexture(e.highlightDepthTexture,"depthTex"),t.setUniform4f("highlightViewportPixelSz",0,0,e.inverseViewport[0],e.inverseViewport[1])}},303:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return a}));var n=r(107);class i{constructor(){this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((()=>0))}get key(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}snapshot(){const t=this._parameterNames,e={key:this.key};for(const r of t)e[r]=this[r];return e}}function a(t={}){return(e,r)=>{var i,a;e._parameterNames=null!=(i=e._parameterNames)?i:[],e._parameterNames.push(r);const o=e._parameterNames.length-1,s=t.count||2,c=Math.ceil(Object(n.n)(s)),u=null!=(a=e._parameterBits)?a:[0];let l=0;for(;u[l]+c>16;)l++,l>=u.length&&u.push(0);e._parameterBits=u;const f=u[l],h=(1<<c)-1<<f;u[l]+=c,Object.defineProperty(e,r,{get(){return this[o]},set(t){if(this[o]!==t&&(this[o]=t,this._keyDirty=!0,this._parameterBits[l]=this._parameterBits[l]&~h|+t<<f&h,"number"!=typeof t&&"boolean"!=typeof t))throw"Configuration value for "+r+" must be boolean or number, got "+typeof t}})}}},310:function(t,e,r){"use strict";r.d(e,"a",(function(){return O})),r.d(e,"b",(function(){return j})),r.d(e,"c",(function(){return T})),r.d(e,"d",(function(){return _})),r.d(e,"e",(function(){return w})),r.d(e,"f",(function(){return h})),r.d(e,"g",(function(){return g})),r.d(e,"h",(function(){return y})),r.d(e,"i",(function(){return M}));var n=r(107),i=r(83),a=r(101),o=r(99),s=r(234),c=r(567),u=r(176),l=r(348);const f=Object(s.f)();function h(t,e,r,n,i,a,o){if(!Object(l.e)(e))if(t.boundingInfo){Object(u.a)(0===t.primitiveType);const e=r.tolerance;m(t.boundingInfo,n,i,e,a,o)}else{const e=t.indices.get("position"),r=t.vertexAttributes.get("position");g(n,i,0,e.length/3,e,r,void 0,a,o)}}const d=Object(o.e)();function m(t,e,r,n,o,c){if(Object(i.j)(t))return;const u=function(t,e,r){return Object(a.w)(r,1/(e[0]-t[0]),1/(e[1]-t[1]),1/(e[2]-t[2]))}(e,r,d);if(Object(s.y)(f,t.getBBMin()),Object(s.x)(f,t.getBBMax()),Object(i.k)(o)&&o.applyToAabb(f),_(f,e,u,n)){const{primitiveIndices:i,indices:a,position:s}=t,u=i?i.length:a.length/3;if(u>P){const i=t.getChildren();if(void 0!==i){for(let t=0;t<8;++t)void 0!==i[t]&&m(i[t],e,r,n,o,c);return}}g(e,r,0,u,a,s,i,o,c)}}const p=Object(o.e)();function g(t,e,r,n,a,o,s,c,u){if(s)return function(t,e,r,n,a,o,s,c,u){const l=o.data,f=o.stride||o.size,h=t[0],d=t[1],m=t[2],g=e[0]-h,b=e[1]-d,v=e[2]-m;for(let _=r;_<n;++_){const t=s[_];let e=3*t,r=f*a[e++],n=l[r++],o=l[r++],M=l[r];r=f*a[e++];let O=l[r++],T=l[r++],y=l[r];r=f*a[e];let w=l[r++],S=l[r++],j=l[r];Object(i.k)(c)&&([n,o,M]=c.applyToVertex(n,o,M,_),[O,T,y]=c.applyToVertex(O,T,y,_),[w,S,j]=c.applyToVertex(w,S,j,_));const P=O-n,A=T-o,D=y-M,I=w-n,F=S-o,z=j-M,E=b*z-F*v,U=v*I-z*g,L=g*F-I*b,C=P*E+A*U+D*L;if(Math.abs(C)<=Number.EPSILON)continue;const N=h-n,R=d-o,k=m-M,V=N*E+R*U+k*L;if(C>0){if(V<0||V>C)continue}else if(V>0||V<C)continue;const H=R*D-A*k,B=k*P-D*N,q=N*A-P*R,G=g*H+b*B+v*q;if(C>0){if(G<0||V+G>C)continue}else if(G>0||V+G<C)continue;const X=(I*H+F*B+z*q)/C;X>=0&&u(X,x(P,A,D,I,F,z,p),t)}}(t,e,r,n,a,o,s,c,u);const l=o.data,f=o.stride||o.size,h=t[0],d=t[1],m=t[2],g=e[0]-h,b=e[1]-d,v=e[2]-m;for(let _=r,M=3*r;_<n;++_){let t=f*a[M++],e=l[t++],r=l[t++],n=l[t];t=f*a[M++];let o=l[t++],s=l[t++],O=l[t];t=f*a[M++];let T=l[t++],y=l[t++],w=l[t];Object(i.k)(c)&&([e,r,n]=c.applyToVertex(e,r,n,_),[o,s,O]=c.applyToVertex(o,s,O,_),[T,y,w]=c.applyToVertex(T,y,w,_));const S=o-e,j=s-r,P=O-n,A=T-e,D=y-r,I=w-n,F=b*I-D*v,z=v*A-I*g,E=g*D-A*b,U=S*F+j*z+P*E;if(Math.abs(U)<=Number.EPSILON)continue;const L=h-e,C=d-r,N=m-n,R=L*F+C*z+N*E;if(U>0){if(R<0||R>U)continue}else if(R>0||R<U)continue;const k=C*P-j*N,V=N*S-P*L,H=L*j-S*C,B=g*k+b*V+v*H;if(U>0){if(B<0||R+B>U)continue}else if(B>0||R+B<U)continue;const q=(A*k+D*V+I*H)/U;q>=0&&u(q,x(S,j,P,A,D,I,p),_)}}const b=Object(o.e)(),v=Object(o.e)();function x(t,e,r,n,i,o,s){return Object(a.w)(b,t,e,r),Object(a.w)(v,n,i,o),Object(a.g)(s,b,v),Object(a.r)(s,s),s}function _(t,e,r,n){return function(t,e,r,n,i){const a=(t[0]-n-e[0])*r[0],o=(t[3]+n-e[0])*r[0];let s=Math.min(a,o),c=Math.max(a,o);const u=(t[1]-n-e[1])*r[1],l=(t[4]+n-e[1])*r[1];if(c=Math.min(c,Math.max(u,l)),c<0)return!1;if(s=Math.max(s,Math.min(u,l)),s>c)return!1;const f=(t[2]-n-e[2])*r[2],h=(t[5]+n-e[2])*r[2];return c=Math.min(c,Math.max(f,h)),!(c<0)&&(s=Math.max(s,Math.min(f,h)),!(s>c)&&s<i)}(t,e,r,n,1/0)}function M(t,e,r,i,a){let o=(r.screenLength||0)*t.pixelRatio;a&&(o=Object(c.d)(o,i,e,a));const s=o*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return Object(n.e)(s*e,r.minWorldLength||0,null!=r.maxWorldLength?r.maxWorldLength:1/0)}function O(t,e,r){if(!t)return;const n=t.parameters,i=t.paddingPixelsOverride;e.setUniform4f(r,n.divisor,n.offset,n.minPixelSize,i)}function T(t,e){const r=e?T(e):{};for(const n in t){let e=t[n];e&&e.forEach&&(e=S(e)),null==e&&n in r||(r[n]=e)}return r}function y(t,e){let r=!1;for(const n in e){const i=e[n];void 0!==i&&(r=!0,Array.isArray(i)?t[n]=i.slice():t[n]=i)}return r}function w(t,e,r,i,a){if(!e.options.selectionMode)return;const o=t.vertexAttributes.get("position").data,s=t.vertexAttributes.get("size"),c=s&&s.data[0],u=r[0],l=r[1],f=((c+i)/2+4)*t.screenToWorldRatio;let h=Number.MAX_VALUE;for(let d=0;d<o.length-5;d+=3){const t=o[d],e=o[d+1],r=u-t,i=l-e,a=o[d+3]-t,s=o[d+4]-e,c=Object(n.e)((a*r+s*i)/(a*a+s*s),0,1),f=a*c-r,m=s*c-i,p=f*f+m*m;p<h&&(h=p)}h<f*f&&a()}function S(t){const e=[];return t.forEach((t=>e.push(t))),e}const j={multiply:1,ignore:2,replace:3,tint:4},P=1e3},318:function(t,e,r){"use strict";r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return p})),r.d(e,"c",(function(){return u})),r.d(e,"d",(function(){return c})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return f})),r.d(e,"g",(function(){return l})),r.d(e,"h",(function(){return d})),r.d(e,"i",(function(){return m}));var n=r(107),i=r(322),a=r(101),o=r(99),s=r(206);function c(t){return t?{origin:Object(o.c)(t.origin),vector:Object(o.c)(t.vector)}:{origin:Object(o.e)(),vector:Object(o.e)()}}function u(t,e=c()){return l(t.origin,t.vector,e)}function l(t,e,r=c()){return Object(a.k)(r.origin,t),Object(a.k)(r.vector,e),r}function f(t,e,r=c()){return Object(a.k)(r.origin,t),Object(a.j)(r.vector,e,t),r}function h(t,e){const r=Object(a.j)(s.d.get(),e,t.origin),i=Object(a.h)(t.vector,r),o=Object(a.h)(t.vector,t.vector),c=Object(n.e)(i/o,0,1),u=Object(a.j)(s.d.get(),Object(a.e)(s.d.get(),t.vector,c),r);return Object(a.h)(u,u)}function d(t,e,r){return Object(a.f)(r,t.origin,Object(a.e)(r,t.vector,e))}function m(t,e,r,i,o){const{vector:c,origin:u}=t,l=Object(a.j)(s.d.get(),e,u),f=Object(a.h)(c,l)/Object(a.t)(c);return Object(a.e)(o,c,Object(n.e)(f,r,i)),Object(a.f)(o,o,t.origin)}function p(t,e){if(b(t,function(t,e){const r=x.get();return r.origin=t,r.vector=e,r}(e.origin,e.direction),!1,v)){const{tA:e,pB:r,distance2:n}=v;if(e>=0&&e<=1)return n;if(e<0)return Object(a.l)(t.origin,r);if(e>1)return Object(a.l)(Object(a.f)(s.d.get(),t.origin,t.vector),r)}return null}function g(t,e,r){return!!b(t,e,!0,v)&&(Object(a.k)(r,v.pA),!0)}function b(t,e,r,i){const o=1e-6,c=t.origin,u=Object(a.f)(s.d.get(),c,t.vector),l=e.origin,f=Object(a.f)(s.d.get(),l,e.vector),h=s.d.get(),d=s.d.get();if(h[0]=c[0]-l[0],h[1]=c[1]-l[1],h[2]=c[2]-l[2],d[0]=f[0]-l[0],d[1]=f[1]-l[1],d[2]=f[2]-l[2],Math.abs(d[0])<o&&Math.abs(d[1])<o&&Math.abs(d[2])<o)return!1;const m=s.d.get();if(m[0]=u[0]-c[0],m[1]=u[1]-c[1],m[2]=u[2]-c[2],Math.abs(m[0])<o&&Math.abs(m[1])<o&&Math.abs(m[2])<o)return!1;const p=h[0]*d[0]+h[1]*d[1]+h[2]*d[2],g=d[0]*m[0]+d[1]*m[1]+d[2]*m[2],b=h[0]*m[0]+h[1]*m[1]+h[2]*m[2],v=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],x=(m[0]*m[0]+m[1]*m[1]+m[2]*m[2])*v-g*g;if(Math.abs(x)<o)return!1;let _=(p*g-b*v)/x,M=(p+g*_)/v;r&&(_=Object(n.e)(_,0,1),M=Object(n.e)(M,0,1));const O=s.d.get(),T=s.d.get();return O[0]=c[0]+_*m[0],O[1]=c[1]+_*m[1],O[2]=c[2]+_*m[2],T[0]=l[0]+M*d[0],T[1]=l[1]+M*d[1],T[2]=l[2]+M*d[2],i.tA=_,i.tB=M,i.pA=O,i.pB=T,i.distance2=Object(a.l)(O,T),!0}const v={tA:0,tB:0,pA:Object(o.e)(),pB:Object(o.e)(),distance2:0},x=new i.a((()=>({origin:null,vector:null})))},322:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(83),i=r(337);class a{constructor(t){this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=i.a.before((()=>this.reset())),this.grow()}destroy(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(n.p)(this.tickHandle)),this.items=Object(n.p)(this.items)}get(){return 0===this.itemsPtr&&Object(i.a)((()=>{})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}reset(){const t=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*o);this.items.length=Math.min(t,this.items.length),this.itemsPtr=0}grow(){for(let t=0;t<Math.max(8,Math.min(this.items.length,o));t++)this.items.push(this.allocator())}}const o=1024},325:function(t,e,r){"use strict";e.a=function(t){return window.WebGL2RenderingContext&&t instanceof window.WebGL2RenderingContext}},326:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return a}));var n=r(110);const i=.1,a=.001;function o(t,e){const r=t.fragment;switch(e.alphaDiscardMode){case 0:r.code.add(n.a`
        #define discardOrAdjustAlpha(color) { if (color.a < ${n.a.float(a)}) { discard; } }
      `);break;case 1:r.code.add(n.a`void discardOrAdjustAlpha(inout vec4 color) {
color.a = 1.0;
}`);break;case 2:r.uniforms.add("textureAlphaCutoff","float"),r.code.add(n.a`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }`);break;case 3:t.fragment.uniforms.add("textureAlphaCutoff","float"),t.fragment.code.add(n.a`#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }`)}}},331:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return h})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return l})),r.d(e,"e",(function(){return u})),r.d(e,"f",(function(){return i})),r.d(e,"g",(function(){return f}));var n=r(277);const i=Object(n.g)(770,1,771,771),a=Object(n.h)(1,1),o=Object(n.h)(0,771);function s(t){return 2===t?null:1===t?o:a}function c(t){return 2===t?n.d:null}const u=5e5,l={factor:-1,units:-2};function f(t){return t?l:null}function h(t){return 3===t||2===t?513:515}},335:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(110);function i(t){t.code.add(n.a`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},342:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(336),i=r(549);class a{constructor(t,e){this.layout=t,this.buffer="number"==typeof e?new ArrayBuffer(e*t.stride):e;for(const r of t.fieldNames){const e=t.fields.get(r);this[r]=new e.constructor(this.buffer,e.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(t,e){const r=this[t];return r&&r.elementCount===e.ElementCount&&r.elementType===e.ElementType?r:null}slice(t,e){return new a(this.layout,this.buffer.slice(t*this.stride,e*this.stride))}copyFrom(t,e,r,n){const i=this.stride;if(i%4==0){const a=new Uint32Array(t.buffer,e*i,n*i/4);new Uint32Array(this.buffer,r*i,n*i/4).set(a)}else{const a=new Uint8Array(t.buffer,e*i,n*i);new Uint8Array(this.buffer,r*i,n*i).set(a)}}}class o{constructor(){this.stride=0,this.fields=new Map,this.fieldNames=[]}vec2f(t,e){return this.appendField(t,n.m,e),this}vec2f64(t,e){return this.appendField(t,n.n,e),this}vec3f(t,e){return this.appendField(t,n.u,e),this}vec3f64(t,e){return this.appendField(t,n.v,e),this}vec4f(t,e){return this.appendField(t,n.C,e),this}vec4f64(t,e){return this.appendField(t,n.D,e),this}mat3f(t,e){return this.appendField(t,n.f,e),this}mat3f64(t,e){return this.appendField(t,n.g,e),this}mat4f(t,e){return this.appendField(t,n.h,e),this}mat4f64(t,e){return this.appendField(t,n.i,e),this}vec4u8(t,e){return this.appendField(t,n.J,e),this}f32(t,e){return this.appendField(t,n.a,e),this}f64(t,e){return this.appendField(t,n.b,e),this}u8(t,e){return this.appendField(t,n.l,e),this}u16(t,e){return this.appendField(t,n.j,e),this}i8(t,e){return this.appendField(t,n.e,e),this}vec2i8(t,e){return this.appendField(t,n.q,e),this}vec2i16(t,e){return this.appendField(t,n.o,e),this}vec2u8(t,e){return this.appendField(t,n.t,e),this}vec4u16(t,e){return this.appendField(t,n.H,e),this}u32(t,e){return this.appendField(t,n.k,e),this}appendField(t,e,r){const n=e.ElementCount*Object(i.a)(e.ElementType),a=this.stride;this.fields.set(t,{size:n,constructor:e,offset:a,optional:r}),this.stride+=n,this.fieldNames.push(t)}alignTo(t){return this.stride=Math.floor((this.stride+t-1)/t)*t,this}hasField(t){return this.fieldNames.indexOf(t)>=0}createBuffer(t){return new a(this,t)}createView(t){return new a(this,t)}clone(){const t=new o;return t.stride=this.stride,t.fields=new Map,this.fields.forEach(((e,r)=>t.fields.set(r,e))),t.fieldNames=this.fieldNames.slice(),t.BufferType=this.BufferType,t}}function s(){return new o}},343:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var n=r(83),i=r(358),a=r(300),o=r(310);class s extends i.a{constructor(t,e){super(),this.type=3,this.supportsEdges=!1,this._visible=!0,this._renderPriority=0,this._insertOrder=0,this._vertexAttributeLocations=a.a,this._params=Object(o.c)(t,e),this.validateParameterValues(this._params)}dispose(){}get params(){return this._params}update(t){return!1}setParameterValues(t){Object(o.h)(this._params,t)&&(this.validateParameterValues(this._params),this.parametersChanged())}validateParameterValues(t){}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.parametersChanged())}isVisibleInPass(t){return!0}get renderOccluded(){return this.params.renderOccluded}get renderPriority(){return this._renderPriority}set renderPriority(t){t!==this._renderPriority&&(this._renderPriority=t,this.parametersChanged())}get insertOrder(){return this._insertOrder}set insertOrder(t){t!==this._insertOrder&&(this._insertOrder=t,this.parametersChanged())}get vertexAttributeLocations(){return this._vertexAttributeLocations}isVisible(){return this._visible}parametersChanged(){Object(n.k)(this.materialRepository)&&this.materialRepository.materialChanged(this)}}function c(t,e){return t.isVisible()&&t.isVisibleInPass(e.pass)&&0!=(t.renderOccluded&e.renderOccludedMask)}const u={renderOccluded:1}},348:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"b",(function(){return c})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return m})),r.d(e,"e",(function(){return l})),r.d(e,"f",(function(){return h})),r.d(e,"g",(function(){return u}));var n=r(83),i=r(140),a=r(150),o=r(594),s=r(176);function c(t,e){return Object(n.j)(t)&&(t=[]),t.push(e),t}function u(t,e){if(Object(n.j)(t))return t;const r=t.filter((t=>t!==e));return 0===r.length?null:r}function l(t){return!!Object(n.k)(t)&&!t.visible}function f(t,e){const r=new Map;return r.set(0,e.acquire(t,0)),r.set(1,e.acquire(t,7)),r.set(4,e.acquire(t,3)),r.set(3,e.acquire(t,2)),r.set(2,e.acquire(t,1)),r.set(5,e.acquire(t,4)),r.set(7,e.acquire(t,3)),r.set(6,e.acquire(t,3)),r}function h(t,e){e.release(t,0),e.release(t,7),e.release(t,3),e.release(t,2),e.release(t,1),e.release(t,4)}function d(t,e,r){const a=t.origin.vec3;Object(s.j)(b,-a[0],-a[1],-a[2]),Object(n.k)(t.transformation)?Object(i.m)(e,b,t.transformation):Object(i.d)(e,b),r&&(Object(i.a)(r,e),Object(i.e)(r,r))}function m(t,e,r,n,i){p[0]=t.get(e,0),p[1]=t.get(e,1),p[2]=t.get(e,2),Object(o.a)(p,g,3),r.set(i,0,g[0]),n.set(i,0,g[1]),r.set(i,1,g[2]),n.set(i,1,g[3]),r.set(i,2,g[4]),n.set(i,2,g[5])}const p=new Float64Array(3),g=new Float32Array(6),b=Object(a.d)()},357:function(t,e,r){"use strict";function n(){return[0,0,0,1]}function i(t){return[t[0],t[1],t[2],t[3]]}function a(t,e){return new Float64Array(t,e,4)}r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return a}));const o=[0,0,0,1];Object.freeze({__proto__:null,create:n,clone:i,fromValues:function(t,e,r,n){return[t,e,r,n]},createView:a,IDENTITY:o})},358:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(212);class i{constructor(){this.id=Object(n.a)()}unload(){}}},364:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return s})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return u})),r.d(e,"e",(function(){return c})),r.d(e,"f",(function(){return l}));var n=r(140),i=r(595);function a(t,e,r){t.setUniform3f("camPos",r[3]-e[0],r[7]-e[1],r[11]-e[2])}function o(t,e){t.setUniformMatrix4fv("proj",e)}function s(t,e){t.setUniform2fv("nearFar",e)}function c(t,e,r){Object(n.t)(f,r,e),t.setUniform3fv("localOrigin",e),t.setUniformMatrix4fv("view",f)}function u(t,e){c(t,e.origin,e.camera.viewMatrix)}function l(t,e){t.setUniform4fv("viewport",e.camera.fullViewport)}const f=Object(i.a)()},365:function(t,e,r){"use strict";r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return p})),r.d(e,"c",(function(){return m})),r.d(e,"d",(function(){return h})),r.d(e,"e",(function(){return d}));var n=r(101),i=r(99),a=r(322),o=(r(131),r(318));r(206);new a.a(o.d),new a.a((()=>({p0:null,p1:null,p2:null})));const s=Object(i.e)(),c=Object(i.e)();let u=(()=>{const t=new Uint32Array(131072);for(let e=0;e<t.length;++e)t[e]=e;return t})();const l=new Uint16Array([0]),f=(()=>{const t=new Uint16Array(65536);for(let e=0;e<t.length;++e)t[e]=e;return t})();function h(t){if(1===t)return l;if(t<f.length)return new Uint16Array(f.buffer,0,t);if(t>u.length){const e=Math.max(2*u.length,t);u=new Uint32Array(e);for(let t=0;t<u.length;t++)u[t]=t}return new Uint32Array(u.buffer,0,t)}function d(t){if(1===t)return new Uint16Array(l);if(t<f.length)return new Uint16Array(f.slice(0,t));if(t>u.length){const e=new Uint32Array(t);for(let t=0;t<e.length;t++)e[t]=t;return e}return new Uint32Array(u.slice(0,t))}function m(t,e,r){if(!t)return!1;const{size:i,data:a}=t;Object(n.w)(r,0,0,0),Object(n.w)(_,0,0,0);let o=0,u=0;for(let d=0;d<e.length-2;d+=3){const t=e[d+0]*i,m=e[d+1]*i,p=e[d+2]*i;Object(n.w)(b,a[t+0],a[t+1],a[t+2]),Object(n.w)(v,a[m+0],a[m+1],a[m+2]),Object(n.w)(x,a[p+0],a[p+1],a[p+2]);const g=(l=b,f=v,h=x,Object(n.j)(s,f,l),Object(n.j)(c,h,l),Object(n.p)(Object(n.g)(s,s,c))/2);g?(Object(n.f)(b,b,v),Object(n.f)(b,b,x),Object(n.e)(b,b,1/3*g),Object(n.f)(r,r,b),o+=g):(Object(n.f)(_,_,b),Object(n.f)(_,_,v),Object(n.f)(_,_,x),u+=3)}var l,f,h;return(0!==u||0!==o)&&(0!==o?(Object(n.e)(r,r,1/o),!0):0!==u&&(Object(n.e)(r,_,1/u),!0))}function p(t,e,r){if(!t||!e)return!1;const{size:i,data:a}=t;Object(n.w)(r,0,0,0);let o=-1,s=0;for(let n=0;n<e.length;n++){const t=e[n]*i;o!==t&&(r[0]+=a[t+0],r[1]+=a[t+1],r[2]+=a[t+2],s++),o=t}return s>1&&Object(n.e)(r,r,1/s),s>0}function g(t,e,r,i){if(!t)return!1;const{size:a,data:o}=t;Object(n.w)(i,0,0,0),Object(n.w)(_,0,0,0);let s=0,c=0;const u=e?e.length-1:o.length/a-1,l=u+(r?2:0);for(let f=0;f<l;f+=2){const t=f<u?f:u,r=f<u?f+1:0,l=(e?e[t]:t)*a,h=(e?e[r]:r)*a;b[0]=o[l+0],b[1]=o[l+1],b[2]=o[l+2],v[0]=o[h+0],v[1]=o[h+1],v[2]=o[h+2],Object(n.e)(b,Object(n.f)(b,b,v),.5);const d=Object(n.n)(b,v);d>0?(Object(n.f)(i,i,Object(n.e)(b,b,d)),s+=d):(Object(n.f)(_,_,b),c++)}return 0!==s?(Object(n.e)(i,i,1/s),!0):0!==c&&(Object(n.e)(i,_,1/c),!0)}const b=Object(i.e)(),v=Object(i.e)(),x=Object(i.e)(),_=Object(i.e)()},370:function(t,e,r){"use strict";r.d(e,"a",(function(){return v})),r.d(e,"b",(function(){return p})),r.d(e,"c",(function(){return _})),r.d(e,"d",(function(){return g})),r.d(e,"e",(function(){return O})),r.d(e,"f",(function(){return b}));r(77);var n=r(78),i=r(107),a=r(83),o=r(140),s=r(101),c=r(99),u=r(189),l=r(181),f=r(254),h=r(427),d=r(206);const m=n.a.getLogger("esri.geometry.support.sphere");function p(){return Object(l.e)()}function g(t,e=p()){return Object(u.c)(e,t)}function b(t){return t}function v(t){t[0]=t[1]=t[2]=t[3]=0}function x(t){return Array.isArray(t)?t[3]:t}function _(t){return Array.isArray(t)?t:A}function M(t,e,r){if(Object(a.j)(e))return!1;const n=Object(s.j)(d.d.get(),e.origin,_(t)),i=Object(s.h)(e.direction,e.direction),o=2*Object(s.h)(e.direction,n),c=o*o-4*i*(Object(s.h)(n,n)-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);let l=(-o-u)/(2*i);const f=(-o+u)/(2*i);return(l<0||f<l&&f>0)&&(l=f),!(l<0)&&(r&&Object(s.f)(r,e.origin,Object(s.e)(d.d.get(),e.direction,l)),!0)}function O(t,e){return M(t,e,null)}function T(t,e,r){const n=d.d.get(),i=d.a.get();Object(s.g)(n,e.origin,e.direction);const a=x(t);Object(s.g)(r,n,e.origin),Object(s.e)(r,r,1/Object(s.p)(r)*a);const c=w(t,e.origin),u=Object(h.a)(e.origin,r);return Object(o.i)(i),Object(o.c)(i,i,u+c,n),Object(s.q)(r,r,i),r}function y(t,e,r){const n=Object(s.j)(d.d.get(),e,_(t)),i=Object(s.e)(d.d.get(),n,t[3]/Object(s.p)(n));return Object(s.f)(r,i,_(t))}function w(t,e){const r=Object(s.j)(d.d.get(),e,_(t)),n=Object(s.p)(r),a=x(t),o=a+Math.abs(a-n);return Object(i.b)(a/o)}const S=Object(c.e)();function j(t,e,r,n){const a=Object(s.j)(S,e,_(t));switch(r){case 0:{const t=Object(i.d)(a,S)[2];return Object(s.w)(n,-Math.sin(t),Math.cos(t),0)}case 1:{const t=Object(i.d)(a,S),e=t[1],r=t[2],o=Math.sin(e);return Object(s.w)(n,-o*Math.cos(r),-o*Math.sin(r),Math.cos(e))}case 2:return Object(s.r)(n,a);default:return}}function P(t,e){const r=Object(s.j)(D,e,_(t));return Object(s.p)(r)-t[3]}const A=Object(c.e)(),D=Object(c.e)();Object.freeze({__proto__:null,create:p,copy:g,fromCenterAndRadius:function(t,e){return Object(l.g)(t[0],t[1],t[2],e)},wrap:b,clear:v,fromRadius:function(t){return t},getRadius:x,getCenter:_,fromValues:function(t,e,r,n){return Object(l.g)(t,e,r,n)},elevate:function(t,e,r){return t!==r&&Object(s.k)(r,t),r[3]=t[3]+e,r},setExtent:function(t,e,r){return m.error("sphere.setExtent is not yet supported"),t===r?r:g(t,r)},intersectRay:M,intersectsRay:O,intersectRayClosestSilhouette:function(t,e,r){if(M(t,e,r))return r;const n=T(t,e,d.d.get());return Object(s.f)(r,e.origin,Object(s.e)(d.d.get(),e.direction,Object(s.m)(e.origin,n)/Object(s.p)(e.direction))),r},closestPointOnSilhouette:T,closestPoint:function(t,e,r){return M(t,e,r)?r:(Object(f.a)(e,_(t),r),y(t,r,r))},projectPoint:y,distanceToSilhouette:function(t,e){const r=Object(s.j)(d.d.get(),e,_(t)),n=Object(s.t)(r),i=t[3]*t[3];return Math.sqrt(Math.abs(n-i))},angleToSilhouette:w,axisAt:j,altitudeAt:P,setAltitudeAt:function(t,e,r,n){const i=P(t,e),a=j(t,e,2,D),o=Object(s.e)(D,a,r-i);return Object(s.f)(n,e,o)}})},371:function(t,e,r){"use strict";var n=r(568);class i extends n.a{constructor(t){super(),this._material=t.material,this._techniqueRep=t.techniqueRep,this._output=t.output}get technique(){return this._technique}getPipelineState(t,e){return this.technique.pipeline}ensureResources(t){return 2}ensureParameters(t){}}e.a=i},384:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(110);function i(t,e){e.linearDepth?t.vertex.code.add(n.a`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;
return proj * eye;
}`):t.vertex.code.add(n.a`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}},387:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(110);function i(t){t.code.add(n.a`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}
const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`)}},395:function(t,e,r){"use strict";r.d(e,"a",(function(){return h}));var n=r(83),i=r(171),a=r(101),o=r(99),s=r(176);class c{constructor(t,e,r,n){this.primitiveIndices=t,this._numIndexPerPrimitive=e,this.indices=r,this.position=n,this.center=Object(o.e)(),Object(s.a)(t.length>=1),Object(s.a)(r.length%this._numIndexPerPrimitive==0),Object(s.a)(r.length>=t.length*this._numIndexPerPrimitive),Object(s.a)(3===n.size||4===n.size);const{data:i,size:c}=n,l=t.length;let f=c*r[this._numIndexPerPrimitive*t[0]];u.clear(),u.push(f),this.bbMin=Object(o.g)(i[f],i[f+1],i[f+2]),this.bbMax=Object(o.c)(this.bbMin);for(let a=0;a<l;++a){const e=this._numIndexPerPrimitive*t[a];for(let t=0;t<this._numIndexPerPrimitive;++t){f=c*r[e+t],u.push(f);let n=i[f];this.bbMin[0]=Math.min(n,this.bbMin[0]),this.bbMax[0]=Math.max(n,this.bbMax[0]),n=i[f+1],this.bbMin[1]=Math.min(n,this.bbMin[1]),this.bbMax[1]=Math.max(n,this.bbMax[1]),n=i[f+2],this.bbMin[2]=Math.min(n,this.bbMin[2]),this.bbMax[2]=Math.max(n,this.bbMax[2])}}Object(a.i)(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);let h=this.radius*this.radius;for(let a=0;a<u.length;++a){f=u.getItemAt(a);const t=i[f]-this.center[0],e=i[f+1]-this.center[1],r=i[f+2]-this.center[2],n=t*t+e*e+r*r;if(n<=h)continue;const o=Math.sqrt(n),s=.5*(o-this.radius);this.radius=this.radius+s,h=this.radius*this.radius;const c=s/o;this.center[0]+=t*c,this.center[1]+=e*c,this.center[2]+=r*c}u.clear()}getCenter(){return this.center}getBSRadius(){return this.radius}getBBMin(){return this.bbMin}getBBMax(){return this.bbMax}getChildren(){if(this._children)return this._children;if(Object(a.l)(this.bbMin,this.bbMax)>1){const t=Object(a.i)(Object(o.e)(),this.bbMin,this.bbMax,.5),e=this.primitiveIndices.length,r=new Uint8Array(e),n=new Array(8);for(let a=0;a<8;++a)n[a]=0;const{data:i,size:s}=this.position;for(let a=0;a<e;++a){let e=0;const o=this._numIndexPerPrimitive*this.primitiveIndices[a];let c=s*this.indices[o],u=i[c],l=i[c+1],f=i[c+2];for(let t=1;t<this._numIndexPerPrimitive;++t){c=s*this.indices[o+t];const e=i[c],r=i[c+1],n=i[c+2];e<u&&(u=e),r<l&&(l=r),n<f&&(f=n)}u<t[0]&&(e|=1),l<t[1]&&(e|=2),f<t[2]&&(e|=4),r[a]=e,++n[e]}let u=0;for(let a=0;a<8;++a)n[a]>0&&++u;if(u<2)return;const l=new Array(8);for(let a=0;a<8;++a)l[a]=n[a]>0?new Uint32Array(n[a]):void 0;for(let a=0;a<8;++a)n[a]=0;for(let a=0;a<e;++a){const t=r[a];l[t][n[t]++]=this.primitiveIndices[a]}this._children=new Array(8);for(let a=0;a<8;++a)void 0!==l[a]&&(this._children[a]=new c(l[a],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}static prune(){u.prune()}}const u=new i.a({deallocator:null});var l=r(358),f=r(365);class h extends l.a{constructor(t,e=[],r=0,n=-1){super(),this._primitiveType=r,this.edgeIndicesLength=n,this.type=2,this._vertexAttributes=new Map,this._indices=new Map,this._boundingInfo=null;for(const[i,a]of t)a&&this._vertexAttributes.set(i,{...a});if(null==e||0===e.length){const t=function(t){const e=t.values().next().value;return null==e?0:e.data.length/e.size}(this._vertexAttributes),e=Object(f.d)(t);this.edgeIndicesLength=this.edgeIndicesLength<0?t:this.edgeIndicesLength;for(const r of this._vertexAttributes.keys())this._indices.set(r,e)}else for(const[i,a]of e)a&&(this._indices.set(i,d(a)),"position"===i&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._indices.get(i).length:this.edgeIndicesLength))}get vertexAttributes(){return this._vertexAttributes}getMutableAttribute(t){const e=this._vertexAttributes.get(t);return e&&!e.exclusive&&(e.data=Array.from(e.data),e.exclusive=!0),e}get indices(){return this._indices}get indexCount(){const t=this._indices.values().next().value;return t?t.length:0}get primitiveType(){return this._primitiveType}get faceCount(){return this.indexCount/3}get boundingInfo(){return Object(n.j)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(t):this.computeAttachmentOriginPoints(t)}computeAttachmentOriginTriangles(t){const e=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(f.c)(r,e,t)}computeAttachmentOriginPoints(t){const e=this.indices.get("position"),r=this.vertexAttributes.get("position");return Object(f.b)(r,e,t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const t=this.indices.get("position");if(0===t.length)return null;const e=0===this.primitiveType?3:1;Object(s.a)(t.length%e==0,"Indexing error: "+t.length+" not divisible by "+e);const r=Object(f.d)(t.length/e),n=this.vertexAttributes.get("position");return new c(r,e,t,n)}}function d(t){if(t.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return t;for(const e of t)if(e>=65536)return t;return new Uint16Array(t)}},427:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return s}));var n=r(107),i=r(101),a=r(99);function o(t,e,r){const n=Object(i.h)(t,e)/Object(i.h)(t,t);return Object(i.e)(r,t,n)}function s(t,e){return Object(i.h)(t,e)/Object(i.p)(t)}function c(t,e){const r=Object(i.h)(t,e)/(Object(i.p)(t)*Object(i.p)(e));return-Object(n.b)(r)}function u(t,e,r){Object(i.r)(l,t),Object(i.r)(f,e);const a=Object(i.h)(l,f),o=Object(n.b)(a),s=Object(i.g)(l,l,f);return Object(i.h)(s,r)<0?2*Math.PI-o:o}const l=Object(a.e)(),f=Object(a.e)()},437:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return o}));var n=r(110);function i(t,e){e.vvInstancingEnabled&&(e.vvSize||e.vvColor)&&t.attributes.add("instanceFeatureAttribute","vec4"),e.vvSize?(t.vertex.uniforms.add("vvSizeMinSize","vec3"),t.vertex.uniforms.add("vvSizeMaxSize","vec3"),t.vertex.uniforms.add("vvSizeOffset","vec3"),t.vertex.uniforms.add("vvSizeFactor","vec3"),t.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),t.vertex.uniforms.add("vvSymbolAnchor","vec3"),t.vertex.code.add(n.a`vec3 vvScale(vec4 _featureAttribute) {
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),t.vertex.code.add(n.a`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${e.vvInstancingEnabled?n.a`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):t.vertex.code.add(n.a`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),e.vvColor?(t.vertex.constants.add("vvColorNumber","int",8),t.vertex.code.add(n.a`
      uniform float vvColorValues[vvColorNumber];
      uniform vec4 vvColorColors[vvColorNumber];

      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {
        float value = featureAttribute.y;
        if (value <= values[0]) {
          return colors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (values[i] >= value) {
            float f = (value - values[i-1]) / (values[i] - values[i-1]);
            return mix(colors[i-1], colors[i], f);
          }
        }
        return colors[vvColorNumber - 1];
      }

      ${e.vvInstancingEnabled?n.a`
      vec4 vvColor() {
        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);
      }`:""}
    `)):t.vertex.code.add(n.a`vec4 vvColor() { return vec4(1.0); }`)}function a(t,e){e.vvSizeEnabled&&(t.setUniform3fv("vvSizeMinSize",e.vvSizeMinSize),t.setUniform3fv("vvSizeMaxSize",e.vvSizeMaxSize),t.setUniform3fv("vvSizeOffset",e.vvSizeOffset),t.setUniform3fv("vvSizeFactor",e.vvSizeFactor)),e.vvColorEnabled&&(t.setUniform1fv("vvColorValues",e.vvColorValues),t.setUniform4fv("vvColorColors",e.vvColorColors))}function o(t,e){a(t,e),e.vvOpacityEnabled&&(t.setUniform1fv("vvOpacityValues",e.vvOpacityValues),t.setUniform1fv("vvOpacityOpacities",e.vvOpacityOpacities))}function s(t,e){a(t,e),e.vvSizeEnabled&&(t.setUniform3fv("vvSymbolAnchor",e.vvSymbolAnchor),t.setUniformMatrix3fv("vvSymbolRotationMatrix",e.vvSymbolRotationMatrix))}},454:function(t,e,r){"use strict";function n(){return new Float32Array(3)}function i(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t,e,r){const n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=r,n}function o(){return n()}function s(){return a(1,1,1)}function c(){return a(1,0,0)}function u(){return a(0,1,0)}function l(){return a(0,0,1)}r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return a}));const f=o(),h=s(),d=c(),m=u(),p=l();Object.freeze({__proto__:null,create:n,clone:i,fromValues:a,createView:function(t,e){return new Float32Array(t,e,3)},zeros:o,ones:s,unitX:c,unitY:u,unitZ:l,ZEROS:f,ONES:h,UNIT_X:d,UNIT_Y:m,UNIT_Z:p})},473:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(387),i=r(110);function a(t,e){t.fragment.include(n.a),3===e.output?(t.extensions.add("GL_OES_standard_derivatives"),t.fragment.code.add(i.a`float _calculateFragDepth(const in float depth) {
const float SLOPE_SCALE = 2.0;
const float BIAS = 2.0 * .000015259;
float m = max(abs(dFdx(depth)), abs(dFdy(depth)));
float result = depth + SLOPE_SCALE * m + BIAS;
return clamp(result, .0, .999999);
}
void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));
}`)):1===e.output&&t.fragment.code.add(i.a`void outputDepth(float _linearDepth) {
gl_FragColor = float2rgba(_linearDepth);
}`)}},485:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return h})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return l})),r.d(e,"e",(function(){return u}));var n=r(140),i=r(336),a=r(176);function o(t,e,r,n){const i=r.typedBuffer,a=r.typedBufferStride,o=t.length;n*=a;for(let s=0;s<o;++s){const r=2*t[s];i[n]=e[r],i[n+1]=e[r+1],n+=a}}function s(t,e,r,n,i){const a=r.typedBuffer,o=r.typedBufferStride,s=t.length;if(n*=o,null==i||1===i)for(let c=0;c<s;++c){const r=3*t[c];a[n]=e[r],a[n+1]=e[r+1],a[n+2]=e[r+2],n+=o}else for(let c=0;c<s;++c){const r=3*t[c];for(let t=0;t<i;++t)a[n]=e[r],a[n+1]=e[r+1],a[n+2]=e[r+2],n+=o}}function c(t,e,r,n,i=1){const a=r.typedBuffer,o=r.typedBufferStride,s=t.length;if(n*=o,1===i)for(let c=0;c<s;++c){const r=4*t[c];a[n]=e[r],a[n+1]=e[r+1],a[n+2]=e[r+2],a[n+3]=e[r+3],n+=o}else for(let c=0;c<s;++c){const r=4*t[c];for(let t=0;t<i;++t)a[n]=e[r],a[n+1]=e[r+1],a[n+2]=e[r+2],a[n+3]=e[r+3],n+=o}}function u(t,e,r,n,i,a=1){if(!r)return void s(t,e,n,i,a);const o=n.typedBuffer,c=n.typedBufferStride,u=t.length,l=r[0],f=r[1],h=r[2],d=r[4],m=r[5],p=r[6],g=r[8],b=r[9],v=r[10],x=r[12],_=r[13],M=r[14];if(i*=c,1===a)for(let s=0;s<u;++s){const r=3*t[s],n=e[r],a=e[r+1],u=e[r+2];o[i]=l*n+d*a+g*u+x,o[i+1]=f*n+m*a+b*u+_,o[i+2]=h*n+p*a+v*u+M,i+=c}else for(let s=0;s<u;++s){const r=3*t[s],n=e[r],u=e[r+1],O=e[r+2],T=l*n+d*u+g*O+x,y=f*n+m*u+b*O+_,w=h*n+p*u+v*O+M;for(let t=0;t<a;++t)o[i]=T,o[i+1]=y,o[i+2]=w,i+=c}}function l(t,e,r,i,a,o=1){if(!r)return void s(t,e,i,a,o);const c=r,u=i.typedBuffer,l=i.typedBufferStride,f=t.length,h=c[0],d=c[1],m=c[2],p=c[4],g=c[5],b=c[6],v=c[8],x=c[9],_=c[10],M=!Object(n.p)(c),O=1e-6,T=1-O;if(a*=l,1===o)for(let n=0;n<f;++n){const r=3*t[n],i=e[r],o=e[r+1],s=e[r+2];let c=h*i+p*o+v*s,f=d*i+g*o+x*s,y=m*i+b*o+_*s;if(M){const t=c*c+f*f+y*y;if(t<T&&t>O){const e=1/Math.sqrt(t);c*=e,f*=e,y*=e}}u[a+0]=c,u[a+1]=f,u[a+2]=y,a+=l}else for(let n=0;n<f;++n){const r=3*t[n],i=e[r],s=e[r+1],c=e[r+2];let f=h*i+p*s+v*c,y=d*i+g*s+x*c,w=m*i+b*s+_*c;if(M){const t=f*f+y*y+w*w;if(t<T&&t>O){const e=1/Math.sqrt(t);f*=e,y*=e,w*=e}}for(let t=0;t<o;++t)u[a+0]=f,u[a+1]=y,u[a+2]=w,a+=l}}function f(t,e,r,i,a,o=1){if(!r)return void c(t,e,i,a,o);const s=r,u=i.typedBuffer,l=i.typedBufferStride,f=t.length,h=s[0],d=s[1],m=s[2],p=s[4],g=s[5],b=s[6],v=s[8],x=s[9],_=s[10],M=!Object(n.p)(s),O=1e-6,T=1-O;if(a*=l,1===o)for(let n=0;n<f;++n){const r=4*t[n],i=e[r],o=e[r+1],s=e[r+2],c=e[r+3];let f=h*i+p*o+v*s,y=d*i+g*o+x*s,w=m*i+b*o+_*s;if(M){const t=f*f+y*y+w*w;if(t<T&&t>O){const e=1/Math.sqrt(t);f*=e,y*=e,w*=e}}u[a+0]=f,u[a+1]=y,u[a+2]=w,u[a+3]=c,a+=l}else for(let n=0;n<f;++n){const r=4*t[n],i=e[r],s=e[r+1],c=e[r+2],f=e[r+3];let y=h*i+p*s+v*c,w=d*i+g*s+x*c,S=m*i+b*s+_*c;if(M){const t=y*y+w*w+S*S;if(t<T&&t>O){const e=1/Math.sqrt(t);y*=e,w*=e,S*=e}}for(let t=0;t<o;++t)u[a+0]=y,u[a+1]=w,u[a+2]=S,u[a+3]=f,a+=l}}function h(t,e,r,n,i,a=1){const o=n.typedBuffer,s=n.typedBufferStride,c=t.length;if(i*=s,1===a){if(4===r)for(let u=0;u<c;++u){const r=4*t[u];o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=e[r+3],i+=s}else if(3===r)for(let u=0;u<c;++u){const r=3*t[u];o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=255,i+=s}}else if(4===r)for(let u=0;u<c;++u){const r=4*t[u];for(let t=0;t<a;++t)o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=e[r+3],i+=s}else if(3===r)for(let u=0;u<c;++u){const r=3*t[u];for(let t=0;t<a;++t)o[i]=e[r],o[i+1]=e[r+1],o[i+2]=e[r+2],o[i+3]=255,i+=s}}function d(t,e,r,n,s,c){for(const d of e.fieldNames){const e=t.vertexAttributes.get(d),m=t.indices.get(d);if(e&&m)switch(d){case"position":{Object(a.a)(3===e.size);const t=s.getField(d,i.u);t&&u(m,e.data,r,t,c);break}case"normal":{Object(a.a)(3===e.size);const t=s.getField(d,i.u);t&&l(m,e.data,n,t,c);break}case"uv0":{Object(a.a)(2===e.size);const t=s.getField(d,i.m);t&&o(m,e.data,t,c);break}case"color":{Object(a.a)(3===e.size||4===e.size);const t=s.getField(d,i.J);t&&h(m,e.data,e.size,t,c);break}case"symbolColor":{Object(a.a)(3===e.size||4===e.size);const t=s.getField(d,i.J);t&&h(m,e.data,e.size,t,c);break}case"tangent":{Object(a.a)(4===e.size);const t=s.getField(d,i.C);t&&f(m,e.data,n,t,c);break}}}}},486:function(t,e,r){"use strict";r.d(e,"a",(function(){return _}));r(77);var n=r(83),i=r(167),a=r(194),o=["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"],s=r(240),c=999,u=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function l(){var t,e,r,n=0,i=0,a=c,o=[],l=[],f=1,h=0,d=0,m=!1,p=!1,g="";return function(t){return l=[],null!==t?v(t.replace?t.replace(/\r\n/g,"\n"):t):(o.length&&b(o.join("")),a=10,b("(eof)"),l)};function b(t){t.length&&l.push({type:u[a],data:t,position:d,line:f,column:h})}function v(s){var u;for(n=0,r=(g+=s).length;t=g[n],n<r;){switch(u=n,a){case 0:n="/"===t&&"*"===e?(o.push(t),b(o.join("")),a=c,n+1):(o.push(t),e=t,n+1);break;case 1:case 2:n=x();break;case 3:n=_();break;case 4:n="."===t||/[eE]/.test(t)?(o.push(t),a=5,e=t,n+1):"x"===t&&1===o.length&&"0"===o[0]?(a=11,o.push(t),e=t,n+1):/[^\d]/.test(t)?(b(o.join("")),a=c,n):(o.push(t),e=t,n+1);break;case 11:n=/[^a-fA-F0-9]/.test(t)?(b(o.join("")),a=c,n):(o.push(t),e=t,n+1);break;case 5:"f"===t&&(o.push(t),e=t,n+=1),n=/[eE]/.test(t)||"-"===t&&/[eE]/.test(e)?(o.push(t),e=t,n+1):/[^\d]/.test(t)?(b(o.join("")),a=c,n):(o.push(t),e=t,n+1);break;case 9999:n=O();break;case 9:n=/[^\s]/g.test(t)?(b(o.join("")),a=c,n):(o.push(t),e=t,n+1);break;case c:o=o.length?[]:o,n="/"===e&&"*"===t?(d=i+n-1,a=0,e=t,n+1):"/"===e&&"/"===t?(d=i+n-1,a=1,e=t,n+1):"#"===t?(a=2,d=i+n,n):/\s/.test(t)?(a=9,d=i+n,n):(m=/\d/.test(t),p=/[^\w_]/.test(t),d=i+n,a=m?4:p?3:9999,n)}if(u!==n)switch(g[u]){case"\n":h=0,++f;break;default:++h}}return i+=n,g=g.slice(n),l}function x(){return"\r"!==t&&"\n"!==t||"\\"===e?(o.push(t),e=t,n+1):(b(o.join("")),a=c,n)}function _(){if("."===e&&/\d/.test(t))return a=5,n;if("/"===e&&"*"===t)return a=0,n;if("/"===e&&"/"===t)return a=1,n;if("."===t&&o.length){for(;M(o););return a=5,n}if(";"===t||")"===t||"("===t){if(o.length)for(;M(o););return b(t),a=c,n+1}var r=2===o.length&&"="!==t;if(/[\w_\d\s]/.test(t)||r){for(;M(o););return a=c,n}return o.push(t),e=t,n+1}function M(t){for(var e,r,n=0;;){if(e=s.c.indexOf(t.slice(0,t.length+n).join("")),r=s.c[e],-1===e){if(n--+t.length>0)continue;r=t.slice(0,1).join("")}return b(r),d+=r.length,(o=o.slice(r.length)).length}}function O(){if(/[^\d\w_]/.test(t)){var r=o.join("");return a=s.b.indexOf(r)>-1?8:s.a.indexOf(r)>-1?7:6,b(o.join("")),a=c,n}return o.push(t),e=t,n+1}}function f(t){return function(t){var e=l(),r=[];return(r=r.concat(e(t))).concat(e(null))}(t)}const h=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"];function d(t,e){for(let r=e-1;r>=0;r--){const e=t[r];if("whitespace"!==e.type&&"block-comment"!==e.type){if("keyword"!==e.type)break;if("attribute"===e.data||"in"===e.data)return!0}}return!1}function m(t,e,r,n){n=n||r;for(const i of t)if("ident"===i.type&&i.data===r)return n in e?e[n]++:e[n]=0,m(t,e,n+"_"+e[n],n);return r}function p(t,e,r="afterVersion"){function n(t,e){for(let r=e;r<t.length;r++){const e=t[r];if("operator"===e.type&&";"===e.data)return r}return null}const i={data:"\n",type:"whitespace"},a=e=>e<t.length&&/[^\r\n]$/.test(t[e].data);let o=function(t){let e=-1,i=0,a=-1;for(let o=0;o<t.length;o++){const s=t[o];if("preprocessor"===s.type&&(s.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++i:s.data.match(/\#endif\s*.*/)&&--i),"afterVersion"!==r&&"afterPrecision"!==r||"preprocessor"===s.type&&/^#version/.test(s.data)&&(a=Math.max(a,o)),"afterPrecision"===r&&"keyword"===s.type&&"precision"===s.data){const e=n(t,o);if(null===e)throw new Error("precision statement not followed by any semicolons!");a=Math.max(a,e)}e<a&&0===i&&(e=o)}return e+1}(t);a(o-1)&&t.splice(o++,0,i);for(const s of e)t.splice(o++,0,s);a(o-1)&&a(o)&&t.splice(o,0,i)}function g(t,e,r,n="lowp"){p(t,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"ident",data:e},{type:"operator",data:";"}],"afterPrecision")}function b(t,e,r,n,i="lowp"){p(t,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"="},{type:"whitespace",data:" "},{type:"integer",data:n.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"ident",data:e},{type:"operator",data:";"}],"afterPrecision")}function v(t,e){let r,n,i=-1;for(let a=e;a<t.length;a++){const e=t[a];if("operator"===e.type&&("["===e.data&&(r=a),"]"===e.data)){n=a;break}"integer"===e.type&&(i=parseInt(e.data,10))}return r&&n&&t.splice(r,n-r+1),i}function x(t,e){const r=f(t);if("300 es"===function(t,e="100",r="300 es"){const n=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/;for(const i of t)if("preprocessor"===i.type){const t=n.exec(i.data);if(t){const n=t[1].replace(/\s\s+/g," ");if(n===r)return n;if(n===e)return i.data="#version "+r,e;throw new Error("unknown glsl version: "+n)}}return t.splice(0,0,{type:"preprocessor",data:"#version "+r},{type:"whitespace",data:"\n"}),null}(r,"100","300 es"))throw new Error("shader is already glsl 300 es");let n=null,i=null;const a={},s={};for(let c=0;c<r.length;++c){const t=r[c];switch(t.type){case"keyword":35633===e&&"attribute"===t.data?t.data="in":"varying"===t.data&&(t.data=35633===e?"out":"in");break;case"builtin":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(t.data.trim())&&(t.data=t.data.replace(/(2D|Cube|EXT)/g,"")),35632===e&&"gl_FragColor"===t.data&&(n||(n=m(r,a,"fragColor"),g(r,n,"vec4")),t.data=n),35632===e&&"gl_FragData"===t.data){const e=v(r,c+1),n=m(r,a,"fragData");b(r,n,"vec4",e,"mediump"),t.data=n}else 35632===e&&"gl_FragDepthEXT"===t.data&&(i||(i=m(r,a,"gl_FragDepth")),t.data=i);break;case"ident":if(o.indexOf(t.data)>=0){if(35633===e&&d(r,c))throw new Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");t.data in s||(s[t.data]=m(r,a,t.data)),t.data=s[t.data]}}}for(let o=r.length-1;o>=0;--o){const t=r[o];if("preprocessor"===t.type){const e=t.data.match(/\#extension\s+(.*)\:/);if(e&&e[1]&&h.indexOf(e[1].trim())>=0){const t=r[o+1];r.splice(o,t&&"whitespace"===t.type?2:1)}const n=t.data.match(/\#ifdef\s+(.*)/);n&&n[1]&&h.indexOf(n[1].trim())>=0&&(t.data="#if 1");const i=t.data.match(/\#ifndef\s+(.*)/);i&&i[1]&&h.indexOf(i[1].trim())>=0&&(t.data="#if 0")}}return r.map((t=>"eof"!==t.type?t.data:"")).join("")}class _{constructor(t,e,r,n){this._context=t,this._locations=n,this._vShader=null,this._fShader=null,this._nameToUniformLocation={},this._nameToUniform1={},this._nameToUniform1v={},this._nameToUniform2={},this._nameToUniform3={},this._nameToUniform4={},this._nameToUniformMatrix3={},this._nameToUniformMatrix4={},t||console.error("RenderingContext isn't initialized!"),0===e.length&&console.error("Shaders source should not be empty!"),this._vShader=O(this._context,35633,e),this._fShader=O(this._context,35632,r),this._vShader&&this._fShader||console.error("Error loading shaders!");const o=this._context.gl,s=o.createProgram();o.attachShader(s,this._vShader),o.attachShader(s,this._fShader),n.forEach(((t,e)=>o.bindAttribLocation(s,t,e))),o.linkProgram(s),Object(a.c)()&&!o.getProgramParameter(s,o.LINK_STATUS)&&console.error("Could not initialize shader\nVALIDATE_STATUS: "+o.getProgramParameter(s,o.VALIDATE_STATUS)+", gl error ["+o.getError()+"]infoLog: "+o.getProgramInfoLog(s)),this._glName=s,this._context.instanceCounter.increment(i.b.Program,this)}get glName(){return this._glName}dispose(){const t=this._context.gl;if(this._vShader){const e=this._vShader;t.deleteShader(e),this._vShader=null}if(this._fShader){const e=this._fShader;t.deleteShader(e),this._fShader=null}this._glName&&(t.deleteProgram(this._glName),this._glName=null,this._context.instanceCounter.decrement(i.b.Program,this))}_getUniformLocation(t){return void 0===this._nameToUniformLocation[t]&&(this._nameToUniformLocation[t]=this._context.gl.getUniformLocation(this._glName,t)),this._nameToUniformLocation[t]}hasUniform(t){return null!==this._getUniformLocation(t)}setUniform1i(t,e){const r=this._nameToUniform1[t];void 0!==r&&e===r||(this._context.useProgram(this),this._context.gl.uniform1i(this._getUniformLocation(t),e),this._nameToUniform1[t]=e)}setUniform1iv(t,e){const r=this._nameToUniform1v[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform1iv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform1v[t]=Array.from(e):T(e,r))}setUniform2iv(t,e){const r=this._nameToUniform2[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform2iv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform2[t]=Array.from(e):T(e,r))}setUniform3iv(t,e){const r=this._nameToUniform3[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform3iv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform3[t]=Array.from(e):T(e,r))}setUniform4iv(t,e){const r=this._nameToUniform4[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform4iv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform4[t]=Array.from(e):T(e,r))}setUniform1f(t,e){const r=this._nameToUniform1[t];void 0!==r&&e===r||(this._context.useProgram(this),this._context.gl.uniform1f(this._getUniformLocation(t),e),this._nameToUniform1[t]=e)}setUniform1fv(t,e){const r=this._nameToUniform1v[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform1fv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform1v[t]=Array.from(e):T(e,r))}setUniform2f(t,e,r){const n=this._nameToUniform2[t];void 0!==n&&e===n[0]&&r===n[1]||(this._context.useProgram(this),this._context.gl.uniform2f(this._getUniformLocation(t),e,r),void 0===n?this._nameToUniform2[t]=[e,r]:(n[0]=e,n[1]=r))}setUniform2fv(t,e){const r=this._nameToUniform2[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform2fv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform2[t]=Array.from(e):T(e,r))}setUniform3f(t,e,r,n){const i=this._nameToUniform3[t];void 0!==i&&e===i[0]&&r===i[1]&&n===i[2]||(this._context.useProgram(this),this._context.gl.uniform3f(this._getUniformLocation(t),e,r,n),void 0===i?this._nameToUniform3[t]=[e,r,n]:(i[0]=e,i[1]=r,i[2]=n))}setUniform3fv(t,e){const r=this._nameToUniform3[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform3fv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform3[t]=Array.from(e):T(e,r))}setUniform4f(t,e,r,n,i){const a=this._nameToUniform4[t];void 0!==a&&e===a[0]&&r===a[1]&&n===a[2]&&i===a[3]||(this._context.useProgram(this),this._context.gl.uniform4f(this._getUniformLocation(t),e,r,n,i),void 0===a?this._nameToUniform4[t]=[e,r,n,i]:(a[0]=e,a[1]=r,a[2]=n,a[3]=i))}setUniform4fv(t,e){const r=this._nameToUniform4[t];M(r,e)&&(this._context.useProgram(this),this._context.gl.uniform4fv(this._getUniformLocation(t),e),void 0===r?this._nameToUniform4[t]=Array.from(e):T(e,r))}setUniformMatrix3fv(t,e,r=!1){const i=this._nameToUniformMatrix3[t];(function(t,e){return!!Object(n.j)(t)||(9!==t.length?M(t,e):9!==t.length||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[7]!==e[7]||t[8]!==e[8])})(i,e)&&(this._context.useProgram(this),this._context.gl.uniformMatrix3fv(this._getUniformLocation(t),r,e),void 0===i?this._nameToUniformMatrix3[t]=Array.from(e):T(e,i))}setUniformMatrix4fv(t,e,r=!1){const i=this._nameToUniformMatrix4[t];(function(t,e){return!!Object(n.j)(t)||(16!==t.length?M(t,e):16!==t.length||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[7]!==e[7]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]||t[11]!==e[11]||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[15]!==e[15])})(i,e)&&(this._context.useProgram(this),this._context.gl.uniformMatrix4fv(this._getUniformLocation(t),r,e),void 0===i?this._nameToUniformMatrix4[t]=Array.from(e):T(e,i))}assertCompatibleVertexAttributeLocations(t){t.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}stop(){}}function M(t,e){if(Object(n.j)(t)||t.length!==e.length)return!0;for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!0;return!1}function O(t,e,r){const n="webgl2"===t.webglVersion?x(r,e):r,i=t.gl,o=i.createShader(e);return i.shaderSource(o,n),i.compileShader(o),Object(a.c)()&&!i.getShaderParameter(o,i.COMPILE_STATUS)&&(console.error("Compile error in ".concat(35633===e?"vertex":"fragment"," shader")),console.error(i.getShaderInfoLog(o)),console.error(function(t){let e=2;return t.replace(/\n/g,(()=>"\n"+function(t){return t>=1e3?t.toString():("  "+t).slice(-3)}(e++)+":"))}(n)),"webgl2"===t.webglVersion&&(console.log("Shader source before transpilation:"),console.log(r))),o}function T(t,e){for(let r=0;r<t.length;++r)e[r]=t[r]}},493:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return c})),r.d(e,"e",(function(){return u})),r.d(e,"f",(function(){return l})),r.d(e,"g",(function(){return o})),r.d(e,"h",(function(){return a}));const n={func:513},i={func:519},a={mask:255},o={mask:0},s={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},c={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},u={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},l={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},494:function(t,e,r){"use strict";r.d(e,"a",(function(){return m})),r.d(e,"b",(function(){return l})),r.d(e,"c",(function(){return d})),r.d(e,"d",(function(){return A})),r.d(e,"e",(function(){return g})),r.d(e,"f",(function(){return f})),r.d(e,"g",(function(){return I})),r.d(e,"h",(function(){return u}));var n=r(281),i=r(357),a=r(99),o=r(222),s=r(101),c=r(189);function u(t,e,r){r*=.5;const n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function l(t,e){const r=2*Math.acos(e[3]),n=Math.sin(r/2);return n>o.a?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function f(t,e,r){const n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],c=r[1],u=r[2],l=r[3];return t[0]=n*l+o*s+i*u-a*c,t[1]=i*l+o*c+a*s-n*u,t[2]=a*l+o*u+n*c-i*s,t[3]=o*l-n*s-i*c-a*u,t}function h(t,e,r,n){const i=e[0],a=e[1],s=e[2],c=e[3];let u,l,f,h,d,m=r[0],p=r[1],g=r[2],b=r[3];return l=i*m+a*p+s*g+c*b,l<0&&(l=-l,m=-m,p=-p,g=-g,b=-b),1-l>o.a?(u=Math.acos(l),f=Math.sin(u),h=Math.sin((1-n)*u)/f,d=Math.sin(n*u)/f):(h=1-n,d=n),t[0]=h*i+d*m,t[1]=h*a+d*p,t[2]=h*s+d*g,t[3]=h*c+d*b,t}function d(t,e){const r=e[0],n=e[1],i=e[2],a=e[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return t[0]=-r*s,t[1]=-n*s,t[2]=-i*s,t[3]=a*s,t}function m(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function p(t,e){const r=e[0]+e[4]+e[8];let n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);const i=(r+1)%3,a=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*i+i]-e[3*a+a]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*i+a]-e[3*a+i])*n,t[i]=(e[3*i+r]+e[3*r+i])*n,t[a]=(e[3*a+r]+e[3*r+a])*n}return t}function g(t,e,r,n){const i=.5*Math.PI/180;e*=i,r*=i,n*=i;const a=Math.sin(e),o=Math.cos(e),s=Math.sin(r),c=Math.cos(r),u=Math.sin(n),l=Math.cos(n);return t[0]=a*c*l-o*s*u,t[1]=o*s*l+a*c*u,t[2]=o*c*u-a*s*l,t[3]=o*c*l+a*s*u,t}const b=c.c,v=c.l,x=c.a,_=f,M=c.b,O=c.d,T=c.j,y=c.e,w=y,S=c.f,j=S,P=c.k,A=c.g,D=c.h;function I(t,e,r){const n=Object(s.h)(e,r);return n<-.999999?(Object(s.g)(F,z,e),Object(s.y)(F)<1e-6&&Object(s.g)(F,E,e),Object(s.r)(F,F),u(t,F,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Object(s.g)(F,e,r),t[0]=F[0],t[1]=F[1],t[2]=F[2],t[3]=1+n,P(t,t))}const F=Object(a.e)(),z=Object(a.g)(1,0,0),E=Object(a.g)(0,1,0);const U=Object(i.b)(),L=Object(i.b)();const C=Object(n.b)();Object.freeze({__proto__:null,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:u,getAxisAngle:l,multiply:f,rotateX:function(t,e,r){r*=.5;const n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=n*c+o*s,t[1]=i*c+a*s,t[2]=a*c-i*s,t[3]=o*c-n*s,t},rotateY:function(t,e,r){r*=.5;const n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=n*c-a*s,t[1]=i*c+o*s,t[2]=a*c+n*s,t[3]=o*c-i*s,t},rotateZ:function(t,e,r){r*=.5;const n=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(r),c=Math.cos(r);return t[0]=n*c+i*s,t[1]=i*c-n*s,t[2]=a*c+o*s,t[3]=o*c-a*s,t},calculateW:function(t,e){const r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t},slerp:h,random:function(t){const e=Object(o.b)(),r=Object(o.b)(),n=Object(o.b)(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=a*Math.sin(2*Math.PI*n),t[3]=a*Math.cos(2*Math.PI*n),t},invert:d,conjugate:m,fromMat3:p,fromEuler:g,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},copy:b,set:v,add:x,mul:_,scale:M,dot:O,lerp:T,length:y,len:w,squaredLength:S,sqrLen:j,normalize:P,exactEquals:A,equals:D,rotationTo:I,sqlerp:function(t,e,r,n,i,a){return h(U,e,i,a),h(L,r,n,a),h(t,U,L,2*a*(1-a)),t},setAxes:function(t,e,r,n){const i=C;return i[0]=r[0],i[3]=r[1],i[6]=r[2],i[1]=n[0],i[4]=n[1],i[7]=n[2],i[2]=-e[0],i[5]=-e[1],i[8]=-e[2],P(t,p(t,i))}})},501:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return o}));var n=r(110),i=r(310);function a(t){t.vertex.code.add(n.a`float screenSizePerspectiveMinSize(float size, vec4 factor) {
float nonZeroSize = 1.0 - step(size, 0.0);
return (
factor.z * (
1.0 +
nonZeroSize *
2.0 * factor.w / (
size + (1.0 - nonZeroSize)
)
)
);
}`),t.vertex.code.add(n.a`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),t.vertex.code.add(n.a`vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {
return vec4(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z,
params.w
);
}`),t.vertex.code.add(n.a`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {
return max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));
}`),t.vertex.code.add(n.a`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),t.vertex.code.add(n.a`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {
return mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);
}`),t.vertex.code.add(n.a`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function o(t,e){if(e.screenSizePerspective){Object(i.a)(e.screenSizePerspective,t,"screenSizePerspective");const r=e.screenSizePerspectiveAlignment||e.screenSizePerspective;Object(i.a)(r,t,"screenSizePerspectiveAlignment")}}},512:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(110);function i(t,e){e.attributeColor?(t.attributes.add("color","vec4"),t.varyings.add("vColor","vec4"),t.vertex.code.add(n.a`void forwardVertexColor() { vColor = color; }`),t.vertex.code.add(n.a`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):t.vertex.code.add(n.a`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}},524:function(t,e,r){"use strict";r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return u}));var n=r(300);const i=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],a=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}];var o=r(199),s=r(164),c=r(203);function u(t,e=i,r=n.a,s=-1,u=1){let l=null;switch(e){case a:l=new Float32Array([s,s,0,0,u,s,1,0,s,u,0,1,u,u,1,1]);break;case i:default:l=new Float32Array([s,s,u,s,s,u,u,u])}return new c.a(t,r,{geometry:e},{geometry:o.a.createVertex(t,35044,l)})}function l(t){return new s.a(t,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},540:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return s}));var n=r(387),i=r(110);function a(t){t.fragment.include(n.a),t.fragment.uniforms.add("uShadowMapTex","sampler2D"),t.fragment.uniforms.add("uShadowMapNum","int"),t.fragment.uniforms.add("uShadowMapDistance","vec4"),t.fragment.uniforms.add("uShadowMapMatrix","mat4",4),t.fragment.uniforms.add("uDepthHalfPixelSz","float"),t.fragment.code.add(i.a`int chooseCascade(float _linearDepth, out mat4 mat) {
vec4 distance = uShadowMapDistance;
float depth = _linearDepth;
int i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;
mat = i == 0 ? uShadowMapMatrix[0] : i == 1 ? uShadowMapMatrix[1] : i == 2 ? uShadowMapMatrix[2] : uShadowMapMatrix[3];
return i;
}
vec3 lightSpacePosition(vec3 _vpos, mat4 mat) {
vec4 lv = mat * vec4(_vpos, 1.0);
lv.xy /= lv.w;
return 0.5 * lv.xyz + vec3(0.5);
}
vec2 cascadeCoordinates(int i, vec3 lvpos) {
return vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;
}
float readShadowMapDepth(vec2 uv, sampler2D _depthTex) {
return rgba2float(texture2D(_depthTex, uv));
}
float posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {
return readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;
}
float filterShadow(vec2 uv, vec3 lvpos, float halfPixelSize, sampler2D _depthTex) {
float texSize = 0.5 / halfPixelSize;
vec2 st = fract((vec2(halfPixelSize) + uv) * texSize);
float s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);
float s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);
float s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);
float s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);
return mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);
}
float readShadowMap(const in vec3 _vpos, float _linearDepth) {
mat4 mat;
int i = chooseCascade(_linearDepth, mat);
if (i >= uShadowMapNum) { return 0.0; }
vec3 lvpos = lightSpacePosition(_vpos, mat);
if (lvpos.z >= 1.0) { return 0.0; }
if (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }
vec2 uv = cascadeCoordinates(i, lvpos);
return filterShadow(uv, lvpos, uDepthHalfPixelSz, uShadowMapTex);
}`)}function o(t,e){e.shadowMappingEnabled&&(e.shadowMap.bind(t),e.shadowMap.bindView(t,e.origin))}function s(t,e,r){e.shadowMappingEnabled&&e.shadowMap.bindView(t,r)}function c(t,e){e.shadowMappingEnabled&&e.shadowMap.bindView(t,e.origin)}},549:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return o}));r(77);function n(t){switch(t){case"u8":return 1;case"u16":return 2;case"u32":return 4;case"i8":return 1;case"i16":return 2;case"i32":case"f32":return 4;case"f64":return 8;default:return}}function i(t){switch(t){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function a(t){switch(t){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function o(t){switch(t){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},550:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(110);function i(t){t.vertex.code.add(n.a`const float PI = 3.141592653589793;`),t.fragment.code.add(n.a`const float PI = 3.141592653589793;
const float LIGHT_NORMALIZATION = 1.0 / PI;
const float INV_PI = 0.3183098861837907;
const float HALF_PI = 1.570796326794897;`)}},567:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return s})),r.d(e,"d",(function(){return u}));var n=r(107);function i(t,e,r){const n=r.parameters,i=r.paddingPixelsOverride;return l.scale=Math.min(n.divisor/(e-n.offset),1),l.factor=function(t){return Math.abs(t*t*t)}(t),l.minPixelSize=n.minPixelSize,l.paddingPixels=i,l}function a(t,e){return 0===t?e.minPixelSize:e.minPixelSize*(1+2*e.paddingPixels/t)}function o(t,e){return Math.max(Object(n.m)(t*e.scale,t,e.factor),a(t,e))}function s(t,e,r,n){n.scale=function(t,e,r){const n=i(t,e,r);return n.minPixelSize=0,n.paddingPixels=0,o(1,n)}(t,e,r),n.factor=0,n.minPixelSize=r.parameters.minPixelSize,n.paddingPixels=r.paddingPixelsOverride}function c(t,e,r=[0,0]){const n=Math.min(Math.max(e.scale,a(t[1],e)/t[1]),1);return r[0]=t[0]*n,r[1]=t[1]*n,r}function u(t,e,r,n){return o(t,i(e,r,n))}Object(n.g)(10),Object(n.g)(12),Object(n.g)(70),Object(n.g)(40);const l={scale:0,factor:0,minPixelSize:0,paddingPixels:0}},568:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return n})),r.d(e,"c",(function(){return a}));const n=t=>class extends t{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const e of null!=(t=this._managedDisposables)?t:[]){var t;const r=this[e];this[e]=null,r&&"function"==typeof r.dispose&&r.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}};class i extends(n(class{})){}function a(){return(t,e)=>{var r,n;t.hasOwnProperty("_managedDisposables")||(t._managedDisposables=null!=(r=null==(n=t._managedDisposables)?void 0:n.slice())?r:[]),t._managedDisposables.unshift(e)}}},594:function(t,e,r){"use strict";function n(t,e,r){for(let n=0;n<r;++n)e[2*n]=t[n],e[2*n+1]=t[n]-e[2*n]}function i(t,e,r,i){for(let s=0;s<i;++s)a[0]=t[s],n(a,o,1),e[s]=o[0],r[s]=o[1]}r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return i}));const a=new Float64Array(1),o=new Float32Array(2)},595:function(t,e,r){"use strict";function n(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}r.d(e,"a",(function(){return n}));const i=n();Object.freeze({__proto__:null,create:n,clone:function(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,e,r,n,i,a,o,s,c,u,l,f,h,d,m,p){const g=new Float32Array(16);return g[0]=t,g[1]=e,g[2]=r,g[3]=n,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=c,g[9]=u,g[10]=l,g[11]=f,g[12]=h,g[13]=d,g[14]=m,g[15]=p,g},createView:function(t,e){return new Float32Array(t,e,16)},IDENTITY:i})},617:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return o}));var n=r(501),i=r(110);function a(t,e){const r=t.vertex.code;e.verticalOffsetEnabled?(t.vertex.uniforms.add("verticalOffset","vec4"),e.screenSizePerspectiveEnabled&&(t.include(n.a),t.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),r.add(i.a`
    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
      ${1===e.viewingMode?i.a`vec3 worldNormal = normalize(worldPos + localOrigin);`:i.a`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
      ${e.screenSizePerspectiveEnabled?i.a`
          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));
          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:i.a`
          float verticalOffsetScreenHeight = verticalOffset.x;`}
      // Screen sized offset in world space, used for example for line callouts
      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
      return worldNormal * worldOffset;
    }

    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
      return worldPos + calculateVerticalOffset(worldPos, localOrigin);
    }
    `)):r.add(i.a`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}function o(t,e,r){if(!e.verticalOffset)return;const n=s(e.verticalOffset,r.camera.fovY,r.camera.fullViewport[3]),i=r.camera.pixelRatio||1;t.setUniform4f("verticalOffset",n.screenLength*i,n.perDistance,n.minWorldLength,n.maxWorldLength)}function s(t,e,r,n=c){return n.screenLength=t.screenLength,n.perDistance=Math.tan(.5*e)/(.5*r),n.minWorldLength=t.minWorldLength,n.maxWorldLength=t.maxWorldLength,n}const c={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}},636:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(110);function i(t,e){0===e.output&&e.receiveShadows?(t.varyings.add("linearDepth","float"),t.vertex.code.add(n.a`void forwardLinearDepth() { linearDepth = gl_Position.w; }`)):1===e.output||3===e.output?(t.varyings.add("linearDepth","float"),t.vertex.uniforms.add("cameraNearFar","vec2"),t.vertex.code.add(n.a`void forwardLinearDepth() {
linearDepth = (-position_view().z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);
}`)):t.vertex.code.add(n.a`void forwardLinearDepth() {}`)}},637:function(t,e,r){"use strict";r.d(e,"a",(function(){return C}));var n=r(184),i=r(85),a=r(122),o=r(107),s=r(83),c=r(87),u=r(308),l=r(94),f=r(643),h=r(403),d=r(128);let m;var p=r(164),g=r(470);let b=null,v=null;async function x(){return Object(s.j)(v)&&(v=function(){if(Object(s.j)(m)){const t=t=>Object(d.a)(`esri/libs/basisu/${t}`);m=Promise.all([r.e(195),r.e(274)]).then(r.bind(null,1261)).then((function(t){return t.b})).then((({default:e})=>e({locateFile:t}).then((t=>(t.initializeBasis(),delete t.then,t)))))}return m}(),b=await v),v}function _(t,e,r,n,i){const a=Object(g.b)(e?37496:37492),o=i&&t>1?(4**t-1)/(3*4**(t-1)):1;return Math.ceil(r*n*a*o)}function M(t){return t.getNumImages()>=1&&!t.isUASTC()}function O(t){return t.getFaces()>=1&&t.isETC1S()}function T(t,e,r,n,i,a,o,s){const{compressedTextureETC:c,compressedTextureS3TC:u}=t.capabilities,[l,f]=c?n?[1,37496]:[0,37492]:u?n?[3,33779]:[2,33776]:[13,6408],h=e.hasMipmap?r:Math.min(1,r),d=[];for(let p=0;p<h;p++)d.push(new Uint8Array(o(p,l))),s(p,l,d[p]);const m=d.length>1,g=m?9987:9729,b={...e,samplingMode:g,hasMipmap:m,internalFormat:f,width:i,height:a};return new p.a(t,b,{type:"compressed",levels:d})}var y=r(358);const w=r(78).a.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),S=542327876,j=131072;function P(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}const A=P("DXT1"),D=P("DXT3"),I=P("DXT5");function F(t,e,r){const{textureData:n,internalFormat:i,width:a,height:s}=function(t,e){const r=new Int32Array(t,0,31);if(r[0]!==S)return w.error("Invalid magic number in DDS header"),null;if(!(4&r[20]))return w.error("Unsupported format, must contain a FourCC code"),null;const n=r[21];let i,a;switch(n){case A:i=8,a=33776;break;case D:i=16,a=33778;break;case I:i=16,a=33779;break;default:return w.error("Unsupported FourCC code:",function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}(n)),null}let s=1,c=r[4],u=r[3];0==(3&c)&&0==(3&u)||(w.warn("Rounding up compressed texture size to nearest multiple of 4."),c=c+3&-4,u=u+3&-4);const l=c,f=u;let h,d;r[2]&j&&!1!==e&&(s=Math.max(1,r[7])),1===s||Object(o.l)(c)&&Object(o.l)(u)||(w.warn("Ignoring mipmaps of non power of two sized compressed texture."),s=1);let m=r[1]+4;const p=[];for(let o=0;o<s;++o)d=(c+3>>2)*(u+3>>2)*i,h=new Uint8Array(t,m,d),p.push(h),m+=d,c=Math.max(1,c>>1),u=Math.max(1,u>>1);return{textureData:{type:"compressed",levels:p},internalFormat:a,width:l,height:f}}(r,e.hasMipmap);return e.samplingMode=n.levels.length>1?9987:9729,e.hasMipmap=n.levels.length>1,e.internalFormat=i,e.width=a,e.height=s,new p.a(t,e,n)}var z=r(524),E=r(176),U=r(230),L=r(325);class C extends y.a{constructor(t,e){super(),this.data=t,this.type=4,this.glTexture=null,this.powerOfTwoStretchInfo=null,this.loadingPromise=null,this.loadingController=null,this.events=new a.a,this.params=e||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:10497,t:10497},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||1,this.estimatedTexMemRequired=C.estimateTexMemRequired(this.data,this.params),this.startPreload()}startPreload(){const t=this.data;Object(s.j)(t)||(t instanceof HTMLVideoElement?this.startPreloadVideoElement(t):t instanceof HTMLImageElement&&this.startPreloadImageElement(t))}startPreloadVideoElement(t){Object(l.t)(t.src)||"auto"===t.preload&&t.crossOrigin||(t.preload="auto",t.crossOrigin="anonymous",t.src=t.src)}startPreloadImageElement(t){Object(l.u)(t.src)||Object(l.t)(t.src)||t.crossOrigin||(t.crossOrigin="anonymous",t.src=t.src)}static getDataDimensions(t){return t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t}static estimateTexMemRequired(t,e){if(Object(s.j)(t))return 0;if(Object(u.c)(t)||Object(u.k)(t))return e.encoding===C.KTX2_ENCODING?function(t,e){if(Object(s.j)(b))return t.byteLength;const r=new b.KTX2File(new Uint8Array(t)),n=O(r)?_(r.getLevels(),r.getHasAlpha(),r.getWidth(),r.getHeight(),e):0;return r.close(),r.delete(),n}(t,e.mipmap):e.encoding===C.BASIS_ENCODING?function(t,e){if(Object(s.j)(b))return t.byteLength;const r=new b.BasisFile(new Uint8Array(t)),n=M(r)?_(r.getNumLevels(0),r.getHasAlpha(),r.getImageWidth(0,0),r.getImageHeight(0,0),e):0;return r.close(),r.delete(),n}(t,e.mipmap):t.byteLength;const{width:r,height:n}=t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement?C.getDataDimensions(t):e;return(e.mipmap?4/3:1)*r*n*(e.components||4)||0}dispose(){this.data=void 0}get width(){return this.params.width}get height(){return this.params.height}createDescriptor(t){var e;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:null!=(e=this.params.maxAnisotropy)?e:this.params.mipmap?t.parameters.maxMaxAnisotropy:1}}load(t,e){if(Object(s.k)(this.glTexture))return this.glTexture;if(Object(s.k)(this.loadingPromise))return this.loadingPromise;const r=this.data;return Object(s.j)(r)?(this.glTexture=new p.a(t,this.createDescriptor(t),null),this.glTexture):"string"==typeof r?this.loadFromURL(t,e,r):r instanceof Image?this.loadFromImageElement(t,e,r):r instanceof HTMLVideoElement?this.loadFromVideoElement(t,e,r):r instanceof ImageData||r instanceof HTMLCanvasElement?this.loadFromImage(t,r,e):(Object(u.c)(r)||Object(u.k)(r))&&this.params.encoding===C.DDS_ENCODING?this.loadFromDDSData(t,r):(Object(u.c)(r)||Object(u.k)(r))&&this.params.encoding===C.KTX2_ENCODING?this.loadFromKTX2(t,r):(Object(u.c)(r)||Object(u.k)(r))&&this.params.encoding===C.BASIS_ENCODING?this.loadFromBasis(t,r):Object(u.k)(r)?this.loadFromPixelData(t,r):Object(u.c)(r)?this.loadFromPixelData(t,new Uint8Array(r)):null}get requiresFrameUpdates(){return this.data instanceof HTMLVideoElement}frameUpdate(t,e,r){if(!(this.data instanceof HTMLVideoElement)||Object(s.j)(this.glTexture))return r;if(this.data.readyState<2||r===this.data.currentTime)return r;if(Object(s.k)(this.powerOfTwoStretchInfo)){const{framebuffer:r,vao:n,sourceTexture:i}=this.powerOfTwoStretchInfo;i.setData(this.data),this.drawStretchedTexture(t,e,r,n,i,this.glTexture)}else{const{width:t,height:e}=this.data,{width:r,height:n}=this.glTexture.descriptor;t!==r||e!==n?this.glTexture.updateData(0,0,0,Math.min(t,r),Math.min(e,n),this.data):this.glTexture.setData(this.data)}return this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap(),this.data.currentTime}loadFromDDSData(t,e){return this.glTexture=F(t,this.createDescriptor(t),e),this.glTexture}loadFromKTX2(t,e){return this.loadAsync((()=>async function(t,e,r){Object(s.j)(b)&&(b=await x());const n=new b.KTX2File(new Uint8Array(r));if(!O(n))return null;n.startTranscoding();const i=T(t,e,n.getLevels(),n.getHasAlpha(),n.getWidth(),n.getHeight(),((t,e)=>n.getImageTranscodedSizeInBytes(t,0,0,e)),((t,e,r)=>n.transcodeImage(r,t,0,0,e,0,-1,-1)));return n.close(),n.delete(),i}(t,this.createDescriptor(t),e).then((t=>(this.glTexture=t,t)))))}loadFromBasis(t,e){return this.loadAsync((()=>async function(t,e,r){Object(s.j)(b)&&(b=await x());const n=new b.BasisFile(new Uint8Array(r));if(!M(n))return null;n.startTranscoding();const i=T(t,e,n.getNumLevels(0),n.getHasAlpha(),n.getImageWidth(0,0),n.getImageHeight(0,0),((t,e)=>n.getImageTranscodedSizeInBytes(0,t,e)),((t,e,r)=>n.transcodeImage(r,0,t,e,0,0)));return n.close(),n.delete(),i}(t,this.createDescriptor(t),e).then((t=>(this.glTexture=t,t)))))}loadFromPixelData(t,e){Object(E.a)(this.params.width>0&&this.params.height>0);const r=this.createDescriptor(t);return r.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,r.width=this.params.width,r.height=this.params.height,this.glTexture=new p.a(t,r,e),this.glTexture}loadAsync(t){const e=Object(c.d)();this.loadingController=e;const r=t(e.signal);this.loadingPromise=r;const n=()=>{this.loadingController===e&&(this.loadingController=null),this.loadingPromise===r&&(this.loadingPromise=null)};return r.then(n,n),r}loadFromURL(t,e,r){return this.loadAsync((async n=>{const i=await Object(f.a)(r,{signal:n});return this.loadFromImage(t,i,e)}))}loadFromImageElement(t,e,r){return r.complete?this.loadFromImage(t,r,e):this.loadAsync((async n=>{const i=await Object(h.a)(r,r.src,!1,n);return this.loadFromImage(t,i,e)}))}loadFromVideoElement(t,e,r){return r.readyState>=2?this.loadFromImage(t,r,e):this.loadFromVideoElementAsync(t,e,r)}loadFromVideoElementAsync(t,e,r){return this.loadAsync((n=>new Promise(((a,o)=>{const u=()=>{r.removeEventListener("loadeddata",l),r.removeEventListener("error",f),Object(s.k)(h)&&h.remove()},l=()=>{r.readyState>=2&&(u(),a(this.loadFromImage(t,r,e)))},f=t=>{u(),o(t||new i.a("Failed to load video"))};r.addEventListener("loadeddata",l),r.addEventListener("error",f);const h=Object(c.q)(n,(()=>f(Object(c.e)())))}))))}loadFromImage(t,e,r){const n=C.getDataDimensions(e);this.params.width=n.width,this.params.height=n.height;const i=this.createDescriptor(t);return i.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(t,i)||Object(o.l)(n.width)&&Object(o.l)(n.height)?(i.width=n.width,i.height=n.height,this.glTexture=new p.a(t,i,e),this.glTexture):(this.glTexture=this.makePowerOfTwoTexture(t,e,n,i,r),this.glTexture)}requiresPowerOfTwo(t,e){const r=33071,n="number"==typeof e.wrapMode?e.wrapMode===r:e.wrapMode.s===r&&e.wrapMode.t===r;return!Object(L.a)(t.gl)&&(e.hasMipmap||!n)}makePowerOfTwoTexture(t,e,r,i,a){const{width:s,height:c}=r,u=Object(o.p)(s),l=Object(o.p)(c);let f;switch(i.width=u,i.height=l,this.params.powerOfTwoResizeMode){case 2:i.textureCoordinateScaleFactor=[s/u,c/l],f=new p.a(t,i),f.updateData(0,0,0,s,c,e);break;case 1:case null:case void 0:f=this.stretchToPowerOfTwo(t,e,i,a);break;default:Object(n.a)(this.params.powerOfTwoResizeMode)}return i.hasMipmap&&f.generateMipmap(),f}stretchToPowerOfTwo(t,e,r,n){const i=new p.a(t,r),a=new U.a(t,{colorTarget:0,depthStencilTarget:0},i),o=new p.a(t,{target:3553,pixelFormat:r.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},e),s=Object(z.b)(t);return this.drawStretchedTexture(t,n,a,s,o,i),this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:s,sourceTexture:o,framebuffer:a}:(s.dispose(!0),o.dispose(),a.detachColorTexture(),t.bindFramebuffer(null),a.dispose()),i}drawStretchedTexture(t,e,r,n,i,a){t.bindFramebuffer(r);const o=t.getViewport();t.setViewport(0,0,a.descriptor.width,a.descriptor.height);const s=e.program;t.useProgram(s),s.setUniform4f("color",1,1,1,1),s.bindTexture(i,"tex"),t.bindVAO(n),t.setPipelineState(e.pipeline),t.drawArrays(5,0,Object(g.f)(n,"geometry")),t.bindFramebuffer(null),t.setViewport(o.x,o.y,o.width,o.height)}unload(){if(Object(s.k)(this.powerOfTwoStretchInfo)){const{framebuffer:t,vao:e,sourceTexture:r}=this.powerOfTwoStretchInfo;e.dispose(!0),r.dispose(),t.dispose(),this.glTexture=null,this.powerOfTwoStretchInfo=null}if(Object(s.k)(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null),Object(s.k)(this.loadingController)){const t=this.loadingController;this.loadingController=null,this.loadingPromise=null,t.abort()}this.events.emit("unloaded")}}C.DDS_ENCODING="image/vnd-ms.dds",C.KTX2_ENCODING="image/ktx2",C.BASIS_ENCODING="image/x.basis"},643:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(98);async function i(t,e){const{data:r}=await Object(n.default)(t,{responseType:"image",...e});return r}},662:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(110);function i(t){const e=t.fragment.code;e.add(n.a`vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)
{
return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;
}`),e.add(n.a`float integratedRadiance(float cosTheta2, float roughness)
{
return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);
}`),e.add(n.a`vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)
{
float cosTheta2 = 1.0 - RdotNG * RdotNG;
float intRadTheta = integratedRadiance(cosTheta2, roughness);
float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;
float sky = 2.0 - ground;
return (ground * ambientGround + sky * ambientSky) * 0.5;
}`)}var a=r(550);function o(t,e){const r=t.fragment.code;t.include(a.a),3===e.pbrMode||4===e.pbrMode?(r.add(n.a`
    struct PBRShadingWater
    {
        float NdotL;   // cos angle between normal and light direction
        float NdotV;   // cos angle between normal and view direction
        float NdotH;   // cos angle between normal and half vector
        float VdotH;   // cos angle between view direction and half vector
        float LdotH;   // cos angle between light direction and half vector
        float VdotN;   // cos angle between view direction and normal vector
    };

    float dtrExponent = ${e.useCustomDTRExponentForWater?"2.2":"2.0"};
    `),r.add(n.a`vec3 fresnelReflection(float angle, vec3 f0, float f90) {
return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);
}`),r.add(n.a`float normalDistributionWater(float NdotH, float roughness)
{
float r2 = roughness * roughness;
float NdotH2 = NdotH * NdotH;
float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;
return r2 / denom;
}`),r.add(n.a`float geometricOcclusionKelemen(float LoH)
{
return 0.25 / (LoH * LoH);
}`),r.add(n.a`vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)
{
vec3  F = fresnelReflection(props.VdotH, F0, F0Max);
float dSun = normalDistributionWater(props.NdotH, roughness);
float V = geometricOcclusionKelemen(props.LdotH);
float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);
float strengthSunHaze  = 1.2;
float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;
return ((dSun + dSunHaze) * V) * F;
}
vec3 tonemapACES(const vec3 x) {
return (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);
}`)):1!==e.pbrMode&&2!==e.pbrMode||(t.include(i),r.add(n.a`struct PBRShadingInfo
{
float NdotL;
float NdotV;
float NdotH;
float VdotH;
float LdotH;
float NdotNG;
float RdotNG;
float NdotAmbDir;
float NdotH_Horizon;
vec3 skyRadianceToSurface;
vec3 groundRadianceToSurface;
vec3 skyIrradianceToSurface;
vec3 groundIrradianceToSurface;
float averageAmbientRadiance;
float ssao;
vec3 albedoLinear;
vec3 f0;
vec3 f90;
vec3 diffuseColor;
float metalness;
float roughness;
};`),r.add(n.a`float normalDistribution(float NdotH, float roughness)
{
float a = NdotH * roughness;
float b = roughness / (1.0 - NdotH * NdotH + a * a);
return b * b * INV_PI;
}`),r.add(n.a`const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);
const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);
const vec2 c2 = vec2(-1.04, 1.04);
vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {
vec4 r = roughness * c0 + c1;
float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;
return c2 * a004 + r.zw;
}`),r.add(n.a`vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {
vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);
vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);
vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;
vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);
vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;
vec3 specularComponent = specularColor * indirectSpecular;
return (diffuseComponent + specularComponent);
}`),r.add(n.a`float gamutMapChanel(float x, vec2 p){
return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );
}`),r.add(n.a`vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){
vec3 outColor;
vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));
outColor.x = gamutMapChanel(inColor.x, p) ;
outColor.y = gamutMapChanel(inColor.y, p) ;
outColor.z = gamutMapChanel(inColor.z, p) ;
return outColor;
}`))}},672:function(t,e,r){"use strict";var n=r(83),i=r(371);class a extends i.a{constructor(t){super(t),this._textureIDs=new Set,this._textureRepository=t.textureRep,this._textureId=t.textureId,this._initTransparent=!!t.initTextureTransparent,this._texture=this._acquire(this._textureId),this._textureNormal=this._acquire(t.normalTextureId),this._textureEmissive=this._acquire(t.emissiveTextureId),this._textureOcclusion=this._acquire(t.occlusionTextureId),this._textureMetallicRoughness=this._acquire(t.metallicRoughnessTextureId)}dispose(){this._textureIDs.forEach((t=>this._textureRepository.release(t))),this._textureIDs.clear()}updateTexture(t){t!==this._textureId&&(this._release(this._textureId),this._textureId=t,this._texture=this._acquire(this._textureId))}bindTextures(t){Object(n.k)(this._texture)&&t.bindTexture(this._texture.glTexture,"tex"),Object(n.k)(this._textureNormal)&&t.bindTexture(this._textureNormal.glTexture,"normalTexture"),Object(n.k)(this._textureEmissive)&&t.bindTexture(this._textureEmissive.glTexture,"texEmission"),Object(n.k)(this._textureOcclusion)&&t.bindTexture(this._textureOcclusion.glTexture,"texOcclusion"),Object(n.k)(this._textureMetallicRoughness)&&t.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")}bindTextureScale(t){const e=Object(n.k)(this._texture)&&this._texture.glTexture;e&&e.descriptor.textureCoordinateScaleFactor?t.setUniform2fv("textureCoordinateScaleFactor",e.descriptor.textureCoordinateScaleFactor):t.setUniform2f("textureCoordinateScaleFactor",1,1)}_acquire(t){if(!Object(n.j)(t))return this._textureIDs.add(t),this._textureRepository.acquire(t,this._initTransparent)}_release(t){Object(n.j)(t)||(this._textureIDs.delete(t),this._textureRepository.release(t))}}e.a=a},687:function(t,e,r){"use strict";r.d(e,"a",(function(){return p})),r.d(e,"b",(function(){return x})),r.d(e,"c",(function(){return v}));var n=r(83),i=r(276),a=r(281),o=r(140),s=r(150),c=r(494),u=r(357),l=r(101),f=r(454),h=r(99),d=r(181),m=r(370);class p{constructor(){this._transform=Object(s.d)(),this._transformInverse=new g({value:this._transform},o.a,s.d),this._transformInverseTranspose=new g(this._transformInverse,o.e,s.d),this._transformTranspose=new g({value:this._transform},o.e,s.d),this._transformInverseRotation=new g({value:this._transform},i.j,a.b)}invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(t){Object(o.d)(this._transform,t)}multiplyTransform(t){Object(o.m)(this._transform,this._transform,t)}set(t){Object(o.d)(this._transform,t),this.invalidateLazyTransforms()}setAndInvalidateLazyTransforms(t,e){this.setTransformMatrix(t),this.multiplyTransform(e),this.invalidateLazyTransforms()}}class g{constructor(t,e,r){this.original=t,this.update=e,this.dirty=!0,this.transform=r()}invalidate(){this.dirty=!0}get value(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}const b=new class{constructor(t=0){this.offset=t,this.sphere=Object(m.b)(),this.tmpVertex=Object(h.e)()}applyToVertex(t,e,r){const n=this.objectTransform.transform;let i=n[0]*t+n[4]*e+n[8]*r+n[12],a=n[1]*t+n[5]*e+n[9]*r+n[13],o=n[2]*t+n[6]*e+n[10]*r+n[14];const s=this.offset/Math.sqrt(i*i+a*a+o*o);i+=i*s,a+=a*s,o+=o*s;const c=this.objectTransform.inverse;return this.tmpVertex[0]=c[0]*i+c[4]*a+c[8]*o+c[12],this.tmpVertex[1]=c[1]*i+c[5]*a+c[9]*o+c[13],this.tmpVertex[2]=c[2]*i+c[6]*a+c[10]*o+c[14],this.tmpVertex}applyToMinMax(t,e){const r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r;const n=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*n,e[1]+=e[1]*n,e[2]+=e[2]*n}applyToAabb(t){const e=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*e,t[1]+=t[1]*e,t[2]+=t[2]*e;const r=this.offset/Math.sqrt(t[3]*t[3]+t[4]*t[4]+t[5]*t[5]);return t[3]+=t[3]*r,t[4]+=t[4]*r,t[5]+=t[5]*r,t}applyToBoundingSphere(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=this.offset/e;return this.sphere[0]=t[0]+t[0]*r,this.sphere[1]=t[1]+t[1]*r,this.sphere[2]=t[2]+t[2]*r,this.sphere[3]=t[3]+t[3]*this.offset/e,this.sphere}};function v(t){return Object(n.k)(t)?(b.offset=t,b):null}new class{constructor(t=0){this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(h.e)(),this.mbs=Object(d.e)(),this.obb={center:Object(h.e)(),halfSize:Object(f.b)(),quaternion:null}}set localOrigin(t){this.componentLocalOriginLength=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}applyToVertex(t,e,r){const n=t,i=e,a=r+this.componentLocalOriginLength,o=this.offset/Math.sqrt(n*n+i*i+a*a);return this.tmpVertex[0]=t+n*o,this.tmpVertex[1]=e+i*o,this.tmpVertex[2]=r+a*o,this.tmpVertex}applyToAabb(t){const e=t[0],r=t[1],n=t[2]+this.componentLocalOriginLength,i=t[3],a=t[4],o=t[5]+this.componentLocalOriginLength,s=this.offset/Math.sqrt(e*e+r*r+n*n);t[0]+=e*s,t[1]+=r*s,t[2]+=n*s;const c=this.offset/Math.sqrt(i*i+a*a+o*o);return t[3]+=i*c,t[4]+=a*c,t[5]+=o*c,t}applyToMbs(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]),r=this.offset/e;return this.mbs[0]=t[0]+t[0]*r,this.mbs[1]=t[1]+t[1]*r,this.mbs[2]=t[2]+t[2]*r,this.mbs[3]=t[3]+t[3]*this.offset/e,this.mbs}applyToObb(t){const e=t.center,r=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);this.obb.center[0]=e[0]+e[0]*r,this.obb.center[1]=e[1]+e[1]*r,this.obb.center[2]=e[2]+e[2]*r,Object(l.u)(this.obb.halfSize,t.halfSize,t.quaternion),Object(l.f)(this.obb.halfSize,this.obb.halfSize,t.center);const n=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*n,this.obb.halfSize[1]+=this.obb.halfSize[1]*n,this.obb.halfSize[2]+=this.obb.halfSize[2]*n,Object(l.j)(this.obb.halfSize,this.obb.halfSize,t.center),Object(c.a)(_,t.quaternion),Object(l.u)(this.obb.halfSize,this.obb.halfSize,_),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=t.quaternion,this.obb}};new class{constructor(t=0){this.offset=t,this.tmpVertex=Object(h.e)()}applyToVertex(t,e,r){const n=t+this.localOrigin[0],i=e+this.localOrigin[1],a=r+this.localOrigin[2],o=this.offset/Math.sqrt(n*n+i*i+a*a);return this.tmpVertex[0]=t+n*o,this.tmpVertex[1]=e+i*o,this.tmpVertex[2]=r+a*o,this.tmpVertex}applyToAabb(t){const e=t[0]+this.localOrigin[0],r=t[1]+this.localOrigin[1],n=t[2]+this.localOrigin[2],i=t[3]+this.localOrigin[0],a=t[4]+this.localOrigin[1],o=t[5]+this.localOrigin[2],s=this.offset/Math.sqrt(e*e+r*r+n*n);t[0]+=e*s,t[1]+=r*s,t[2]+=n*s;const c=this.offset/Math.sqrt(i*i+a*a+o*o);return t[3]+=i*c,t[4]+=a*c,t[5]+=o*c,t}};const x="terrain",_=Object(u.b)()}}]);
//# sourceMappingURL=95.d5e6043c.chunk.js.map