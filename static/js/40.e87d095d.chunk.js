(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[40,244,306],{1138:function(t,e,n){"use strict";n.d(e,"a",(function(){return I})),n.d(e,"b",(function(){return V}));var r=n(79),i=n(122),a=(n(82),n(129)),s=n(131),o=n(162),c=n(85),l=n(81),u=n(84),h=(n(83),n(80)),d=n(491),p=(n(97),n(89)),b=n(114),m=n(943),f=n(574),g=n(246),y=n(110),_=n(777),O=n(189),v=n(109),j=n(134),x=n(125);function E(t,e){const n=new v.a({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(n.z=t[2]),n}function T(t,e,n){const r=new j.a({paths:t,spatialReference:e});return n&&Object(g.i)(r),r}function w(t,e,n,r=!0){const i=Object(p.a)(t);i.forEach((t=>{const e=t[0],n=t[t.length-1];Object(u.c)(e,n)&&1!==t.length||t.push(t[0])}));let a=new x.a({rings:i,spatialReference:e});return a.rings.forEach((t=>{Object(g.g)(t,!1,!1)||t.reverse()})),n&&Object(g.i)(a),r&&a.isSelfIntersecting&&Object(y.l)(e)&&(a=Object(f.simplify)(a)),a}function S(t,e,n){const r=e.mapToLocalMultiple(t),i=[],a={x:r[0].x,y:r[0].y},s=r[1].x,o=r[1].y,l=Math.round(s-a.x),u=Math.round(o-a.y),h=Math.max(Math.abs(l),Math.abs(u));if(n){const t={x:a.x+h,y:a.y+h},e={x:a.x-h,y:a.y-h};i.push(Object(_.b)(t.x,e.y),Object(_.b)(e.x,e.y),Object(_.b)(e.x,t.y),Object(_.b)(t.x,t.y))}else{const t={x:l>0?a.x+h:a.x-h,y:u>0?a.y+h:a.y-h};i.push(Object(_.b)(a.x,a.y),Object(_.b)(t.x,a.y),Object(_.b)(t.x,t.y),Object(_.b)(a.x,t.y))}return w([Object(c.h)(i.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!0)}function M(t,e,n,r){const i=e.mapToLocalMultiple(t);let a=null,s=null;if(n)a=i[0],s=i[1];else{const t=i[0],e=i[1],n=Math.round(e.x-t.x),r=Math.round(e.y-t.y),o=Math.max(Math.abs(n),Math.abs(r));a=Object(_.b)(n>0?t.x+o/2:t.x-o/2,r>0?t.y+o/2:t.y-o/2),s=Object(_.b)(Math.abs(n)>Math.abs(r)?a.x-o/2:a.x,Math.abs(n)>Math.abs(r)?a.y:a.y-o/2)}const o=e.localToMap(a),l=e.localToMap(s);if(Object(c.k)(o)||Object(c.k)(l))return null;e.doUnnormalization&&Object(g.j)([[o,l]],e.spatialReference);const u=E(o,e.spatialReference),h=E(l,e.spatialReference),d=Object(b.e)(e.spatialReference);let p=0;if(Object(y.l)(e.spatialReference))p=d*Object(f.distance)(u,h,null);else{const t=a.x-s.x,e=a.y-s.y;p=d*Math.sqrt(t*t+e*e)*(r||1)}const O=new m.a({center:u,radius:p,radiusUnit:"meters",spatialReference:e.spatialReference});return w(O.rings,O.spatialReference,!1)}var R=n(621);let I=class extends(Object(s.b)(a.a.EventedMixin(R.a))){constructor(t){super(t),this._graphic=null,this.defaultZ=0,this.geometryType=null,this.hasZ=!0,this.mode=null,this.snappingManager=null,this.snapToScene=!1}initialize(){this.internalGraphicsLayer=new d.a({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",(t=>this.onVertexAdd(t))),this.drawOperation.on("vertex-remove",(t=>this.onVertexRemove(t))),this.drawOperation.on("vertex-update",(t=>this.onVertexUpdate(t))),this.drawOperation.on("cursor-update",(t=>this.onCursorUpdate(t))),this.drawOperation.on("complete",(t=>this.onComplete(t)))]),this.complete()}destroy(){this.drawOperation=Object(c.e)(this.drawOperation),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=Object(c.e)(this.internalGraphicsLayer),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),Object(c.l)(this._graphic)&&(this._graphic.symbol=t)}get updating(){var t,e;return null!=(t=null==(e=this.drawOperation)?void 0:e.updating)&&t}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}_createGraphic(t){this._graphic=new i.a({geometry:t,symbol:this.graphicSymbol}),this.internalGraphicsLayer.add(this._graphic),this.handles.add(this.initializeGraphic(this._graphic)),this.notifyChange("graphic"),this.handles.add(Object(o.c)((()=>{Object(c.l)(this._graphic)&&(this.internalGraphicsLayer.remove(this._graphic),this._graphic=Object(c.e)(this._graphic))})),A)}_destroyAllVisualisations(){this.handles.remove(k.outline),this.handles.remove(k.regularVertices),this.handles.remove(k.activeVertex),this.handles.remove(A)}_getCreateOperationGeometry(t={operationComplete:!1}){if(null==this.drawOperation||0===this.drawOperation.numVertices)return null;const e=this.drawOperation.stagedVertex,n=this.drawOperation.committedVertices,r=n.slice();Object(c.l)(e)&&r.push(this.drawOperation.coordinateHelper.pointToArray(e));const i=Object(c.l)(e)?this.drawOperation.coordinateHelper.pointToArray(e):n.splice(-1)[0],a={regularVertices:null,activeVertex:null,full:null,outline:null},s=r.length,o=this.drawOperation.spatialReference,l="3d"===this.view.type&&"global"===this.view.viewingMode;switch(this.geometryType){case"point":a.regularVertices=n,a.activeVertex=i,a.full=this.drawOperation.coordinateHelper.arrayToPoint(r[0]);break;case"multipoint":a.regularVertices=n,a.activeVertex=i,s>0&&(a.full=function(t,e){return new O.a({points:t,spatialReference:e})}(r,o));break;case"polyline":a.regularVertices=n,a.activeVertex=i,s>0&&(a.full=T([r],o,l));break;case"polygon":a.regularVertices=n,a.activeVertex=i,s>0&&(a.full=w([r],o,l,!0));break;case"circle":if(s>0){const e=Object(_.a)(this.view,r[0]);if(1===s&&t.operationComplete){const t=r[0],n=e.makeMapPoint(t[0]+G*this.view.resolution,t[1]);a.full=M([t,n],e,!0)}else 2===s&&(a.full=this.forceUniformSize?M(r,e,this.centered):function(t,e,n){const r=e.mapToLocalMultiple(t),i=r[0],a=r[1],s=Math.round(a.x-i.x),o=Math.round(a.y-i.y),l=Object(_.b)(n?i.x:i.x+s/2,n?i.y:i.y+o/2),u=n?s:s/2,h=n?o:o/2,d=[],p=2*Math.PI/60;for(let c=0;c<60;c++){const t=Math.cos(c*p),e=Math.sin(c*p),n=Object(_.b)(u*t+l.x,h*e+l.y);d.push(n)}return d.push(d[0]),w([Object(c.h)(d.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!1)}(r,e,this.centered))}break;case"rectangle":if(s>0){const e=Object(_.a)(this.view,r[0]);if(1===s&&t.operationComplete){const t=r[0],n=e.makeMapPoint(t[0]+G*this.view.resolution,t[1]);a.full=S([t,n],e,!0)}else 2===s&&(a.full=this.forceUniformSize?S(r,e,this.centered):function(t,e,n){let r=e.mapToLocalMultiple(t);if(1===r.length){const t=48,e=r[0];r=[Object(_.b)(e.x-t,e.y+t),Object(_.b)(e.x+t,e.y-t),Object(_.b)(e.x+t,e.y-t),Object(_.b)(e.x-t,e.y+t)]}const i=[],a={x:r[0].x,y:r[0].y},s={x:r[1].x,y:r[1].y};if(n){const t=Math.round(s.x-a.x),e=Math.round(s.y-a.y);i.push(Object(_.b)(a.x-t,a.y-e),Object(_.b)(s.x,a.y-e),Object(_.b)(s.x,s.y),Object(_.b)(a.x-t,s.y))}else i.push(Object(_.b)(a.x,a.y),Object(_.b)(s.x,a.y),Object(_.b)(s.x,s.y),Object(_.b)(a.x,s.y));return w([Object(c.h)(i.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!0)}(r,e,this.centered))}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":case"polygon":s>1&&(a.outline=T([r],o,l));break;case"circle":case"rectangle":Object(c.l)(a.full)&&"polygon"===a.full.type&&(a.outline=w(a.full.rings,o,l))}return a}initializeGraphic(t){return null}onComplete(t){this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){const t=this._getCreateOperationGeometry({operationComplete:!0});Object(c.l)(t)&&(e=new i.a({geometry:t.full,symbol:this.graphicSymbol,sourceLayer:this.internalGraphicsLayer,...this.graphicProperties}))}this.emit("complete",{graphic:e,...t})}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}onVertexAdd(t){this._updateGraphic(),this.emit("vertex-add",t)}onVertexRemove(t){this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){const t=this._getCreateOperationGeometry();Object(c.k)(t)?this._destroyAllVisualisations():(Object(c.l)(t.outline)?this.handles.add(this.onOutlineChanged(t.outline),k.outline):this.handles.remove(k.outline),Object(c.l)(t.regularVertices)?this.handles.add(this.onRegularVerticesChanged(t.regularVertices),k.regularVertices):this.handles.remove(k.regularVertices),Object(c.l)(t.activeVertex)?this.handles.add(this.onActiveVertexChanged(t.activeVertex),k.activeVertex):this.handles.remove(k.activeVertex),Object(c.l)(t.full)?Object(c.k)(this._graphic)?this._createGraphic(t.full):this._graphic.geometry=t.full:this.handles.remove(A))}};Object(r.a)([Object(l.b)({value:!0})],I.prototype,"centered",null),Object(r.a)([Object(l.b)({nonNullable:!0})],I.prototype,"defaultZ",void 0),Object(r.a)([Object(l.b)()],I.prototype,"drawOperation",void 0),Object(r.a)([Object(l.b)({value:!0})],I.prototype,"enabled",null),Object(r.a)([Object(l.b)({value:!0})],I.prototype,"forceUniformSize",null),Object(r.a)([Object(l.b)({constructOnly:!0})],I.prototype,"geometryType",void 0),Object(r.a)([Object(l.b)()],I.prototype,"graphic",null),Object(r.a)([Object(l.b)({constructOnly:!0})],I.prototype,"graphicProperties",void 0),Object(r.a)([Object(l.b)()],I.prototype,"graphicSymbol",null),Object(r.a)([Object(l.b)({constructOnly:!0})],I.prototype,"hasZ",void 0),Object(r.a)([Object(l.b)({constructOnly:!0})],I.prototype,"mode",void 0),Object(r.a)([Object(l.b)()],I.prototype,"snappingManager",void 0),Object(r.a)([Object(l.b)()],I.prototype,"snapToScene",void 0),Object(r.a)([Object(l.b)({readOnly:!0})],I.prototype,"type",void 0),Object(r.a)([Object(l.b)({readOnly:!0})],I.prototype,"updating",null),Object(r.a)([Object(l.b)({constructOnly:!0,nonNullable:!0})],I.prototype,"view",void 0),I=Object(r.a)([Object(h.a)("esri.views.draw.DrawGraphicTool")],I);const A="create-operation-graphic",k={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function V(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";default:return null}}const G=48},1389:function(t,e,n){"use strict";n.r(e),n.d(e,"DrawGraphicTool2D",(function(){return O}));var r=n(79),i=(n(97),n(122)),a=n(162),s=n(85),o=n(81),c=(n(84),n(82),n(83),n(80)),l=n(903),u=(n(111),n(428)),h=n(242);const d=new u.a({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}}),p=new h.a({style:"circle",size:6,color:[127,127,127,1],outline:{color:[50,50,50],width:1}}),b=new h.a({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});var m=n(1138),f=n(872),g=n(856),y=n(109),_=n(189);let O=class extends m.a{constructor(t){super(t),this._visualElementGraphics={outline:null,regularVertices:null,activeVertex:null},this.activeFillSymbol=null,this.type="draw-2d",this._visualElementSymbols={outline:Object(s.u)(t.activeLineSymbol,d),regularVertices:Object(s.u)(t.regularVerticesSymbol,p),activeVertex:Object(s.u)(t.activeVertexSymbol,b),fill:Object(s.t)(t.activeFillSymbol)}}initializeGraphic(t){return Object(s.l)(this._visualElementSymbols.fill)&&(t.symbol=this._visualElementSymbols.fill),null}makeDrawOperation(){const t=this.view;return new f.a({view:t,manipulators:this.manipulators,geometryType:Object(m.b)(this.geometryType),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new g.b(t),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new l.a(this.internalGraphicsLayer)})}onActiveVertexChanged(t){if("point"===this.geometryType)return null;const[e,n]=t,r=new y.a({x:e,y:n,spatialReference:this.drawOperation.spatialReference});return Object(s.l)(this._visualElementGraphics.activeVertex)?(this._visualElementGraphics.activeVertex.geometry=r,null):(this._visualElementGraphics.activeVertex=new i.a({geometry:r,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(v),Object(a.c)((()=>{Object(s.l)(this._visualElementGraphics.activeVertex)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex),this._visualElementGraphics.activeVertex=Object(s.e)(this._visualElementGraphics.activeVertex))})))}onOutlineChanged(t){const e=t.clone();if("polyline"===e.type){const t=e.paths[e.paths.length-1];t.splice(0,t.length-2)}return Object(s.l)(this._visualElementGraphics.outline)?(this._visualElementGraphics.outline.geometry=e,null):(this._visualElementGraphics.outline=new i.a({geometry:e,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.outline),this.internalGraphicsLayer.graphics.sort(v),Object(a.c)((()=>{Object(s.l)(this._visualElementGraphics.outline)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.outline),this._visualElementGraphics.outline=Object(s.e)(this._visualElementGraphics.outline))})))}onRegularVerticesChanged(t){const e=new _.a({points:t,spatialReference:this.drawOperation.spatialReference});return Object(s.l)(this._visualElementGraphics.regularVertices)?(this._visualElementGraphics.regularVertices.geometry=e,null):(this._visualElementGraphics.regularVertices=new i.a({geometry:e,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(v),Object(a.c)((()=>{Object(s.l)(this._visualElementGraphics.regularVertices)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices),this._visualElementGraphics.regularVertices=Object(s.e)(this._visualElementGraphics.regularVertices))})))}};function v(t,e){var n,r,i,a;return(null!=(n=null==(r=t.attributes)?void 0:r.displayOrder)?n:-1/0)-(null!=(i=null==(a=e.attributes)?void 0:a.displayOrder)?i:-1/0)}Object(r.a)([Object(o.b)()],O.prototype,"activeFillSymbol",void 0),Object(r.a)([Object(o.b)({readOnly:!0})],O.prototype,"type",void 0),Object(r.a)([Object(o.b)({constructOnly:!0,nonNullable:!0})],O.prototype,"view",void 0),O=Object(r.a)([Object(c.a)("esri.views.2d.interactive.draw.DrawGraphicTool2D")],O)},345:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return o})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return l}));var r=n(176);function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function a(t,e){const n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5];let c=n*a-r*i;return c?(c=1/c,t[0]=a*c,t[1]=-r*c,t[2]=-i*c,t[3]=n*c,t[4]=(i*o-a*s)*c,t[5]=(r*s-n*o)*c,t):null}function s(t,e,n){const r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=n[0],u=n[1],h=n[2],d=n[3],p=n[4],b=n[5];return t[0]=r*l+a*u,t[1]=i*l+s*u,t[2]=r*h+a*d,t[3]=i*h+s*d,t[4]=r*p+a*b+o,t[5]=i*p+s*b+c,t}function o(t,e,n){const r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*l,t[1]=i*u+s*l,t[2]=r*-l+a*u,t[3]=i*-l+s*u,t[4]=o,t[5]=c,t}function c(t,e,n){const r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=n[0],u=n[1];return t[0]=r*l,t[1]=i*l,t[2]=a*u,t[3]=s*u,t[4]=o,t[5]=c,t}function l(t,e,n){const r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],c=e[5],l=n[0],u=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=s,t[4]=r*l+a*u+o,t[5]=i*l+s*u+c,t}function u(t,e){const n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function h(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function d(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}const p=s,b=d;Object.freeze({__proto__:null,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:i,set:function(t,e,n,r,i,a,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=s,t},invert:a,determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:s,rotate:o,scale:c,translate:l,fromRotation:u,fromScaling:h,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)},add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},subtract:d,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},multiplyScalarAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},equals:function(t,e){const n=t[0],i=t[1],a=t[2],s=t[3],o=t[4],c=t[5],l=e[0],u=e[1],h=e[2],d=e[3],p=e[4],b=e[5];return Math.abs(n-l)<=r.a*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-u)<=r.a*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-h)<=r.a*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-d)<=r.a*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-p)<=r.a*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(c-b)<=r.a*Math.max(1,Math.abs(c),Math.abs(b))},mul:p,sub:b})},350:function(t,e,n){"use strict";n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return v})),n.d(e,"e",(function(){return j})),n.d(e,"f",(function(){return x})),n.d(e,"g",(function(){return E}));var r=n(85),i=n(98);const a=(t,e,n)=>[e,n],s=(t,e,n)=>[e,n,t[2]],o=(t,e,n)=>[e,n,t[2],t[3]];function c(t){return t?{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance]:[1,1],translate:Object(r.l)(t.extent)?[t.extent.xmin,t.extent.ymax]:[0,0]}:null}function l({scale:t,translate:e},n){return Math.round((n-e[0])/t[0])}function u({scale:t,translate:e},n){return Math.round((e[1]-n)/t[1])}function h(t,e,n){const r=[];let i,a,s,o;for(let c=0;c<n.length;c++){const h=n[c];c>0?(s=l(t,h[0]),o=u(t,h[1]),s===i&&o===a||(r.push(e(h,s-i,o-a)),i=s,a=o)):(i=l(t,h[0]),a=u(t,h[1]),r.push(e(h,i,a)))}return r.length>0?r:null}function d({scale:t,translate:e},n){return n*t[0]+e[0]}function p({scale:t,translate:e},n){return e[1]-n*t[1]}function b(t,e,n){const r=new Array(n.length);if(!n.length)return r;const[i,a]=t.scale;let s=d(t,n[0][0]),o=p(t,n[0][1]);r[0]=e(n[0],s,o);for(let c=1;c<n.length;c++){const t=n[c];s+=t[0]*i,o-=t[1]*a,r[c]=e(t,s,o)}return r}function m(t,e,n){const r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=b(t,e,n[i]);return r}function f(t,e,n,r,i){return e.points=function(t,e,n,r){return h(t,n?r?o:s:r?s:a,e)}(t,n.points,r,i),e}function g(t,e,n,r,i){return e.x=l(t,n.x),e.y=u(t,n.y),e!==n&&(r&&(e.z=n.z),i&&(e.m=n.m)),e}function y(t,e,n,r,i){const c=function(t,e,n,r){const i=[],c=n?r?o:s:r?s:a;for(let a=0;a<e.length;a++){const n=h(t,c,e[a]);n&&n.length>=3&&i.push(n)}return i.length?i:null}(t,n.rings,r,i);return c?(e.rings=c,e):null}function _(t,e,n,r,i){const c=function(t,e,n,r){const i=[],c=n?r?o:s:r?s:a;for(let a=0;a<e.length;a++){const n=h(t,c,e[a]);n&&n.length>=2&&i.push(n)}return i.length?i:null}(t,n.paths,r,i);return c?(e.paths=c,e):null}function O(t,e){return t&&e?Object(i.f)(e)?g(t,{},e,!1,!1):Object(i.h)(e)?_(t,{},e,!1,!1):Object(i.g)(e)?y(t,{},e,!1,!1):Object(i.e)(e)?f(t,{},e,!1,!1):Object(i.d)(e)?function(t,e,n,r,i){return e.xmin=l(t,n.xmin),e.ymin=u(t,n.ymin),e.xmax=l(t,n.xmax),e.ymax=u(t,n.ymax),e!==n&&(r&&(e.zmin=n.zmin,e.zmax=n.zmax),i&&(e.mmin=n.mmin,e.mmax=n.mmax)),e}(t,{},e,!1,!1):null:null}function v(t,e,n,i,c){return Object(r.l)(n)&&(e.points=function(t,e,n,r){return b(t,n?r?o:s:r?s:a,e)}(t,n.points,i,c)),e}function j(t,e,n,i,a){return Object(r.k)(n)||(e.x=d(t,n.x),e.y=p(t,n.y),e!==n&&(i&&(e.z=n.z),a&&(e.m=n.m))),e}function x(t,e,n,i,c){return Object(r.l)(n)&&(e.rings=function(t,e,n,r){return m(t,n?r?o:s:r?s:a,e)}(t,n.rings,i,c)),e}function E(t,e,n,i,c){return Object(r.l)(n)&&(e.paths=function(t,e,n,r){return m(t,n?r?o:s:r?s:a,e)}(t,n.paths,i,c)),e}},416:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"f",(function(){return o})),n.d(e,"g",(function(){return l})),n.d(e,"h",(function(){return u}));n(598),n(82);var r=n(85),i=(n(554),n(251),n(94),n(223)),a=n(118);n(350),n(171),n(153),n(437);class s{constructor(t,e,n){this.uid=t,this.geometry=e,this.attributes=n,this.visible=!0,this.objectId=null,this.centroid=null}}function o(t){return Object(r.l)(t.geometry)}class c{constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}}function l(t,e,n,r){return{x:t,y:e,z:n,hasZ:null!=n,hasM:!1,spatialReference:r,type:"point"}}function u(t){if(Object(r.k)(t))return 0;switch(t.type){case"point":return 1;case"polyline":{let e=0;for(const n of t.paths)e+=n.length;return e}case"polygon":{let e=0;for(const n of t.rings)e+=n.length;return e}case"multipoint":return t.points.length;case"extent":return 2;case"mesh":{const e=t.vertexAttributes&&t.vertexAttributes.position;return e?e.length/3:0}default:return}}function h(t,e){switch(Object(i.h)(e),"mesh"===t.type&&(t=t.extent),t.type){case"point":e[0]=e[3]=t.x,e[1]=e[4]=t.y,t.hasZ&&(e[2]=e[5]=t.z);break;case"polyline":for(let n=0;n<t.paths.length;n++)Object(i.l)(e,t.paths[n],t.hasZ);break;case"polygon":for(let n=0;n<t.rings.length;n++)Object(i.l)(e,t.rings[n],t.hasZ);break;case"multipoint":Object(i.l)(e,t.points,t.hasZ);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[3]=t.xmax,e[4]=t.ymax,null!=t.zmin&&(e[2]=t.zmin),null!=t.zmax&&(e[5]=t.zmax)}}function d(t,e){switch(Object(a.m)(e),"mesh"===t.type&&(t=t.extent),t.type){case"point":e[0]=e[2]=t.x,e[1]=e[3]=t.y;break;case"polyline":for(let n=0;n<t.paths.length;n++)Object(a.p)(e,t.paths[n]);break;case"polygon":for(let n=0;n<t.rings.length;n++)Object(a.p)(e,t.rings[n]);break;case"multipoint":Object(a.p)(e,t.points);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax}}function p(t,e){return null!=t.objectId?t.objectId:t.attributes&&e?t.attributes[e]:null}Object(i.f)(),Object(a.l)()},437:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n(82),n(85);function r(t,e){return!!i(t.spatialReference,e.spatialReference)&&t.x===e.x&&t.y===e.y&&t.z===e.z&&t.m===e.m}function i(t,e){return t===e||t&&e&&t.equals(e)}},439:function(t,e,n){"use strict";n.d(e,"a",(function(){return j})),n.d(e,"b",(function(){return _})),n.d(e,"c",(function(){return O})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return u})),n.d(e,"f",(function(){return v})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return m})),n.d(e,"i",(function(){return g})),n.d(e,"j",(function(){return y})),n.d(e,"k",(function(){return f})),n.d(e,"l",(function(){return b}));n(162);var r=n(89),i=n(113),a=n(85),s=n(101),o=n(106),c=n(207),l=n(600);function u(t,e){return t.events.on("drag",function(t,e){let n=null,r=null;return i=>{if("cancel"===i.action)return void(Object(a.l)(r)&&(r.execute({action:"cancel"}),n=null,r=null));const s={action:i.action,screenStart:i.start,screenEnd:i.screenPoint};"start"===i.action&&Object(a.k)(n)&&(n=new j,r=new j,e(t,n,r,i.pointerType,s)),Object(a.l)(n)&&n.execute(s),"end"===i.action&&Object(a.l)(n)&&(n=null,r=null)}}(t,e))}function h(t,e){const n=[t.x,t.y,t.z],r=e,i=[Math.cos(r),Math.sin(r)],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]);if(0===a)return null;i[0]/=a,i[1]/=a;const s=t=>{const e=(t.x-n[0])*i[0]+(t.y-n[1])*i[1];t.x=n[0]+e*i[0],t.y=n[1]+e*i[1]};return t=>(s(t.mapStart),s(t.mapEnd),t)}function d(t,e){let n=null;return r=>{if("start"===r.action&&(n=function(t,e,n){const r=t.geometry;if(Object(a.k)(r))return null;if("mesh"===r.type)return function(t,e,n,r){if(Object(a.l)(e.transform))return function(t,e,n,r){const i=p(n.getOriginPoint(e.spatialReference),r),s=e.spatialReference;return Object(a.k)(i)?null:{move:(e,r,u)=>{const h=Object(l.d)(i.clone(),e,r,u);if(h.spatialReference.equals(s))n.origin=Object(o.h)(h.x,h.y,h.z);else{const t=Object(c.j)(h,s);Object(a.l)(t)&&(n.origin=Object(o.h)(t.x,t.y,t.z))}t.notifyGeometryChanged()}}}(t,e,e.transform,n);if(!e.spatialReference.equals(n))return null;let i=0,s=0,u=0;return{move:(n,a,o)=>{const c=n-i,l=a-s,h=o-u;if(c||l||h){const d=e.origin.clone().offset(c,l,h);e.centerAt(d,{geographic:1===r}),t.notifyGeometryChanged(),i=n,s=a,u=o}}}}(t,r,e,n);const i=p(r,e),s=r.spatialReference;return Object(a.k)(i)?null:{move:(e,n,r)=>{const a=Object(l.d)(i.clone(),e,n,r);a.spatialReference.equals(s)?t.geometry=a:t.geometry=Object(c.j)(a,s)}}}(t,r.mapStart.spatialReference,e)),Object(a.k)(n))return null;const i=r.mapEnd.x-r.mapStart.x,s=r.mapEnd.y-r.mapStart.y,u=r.mapEnd.z-r.mapStart.z;return n.move(i,s,u),{...r,translationX:i,translationY:s,translationZ:u}}}function p(t,e){return Object(a.k)(t)?null:t.spatialReference.equals(e)?t.clone():Object(c.j)(t,e)}function b(t,e=null,n){let r=null;const i=Object(a.l)(e)&&!t.spatialReference.equals(e)?t=>Object(a.l)(t)?Object(c.j)(t,e):t:t=>t,s={exclude:[],...n};return e=>{if("start"===e.action&&(r=i(t.toMap(e.screenStart,s))),Object(a.k)(r))return null;const n=i(t.toMap(e.screenEnd,s));return Object(a.l)(n)?{...e,mapStart:r,mapEnd:n}:null}}function m(t,e){const n=t.map((t=>Object(a.t)(d(t,e)))).filter((t=>Object(a.l)(t)));return t=>{const e=t.mapEnd.x-t.mapStart.x,r=t.mapEnd.y-t.mapStart.y,i=t.mapEnd.z-t.mapStart.z;return n.forEach((e=>e(t))),{...t,translationX:e,translationY:r,translationZ:i}}}function f(t,e){const n=new Map;for(const i of e)n.set(i,Object(r.a)(t[i]));return e=>(n.forEach(((e,n)=>{t[n]=e})),e)}function g(t){return Object(a.l)(t.geometry)&&"mesh"===t.geometry.type?function(t,e){const n=Object(a.l)(e.transform)?e.transform.clone():null,r=e.vertexAttributes.clonePositional();return i=>(e.transform=n,e.vertexAttributes=r,t.notifyGeometryChanged(),i)}(t,t.geometry):f(t,["geometry"])}function y(t){const e=t.map((t=>Object(a.t)(g(t)))).filter((t=>Object(a.l)(t)));return t=>(e.forEach((e=>e(t))),t)}function _(){let t=0,e=0,n=0;return r=>{"start"===r.action&&(t=r.mapStart.x,e=r.mapStart.y,n=r.mapStart.z);const i=r.mapEnd.x-t,a=r.mapEnd.y-e,s=r.mapEnd.z-n;return t=r.mapEnd.x,e=r.mapEnd.y,n=r.mapEnd.z,{...r,mapDeltaX:i,mapDeltaY:a,mapDeltaZ:s,mapDeltaSpatialReference:r.mapStart.spatialReference}}}function O(){let t=0,e=0;return n=>{"start"===n.action&&(t=n.screenStart.x,e=n.screenStart.y);const r=n.screenEnd.x-t,i=n.screenEnd.y-e;return t=n.screenEnd.x,e=n.screenEnd.y,{...n,screenDeltaX:r,screenDeltaY:i}}}function v(t,e){let n=null,r=0,a=0;return o=>{if("start"===o.action&&(n=t.toScreen(e),n.x<0||n.x>t.width||n.y<0||n.y>t.height?n=null:(r=o.screenStart.x-n.x,a=o.screenStart.y-n.y)),null==n)return null;const c=Object(i.e)(o.screenEnd.x-r,0,t.width),l=Object(i.e)(o.screenEnd.y-a,0,t.height),u=Object(s.e)(c,l);return o.screenStart=n,o.screenEnd=u,o}}class j{constructor(){this.execute=()=>{}}next(t,e=new j){return Object(a.l)(t)&&(this.execute=n=>{const r=t(n);Object(a.l)(r)&&e.execute(r)}),e}}},461:function(t,e,n){"use strict";n.r(e),n.d(e,"hydratedAdapter",(function(){return c}));var r=n(96),i=n(189),a=n(109),s=n(125),o=n(134);const c={convertToGEGeometry:function(t,e){if(null==e)return null;let n="cache"in e?e.cache._geVersion:void 0;return null==n&&(n=t.convertJSONToGeometry(e),"cache"in e&&(e.cache._geVersion=n)),n},exportPoint:function(t,e,n){const r=t.hasZ(e),i=t.hasM(e),s=new a.a({x:t.getPointX(e),y:t.getPointY(e),spatialReference:n});return r&&(s.z=t.getPointZ(e)),i&&(s.m=t.getPointM(e)),s.cache._geVersion=e,s},exportPolygon:function(t,e,n){const r=new s.a({rings:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:n});return r.cache._geVersion=e,r},exportPolyline:function(t,e,n){const r=new o.a({paths:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:n});return r.cache._geVersion=e,r},exportMultipoint:function(t,e,n){const r=new i.a({hasZ:t.hasZ(e),hasM:t.hasM(e),points:t.exportPoints(e),spatialReference:n});return r.cache._geVersion=e,r},exportExtent:function(t,e,n){const i=t.hasZ(e),a=t.hasM(e),s=new r.a({xmin:t.getXMin(e),ymin:t.getYMin(e),xmax:t.getXMax(e),ymax:t.getYMax(e),spatialReference:n});if(i){const n=t.getZExtent(e);s.zmin=n.vmin,s.zmax=n.vmax}if(a){const n=t.getMExtent(e);s.mmin=n.vmin,s.mmax=n.vmax}return s.cache._geVersion=e,s}}},502:function(t,e,n){"use strict";n.d(e,"a",(function(){return k})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return A}));var r=n(79),i=n(99),a=n(121),s=n(87),o=n(85),c=n(468),l=n(215),u=n(91),h=n(212),d=n(444),p=n(112),b=n(81),m=(n(84),n(82),n(83),n(80));let f=class extends i.a{constructor(){super(...arguments),this._tasks=new Array,this.running=!1}get length(){return this._tasks.length}destroy(){this.cancelAll()}runTask(t){for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,n){return this.running=!0,new Promise(((r,i)=>this._tasks.push(new g(r,i,t,e,n))))}unshift(t,e,n){return this.running=!0,new Promise(((r,i)=>this._tasks.unshift(new g(r,i,t,e,n))))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const n=Object(u.m)(e.signal);if(n&&!e.abortCallback)e.reject(Object(u.d)());else{const r=n?e.abortCallback(Object(u.d)()):e.callback(t);Object(u.n)(r)?r.then(e.resolve,e.reject):e.resolve(r)}}catch(n){e.reject(n)}return this.running=this._tasks.length>0,!0}cancelAll(){const t=Object(u.d)();for(const e of this._tasks)if(e.abortCallback){const n=e.abortCallback(t);e.resolve(n)}else e.reject(t);this._tasks.length=0,this.running=!1}};Object(r.a)([Object(b.b)()],f.prototype,"running",void 0),f=Object(r.a)([Object(m.a)("esri.layers.support.PromiseQueue")],f);class g{constructor(t,e,n,r,i){this.resolve=t,this.reject=e,this.callback=n,this.signal=r,this.abortCallback=i}}var y=n(611);const _=s.a.getLogger("esri.views.support.Scheduler");var O,v;(v=O||(O={})).RESOURCE_CONTROLLER="schedule",v.SLIDE="slide",v.STREAM_DATA_LOADER="stream loader",v.ELEVATION_QUERY="elevation query",v.TERRAIN_SURFACE="terrain",v.SURFACE_GEOMETRY_UPDATES="surface geometry updates",v.GRAPHICS_CORE="Graphics3D",v.I3S_CONTROLLER="I3S",v.POINT_CLOUD_LAYER="point cloud",v.FEATURE_TILE_FETCHER="feature fetcher",v.OVERLAY="overlay",v.STAGE="stage",v.GRAPHICS_DECONFLICTOR="graphics deconflictor",v.FILTER_VISIBILITY="Graphics3D filter visibility",v.SCALE_VISIBILITY="Graphics3D scale visibility",v.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",v.POINT_OF_INTEREST_FREQUENT="POI frequent",v.POINT_OF_INTEREST_INFREQUENT="POI infrequent",v.LABELER="labeler",v.FEATURE_QUERY_ENGINE="feature query",v.FEATURE_TILE_TREE="feature tile tree",v.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",v.ELEVATION_ALIGNMENT="elevation alignment",v.TEXT_TEXTURE_ATLAS="text texture atlas",v.TEXTURE_UNLOAD="texture unload",v.LINE_OF_SIGHT_TOOL="line of sight tool",v.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",v.ELEVATION_PROFILE="elevation profile",v.SNAPPING="snapping",v.SHADOW_ACCUMULATOR="shadow accumulator",v.CLOUDS_GENERATOR="cloud generator",v[v.TEST_PRIO=1]="TEST_PRIO";const j=new Map([[O.RESOURCE_CONTROLLER,0],[O.SLIDE,0],[O.STREAM_DATA_LOADER,0],[O.ELEVATION_QUERY,0],[O.TERRAIN_SURFACE,1],[O.SURFACE_GEOMETRY_UPDATES,1],[O.GRAPHICS_CORE,2],[O.I3S_CONTROLLER,2],[O.POINT_CLOUD_LAYER,2],[O.FEATURE_TILE_FETCHER,2],[O.OVERLAY,4],[O.STAGE,4],[O.GRAPHICS_DECONFLICTOR,4],[O.FILTER_VISIBILITY,4],[O.SCALE_VISIBILITY,4],[O.FRUSTUM_VISIBILITY,4],[O.POINT_OF_INTEREST_FREQUENT,6],[O.POINT_OF_INTEREST_INFREQUENT,30],[O.LABELER,8],[O.FEATURE_QUERY_ENGINE,8],[O.FEATURE_TILE_TREE,16],[O.FEATURE_TILE_TREE_ACTIVE,0],[O.ELEVATION_ALIGNMENT,12],[O.TEXT_TEXTURE_ATLAS,12],[O.CLOUDS_GENERATOR,12],[O.TEXTURE_UNLOAD,12],[O.LINE_OF_SIGHT_TOOL,16],[O.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[O.SNAPPING,0],[O.SHADOW_ACCUMULATOR,30]]);function x(t){return j.has(t)?j.get(t):"number"==typeof t?t:1}const E=Object(d.a)(6.5),T=Object(d.a)(1),w=Object(d.a)(30),S=Object(d.a)(1e3/30),M=Object(d.a)(100);var R,I;!function(t){let e=class extends i.a{constructor(t){super(t),this.updating=!0,this._microTaskQueued=!1,this.performanceInfo={total:new c.a("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=null,this._state=1,this._tasks=new l.a,this._runQueue=new l.a,this._load=0,this._idleStateCallbacks=new l.a,this._idleUpdatesStartFired=!1,this._maxReschedule=V,this._forceTask=!1,this._debug=!1,this._debugHandle=Object(p.a)(y.a,"SCHEDULER_LOG_SLOW_TASKS",(t=>this._debug=t)),this._budget=new s(t.nowFunc);for(const r of Object.keys(O))this.performanceInfo.tasks.set(O[r],new c.a(O[r]));let e;const n=this;this._test={get state(){return Object(o.u)(e,n._state)},set state(t){e=t},FRAME_SAFETY_BUDGET:E,INTERACTING_BUDGET:S,IDLE_BUDGET:M,get budget(){return n._budget.budget},usedBudget:0,setBudget:t=>n._budget=t,updateTask:t=>this._updateTask(t),getState:t=>this._getState(t),getRuntime:t=>this._getRuntime(t),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._debugHandle&&this._debugHandle.remove(),this._microTaskQueued=!1}activate(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=V,this._schedule(),this.frame()))})))}registerTask(t,e){const r=x(t),i=new n(this,t,e,r);return this._tasks.push(i),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new c.a(t)),i}registerIdleStateCallbacks(t,e){const n={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(n),2===this.state&&this._idleUpdatesStartFired&&n.idleBegin();const r=this;return{remove:()=>this._removeIdleStateCallbacks(n),set idleBegin(t){r._idleUpdatesStartFired&&(n.idleEnd(),2===r._state&&t()),n.idleBegin=t},set idleEnd(t){n.idleEnd=t}}}get now(){return this.nowFunc()}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return Object(o.k)(this._test.state)?this._state:this._test.state}updateBudget(t){this._test.usedBudget=0;let e=E,n=t.frameDuration,r=T;switch(this.state){case 2:e=Object(d.a)(0),n=Object(d.a)(Math.max(M,t.frameDuration)),r=w;break;case 1:n=Object(d.a)(Math.max(S,t.frameDuration))}return n=Object(d.a)(n-t.elapsedFrameTime-e),2!==this.state&&n<T&&!this._forceTask?(this._forceTask=!0,!1):(n=Object(d.a)(Math.max(n,r)),this._budget.reset(n,this.state),this._maxReschedule=V,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(Object(d.a)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t)}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return I.SCHEDULED;let e=I.IDLE;return this._tasks.forAll((n=>{n.name===t&&n.needsUpdate&&(n.schedulePriority<=1?e=I.READY:e!==I.READY&&(e=I.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((n=>{n.name===t&&(e+=n.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,n)=>{e+=t>1?` ${t}x ${n}`:` ${n}`})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=.9*this._load+t*(1-.9)}_schedule(){if(this._maxReschedule<=0)return!1;for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{0===t.basePriority&&t.needsUpdate&&!this._runQueue.some((e=>e===t))&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1,e=0;if(this._tasks.forAll((n=>{n.needsUpdate&&0!==n.schedulePriority&&0!==n.basePriority&&(t=!0,e=Math.max(e,n.basePriority),1===n.schedulePriority?(n.schedulePriority=0,this._runQueue.push(n)):--n.schedulePriority)})),!t)return this.updating=!1,!1;this._maxReschedule===V&&(this._maxReschedule=e),--this._maxReschedule}return this.updating=!0,!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const n=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)}catch(e){_.error(`Exception in task "${r.name}"`,e)}r.schedulePriority=r.basePriority;const i=this._budget.now()-n;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",r.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(O))this._frameTaskTimes.set(O[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).record(t))),this.performanceInfo.total.record(t)}get test(){return this._test}};Object(r.a)([Object(b.b)()],e.prototype,"updating",void 0),Object(r.a)([Object(b.b)()],e.prototype,"nowFunc",void 0),e=Object(r.a)([Object(m.a)("esri.views.support.Scheduler")],e),t.Scheduler=e;let n=class extends i.a{constructor(t,e,n,r){super({}),this._scheduler=t,this.name=e,this._basePriority=r,this.runtime=0,this._queue=new f,this._handles=new a.a,this.schedulePriority=this._basePriority,this.task=Object(o.l)(n)?n:this._queue,this._handles.add(Object(h.c)((()=>this.task.running),(()=>t.activate())))}get updating(){return this._queue.running}normalizeCtorArgs(){return{}}remove(){this.processQueue(A),this._scheduler.removeTask(this),this.schedule=k.schedule,this.reschedule=k.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){this.name=t;const e=x(t);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,n){return this._queue.push(t,e,n)}reschedule(t,e,n){return this._queue.unshift(t,e,n)}processQueue(t){this._queue.runTask(t)}};Object(r.a)([Object(b.b)({constructOnly:!0})],n.prototype,"task",void 0),Object(r.a)([Object(b.b)({readOnly:!0})],n.prototype,"updating",null),n=Object(r.a)([Object(m.a)("esri.views.support.SchedulerTask")],n);class s{constructor(t){this.now=t,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&(this._didWork=!0),!0)}get done(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}get budget(){return this._budget}madeProgress(){this._didWork=!0}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this._didWork=!1}get remaining(){return Math.max(this._budget-this.elapsed,0)}get elapsed(){return this.now()-this._begin}resetProgress(){this._didWork=!1}get hasProgressed(){return this._didWork}}t.Budget=s}(R||(R={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(I||(I={}));const A=(()=>{const t=new R.Budget((()=>performance.now()));return t.enabled=!1,t})();const k=new class{remove(){}processQueue(){}schedule(t,e,n){try{if(Object(u.m)(e)){const t=Object(u.d)();return n?Promise.resolve(n(t)):Promise.reject(t)}return Object(u.x)(t(A))}catch(r){return Promise.reject(r)}}reschedule(t,e,n){return this.schedule(t,e,n)}},V=Number.MAX_SAFE_INTEGER},550:function(t,e,n){"use strict";n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return p})),n.d(e,"d",(function(){return R})),n.d(e,"e",(function(){return f})),n.d(e,"f",(function(){return h})),n.d(e,"g",(function(){return A})),n.d(e,"h",(function(){return l}));var r=n(331),i=n(400),a=n(106),s=n(176),o=n(116),c=n(237);function l(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function u(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>s.a?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function h(t,e,n){const r=e[0],i=e[1],a=e[2],s=e[3],o=n[0],c=n[1],l=n[2],u=n[3];return t[0]=r*u+s*o+i*l-a*c,t[1]=i*u+s*c+a*o-r*l,t[2]=a*u+s*l+r*c-i*o,t[3]=s*u-r*o-i*c-a*l,t}function d(t,e,n,r){const i=e[0],a=e[1],o=e[2],c=e[3];let l,u,h,d,p,b=n[0],m=n[1],f=n[2],g=n[3];return u=i*b+a*m+o*f+c*g,u<0&&(u=-u,b=-b,m=-m,f=-f,g=-g),1-u>s.a?(l=Math.acos(u),h=Math.sin(l),d=Math.sin((1-r)*l)/h,p=Math.sin(r*l)/h):(d=1-r,p=r),t[0]=d*i+p*b,t[1]=d*a+p*m,t[2]=d*o+p*f,t[3]=d*c+p*g,t}function p(t,e){const n=e[0],r=e[1],i=e[2],a=e[3],s=n*n+r*r+i*i+a*a,o=s?1/s:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=a*o,t}function b(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function m(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const i=(n+1)%3,a=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*i+i]-e[3*a+a]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*i+a]-e[3*a+i])*r,t[i]=(e[3*i+n]+e[3*n+i])*r,t[a]=(e[3*a+n]+e[3*n+a])*r}return t}function f(t,e,n,r){const i=.5*Math.PI/180;e*=i,n*=i,r*=i;const a=Math.sin(e),s=Math.cos(e),o=Math.sin(n),c=Math.cos(n),l=Math.sin(r),u=Math.cos(r);return t[0]=a*c*u-s*o*l,t[1]=s*o*u+a*c*l,t[2]=s*c*l-a*o*u,t[3]=s*c*u+a*o*l,t}const g=c.c,y=c.l,_=c.a,O=h,v=c.b,j=c.d,x=c.j,E=c.e,T=E,w=c.f,S=w,M=c.k,R=c.g,I=c.h;function A(t,e,n){const r=Object(o.h)(e,n);return r<-.999999?(Object(o.g)(k,V,e),Object(o.y)(k)<1e-6&&Object(o.g)(k,G,e),Object(o.r)(k,k),l(t,k,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Object(o.g)(k,e,n),t[0]=k[0],t[1]=k[1],t[2]=k[2],t[3]=1+r,M(t,t))}const k=Object(a.f)(),V=Object(a.h)(1,0,0),G=Object(a.h)(0,1,0);const C=Object(i.b)(),P=Object(i.b)();const L=Object(r.b)();Object.freeze({__proto__:null,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},setAxisAngle:l,getAxisAngle:u,multiply:h,rotateX:function(t,e,n){n*=.5;const r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),c=Math.cos(n);return t[0]=r*c+s*o,t[1]=i*c+a*o,t[2]=a*c-i*o,t[3]=s*c-r*o,t},rotateY:function(t,e,n){n*=.5;const r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),c=Math.cos(n);return t[0]=r*c-a*o,t[1]=i*c+s*o,t[2]=a*c+r*o,t[3]=s*c-i*o,t},rotateZ:function(t,e,n){n*=.5;const r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*o,t[1]=i*c-r*o,t[2]=a*c+s*o,t[3]=s*c-a*o,t},calculateW:function(t,e){const n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},slerp:d,random:function(t){const e=Object(s.b)(),n=Object(s.b)(),r=Object(s.b)(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t},invert:p,conjugate:b,fromMat3:m,fromEuler:f,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},copy:g,set:y,add:_,mul:O,scale:v,dot:j,lerp:x,length:E,len:T,squaredLength:w,sqrLen:S,normalize:M,exactEquals:R,equals:I,rotationTo:A,sqlerp:function(t,e,n,r,i,a){return d(C,e,i,a),d(P,n,r,a),d(t,C,P,2*a*(1-a)),t},setAxes:function(t,e,n,r){const i=L;return i[0]=n[0],i[3]=n[1],i[6]=n[2],i[1]=r[0],i[4]=r[1],i[7]=r[2],i[2]=-e[0],i[5]=-e[1],i[8]=-e[2],M(t,m(t,i))}})},574:function(t,e,n){"use strict";n.r(e),n.d(e,"buffer",(function(){return S})),n.d(e,"clip",(function(){return o})),n.d(e,"contains",(function(){return l})),n.d(e,"convexHull",(function(){return v})),n.d(e,"crosses",(function(){return u})),n.d(e,"cut",(function(){return c})),n.d(e,"densify",(function(){return L})),n.d(e,"difference",(function(){return j})),n.d(e,"disjoint",(function(){return f})),n.d(e,"distance",(function(){return h})),n.d(e,"equals",(function(){return d})),n.d(e,"extendedSpatialReferenceInfo",(function(){return s})),n.d(e,"flipHorizontal",(function(){return G})),n.d(e,"flipVertical",(function(){return C})),n.d(e,"generalize",(function(){return P})),n.d(e,"geodesicArea",(function(){return N})),n.d(e,"geodesicBuffer",(function(){return M})),n.d(e,"geodesicDensify",(function(){return F})),n.d(e,"geodesicLength",(function(){return z})),n.d(e,"intersect",(function(){return E})),n.d(e,"intersects",(function(){return p})),n.d(e,"isSimple",(function(){return _})),n.d(e,"nearestCoordinate",(function(){return R})),n.d(e,"nearestVertex",(function(){return I})),n.d(e,"nearestVertices",(function(){return A})),n.d(e,"offset",(function(){return w})),n.d(e,"overlaps",(function(){return g})),n.d(e,"planarArea",(function(){return D})),n.d(e,"planarLength",(function(){return U})),n.d(e,"relate",(function(){return y})),n.d(e,"rotate",(function(){return V})),n.d(e,"simplify",(function(){return O})),n.d(e,"symmetricDifference",(function(){return x})),n.d(e,"touches",(function(){return b})),n.d(e,"union",(function(){return T})),n.d(e,"within",(function(){return m}));var r=n(512),i=n(461);function a(t){return Array.isArray(t)?t[0].spatialReference:t&&t.spatialReference}function s(t){return r.G.extendedSpatialReferenceInfo(t)}function o(t,e){return r.G.clip(i.hydratedAdapter,a(t),t,e)}function c(t,e){return r.G.cut(i.hydratedAdapter,a(t),t,e)}function l(t,e){return r.G.contains(i.hydratedAdapter,a(t),t,e)}function u(t,e){return r.G.crosses(i.hydratedAdapter,a(t),t,e)}function h(t,e,n){return r.G.distance(i.hydratedAdapter,a(t),t,e,n)}function d(t,e){return r.G.equals(i.hydratedAdapter,a(t),t,e)}function p(t,e){return r.G.intersects(i.hydratedAdapter,a(t),t,e)}function b(t,e){return r.G.touches(i.hydratedAdapter,a(t),t,e)}function m(t,e){return r.G.within(i.hydratedAdapter,a(t),t,e)}function f(t,e){return r.G.disjoint(i.hydratedAdapter,a(t),t,e)}function g(t,e){return r.G.overlaps(i.hydratedAdapter,a(t),t,e)}function y(t,e,n){return r.G.relate(i.hydratedAdapter,a(t),t,e,n)}function _(t){return r.G.isSimple(i.hydratedAdapter,a(t),t)}function O(t){return r.G.simplify(i.hydratedAdapter,a(t),t)}function v(t,e=!1){return r.G.convexHull(i.hydratedAdapter,a(t),t,e)}function j(t,e){return r.G.difference(i.hydratedAdapter,a(t),t,e)}function x(t,e){return r.G.symmetricDifference(i.hydratedAdapter,a(t),t,e)}function E(t,e){return r.G.intersect(i.hydratedAdapter,a(t),t,e)}function T(t,e=null){return r.G.union(i.hydratedAdapter,a(t),t,e)}function w(t,e,n,s,o,c){return r.G.offset(i.hydratedAdapter,a(t),t,e,n,s,o,c)}function S(t,e,n,s=!1){return r.G.buffer(i.hydratedAdapter,a(t),t,e,n,s)}function M(t,e,n,s,o,c){return r.G.geodesicBuffer(i.hydratedAdapter,a(t),t,e,n,s,o,c)}function R(t,e,n=!0){return r.G.nearestCoordinate(i.hydratedAdapter,a(t),t,e,n)}function I(t,e){return r.G.nearestVertex(i.hydratedAdapter,a(t),t,e)}function A(t,e,n,s){return r.G.nearestVertices(i.hydratedAdapter,a(t),t,e,n,s)}function k(t){return"xmin"in t?"center"in t?t.center:null:"x"in t?t:"extent"in t?t.extent.center:null}function V(t,e,n){var i;if(null==t)throw new Error("Illegal Argument Exception");const a=t.spatialReference;if(null==(n=null!=(i=n)?i:k(t)))throw new Error("Illegal Argument Exception");const s=t.constructor.fromJSON(r.G.rotate(t,e,n));return s.spatialReference=a,s}function G(t,e){var n;if(null==t)throw new Error("Illegal Argument Exception");const i=t.spatialReference;if(null==(e=null!=(n=e)?n:k(t)))throw new Error("Illegal Argument Exception");const a=t.constructor.fromJSON(r.G.flipHorizontal(t,e));return a.spatialReference=i,a}function C(t,e){var n;if(null==t)throw new Error("Illegal Argument Exception");const i=t.spatialReference;if(null==(e=null!=(n=e)?n:k(t)))throw new Error("Illegal Argument Exception");const a=t.constructor.fromJSON(r.G.flipVertical(t,e));return a.spatialReference=i,a}function P(t,e,n,s){return r.G.generalize(i.hydratedAdapter,a(t),t,e,n,s)}function L(t,e,n){return r.G.densify(i.hydratedAdapter,a(t),t,e,n)}function F(t,e,n,s=0){return r.G.geodesicDensify(i.hydratedAdapter,a(t),t,e,n,s)}function D(t,e){return r.G.planarArea(i.hydratedAdapter,a(t),t,e)}function U(t,e){return r.G.planarLength(i.hydratedAdapter,a(t),t,e)}function N(t,e,n){return r.G.geodesicArea(i.hydratedAdapter,a(t),t,e,n)}function z(t,e,n){return r.G.geodesicLength(i.hydratedAdapter,a(t),t,e,n)}},598:function(t,e,n){"use strict";function r(t){return 32+t.length}function i(t){if(!t)return 0;let e=32;for(const n in t)if(t.hasOwnProperty(n)){const i=t[n];switch(typeof i){case"string":e+=r(i);break;case"number":e+=16;break;case"boolean":e+=4}}return e}function a(t,e){return 32+t.length*e}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a}))},611:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(79),i=n(99),a=n(81),s=(n(84),n(82),n(83),n(80));let o=class extends i.a{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};Object(r.a)([Object(a.b)()],o.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),Object(r.a)([Object(a.b)()],o.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),o=Object(r.a)([Object(s.a)("esri.views.support.DebugFlags")],o);const c=new o},621:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(79),i=n(99),a=n(87),s=n(85),o=n(91),c=n(81),l=(n(84),n(82),n(83),n(80)),u=n(652),h=n(683);const d=a.a.getLogger("esri.views.interactive.InteractiveToolBase");let p=class extends i.a{constructor(t){super(t),this.toolState="pending",this.completed=!1,this.manipulators=new h.a,this.updating=!1,this.automaticManipulatorSelection=!0,this._editableFlags=new Map([[1,!0],[0,!0]]),this._creationStartedResolver=Object(o.f)(),this._creationFinishedResolver=Object(o.f)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(t){this._set("visible",t),t||this.active&&(this.view.activeTool=null),this.attached&&(t?this._show():this._hide())}get editable(){return this.getEditableFlag(0)}set editable(t){this.setEditableFlag(0,t)}get attached(){return this._get("attached")}get created(){return"created"===this.toolState}get cursor(){return null}attach(){this.attached?d.warn("Tool is already attached. Ignoring attach request."):(this.manipulators.attach(),this.onAttach(),this.visible&&this.onShow(),this._set("attached",!0))}detach(){this.attached?(this.visible&&this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1)):d.error("Tool isn't currently attached. Ignoring detach request.")}activate(){Object(s.k)(this.view)?d.error("Can't activate tool if view is not defined."):this.active?d.warn("Tool is already active, ignoring activation request."):(Object(u.b)(this.view)&&this.view.focus(),this.onActivate())}deactivate(){this.active?this.onDeactivate():d.warn("Tool is not active, ignoring deactivation request.")}handleInputEvent(t){this.attached?this.onInputEvent(t):d.warn("handleInputEvent() called on detached tool")}handleInputEventAfter(t){this.attached?this.onInputEventAfter(t):d.warn("handleInputEventAfter() called on detached tool")}destroy(){this.manipulators.destroy(),this._set("view",null),this._set("completed",!1)}setEditableFlag(t,e){this._editableFlags.set(t,e),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),0===t&&this.notifyChange("editable"),this.onEditableChange()}getEditableFlag(t){return this._editableFlags.get(t)}whenCreationStarted(){return this._creationStartedResolver.promise}whenCreated(){return this._creationFinishedResolver.promise}rejectCreation(t){"pending"!==this.toolState&&"creating"!==this.toolState||this._creationStartedResolver.resolve(this),this._creationFinishedResolver.reject(t)}onActivate(){}onDeactivate(){}onAttach(){}onDetach(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(t){}onInputEventAfter(t){}get internallyEditable(){return this.getEditableFlag(0)&&this.getEditableFlag(1)}startToolCreation(){if("pending"===this.toolState)return this._creationStartedResolver.resolve(this),void(this.toolState="creating");throw new Error(`Unexpected tool state ${this.toolState}`)}finishToolCreation(){switch(this.toolState){case"pending":this.startToolCreation();case"creating":this.created||this._creationFinishedResolver.resolve(this),this.toolState="created";break;case"created":break;default:throw new Error(`Unexpected tool state ${this.toolState}`)}}complete(){this.finishToolCreation(),this._set("completed",!0)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()}};Object(r.a)([Object(c.b)()],p.prototype,"toolState",void 0),Object(r.a)([Object(c.b)({constructOnly:!0})],p.prototype,"view",void 0),Object(r.a)([Object(c.b)({readOnly:!0})],p.prototype,"active",null),Object(r.a)([Object(c.b)({value:!0})],p.prototype,"visible",null),Object(r.a)([Object(c.b)({value:!0})],p.prototype,"editable",null),Object(r.a)([Object(c.b)({value:!1,readOnly:!0})],p.prototype,"attached",null),Object(r.a)([Object(c.b)({readOnly:!0})],p.prototype,"created",null),Object(r.a)([Object(c.b)({readOnly:!0})],p.prototype,"completed",void 0),Object(r.a)([Object(c.b)({readOnly:!0})],p.prototype,"manipulators",void 0),Object(r.a)([Object(c.b)({readOnly:!0})],p.prototype,"updating",void 0),Object(r.a)([Object(c.b)()],p.prototype,"cursor",null),Object(r.a)([Object(c.b)()],p.prototype,"automaticManipulatorSelection",void 0),p=Object(r.a)([Object(l.a)("esri.views.interactive.InteractiveToolBase")],p)},683:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(107),i=n(85);class a{constructor(){this._isToolEditable=!0,this._manipulators=new r.a,this._nextManipulatorId=0,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t,e=0){return this.addMany([t],e)[0]}addMany(t,e=0){return t.map((t=>{const n=this._nextManipulatorId++,r={id:n,manipulator:t,visibilityPredicate:e,attached:!1};return this._manipulators.add(r),this._attached&&this._updateManipulatorAttachment(r),n}))}remove(t){if("number"==typeof t){const e=t;for(let t=0;t<this._manipulators.length;t++)if(this._manipulators.getItemAt(t).id===e){const e=this._manipulators.splice(t,1)[0];return this._detachManipulator(e),e.id}return null}const e=t;for(let n=0;n<this._manipulators.length;n++)if(this._manipulators.getItemAt(n).manipulator===e){const t=this._manipulators.splice(n,1)[0];return this._detachManipulator(t),t.id}return null}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this._manipulators.forEach((({manipulator:t})=>{t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(t,e){return this._manipulators.on(t,(t=>{e(t)}))}forEach(t){for(const e of this._manipulators.items)t(e)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((e=>t.push(e.manipulator))),t}intersect(t,e){let n=null,r=Number.MAX_VALUE;return this._manipulators.forEach((({id:a,manipulator:s,attached:o})=>{if(!o||!s.interactive)return;const c=s.intersectionDistance(t,e);Object(i.l)(c)&&c<r&&(r=c,n={id:a,manipulator:s})})),n}findById(t){if(Object(i.k)(t))return null;for(const e of this._manipulators.items)if(t===e.id)return e.manipulator;return null}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const e=t.manipulator;e.grabbing=!1,e.dragging=!1,e.hovering=!1,e.selected=!1,e.detach&&e.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return 2===t.visibilityPredicate||(this._isToolEditable?0===t.visibilityPredicate:1===t.visibilityPredicate)}}},697:function(t,e,n){"use strict";function r(){return[1,0,0,1,0,0]}function i(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));Object.freeze({__proto__:null,create:r,clone:i,fromValues:function(t,e,n,r,i,a){return[t,e,n,r,i,a]},createView:function(t,e){return new Float64Array(t,e,6)}})},706:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}));const r=["freehand","hybrid","click"],i="click"},741:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(85),i=n(91),a=n(437),s=n(439),o=n(622),c=n(502);class l{constructor(){this.next=new s.a}createSnapDragEventPipelineStep({predicate:t=(()=>!0),cancel:e,snappingManager:n,snappingContext:l,updatingHandles:u}){if(Object(r.k)(n))return t=>t;let h=null,d=null;const p=()=>{h=Object(r.a)(h),n.doneSnapping(),Object(r.l)(d)&&d.frameTask.remove(),d=null};return e.next((t=>(p(),t))),this.next=new s.a,e=>{if(!t(e))return e;if(h=Object(r.a)(h),"start"===e.action){const t="3d"===n.view.type?n.view.resourceController.scheduler.registerTask(c.b.SNAPPING):c.a;d={context:new o.a({editGeometryOperations:l.editGeometryOperations,elevationInfo:l.elevationInfo,pointer:l.pointer,vertexHandle:Object(r.l)(e.info)?e.info.handle:null,excludeFeature:l.excludeFeature,visualizer:l.visualizer}),originalPos:Object(r.l)(e.snapOrigin)?l.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,frameTask:t}}if(Object(r.l)(d)){const t=d.context.coordinateHelper.vectorToDehydratedPoint(d.context.coordinateHelper.arrayToVector([d.originalPos.x,d.originalPos.y,d.originalPos.z]));t.x+=e.mapEnd.x-e.mapStart.x,t.y+=e.mapEnd.y-e.mapStart.y;const r=e.mapStart.x-d.originalPos.x,s=e.mapStart.y-d.originalPos.y,o={...e,action:"udpate"},c=d.context,l=n.update(t,d.context);if(e.mapEnd.x=l.x+r,e.mapEnd.y=l.y+s,"end"!==e.action){const e=d.frameTask;h=Object(i.g)((async i=>{const u=await e.schedule((()=>n.snap(t,c,i)),i);if(u.valid){const t=await e.schedule((()=>u.apply()),i);Object(a.a)(t,l)||(o.mapEnd.x=t.x+r,o.mapEnd.y=t.y+s,this.next.execute(o))}})),u.addPromise(h.promise)}}return"end"===e.action&&p(),e}}}},777:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return d}));n(97);var r=n(85),i=n(345),a=n(697),s=n(550),o=n(400),c=n(116),l=n(106),u=n(109);function h(t,e,n=null){return Object(r.l)(n)?[t,e,n]:[t,e]}function d(t,e,n=null){return Object(r.l)(n)?{x:t,y:e,z:n}:{x:t,y:e}}class p{constructor(t){this.spatialReference=t}mapToLocalMultiple(t){return Object(r.h)(t.map((t=>this.mapToLocal(t))))}get doUnnormalization(){return!1}}class b extends p{constructor(t,e,n=null){super(e),this.defaultZ=n,this.transform=Object(a.b)(),this.transformInv=Object(a.b)(),this.transform=Object(a.a)(t),Object(i.a)(this.transformInv,this.transform)}makeMapPoint(t,e){return h(t,e,this.defaultZ)}mapToLocal(t){return d(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return h(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this.defaultZ)}}class m extends p{constructor(t,e){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=Object(l.f)(),this.tangentFrameUpWS=Object(l.f)(),this.tangentFrameRightWS=Object(l.f)(),this.tangentFrameForwardWS=Object(l.f)(),this.localFrameRightWS=Object(l.f)(),this.localFrameUpWS=Object(l.f)(),this.worldToLocalTransform=Object(o.b)(),this.localToWorldTransform=Object(o.b)(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=e,this.defaultZ=e.hasZ?e.z:null;const n=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,0,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,1,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,2,this.tangentFrameForwardWS);const r=Object(l.f)();Object(c.e)(r,this.tangentFrameForwardWS,Object(c.h)(n,this.tangentFrameForwardWS)),Object(c.j)(this.localFrameRightWS,n,r),Object(c.r)(this.localFrameRightWS,this.localFrameRightWS),Object(c.g)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),Object(s.g)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),Object(s.c)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(t,e){return h(t,e,this.defaultZ)}mapToLocal(t){const e=Object(l.f)();this.view.renderCoordsHelper.toRenderCoords(new u.a({x:t[0],y:t[1],spatialReference:this.spatialReference}),e),Object(c.u)(e,e,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return Object(r.l)(n)?d(n.x/this.scale,n.y/this.scale):null}localToMap(t){const e=Object(l.f)();this.view.renderCoordsHelper.toRenderCoords(new u.a({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),e),Object(c.u)(e,e,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return Object(r.l)(n)?h(n.x,n.y,this.defaultZ):null}}function f(t,e){if("2d"===t.type)return new b(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if("3d"===t.type){const n=e.length>2?new u.a({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new u.a({x:e[0],y:e[1],spatialReference:t.spatialReference});return new m(t,n)}return null}},856:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return c}));var r=n(85),i=n(101),a=n(416),s=n(386);class o{constructor(t,e,n,r=null){this.elevationInfo=t,this.defaultZ=e,this.view=n,this.excludeGraphics=r}screenToMap(t){if(Object(r.l)(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen(Object(i.f)(t.x,t.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);const e=this.view.sceneIntersectionHelper.intersectElevationFromScreen(Object(i.f)(t.x,t.y),this.elevationInfo,0,this.excludeGraphics);return Object(r.l)(e)&&(e.z=void 0),e}mapToScreen(t){const e=Object(a.g)(t.x,t.y,Object(s.a)(this.view,t,this.elevationInfo),t.spatialReference);return this.view.toScreen(e)}}class c{constructor(t,e,n=[]){this.view=t,this.elevationInfo=e,this.exclude=n}screenToMap(t){const e=this.view.toMap(t,{exclude:this.exclude});return Object(r.l)(e)&&(e.z=Object(s.g)(e,this.view,this.elevationInfo)),e}mapToScreen(t){let e=t;return Object(r.l)(this.elevationInfo)&&(e=Object(a.g)(t.x,t.y,Object(s.a)(this.view,t,this.elevationInfo),t.spatialReference)),this.view.toScreen(e)}}class l{constructor(t){this.view=t,this.screenToMap=e=>t.toMap(e),this.mapToScreen=e=>t.toScreen(e)}}},872:function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var r=n(79),i=n(129),a=n(131),s=n(89),o=n(85),c=n(91),l=n(101),u=n(81),h=(n(83),n(80)),d=n(437);class p{constructor({grabbableForEvent:t}){this.events=new i.a,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=t}intersectionDistance(t,e){return 0}attach(){}detach(){}}var b=n(706),m=n(674),f=n(439),g=n(442),y=n(637),_=n(622),O=n(741),v=n(502);let j=class extends(i.a.EventedMixin(a.a)){constructor(t){super(t),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingPipeline=new O.a,this._snappingTask=null,this._stagedVertex=null,this.snapToSceneEnabled=null,Object(o.k)(t.elevationInfo)&&(this.elevationInfo={mode:t.hasZ?"absolute-height":"on-the-ground",offset:0})}initialize(){var t,e;this.coordinateHelper=Object(m.a)(this.hasZ,this.hasM,this.view.spatialReference);const n="3d"===this.view.type?null==(t=this.view)||null==(e=t.resourceController)?void 0:e.scheduler:null;this._frameTask=n?n.registerTask(v.b.SNAPPING):v.a;const r="viewingMode"in this.view.state?this.view.state.viewingMode:2,i="segment"===this.geometryType||"multipoint"===this.geometryType?"polyline":this.geometryType;this._editGeometryOperations=new y.a(new g.c(i,this.coordinateHelper,r)),this._activeComponent=new g.a(this.spatialReference,r),this._editGeometryOperations.data.components.push(this._activeComponent),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(t=>{const e=t.vertices.map((t=>({componentIndex:0,vertexIndex:t.index,coordinates:this.coordinateHelper.vectorToArray(t.pos)}))),n=e.map((t=>t.coordinates));switch(t.type){case"vertex-add":this.emit(t.type,{...t,added:n,vertices:e});break;case"vertex-update":this.emit(t.type,{...t,updated:n,vertices:e});break;case"vertex-remove":this.emit(t.type,{...t,removed:n,vertices:e})}}))),this._manipulator=new p({grabbableForEvent:t=>"click"!==this.drawingMode||"touch"===t.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==this.geometryType,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(t=>this._onImmediateClick(t))),this._manipulator.events.on("immediate-double-click",(t=>this._onImmediateDoubleClick(t)))])}destroy(){this._editGeometryOperations=Object(o.e)(this._editGeometryOperations),this._frameTask=Object(o.s)(this._frameTask)}get _snappingEnabled(){return Object(o.l)(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((t=>this.coordinateHelper.vectorToArray(t.pos)))}set drawingMode(t){this._set("drawingMode",null!=t?t:b.a)}get hasStagedVertex(){return Object(o.l)(this._stagedVertex)}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return Object(o.l)(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get spatialReference(){return this.view.spatialReference}get stagedVertex(){return this._stagedVertex}set stagedVertex(t){if(Object(o.k)(t))this.discardStagedVertex();else if(!Object(o.l)(this._stagedVertex)||!Object(d.a)(this._stagedVertex,t)){if(Object(o.k)(this._stagedVertex))this._stagedVertex=Object(s.a)(t);else{if(Object(d.a)(this._stagedVertex,t))return;this._stagedVertex.x=t.x,this._stagedVertex.y=t.y,this._stagedVertex.z=t.z,this._stagedVertex.m=t.m,this._stagedVertex.hasZ=t.hasZ,this._stagedVertex.hasM=t.hasM,this._stagedVertex.spatialReference=t.spatialReference}this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(t)}],operation:"apply",type:"vertex-update"})}}get updating(){return this.updatingHandles.updating}get vertices(){const t=this.committedVertices;return Object(o.l)(this._stagedVertex)&&t.push(this.coordinateHelper.pointToArray(this._stagedVertex)),t}cancel(){this.complete({aborted:!0})}commitStagedVertex(){if(this._snappingTask=Object(o.a)(this._snappingTask),Object(o.l)(this._stagedVertex)){const t=this._stagedVertex;this._stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}}complete(t){const e=t&&t.aborted||!1;Object(o.a)(this._snappingTask),Object(o.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.discardStagedVertex();const n="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!n,(this.isCompleted||e)&&this.emit("complete",{vertices:this.vertices.map(((t,e)=>({componentIndex:0,vertexIndex:e,coordinates:t}))),aborted:e,type:"complete"})}discardStagedVertex(){this._stagedVertex=null}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){Object(o.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_closeOnClickVertexIndex(t){const e=this._activeComponent;if("polygon"===this.geometryType&&e.vertices.length>2){if(this._vertexWithinPointerDistance(e.vertices[0].pos,t))return 0;if(this._vertexWithinPointerDistance(e.vertices[e.vertices.length-1].pos,t))return e.vertices.length-1}return null}_createManipulatorDragPipeline(t){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return Object(f.e)(t,((t,e,n,r)=>{const i="touch"===r&&this._snappingEnabled;!this.isCompleted&&i&&(e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this.stagedVertex=t.mapStart,("segment"===this.geometryType||i&&0===this.numVertices)&&this.commitStagedVertex()),t))).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>i,cancel:n,snappingManager:this.snappingManager,snappingContext:new _.a({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:r,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next((t=>(i&&(this.stagedVertex=t.mapEnd,"end"===t.action&&this.commitStagedVertex()),t))).next((t=>("end"===t.action&&("segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),t))),n.next((()=>{i&&Object(o.l)(this.snappingManager)&&this.snappingManager.doneSnapping()})))}))}_createManipulatorDragPipelineFreehand(t){return Object(f.e)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(Object(o.k)(this.stagedVertex)&&(this.stagedVertex=t.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this.stagedVertex=t.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return t}))}))}_createManipulatorDragPipelineHybrid(t){return Object(f.e)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(Object(o.k)(this.stagedVertex)&&(this.stagedVertex=t.mapStart),this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this.stagedVertex=t.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return t}))}))}_getDrawSurface(){if(Object(o.k)(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ)return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let t=this.defaultZ,e=!1;Object(o.l)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(e=!0),Object(o.l)(this.snapToSceneEnabled)&&(e=this.snapToSceneEnabled),Object(o.l)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(e=!1);const n=this._activeComponent.vertices.length;return("segment"===this.geometryType||"polygon"===this.geometryType)&&n>0&&(t=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),e=!1),e?this.drawSurface:(this.elevationDrawSurface.defaultZ=t,this.elevationDrawSurface)}_mapToScreen(t){return this._getDrawSurface().mapToScreen(t)}_onHold(t){Object(o.a)(this._snappingTask),"click"===this.drawingMode&&"touch"===t.pointerType&&this._snappingEnabled&&(this.stagedVertex=t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if("mouse"===t.pointerType&&2===t.button||this._manipulator.dragging)return;const e=this._activeComponent,n=this._closeOnClickVertexIndex(t.screenPoint);if(Object(o.l)(n))return t.stopPropagation(),this.discardStagedVertex(),void this.complete();const r=this._screenToMap(t.screenPoint);if(Object(o.l)(r))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&(this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),this.complete());break;case"click":case"hybrid":this._snappingTask=Object(o.a)(this._snappingTask),this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),("point"===this.geometryType||"segment"===this.geometryType&&2===e.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===e.vertices.length)&&this.complete()}t.stopPropagation()}_onImmediateDoubleClick(t){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),t.stopPropagation())}_onPointerMove(t){if(Object(o.a)(this._snappingTask),this._manipulator.dragging||this._pointerDownStates.has(t.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return;const e=Object(l.e)(t.x,t.y),n=this._closeOnClickVertexIndex(e);if(Object(o.l)(n)){this.discardStagedVertex();const t={componentIndex:0,vertexIndex:n,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[n].pos)};this.emit("cursor-update",{updated:null,vertices:[t],operation:"apply",type:"vertex-update"})}else{const n=this._screenToMap(e);if(this._manipulator.cursor=Object(o.l)(n)?"crosshair":null,Object(o.l)(n))if(Object(o.l)(this.snappingManager)){const e=this.snappingManager,r=new _.a({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t.pointerType,visualizer:this.snappingVisualizer});this.stagedVertex=e.update(n,r),this._snappingTask=Object(c.g)((async t=>{const i=await this._frameTask.schedule((()=>e.snap(n,r,t)),t);i.valid&&await this._frameTask.schedule((()=>{this.stagedVertex=i.apply()}),t)})),this.updatingHandles.addPromise(this._snappingTask.promise)}else this.stagedVertex=n}t.stopPropagation()}_screenToMap(t){return this._getDrawSurface().screenToMap(t)}_screenToMapDragEventStep(){let t=null;return e=>{if("start"===e.action&&(t=this._screenToMap(e.screenStart)),Object(o.k)(t))return null;const n=this._screenToMap(e.screenEnd);return Object(o.l)(n)?{...e,mapStart:t,mapEnd:n}:null}}_vertexWithinPointerDistance(t,e){const n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return!!Object(o.l)(n)&&function(t,e,n){const r=t.x-e.x,i=t.y-e.y;return r*r+i*i<=n}(n,e,25)}};Object(r.a)([Object(u.b)()],j.prototype,"defaultZ",void 0),Object(r.a)([Object(u.b)({value:b.a})],j.prototype,"drawingMode",null),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"elevationDrawSurface",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"elevationInfo",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"geometryType",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"hasM",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"hasZ",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"manipulators",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"drawSurface",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"snappingManager",void 0),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"snappingVisualizer",void 0),Object(r.a)([Object(u.b)()],j.prototype,"snapToSceneEnabled",void 0),Object(r.a)([Object(u.b)({readOnly:!0})],j.prototype,"updating",null),Object(r.a)([Object(u.b)({constructOnly:!0})],j.prototype,"view",void 0),j=Object(r.a)([Object(h.a)("esri.views.draw.DrawOperation")],j)}}]);
//# sourceMappingURL=40.e87d095d.chunk.js.map