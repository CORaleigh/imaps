{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/GraphicsSnappingSource.js","../node_modules/@arcgis/core/geometry/support/normalizeUtilsSync.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"],"names":["O","s","t","constructor","e","super","this","availability","sources","multipoint","point","polygon","polyline","loadedWkids","Set","loadedWkts","pendingAdds","updatingHandles","updating","layerSource","layer","destroy","length","task","abort","mapSources","destroySource","initialize","handles","add","on","onGraphicUpdate","addOnCollectionChange","graphics","onGraphicsChanged","addMany","toArray","r","a","queryEngine","executeQueryForSnapping","coordinateHelper","toPoint","c","toJSON","distance","types","query","o","filter","createQuery","where","then","candidates","flat","map","k","v","refresh","property","remove","graphic","removed","added","Map","i","geometry","needsInitializeProjection","spatialReference","push","set","uid","createPendingAdd","n","async","u","source","dest","signal","markLoadedSpatialReferences","addPromise","promise","wkid","wkt","visible","type","l","fromExtent","ensureSource","createOptimizedFeature","featureStore","has","h","m","y","S","f","b","createSource","g","j","geometryType","hasZ","hasM","w","fields","name","alias","objectIdField","scheduler","view","resourceController","removeFromSource","delete","size","removeById","p","constructOnly","prototype","readOnly","d","isWebMercator","I","maxX","minX","plus180Line","minus180Line","J","N","points","x","M","xmin","ymin","xmax","ymax","cut","valid","frameId","extent","frameIds","rings","Array","isArray","Math","ceil","abs","closed","minPts","paths","constraint","targetPoint","edgeStart","fromPoint","start","edgeEnd","end","target","objectId"],"mappings":"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","file":"static/js/199.11617022.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import{removeUnordered as r}from\"../../../../core/arrayUtils.js\";import{HandleOwnerMixin as s}from\"../../../../core/HandleOwner.js\";import{isSome as o,isNone as i}from\"../../../../core/maybe.js\";import{eachAlwaysValues as a,createTask as n}from\"../../../../core/promiseUtils.js\";import{property as p}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as d}from\"../../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../../geometry/Point.js\";import l from\"../../../../geometry/Polygon.js\";import{initializeProjection as u,canProjectWithoutEngine as h,project as m}from\"../../../../geometry/projection.js\";import{normalizeCentralMeridianSync as y}from\"../../../../geometry/support/normalizeUtilsSync.js\";import{featureGeometryTypeKebabDictionary as g}from\"../../../../geometry/support/typeUtils.js\";import{convertFromGeometry as f}from\"../../../../layers/graphics/featureConversionUtils.js\";import S from\"../../../../layers/graphics/OptimizedFeature.js\";import j from\"../../../../layers/graphics/data/FeatureStore.js\";import w from\"../../../../layers/graphics/data/QueryEngine.js\";import{sortCandidatesInPlace as v}from\"../snappingUtils.js\";import{convertSnappingCandidate as k}from\"./queryEngineUtils.js\";let O=class extends(s(t)){constructor(e){super(e),this.availability=1,this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){const e=this.pendingAdds;this.pendingAdds.length=0;for(const t of e)t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on(\"graphic-update\",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}async fetchCandidates(e,t){const r=(await a(this.mapSources((r=>r.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.toPoint(e.point,new c).toJSON(),distance:e.distance,types:e.types,query:o(e.filter)?e.filter.createQuery().toJSON():{where:\"1=1\"}},t).then((({candidates:e})=>e)))))).flat().map((t=>k(t,e.coordinateHelper)));return v(e.point,r),r}refresh(){}onGraphicUpdate(e){switch(e.property){case\"geometry\":case\"visible\":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(const t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){const t=[],r=new Map;for(const s of e)i(s.geometry)||(this.needsInitializeProjection(s.geometry.spatialReference)?(t.push(s.geometry.spatialReference),r.set(s.uid,s)):this.add(s));this.createPendingAdd(t,r)}createPendingAdd(e,t){if(!e.length)return;const s=n((async r=>{await u(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:r}),this.markLoadedSpatialReferences(e);for(const[,e]of t)this.add(e)}));this.updatingHandles.addPromise(s.promise);const o={task:s,graphics:t},i=()=>r(this.pendingAdds,o);s.promise.then(i,i),this.pendingAdds.push(o)}markLoadedSpatialReferences(e){for(const t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if(i(e.geometry)||!e.visible)return;let t=e.geometry;if(\"mesh\"===t.type)return;\"extent\"===t.type&&(t=l.fromExtent(t));const r=this.ensureSource(t.type);if(i(r))return;const s=this.createOptimizedFeature(e.uid,t);o(s)&&r.featureStore.add(s)}needsInitializeProjection(e){return(null==e.wkid||!this.loadedWkids.has(e.wkid))&&((null==e.wkt||!this.loadedWkts.has(e.wkt))&&!h(e,this.spatialReference))}createOptimizedFeature(e,t){const r=m(y(t),this.spatialReference);return r?new S(f(r,!1,!1),{[b]:e},null,e):null}ensureSource(e){const t=this.sources[e];if(o(t))return t;const r=this.createSource(e);return this.sources[e]=r,r}createSource(e){const t=g.toJSON(e),r=new j({geometryType:t,hasZ:!1,hasM:!1});return{featureStore:r,queryEngine:new w({featureStore:r,fields:[{name:b,type:\"esriFieldTypeOID\",alias:b}],geometryType:t,hasM:!1,hasZ:!1,objectIdField:b,spatialReference:this.spatialReference,scheduler:o(this.view)&&\"3d\"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){this.mapSources((t=>this.removeFromSource(t,e)));for(const t of this.pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){const r=t.uid;e.featureStore.has(r)&&e.featureStore.removeById(t.uid)}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){const{point:t,polygon:r,polyline:s,multipoint:i}=this.sources,a=[];return o(t)&&a.push(e(t)),o(r)&&a.push(e(r)),o(s)&&a.push(e(s)),o(i)&&a.push(e(i)),a}};e([p({constructOnly:!0})],O.prototype,\"spatialReference\",void 0),e([p({constructOnly:!0})],O.prototype,\"layerSource\",void 0),e([p({constructOnly:!0})],O.prototype,\"view\",void 0),e([p({readOnly:!0})],O.prototype,\"updating\",null),e([p({readOnly:!0})],O.prototype,\"availability\",void 0),O=e([d(\"esri.views.interactive.snapping.featureSources.GraphicsSnappingSource\")],O);const b=\"OBJECTID\";export{O as GraphicsSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{create as n}from\"./aaBoundingRect.js\";import{getBoundsXY as t}from\"./boundsUtils.js\";import{extentIntersectsPolyline as i}from\"./intersectsBase.js\";import{isPoint as s,isMultipoint as m,isExtent as e,isPolygon as x,isPolyline as o}from\"./jsonUtils.js\";import{cutParams as r,getGeometryParts as a,offsetMagnitude as f}from\"./normalizeUtilsCommon.js\";import{getInfo as c}from\"./spatialReferenceUtils.js\";function l(n){if(!n)return null;if(\"mesh\"===n.type)return n.toJSON();let a=null;const l=n.spatialReference,h=c(l);if(!h)return n.toJSON();const d=l.isWebMercator?102100:4326,I=r[d].maxX,g=r[d].minX,b=r[d].plus180Line,v=r[d].minus180Line;let J;const N=n.toJSON();if(s(N))J=y(N,I,g);else if(m(N))N.points=N.points.map((n=>y(n,I,g))),J=N;else if(e(N))J=p(N,h);else if(x(N)||o(N)){const n=M;t(n,N);const s={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},m=f(s.xmin,g)*(2*I),e=0===m?N:u(N,m);s.xmin+=m,s.xmax+=m,i(s,b)&&s.xmax!==I||i(s,v)&&s.xmin!==g?a=e:J=e}else J=n.toJSON();if(null!==a){return(new j).cut(a,I)}return J}function u(n,t){const i=a(n);for(const s of i)for(const n of s)n[0]+=t;return n}function p(n,t){if(!t)return n;const i=h(n,t).map((n=>n.extent));return i.length<2?i[0]||n:i.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:i.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}function y(n,t,i){if(Array.isArray(n)){const s=n[0];if(s>t){const i=f(s,t);n[0]=s+i*(-2*t)}else if(s<i){const t=f(s,i);n[0]=s+t*(-2*i)}}else{const s=n.x;if(s>t){const i=f(s,t);n.x+=i*(-2*t)}else if(s<i){const t=f(s,i);n.x+=t*(-2*i)}}return n}function h(n,t){const i=[],{ymin:s,ymax:m}=n,e=n.xmax-n.xmin,x=n.xmin,o=n.xmax;let r;const[a,f]=t.valid;r=d(n.xmin,t);const c=r.x,l=r.frameId;r=d(n.xmax,t);const u=r.x,p=r.frameId,y=c===u&&e>0;if(e>2*f){const n={xmin:x<o?c:u,ymin:s,xmax:f,ymax:m},t={xmin:a,ymin:s,xmax:x<o?u:c,ymax:m},e={xmin:0,ymin:s,xmax:f,ymax:m},r={xmin:a,ymin:s,xmax:0,ymax:m},y=[],h=[];I(n,e)&&y.push(l),I(n,r)&&h.push(l),I(t,e)&&y.push(p),I(t,r)&&h.push(p);for(let i=l+1;i<p;i++)y.push(i),h.push(i);i.push({extent:n,frameIds:[l]},{extent:t,frameIds:[p]},{extent:e,frameIds:y},{extent:r,frameIds:h})}else c>u||y?i.push({extent:{xmin:c,ymin:s,xmax:f,ymax:m},frameIds:[l]},{extent:{xmin:a,ymin:s,xmax:u,ymax:m},frameIds:[p]}):i.push({extent:{xmin:c,ymin:s,xmax:u,ymax:m},frameIds:[l]});return i}function d(n,t){const[i,s]=t.valid,m=2*s;let e,x=0;return n>s?(e=Math.ceil(Math.abs(n-s)/m),n-=e*m,x=e):n<i&&(e=Math.ceil(Math.abs(n-i)/m),n+=e*m,x=-e),{x:n,frameId:x}}function I(n,t){const{xmin:i,ymin:s,xmax:m,ymax:e}=t;return g(n,i,s)&&g(n,i,e)&&g(n,m,e)&&g(n,m,s)}function g(n,t,i){return t>=n.xmin&&t<=n.xmax&&i>=n.ymin&&i<=n.ymax}class j{cut(n,t){let i;if(n.rings)this.closed=!0,i=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,i=n.paths,this.minPts=2}const s=i.length,m=-2*t;for(let e=0;e<s;e++){const n=i[e];if(n&&n.length>=this.minPts){const t=[];for(const i of n)t.push([i[0]+m,i[1]]);i.push(t)}}return this.closed?n.rings=i:n.paths=i,n}}const M=n();export{l as normalizeCentralMeridianSync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{PointConstraint as t}from\"../SnappingConstraint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointSnappingHint as r}from\"../hints/PointSnappingHint.js\";class i extends n{constructor(n){super({...n,constraint:new t(n.coordinateHelper,n.targetPoint)})}get hints(){return[new r(this.targetPoint)]}}export{i as VertexSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.20/esri/copyright.txt for details.\n*/\nimport{EdgeSnappingCandidate as e}from\"../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as t}from\"../candidates/VertexSnappingCandidate.js\";function r(r,n){switch(r.type){case\"edge\":return new e({coordinateHelper:n,edgeStart:n.fromPoint(r.start),edgeEnd:n.fromPoint(r.end),targetPoint:n.fromPoint(r.target),objectId:r.objectId});case\"vertex\":return new t({coordinateHelper:n,targetPoint:n.fromPoint(r.target),objectId:r.objectId})}}export{r as convertSnappingCandidate};\n"],"sourceRoot":""}