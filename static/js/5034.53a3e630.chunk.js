"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[5034],{45034:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var s=t(85580),i=t(72791),r=t(2170),l=t(50890),o=t(97862),n=t(76200),c=t(80885),d=t(51995),m=t(94172),p=t(47409);let u;let b,h,y;const v=e=>r.intersects(e,b),f=e=>!!h||e.portalItem.tags.includes("countywide"),g=async e=>{const a=await(0,n.default)("https://maps.raleighnc.gov/images/rest/services/Orthos2020/ImageServer/queryBoundary?outSR=102100&f=json",{responseType:"json"});return c.Z.fromJSON(a.data.shape)},w=(e,a,t)=>{b&&u.source.basemaps.find((e=>u.activeBasemap.title===e.title))&&(y=h,h=v(a.extent),y!==h&&(u.source.refresh(),setTimeout((()=>{const e=u.source.basemaps.find((e=>a.map.basemap.title===e.title));if(e)u.activeBasemap=e;else{const e=u.activeBasemap.title;u.activeBasemap=u.source.basemaps.at(0);const a=u.activeBasemap.title;if(t){t({show:!0,autoDismiss:!0,duration:"medium",kind:"warning",title:"Imagery Year Changed",message:`Imagery for ${e} only available inside Raleigh, base map has changed to ${a}`})}}}),1e3)))},x=async(e,a)=>{if(e.baseLayers.length){const t=e.baseLayers.find((e=>"vector-tile"===e.type));if("vector-tile"===(null===t||void 0===t?void 0:t.type)){await m.N1((()=>t.loaded));const e=t.getStyleLayer("background");if(e){const t=new d.Z(e.paint["background-color"]);return a.background={color:t},t.isBright}return!0}return!(!t&&"imagery"===e.baseLayers.getItemAt(0).type)}return!1},j=(e,a)=>{const t=e.map.allLayers.find((e=>e.title.includes("Property")&&"feature"===e.type));if(t){const e=(null===t||void 0===t?void 0:t.renderer).clone();a?(e.symbol.outline.color.r=0,e.symbol.outline.color.g=0,e.symbol.outline.color.b=0):(e.symbol.outline.color.r=255,e.symbol.outline.color.g=255,e.symbol.outline.color.b=255),t.renderer=e}},k={title:"Basemap Tips",tips:[{title:"Imagery Basemap",text:"The lastest years of imagery are available in the Imagery basemap under the base maps option.  We recommend using this base map for imagery, unless you need to access historic imagery."},{title:"Esri Basemaps",text:"You now have access to all basemaps created by Esri by select the Esri Basemaps option from the dropdown."},{title:"Property Color",text:"If you switch to a dark themed basemap or an imagery basemap, the property lines will change to white for better visibility.  They will change back to black when on a light themed basemap."},{title:"Available Imagery",text:"If you go to an area outside of Raleigh, the list of available imagery will change to show you what is available in your area.  Also it will switch to the latest year available and warn you the the imagery has changed."}]},I=e=>{const[a,t]=(0,i.useState)(),[s,r]=(0,i.useState)(!1),[n,c]=(0,i.useState)(!1),d=(0,i.useRef)(!1),y=(0,i.useRef)(null),I=(0,i.useRef)(null),C=(0,i.useRef)(null),B=(0,i.useRef)(.5),A="f6329364e80c438a958ce74aadc3a89f",R="492386759d264d49948bf7f83957ddb9",S="02d50d24991747538e218e0a5806e9b3";(0,i.useEffect)((()=>{t(e.view),d.current||(d.current=!0,(async(e,a,t)=>{const s=new l.Z({container:a,view:e,source:{query:`id: ${t}`}});await m.N1((()=>s.source.basemaps.length>0));const i=s.source.basemaps.find((a=>a.portalItem.title===e.map.basemap.title));i&&(s.activeBasemap=i)})(e.view,y.current,A),(async(e,a,t,s)=>{u=new l.Z({container:a,view:e,source:new o.Z({query:`id: ${t}`,filterFunction:f,updateBasemapsCallback:e=>e.reverse()})}),await m.N1((()=>u.source.basemaps.length>0));const i=u.source.basemaps.find((a=>a.portalItem.title===e.map.basemap.title));if(i&&(u.activeBasemap=i),await u.when(),u.source.basemaps.reverse(),!b){const a=await g(e);b=a,h=v(e.extent),u.source.refresh()}e.watch("extent",(a=>w(a,e,s))),e.map.watch("basemap",(async a=>{const t=await x(a,e);j(e,t)}))})(e.view,I.current,R,e.alertSet),(async(e,a)=>{const t=new l.Z({container:a,view:e});await m.N1((()=>t.source.basemaps.length>0));const s=t.source.basemaps.find((a=>a.portalItem.title===e.map.basemap.title));s&&(t.activeBasemap=s)})(e.view,C.current),setTimeout((()=>{var e,a,t;null===(e=document.querySelector(".basemaps calcite-tab-nav"))||void 0===e||null===(a=e.shadowRoot)||void 0===a||null===(t=a.querySelector(".tab-nav"))||void 0===t||t.setAttribute("style","overflow: hidden")}),100))}),[e.view]),(0,i.useEffect)((()=>{r(e.isActive)}),[e.isActive]);const T=(0,i.useCallback)((a=>{e.panelDismissed()}),[]),L=(0,i.useCallback)((a=>{e.showTips(k)}),[]),E=(0,i.useCallback)((a=>{c(a.currentTarget.checked),((e,a,t,s)=>{const i=new p.default({portalItem:{id:t}});if(e)i.opacity=s,a.map.basemap.baseLayers.add(i);else{a.map.basemap.baseLayers.remove(i);const e=a.map.basemap.baseLayers.find((e=>"vector-tile"===e.type&&e.portalItem.id===i.portalItem.id));e&&a.map.basemap.baseLayers.remove(e)}u.watch("activeBasemap",(a=>{e&&(a.baseLayers.find((e=>"vector-tile"===e.type&&e.portalItem.id===i.portalItem.id))||a.baseLayers.add(i))}))})(a.currentTarget.checked,e.view,S,B.current)}),[]),N=(0,i.useCallback)((a=>{B.current=1-a.target.value/100,((e,a,t,s)=>{const i=a.map.basemap.baseLayers.find((e=>"vector-tile"===e.type&&e.portalItem.id===t));i&&(i.opacity=s)})(a.target.value,e.view,S,B.current)}),[]);return{basemapRef:y,imagesRef:I,esriRef:C,mapGroup:A,imageGroup:R,view:a,isActive:s,panelDismissed:T,tipsClicked:L,blendUpdated:E,blendOpacityChanged:N,blendActive:n}};var C=t(80184);function B(e){const{basemapRef:a,imagesRef:t,esriRef:i,isActive:r,panelDismissed:l,tipsClicked:o,blendUpdated:n,blendOpacityChanged:c,blendActive:d}=I(e);return(0,C.jsxs)(s.N$,{id:"basemaps-panel",heading:"Basemaps",hidden:!r,closed:!r||void 0,closable:!0,onCalcitePanelClose:l,children:[(0,C.jsx)(s.G1,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:o}),(0,C.jsx)(s.$A,{label:"Show Tip",referenceElement:"tip",closeOnClick:!0,children:"Show Tip"}),(0,C.jsx)("div",{className:"basemaps",children:(0,C.jsxs)(s.A3,{position:"bottom",layout:"center",scale:"l",children:[(0,C.jsxs)(s.yj,{slot:"title-group",children:[(0,C.jsx)(s.A7,{children:"Maps"}),(0,C.jsx)(s.A7,{children:"Images"}),(0,C.jsx)(s.A7,{children:"Esri"})]}),(0,C.jsx)(s.Qi,{children:(0,C.jsx)("div",{ref:a})}),(0,C.jsxs)(s.Qi,{children:[(0,C.jsx)("br",{}),(0,C.jsxs)(s.ZK,{layout:"inline",alignment:"end",children:[(0,C.jsx)(s.$p,{onCalciteSwitchChange:n}),"Blend"]}),(0,C.jsx)(s.XQ,{hidden:!d||void 0,max:100,min:0,value:50,onCalciteSliderInput:c}),(0,C.jsx)("div",{ref:t})]}),(0,C.jsx)(s.Qi,{children:(0,C.jsx)("div",{ref:i})})]})})]})}const A=i.memo(B)}}]);
//# sourceMappingURL=5034.53a3e630.chunk.js.map