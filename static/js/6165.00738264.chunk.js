"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[6165],{40237:(e,t,s)=>{s.d(t,{N:()=>n});const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,s){const n=new i(e.getPointX(t),e.getPointY(t),s),r=e.hasZ(t),o=e.hasM(t);return r&&(n.z=e.getPointZ(t)),o&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,s){return new r(e.exportPaths(t),s,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,s){return new o(e.exportPaths(t),s,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,s){return new a(e.exportPoints(t),s,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,s){const n=e.hasZ(t),i=e.hasM(t),r=new c(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),s);if(n){const s=e.getZExtent(t);r.zmin=s.vmin,r.zmax=s.vmax}if(i){const s=e.getMExtent(t);r.mmin=s.vmin,r.mmax=s.vmax}return r}};class i{constructor(e,t,s){this.x=e,this.y=t,this.spatialReference=s,this.z=void 0,this.m=void 0}}class r{constructor(e,t,s,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),n&&(this.hasM=n)}}class o{constructor(e,t,s,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),n&&(this.hasM=n)}}class a{constructor(e,t,s,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),n&&(this.hasM=n)}}class c{constructor(e,t,s,n,i){this.xmin=e,this.ymin=t,this.xmax=s,this.ymax=n,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},19995:(e,t,s)=>{s.d(t,{_W:()=>p,iV:()=>g,oj:()=>_});var n=s(92026),i=s(79803),r=s(40237),o=s(92975),a=s(81753);const c=[0,0];function h(e,t){if(!t)return null;if("x"in t){const s={x:0,y:0};return[s.x,s.y]=e(t.x,t.y,c),null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=e(t.xmin,t.ymin,c),[s.xmax,s.ymax]=e(t.xmax,t.ymax,c),t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:d(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:d(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:l(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function d(e,t){const s=[];for(const n of e)s.push(l(n,t));return s}function l(e,t){const s=[];for(const n of e){const e=t(n[0],n[1],[0,0]);s.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return s}async function p(e,t){if(!e||!t)return;const s=Array.isArray(e)?e.map((e=>(0,n.pC)(e.geometry)?e.geometry.spatialReference:null)).filter(n.pC):[e];await(0,i.iQ)(s.map((e=>({source:e,dest:t}))))}const u=h.bind(null,a.hG),f=h.bind(null,a.R6);function g(e,t,s,n){if(!e)return e;if(s||(s=t,t=e.spatialReference),!(0,o.JY)(t)||!(0,o.JY)(s)||(0,o.fS)(t,s))return e;if((0,a.Q8)(t,s)){const t=(0,o.sS)(s)?u(e):f(e);return t.spatialReference=s,t}return(0,i.oj)(r.N,[e],t,s,null,n)[0]}const y=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,s){if(!e||!e.length||!t||!s||(0,o.fS)(t,s))return e;const n={geometries:e,inSpatialReference:t,outSpatialReference:s,resolve:null};return this._jobs.push(n),new Promise((e=>{n.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:s,outSpatialReference:n,resolve:c}=e;(0,a.Q8)(s,n)?(0,o.sS)(n)?c(t.map(u)):c(t.map(f)):c((0,i.oj)(r.N,t,s,n,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function _(e,t,s){return y.push(e,t,s)}},61394:(e,t,s)=>{s.d(t,{U:()=>R});var n=s(27366),i=s(41691),r=s(100),o=s(77427),a=s(92026),c=s(66978),h=s(94172),d=s(49861),l=(s(25243),s(63780),s(69912)),p=s(88396),u=s(11186),f=s(71353),g=s(26277),y=s(92536),_=s(74509),v=s(95122),S=s(80371),m=s(1700),x=s(64674),E=s(97760),w=s(95905),C=s(75691),P=s(19824),L=s(11208);let R=class extends i.r{get updating(){return(0,o.oE)(this.snappingSources,(e=>{let{snappingSource:t}=e;return t.updating}))||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,t=new Map;if((0,a.pC)(this.options)&&(0,a.pC)(this.options.featureSources))for(const s of this.options.featureSources.items){const n=s.layer.uid,i=e.get(n);if(i){e.delete(n),t.set(n,i);continue}if(!s.layer.loaded){this.updatingHandles.addPromise(s.layer.load());continue}const r=this._createSourceInfo(s);(0,a.pC)(r)&&t.set(n,r)}for(const[,s]of e)s.destroy();return t}constructor(e){super(e),this.options=null,this._domain=S.B.FEATURE,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}initialize(){this.updatingHandles.add((()=>this.snappingSources),(()=>this.notifyChange("updating")),h.Z_),(0,a.pC)(this.view)&&this.handles.add([this.view.on("layerview-create",(e=>this._updateLayerView(e.layer,e.layerView))),this.view.on("layerview-destroy",(e=>this._updateLayerView(e.layer,null)))])}_updateLayerView(e,t){for(const[,s]of this.snappingSources)s.snappingSource.layerSource.layer===e&&(s.layerView=t)}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,t,s,n){if(!(t&this._domain)||(0,a.Wi)(this.options)||!this.options.effectiveFeatureEnabled)return[];const i=[],r=this._computeScreenSizeDistanceParameters(e,s),o={distance:r,mode:(0,a.Wg)(this.view)?.type??"2d",point:e,coordinateHelper:s.coordinateHelper,types:this._types};for(const[,{snappingSource:c,layerView:d}]of this.snappingSources)!c.layerSource.enabled||(0,a.pC)(d)&&d.suspended||i.push(c.fetchCandidates(o,n).then((e=>e.filter((e=>!this._candidateIsExcluded(c,e,s.excludeFeature))))));const h=(await(0,c.WW)(i)).flat();return this._addRightAngleCandidates(h,e,r,s),(0,c.k_)(n),(0,x.lQ)(e,h),h}_addRightAngleCandidates(e,t,s,n){const i=(0,a.pC)(n.vertexHandle)?n.vertexHandle.rightEdge?.rightVertex?.pos:(0,a.pC)(n.editGeometryOperations)&&"polygon"===n.editGeometryOperations.data.type?(0,a.Wg)(n.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,r=(0,a.pC)(n.vertexHandle)?n.vertexHandle.leftEdge?.leftVertex?.pos:(0,a.pC)(n.editGeometryOperations)?(0,a.Wg)(n.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,{view:o}=this,c=(0,m.$D)(i,o,n),h=(0,m.$D)(r,o,n),d=e.length;for(let a=0;a<d;a++)this._addRightAngleCandidate(e[a],h,t,s,e),this._addRightAngleCandidate(e[a],c,t,s,e)}_addRightAngleCandidate(e,t,s,n,i){if((0,a.Wi)(t)||!function(e){return(e instanceof w.L||e instanceof E.k)&&!function(e){let{constraint:{start:t,end:s}}=e;const n=(0,u.d)(t,s),i=(0,p.k)(t,s);return n<(0,g.g)()||i/n<k}(e)}(e))return;const r=e.constraint.closestTo(t),o=(r[0]-s[0])/n.x,c=(r[1]-s[1])/n.y,{start:h,end:d}=e.constraint;if(o*o+c*c<=1){const s=new P.A({targetPoint:r,otherVertex:t,otherVertexType:P.Y.NEXT,previousVertex:(0,p.k)(r,h)>(0,p.k)(r,d)?h:d,constraint:new v.aU(t,r),objectId:e.objectId,isDraped:e.isDraped});i.push(s)}}_computeScreenSizeDistanceParameters(e,t){let s=(0,a.pC)(this.options)?this.options.distance*("touch"===t.pointer?this.options.touchSensitivityMultiplier:1):0;return(0,a.Wi)(this.view)?{x:s,y:s,z:s,distance:s}:"2d"===this.view.type?(s*=this.view.resolution,{x:s,y:s,z:s,distance:s}):this._computeScreenSizeDistanceParameters3D(e,s,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,s,n){const{spatialReference:i}=n;s.renderCoordsHelper.toRenderCoords(e,i,M);const r=s.state.camera.computeScreenPixelSizeAt(M),o=r*s.renderCoordsHelper.unitInMeters/s.mapCoordsHelper.unitInMeters,a=t*o,c=(0,L.Rs)(e,i,_.jG,s),h=c?b(c,e,o,0,0,s,n):0,d=c?b(c,e,0,o,0,s,n):0,l=c?b(c,e,0,0,o,s,n):0;return{x:0===h?0:a/h,y:0===d?0:a/d,z:0===l?0:a/l,distance:r*t}}get _types(){return y.r.EDGE|y.r.VERTEX}_candidateIsExcluded(e,t,s){if((0,a.Wi)(s))return!1;const n=this._getCandidateObjectId(t);if((0,a.Wi)(n))return!1;const i=e.layerSource.layer;return"graphics"===i.type?s.uid===n:s.sourceLayer===i&&!(!s.attributes||!("objectIdField"in i))&&s.attributes[i.objectIdField]===n}_getCandidateObjectId(e){return e instanceof C.a?e.objectId:null}_createSourceInfo(e){const t=this._createFeatureSnappingSourceType(e);if((0,a.Wi)(t))return null;if("loading"in t)return this.updatingHandles.addPromise(t.loading.then((()=>{this.destroyed||this.notifyChange("snappingSources")}))),null;const s=(0,a.pC)(this.view)?this.view.allLayerViews.find((t=>t.layer===e.layer)):null;return new T(t.source,s)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}_createFeatureSnappingSourceSceneLayer(e){const{view:t}=this;if((0,a.Wi)(t)||"3d"!==t.type)return null;const s=this._getSourceModule("scene");return(0,a.pC)(s.module)?{source:new s.module.SceneLayerSnappingSource({layerSource:e,view:t})}:{loading:s.loader}}_createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source?.type){case"feature-layer":case"oriented-imagery":{const t=this._getSourceModule("featureService");return(0,a.pC)(t.module)?{source:new t.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}case"memory":case"csv":case"geojson":case"wfs":{if("mesh"===e.layer.geometryType)return null;const t=this._getSourceModule("featureCollection");return(0,a.pC)(t.module)?{source:new t.module.FeatureCollectionSnappingSource({layerSource:e,view:this.view})}:{loading:t.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const t=this._getSourceModule("graphics");return(0,a.pC)(t.module)?{source:new t.module.GraphicsSnappingSource({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_createFeatureSnappingSourceMapNotesLayer(e){const t=this._getSourceModule("notes");return(0,a.pC)(t.module)?{source:new t.module.GraphicsSnappingSource({getGraphicsLayers:()=>(0,a.pC)(e.layer.sublayers)?e.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_getSourceModule(e){const t=this._sourceModules[e];if((0,a.Wi)(t.loader)){const s=this._loadSourceModule(e).then((e=>{t.module=e}));return t.loader=s,{module:t.module,loader:s}}return{module:t.module,loader:t.loader}}_loadSourceModule(e){const t=this.updatingHandles;switch(e){case"featureService":return t.addPromise(Promise.all([s.e(5652),s.e(4134)]).then(s.bind(s,84134)));case"featureCollection":return t.addPromise(s.e(2137).then(s.bind(s,26823)));case"graphics":case"notes":return t.addPromise(Promise.all([s.e(4e3),s.e(8928),s.e(3518)]).then(s.bind(s,33518)));case"scene":return t.addPromise(Promise.all([s.e(5158),s.e(7814),s.e(9306)]).then(s.bind(s,34953)))}}};(0,n._)([(0,d.Cb)({constructOnly:!0})],R.prototype,"spatialReference",void 0),(0,n._)([(0,d.Cb)({constructOnly:!0})],R.prototype,"view",void 0),(0,n._)([(0,d.Cb)()],R.prototype,"options",void 0),(0,n._)([(0,d.Cb)({readOnly:!0})],R.prototype,"updating",null),(0,n._)([(0,d.Cb)({readOnly:!0})],R.prototype,"snappingSources",null),R=(0,n._)([(0,l.j)("esri.views.interactive.snapping.FeatureSnappingEngine")],R);class T{constructor(e,t){this.snappingSource=e,this.layerView=t,this.handles=new r.Z;const s=this.snappingSource.layerSource.layer;if("refresh"in s){const t=s;this.handles.add(t.on("refresh",(()=>e.refresh())))}this.handles.add([(0,h.YP)((()=>e.updating),(t=>e.layerSource.updating=t),h.tX),(0,h.YP)((()=>e.availability),(t=>e.layerSource.availability=t),h.tX)])}destroy(){this.snappingSource.destroy(),this.handles.destroy()}}function b(e,t,s,n,i,r,o){let{spatialReference:a}=o;const c=(0,u.c)(V,t);c[0]+=s,c[1]+=n,c[2]+=i;const h=(0,L.Rs)(c,a,_.jG,r);return h?(0,x.fG)(h,e):1/0}const M=(0,f.c)(),V=(0,f.c)(),k=1e-4},22006:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(27366),i=s(85015),r=s(49861),o=(s(25243),s(63780),s(69912));let a=class extends i.Z{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1}};(0,n._)([(0,r.Cb)({constructOnly:!0})],a.prototype,"layer",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"enabled",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"updating",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"availability",void 0),a=(0,n._)([(0,o.j)("esri.views.interactive.snapping.FeatureSnappingLayerSource")],a);const c=a},95122:(e,t,s)=>{s.d(t,{Bq:()=>g,Hk:()=>p,M8:()=>x,aU:()=>S,jg:()=>m,kt:()=>_,ku:()=>f});var n=s(92026),i=s(88396),r=s(6394),o=s(11186),a=s(71353),c=s(1700),h=s(55793),d=s(94163);class l{intersect(e){return function(e,t){let s=[];if(w(e)){const{point:n}=e;C(t)?s=(0,h.pk)(t.lineLike,n):P(t)?s=(0,h.Xi)(t.center,t.radius,n):L(t)?s=(0,h.hm)(t.planeLike,n):R(t)&&(s=E(t,e))}else if(C(e)){const{lineLike:n}=e;w(t)?s=(0,h.pk)(n,t.point):C(t)?s=(0,h.Lh)(n,t.lineLike):P(t)?s=(0,h.CJ)(n,t.center,t.radius):L(t)?s=(0,h.fK)(t.planeLike,n):R(t)&&(s=E(t,e))}else if(P(e)){const{center:n,radius:i}=e;if(C(t))s=(0,h.CJ)(t.lineLike,n,i);else if(w(t))s=(0,h.Xi)(n,i,t.point);else{if(L(t))return(0,h.SD)(t.planeLike,n,i).map((s=>new y(s,e,t)));R(t)&&(s=E(t,e))}}else if(L(e)){const{planeLike:n}=e;if(L(t))return(0,h.qi)(n,t.planeLike).map((s=>new y(s,e,t)));if(w(t))s=(0,h.hm)(n,t.point);else if(C(t))s=(0,h.fK)(n,t.lineLike);else{if(P(t))return(0,h.SD)(n,t.center,t.radius).map((s=>new y(s,e,t)));R(t)&&(s=E(t,e))}}else R(e)&&(s=E(e,t));return function(e,t,s){return e.map((e=>new g((0,c.uc)(e),t,s)))}(s,e,t)}(this,e)}}class p extends l{constructor(e){super(),this.point=e}equals(e){return w(e)&&(0,o.k)(this.point,e.point)}closestTo(){return(0,c.bQ)(this.point)}}class u extends l{constructor(e,t,s){super(),this.start=e,this.end=t,this.type=s,this.lineLike={start:this.start,end:this.end,type:this.type}}equals(e){return C(e)&&this.type===e.type&&(0,o.k)(this.start,e.start)&&(0,o.k)(this.end,e.end)}closestTo(e){const t=(0,h.ZE)(e,this.lineLike);return(0,c.uc)(t)}}class f extends u{constructor(e,t){super(e,t,d.SP.LINE)}}class g extends l{constructor(e,t,s){super(),this.intersection=e,this.first=t,this.second=s}equals(e){return e instanceof g&&this.first.equals(e.first)&&this.second.equals(e.second)}closestTo(){return(0,c.bQ)(this.intersection)}}class y extends l{constructor(e,t,s){super(),this.basePoint=e,this.first=t,this.second=s}equals(e){return e instanceof y&&this.first.equals(e.first)&&this.second.equals(e.second)}closestTo(e){const t=this.basePoint;return(0,c.uc)((0,a.f)(t[0],t[1],e[2]))}}class _ extends l{constructor(e,t){super(),this.center=e,this.radius=t}equals(e){return P(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const t=(0,h.sc)(e,this.center,this.radius);return(0,c.uc)(t)}}class v extends l{constructor(e,t,s){super(),this.start=e,this.end=t,this.type=s,this.planeLike={start:e,end:t,type:s}}equals(e){return L(e)&&this.type===e.type&&(0,o.k)(this.start,e.start)&&(0,o.k)(this.end,e.end)}closestTo(e){return(0,c.uc)((0,h.z9)(e,this.planeLike))}closestEndTo(e){const{start:t,end:s}=this;return Math.sign((0,i.h)((0,i.a)(T,s,t),(0,i.a)(b,e,t)))>0?s:t}}class S extends v{constructor(e,t){super(e,t,h.Jk.HALF_PLANE)}}class m extends v{constructor(e,t){super(e,t,h.Jk.PLANE)}}class x extends l{constructor(e,t,s){super(),this.start=e,this.end=t,this.getZ=s,this.planeLike={start:e,end:t,type:h.Jk.HALF_PLANE}}equals(e){return R(e)&&(0,o.k)(this.start,e.start)&&(0,o.k)(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return function(e,t){const s=(0,h.z9)(t,e.planeLike);return s[2]=(0,n.WG)(e.getZ(t[0],t[1],t[2]))??M,(0,c.uc)(s)}(this,e)}addIfOnTheGround(e,t){for(const s of t){const t=(0,n.Pt)(this.getZ(s[0],s[1],s[2]),0);Math.abs(s[2]-t)<h.Ho&&(s[2]=t,e.push(s))}}}function E(e,t){const{planeLike:s,getZ:i}=e,r=[];if(w(t))e.addIfOnTheGround(r,(0,h.hm)(s,t.point));else if(C(t))e.addIfOnTheGround(r,(0,h.fK)(s,t.lineLike));else if(P(t))for(const[o,c]of(0,h.SD)(s,t.center,t.radius)){const e=i(o,c,0);(0,n.pC)(e)&&r.push((0,a.f)(o,c,e))}else if(L(t)||R(t))for(const[o,c]of(0,h.qi)(s,t.planeLike)){const e=(0,n.WG)(i(o,c,0))??M;r.push((0,a.f)(o,c,e))}return r}function w(e){return e instanceof p}function C(e){return e instanceof u}function P(e){return e instanceof _}function L(e){return e instanceof v}function R(e){return e instanceof x}const T=(0,r.a)(),b=(0,r.a)(),M=0},38856:(e,t,s)=>{s.d(t,{N:()=>J});var n=s(27366),i=s(91505),r=s(41691),o=s(92026),a=s(66978),c=s(94172),h=s(49861),d=(s(25243),s(63780),s(69912)),l=s(79803),p=s(74509),u=s(76014),f=s(80371),g=s(61394),y=s(85015),_=s(40281),v=s(88396),S=s(1700),m=s(64674),x=s(11208);class E{constructor(e,t){this.view=e,this.options=t,this.squaredShortLineThreshold=u.c.shortLineThreshold*u.c.shortLineThreshold}snap(e,t){return(0,o.pC)(t.vertexHandle)?"vertex"!==t.vertexHandle.type?[]:this.snapExistingVertex(e,t):this.snapNewVertex(e,t)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold((0,S.$D)(e.leftVertex.pos,this.view,t),(0,S.$D)(e.rightVertex.pos,this.view,t),t)}exceedsShortLineThreshold(e,t,s){let{spatialReference:n}=s;return 0===this.squaredShortLineThreshold||(0,m.Bb)((0,x.Rs)(t,n,p.jG,this.view),(0,x.Rs)(e,n,p.jG,this.view))>this.squaredShortLineThreshold}isVertical(e,t){return(0,v.k)(e,t)<u.c.verticalLineThreshold}squaredProximityThreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,s=e*t;return s*s}}var w=s(95122),C=s(92605),P=s(53397);class L extends C.j{constructor(e){let{lineStart:t,lineEnd:s,targetPoint:n,isDraped:i}=e;super(n,new w.jg(t,s),i,f.B.SELF),this._referenceLineHint=new P.w(m.ze.REFERENCE_EXTENSION,t,s,i,this.domain)}get hints(){return[this._referenceLineHint,new P.w(m.ze.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}var R=s(55793),T=s(94163);class b extends E{snapNewVertex(e,t){const s=t.editGeometryOperations.data.components[0],n=s.edges.length,i=[];if(n<1)return i;const{spatialReference:r}=t,o=(0,x.Rs)(e,r,p.jG,this.view),{view:a}=this,c=s.edges[n-1];let h=c;do{if(this.edgeExceedsShortLineThreshold(h,t)){const s=(0,m._j)(h,a,t);this._processCandidateProposal(s.left,s.right,e,o,t,i)}h=h.leftVertex.leftEdge}while(h&&h!==c);return i}snapExistingVertex(e,t){const s=[],n=(0,o.Wg)(t.vertexHandle),i=n.component;if(i.edges.length<2)return s;const{view:r}=this,{spatialReference:a}=t,c=(0,x.Rs)(e,a,p.jG,r),h=n.leftEdge,d=n.rightEdge;h&&d&&this.edgeExceedsShortLineThreshold(h,t)&&this.edgeExceedsShortLineThreshold(d,t)&&this._processCandidateProposal((0,S.$D)(h.leftVertex.pos,r,t),(0,S.$D)(d.rightVertex.pos,r,t),e,c,t,s);const l=i.edges[0];let u=l;do{if(u!==n.leftEdge&&u!==n.rightEdge&&this.edgeExceedsShortLineThreshold(u,t)){const n=(0,m._j)(u,r,t);this._processCandidateProposal(n.left,n.right,e,c,t,s)}u=u.rightVertex.rightEdge}while(u&&u!==l);return s}_processCandidateProposal(e,t,s,n,i,r){const{spatialReference:o,pointer:a}=i,c=(0,S.uc)((0,R.ZE)(s,{start:e,end:t,type:T.SP.LINE}));(0,m.Bb)(n,(0,x.Rs)(c,o,p.jG,this.view))<this.squaredProximityThreshold(a)&&r.push(new L({lineStart:e,lineEnd:t,targetPoint:c,isDraped:"on-the-ground"===i.elevationInfo?.mode}))}}var M=s(6394),V=s(71353),k=s(11186),D=s(5916);class F extends C.j{constructor(e){let{referenceLine:t,lineStart:s,targetPoint:n,isDraped:i}=e;const r=(0,V.a)(s),{left:o,right:a}=t;(0,k.b)(r,(0,k.a)(r,r,a),o),super(n,new w.jg(s,(0,S.uc)(r)),i,f.B.SELF),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new P.w(m.ze.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new D.L(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map((e=>new P.w(m.ze.REFERENCE,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((s=>{(0,k.k)(e.right,s.edge.left)&&(s.fadeLeft=!1,t.fadeRight=!1),(0,k.k)(e.right,s.edge.right)&&(s.fadeRight=!1,t.fadeRight=!1),(0,k.k)(e.left,s.edge.right)&&(s.fadeRight=!1,t.fadeLeft=!1),(0,k.k)(e.left,s.edge.left)&&(s.fadeLeft=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}class N extends E{snapNewVertex(e,t){const s=t.editGeometryOperations.data.components[0],n=s.edges.length,i=s.vertices.length,r=[];if(n<2)return r;const{view:o}=this,a=(0,x.Rs)(e,t.spatialReference,p.jG,o),c=(0,S.$D)(s.vertices[i-1].pos,o,t),h=(0,S.$D)(s.vertices[0].pos,o,t),d=s.edges[n-1];let l=d;do{if(this.edgeExceedsShortLineThreshold(l,t)){const s=(0,m._j)(l,o,t);this._checkEdgeForParallelLines(s,c,e,a,t,r),this._checkEdgeForParallelLines(s,h,e,a,t,r)}l=l.leftVertex.leftEdge}while(l&&l!==d);return r}snapExistingVertex(e,t){const s=[],n=(0,o.Wg)(t.vertexHandle),i=n.component;if(i.edges.length<3)return s;const{view:r}=this,a=(0,x.Rs)(e,t.spatialReference,p.jG,r),c=n.leftEdge,h=n.rightEdge,d=i.vertices[0],l=(0,S.$D)(d.pos,r,t),u=i.vertices.length,f=i.vertices[u-1],g=(0,S.$D)(f.pos,r,t),y=i.edges[0];let _=y;do{if(_!==c&&_!==h&&this.edgeExceedsShortLineThreshold(_,t)){const i=(0,m._j)(_,r,t);c&&this._checkEdgeForParallelLines(i,(0,S.$D)(c.leftVertex.pos,r,t),e,a,t,s),h&&this._checkEdgeForParallelLines(i,(0,S.$D)(h.rightVertex.pos,r,t),e,a,t,s),n===d?this._checkEdgeForParallelLines(i,g,e,a,t,s):n===f&&this._checkEdgeForParallelLines(i,l,e,a,t,s)}_=_.rightVertex.rightEdge}while(_&&_!==y);return s}_checkEdgeForParallelLines(e,t,s,n,i,r){const o=e.left,a=e.right;if((0,T.k0)(z,t,o,a),(0,v.k)(z,t)<u.c.parallelLineThreshold)return;(0,T.k0)(z,s,o,a,t);const{spatialReference:c,pointer:h}=i,d=(0,S.uc)((0,V.f)(z[0],z[1],s[2]));if((0,m.Bb)(n,(0,x.Rs)(d,c,p.jG,this.view))<this.squaredProximityThreshold(h)){if(this.isVertical(d,t)||this.isVertical(o,a))return;if(this._parallelToPreviousCandidate(e,r))return;r.push(new F({referenceLine:e,lineStart:t,targetPoint:d,isDraped:"on-the-ground"===i.elevationInfo?.mode}))}}_parallelToPreviousCandidate(e,t){const s=e.left,n=e.right;for(const i of t)if((0,T.k0)(z,n,i.constraint.start,i.constraint.end,s),(0,v.k)(z,n)<u.c.parallelLineThreshold)return i.addReferenceLine(e),!0;return!1}}const z=(0,M.a)();var I=s(19824);class j extends E{snapNewVertex(e,t){const s=t.editGeometryOperations.data.components[0],n=s.vertices.length,i=[];if(n<2)return i;const{view:r}=this,o=(0,x.Rs)(e,t.spatialReference,p.jG,r),a=s.vertices[n-1];if(this.edgeExceedsShortLineThreshold(a.leftEdge,t)){const s=(0,S.$D)(a.pos,r,t),n=(0,S.$D)(a.leftEdge.leftVertex.pos,r,t);this._checkForSnappingCandidate(i,n,s,e,o,t)}const c=s.vertices[0];if(this.edgeExceedsShortLineThreshold(c.rightEdge,t)){const s=(0,S.$D)(c.pos,r,t),n=(0,S.$D)(c.rightEdge.rightVertex.pos,r,t);this._checkForSnappingCandidate(i,n,s,e,o,t)}return i}snapExistingVertex(e,t){const s=[],n=(0,o.Wg)(t.vertexHandle);if(n.component.vertices.length<3)return s;const{view:i}=this,r=(0,x.Rs)(e,t.spatialReference,p.jG,i),a=n.leftEdge,c=n.rightEdge;if(a&&a.leftVertex.leftEdge){const n=a.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(n,t)){const o=(0,S.$D)(n.rightVertex.pos,i,t),a=(0,S.$D)(n.leftVertex.pos,i,t);this._checkForSnappingCandidate(s,a,o,e,r,t)}}if(c&&c.rightVertex.rightEdge){const n=c.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(n,t)){const o=(0,S.$D)(n.leftVertex.pos,i,t),a=(0,S.$D)(n.rightVertex.pos,i,t);this._checkForSnappingCandidate(s,a,o,e,r,t)}}return s}_checkForSnappingCandidate(e,t,s,n,i,r){const{spatialReference:o,pointer:a}=r;(0,v.a)(A,s,t);const c=(0,k.s)(G,A[1],-A[0],0),h=(0,v.h)(c,(0,v.a)(A,n,s))/(0,v.v)(c),d=(0,S.uc)((0,v.w)((0,V.a)(n),s,c,h));if((0,m.Bb)(i,(0,x.Rs)(d,o,p.jG,this.view))<this.squaredProximityThreshold(a)){if(this.isVertical(d,s)||this.isVertical(s,t))return;const n=(0,k.z)((0,V.c)(),s,c,Math.sign(h));e.push(new I.A({targetPoint:d,constraint:new w.aU(s,(0,S.uc)(n)),previousVertex:t,otherVertex:s,otherVertexType:I.Y.CENTER,isDraped:"on-the-ground"===r.elevationInfo?.mode}))}}}const A=(0,M.a)(),G=(0,V.c)();var Z=s(41216);class q extends C.j{constructor(e){let{targetPoint:t,point1:s,point2:n,isDraped:i}=e;super(t,new w.kt((0,S.uc)((0,k.h)((0,V.c)(),s,n,.5)),.5*(0,v.d)(s,n)),i,f.B.SELF),this._p1=s,this._p2=n}get hints(){return[new P.w(m.ze.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new P.w(m.ze.REFERENCE,this.targetPoint,this._p2,this.isDraped,this.domain),new Z.y(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}class O extends E{snapNewVertex(e,t){const s=t.editGeometryOperations.data.components[0],n=[],i=s.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||i<2)return n;const{view:r}=this,o=s.vertices[0],a=s.vertices[i-1],c=(0,S.$D)(o.pos,r,t),h=(0,S.$D)(a.pos,r,t);return this._processCandidateProposal(c,h,e,t,n),n}snapExistingVertex(e,t){const s=[],n=(0,o.Wg)(t.vertexHandle),i=n.component;if(i.edges.length<2)return s;if("polyline"===t.editGeometryOperations.data.type&&(0===n.index||n.index===i.vertices.length-1))return s;const{view:r}=this,a=(0,S.$D)(n.leftEdge.leftVertex.pos,r,t),c=(0,S.$D)(n.rightEdge.rightVertex.pos,r,t);return this._processCandidateProposal(a,c,e,t,s),s}_processCandidateProposal(e,t,s,n,i){if(!this.exceedsShortLineThreshold(e,t,n))return;const r=(0,v.l)(H,e,t,.5),o=.5*(0,v.d)(e,t),a=(0,V.c)();(0,T.xO)(a,s,r,o),a[2]=s[2];const c=(0,S.uc)(a),{spatialReference:h,pointer:d}=n,l=(0,x.Rs)(s,h,p.jG,this.view);if((0,m.Bb)(l,(0,x.Rs)(c,h,p.jG,this.view))<this.squaredProximityThreshold(d)){if(this.isVertical(e,c)||this.isVertical(c,t))return;i.push(new q({targetPoint:c,point1:e,point2:t,isDraped:"on-the-ground"===n.elevationInfo?.mode}))}}}const H=(0,M.a)();let W=class extends y.Z{constructor(e){super(e),this.updating=!1,this._snappers=new _.Z,this._domain=f.B.SELF}initialize(){this._snappers.push(new N(this.view,this.options),new b(this.view,this.options),new j(this.view,this.options),new O(this.view,this.options))}set options(e){this._set("options",e);for(const t of this._snappers)t.options=e}async fetchCandidates(e,t,s){if(!(t&this._domain&&this.options.effectiveSelfEnabled))return[];const n=[];for(const i of this._snappers.items)for(const t of i.snap(e,s))n.push(t);return(0,m.lQ)(e,n),n}};function $(e,t){return[new W({view:e,options:t}),new g.U({view:e,options:t,spatialReference:e.spatialReference})]}(0,n._)([(0,h.Cb)({readOnly:!0})],W.prototype,"updating",void 0),(0,n._)([(0,h.Cb)({constructOnly:!0})],W.prototype,"view",void 0),(0,n._)([(0,h.Cb)()],W.prototype,"options",null),W=(0,n._)([(0,d.j)("esri.views.interactive.snapping.SelfSnappingEngine")],W);var B=s(98173),Y=s(90609);class X extends C.j{constructor(e,t,s,n){super(e,new w.Bq(e,t.constraint,s.constraint),n,f.B.ALL),this.first=t,this.second=s}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new Y.w(this.targetPoint,this.isDraped,this.domain)]}}let J=class extends(i.Z.EventedMixin(r.r)){constructor(e){super(e),this.options=new B.Z,this.snappingEnginesFactory=$,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=U.MAIN}initialize(){this.handles.add([(0,c.YP)((()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:s,distance:n}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:s,distance:n}}),(()=>{this.doneSnapping(),this.emit("changed")}),c.Z_),(0,c.YP)((()=>this.options),(e=>{for(const t of this._engines)t.options=e}),c.Z_),(0,c.YP)((()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory})),(e=>{let{viewReady:t,snappingEnginesFactory:s}=e;return this._recreateEngines(t,s)}),c.tX)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some((e=>e.updating))}_recreateEngines(e,t){if(this._destroyEngines(),!e)return;const{view:s,options:n}=this;this._engines=t(s,n)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,s=e*t;return s*s}get _squaredSatisfiesConstraintThreshold(){return u.c.satisfiesConstraintScreenThreshold*u.c.satisfiesConstraintScreenThreshold}async snap(e){return function(e){return(0,o.pC)(e.scenePoint)}(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:s}=e;this._removeVisualization();const n=this._currentMainCandidate;if((0,o.Wi)(n))return t;const i=this._selectUpdateInput(e);if((0,o.Wi)(i))return t;const{spatialReference:r}=s,a=(0,l.iV)(i,r);if((0,o.Wi)(a))return t;const{view:c}=this,{elevationInfo:h,visualizer:d}=s,p=[],u=(0,S.dF)(a,c,s),f=n.constraint.closestTo(u);if(!this._arePointsWithinScreenThreshold(u,f,s))return this._resetSnappingState(),t;n.targetPoint=f,p.push(...n.hints);for(const o of this._currentOtherActiveCandidates)o.targetPoint=f,p.push(...o.hints);return(0,o.pC)(d)&&this.handles.add(d.draw(p,{spatialReference:r,elevationInfo:ee(s),view:c,selfSnappingZ:s.selfSnappingZ}),K),(0,S.Gs)(f,c,{z:t.z,m:t.m,spatialReference:t.spatialReference,elevationInfo:h})}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput(e){let{point:t,scenePoint:s}=e;switch(this._currentSnappedType){case U.MAIN:return t;case U.SCENE:return s}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=U.MAIN}_removeVisualization(){this.handles.remove(K)}async _snapSinglePoint(e){let{point:t,context:s,signal:n}=e;const{view:i}=this,r=(0,S.dF)(t,i,s),o=await this._fetchCandidates(r,f.B.ALL,s,n);return this._createSnapResult(r,U.MAIN,o,i,s,{z:t.z,m:t.m,spatialReference:t.spatialReference,elevationInfo:s.elevationInfo},n)}async _snapMultiPoint(e){let{point:t,scenePoint:s,context:n,signal:i}=e;const{view:r}=this,{coordinateHelper:o,spatialReference:a}=n;await(0,l.iQ)(s.spatialReference,a);const c=(0,l.iV)(s,a),h=(0,S.dF)(c,r,n),d=await this._fetchCandidates(h,f.B.FEATURE,n,i);if(d.length>0){const e=await this._fetchCandidates(h,f.B.SELF,n,i);return this._createSnapResult(h,U.SCENE,[...d,...e],r,n,{z:c.z,m:c.m,spatialReference:c.spatialReference,elevationInfo:n.elevationInfo},i)}const p=(0,S.dF)(t,r,n),u=await this._fetchCandidates(p,f.B.SELF,n,i);return this._createSnapResult(p,U.MAIN,u,r,n,{z:o.hasZ()&&t.hasZ?t.z??0:void 0,m:o.hasM()&&t.hasM?t.m??0:void 0,spatialReference:t.spatialReference,elevationInfo:n.elevationInfo},i)}async _fetchCandidates(e,t,s,n){return(await Promise.all(this._engines.map((i=>i.fetchCandidates(e,t,s,n))))).flat()}_createSnapResult(e,t,s,n,i,r,c){return{get valid(){return!(0,a.Hc)(c)},apply:()=>{const{spatialReference:a}=i,{snappedPoint:c,hints:h}=this._processCandidates(e,t,s,i);return this._removeVisualization(),(0,o.pC)(i.visualizer)&&this.handles.add(i.visualizer.draw(h,{spatialReference:a,elevationInfo:p.jG,view:n,selfSnappingZ:i.selfSnappingZ}),K),(0,S.Gs)(c,n,r)}}}_processCandidates(e,t,s,n){if(s.length<1)return this.doneSnapping(),{snappedPoint:e,hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),(0,m.lQ)(e,s);const i=this._currentMainCandidate;if((0,o.pC)(i)){const r=this._findOldConstraintInNewCandidates(i,s);if(r>=0){if(!(s[r]instanceof X))return this._intersectWithOtherCandidates(r,s,e,t,n);if(this._arePointsWithinScreenThreshold(e,i.targetPoint,n))return this._updateSnappingCandidate(i,t,s,n)}}return this._intersectWithOtherCandidates(0,s,e,t,n)}_findOldConstraintInNewCandidates(e,t){return e instanceof X?this._findOldCandidateIndex(t,e.first)>=0&&this._findOldCandidateIndex(t,e.second)>=0?0:-1:this._findOldCandidateIndex(t,e)}_intersectWithOtherCandidates(e,t,s,n,i){const{coordinateHelper:r}=i,o=t[e],a=[];for(let c=0;c<t.length;++c){if(c===e)continue;const n=t[c];for(const e of o.constraint.intersect(n.constraint)){const t=e.closestTo(o.targetPoint);a.push([new X(t,o,n,n.isDraped),this._squaredScreenDistance(s,t,r)])}}return a.length>0&&(a.sort(((e,t)=>e[1]-t[1])),a[0][1]<this._squaredPointProximityThreshold(i.pointer))?this._updateSnappingCandidate(a[0][0],n,t,i):this._updateSnappingCandidate(o,n,t,i)}_updateSnappingCandidate(e,t,s,n){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const i=this._currentMainCandidate.targetPoint,r=[];r.push(...e.hints);for(const o of s){if(e instanceof X){if(o.constraint.equals(e.first.constraint)||o.constraint.equals(e.second.constraint))continue}else if(o.constraint.equals(e.constraint))continue;const t=o.constraint.closestTo(i);this._squaredScreenDistance(t,i,n.coordinateHelper)<this._squaredSatisfiesConstraintThreshold&&(o.targetPoint=i,this._currentOtherActiveCandidates.push(o),r.push(...o.hints))}return{snappedPoint:i,hints:r}}_squaredPointProximityThreshold(e){return"touch"===e?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(e,t,s){return this._squaredScreenDistance(e,t,s.coordinateHelper)<this._squaredPointProximityThreshold(s.pointer)}_squaredScreenDistance(e,t,s){return(0,m.Bb)(this._toScreen(e,s),this._toScreen(t,s))}_toScreen(e,t){return(0,x.Rs)(e,t.spatialReference,p.jG,this.view)}_findOldCandidateIndex(e,t){let s=-1;for(let n=0;n<e.length;++n)if(t.constraint.equals(e[n].constraint)){s=n;break}return s}get test(){return{visualizationsActive:this.handles.has(K),engines:this._engines}}};var U,Q;(0,n._)([(0,h.Cb)({constructOnly:!0})],J.prototype,"view",void 0),(0,n._)([(0,h.Cb)()],J.prototype,"options",void 0),(0,n._)([(0,h.Cb)({readOnly:!0})],J.prototype,"updating",null),(0,n._)([(0,h.Cb)()],J.prototype,"snappingEnginesFactory",void 0),(0,n._)([(0,h.Cb)()],J.prototype,"_engines",void 0),(0,n._)([(0,h.Cb)()],J.prototype,"_squaredMouseProximityTreshold",null),(0,n._)([(0,h.Cb)()],J.prototype,"_squaredTouchProximityThreshold",null),(0,n._)([(0,h.Cb)()],J.prototype,"_squaredSatisfiesConstraintThreshold",null),J=(0,n._)([(0,d.j)("esri.views.interactive.snapping.SnappingManager")],J),(Q=U||(U={}))[Q.MAIN=0]="MAIN",Q[Q.SCENE=1]="SCENE";const K="visualization-handle";function ee(e){let{coordinateHelper:t,elevationInfo:s}=e;return t.hasZ()?p.jG:s}},98173:(e,t,s)=>{s.d(t,{Z:()=>l});var n=s(27366),i=s(85015),r=s(40281),o=s(49861),a=(s(25243),s(63780),s(69912)),c=s(22006),h=s(76014);let d=class extends i.Z{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new r.Z,this.distance=h.c.distance,this.touchSensitivityMultiplier=h.c.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};(0,n._)([(0,o.Cb)()],d.prototype,"enabled",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"enabledToggled",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"selfEnabled",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"featureEnabled",void 0),(0,n._)([(0,o.Cb)({type:r.Z.ofType(c.Z)})],d.prototype,"featureSources",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"distance",void 0),(0,n._)([(0,o.Cb)()],d.prototype,"touchSensitivityMultiplier",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],d.prototype,"effectiveEnabled",null),(0,n._)([(0,o.Cb)({readOnly:!0})],d.prototype,"effectiveSelfEnabled",null),(0,n._)([(0,o.Cb)({readOnly:!0})],d.prototype,"effectiveFeatureEnabled",null),d=(0,n._)([(0,a.j)("esri.views.interactive.snapping.SnappingOptions")],d);const l=d},97760:(e,t,s)=>{s.d(t,{k:()=>a});var n=s(95122),i=s(64674),r=s(75691),o=s(53397);class a extends r.a{constructor(e){super({...e,isDraped:!0,constraint:new n.M8(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new o.w(i.ze.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},95905:(e,t,s)=>{s.d(t,{L:()=>a});var n=s(95122),i=s(64674),r=s(75691),o=s(53397);class a extends r.a{constructor(e){super({...e,constraint:new n.ku(e.edgeStart,e.edgeEnd)})}get hints(){return[new o.w(i.ze.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}},75691:(e,t,s)=>{s.d(t,{a:()=>r});var n=s(80371),i=s(92605);class r extends i.j{constructor(e){let{targetPoint:t,objectId:s,constraint:i,isDraped:r}=e;super(t,i,r,n.B.FEATURE),this.objectId=s}}},19824:(e,t,s)=>{s.d(t,{A:()=>h,Y:()=>n});var n,i=s(80371),r=s(64674),o=s(92605),a=s(53397),c=s(41216);class h extends o.j{constructor(e){let{targetPoint:t,constraint:s,previousVertex:n,otherVertex:r,otherVertexType:o,objectId:a,isDraped:c}=e;super(t,s,c,i.B.SELF),this.previousVertex=n,this.otherVertex=r,this.otherVertexType=o,this.objectId=a}get hints(){const e=this.previousVertex,t=this.otherVertexType===n.CENTER?this.otherVertex:this.targetPoint,s=this.otherVertexType===n.CENTER?this.targetPoint:this.otherVertex;return[new a.w(r.ze.TARGET,t,s,this.isDraped,this.domain),new a.w(r.ze.REFERENCE,e,t,this.isDraped,this.domain),new c.y(this.previousVertex,t,s,this.isDraped,this.domain)]}}!function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"}(n||(n={}))},92605:(e,t,s)=>{s.d(t,{j:()=>n});class n{constructor(e,t,s,n){this.targetPoint=e,this.constraint=t,this.isDraped=s,this.domain=n}}},11208:(e,t,s)=>{s.d(t,{RS:()=>c,Rs:()=>h});var n=s(17842),i=(s(88396),s(11186)),r=s(71353),o=s(65618),a=s(74509);function c(e,t,s,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,r.c)();const c=(0,i.c)(l,e);return c[2]=(0,a.zx)(n,c,t,s)||0,n.renderCoordsHelper.toRenderCoords(c,t,o),o}function h(e,t,s,i){return"2d"===i.type?(d.x=e[0],d.y=e[1],d.spatialReference=t,i.toScreen(d)):(c(e,t,s,i,l),i.state.camera.projectToScreen(l,p),(0,n.vW)(p[0],p[1]))}const d=(0,o.Tx)(0,0,0,null),l=(0,r.c)(),p=((0,n.J$)(),(0,n.J$)(),(0,n.s1)())},55793:(e,t,s)=>{s.d(t,{CJ:()=>_,Ho:()=>w,Jk:()=>n,Lh:()=>v,SD:()=>d,Xi:()=>m,ZE:()=>y,fK:()=>l,hm:()=>p,pk:()=>S,qi:()=>u,sc:()=>g,z9:()=>f});var n,i=s(16889),r=s(88396),o=s(6394),a=s(11186),c=s(71353),h=s(94163);function d(e,t,s){let{start:i,end:a,type:c}=e;const h=[],d=(0,r.a)(C,a,i),l=(0,r.a)(P,i,t),p=(0,r.v)(d),u=2*(0,r.h)(d,l),f=u*u-4*p*((0,r.v)(l)-s*s);if(0===f){const e=-u/(2*p);(c===n.PLANE||e>=0)&&h.push((0,r.w)((0,o.a)(),i,d,e))}else if(f>0){const e=Math.sqrt(f),t=(-u+e)/(2*p);(c===n.PLANE||t>=0)&&h.push((0,r.w)((0,o.a)(),i,d,t));const s=(-u-e)/(2*p);(c===n.PLANE||s>=0)&&h.push((0,r.w)((0,o.a)(),i,d,s))}return h}function l(e,t){const s=e.start,i=e.end,o=(0,r.a)(C,i,s),d=(0,a.s)(P,-o[1],o[0],0),l=t.start,p=t.end,u=(0,a.w)(L,p,l),f=(0,a.e)(u,d),g=(0,a.s)(R,s[0],s[1],0),y=(0,a.w)(T,g,l),_=(0,a.e)(y,d);if(Math.abs(f)<w)return Math.abs(_),[];const v=(0,a.z)(b,l,u,_/f);if(t.type===h.SP.RAY){const e=(0,a.w)(M,v,l);if((0,a.e)(e,u)<-w)return[]}if(e.type===n.HALF_PLANE){const e=(0,r.e)(M,v,s);if((0,r.h)(e,o)<-w)return[]}return[(0,c.a)(v)]}function p(e,t){return S(x(V,t[2],e),t)}function u(e,t){const s=v(x(V,0,e),x(k,0,t)),n=[];for(const i of s)n.push((0,o.d)(i));return n}function f(e,t){return y(e,x(V,e[2],t))}function g(e,t,s){const n=(0,r.a)(C,e,t),i=s/(0,r.i)(n),o=(0,r.w)((0,c.c)(),t,n,i);return o[2]=e[2],o}function y(e,t){let{start:s,end:n,type:i}=t;const r=(0,a.w)(C,e,s),o=(0,a.w)(P,n,s),d=(0,a.e)(r,o)/(0,a.e)(o,o);return(0,a.z)((0,c.c)(),s,o,i===h.SP.RAY?Math.max(d,0):d)}function _(e,t,s){let{start:n,end:i,type:o}=e;const d=[],l=(0,a.b)(C,i,n),p=(0,r.a)(P,n,t),u=(0,r.v)(l),f=2*(0,r.h)(l,p),g=f*f-4*u*((0,r.v)(p)-s*s);if(0===g){const e=-f/(2*u);(o===h.SP.LINE||e>=0)&&d.push((0,a.z)((0,c.c)(),n,l,e))}else if(g>0){const e=Math.sqrt(g),t=(-f+e)/(2*u);(o===h.SP.LINE||t>=0)&&d.push((0,a.z)((0,c.c)(),n,l,t));const s=(-f-e)/(2*u);(o===h.SP.LINE||s>=0)&&d.push((0,a.z)((0,c.c)(),n,l,s))}return d}function v(e,t){const s=e.start,n=e.end,r=t.start,o=t.end,d=(0,a.w)(C,n,s),l=(0,a.w)(P,o,r),p=(0,a.w)(L,r,s),u=(0,a.f)(R,d,l),f=(0,a.e)(p,u);if(!(0,i.W8)(f,0,w))return[];const g=(0,a.D)(u);if((0,i.W8)(g,0,w))return[];const y=(0,a.f)(T,p,l),_=(0,a.e)(y,u)/g,v=(0,a.z)(b,s,d,_);if(e.type===h.SP.RAY){const e=(0,a.w)(M,v,s);if((0,a.e)(d,e)<-w)return[]}if(t.type===h.SP.RAY){const e=(0,a.w)(M,v,r);if((0,a.e)(l,e)<-w)return[]}return[(0,c.a)(v)]}function S(e,t){let{start:s,end:n,type:i}=e;const r=(0,a.w)(C,t,s),o=(0,a.w)(P,n,s),d=(0,a.f)(L,o,r);if((0,a.D)(d)/(0,a.D)(o)<w)switch(i){case h.SP.LINE:return[(0,c.a)(t)];case h.SP.RAY:return(0,a.e)(o,r)<-w?[]:[(0,c.a)(t)]}return[]}function m(e,t,s){return(0,i.W8)((0,r.k)(s,e),t*t,w)?[(0,c.a)(s)]:[]}function x(e,t,s){let{start:n,end:i,type:r}=s;return(0,a.s)(e.start,n[0],n[1],t),(0,a.s)(e.end,i[0],i[1],t),e.type=E[r],e}!function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"}(n||(n={}));const E={[n.PLANE]:h.SP.LINE,[n.HALF_PLANE]:h.SP.RAY},w=1e-6,C=(0,c.c)(),P=(0,c.c)(),L=(0,c.c)(),R=(0,c.c)(),T=(0,c.c)(),b=(0,c.c)(),M=(0,c.c)(),V={start:(0,c.c)(),end:(0,c.c)(),type:h.SP.LINE},k={start:(0,c.c)(),end:(0,c.c)(),type:h.SP.LINE}}}]);
//# sourceMappingURL=6165.00738264.chunk.js.map