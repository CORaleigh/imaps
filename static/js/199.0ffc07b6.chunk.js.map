{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/GraphicsSnappingSource.js","../node_modules/@arcgis/core/geometry/support/normalizeUtilsSync.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"],"names":["O","f","p","constructor","e","super","this","availability","sources","multipoint","point","polygon","polyline","loadedWkids","Set","loadedWkts","pendingAdds","updatingHandles","updating","layerSource","layer","destroy","length","t","task","abort","mapSources","destroySource","initialize","handles","add","on","onGraphicUpdate","addOnCollectionChange","graphics","onGraphicsChanged","addMany","toArray","r","s","a","queryEngine","executeQueryForSnapping","coordinateHelper","toPoint","d","toJSON","distance","types","query","filter","createQuery","where","then","candidates","flat","map","k","S","refresh","property","remove","graphic","removed","added","Map","o","geometry","needsInitializeProjection","spatialReference","push","set","uid","createPendingAdd","n","async","u","source","dest","signal","markLoadedSpatialReferences","addPromise","promise","i","wkid","wkt","visible","type","c","fromExtent","ensureSource","createOptimizedFeature","featureStore","has","h","m","j","y","g","b","createSource","l","w","geometryType","hasZ","hasM","v","fields","name","alias","objectIdField","scheduler","view","resourceController","removeFromSource","delete","size","removeById","constructOnly","prototype","readOnly","isWebMercator","I","maxX","minX","plus180Line","minus180Line","J","N","points","x","M","xmin","ymin","xmax","ymax","cut","valid","frameId","extent","frameIds","rings","Array","isArray","Math","ceil","abs","closed","minPts","paths","constraint","edgeStart","edgeEnd","start","end","targetPoint","fromPoint","target","objectId"],"mappings":"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","file":"static/js/199.0ffc07b6.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import\"../../../../core/has.js\";import{isSome as t,isNone as r}from\"../../../../core/maybe.js\";import\"../../../../core/Logger.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import\"../../../../core/urlUtils.js\";import\"../../../../core/uuid.js\";import\"../../../../portal/support/resourceExtension.js\";import{removeUnordered as i}from\"../../../../core/arrayUtils.js\";import{eachAlwaysValues as a,createTask as n}from\"../../../../core/promiseUtils.js\";import p from\"../../../../core/Accessor.js\";import d from\"../../../../geometry/Point.js\";import c from\"../../../../geometry/Polygon.js\";import{featureGeometryTypeKebabDictionary as l}from\"../../../../geometry/support/typeUtils.js\";import{initializeProjection as u,canProjectWithoutEngine as h,project as m}from\"../../../../geometry/projection.js\";import y from\"../../../../layers/graphics/OptimizedFeature.js\";import{convertFromGeometry as g}from\"../../../../layers/graphics/featureConversionUtils.js\";import{HandleOwnerMixin as f}from\"../../../../core/HandleOwner.js\";import{sortCandidatesInPlace as S}from\"../snappingUtils.js\";import{normalizeCentralMeridianSync as j}from\"../../../../geometry/support/normalizeUtilsSync.js\";import w from\"../../../../layers/graphics/data/FeatureStore.js\";import v from\"../../../../layers/graphics/data/QueryEngine.js\";import{convertSnappingCandidate as k}from\"./queryEngineUtils.js\";let O=class extends(f(p)){constructor(e){super(e),this.availability=1,this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){const e=this.pendingAdds;this.pendingAdds.length=0;for(const t of e)t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on(\"graphic-update\",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}async fetchCandidates(e,r){const s=(await a(this.mapSources((s=>s.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.toPoint(e.point,new d).toJSON(),distance:e.distance,types:e.types,query:t(e.filter)?e.filter.createQuery().toJSON():{where:\"1=1\"}},r).then((({candidates:e})=>e)))))).flat().map((t=>k(t,e.coordinateHelper)));return S(e.point,s),{candidates:s}}refresh(){}onGraphicUpdate(e){switch(e.property){case\"geometry\":case\"visible\":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(const t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){const t=[],s=new Map;for(const o of e)r(o.geometry)||(this.needsInitializeProjection(o.geometry.spatialReference)?(t.push(o.geometry.spatialReference),s.set(o.uid,o)):this.add(o));this.createPendingAdd(t,s)}createPendingAdd(e,t){if(!e.length)return;const r=n((async r=>{await u(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:r}),this.markLoadedSpatialReferences(e);for(const[,e]of t)this.add(e)}));this.updatingHandles.addPromise(r.promise);const s={task:r,graphics:t},o=()=>i(this.pendingAdds,s);r.promise.then(o,o),this.pendingAdds.push(s)}markLoadedSpatialReferences(e){for(const t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if(r(e.geometry)||!e.visible)return;let s=e.geometry;if(\"mesh\"===s.type)return;\"extent\"===s.type&&(s=c.fromExtent(s));const o=this.ensureSource(s.type);if(r(o))return;const i=this.createOptimizedFeature(e.uid,s);t(i)&&o.featureStore.add(i)}needsInitializeProjection(e){return(null==e.wkid||!this.loadedWkids.has(e.wkid))&&((null==e.wkt||!this.loadedWkts.has(e.wkt))&&!h(e,this.spatialReference))}createOptimizedFeature(e,t){const r=m(j(t),this.spatialReference);return r?new y(g(r,!1,!1),{[b]:e},null,e):null}ensureSource(e){const r=this.sources[e];if(t(r))return r;const s=this.createSource(e);return this.sources[e]=s,s}createSource(e){const r=l.toJSON(e),s=new w({geometryType:r,hasZ:!1,hasM:!1});return{featureStore:s,queryEngine:new v({featureStore:s,fields:[{name:b,type:\"esriFieldTypeOID\",alias:b}],geometryType:r,hasM:!1,hasZ:!1,objectIdField:b,spatialReference:this.spatialReference,scheduler:t(this.view)&&\"3d\"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){this.mapSources((t=>this.removeFromSource(t,e)));for(const t of this.pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){const r=t.uid;e.featureStore.has(r)&&e.featureStore.removeById(t.uid)}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){const{point:r,polygon:s,polyline:o,multipoint:i}=this.sources,a=[];return t(r)&&a.push(e(r)),t(s)&&a.push(e(s)),t(o)&&a.push(e(o)),t(i)&&a.push(e(i)),a}};e([s({constructOnly:!0})],O.prototype,\"spatialReference\",void 0),e([s({constructOnly:!0})],O.prototype,\"layerSource\",void 0),e([s({constructOnly:!0})],O.prototype,\"view\",void 0),e([s({readOnly:!0})],O.prototype,\"updating\",null),e([s({readOnly:!0})],O.prototype,\"availability\",void 0),O=e([o(\"esri.views.interactive.snapping.featureSources.GraphicsSnappingSource\")],O);const b=\"OBJECTID\";export{O as GraphicsSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{getInfo as n}from\"./spatialReferenceUtils.js\";import{extentIntersectsPolyline as t}from\"./intersects.js\";import{getBoundsXY as i}from\"./boundsUtils.js\";import{isPoint as m,isMultipoint as s,isExtent as e,isPolygon as x,isPolyline as o}from\"./jsonUtils.js\";import{create as r}from\"./aaBoundingRect.js\";import{cutParams as a,getGeometryParts as f,offsetMagnitude as c}from\"./normalizeUtilsCommon.js\";function l(r){if(!r)return null;if(\"mesh\"===r.type)return r.toJSON();let f=null;const l=r.spatialReference,h=n(l);if(!h)return r.toJSON();const d=l.isWebMercator?102100:4326,I=a[d].maxX,g=a[d].minX,b=a[d].plus180Line,v=a[d].minus180Line;let J;const N=r.toJSON();if(m(N))J=y(N,I,g);else if(s(N))N.points=N.points.map((n=>y(n,I,g))),J=N;else if(e(N))J=p(N,h);else if(x(N)||o(N)){const n=M;i(n,N);const m={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},s=c(m.xmin,g)*(2*I),e=0===s?N:u(N,s);m.xmin+=s,m.xmax+=s,t(m,b)&&m.xmax!==I||t(m,v)&&m.xmin!==g?f=e:J=e}else J=r.toJSON();if(null!==f){return(new j).cut(f,I)}return J}function u(n,t){const i=f(n);for(const m of i)for(const n of m)n[0]+=t;return n}function p(n,t){if(!t)return n;const i=h(n,t).map((n=>n.extent));return i.length<2?i[0]||n:i.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:i.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}function y(n,t,i){if(Array.isArray(n)){const m=n[0];if(m>t){const i=c(m,t);n[0]=m+i*(-2*t)}else if(m<i){const t=c(m,i);n[0]=m+t*(-2*i)}}else{const m=n.x;if(m>t){const i=c(m,t);n.x+=i*(-2*t)}else if(m<i){const t=c(m,i);n.x+=t*(-2*i)}}return n}function h(n,t){const i=[],{ymin:m,ymax:s}=n,e=n.xmax-n.xmin,x=n.xmin,o=n.xmax;let r;const[a,f]=t.valid;r=d(n.xmin,t);const c=r.x,l=r.frameId;r=d(n.xmax,t);const u=r.x,p=r.frameId,y=c===u&&e>0;if(e>2*f){const n={xmin:x<o?c:u,ymin:m,xmax:f,ymax:s},t={xmin:a,ymin:m,xmax:x<o?u:c,ymax:s},e={xmin:0,ymin:m,xmax:f,ymax:s},r={xmin:a,ymin:m,xmax:0,ymax:s},y=[],h=[];I(n,e)&&y.push(l),I(n,r)&&h.push(l),I(t,e)&&y.push(p),I(t,r)&&h.push(p);for(let i=l+1;i<p;i++)y.push(i),h.push(i);i.push({extent:n,frameIds:[l]},{extent:t,frameIds:[p]},{extent:e,frameIds:y},{extent:r,frameIds:h})}else c>u||y?i.push({extent:{xmin:c,ymin:m,xmax:f,ymax:s},frameIds:[l]},{extent:{xmin:a,ymin:m,xmax:u,ymax:s},frameIds:[p]}):i.push({extent:{xmin:c,ymin:m,xmax:u,ymax:s},frameIds:[l]});return i}function d(n,t){const[i,m]=t.valid,s=2*m;let e,x=0;return n>m?(e=Math.ceil(Math.abs(n-m)/s),n-=e*s,x=e):n<i&&(e=Math.ceil(Math.abs(n-i)/s),n+=e*s,x=-e),{x:n,frameId:x}}function I(n,t){const{xmin:i,ymin:m,xmax:s,ymax:e}=t;return g(n,i,m)&&g(n,i,e)&&g(n,s,e)&&g(n,s,m)}function g(n,t,i){return t>=n.xmin&&t<=n.xmax&&i>=n.ymin&&i<=n.ymax}class j{cut(n,t){let i;if(n.rings)this.closed=!0,i=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,i=n.paths,this.minPts=2}const m=i.length,s=-2*t;for(let e=0;e<m;e++){const n=i[e];if(n&&n.length>=this.minPts){const t=[];for(const i of n)t.push([i[0]+s,i[1]]);i.push(t)}}return this.closed?n.rings=i:n.paths=i,n}}const M=r();export{l as normalizeCentralMeridianSync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{LineSnappingHint as t}from\"../hints/LineSnappingHint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{LineConstraint as r}from\"../SnappingConstraint.js\";class e extends n{constructor(t){super({...t,constraint:new r(t.coordinateHelper,t.edgeStart,t.edgeEnd)})}get hints(){return[new t(1,this.constraint.start,this.constraint.end)]}}export{e as EdgeSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{PointSnappingHint as t}from\"../hints/PointSnappingHint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointConstraint as r}from\"../SnappingConstraint.js\";class i extends n{constructor(t){super({...t,constraint:new r(t.coordinateHelper,t.targetPoint)})}get hints(){return[new t(this.targetPoint)]}}export{i as VertexSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{EdgeSnappingCandidate as e}from\"../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as t}from\"../candidates/VertexSnappingCandidate.js\";function r(r,n){switch(r.type){case\"edge\":return new e({coordinateHelper:n,edgeStart:n.fromPoint(r.start),edgeEnd:n.fromPoint(r.end),targetPoint:n.fromPoint(r.target),objectId:r.objectId});case\"vertex\":return new t({coordinateHelper:n,targetPoint:n.fromPoint(r.target),objectId:r.objectId})}}export{r as convertSnappingCandidate};\n"],"sourceRoot":""}