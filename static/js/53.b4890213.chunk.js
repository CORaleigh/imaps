(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[53],{1055:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return u}));var n,r,a=i(33),s=i(35),o=i(246),c=i(354),l=i(298),h=i(296);function u(e){var t=new o.a;return t.extensions.add("GL_OES_standard_derivatives"),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),t.vertex.uniforms.add("proj","mat4").add("view","mat4"),t.varyings.add("vUV","vec2"),e.multipassTerrainEnabled&&t.varyings.add("depth","float"),t.vertex.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    void main(void) {\n      vUV = uv0;\n      ","\n      gl_Position = proj * view * vec4(position, 1.0);\n    }\n  "])),e.multipassTerrainEnabled?"depth = (view * vec4(position, 1.0)).z;":"")),e.multipassTerrainEnabled&&(t.fragment.include(l.a),t.include(h.b,e)),t.fragment.uniforms.add("size","vec2").add("color1","vec4").add("color2","vec4"),t.fragment.include(c.a),t.fragment.code.add(Object(s.a)(r||(r=Object(a.a)(["\n    void main() {\n      ","\n      vec2 uvScaled = vUV / (2.0 * size);\n\n      vec2 uv = fract(uvScaled - 0.25);\n      vec2 ab = clamp((abs(uv - 0.5) - 0.25) / fwidth(uvScaled), -0.5, 0.5);\n      float fade = smoothstep(0.25, 0.5, max(fwidth(uvScaled.x), fwidth(uvScaled.y)));\n      float t = mix(abs(ab.x + ab.y), 0.5, fade);\n\n      gl_FragColor = mix(color2, color1, t);\n      ","\n    }\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"",e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":"")),t}var d=Object.freeze({__proto__:null,build:u})},1056:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d}));var n=i(2),r=i(3),a=i(26),s=i(13),o=i(253),c=i(220),l=i(130),h=i(53),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(a.e)(),i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(a.e)();Object(n.a)(this,e),this.startRenderSpace=t,this.endRenderSpace=i,this.type="euclidean"}return Object(r.a)(e,[{key:"eval",value:function(e,t,i){return Object(s.h)(t,this.startRenderSpace,this.endRenderSpace,e),i&&(Object(s.i)(i,this.endRenderSpace,this.startRenderSpace),Object(s.q)(i,i)),t}},{key:"createRenderGeometry",value:function(e,t){var i=[],n=[],r=function(t,r){var a=b;Object(s.i)(a,t,e),i.push([a[0],a[1],a[2]]),n.push([r[0],r[1],r[2]])},a=t.worldUpAtPosition(this.eval(.5,p),h.d.get());return r(this.startRenderSpace,a),r(this.endRenderSpace,a),{points:i,normals:n}}}]),e}(),d=function(){function e(t,i,r){Object(n.a)(this,e),this.startRenderSpace=t,this.endRenderSpace=i,this.renderSpatialReference=r,this.type="geodesic",this._start=Object(a.e)(),this._end=Object(a.e)(),this._pcpf=Object(c.g)(r),this._project=Object(l.b)(r,this._pcpf),this._projectIn(t,this._start),this._projectIn(i,this._end)}return Object(r.a)(e,[{key:"_projectIn",value:function(e,t){this._project?Object(l.r)(e,this.renderSpatialReference,t,this._pcpf):Object(s.j)(t,e)}},{key:"eval",value:function(e,t,i){if(this._project)if(i){var n=b;Object(o.i)(this._start,this._end,e,t,n),Object(s.e)(m,t,n),Object(l.r)(t,this._pcpf,t,this.renderSpatialReference),Object(l.r)(m,this._pcpf,m,this.renderSpatialReference),Object(s.i)(i,m,t),Object(s.q)(i,i)}else Object(o.h)(this._start,this._end,e,t),Object(l.r)(t,this._pcpf,t,this.renderSpatialReference);else Object(s.h)(t,this._start,this._end,e),i&&(Object(s.i)(i,this._end,this._start),Object(s.q)(i,i));return t}},{key:"createRenderGeometry",value:function(e,t){for(var i=[],n=[],r=function(t,r){var a=m;Object(s.i)(a,t,e),i.push([a[0],a[1],a[2]]),n.push([r[0],r[1],r[2]])},a=0;a<128;++a){var o=a/127,c=p,l=b;this.eval(o,c),t.worldUpAtPosition(c,l),r(c,l)}return{points:i,normals:n}}}]),e}();var p=Object(a.e)(),b=Object(a.e)(),m=Object(a.e)()},1057:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return a})),i.d(t,"f",(function(){return s}));var n=i(554);function r(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"abbr";return Object(n.b)(e,t.toUnit(i).value,i,r,a)}function a(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";if("length"!==t.measure)throw new Error("quantity is not a length");return Object(n.h)(e,t.value,t.unit,i,r)}function s(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";if("length"!==t.measure)throw new Error("quantity is not a length");return Object(n.i)(e,t.value,t.unit,i,r)}function o(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";if("length"!==t.measure)throw new Error("quantity is not a length");return Object(n.e)(e,t.value,t.unit,i,r)}function c(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"abbr";if("length"!==t.measure)throw new Error("quantity is not a length");return Object(n.f)(e,t.value,t.unit,i,r)}function l(e){if("angle"!==e.measure)throw new Error("quantity is not an angle");return Object(n.a)(e.value,e.unit)}},1058:function(e,t,i){"use strict";var n=i(2),r=i(3),a=i(62),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(n.a)(this,e),this.spatialReference=t}return Object(r.a)(e,[{key:"spatialReference",get:function(){return this._spatialReference},set:function(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}},{key:"normalizeDistance",value:function(e){return e*this._metersPerDistanceUnit}},{key:"normalizeElevation",value:function(e){return e*this._metersPerElevationUnit}},{key:"normalizeArea",value:function(e){return e*this._squareMetersPerAreaUnit}},{key:"_updateNormalizationFactors",value:function(){this._metersPerDistanceUnit=Object(a.f)(this._spatialReference,1),this._metersPerElevationUnit=Object(a.f)(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}}]),e}();t.a=s},1078:function(e,t,i){"use strict";i.d(t,"a",(function(){return R})),i.d(t,"b",(function(){return D}));var n=i(2),r=i(3),a=i(4),s=i(5),o=i(6),c=i(37),l=i(26),h=i(13),u=i(49),d=i(34),p=i(449),b=i(941),m=i(0),v=(i(14),i(12),i(17),i(1)),g=i(8),_=(i(11),i(18),i(19),i(31)),f=(i(164),function e(t,i,n){for(var r=0,a=i.length;r<a;r++){var s=i[r];Array.isArray(s)?e(t,s,n):null!=s&&!1!==s&&("string"==typeof s&&(s={vnodeSelector:"",properties:void 0,children:void 0,text:s.toString(),domNode:null}),n.push(s))}});function O(e,t,i){if(Array.isArray(t))i=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");var n,r;return i&&1===i.length&&"string"==typeof i[0]?n=i[0]:i&&(f(e,i,r=[]),0===r.length&&(r=void 0)),{vnodeSelector:e,properties:t,children:r,text:""===n?void 0:n,domNode:null}}i(281);var j=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e)).startX=0,r.startY=0,r.endX=0,r.endY=0,r.width=1,r.color=[0,0,0,.5],r.visible=!0,r}return Object(r.a)(i,[{key:"startPosition",get:function(){return[this.startX,this.startY]},set:function(e){this._set("startX",e[0]),this._set("startY",e[1])}},{key:"endPosition",get:function(){return[this.endX,this.endY]},set:function(e){this._set("endX",e[0]),this._set("endY",e[1])}},{key:"strokeStyle",get:function(){var e=this.color;return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3],")")}},{key:"lineCap",get:function(){return"round"}},{key:"render",value:function(){var e=this.calculateCoordinates(y),t=e.height,i=e.left,n=e.top,r=e.width,a=e.x1,s=e.x2,o=e.y1,c=e.y2,l="stroke: ".concat(this.strokeStyle,"; stroke-width: ").concat(this.width,"; stroke-linecap: ").concat(this.lineCap,";");return O("div",{classes:{"esri-line-overlay-item":!0},styles:{left:i+"px",top:n+"px",width:r+"px",height:t+"px",visibility:this.visible?"visible":"hidden"}},[O("svg",{width:r,height:t},[O("line",{x1:a,y1:o,x2:s,y2:c,style:l})])])}},{key:"renderCanvas",value:function(e){if(this.visible){e.strokeStyle=this.strokeStyle,e.lineWidth=this.width,e.lineCap=this.lineCap;var t=this.calculateCoordinates(y);e.beginPath(),e.moveTo(t.left+t.x1,t.top+t.y1),e.lineTo(t.left+t.x2,t.top+t.y2),e.stroke()}}},{key:"calculateCoordinates",value:function(e){var t=Math.min(this.startX,this.endX),i=Math.max(this.startX,this.endX),n=Math.min(this.startY,this.endY),r=Math.max(this.startY,this.endY),a=this.width;return e.left=t-a,e.top=n-a,e.width=i-t+2*a,e.height=Math.max(20,r-n+2*a),e.x1=this.startX-t+a,e.y1=this.startY-n+a,e.x2=this.endX-t+a,e.y2=this.endY-n+a,e}}]),i}(_.a);Object(m.a)([Object(v.b)()],j.prototype,"startX",void 0),Object(m.a)([Object(v.b)()],j.prototype,"startY",void 0),Object(m.a)([Object(v.b)()],j.prototype,"endX",void 0),Object(m.a)([Object(v.b)()],j.prototype,"endY",void 0),Object(m.a)([Object(v.b)()],j.prototype,"startPosition",null),Object(m.a)([Object(v.b)()],j.prototype,"endPosition",null),Object(m.a)([Object(v.b)()],j.prototype,"width",void 0),Object(m.a)([Object(v.b)()],j.prototype,"color",void 0),Object(m.a)([Object(v.b)()],j.prototype,"visible",void 0),Object(m.a)([Object(v.b)({readOnly:!0})],j.prototype,"strokeStyle",null),j=Object(m.a)([Object(g.a)("esri.views.overlay.LineOverlayItem")],j);var y={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},w=j,L=i(29),k=i(15),x={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"},S=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e)).x=0,r.y=0,r.text="-",r.fontSize=14,r.anchor="center",r.visible=!0,r.backgroundColor="rgba(0, 0, 0, 0.6)",r.textColor="white",r.textShadowColor=[0,0,0],r.textShadowSize=1,r}return Object(r.a)(i,[{key:"position",get:function(){return[this.x,this.y]},set:function(e){this._set("x",e[0]),this._set("y",e[1])}},{key:"padding",get:function(){return.5*this.fontSize}},{key:"render",value:function(){return O("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 ".concat(this.textShadowSize,"px rgb(").concat(this.textShadowColor[0],", ").concat(this.textShadowColor[1],", ").concat(this.textShadowColor[2],")")}},[this.text])}},{key:"renderCanvas",value:function(e){if(this.visible){var t=e.font.replace(/^(.*?)px/,"");e.font="".concat(this.fontSize,"px ").concat(t);var i=this.padding,n=this.padding,r=e.measureText(this.text).width,a=this.fontSize,s=P[this.anchor];e.textAlign="center",e.textBaseline="middle";var o=r+2*i,c=a+2*i,l=this.x+s.x*o,h=this.y+s.y*c;this.roundedRect(e,l,h,o,c,n),e.fillStyle=this.backgroundColor,e.fill();var u=this.x+(s.x+.5)*o,d=this.y+(s.y+.5)*c;this._renderTextShadow(e,this.text,u,d),e.fillStyle=this.textColor,e.fillText(this.text,u,d)}}},{key:"_renderTextShadow",value:function(e,t,i,n){e.lineJoin="miter",e.fillStyle="rgba(".concat(this.textShadowColor[0],", ").concat(this.textShadowColor[1],", ").concat(this.textShadowColor[2],", ").concat(1/C.length,")");var r,a=this.textShadowSize,s=Object(k.a)(C);try{for(s.s();!(r=s.n()).done;){var o=Object(L.a)(r.value,2),c=o[0],l=o[1];e.fillText(t,i+a*c,n+a*l)}}catch(h){s.e(h)}finally{s.f()}}},{key:"roundedRect",value:function(e,t,i,n,r,a){e.beginPath(),e.moveTo(t,i+a),e.arcTo(t,i,t+a,i,a),e.lineTo(t+n-a,i),e.arcTo(t+n,i,t+n,i+a,a),e.lineTo(t+n,i+r-a),e.arcTo(t+n,i+r,t+n-a,i+r,a),e.lineTo(t+a,i+r),e.arcTo(t,i+r,t,i+r-a,a),e.closePath()}},{key:"_cssClasses",value:function(){var e={"esri-text-overlay-item":!0};for(var t in x)e[x[t]]=this.anchor===t;return e}}]),i}(_.a);Object(m.a)([Object(v.b)()],S.prototype,"x",void 0),Object(m.a)([Object(v.b)()],S.prototype,"y",void 0),Object(m.a)([Object(v.b)()],S.prototype,"position",null),Object(m.a)([Object(v.b)()],S.prototype,"text",void 0),Object(m.a)([Object(v.b)()],S.prototype,"fontSize",void 0),Object(m.a)([Object(v.b)()],S.prototype,"anchor",void 0),Object(m.a)([Object(v.b)()],S.prototype,"visible",void 0),Object(m.a)([Object(v.b)()],S.prototype,"padding",null),S=Object(m.a)([Object(g.a)("esri.views.overlay.TextOverlayItem")],S);for(var P={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},C=[],M=0;M<360;M+=22.5)C.push([Math.cos(Math.PI*M/180),Math.sin(Math.PI*M/180)]);var A=S,R=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e.view))._handles=new u.a,r._textItem=null,r._calloutItem=null,r._showCallout=!0,r._showText=!0,r._geometry=null,r._text=null,r._fontSize=14,r._distance=25,r._anchor="right",r.applyProps(e),r}return Object(r.a)(i,[{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this._updateLabelPosition()}},{key:"textItem",get:function(){return this._textItem}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this.attached&&(this._textItem.text=this._text)}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize=e,this.attached&&(this._textItem.fontSize=this._fontSize)}},{key:"distance",get:function(){return this._distance},set:function(e){this._distance!==e&&(this._distance=e,this._updateLabelPosition())}},{key:"anchor",get:function(){return this._anchor},set:function(e){this._anchor!==e&&(this._anchor=e,this._updateLabelPosition())}},{key:"overlaps",value:function(e){return this.textItem.visible&&e.textItem.visible&&this.view.overlay.overlaps(this._textItem,e.textItem)}},{key:"_updateLabelPosition",value:function(){if(this.attached){if(this._showText=!1,this._showCallout=!1,Object(o.k)(this.geometry)&&this.view._stage)switch(this.geometry.type){case"point":this._computeLabelPositionFromPoint(this.geometry,W)&&(this._textItem.position=[W[0],W[1]],this._textItem.anchor="center",this._showText=!0);break;case"corner":this._computeLabelPositionFromCorner(this.geometry,this._distance,W,H)&&(this._showCallout=this._updatePosition(W,H),this._showText=!0);break;case"segment":this._computeLabelPositionFromSegment(this.geometry,this._distance,this._anchor,W,H)&&(this._showText=!0,this._showCallout=this._updatePosition(W,H))}this.updateVisibility(this.visible)}}},{key:"_computeLabelPositionFromPoint",value:function(e,t){this.view.renderCoordsHelper.toRenderCoords(e,q);var i=this.view._stage.camera;return i.projectToRenderScreen(q,F),!(F[2]<0||F[2]>1)&&(i.renderToScreen(F,t),!0)}},{key:"_computeLabelPositionFromCorner",value:function(e,t,i,n){if(!e)return!1;var r=this.view._stage.camera;return T(e.left,1,r,G),Object(d.n)(G,G),T(e.right,0,r,U),Object(d.h)(E,G,U),Object(d.n)(E,E),Object(d.e)(E,E),r.projectToRenderScreen(e.left.endRenderSpace,F),!(F[2]<0||F[2]>1)&&(r.renderToScreen(F,i),Object(d.a)(E,E,t*r.pixelRatio),Object(d.h)(E,E,F),r.renderToScreen(E,n),!0)}},{key:"_computeLabelPositionFromSegment",value:function(e,t,i,n,r){if(!e)return!1;var a=e.segment,s=this.view._stage.camera;Object(b.e)(a.startRenderSpace,a.endRenderSpace,G,s),Object(d.r)(E,-G[1],G[0]);var o=!1;switch(i){case"top":o=E[1]<0;break;case"bottom":o=E[1]>0;break;case"left":o=E[0]>0;break;case"right":o=E[0]<0}if(o&&Object(d.n)(E,E),0===Object(d.l)(E))switch(i){case"top":E[1]=1;break;case"bottom":E[1]=-1;break;case"left":E[0]=-1;break;case"right":E[0]=1}return a.eval(J[e.sampleLocation],q),s.projectToRenderScreen(q,F),!(F[2]<0||F[2]>1)&&(s.renderToScreen(F,n),Object(d.a)(E,E,t*s.pixelRatio),Object(d.h)(E,E,F),s.renderToScreen(E,r),!0)}},{key:"_updatePosition",value:function(e,t){if(t){var i=t[0]-e[0],n=t[1]-e[1];return this._textItem.position=[t[0],t[1]],this._textItem.anchor=Math.abs(i)>Math.abs(n)?i>0?"left":"right":n>0?"top":"bottom",this._calloutItem.startPosition=[e[0],e[1]],this._calloutItem.endPosition=[t[0],t[1]],!0}return this._textItem.position=[e[0],e[1]],this._textItem.anchor="center",!1}},{key:"createResources",value:function(){var e=this;this._textItem=new A({visible:!0}),this._textItem.text=Object(o.q)(this._text),this._textItem.fontSize=this._fontSize,this._calloutItem=new w({visible:!0,width:2}),this._updateLabelPosition(),this.view.overlay.items.addMany([this._textItem,this._calloutItem]),this._handles.add(this.view.state.watch("camera",(function(){e._updateLabelPosition()})))}},{key:"destroyResources",value:function(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}},{key:"updateVisibility",value:function(e){this._textItem.visible=this._showText&&e,this._calloutItem.visible=this._showCallout&&e}}]),i}(p.a);function T(e,t,i,n){e.eval(t,V,z),Object(h.e)(I,V,z),i.projectToRenderScreen(V,B),i.projectToRenderScreen(I,Y),Object(d.d)(n,N,X),Object(d.e)(n,n)}function D(e){switch(e){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}var V=Object(l.e)(),I=Object(l.e)(),z=Object(l.e)(),G=Object(c.d)(),U=Object(c.d)(),E=Object(c.d)(),q=Object(l.e)(),F=Object(c.e)(),W=Object(c.g)(),H=Object(c.g)(),B=Object(c.e)(),X=B,Y=Object(c.e)(),N=Y,J={start:0,center:.5,end:1}},1234:function(e,t,i){"use strict";i.r(t);var n=i(2),r=i(3),a=i(4),s=i(5),o=i(0),c=(i(14),i(12)),l=(i(17),i(1)),h=i(27),u=i(8),d=(i(11),i(18),i(19),i(24)),p=i(62),b=(i(51),i(77)),m=i(64),v=i(9),g=i(60),_=i(49),f=i(25),O=i(561),j=i(940),y=i(545),w=i(6),L=i(37),k=i(26),x=i(13),S=i(82),P=i(110),C=i(274),M=i(1050),A=i(980),R=i(552),T=i(624),D=i(917),V=i(923),I=i(941),z=i(1078),G=i(1052),U=i(156),E=i(362),q=i(10),F=i(360),W=i(195),H=i(277),B=i(516),X=i(249),Y=i(252),N=i(66),J=i(251),K=i(247),Q=i(109),Z=i(223),$=i(154),ee=i(296),te=i(1055),ie=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(){return Object(n.a)(this,i),t.apply(this,arguments)}return Object(r.a)(i,[{key:"initializeProgram",value:function(e){var t=i.shader.get(),n=this.configuration,r=t.build({OITEnabled:0===n.transparencyPassType,multipassTerrainEnabled:n.multipassTerrainEnabled,cullAboveGround:n.cullAboveGround});return new K.a(e.rctx,r.generateSource("vertex"),r.generateSource("fragment"),J.a)}},{key:"bindPass",value:function(e,t,i){Z.a.bindProjectionMatrix(this.program,i.camera.projectionMatrix),this.program.setUniform2fv("size",t.size),this.program.setUniform4fv("color1",t.color1),this.program.setUniform4fv("color2",t.color2),i.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",i.camera.nearFar),this.program.setUniform2fv("inverseViewport",i.inverseViewport),Object(ee.a)(this.program,e,i))}},{key:"bindDraw",value:function(e){Z.a.bindView(this.program,e)}},{key:"setPipelineState",value:function(e){var t=this.configuration,i=3===e,n=2===e;return Object(Q.d)({blending:t.transparent?i?re:Object($.a)(e):null,depthTest:{func:Object($.b)(e)},depthWrite:i?t.writeDepth&&Q.c:Object($.c)(e),colorWrite:Q.b,polygonOffset:i||n?t.polygonOffset&&ne:{factor:-1,units:-25}})}},{key:"initializePipeline",value:function(){return this.setPipelineState(this.configuration.transparencyPassType)}}]),i}(Y.a);ie.shader=new X.a(te.a,(function(){return i.e(230).then(i.bind(null,1224))}));var ne={factor:0,units:-25},re=Object(Q.e)(770,1,771,771),ae=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).transparent=!1,e.writeDepth=!0,e.polygonOffset=!1,e.transparencyPassType=3,e.multipassTerrainEnabled=!1,e.cullAboveGround=!0,e}return i}(N.a);Object(o.a)([Object(N.b)()],ae.prototype,"transparent",void 0),Object(o.a)([Object(N.b)()],ae.prototype,"writeDepth",void 0),Object(o.a)([Object(N.b)()],ae.prototype,"polygonOffset",void 0),Object(o.a)([Object(N.b)({count:4})],ae.prototype,"transparencyPassType",void 0),Object(o.a)([Object(N.b)()],ae.prototype,"multipassTerrainEnabled",void 0),Object(o.a)([Object(N.b)()],ae.prototype,"cullAboveGround",void 0);var se=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e,ce)).techniqueConfig=new ae,r}return Object(r.a)(i,[{key:"dispose",value:function(){}},{key:"getPassParameters",value:function(){return this.params}},{key:"getTechniqueConfig",value:function(e){return this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.transparencyPassType=e?e.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!e&&e.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!e||e.cullAboveGround,this.techniqueConfig}},{key:"intersect",value:function(e,t,i,n,r,a,s){return Object(W.e)(e,t,n,r,a,void 0,s)}},{key:"getGLMaterial",value:function(e){return 0===e.output||7===e.output?new oe(e):void 0}},{key:"createBufferWriter",value:function(){return new B.a(B.d)}}]),i}(H.a),oe=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e)).updateParameters(),r}return Object(r.a)(i,[{key:"updateParameters",value:function(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(ie,this.material.getTechniqueConfig(e),this.technique)}},{key:"beginSlot",value:function(e){var t=3;return this.technique.configuration.transparent&&(t=this.technique.configuration.writeDepth?5:8),e===t}},{key:"ensureParameters",value:function(e){this.updateParameters(e)}},{key:"bind",value:function(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}}]),i}(F.a),ce=Object(q.a)({size:[1,1],color1:[.75,.75,.75,1],color2:[.5,.5,.5,1],transparent:!1,writeDepth:!0,polygonOffset:!1},H.b),le=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e))._checkerBoardMaterial=null,r._renderOccluded=4,r._geometry=null,r._size=[1,1],r._color1=[1,.5,0,.5],r._color2=[1,1,1,.5],r.applyProps(e),r}return Object(r.a)(i,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(e){e!==this._renderOccluded&&(this._renderOccluded=e,this.updateMaterial())}},{key:"geometry",get:function(){return this._geometry},set:function(e){this._geometry=e,this.geometryChanged()}},{key:"size",get:function(){return this._size},set:function(e){this._size=e,this.updateMaterial()}},{key:"color1",get:function(){return this._color1},set:function(e){this._color1=e,this.updateMaterial()}},{key:"color2",get:function(){return this._color2},set:function(e){this._color2=e,this.updateMaterial()}},{key:"updateMaterial",value:function(){Object(w.k)(this._checkerBoardMaterial)&&this._checkerBoardMaterial.setParameterValues({size:this._size,color1:this._color1,color2:this._color2,renderOccluded:this._renderOccluded})}},{key:"createExternalResources",value:function(){this._checkerBoardMaterial=new se({size:this._size,color1:this._color1,color2:this._color2,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:4})}},{key:"destroyExternalResources",value:function(){this._checkerBoardMaterial=null}},{key:"forEachExternalMaterial",value:function(e){Object(w.k)(this._checkerBoardMaterial)&&e(this._checkerBoardMaterial)}},{key:"createGeometries",value:function(e){if(!Object(w.j)(this._geometry)&&!Object(w.j)(this._checkerBoardMaterial)){var t=he;Object(S.m)(t,this.transform);var i=this._geometry,n=[],r=Object(k.e)();i.position.forEach((function(e){Object(x.i)(r,e,t),n.push(r[0],r[1],r[2])}));var a=[];i.uv.forEach((function(e){a.push(e[0],e[1])}));var s=new U.a([["position",{size:3,data:n,exclusive:!0}],["uv0",{size:2,data:a,exclusive:!0}]],[["position",i.triangleIndices],["uv0",i.triangleIndices]]);e.addGeometry(s,this._checkerBoardMaterial)}}},{key:"geometryChanged",value:function(){this.recreateGeometry()}}]),i}(E.a),he=Object(k.e)(),ue=i(1056),de={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:1,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,handleRadiusHovered:10,handleRadiusMouse:10,handleRadiusTouch:25,pathLineColor:[1,.5,0,1],pathLineWidth:3,intersectingLineColor:[1,.2,0,1],perimeterLineColor:[1,.5,0,1],perimeterLineWidth:2,projectionLineColor:[1,.5,0,1],projectionLineWidth:2,projectionLineStippleSize:5,areaColor1:[1,.5,0,.5],areaColor2:[1,1,1,.5],fillColor:[1,.5,0,.5],lineSubdivisions:64,labelDistance:25},pe=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new T.a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(n.a)(this,e),this._model=t,this._manipulators=i,this.vertexManipulators=[],this._visible=!1,this._path=null,this._intersectedPath=null,this._perimeter=null,this._intersectedPerimeter=null,this._projectionLines=null,this._laserLine=null,this._measurementArea=null,this._areaLabel=null,this._pathLengthLabel=null,this._cursorSegmentLengthLabel=null,this._perimeterLengthLabel=null,this._cursorManipulator=null,this._pathSegments=[],this._perimeterSegments=[],this._cursorSegment=null,this._listenerHandles=null,this._origin=Object(k.e)(),this._originTransform=Object(P.b)(),this._tempHandlePosition=Object(k.e)(),this._cursorPositionRenderSpace=Object(k.e)(),this._view=this._model.sceneView,this._params=Object(I.a)(de,r),this._intersector=new M.a(this._view.state.mode),this._intersector.options.store=0;var a=Object(V.e)(this._view,this._params.handleColor,this._params.handleOpacity);a.available=!1,a.radius=this._params.handleRadius,a.interactive=!1,this._manipulators.add(a),this._cursorManipulator=a,this._path=new G.a({view:this._view,attached:!0,width:this._params.pathLineWidth,color:this._params.pathLineColor,polygonOffset:!0,renderOccluded:4}),this._intersectedPath=new G.a({view:this._view,attached:!0,width:this._params.pathLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0,renderOccluded:4}),this._perimeter=new G.a({view:this._view,attached:!0,width:this._params.perimeterLineWidth,color:this._params.perimeterLineColor,polygonOffset:!0,renderOccluded:4}),this._intersectedPerimeter=new G.a({view:this._view,attached:!0,width:this._params.perimeterLineWidth,color:this._params.intersectingLineColor,polygonOffset:!0,renderOccluded:4}),this._projectionLines=new G.a({view:this._view,attached:!0,width:this._params.projectionLineWidth,color:this._params.projectionLineColor,stipplePattern:Object(A.c)(this._params.projectionLineStippleSize),stippleIntegerRepeats:!1,polygonOffset:!0,renderOccluded:4}),this._laserLine=new R.a({view:this._view,attached:!0,style:{glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,glowFalloff:this._params.laserLineGlowFalloff,innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,globalAlpha:this._params.laserLineGlobalAlpha}}),this._measurementArea=new le({view:this._view,attached:!0,color1:this._params.areaColor1,color2:this._params.areaColor2}),this._areaLabel=new z.a({view:this._view,attached:!0,fontSize:16}),this._pathLengthLabel=new z.a({view:this._view,attached:!0,fontSize:12}),this._cursorSegmentLengthLabel=new z.a({view:this._view,attached:!0,fontSize:12}),this._perimeterLengthLabel=new z.a({view:this._view,attached:!0,fontSize:12})}return Object(r.a)(e,[{key:"destroy",value:function(){this.hide(),this._laserLine.destroy(),this._laserLine=null,this._measurementArea.destroy(),this._measurementArea=null,this._path.destroy(),this._path=null,this._intersectedPath.destroy(),this._intersectedPath=null,this._perimeter.destroy(),this._perimeter=null,this._intersectedPerimeter.destroy(),this._intersectedPerimeter=null,this._areaLabel.destroy(),this._areaLabel=null,this._pathLengthLabel.destroy(),this._pathLengthLabel=null,this._cursorSegmentLengthLabel.destroy(),this._cursorSegmentLengthLabel=null,this._perimeterLengthLabel.destroy(),this._perimeterLengthLabel=null}},{key:"requiresCursorPoint",get:function(){return("initial"===this._model.state||"drawing"===this._model.state)&&this._model.active}},{key:"visible",get:function(){return this._visible},set:function(e){e?this.show():this.hide()}},{key:"testData",get:function(){var e=this._laserLine.testData;return{labels:{area:this._areaLabel,pathLength:this._pathLengthLabel,cursorSegmentLength:this._cursorSegmentLengthLabel,perimeterLength:this._perimeterLengthLabel},laserLineRenderer:Object(w.k)(e)?{heightManifoldEnabled:e.heightManifoldEnabled,heightManifoldTarget:e.heightManifoldTarget,pointDistanceEnabled:e.pointDistanceEnabled,pointDistanceOrigin:e.pointDistanceOrigin,pointDistanceTarget:e.pointDistanceTarget,lineVerticalPlaneEnabled:e.lineVerticalPlaneEnabled}:{heightManifoldEnabled:!1,heightManifoldTarget:null,pointDistanceEnabled:!1,pointDistanceOrigin:null,pointDistanceTarget:null,lineVerticalPlaneEnabled:!1}}}},{key:"show",value:function(){this._visible||(this._visible=!0,this._path.visible=!0,this._intersectedPath.visible=!0,this._perimeter.visible=!0,this._intersectedPerimeter.visible=!0,this._projectionLines.visible=!0,this._laserLine.visible=!0,this._measurementArea.visible=!0,this._areaLabel.visible=!0,this._pathLengthLabel.visible=!0,this._cursorSegmentLengthLabel.visible=!0,this._perimeterLengthLabel.visible=!0,this._initializeListeners(),this._updateAll(this._model.viewData))}},{key:"hide",value:function(){var e=this;this._visible&&(this._visible=!1,this._path.visible=!1,this._intersectedPath.visible=!1,this._perimeter.visible=!1,this._projectionLines.visible=!1,this._intersectedPerimeter.visible=!1,this._laserLine.visible=!1,this._measurementArea.visible=!1,this._areaLabel.visible=!1,this._pathLengthLabel.visible=!1,this._cursorSegmentLengthLabel.visible=!1,this._perimeterLengthLabel.visible=!1,this._destroyListeners(),this.vertexManipulators.forEach((function(t){e._removeVertexManipulator(t.manipulator)})),this.vertexManipulators=[],this._view.cursor=null)}},{key:"vertexHandleAt",value:function(e,t){var i=this._manipulators.intersect(e,t);return Object(w.k)(i)?i.manipulator.metadata:null}},{key:"manipulatorToVertex",value:function(e){return e.metadata}},{key:"pick",value:function(t){var i=this._view.spatialReference,n=Object(L.j)(t.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(n,this._intersector);var r=this._intersector.results.min,a=Object(k.e)();if(!r.getIntersectionPoint(a))return new e.PickResult;var s=this._view.renderCoordsHelper.fromRenderCoords(a,i);if(Object(w.j)(s))return new e.PickResult;var o="TerrainRenderer"===r.intersector?"surface":"feature";return new e.PickResult(o,a,s)}},{key:"overlappingHandles",value:function(e,t){return Object(I.c)(e,t,this._view)<=this._params.handleRadius}},{key:"screenToMap3D",value:function(){return Object(D.b)(this._view)}},{key:"_updateOrigin",value:function(e){Object(I.b)(e.positionsRenderCoords,this._origin),Object(S.i)(this._originTransform),Object(S.s)(this._originTransform,this._originTransform,this._origin),this._measurementArea.transform=this._originTransform,this._projectionLines.transform=this._originTransform}},{key:"_updateAll",value:function(e){this._visible&&(this._updateOrigin(e),this._updatePathSegments(e),this._updatePerimeterSegments(e),this._updateVertexManipulators(e),this._updateArea(e),this._updateProjectionLines(e),this._updateLabels(e),this._updateLaserLine())}},{key:"_createSegments",value:function(e,t){for(var i=e.path,n=this._view.renderCoordsHelper.spatialReference,r=this._model.measurementMode,a=[],s=[],o=[],c=e.validMeasurement?i.numVertices:i.numVertices-1,l=0;l<c;++l){var h=e[t][l],u=e[t][(l+1)%i.numVertices],d=null;switch(r){case"euclidean":d=new ue.a(h,u);break;case"geodesic":d=new ue.b(h,u,n)}e.intersectingSegments.has(l)?o.push(d):s.push(d),a.push(d)}return{all:a,nonIntersecting:s,intersecting:o}}},{key:"_updatePathSegments",value:function(e){var t=this._createSegments(e,"positionsRenderCoords"),i=e.path,n=this._view.renderCoordsHelper,r=n.spatialReference,a=this._model.measurementMode;if(this._cursorSegment=null,i.numVertices>0&&"drawing"===this._model.state&&Object(w.k)(this._model.cursorPoint)&&n.toRenderCoords(this._model.cursorPoint,this._cursorPositionRenderSpace)){var s=e.positionsRenderCoords[i.numVertices-1],o=this._cursorPositionRenderSpace,c=null;switch(a){case"euclidean":c=new ue.a(s,o);break;case"geodesic":c=new ue.b(s,o,r)}t.nonIntersecting.push(c),this._cursorSegment=c}this._path.setGeometryFromSegments(t.nonIntersecting,this._origin),this._intersectedPath.setGeometryFromSegments(t.intersecting,this._origin),this._pathSegments=t.all}},{key:"_updatePerimeterSegments",value:function(e){var t=this._createSegments(e,"positionsFittedRenderCoords");this._perimeter.setGeometryFromSegments(t.nonIntersecting,this._origin),this._intersectedPerimeter.setGeometryFromSegments(t.intersecting,this._origin),this._perimeterSegments=t.all}},{key:"_createVertexManipulator",value:function(){var e=Object(V.e)(this._view,this._params.handleColor,this._params.handleOpacity);return e.radius=this._params.handleRadius,{id:this._manipulators.add(e),manipulator:e}}},{key:"_removeVertexManipulator",value:function(e){this._manipulators.remove(e)}},{key:"_updateVertexManipulators",value:function(e){var t=this,i=this._model.path.vertices,n=this.vertexManipulators;Object(I.d)(n,i.length,(function(){return t._createVertexManipulator()}),(function(e){return t._removeVertexManipulator(e.manipulator)})),n.forEach((function(t,n){t.manipulator.metadata=i[n],t.manipulator.renderLocation=e.positionsRenderCoords[n]})),"drawing"===this._model.state&&Object(w.k)(this._model.cursorPoint)?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._model.cursorPoint):this._cursorManipulator.available=!1}},{key:"_updateArea",value:function(e){switch(this._model.measurementMode){case"euclidean":this._updateAreaEuclidean(e);break;case"geodesic":this._updateAreaGeodesic()}}},{key:"_updateAreaEuclidean",value:function(e){e.validMeasurement&&0===e.intersectingSegments.size&&e.triangleIndices?(this._measurementArea.geometry={uv:e.positionsProjected,position:e.positionsFittedRenderCoords,triangleIndices:e.triangleIndices},this._measurementArea.size=[e.checkerSize,e.checkerSize],this._measurementArea.visible=!0,this._perimeter.visible=!0,this._projectionLines.visible=!0):(this._measurementArea.visible=!1,this._perimeter.visible=!1,this._projectionLines.visible=!1)}},{key:"_updateAreaGeodesic",value:function(){this._measurementArea.visible=!1,this._perimeter.visible=!1,this._projectionLines.visible=!1}},{key:"_updateProjectionLines",value:function(e){var t=e.path;if(t.numVertices>0&&e.validMeasurement&&"euclidean"===this._model.measurementMode){for(var i=[],n=0;n<t.numVertices;++n){var r=Object(k.e)();Object(x.i)(r,this._model.viewData.positionsRenderCoords[n],this._origin);var a=Object(k.e)();Object(x.i)(a,this._model.viewData.positionsFittedRenderCoords[n],this._origin),i.push([r,a])}this._projectionLines.geometry=i}else this._projectionLines.geometry=null}},{key:"_updateLabels",value:function(e){if(this._visible){var t=this._model,i=this._view,n="drawing"===t.state;if(this._areaLabel.geometry=i.renderCoordsHelper.fromRenderCoords(e.areaCentroid,i.spatialReference),this._areaLabel.text=t.areaLabel,this._areaLabel.visible=e.validMeasurement&&0===e.intersectingSegments.size&&null!=t.areaLabel,e.pathLengthLabelSegmentIndex>=0&&e.pathLengthLabelSegmentIndex<this._pathSegments.length){var r=this._pathSegments[e.pathLengthLabelSegmentIndex],a=Object(w.k)(this._cursorSegment)?this._cursorSegment:be;this._pathLengthLabel.distance=this._params.labelDistance,this._pathLengthLabel.geometry={type:"corner",left:r,right:a},this._pathLengthLabel.text=t.pathLengthLabel,this._pathLengthLabel.visible=n&&t.path.numVertices>0}else this._pathLengthLabel.visible=!1;this._cursorSegmentLengthLabel.distance=this._params.labelDistance,this._cursorSegmentLengthLabel.geometry=Object(w.k)(this._cursorSegment)?{type:"segment",segment:this._cursorSegment,sampleLocation:"end"}:null,this._cursorSegmentLengthLabel.anchor="bottom",this._cursorSegmentLengthLabel.text=t.cursorSegmentLengthLabel,this._cursorSegmentLengthLabel.visible=n&&!!t.cursorSegmentLength&&0!==t.cursorSegmentLength.value,this._cursorSegmentLengthLabel.overlaps(this._pathLengthLabel)&&(this._cursorSegmentLengthLabel.visible=!1),this._pathLengthLabel.overlaps(this._areaLabel)&&(this._pathLengthLabel.visible=!1),this._updatePerimeterLabel(this._model.viewData)}}},{key:"_updatePerimeterLabel",value:function(e){var t=this._model,i="geodesic"===t.measurementMode;if(t.validMeasurement&&0===e.intersectingSegments.size){this._perimeterLengthLabel.distance=this._params.labelDistance,this._perimeterLengthLabel.anchor="top",this._perimeterLengthLabel.text=t.perimeterLengthLabel,this._perimeterLengthLabel.visible=!0;for(var n=!0,r=0;r<e.path.numVertices;++r){var a=(e.perimeterLengthLabelSegmentIndex+r)%e.path.numVertices,s=i?this._pathSegments[a]:this._perimeterSegments[a];if(n=!0,this._perimeterLengthLabel.geometry={type:"segment",segment:s,sampleLocation:"center"},!this._perimeterLengthLabel.overlaps(this._areaLabel))break;n=!1}this._perimeterLengthLabel.visible=n}else this._perimeterLengthLabel.visible=!1}},{key:"_getFocusPoint",value:function(){var e=this._model,t=this._model.lastDraggedVertex;switch(e.state){case"drawing":return Object(w.k)(e.cursorPoint)?e.cursorPoint:Object(w.k)(t)?e.path.getVertexPositionAsPoint(t):Object(w.q)(e.path.lastPoint);case"editing":return Object(w.k)(t)?e.path.getVertexPositionAsPoint(t):null;default:return e.cursorPoint}}},{key:"_updateLaserLine",value:function(){var e=this._model,t=this._params.laserLineEnabled&&"measured"!==e.state&&e.active,i=this._getFocusPoint();if(t&&Object(w.k)(i)){var n=this._tempHandlePosition;this._view.renderCoordsHelper.toRenderCoords(i,n),this._laserLine.heightManifoldTarget=n}else this._laserLine.heightManifoldTarget=null}},{key:"_initializeListeners",value:function(){var e=this;this._listenerHandles=new _.a,this._listenerHandles.add([this._model.watch(["state","lastDraggedVertex"],(function(){return e._updateLaserLine()})),this._model.watch(["cursorPoint","unit","measurementMode","active","viewData"],(function(){return e._updateAll(e._model.viewData)})),this._model.watch(["areaLabel","cursorSegmentLengthLabel","pathLengthLabel","perimeterLengthLabel"],(function(){e._updateAll(e._model.viewData)})),this._view.state.watch("camera",(function(){return e._updatePerimeterLabel(e._model.viewData)}))])}},{key:"_destroyListeners",value:function(){this._listenerHandles.destroy(),this._listenerHandles=null}}]),e}();pe._handleGeometry=C.a.createSphereGeometry(1,32,32),function(e){e.PickRequest=function e(){Object(n.a)(this,e)};e.PickResult=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(n.a)(this,e),this.type=t,this.scenePoint=i,this.mapPoint=r}}(pe||(pe={}));var be=new ue.a(Object(k.e)(),Object(k.e)()),me=pe,ve=i(87),ge=i(405),_e=i(331);function fe(e){return"mouse"!==e.pointerType||0===e.button}var Oe=function(){function e(t,i,r){Object(n.a)(this,e),this._manipulators=r,this._handles=new _.a,this._tempPickRequest=new me.PickRequest,this.model=t,this.view=i,this.model.reset(),this._setupManipulators()}return Object(r.a)(e,[{key:"destroy",value:function(){this._handles.destroy(),this._handles=null}},{key:"handleInputEvent",value:function(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"drag":this._handleDrag(e);break;case"key-down":this._handleKeyDown(e)}}},{key:"_setupManipulators",value:function(){var e=this,t=function(e){return"manipulator-".concat(e)},i=0,n=function(t){return function(n){return"start"===n.action&&(i++,e.model.lastDraggedVertex=Object(w.q)(e.view.manipulatorToVertex(t)),"measured"===e.model.state&&(e.model.state="editing")),n}},r=function(){return function(t){return"end"===t.action?(0===--i&&"editing"===e.model.state&&(e.model.state="measured"),null):t}},a=function(i,a){e._handles.add([Object(_e.e)(a,(function(t,i,a){var s=Object(D.a)(t),o=Object(w.q)(e.view.manipulatorToVertex(t));i.next(n(t)).next(s).next(r()).next(e.view.screenToMap3D()).next((function(i){t.location=i.mapEnd,e.model.path.setVertexPosition(o,Object(ge.a)(i.mapEnd))}));var c=Object(ge.a)(e.model.path.getVertexPositionAsPoint(o));a.next(s).next((function(){e.model.path.setVertexPosition(o,c),t.location=c}))})),a.events.on("double-click",(function(t){fe(t)&&("drawing"===e.model.state&&e.model.finishMeasurement(),t.stopPropagation())}))],t(i))},s=function(i){e._handles.remove(t(i))};this._manipulators.forEach((function(e){var t=e.id,i=e.manipulator;a(t,i)})),this._handles.add([this._manipulators.on("after-add",(function(e){var t=e.item,i=t.id,n=t.manipulator;a(i,n)})),this._manipulators.on("after-remove",(function(e){var t=e.item.id;s(t)}))])}},{key:"_handleDrag",value:function(e){"editing"===this.model.state&&e.stopPropagation()}},{key:"_handleImmediateClick",value:function(e){if(fe(e)){var t=Object(ve.a)(e);if(this.model.active)switch(this.model.state){case"initial":this._addVertexAt(t)&&(this.model.state="drawing",e.stopPropagation());break;case"drawing":var i=this.view.vertexHandleAt(t,e.pointerType);if(Object(w.j)(i)){if(this._addVertexAt(t))return}else 0===i.index&&(this.model.finishMeasurement(),e.stopPropagation())}"mouse"===e.pointerType&&this._hoverAt(t)}}},{key:"_handlePointerMove",value:function(e){if("mouse"===e.pointerType){var t=Object(ve.a)(e);this._hoverAt(t)}}},{key:"_handleKeyDown",value:function(e){"Enter"===e.key&&"drawing"===this.model.state&&(this.model.finishMeasurement(),e.stopPropagation())}},{key:"_hoverAt",value:function(e){if(this.view.requiresCursorPoint){var t=this._pick(e);t.mapPoint&&(this.model.cursorPoint=t.mapPoint)}else this.model.cursorPoint=null}},{key:"_addVertexAt",value:function(e){var t=this._pick(e);return!!t.mapPoint&&(this.model.path.add(t.mapPoint),!0)}},{key:"_pick",value:function(e){var t=this._tempPickRequest;return t.screenPoint=e,this.view.pick(t)}}]),e}(),je=i(7),ye=i.n(je),we=i(16),Le=i(31),ke=i(88),xe=i(46),Se=i(132),Pe=(i(127),i(220)),Ce=i(130),Me=i(982),Ae=i(1057),Re=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments)).result=null,e}return Object(r.a)(i,[{key:"destroy",value:function(){this.result=null}},{key:"geometry",set:function(e){this.result=null,this._set("geometry",Object(w.k)(e)?e.clone():null)}}]),i}(Le.a);Object(o.a)([Object(l.b)({value:null})],Re.prototype,"geometry",null),Object(o.a)([Object(l.b)()],Re.prototype,"result",void 0),Re=Object(o.a)([Object(u.a)("esri.views.3d.interactive.graphics.AreaMeasurement3D")],Re);var Te,De,Ve=i(43),Ie=(i(78),i(70)),ze=i(381),Ge=i(126),Ue=i(615),Ee=function(){function e(t,i,r){Object(n.a)(this,e),this.editGeometry=t,this.vertex=i,this.pos=r}return Object(r.a)(e,[{key:"apply",value:function(){var e="redo";Object(w.j)(this.originalPosition)&&(e="apply",this.originalPosition=this.vertex.pos),this._apply(e)}},{key:"undo",value:function(){this.vertex.pos=Object(w.q)(this.originalPosition);var e={updatedVertices:[this.vertex],operation:"undo"};this.editGeometry.emit("change",e)}},{key:"accumulate",value:function(t){return t instanceof e&&t.vertex===this.vertex&&(this.pos=t.pos,this._apply("apply"),!0)}},{key:"_apply",value:function(e){this.vertex.pos=this.pos,this.editGeometry.components.forEach((function(e){return e.unnormalizeVertexPositions()}));var t={updatedVertices:[this.vertex],operation:e};this.editGeometry.emit("change",t)}}]),e}(),qe=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.call(this))._handles=new _.a,e._dirty=!0,e._model=null,e._view=null,e._version=0,e._internalGeometryChange=!1,e}return Object(r.a)(i,[{key:"model",get:function(){return this._model},set:function(e){this._model=e,Object(w.k)(this._model)&&Object(w.k)(this._view)&&this._initialize(this._model,this._view)}},{key:"view",get:function(){return this._view},set:function(e){this._view=e,Object(w.k)(this._model)&&Object(w.k)(this._view)&&this._initialize(this._model,this._view)}},{key:"initialized",get:function(){return Object(w.k)(this._model)&&Object(w.k)(this._view)}},{key:"version",get:function(){return this._version}},{key:"_initialize",value:function(e,t){var i=this;this._handles.removeAll(),this._handles.add(Object(f.a)(e,"geometry",(function(){return i._updateEditGeometryFromModelGeometry(e,t)}),!0))}},{key:"_updateEditGeometryFromModelGeometry",value:function(e,t){var i=this;this._version++,this._internalGeometryChange||(this._handles.remove("EditGeometry"),this._editGeometry=Object(w.k)(e.geometry)?Ge.c.fromGeometry(e.geometry,t.viewingMode):new Ge.c(Object(ze.a)(!0,!1,t.spatialReference,t.viewingMode)),this.emit("clear",{type:"clear"}),this._handles.add(this._editGeometry.on("change",(function(t){i._internalGeometryChange=!0,e.geometry=i.numVertices>0?i._editGeometry.toPolygon():null,i._internalGeometryChange=!1})),"EditGeometry"))}},{key:"vertices",get:function(){var e=[];return this.forEachVertex((function(t){e.push(t)})),e}},{key:"numVertices",get:function(){return this.initialized&&this._editGeometry.components.length>0?this._editGeometry.components[0].vertices.length:0}},{key:"lastPoint",get:function(){if(this.initialized&&this._editGeometry.components.length>0){var e=this._editGeometry.components[0].getLastVertex();if(Object(w.k)(e))return this._editGeometry.coordinateHelper.createPoint(e.pos)}return null}},{key:"getVertex",value:function(e){if(!this.initialized||0===this._editGeometry.components.length||0===this._editGeometry.components[0].vertices.length)return null;var t=this._editGeometry.components[0].vertices[0],i=t;do{if(i.index===e)return i;i=i.right.right}while(i!==t&&null!=i);return null}},{key:"getVertexPositionAsPoint",value:function(e){return this._editGeometry.coordinateHelper.createPoint(e.pos)}},{key:"getVertexPositionAsPointFromIndex",value:function(e){return this._editGeometry.coordinateHelper.createPoint(this.getVertex(e).pos)}},{key:"forEachVertex",value:function(e){this.initialized&&this._editGeometry.components.length>0&&this._editGeometry.components[0].iterateVertices(e)}},{key:"forEachVertexPosition",value:function(e){var t=this._editGeometry.coordinateHelper;this.forEachVertex((function(i,n){t.toPoint(i.pos,Fe),e(Fe,n)}))}},{key:"clear",value:function(){Object(w.k)(this.model)&&(this.model.geometry=null)}},{key:"add",value:function(e){if(!this.initialized)return null;0===this._editGeometry.components.length&&this._editGeometry.components.push(new Ge.a(this._editGeometry));var t=new Ue.a(this._editGeometry,this._editGeometry.components[0],this._editGeometry.coordinateHelper.fromPoint(e));return this._editGeometry.apply(t),this.emit("vertex-update",{type:"vertex-update"}),t}},{key:"ensureContains",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!1;if(this._editGeometry.components.forEach((function(t){t.iterateVertices((function(t){t===e&&(i=!0)}))})),!i)throw new Error("vertex doesnt exist ".concat(t));return i}},{key:"setVertexPosition",value:function(e,t){if(!this.initialized)return null;var i=new Ee(this._editGeometry,e,this._editGeometry.coordinateHelper.fromPoint(t));return this._editGeometry.apply(i),this.emit("vertex-update",{type:"vertex-update"}),i}}]),i}(Ie.a),Fe=new Ve.a,We=i(44),He=i(95),Be=i(253),Xe=i(364),Ye=i(404);(De=Te||(Te={})).boundingSphere=function(e,t){var i=t.center;Object(x.v)(i,0,0,0);for(var n=0;n<e.length;++n)Object(x.e)(i,i,e[n]);Object(x.d)(i,i,1/e.length);for(var r=0,a=0;a<e.length;++a)r=Math.max(r,Object(x.k)(i,e[a]));t.radius=Math.sqrt(r)},De.bestFitPlane=function(e,t){if(e.length<3)throw new Error("need at least 3 points to fit a plane");Object(Be.g)(e[0],e[1],e[2],t)},De.planePointDistance=function(e,t){return Object(x.g)(e,t)+e[3]},De.segmentLengthEuclidean=function(e,t,i){return Object(Ce.o)(e,Ne,i)&&Object(Ce.o)(t,Je,i)?Object(x.n)(Ne,Je):0},De.segmentLengthGeodesic=function(e,t){if(!Object(Ce.p)(e,Ne)||!Object(Ce.p)(t,Je))return 0;var i={distance:null};return Object(Xe.f)(i,[Ne[0],Ne[1]],[Je[0],Je[1]]),i.distance},De.segmentLengthGeodesicVector=function(e,t,i){var n={distance:null};return Object(Xe.f)(n,[e[0],e[1]],[t[0],t[1]],i),n.distance},De.triangleAreaEuclidean=function(e,t,i){var n=t[0]-e[0],r=t[1]-e[1],a=i[0]-e[0],s=i[1]-e[1];return.5*Math.abs(n*s-r*a)},De.triangleAreaGeodesic=function(e,t,i,n){var r=Qe;return Object(Ce.s)(e,n,Ne)&&Object(Ce.s)(t,n,Je)&&Object(Ce.s)(i,n,Ke)?(r.setPoint(0,0,Ne),r.setPoint(0,1,Je),r.setPoint(0,2,Ke),Math.abs(Object(Ye.geodesicArea)(r,"square-meters"))):0},De.tangentFrame=function(e,t,i){Math.abs(e[0])>Math.abs(e[1])?Object(x.v)(t,0,1,0):Object(x.v)(t,1,0,0),Object(x.f)(i,e,t),Object(x.q)(t,t),Object(x.f)(t,i,e),Object(x.q)(i,i)},De.fitHemisphere=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=1e-6,r=function(e,t){if(0===t[0]&&0===t[1]&&0===t[2])return!1;for(var i=0;i<e.length;++i)if(Object(x.g)(t,e[i])<-n)return!1;return!0};if(0===e.length)return!1;if(1===e.length)return t&&Object(x.j)(t,e[0]),!0;Object(x.v)(Ze,0,0,0);for(var a=0;a<e.length;++a)Object(x.e)(Ze,Ze,e[a]);if(Object(x.q)(Ze,Ze),r(e,Ze))return t&&Object(x.j)(t,Ze),!0;if(!i)return!1;for(var s=0;s<e.length;++s)for(var o=0;o<e.length;++o)if(s!==o&&(Object(x.f)(Ze,e[s],e[o]),Object(x.q)(Ze,Ze),r(e,Ze)))return t&&Object(x.j)(t,Ze),!0;return!1},De.compareSets=function(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(var i=0;i<e.size;++i)if(!t.has(e[i]))return!1;return!0};var Ne=Object(k.e)(),Je=Object(k.e)(),Ke=Object(k.e)(),Qe=new He.a({rings:[[Ne,Je,Ke]],spatialReference:We.a.WGS84}),Ze=Object(k.e)(),$e=Te,et=i(432),tt=i(58),it=i(92),nt=i(889),rt=i(34);function at(e,t){for(var i=new Float64Array(e.length*t),n=0;n<e.length;++n)for(var r=e[n],a=0;a<t;++a)i[n*t+a]=r[a];return i}var st=function(){function e(){Object(n.a)(this,e),this.positionsWorldCoords=[],this.positionsRenderCoords=[],this.positionsProjectedWorldCoords=[],this.positionsFittedRenderCoords=[],this.positionsGeographic=[],this.positionsSpherical=[],this.positionsStereographic=[],this.pathSegmentLengths=[],this.geodesicPathSegmentLengths=[],this.perimeterSegmentLengths=[],this.intersectingSegments=new Set,this.geodesicIntersectingSegments=new Set,this.areaCentroidWorldCoords=Object(k.e)(),this.areaCentroidRenderCoords=Object(k.e)(),this.geodesicAreaCentroidRenderCoords=Object(k.e)(),this._length=0,this._centroidRenderCoords=Object(k.e)(),this._planeWorldCoords=Object(it.c)(),this._worldUp=Object(k.e)(),this._worldTangent=Object(k.e)(),this._frame=[Object(k.e)(),Object(k.e)(),Object(k.e)()],this._pathVersion=-1,this._validMeasurement=!1,this._tempU=Object(k.e)(),this._tempV=Object(k.e)(),this._tempVec3=Object(k.e)(),this._tempSphere={center:Object(k.e)(),radius:0}}return Object(r.a)(e,[{key:"update",value:function(e,t,i,n,r,a,s){if(this._pathVersion!==e.version||this._validMeasurement!==n){this._pathVersion=e.version,this._validMeasurement=n;var o=e.numVertices;this._resize(o);var c=Object(Pe.g)(t.spatialReference),l=Object(Ce.b)(t.spatialReference,c)&&Object(Ce.a)(t.spatialReference),h=this.positionsGeographic,u=this.positionsWorldCoords,d=this.positionsRenderCoords,p=this.positionsSpherical;e.forEachVertexPosition((function(e,t){Object(Ce.o)(e,u[t],a),Object(Ce.o)(e,d[t],r),l&&(Object(Ce.p)(e,h[t]),Object(Ce.o)(e,p[t],c),Object(x.q)(p[t],p[t]))}));var b=this._updatePathLengths(n);if(this.pathLength=this._length>0?new Me.a(i.normalizeDistance(b),"meters"):null,l){var m=this._updateGeodesicPathLengths(n,a);this.geodesicPathLength=this._length>0?new Me.a(m,"meters"):null}else this.geodesicPathLength=null;if(!n)return this.area=null,this.geodesicArea=null,this.perimeterLength=null,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.intersectingSegments.clear(),void this.geodesicIntersectingSegments.clear();this._updateArea(t,i,r,a,s),l&&this._updateGeodesicArea(t)}}},{key:"_resize",value:function(e){for(e<this._length&&(this.positionsWorldCoords.length=e,this.positionsRenderCoords.length=e,this.positionsProjectedWorldCoords.length=e,this.positionsFittedRenderCoords.length=e,this.positionsGeographic.length=e,this.positionsSpherical.length=e,this.positionsStereographic.length=e,this.pathSegmentLengths.length=e,this.geodesicPathSegmentLengths.length=e,this.perimeterSegmentLengths.length=e,this._length=e);this._length<e;)this.positionsWorldCoords.push(Object(k.e)()),this.positionsRenderCoords.push(Object(k.e)()),this.positionsProjectedWorldCoords.push(Object(tt.a)()),this.positionsFittedRenderCoords.push(Object(k.e)()),this.positionsGeographic.push(Object(k.e)()),this.positionsSpherical.push(Object(k.e)()),this.positionsStereographic.push(Object(tt.a)()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),this.perimeterSegmentLengths.push(0),++this._length}},{key:"_updatePathLengths",value:function(e){for(var t=this.positionsWorldCoords,i=this.pathSegmentLengths,n=0,r=0;r<this._length;++r){var a=i[r]=Object(x.n)(t[r],t[(r+1)%this._length]);(r<this._length-1||e)&&(n+=a)}return n}},{key:"_updateGeodesicPathLengths",value:function(e,t){for(var i=this.positionsGeographic,n=this.geodesicPathSegmentLengths,r=0,a=0;a<this._length;++a){var s=n[a]=$e.segmentLengthGeodesicVector(i[a],i[(a+1)%this._length],t);(a<this._length-1||e)&&(r+=s)}return r}},{key:"_updateArea",value:function(e,t,i,n,r){var a=e.renderCoordsHelper,s=this.positionsWorldCoords,o=this.positionsRenderCoords,c=this.positionsProjectedWorldCoords,l=this.positionsFittedRenderCoords,h=this._planeWorldCoords,u=this._centroidRenderCoords;Object(I.b)(o,u),a.worldUpAtPosition(u,this._worldUp),a.worldBasisAtPosition(u,0,this._worldTangent),Object(Ce.l)(u,this._worldUp,i,this._worldUp,n),Object(Ce.l)(u,this._worldTangent,i,this._worldTangent,n),s.length>2&&$e.bestFitPlane(s,h),this.fittingMode=this._selectFittingMode(h,s,this._worldUp,r);var d=0;if("horizontal"===this.fittingMode){var p=-1/0;o.forEach((function(e,t){var i=a.getAltitude(o[t]);i>p&&(p=i,d=t)}))}var b=s[d],m=h,v=this._worldTangent;"horizontal"===this.fittingMode?m=this._worldUp:"vertical"===this.fittingMode&&(m=this._tempVec3,v=this._worldUp,Object(Be.e)(h,this._worldUp,m)),Object(x.j)(this._frame[2],m),Object(Be.e)(v,m,this._frame[0]),Object(x.f)(this._frame[1],this._frame[0],this._frame[2]),Object(x.s)(this._frame[1],this._frame[1]);for(var g=this._tempVec3,_=this._tempU,f=this._tempV,O=0;O<this._length;++O){var j=c[O],y=l[O];Object(x.i)(g,s[O],b),Object(rt.r)(j,Object(x.g)(this._frame[0],g),Object(x.g)(this._frame[1],g)),Object(x.d)(_,this._frame[0],j[0]),Object(x.d)(f,this._frame[1],j[1]),Object(x.e)(g,_,f),Object(x.e)(g,g,b),Object(Ce.r)(g,n,y,i)}this.perimeterLength=this._length>0?new Me.a(t.normalizeDistance(this._updatePerimeterLengths()),"meters"):null,Object(I.b)(l,this.areaCentroidRenderCoords),Object(Ce.r)(this.areaCentroidRenderCoords,i,this.areaCentroidWorldCoords,n),this._updateIntersectingSegments(),this.area=0===this.intersectingSegments.size?new Me.a(t.normalizeArea(this._computeArea()),"square-meters"):null}},{key:"_updateGeodesicArea",value:function(e){var t=e.renderCoordsHelper,i=this.positionsSpherical,n=this.positionsStereographic,r=this._tempVec3,a=$e.fitHemisphere(i,r);if(a){var s=this._tempU,o=this._tempV;Object(Be.j)(r,s,o);for(var c=0;c<this._length;++c){var l=Object(x.g)(i[c],s),h=Object(x.g)(i[c],o),u=Object(x.g)(i[c],r);Object(rt.r)(n[c],l/u,h/u)}Object(x.d)(r,r,Object(Pe.e)(e.spatialReference).radius),t.toRenderCoords(r,Object(Pe.g)(e.spatialReference),this.geodesicAreaCentroidRenderCoords),this._updateGeodesicIntersectingSegments(),this.geodesicArea=a&&0===this.geodesicIntersectingSegments.size?new Me.a(this._computeGeodesicArea(),"square-meters"):null}else this.geodesicArea=null}},{key:"_updatePerimeterLengths",value:function(){for(var e=this.positionsProjectedWorldCoords,t=this.perimeterSegmentLengths,i=0,n=0;n<this._length;++n)i+=t[n]=Object(rt.i)(e[n],e[(n+1)%this._length]);return i}},{key:"_updateIntersectingSegments",value:function(){var e=this.positionsProjectedWorldCoords,t=this.intersectingSegments;t.clear();for(var i=0;i<this._length;++i)for(var n=i+2;n<this._length;++n)if((n+1)%this._length!==i){var r=e[i],a=e[(i+1)%this._length],s=e[n],o=e[(n+1)%this._length];Object(et.d)(r,a,s,o)&&(t.add(i),t.add(n))}}},{key:"_computeArea",value:function(){for(var e=this.positionsProjectedWorldCoords,t=at(e,2),i=this.triangleIndices=new Uint32Array(Object(nt.b)(t,[],2)),n=0,r=0;r<i.length;r+=3)n+=$e.triangleAreaEuclidean(e[i[r]],e[i[r+1]],e[i[r+2]]);return n}},{key:"_updateGeodesicIntersectingSegments",value:function(){var e=this.positionsStereographic,t=this.geodesicIntersectingSegments;t.clear();for(var i=0;i<this._length;++i)for(var n=i+2;n<this._length;++n)if((n+1)%this._length!==i){var r=e[i],a=e[(i+1)%this._length],s=e[n],o=e[(n+1)%this._length];Object(et.d)(r,a,s,o)&&(t.add(i),t.add(n))}}},{key:"_computeGeodesicArea",value:function(){for(var e=this.positionsGeographic,t=at(this.positionsStereographic,2),i=this.geodesicTriangleIndices=new Uint32Array(Object(nt.b)(t,[],2)),n=0,r=0;r<i.length;r+=3)n+=$e.triangleAreaGeodesic(e[i[r]],e[i[r+1]],e[i[r+2]],We.a.WGS84);return n}},{key:"_selectFittingMode",value:function(e,t,i,n){var r=t.map((function(t){return Math.abs($e.planePointDistance(e,t))})).reduce((function(e,t){return Math.max(e,t)}),0);$e.boundingSphere(t,this._tempSphere);var a=r/(2*this._tempSphere.radius),s=a<n.maxRelativeErrorCoplanar,o=a<n.maxRelativeErrorAlmostCoplanar,c="horizontal";return s?c="oblique":o&&(c=Math.abs(Object(x.g)(i,e))>Math.cos(Object(xe.f)(n.verticalAngleThreshold))?"horizontal":"vertical"),c}}]),e}(),ot=i(1058),ct=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(){var e;return Object(n.a)(this,i),(e=t.apply(this,arguments))._unitNormalizer=new ot.a,e._measurementData=new st,e._handles=new _.a,e.dataObject=new Re,e.path=new qe,e.cursorPoint=null,e.state="initial",e.lastDraggedVertex=null,e.mode="auto",e.unit="metric",e.active=!1,e.fittingSettings={maxRelativeErrorCoplanar:.005,maxRelativeErrorAlmostCoplanar:.01,verticalAngleThreshold:80},e.geodesicMeasurementDistanceThreshold=1e5,e}return Object(r.a)(i,[{key:"initialize",value:function(){var e=this;this.path.model=this.dataObject,Object(Se.a)("esri/core/t9n/Units").then((function(t){e.messages=t})),this._handles.add(Object(ke.c)(Object(we.a)(ye.a.mark((function t(){return ye.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Se.a)("esri/core/t9n/Units");case 2:e.messages=t.sent;case 3:case"end":return t.stop()}}),t)}))))),this._handles.add(Object(f.k)(this.sceneView,"ready",(function(){var t=e.sceneView.spatialReference,i=Object(Pe.g)(t),n=i===Pe.a?Pe.d:i,r=!t||Object(Ce.b)(t,n)?n:t;e._worldSpatialReference=r,e._unitNormalizer.spatialReference=r,e.path.view=e.sceneView})),"scene-view"),this.reset(),this._handles.add(this.path.on("clear",(function(){e.notifyChange("numVertices"),e._updateMeasurementData()}))),this._handles.add(this.path.on("vertex-update",(function(){e.notifyChange("numVertices"),e._updateMeasurementData()}))),this._handles.add(this.watch("state",(function(){return e._updateMeasurementData()}),!0)),this._handles.add(this.watch("fittingSettings",(function(){return e._updateMeasurementData()})))}},{key:"destroy",value:function(){this._handles.destroy(),this._handles=null}},{key:"validMeasurement",get:function(){return this.numVertices>=3&&"measured"===this.state||"editing"===this.state}},{key:"numVertices",get:function(){return this.path.numVertices}},{key:"measurementData",get:function(){return this._measurementData}},{key:"_updateMeasurementData",value:function(){var e=this._measurementData;e.update(this.path,this.sceneView,this._unitNormalizer,this.validMeasurement,this.sceneView.renderSpatialReference,this._worldSpatialReference,this.fittingSettings),this.dataObject.result={area:e.area,geodesicArea:e.geodesicArea,pathLength:e.pathLength,geodesicPathLength:e.geodesicPathLength,perimeterLength:e.perimeterLength},this.notifyChange("measurementData")}},{key:"area",get:function(){return this.measurementData.area}},{key:"geodesicArea",get:function(){return this.measurementData.geodesicArea}},{key:"areaLabel",get:function(){return this._formatAreaLabel(this.messages,"geodesic"===this.measurementMode?this.measurementData.geodesicArea:this.measurementData.area,this.unit)}},{key:"pathLength",get:function(){return this.measurementData.pathLength}},{key:"geodesicPathLength",get:function(){return this.measurementData.geodesicPathLength}},{key:"pathLengthLabel",get:function(){return this._formatLengthLabel(this.messages,"geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.pathLength,this.unit)}},{key:"perimeterLength",get:function(){return this.measurementData.perimeterLength}},{key:"geodesicPerimeterLength",get:function(){return this.measurementData.geodesicPathLength}},{key:"perimeterLengthLabel",get:function(){return this.measurementData.perimeterLength&&this._formatLengthLabel(this.messages,"geodesic"===this.measurementMode?this.measurementData.geodesicPathLength:this.measurementData.perimeterLength,this.unit)}},{key:"cursorSegmentLength",get:function(){var e=this.path.lastPoint;return Object(w.k)(e)&&Object(w.k)(this.cursorPoint)?new Me.a(this._unitNormalizer.normalizeDistance($e.segmentLengthEuclidean(e,this.cursorPoint,this._worldSpatialReference)),"meters"):null}},{key:"geodesicCursorSegmentLength",get:function(){var e=this.path.lastPoint;return Object(w.k)(e)&&Object(w.k)(this.cursorPoint)?new Me.a($e.segmentLengthGeodesic(e,this.cursorPoint),"meters"):null}},{key:"cursorSegmentLengthLabel",get:function(){return this._formatLengthLabel(this.messages,"geodesic"===this.measurementMode?this.geodesicCursorSegmentLength:this.cursorSegmentLength,this.unit)}},{key:"viewData",get:function(){var e=this.measurementData,t="geodesic"===this.measurementMode,i=t?this.geodesicArea:this.area,n=1;if(i){var r=this._toPreferredAreaUnit(i,this.unit);n=Object(xe.n)(Math.sqrt(r.value)/Math.sqrt(300)),n*=Math.sqrt(Object(p.c)(1,r.unit,"square-meters")),n/=this._unitNormalizer.normalizeDistance(1)}return{validMeasurement:this.validMeasurement,path:this.path,positionsGeographic:e.positionsGeographic,positionsRenderCoords:e.positionsRenderCoords,positionsProjected:e.positionsProjectedWorldCoords,positionsFittedRenderCoords:e.positionsFittedRenderCoords,intersectingSegments:t?e.geodesicIntersectingSegments:e.intersectingSegments,triangleIndices:t?e.geodesicTriangleIndices:e.triangleIndices,fittingMode:e.fittingMode,areaCentroid:t?e.geodesicAreaCentroidRenderCoords:e.areaCentroidRenderCoords,pathLengthLabelSegmentIndex:this.validMeasurement?0:this.path.numVertices-2,perimeterLengthLabelSegmentIndex:0,checkerSize:n}}},{key:"measurementMode",get:function(){var e=this.mode;return"auto"===e&&(e="euclidean",(this.geodesicPathLength?this.geodesicPathLength.value:0)+(!this.validMeasurement&&this.geodesicCursorSegmentLength?this.geodesicCursorSegmentLength.value:0)>this.geodesicMeasurementDistanceThreshold&&(e="geodesic")),null==this.geodesicPathLength&&(e="euclidean"),e}},{key:"reset",value:function(){this.clearMeasurement(),this._updateMeasurementData()}},{key:"clearMeasurement",value:function(){this.path.clear(),this.state="initial",this.cursorPoint=null}},{key:"finishMeasurement",value:function(){this.path.numVertices<3?this.clearMeasurement():this.state="measured"}},{key:"_preferredAreaUnit",value:function(e,t){switch(t){case"metric":return Object(p.u)(e.value,e.unit);case"imperial":return Object(p.r)(e.value,e.unit);default:return t}}},{key:"_preferredLengthUnit",value:function(e,t){var i=this._deriveLengthUnitFromAreaUnit(t);switch(i){case"metric":return Object(p.v)(e.value,e.unit);case"imperial":return Object(p.s)(e.value,e.unit);default:return i}}},{key:"_toPreferredAreaUnit",value:function(e,t){return e.toUnit(this._preferredAreaUnit(e,t))}},{key:"_toPreferredLengthUnit",value:function(e,t){return e.toUnit(this._preferredLengthUnit(e,t))}},{key:"_formatAreaLabel",value:function(e,t,i){return e&&t&&Object(Ae.b)(e,t,this._preferredAreaUnit(t,i))}},{key:"_formatLengthLabel",value:function(e,t,i){return e&&t&&Object(Ae.b)(e,t,this._preferredLengthUnit(t,i))}},{key:"_deriveLengthUnitFromAreaUnit",value:function(e){switch(e){case"metric":return"metric";case"imperial":return"imperial";case"square-inches":return"inches";case"square-feet":return"feet";case"square-yards":return"yards";case"square-miles":return"miles";case"square-us-feet":return"us-feet";case"square-millimeters":return"millimeters";case"square-centimeters":return"centimeters";case"square-decimeters":return"decimeters";case"square-meters":return"meters";case"square-kilometers":return"kilometers";case"acres":return"imperial";case"ares":case"hectares":return"metric"}throw new Error("unhandled area unit")}}]),i}(Le.a);Object(o.a)([Object(l.b)()],ct.prototype,"messages",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"dataObject",void 0),Object(o.a)([Object(l.b)({constructOnly:!0})],ct.prototype,"sceneView",void 0),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"path",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"cursorPoint",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"state",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"lastDraggedVertex",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"mode",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"unit",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"active",void 0),Object(o.a)([Object(l.b)()],ct.prototype,"fittingSettings",void 0),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"validMeasurement",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"numVertices",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"measurementData",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"area",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"geodesicArea",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"areaLabel",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"pathLength",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"geodesicPathLength",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"pathLengthLabel",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"perimeterLength",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"geodesicPerimeterLength",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"perimeterLengthLabel",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"cursorSegmentLength",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"geodesicCursorSegmentLength",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"cursorSegmentLengthLabel",null),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"viewData",null),Object(o.a)([Object(l.b)()],ct.prototype,"geodesicMeasurementDistanceThreshold",void 0),Object(o.a)([Object(l.b)({readOnly:!0})],ct.prototype,"measurementMode",null);var lt=ct=Object(o.a)([Object(u.a)("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DModel")],ct),ht=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e))._handles=new _.a,r.deferCreation=!0,r.model=new lt({sceneView:e.view}),r}return Object(r.a)(i,[{key:"initialize",value:function(){var e=this;this._view=new me(this.model,this.manipulators),this._controller=new Oe(this.model,this._view,this.manipulators),this._handles.add(Object(f.a)(this,"state",(function(t){switch(t){case"measured":return e.complete();case"ready":break;default:return e.create()}}),!0))}},{key:"destroy",value:function(){this.detach(),this._view.destroy(),this._view=null,this._controller.destroy(),this._controller=null,this._handles.destroy(),this._handles=null}},{key:"state",get:function(){switch(this.model.state){case"initial":return this.model.numVertices>=1?"measuring":"ready";case"drawing":case"editing":return"measuring";case"measured":return"measured"}}},{key:"isSupported",get:function(){return"3d"===this.get("view.type")}},{key:"cursor",get:function(){return!this.model.active||"initial"!==this.model.state&&"drawing"!==this.model.state?null:"crosshair"}},{key:"activate",value:function(){this.model.active=!0}},{key:"deactivate",value:function(){this.model.active=!1}},{key:"onShow",value:function(){this._view.show()}},{key:"onHide",value:function(){this._view.hide()}},{key:"onDetach",value:function(){this.model.reset()}},{key:"onInputEvent",value:function(e){this._controller.handleInputEvent(e)}}]),i}(y.a);Object(o.a)([Object(l.b)({readOnly:!0})],ht.prototype,"state",null),Object(o.a)([Object(l.b)({readOnly:!0})],ht.prototype,"isSupported",null),Object(o.a)([Object(l.b)({readOnly:!0})],ht.prototype,"cursor",null),Object(o.a)([Object(l.b)({constructOnly:!0})],ht.prototype,"model",void 0),Object(o.a)([Object(h.a)("model.mode")],ht.prototype,"mode",void 0),Object(o.a)([Object(h.a)("model.unit")],ht.prototype,"unit",void 0),Object(o.a)([Object(h.a)("model.areaLabel")],ht.prototype,"areaLabel",void 0),Object(o.a)([Object(h.a)("model.area")],ht.prototype,"area",void 0),Object(o.a)([Object(h.a)("model.geodesicArea")],ht.prototype,"geodesicArea",void 0),Object(o.a)([Object(h.a)("model.pathLengthLabel")],ht.prototype,"pathLengthLabel",void 0),Object(o.a)([Object(h.a)("model.pathLength")],ht.prototype,"pathLength",void 0),Object(o.a)([Object(h.a)("model.geodesicPathLength")],ht.prototype,"geodesicPathLength",void 0),Object(o.a)([Object(h.a)("model.perimeterLengthLabel")],ht.prototype,"perimeterLengthLabel",void 0),Object(o.a)([Object(h.a)("model.perimeterLength")],ht.prototype,"perimeterLength",void 0),Object(o.a)([Object(h.a)("model.geodesicPerimeterLength")],ht.prototype,"geodesicPerimeterLength",void 0),Object(o.a)([Object(h.a)("model.validMeasurement")],ht.prototype,"validMeasurement",void 0),Object(o.a)([Object(h.a)("model.viewData")],ht.prototype,"viewData",void 0);var ut=ht=Object(o.a)([Object(u.a)("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],ht),dt=c.a.getLogger("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel"),pt=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e){var r;return Object(n.a)(this,i),(r=t.call(this,e)).supportedViewType="3d",r._handles=new _.a,r._userUnitOptions=null,r._userUnit=null,r.tool=null,r}return Object(r.a)(i,[{key:"initialize",value:function(){var e=this;this._handles.add([Object(f.a)(this,"unit",(function(t){e.tool&&(e.tool.model.unit=t)}))])}},{key:"destroy",value:function(){this._handles&&(this._handles.destroy(),this._handles=null)}},{key:"state",get:function(){return this.isDisabled?"disabled":this.tool?this.tool.state:"ready"}},{key:"measurement",get:function(){if(!this.tool||this.isDisabled)return null;var e=this.tool.model,t=e.measurementMode,i=e.measurementData,n=e.validMeasurement,r=0===("euclidean"===t?i.intersectingSegments:i.geodesicIntersectingSegments).size,a=r?n?"available":"unavailable":"invalid";return{mode:t,area:{text:r&&n?e.areaLabel:null,state:a},perimeterLength:{text:r&&n?e.perimeterLengthLabel:null,state:a}}}},{key:"unitOptions",get:function(){return this._filteredOrAllUnits(this._userUnitOptions)},set:function(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}},{key:"unit",get:function(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)},set:function(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.notifyChange("unit")}},{key:"start",value:function(){return this.createTool()}},{key:"clear",value:function(){this.removeTool()}},{key:"createToolParams",value:function(){var e=this;return{toolConstructor:ut,constructorArguments:function(){return{unit:e.unit}}}}},{key:"logUnsupportedError",value:function(){dt.error("AreaMeasurement3D widget is not implemented for MapView")}},{key:"logError",value:function(){dt.error.apply(dt,arguments)}},{key:"_findSelectableUnit",value:function(e,t){var i=this.unitOptions;return-1!==i.indexOf(e)?e:t?this._findSelectableUnit(t):i[0]}},{key:"_filteredOrAllUnits",value:function(e){if(!e)return p.p.slice();var t=e.filter((function(e){return-1!==p.p.indexOf(e)}));return 0===t.length?p.p.slice():t}}]),i}(j.a);Object(o.a)([Object(l.b)({readOnly:!0})],pt.prototype,"state",null),Object(o.a)([Object(l.b)({readOnly:!0})],pt.prototype,"measurement",null),Object(o.a)([Object(l.b)({constructOnly:!0})],pt.prototype,"tool",void 0),Object(o.a)([Object(l.b)(O.a)],pt.prototype,"defaultUnit",void 0),Object(o.a)([Object(l.b)()],pt.prototype,"unitOptions",null),Object(o.a)([Object(l.b)()],pt.prototype,"unit",null);var bt=pt=Object(o.a)([Object(u.a)("esri.widgets.AreaMeasurement3D.AreaMeasurement3DViewModel")],pt),mt="esri-area-measurement-3d",vt={buttonDisabled:"esri-button--disabled",base:"".concat(mt," esri-widget esri-widget--panel"),container:"".concat(mt,"__container"),hint:"".concat(mt,"__hint"),hintText:"".concat(mt,"__hint-text"),panelError:"".concat(mt,"__panel--error"),measurement:"".concat(mt,"__measurement"),measurementItem:"".concat(mt,"__measurement-item"),measurementItemDisabled:"".concat(mt,"__measurement-item--disabled"),measurementItemTitle:"".concat(mt,"__measurement-item-title"),measurementItemValue:"".concat(mt,"__measurement-item-value"),settings:"".concat(mt,"__settings"),units:"".concat(mt,"__units"),unitsLabel:"".concat(mt,"__units-label"),unitsSelect:"".concat(mt,"__units-select esri-select"),unitsSelectWrapper:"".concat(mt,"__units-select-wrapper"),actionSection:"".concat(mt,"__actions"),newMeasurementButton:"".concat(mt,"__clear-button esri-button esri-button--primary"),widgetIcon:"esri-icon-measure-area"},gt=function(e){Object(a.a)(i,e);var t=Object(s.a)(i);function i(e,r){var a;return Object(n.a)(this,i),(a=t.call(this,e,r)).view=null,a.visible=null,a.iconClass=vt.widgetIcon,a.label=void 0,a.messages=null,a.messagesUnits=null,a.viewModel=new bt,a.unitOptions=null,a.unit=null,a}return Object(r.a)(i,[{key:"render",value:function(){var e=this,t=this.viewModel,i=t.isSupported,n=t.active,r=t.measurement,a=t.state,s=t.unit,o="disabled"===a,c="ready"===a,l="measuring"===a||"measured"===a,h=this.messages,u=this.messagesUnits,d=n&&c?Object(v.a)("section",{key:"esri-area-measurement-3d__hint",class:vt.hint},Object(v.a)("p",{class:vt.hintText},h.hint)):null,b=i?null:Object(v.a)("section",{key:"esri-area-measurement-3d__unsupported",class:vt.panelError},Object(v.a)("p",null,h.unsupported)),m=function(t,i,n){switch(i.state){case"available":return Object(v.a)("div",{key:"".concat(n,"-enabled"),class:vt.measurementItem},Object(v.a)("span",{class:vt.measurementItemTitle},t),Object(v.a)("span",{class:vt.measurementItemValue},i.text));case"unavailable":return Object(v.a)("div",{key:"".concat(n,"-disabled"),class:e.classes(vt.measurementItem,vt.measurementItemDisabled)},Object(v.a)("span",{class:vt.measurementItemTitle},t));case"invalid":return Object(v.a)("div",{key:"".concat(n,"-enabled"),class:vt.measurementItem},Object(v.a)("span",{class:vt.measurementItemTitle},t),Object(v.a)("span",{class:vt.measurementItemValue},h.notApplicable))}},g=l?Object(v.a)("section",{key:"esri-area-measurement-3d__measurement",class:vt.measurement},m(h.area,r.area,"area"),m(h.perimeterLength,r.perimeterLength,"perimeter-length")):null,_="".concat(this.id,"__units"),f=Object(v.a)("label",{class:vt.unitsLabel,for:_},h.unit),O=Object(v.a)("div",{class:vt.unitsSelectWrapper},Object(v.a)("select",{class:vt.unitsSelect,id:_,onchange:this._changeUnit,bind:this,value:s},this.viewModel.unitOptions.map((function(e){var t;return Object(v.a)("option",{key:e,value:e},Object(p.l)(e)?u.systems[e]:null==(t=u.units[e])?void 0:t.pluralCapitalized)})))),j=l?Object(v.a)("section",{key:"esri-area-measurement-3d__units",class:vt.units},f,O):null,y=l?Object(v.a)("div",{key:"settings",class:vt.settings},j):null,w=!i||n&&!l?null:Object(v.a)("div",{class:vt.actionSection},Object(v.a)("button",{disabled:o,class:this.classes(vt.newMeasurementButton,o&&vt.buttonDisabled),bind:this,onclick:this._newMeasurement,type:"button"},h.newMeasurement)),L=this.visible?Object(v.a)("div",{class:vt.container},b,d,y,g,w):null;return Object(v.a)("div",{key:this,class:vt.base,role:"presentation"},L)}},{key:"_newMeasurement",value:function(){Object(d.l)(this.viewModel.start())}},{key:"_changeUnit",value:function(e){var t=e.target,i=t.options[t.selectedIndex];i&&(this.unit=i.value)}}]),i}(g.a);Object(o.a)([Object(h.a)("viewModel.view")],gt.prototype,"view",void 0),Object(o.a)([Object(h.a)("viewModel.visible")],gt.prototype,"visible",void 0),Object(o.a)([Object(h.a)("viewModel.active")],gt.prototype,"active",void 0),Object(o.a)([Object(l.b)()],gt.prototype,"iconClass",void 0),Object(o.a)([Object(l.b)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],gt.prototype,"label",void 0),Object(o.a)([Object(l.b)(),Object(m.a)("esri/widgets/AreaMeasurement3D/t9n/AreaMeasurement3D")],gt.prototype,"messages",void 0),Object(o.a)([Object(l.b)(),Object(m.a)("esri/core/t9n/Units")],gt.prototype,"messagesUnits",void 0),Object(o.a)([Object(l.b)({type:bt})],gt.prototype,"viewModel",void 0),Object(o.a)([Object(h.a)("viewModel.unitOptions")],gt.prototype,"unitOptions",void 0),Object(o.a)([Object(h.a)("viewModel.unit")],gt.prototype,"unit",void 0),Object(o.a)([Object(b.a)()],gt.prototype,"_newMeasurement",null),Object(o.a)([Object(b.a)()],gt.prototype,"_changeUnit",null);var _t=gt=Object(o.a)([Object(u.a)("esri.widgets.AreaMeasurement3D")],gt);t.default=_t},940:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var n=i(7),r=i.n(n),a=i(10),s=i(16),o=i(15),c=i(2),l=i(3),h=i(4),u=i(5),d=i(0),p=(i(14),i(12),i(17),i(1)),b=i(8),m=i(20),v=(i(11),i(18),i(19),i(31)),g=i(49),_=i(25),f=i(197),O=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,e)).tool=null,n._baseHandles=new g.a,n._loggedUnsupportedErrorOnce=!1,n._creationAbortController=null,e&&null!=e.visible&&(n.visible=e.visible),n}return Object(l.a)(i,[{key:"initialize",value:function(){var e=this;this._baseHandles.add(Object(_.a)(this,["view.ready","isSupported"],(function(){e.view&&e.view.ready&&!e.isSupported?e._loggedUnsupportedErrorOnce||(e.logUnsupportedError(),e._loggedUnsupportedErrorOnce=!0):e._loggedUnsupportedErrorOnce=!1})))}},{key:"destroy",value:function(){this.removeTool(),this.view=null,this._baseHandles.destroy(),this._baseHandles=null}},{key:"isSupported",get:function(){return!this.view||this.view.type===this.supportedViewType}},{key:"view",get:function(){return this._get("view")},set:function(e){var t=this;if(e!==this.view){this.removeTool(),this._set("view",e);var i="tools";this._baseHandles.remove(i),e&&this._baseHandles.add(e.tools.on("change",(function(e){if(t.tool){var i,n=Object(o.a)(e.removed);try{for(n.s();!(i=n.n()).done;){var r=i.value;if(t.tool===r){r.destroyed||r.destroy(),t._set("tool",null);break}}}catch(a){n.e(a)}finally{n.f()}}})),i)}}},{key:"visible",set:function(e){this._set("visible",e),this.tool&&(this.tool.visible=e),!e&&this._creationAbortController&&(this._creationAbortController.abort(),this._creationAbortController=null)}},{key:"active",get:function(){return null!=this._creationAbortController||null!=this.tool&&this.tool.active}},{key:"isDisabled",get:function(){return!this.view||!this.view.ready||!this.isSupported}},{key:"creatingTool",get:function(){return!!this._creationAbortController}},{key:"createTool",value:function(){var e=Object(s.a)(r.a.mark((function e(){var t,i,n,s,o,c,l=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.removeTool(),this.isSupported){e.next=2;break}return e.abrupt("return",Promise.reject(new m.a("tool:create","The view does not support the tool")));case 2:return t=this.createToolParams(),i=function(){var e=Object(f.b)(t.constructorArguments);return Object(a.a)({visible:l.visible},e)},n=new AbortController,s=n.signal,this._creationAbortController=n,o=function(){n===l._creationAbortController&&(l._creationAbortController=null)},e.prev=5,e.next=8,this.view.createTool(t.toolConstructor,i,{signal:s});case 8:c=e.sent,this._set("tool",c),o(),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(5),o(),e.t0;case 15:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"removeTool",value:function(){this._creationAbortController&&this._creationAbortController.abort(),this._creationAbortController=null;var e=this.tool;e&&(this.view&&this.view.tools&&this.view.tools.remove(e),e.destroyed||e.destroy(),this._set("tool",null))}}]),i}(v.a);Object(d.a)([Object(p.b)({constructOnly:!0})],O.prototype,"tool",void 0),Object(d.a)([Object(p.b)()],O.prototype,"isSupported",null),Object(d.a)([Object(p.b)({value:null})],O.prototype,"view",null),Object(d.a)([Object(p.b)({type:Boolean,value:!0})],O.prototype,"visible",null),Object(d.a)([Object(p.b)()],O.prototype,"active",null),Object(d.a)([Object(p.b)()],O.prototype,"isDisabled",null),Object(d.a)([Object(p.b)()],O.prototype,"_creationAbortController",void 0),Object(d.a)([Object(p.b)({readOnly:!0})],O.prototype,"creatingTool",null),O=Object(d.a)([Object(b.a)("esri.widgets.support.InteractiveToolViewModel")],O)},941:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return b})),i.d(t,"d",(function(){return h})),i.d(t,"e",(function(){return d}));var n=i(10),r=i(21),a=i(37),s=i(26),o=i(13),c=(i(82),i(34));Object(s.e)();function l(e,t){return Object(n.a)(Object(n.a)({},e),Object(r.a)(t))}function h(e,t,i,n){for(;e.length<t;)e.push(i());if(n)for(;e.length>t;)n(e.pop());else e.length=t}function u(e,t){if(Object(o.v)(t,0,0,0),e.length>0){for(var i=0;i<e.length;++i)Object(o.e)(t,t,e[i]);Object(o.d)(t,t,1/e.length)}}function d(e,t,i,n){n.projectToRenderScreen(e,g),n.projectToRenderScreen(t,f),Object(c.d)(i,O,_),Object(c.e)(i,i)}function p(e,t,i){var n=i.state.camera;i.renderCoordsHelper.toRenderCoords(e,m),n.projectToRenderScreen(m,v),i.state.camera.renderToScreen(v,t)}function b(e,t,i){return p(e,j,i),p(t,y,i),Object(c.i)(j,y)}var m=Object(s.e)(),v=Object(a.e)(),g=Object(a.e)(),_=g,f=Object(a.e)(),O=f,j=(Object(a.g)(),Object(a.g)()),y=Object(a.g)()},982:function(e,t,i){"use strict";var n=i(2),r=i(3),a=i(62),s=function(){function e(t,i){Object(n.a)(this,e),this.measure=Object(a.o)(i),this.value=t,this.unit=i}return Object(r.a)(e,[{key:"isBaseUnit",get:function(){return Object(a.k)(this.unit)}},{key:"toUnit",value:function(t){return new e(Object(a.c)(this.value,this.unit,t),t)}},{key:"toBaseUnit",value:function(){return this.toUnit(Object(a.b)(this.unit))}}]),e}();t.a=s}}]);
//# sourceMappingURL=53.b4890213.chunk.js.map