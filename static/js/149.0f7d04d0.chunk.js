(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[149],{1017:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i(174),s=i(182),r=i(80),o=i(85),a=i(89),l=i(297);const c=r.a.getLogger("esri.core.workers.WorkerHandle");class d{constructor(e,t,i,n={}){this._mainMethod=t,this._listeners=[],this._promise=Object(l.b)(e,{...n,schedule:i}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,n.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>c.error(`Failed to initialize ${e} worker: ${t}`)))}on(e,t){const i={removed:!1,eventName:e,callback:t,threadHandle:null};return this._listeners.push(i),this._connectListener(i),Object(s.c)((()=>{i.removed=!0,Object(n.i)(this._listeners,i),this._thread&&Object(o.k)(i.threadHandle)&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,i){if(this._thread){const n=this.getTransferList(t,e);return this._thread.invoke(e,t,{transferList:n,signal:i})}return this._promise?this._promise.then((()=>(Object(a.v)(i),this.invokeMethod(e,t,i)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},1314:function(e,t,i){"use strict";i.r(t),i.d(t,"FeatureServiceSnappingSource",(function(){return B}));var n=i(81),s=i(93),r=i(155),o=i(182),a=i(85),l=i(111),c=i(83),d=(i(79),i(84),i(80),i(82)),b=i(260),u=i(107),h=i(103),p=i(183),O=i(687);function f(e,t){return Object(O.e)(t.extent,j),Object(O.f)(j,Object(h.w)(g,e.x,e.y,0))}const j=Object(O.a)(),g=Object(p.e)();var v=i(493);let y=class extends(Object(r.b)(s.a)){constructor(e){super(e),this.pointOfInterest=null}get tiles(){const e=this.tilesCoveringView,t=Object(a.k)(this.pointOfInterest)?this.pointOfInterest:this.view.center;return e.sort(((e,i)=>f(t,e)-f(t,i))),e}scaleEnabled(){return Object(v.b)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}get tilesCoveringView(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||Object(a.j)(this.tileInfo))return[];if(!this.scaleEnabled)return[];const{spans:e,lodInfo:t}=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),{level:i}=t,n=[];for(const{row:s,colFrom:r,colTo:o}of e)for(let e=r;e<=o;e++){const r={id:null,level:i,row:s,col:t.normalizeCol(e)};this.tileInfo.updateTileInfo(r),n.push(r)}return n}get tileInfo(){var e,t;return null!=(e=null==(t=this.view.featuresTilingScheme)?void 0:t.tileInfo)?e:null}get tileSize(){return Object(a.k)(this.tileInfo)?this.tileInfo.size[0]:256}initialize(){this.handles.add(this.watch("view.state.viewpoint",(()=>this.notifyChange("tilesCoveringView")),!0))}};Object(n.a)([Object(c.b)({readOnly:!0})],y.prototype,"tiles",null),Object(n.a)([Object(c.b)({readOnly:!0})],y.prototype,"scaleEnabled",null),Object(n.a)([Object(c.b)({readOnly:!0})],y.prototype,"tilesCoveringView",null),Object(n.a)([Object(c.b)({readOnly:!0})],y.prototype,"tileInfo",null),Object(n.a)([Object(c.b)({readOnly:!0})],y.prototype,"tileSize",null),Object(n.a)([Object(c.b)({constructOnly:!0})],y.prototype,"view",void 0),Object(n.a)([Object(c.b)({constructOnly:!0})],y.prototype,"layer",void 0),Object(n.a)([Object(c.b)()],y.prototype,"pointOfInterest",void 0),y=Object(n.a)([Object(d.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],y);let w=class extends r.a{constructor(e){super(e),this.pointOfInterest=null}get tiles(){const e=this.tilesCoveringView,t=this.effectivePointOfInterest;if(Object(a.k)(t)){const i=e.map((e=>f(t,e)));for(let n=1;n<i.length;n++)if(i[n-1]>i[n])return e.sort(((e,i)=>f(t,e)-f(t,i))),e.slice()}return e}get tilesCoveringView(){var e,t;return this.filterTiles(null==(e=this.view.featureTiles)||null==(t=e.tiles)?void 0:t.toArray()).map(m)}get tileInfo(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tilingScheme.toTileInfo())?e:null}get tileSize(){var e,t;return null!=(e=null==(t=this.view.featureTiles)?void 0:t.tileSize)?e:256}get effectivePointOfInterest(){var e;const t=this.pointOfInterest;return Object(a.k)(t)?t:null==(e=this.view.pointsOfInterest)?void 0:e.focus.location}initialize(){this.handles.add(Object(l.a)(this.view,"featureTiles",(e=>{this.handles.remove(k),e&&this.handles.add(e.addClient(),k)})))}filterTiles(e){return Object(a.j)(e)?[]:e.filter((e=>Math.abs(e.measures.screenRect[3]-e.measures.screenRect[1])>I&&2===e.measures.visibility))}};function m({lij:[e,t,i],extent:n}){return{id:`${e}/${t}/${i}`,level:e,row:t,col:i,extent:n}}Object(n.a)([Object(c.b)({readOnly:!0})],w.prototype,"tiles",null),Object(n.a)([Object(c.b)({readOnly:!0})],w.prototype,"tilesCoveringView",null),Object(n.a)([Object(c.b)({readOnly:!0})],w.prototype,"tileInfo",null),Object(n.a)([Object(c.b)({readOnly:!0})],w.prototype,"tileSize",null),Object(n.a)([Object(c.b)({constructOnly:!0})],w.prototype,"view",void 0),Object(n.a)([Object(c.b)()],w.prototype,"pointOfInterest",void 0),Object(n.a)([Object(c.b)()],w.prototype,"effectivePointOfInterest",null),w=Object(n.a)([Object(d.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],w);const I=50,k="feature-tiles";var S=i(940),_=i(114),T=i(121),P=i(123),H=i(106),x=i(118),M=i(109),z=i(766),N=i(220),R=i(357),E=i(810);const L=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]];let F=class extends s.a{constructor(e){super(e),this.updating=!1,this.enablePolygons=!0,this.enableLabels=!0,this._polygons=new Map,this._labels=new Map,this._enabled=!0}initialize(){this._symbols=L.map((e=>new N.a({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}}))),this.update()}destroy(){this._enabled=!1,this.clear()}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this.update())}update(){if(!this._enabled)return void this.clear();const e=this.getTiles(),t=new Array,i=new Set((this._labels.size,this._labels.keys()));e.forEach(((n,s)=>{const r=n.lij.toString();i.delete(r);const o=n.lij[0],l=n.geometry;if(this.enablePolygons&&!this._polygons.has(r)){const e=new x.a({geometry:l,symbol:this._symbols[o%this._symbols.length]});this._polygons.set(r,e),t.push(e)}if(this.enableLabels){const i=(e=>{if(Object(a.k)(e.label))return e.label;let t=e.lij.toString();return Object(a.k)(e.loadPriority)&&(t+=` (${e.loadPriority})`),t})(n),o=s/(e.length-1),c=Object(M.m)(0,200,o),d=Object(M.m)(20,6,o)/.75,b=Object(a.k)(n.loadPriority)&&n.loadPriority>=e.length,u=new H.a([c,b?0:c,b?0:c]),h="3d"===this.view.type?()=>new z.a({verticalOffset:{screenLength:40/.75},callout:{type:"line",color:"white",border:{color:"black"}},symbolLayers:[new E.a({text:i,halo:{color:"white",size:1/.75},material:{color:u},size:d})]}):()=>new R.a({text:i,haloColor:"white",haloSize:1/.75,color:u,size:d});if(this._labels.has(r)){const e=this._labels.get(r),t=h();(Object(a.j)(e.symbol)||JSON.stringify(t)!==JSON.stringify(e.symbol))&&(e.symbol=t)}else{const e=new x.a({geometry:l.extent.center,symbol:h()});this._labels.set(r,e),t.push(e)}}}));const n=new Array;i.forEach((e=>{this._polygons.has(e)&&(n.push(this._polygons.get(e)),this._polygons.delete(e)),this._labels.has(e)&&(n.push(this._labels.get(e)),this._labels.delete(e))})),this.view.graphics.removeMany(n),this.view.graphics.addMany(t)}clear(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}};Object(n.a)([Object(c.b)({constructOnly:!0})],F.prototype,"view",void 0),Object(n.a)([Object(c.b)({readOnly:!0})],F.prototype,"updating",void 0),Object(n.a)([Object(c.b)()],F.prototype,"enabled",null),F=Object(n.a)([Object(d.a)("esri.views.support.TileTreeDebugger")],F);let C=class extends F{constructor(e){super(e),this.handles=new _.a}initialize(){const e=setInterval((()=>this.fetchDebugInfo()),2e3);this.handles.add(Object(o.c)((()=>clearInterval(e))))}destroy(){this.handles.destroy()}getTiles(){if(!this.debugInfo)return[];const e=new Map,t=new Map;this.debugInfo.storedTiles.forEach((t=>{e.set(t.data.id,t.featureCount)})),this.debugInfo.pendingTiles.forEach((i=>{e.set(i.data.id,i.featureCount),t.set(i.data.id,i.state)}));const i=i=>{var n;const s=t.get(i),r=null!=(n=e.get(i))?n:"?";return s?`${s}:${r}\n${i}`:`store:${r}\n${i}`},n=new Map;return this.debugInfo.storedTiles.forEach((e=>{n.set(e.data.id,e.data)})),this.debugInfo.pendingTiles.forEach((e=>{n.set(e.data.id,e.data)})),Array.from(n.values()).map((e=>({lij:[e.level,e.row,e.col],geometry:T.a.fromExtent(Object(P.v)(e.extent,this.view.spatialReference)),label:i(e.id)})))}fetchDebugInfo(){this.handle.getDebugInfo(null).then((e=>{this.debugInfo=e,this.update()}))}};Object(n.a)([Object(c.b)({constructOnly:!0})],C.prototype,"handle",void 0),C=Object(n.a)([Object(d.a)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],C);var A=i(89),D=i(1017),V=i(165);let U=class extends r.a{constructor(e){super(e),this.availability=0,this.workerHandleUpdating=!0,this.editId=0}get updating(){return this.updatingHandles.updating||this.workerHandleUpdating}destroy(){this.workerHandle.destroy()}initialize(){this.workerHandle=new J(this.schedule),this.handles.add([this.workerHandle.on("notify-updating",(({updating:e})=>this.workerHandleUpdating=e)),this.workerHandle.on("notify-availability",(({availability:e})=>this._set("availability",e)))])}async setup(e,t){const i=this.serviceInfoFromLayer(e.layer);if(Object(a.j)(i))return;const n={configuration:this.convertConfiguration(e.configuration),serviceInfo:i,spatialReference:e.spatialReference.toJSON()};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("setup",n,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}async configure(e,t){const i=this.convertConfiguration(e);await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("configure",i,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}async refresh(e){await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("refresh",{},e)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},e))}async fetchCandidates(e,t){const i={distance:e.distance,point:e.coordinateHelper.toPoint(e.point,new u.a).toJSON(),types:e.types,filter:Object(a.k)(e.filter)?e.filter.createQuery().toJSON():null};return this.workerHandle.invoke(i,t)}async updateTiles(e,t){const i={tiles:e.tiles,tileInfo:Object(a.k)(e.tileInfo)?e.tileInfo.toJSON():null,tileSize:e.tileSize};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("updateTiles",i,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}async applyEdits(e,t){var i,n,s,r,o,a;const l=this.editId++,c={id:l};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("beginApplyEdits",c,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t));const d=await this.updatingHandles.addPromise(Object(A.y)(e.result,t)),b={id:l,edits:{addedFeatures:null!=(i=null==(n=d.addedFeatures)?void 0:n.map((({objectId:e})=>e)))?i:[],deletedFeatures:null!=(s=null==(r=d.deletedFeatures)?void 0:r.map((({objectId:e,globalId:t})=>({objectId:e,globalId:t}))))?s:[],updatedFeatures:null!=(o=null==(a=d.updatedFeatures)?void 0:a.map((({objectId:e})=>e)))?o:[]}};await this.updatingHandles.addPromise(this.workerHandle.invokeMethod("endApplyEdits",b,t)),this.updatingHandles.addPromise(this.workerHandle.invokeMethod("whenNotUpdating",{},t))}getDebugInfo(e){return this.workerHandle.invokeMethod("getDebugInfo",{},e)}convertConfiguration(e){return{filter:Object(a.k)(e.filter)?e.filter.toJSON():null,customParameters:e.customParameters}}serviceInfoFromLayer(e){var t;return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl.path,fields:e.fields.map((e=>e.toJSON())),geometryType:V.a.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:null==(t=e.timeInfo)?void 0:t.toJSON()}}};Object(n.a)([Object(c.b)({constructOnly:!0})],U.prototype,"schedule",void 0),Object(n.a)([Object(c.b)({readOnly:!0})],U.prototype,"updating",null),Object(n.a)([Object(c.b)({readOnly:!0})],U.prototype,"availability",void 0),Object(n.a)([Object(c.b)()],U.prototype,"workerHandleUpdating",void 0),U=Object(n.a)([Object(d.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],U);class J extends D.a{constructor(e){super("FeatureServiceSnappingSourceWorker","fetchCandidates",e,{strategy:"dedicated"})}getTransferList(){return[]}}var $=i(482),G=i(365);let W=class extends s.a{constructor(e){super(e),this.pointOfInterest=null}get tiles(){return[{id:"0/0/0",level:0,row:0,col:0,extent:Object(P.q)(-1e8,-1e8,1e8,1e8)}]}get tileInfo(){return new G.a({origin:new u.a({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new $.a({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}get tileSize(){return this.tileInfo.size[0]}};Object(n.a)([Object(c.b)({readOnly:!0})],W.prototype,"tiles",null),Object(n.a)([Object(c.b)({readOnly:!0})],W.prototype,"tileInfo",null),Object(n.a)([Object(c.b)({readOnly:!0})],W.prototype,"tileSize",null),Object(n.a)([Object(c.b)({constructOnly:!0})],W.prototype,"layer",void 0),Object(n.a)([Object(c.b)()],W.prototype,"pointOfInterest",void 0),W=Object(n.a)([Object(d.a)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],W);var q=i(616);let B=class extends(Object(r.b)(s.a)){constructor(e){super(e)}get updateTilesParameters(){return{tiles:this.tilesOfInterest.tiles,tileInfo:this.tilesOfInterest.tileInfo,tileSize:this.tilesOfInterest.tileSize}}get updating(){return this.workerHandle.updating||this.updatingHandles.updating}get configuration(){return{filter:this.layer.createQuery(),customParameters:this.layer.customParameters}}get availability(){return this.workerHandle.availability}get layer(){return this.layerSource.layer}initialize(){const e=this.view;if(Object(a.k)(e))switch(e.type){case"2d":this.tilesOfInterest=new y({view:e,layer:this.layer}),this.workerHandle=new U;break;case"3d":{const t=e.resourceController;this.tilesOfInterest=new w({view:e}),this.workerHandle=new U({schedule:e=>t.schedule(e)});break}}else this.tilesOfInterest=new W({layer:this.layer}),this.workerHandle=new U;this.handles.add([Object(o.a)(this.workerHandle)]),this.workerHandle.setup({layer:this.layer,spatialReference:this.spatialReference,configuration:this.configuration},null),this.updatingHandles.add(this,"updateTilesParameters",(()=>this.workerHandle.updateTiles(this.updateTilesParameters,null)),2),this.handles.add([Object(b.b)((()=>this.configuration),(e=>this.workerHandle.configure(e,null)))]),Object(a.k)(e)&&this.handles.add(Object(l.a)(q.a,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",(t=>{t&&!this.debug?(this.debug=new C({view:e,handle:this.workerHandle}),this.handles.add(Object(o.a)(this.debug),"debug")):!t&&this.debug&&this.handles.remove("debug")}))),this.handles.add(this.layerSource.layer.on("apply-edits",(e=>{this.workerHandle.applyEdits(e,null)})))}refresh(){this.workerHandle.refresh(null)}async fetchCandidates(e,t){return this.tilesOfInterest.pointOfInterest=e.coordinateHelper.toPoint(e.point,new u.a),(await this.workerHandle.fetchCandidates({...e,filter:null},t)).candidates.map((t=>Object(S.a)(t,e.coordinateHelper)))}getDebugInfo(e){return this.workerHandle.getDebugInfo(e)}};Object(n.a)([Object(c.b)({constructOnly:!0})],B.prototype,"spatialReference",void 0),Object(n.a)([Object(c.b)({constructOnly:!0})],B.prototype,"layerSource",void 0),Object(n.a)([Object(c.b)({constructOnly:!0})],B.prototype,"view",void 0),Object(n.a)([Object(c.b)()],B.prototype,"tilesOfInterest",void 0),Object(n.a)([Object(c.b)({readOnly:!0})],B.prototype,"updateTilesParameters",null),Object(n.a)([Object(c.b)({readOnly:!0})],B.prototype,"updating",null),Object(n.a)([Object(c.b)({readOnly:!0})],B.prototype,"configuration",null),Object(n.a)([Object(c.b)({readOnly:!0})],B.prototype,"availability",null),B=Object(n.a)([Object(d.a)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],B)},365:function(e,t,i){"use strict";var n,s=i(81),r=i(90),o=i(86),a=i(113),l=i(83),c=(i(79),i(84)),d=(i(80),i(92)),b=i(82),u=i(91),h=i(107),p=i(94),O=i(123),f=i(104),j=i(154),g=i(482);const v=new r.a({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let y=n=class extends o.a{constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null}static create(e={}){const{resolutionFactor:t=1,scales:i,size:s=256,spatialReference:r=p.a.WebMercator,numLODs:o=24}=e;if(!Object(f.j)(r)){const e=[];if(i)for(let t=0;t<i.length;t++){const n=i[t];e.push({level:t,scale:n,resolution:n})}else{let t=5e-4;for(let i=o-1;i>=0;i--)e.unshift({level:i,scale:t,resolution:t}),t*=2}return new n({dpi:96,lods:e,origin:new h.a(0,0,r),size:[s,s],spatialReference:r})}const l=Object(f.d)(r),c=e.origin?new h.a({x:e.origin.x,y:e.origin.y,spatialReference:r}):new h.a(l?{x:l.origin[0],y:l.origin[1],spatialReference:r}:{x:0,y:0,spatialReference:r}),d=1/(39.37*Object(a.f)(r)*96),b=[];if(i)for(let n=0;n<i.length;n++){const e=i[n],t=e*d;b.push({level:n,scale:e,resolution:t})}else{let e=Object(f.g)(r)?512/s*591657527.5917094:256/s*591657527.591555;const i=Math.ceil(o/t);b.push({level:0,scale:e,resolution:e*d});for(let n=1;n<i;n++){const i=e/2**t,s=i*d;b.push({level:n,scale:i,resolution:s}),e=i}}return new n({dpi:96,lods:b,origin:c,size:[s,s],spatialReference:r})}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const i=Object(f.d)(e);return e.isWrappable&&Math.abs(i.origin[0]-t.x)<=i.dx}return!1}readOrigin(e,t){return h.a.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,i=0;const n=[];this._levelToLOD={},e&&(t=-1/0,i=1/0,e.forEach((e=>{n.push(e.scale),t=e.scale>t?e.scale:t,i=e.scale<i?e.scale:i,this._levelToLOD[e.level]=e}))),this._set("scales",n),this._set("minScale",t),this._set("maxScale",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[0]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];{const i=Math.floor(e),n=i+1;return t[i]/(t[i]/t[n])**(e-i)}}scaleToZoom(e){const t=this.scales,i=t.length-1;let n=0;for(;n<i;n++){const i=t[n],s=t[n+1];if(i<=e)return n;if(s===e)return n+1;if(i>e&&s<e)return n+Math.log(i/e)/Math.log(i/s)}return n}snapScale(e,t=.95){const i=this.scaleToZoom(e);return i%Math.floor(i)>=t?this.zoomToScale(Math.ceil(i)):this.zoomToScale(Math.floor(i))}tileAt(e,t,i,n){const s=this.lodAt(e);if(!s)return null;let r,o;if("number"==typeof t)r=t,o=i;else if(Object(f.c)(t.spatialReference,this.spatialReference))r=t.x,o=t.y,n=i;else{const e=Object(j.d)(t,this.spatialReference);if(!e)return null;r=e.x,o=e.y,n=i}const a=s.resolution*this.size[0],l=s.resolution*this.size[1];return n||(n={id:null,level:0,row:0,col:0,extent:Object(O.k)()}),n.level=e,n.row=Math.floor((this.origin.y-o)/l+.001),n.col=Math.floor((r-this.origin.x)/a+.001),this.updateTileInfo(n),n}updateTileInfo(e,t=0){let i=this.lodAt(e.level);if(!i&&1===t){const t=this.lods[this.lods.length-1];t.level<e.level&&(i=t)}if(!i)return;const n=e.level-i.level,s=i.resolution*this.size[0]/2**n,r=i.resolution*this.size[1]/2**n;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=Object(O.k)()),e.extent[0]=this.origin.x+e.col*s,e.extent[1]=this.origin.y-(e.row+1)*r,e.extent[2]=e.extent[0]+s,e.extent[3]=e.extent[1]+r}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const{resolution:i}=this.lodAt(t.level),n=i*this.size[0],s=i*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*s,e[2]=e[0]+n,e[3]=e[1]+s,e}lodAt(e){return this._levelToLOD&&this._levelToLOD[e]||null}clone(){return n.fromJSON(this.write({}))}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let i=0;i<e.length;i++){const n=e[i];this._upsampleLevels[n.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/n.resolution:0},t=n}}};Object(s.a)([Object(l.b)({type:Number,json:{write:!0}})],y.prototype,"compressionQuality",void 0),Object(s.a)([Object(l.b)({type:Number,json:{write:!0}})],y.prototype,"dpi",void 0),Object(s.a)([Object(l.b)({type:String,json:{read:v.read,write:v.write,origins:{"web-scene":{read:!1,write:!1}}}})],y.prototype,"format",void 0),Object(s.a)([Object(l.b)({readOnly:!0})],y.prototype,"isWrappable",null),Object(s.a)([Object(l.b)({type:h.a,json:{write:!0}})],y.prototype,"origin",void 0),Object(s.a)([Object(d.a)("origin")],y.prototype,"readOrigin",null),Object(s.a)([Object(l.b)({type:[g.a],value:null,json:{write:!0}})],y.prototype,"lods",null),Object(s.a)([Object(l.b)({readOnly:!0})],y.prototype,"minScale",void 0),Object(s.a)([Object(l.b)({readOnly:!0})],y.prototype,"maxScale",void 0),Object(s.a)([Object(l.b)({readOnly:!0})],y.prototype,"scales",void 0),Object(s.a)([Object(l.b)({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],y.prototype,"size",void 0),Object(s.a)([Object(d.a)("size",["rows","cols"])],y.prototype,"readSize",null),Object(s.a)([Object(u.a)("size",{cols:{type:c.a},rows:{type:c.a}})],y.prototype,"writeSize",null),Object(s.a)([Object(l.b)({type:p.a,json:{write:!0}})],y.prototype,"spatialReference",void 0),y=n=Object(s.a)([Object(b.a)("esri.layers.support.TileInfo")],y);var w=y;t.a=w},482:function(e,t,i){"use strict";var n,s=i(81),r=i(86),o=i(83),a=(i(79),i(84)),l=(i(80),i(82));let c=n=class extends r.a{constructor(e){super(e),this.level=0,this.levelValue=null,this.resolution=0,this.scale=0}clone(){return new n({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}};Object(s.a)([Object(o.b)({type:a.a,json:{write:!0}})],c.prototype,"level",void 0),Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],c.prototype,"levelValue",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],c.prototype,"resolution",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],c.prototype,"scale",void 0),c=n=Object(s.a)([Object(l.a)("esri.layers.support.LOD")],c);var d=c;t.a=d},687:function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return j})),i.d(t,"c",(function(){return H})),i.d(t,"d",(function(){return g})),i.d(t,"e",(function(){return w})),i.d(t,"f",(function(){return P})),i.d(t,"g",(function(){return m})),i.d(t,"h",(function(){return z})),i.d(t,"i",(function(){return M})),i.d(t,"j",(function(){return v}));i(79);var n=i(80),s=i(109),r=i(324),o=i(142),a=i(153),l=i(103),c=i(101),d=i(320),b=i(300),u=i(256),h=i(429),p=i(209);const O=n.a.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");function f(e=F){return{plane:Object(b.d)(e.plane),origin:Object(c.c)(e.origin),basis1:Object(c.c)(e.basis1),basis2:Object(c.c)(e.basis2)}}function j(e,t=f()){return g(e.origin,e.basis1,e.basis2,t)}function g(e,t,i,n=f()){return Object(l.k)(n.origin,e),Object(l.k)(n.basis1,t),Object(l.k)(n.basis2,i),v(n),function(e,t){Math.abs(Object(l.h)(e.basis1,e.basis2)/(Object(l.p)(e.basis1)*Object(l.p)(e.basis2)))>1e-6&&O.warn(t,"Provided basis vectors are not perpendicular"),Math.abs(Object(l.h)(e.basis1,z(e)))>1e-6&&O.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-Object(l.h)(z(e),e.origin)-e.plane[3])>1e-6&&O.warn(t,"Plane offset is not consistent with plane origin")}(n,"fromValues()"),n}function v(e){Object(b.i)(e.basis2,e.basis1,e.origin,e.plane)}function y(e,t,i){e!==i&&j(e,i);const n=Object(l.e)(p.d.get(),z(e),t);return Object(l.f)(i.origin,i.origin,n),i.plane[3]-=t,i}function w(e,t=f()){const i=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return Object(l.w)(t.origin,e[0]+i,e[1]+n,0),Object(l.w)(t.basis1,i,0,0),Object(l.w)(t.basis2,0,n,0),Object(b.h)(0,0,1,0,t.plane),t}function m(e,t,i){return!!Object(b.m)(e.plane,t,i)&&N(e,i)}function I(e,t,i){const n=C.get();L(e,t,n,C.get());let r=Number.POSITIVE_INFINITY;for(const o of U){const a=E(e,o,A.get()),c=p.d.get();if(Object(b.k)(n,a,c)){const e=Object(l.v)(p.d.get(),t.origin,c),n=Math.abs(Object(s.b)(Object(l.h)(t.direction,e)));n<r&&(r=n,Object(l.k)(i,c))}}return r===Number.POSITIVE_INFINITY?k(e,t,i):i}function k(e,t,i){if(m(e,t,i))return i;const n=C.get(),s=C.get();L(e,t,n,s);let r=Number.POSITIVE_INFINITY;for(const o of U){const a=E(e,o,A.get()),c=p.d.get();if(Object(b.l)(n,a,c)){const e=Object(u.d)(t,c);if(!Object(b.o)(s,c))continue;e<r&&(r=e,Object(l.k)(i,c))}}return T(e,t.origin)<r&&S(e,t.origin,i),i}function S(e,t,i){const n=Object(b.s)(e.plane,t,p.d.get()),s=Object(d.i)(R(e,e.basis1),n,-1,1,p.d.get()),r=Object(d.i)(R(e,e.basis2),n,-1,1,p.d.get());return Object(l.j)(i,Object(l.f)(p.d.get(),s,r),e.origin),i}function _(e,t,i){const{origin:n,basis1:s,basis2:r}=e,o=Object(l.j)(p.d.get(),t,n),a=Object(h.d)(s,o),c=Object(h.d)(r,o),d=Object(h.d)(z(e),o);return Object(l.w)(i,a,c,d)}function T(e,t){const i=_(e,t,p.d.get()),{basis1:n,basis2:s}=e,r=Object(l.p)(n),o=Object(l.p)(s),a=Math.max(Math.abs(i[0])-r,0),c=Math.max(Math.abs(i[1])-o,0),d=i[2];return a*a+c*c+d*d}function P(e,t){return Math.sqrt(T(e,t))}function H(e,t){return Object(b.o)(e.plane,t)&&N(e,t)}function x(e,t){const i=-e.plane[3];return Object(h.d)(z(e),t)-i}function M(e,t,i,n){return e!==n&&j(e,n),Object(o.c)($,Object(o.i)($),t,i),Object(l.q)(n.basis1,e.basis1,$),Object(l.q)(n.basis2,e.basis2,$),v(n),n}function z(e){return Object(b.r)(e.plane)}function N(e,t){const i=Object(l.j)(p.d.get(),t,e.origin),n=Object(l.t)(e.basis1),s=Object(l.t)(e.basis2),r=Object(l.h)(e.basis1,i),o=Object(l.h)(e.basis2,i);return-r-n<0&&r-n<0&&-o-s<0&&o-s<0}function R(e,t){const i=A.get();return Object(l.k)(i.origin,e.origin),Object(l.k)(i.vector,t),i}function E(e,t,i){const{basis1:n,basis2:s,origin:r}=e,o=Object(l.e)(p.d.get(),n,t.origin[0]),a=Object(l.e)(p.d.get(),s,t.origin[1]);Object(l.f)(i.origin,o,a),Object(l.f)(i.origin,i.origin,r);const c=Object(l.e)(p.d.get(),n,t.direction[0]),d=Object(l.e)(p.d.get(),s,t.direction[1]);return Object(l.e)(i.vector,Object(l.f)(c,c,d),2),i}function L(e,t,i,n){const s=z(e);Object(b.i)(s,t.direction,t.origin,i),Object(b.i)(Object(b.r)(i),s,t.origin,n)}const F={plane:Object(b.d)(),origin:Object(c.g)(0,0,0),basis1:Object(c.g)(1,0,0),basis2:Object(c.g)(0,1,0)},C=new r.a(b.d),A=new r.a(d.d),D=Object(c.e)(),V=new r.a((()=>({origin:null,basis1:null,basis2:null,plane:null}))),U=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],J=Object(a.d)(),$=Object(a.d)();Object.freeze({__proto__:null,BoundedPlaneClass:class{constructor(){this.plane=Object(b.d)(),this.origin=Object(c.e)(),this.basis1=Object(c.e)(),this.basis2=Object(c.e)()}},create:f,wrap:function(e,t,i){const n=V.get();return n.origin=e,n.basis1=t,n.basis2=i,n.plane=Object(b.v)(0,0,0,0),v(n),n},copy:j,copyWithoutVerify:function(e,t){Object(l.k)(t.origin,e.origin),Object(l.k)(t.basis1,e.basis1),Object(l.k)(t.basis2,e.basis2),Object(b.c)(e.plane,t.plane)},fromValues:g,updateUnboundedPlane:v,elevate:y,setExtent:function(e,t,i){return w(t,i),y(i,x(e,e.origin),i),i},fromAABoundingRect:w,intersectRay:m,intersectRayClosestSilhouette:function(e,t,i){if(m(e,t,i))return i;const n=I(e,t,p.d.get());return Object(l.f)(i,t.origin,Object(l.e)(p.d.get(),t.direction,Object(l.m)(t.origin,n)/Object(l.p)(t.direction))),i},closestPointOnSilhouette:I,closestPoint:k,projectPoint:S,projectPointLocal:_,distance2:T,distance:P,distanceToSilhouette:function(e,t){let i=Number.NEGATIVE_INFINITY;for(const n of U){const s=E(e,n,A.get()),r=Object(d.e)(s,t);r>i&&(i=r)}return Math.sqrt(i)},extrusionContainsPoint:H,axisAt:function(e,t,i,n){return function(e,t,i){switch(t){case 0:Object(l.k)(i,e.basis1),Object(l.r)(i,i);break;case 1:Object(l.k)(i,e.basis2),Object(l.r)(i,i);break;case 2:Object(l.k)(i,z(e))}return i}(e,i,n)},altitudeAt:x,setAltitudeAt:function(e,t,i,n){const s=x(e,t),r=Object(l.e)(D,z(e),i-s);return Object(l.f)(n,t,r),n},equals:function(e,t){return Object(l.o)(e.basis1,t.basis1)&&Object(l.o)(e.basis2,t.basis2)&&Object(l.o)(e.origin,t.origin)},transform:function(e,t,i){return e!==i&&j(e,i),Object(o.a)(J,t),Object(o.e)(J,J),Object(l.q)(i.basis1,e.basis1,J),Object(l.q)(i.basis2,e.basis2,J),Object(l.q)(Object(b.r)(i.plane),Object(b.r)(e.plane),J),Object(l.q)(i.origin,e.origin,t),Object(b.t)(i.plane,i.origin,i.plane),i},rotate:M,normal:z,UP:F})},940:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(823),s=i(554),r=i(747),o=i(672);class a extends r.a{constructor(e){super({...e,constraint:new s.d(e.coordinateHelper,e.targetPoint)})}get hints(){return[new o.a(this.targetPoint)]}}function l(e,t){switch(e.type){case"edge":return new n.a({coordinateHelper:t,edgeStart:t.fromPoint(e.start),edgeEnd:t.fromPoint(e.end),targetPoint:t.fromPoint(e.target),objectId:e.objectId});case"vertex":return new a({coordinateHelper:t,targetPoint:t.fromPoint(e.target),objectId:e.objectId})}}}}]);
//# sourceMappingURL=149.0f7d04d0.chunk.js.map