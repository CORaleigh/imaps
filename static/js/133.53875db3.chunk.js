(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[133],{125:function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return v})),r.d(t,"h",(function(){return g})),r.d(t,"i",(function(){return i})),r.d(t,"j",(function(){return O})),r.d(t,"k",(function(){return c})),r.d(t,"l",(function(){return f})),r.d(t,"m",(function(){return l})),r.d(t,"n",(function(){return o})),r.d(t,"o",(function(){return h})),r.d(t,"p",(function(){return p})),r.d(t,"q",(function(){return x})),r.d(t,"r",(function(){return s})),r.d(t,"s",(function(){return m}));r(80),r(89);var a=r(103);function i(e=C){return[e[0],e[1],e[2],e[3]]}function n(e){return[e[0],e[1],e[2],e[3]]}function o(e,t,r,a,n=i()){return n[0]=e,n[1]=t,n[2]=r,n[3]=a,n}function l(e,t=i()){return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function s(e,t){return new a.a({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function c(e,t,r=e){if("length"in t)M(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3])):2!==t.length&&3!==t.length||(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.max(e[2],t[0]),r[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":r[0]=Math.min(e[0],t.xmin),r[1]=Math.min(e[1],t.ymin),r[2]=Math.max(e[2],t.xmax),r[3]=Math.max(e[3],t.ymax);break;case"point":r[0]=Math.min(e[0],t.x),r[1]=Math.min(e[1],t.y),r[2]=Math.max(e[2],t.x),r[3]=Math.max(e[3],t.y)}return r}function f(e,t,r=e){for(var a=t.length,i=e[0],n=e[1],o=e[2],l=e[3],s=0;s<a;s++){var c=t[s];i=Math.min(i,c[0]),n=Math.min(n,c[1]),o=Math.max(o,c[0]),l=Math.max(l,c[1])}return r[0]=i,r[1]=n,r[2]=o,r[3]=l,r}function m(e){return e[0]>=e[2]?0:e[2]-e[0]}function h(e){return e[1]>=e[3]?0:e[3]-e[1]}function u(e){return m(e)*h(e)}function y(e,t){return g(e,t[0],t[1])}function d(e,t){return g(e,t.x,t.y)}function g(e,t,r){return t>=e[0]&&r>=e[1]&&t<=e[2]&&r<=e[3]}function v(e,t,r){return t[0]>=e[0]-r&&t[1]>=e[1]-r&&t[0]<=e[2]+r&&t[1]<=e[3]+r}function p(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function b(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function O(e){return e?x(e,S):i(S)}function M(e){return 4===e.length}var S=[1/0,1/0,-1/0,-1/0],C=[0,0,0,0]},311:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return x})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return M})),r.d(t,"g",(function(){return S}));var a=r(100);var i=(e,t,r)=>[t,r],n=(e,t,r)=>[t,r,e[2]],o=(e,t,r)=>[t,r,e[2],e[3]];function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function s({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function c({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function f(e,t,r){for(var a,i,n,o,l=[],f=0;f<r.length;f++){var m=r[f];f>0?(n=s(e,m[0]),o=c(e,m[1]),n===a&&o===i||(l.push(t(m,n-a,o-i)),a=n,i=o)):(a=s(e,m[0]),i=c(e,m[1]),l.push(t(m,a,i)))}return l.length>0?l:null}function m({scale:e,translate:t},r){return r*e[0]+t[0]}function h({scale:e,translate:t},r){return t[1]-r*e[1]}function u(e,t,r){var a=new Array(r.length);if(!r.length)return a;var[i,n]=e.scale,o=m(e,r[0][0]),l=h(e,r[0][1]);a[0]=t(r[0],o,l);for(var s=1;s<r.length;s++){var c=r[s];o+=c[0]*i,l-=c[1]*n,a[s]=t(c,o,l)}return a}function y(e,t,r){for(var a=new Array(r.length),i=0;i<r.length;i++)a[i]=u(e,t,r[i]);return a}function d(e,t,r,a,l){return t.points=function(e,t,r,a){return f(e,r?a?o:n:a?n:i,t)}(e,r.points,a,l),t}function g(e,t,r,a,i){return t.x=s(e,r.x),t.y=c(e,r.y),t!==r&&(a&&(t.z=r.z),i&&(t.m=r.m)),t}function v(e,t,r,a,l){var s=function(e,t,r,a){for(var l=[],s=r?a?o:n:a?n:i,c=0;c<t.length;c++){var m=f(e,s,t[c]);m&&m.length>=3&&l.push(m)}return l.length?l:null}(e,r.rings,a,l);return s?(t.rings=s,t):null}function p(e,t,r,a,l){var s=function(e,t,r,a){for(var l=[],s=r?a?o:n:a?n:i,c=0;c<t.length;c++){var m=f(e,s,t[c]);m&&m.length>=2&&l.push(m)}return l.length?l:null}(e,r.paths,a,l);return s?(t.paths=s,t):null}function b(e,t){return e&&t?Object(a.f)(t)?g(e,{},t,!1,!1):Object(a.h)(t)?p(e,{},t,!1,!1):Object(a.g)(t)?v(e,{},t,!1,!1):Object(a.e)(t)?d(e,{},t,!1,!1):Object(a.d)(t)?(o=!1,l=!1,(i={}).xmin=s(r=e,(n=t).xmin),i.ymin=c(r,n.ymin),i.xmax=s(r,n.xmax),i.ymax=c(r,n.ymax),i!==n&&(o&&(i.zmin=n.zmin,i.zmax=n.zmax),l&&(i.mmin=n.mmin,i.mmax=n.mmax)),i):null:null;var r,i,n,o,l}function x(e,t,r,a,l){return t.points=function(e,t,r,a){return u(e,r?a?o:n:a?n:i,t)}(e,r.points,a,l),t}function O(e,t,r,a,i){return t.x=m(e,r.x),t.y=h(e,r.y),t!==r&&(a&&(t.z=r.z),i&&(t.m=r.m)),t}function M(e,t,r,a,l){return t.rings=function(e,t,r,a){return y(e,r?a?o:n:a?n:i,t)}(e,r.rings,a,l),t}function S(e,t,r,a,l){return t.paths=function(e,t,r,a){return y(e,r?a?o:n:a?n:i,t)}(e,r.paths,a,l),t}},418:function(e,t,r){"use strict";r.d(t,"a",(function(){return J})),r.d(t,"b",(function(){return O}));var a=r(91),i=r(7),n=r(143),o=r(81),l=r(152),s=r(109),c=r(105),f=r(320),m=r(419),h=r(352),u=r(493),y=o.a.getLogger("esri.symbols.cim.cimAnalyzer");function d(e){switch(e){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function g(e){switch(e){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function v(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function p(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function b(e,t,r,a){var i;e[t]?i=e[t]:(i={},e[t]=i),i[r]=a}function x(e){var t=e.markerPlacement;return t&&t.angleToLine?1:0}function O(e,t,r,a){return M.apply(this,arguments)}function M(){return(M=Object(i.a)((function*(e,t,r,a){var i,n,o=r||[];if(!e)return o;var s={};if("CIMSymbolReference"!==e.type)return y.error("Expect cim type to be 'CIMSymbolReference'"),o;if(i=e.symbol,n=e.primitiveOverrides){var c=[],f=function(e){var r=e.valueExpressionInfo;if(r&&t){var a=r.expression,i=Object(l.d)(a,t.spatialReference,t.fields).then((t=>{t&&b(s,e.primitiveName,e.propertyName,t)}));c.push(i)}else null!=e.value&&b(s,e.primitiveName,e.propertyName,e.value)};for(var m of n)f(m);yield Promise.all(c)}switch(i.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":S(i,n,s,t,o,a)}return o}))).apply(this,arguments)}function S(e,t,r,a,i,n){if(e){var o=e.symbolLayers;if(o){var l,s=h.a.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(l=1);for(var c=o.length;c--;){var f=o[c];if(f&&!1!==f.enable){var m=[];switch(h.b.findApplicableOverrides(f,t,m),f.type){case"CIMSolidFill":C(f,r,m,a,i);break;case"CIMPictureFill":k(f,r,m,a,i);break;case"CIMHatchFill":P(f,r,m,a,i);break;case"CIMGradientFill":z(f,r,m,a,i);break;case"CIMSolidStroke":w(f,r,m,a,i,"CIMPolygonSymbol"===e.type,s);break;case"CIMPictureStroke":j(f,r,m,a,i,"CIMPolygonSymbol"===e.type,s);break;case"CIMGradientStroke":I(f,r,m,a,i,"CIMPolygonSymbol"===e.type,s);break;case"CIMCharacterMarker":if(N(f,r,m,a,i))break;break;case"CIMPictureMarker":if(N(f,r,m,a,i))break;"CIMLineSymbol"===e.type&&(l=x(f)),L(f,r,m,a,i,l,s);break;case"CIMVectorMarker":if(N(f,r,m,a,i))break;"CIMLineSymbol"===e.type&&(l=x(f)),R(f,r,m,a,i,l,s,n);break;default:y.error("Cannot analyze CIM layer",f.type)}}}}}}function C(e,t,r,a,i){var o=e.primitiveName,l=Object(f.e)(e.color),s=Object(n.b)(JSON.stringify(e)).toString();i.push({type:"fill",templateHash:s,materialHash:0===r.length?s:()=>s,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:F(o,t,"Color",a,l,Y),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function k(e,t,r,a,i){var o=e.primitiveName,l=e.tintColor?Object(f.e)(e.tintColor):{r:255,g:255,b:255,a:1},s=Object(n.b)(JSON.stringify(e)).toString(),c=Object(n.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString();i.push({type:"fill",templateHash:s,materialHash:0===r.length?c:()=>c,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:F(o,t,"TintColor",a,l,Y),height:F(o,t,"Height",a,e.height),scaleX:F(o,t,"ScaleX",a,e.scaleX),angle:F(o,t,"Rotation",a,e.rotation),offsetX:F(o,t,"OffsetX",a,e.offsetX),offsetY:F(o,t,"OffsetY",a,e.offsetY)})}function P(e,t,r,a,i){var o=["Rotation","OffsetX","OffsetY"],l=r.filter((t=>t.primitiveName!==e.primitiveName&&-1===o.indexOf(t.propertyName))),s=e.primitiveName,c=Object(n.b)(JSON.stringify(e)).toString(),f=Object(n.b)("".concat(e.separation).concat(JSON.stringify(e.lineSymbol))).toString();i.push({type:"fill",templateHash:c,materialHash:0===r.length?f:D(f,t,l,a),cim:e,materialOverrides:l,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:F(s,t,"Separation",a,e.separation),scaleX:1,angle:F(s,t,"Rotation",a,e.rotation),offsetX:F(s,t,"OffsetX",a,e.offsetX),offsetY:F(s,t,"OffsetY",a,e.offsetY)})}function z(e,t,r,a,i){var o=Object(n.b)(JSON.stringify(e)).toString();i.push({type:"fill",templateHash:o,materialHash:0===r.length?o:D(o,t,r,a),cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function w(e,t,r,a,i,o,l){var s=Object(n.b)(JSON.stringify(e)).toString(),c=e.primitiveName,m=Object(f.e)(e.color),h=void 0!==e.width?e.width:4,u=d(e.capStyle),y=g(e.joinStyle),v=e.miterLimit;i.push({type:"line",templateHash:s,materialHash:0===r.length?s:()=>s,cim:e,materialOverrides:null,isOutline:o,colorLocked:e.colorLocked,effects:e.effects,color:F(c,t,"Color",a,m,Y),width:F(c,t,"Width",a,h),cap:F(c,t,"CapStyle",a,u),join:F(c,t,"JoinStyle",a,y),miterLimit:F(c,t,"MiterLimit",a,v),referenceWidth:l,zOrder:A(e.name),isDashed:!1})}function j(e,t,r,a,i,o,l){var s=Object(n.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),c=e.primitiveName,m=Object(f.e)(e.tintColor),h=void 0!==e.width?e.width:4,u=d(e.capStyle),y=g(e.joinStyle),v=e.miterLimit,p=Object(n.b)(JSON.stringify(e)).toString();i.push({type:"line",templateHash:p,materialHash:0===r.length?s:()=>s,cim:e,materialOverrides:null,isOutline:o,colorLocked:e.colorLocked,effects:e.effects,color:F(c,t,"TintColor",a,m,Y),width:F(c,t,"Width",a,h),cap:F(c,t,"CapStyle",a,u),join:F(c,t,"JoinStyle",a,y),miterLimit:F(c,t,"MiterLimit",a,v),referenceWidth:l,zOrder:A(e.name),isDashed:!1})}function I(e,t,r,a,i,o,l){var s=e.primitiveName,c=void 0!==e.width?e.width:4,f=d(e.capStyle),m=g(e.joinStyle),h=e.miterLimit,u=Object(n.b)(JSON.stringify(e)).toString();i.push({type:"line",templateHash:u,materialHash:0===r.length?u:D(u,t,r,a),cim:e,materialOverrides:null,isOutline:o,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:F(s,t,"Width",a,c),cap:F(s,t,"CapStyle",a,f),join:F(s,t,"JoinStyle",a,m),miterLimit:F(s,t,"MiterLimit",a,h),referenceWidth:l,zOrder:A(e.name),isDashed:!1})}function N(e,t,r,a,i){var o=e.markerPlacement;if(!o||"CIMMarkerPlacementInsidePolygon"!==o.type)return!1;var l=o,s=["Rotation","OffsetX","OffsetY"],c=r.filter((t=>t.primitiveName!==e.primitiveName&&-1===s.indexOf(t.propertyName))),f=Object(n.b)(JSON.stringify(e)).toString();return i.push({type:"fill",templateHash:f,materialHash:0===r.length?f:D(f,t,c,a),cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:F(l.primitiveName,t,"StepY",a,l.stepY),scaleX:1,angle:F(l.primitiveName,t,"GridAngle",a,l.gridAngle),offsetX:F(l.primitiveName,t,"OffsetX",a,l.offsetX),offsetY:F(l.primitiveName,t,"OffsetY",a,l.offsetY)}),!0}function L(e,t,r,a,i,o,l){var s=e.primitiveName,c=e.size,m=e.scaleX,h=e.rotation,u=e.offsetX,y=e.offsetY,d=Object(f.e)(e.tintColor),g=Object(n.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),v=!1,p="";for(var b of r)b.primitiveName===s&&(void 0!==b.value?p+="-".concat(b.primitiveName,"-").concat(b.propertyName,"-").concat(JSON.stringify(b.value)):b.valueExpressionInfo&&(v=!0));i.push({type:"marker",templateHash:Object(n.b)(JSON.stringify(e)+p).toString(),materialHash:v?()=>g:g,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:o,size:F(s,t,"Size",a,c),scaleX:F(s,t,"ScaleX",a,m),rotation:F(s,t,"Rotation",a,h),offsetX:F(s,t,"OffsetX",a,u),offsetY:F(s,t,"OffsetY",a,y),color:F(s,t,"TintColor",a,d,Y),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:1,markerPlacement:e.markerPlacement})}function R(e,t,r,a,i,n,o,l){var s=e.markerGraphics;if(s){var c=0;if(e.scaleSymbolsProportionally){var f=e.frame;f&&(c=f.ymax-f.ymin)}for(var m of s)if(m){var h=m.symbol;if(!h)continue;switch(h.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":H(e,m,r,t,a,i,n,o,c,l);break;case"CIMTextSymbol":_(e,m,t,r,a,i,n,o,c)}}}}function _(e,t,r,i,o,l,s,c,m){h.b.findApplicableOverrides(t,i,[]);var u=t.geometry;if("x"in u&&"y"in u){var y,d=t.symbol,g=(y=d).underline?"underline":y.strikethrough?"line-through":"none",b=function(e){var t="normal",r="normal";if(e){var a=e.toLowerCase();-1!==a.indexOf("italic")?t="italic":-1!==a.indexOf("oblique")&&(t="oblique"),-1!==a.indexOf("bold")?r="bold":-1!==a.indexOf("light")&&(r="lighter")}return{style:t,weight:r}}(d.fontStyleName);d.font=Object(a.a)({family:d.fontFamilyName,decoration:g},b);var x=e.frame,O=u.x-.5*(x.xmin+x.xmax),M=u.y-.5*(x.ymin+x.ymax),S=e.size/m,C=e.primitiveName,k=(d.height||0)*S,P=d.angle||0,z=((d.offsetX||0)+O)*S,w=((d.offsetY||0)+M)*S,j=Object(f.e)(h.a.getFillColor(d)),I=Object(f.e)(h.a.getStrokeColor(d)),N=h.a.getStrokeWidth(d);N||(I=Object(f.e)(h.a.getFillColor(d.haloSymbol)),N=d.haloSize*S);var L="";for(var R of i)R.primitiveName===C&&void 0!==R.value&&(L+="-".concat(R.primitiveName,"-").concat(R.propertyName,"-").concat(JSON.stringify(R.value)));var _=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),H=Object(n.b)(JSON.stringify(t)+_+L).toString();l.push({type:"text",templateHash:H,materialHash:()=>Object(n.b)(JSON.stringify(d.font)).toString(),cim:d,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:s,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:d.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:F(C,r,"Size",o,k),angle:F(C,r,"Rotation",o,P),offsetX:F(C,r,"OffsetX",o,z),offsetY:F(C,r,"OffsetY",o,w),horizontalAlignment:v(d.horizontalAlignment),verticalAlignment:p(d.verticalAlignment),text:F(t.primitiveName,r,"TextString",o,t.textString,f.a,d.textCase),color:j,outlineColor:I,outlineSize:N,referenceSize:c,sizeRatio:1,markerPlacement:e.markerPlacement})}}function H(e,t,r,i,o,l,s,c,m,y){var d=t.symbol,g=t.geometry;if(g){var v=d.symbolLayers;if(v)if(y)X(e,t,i,r,o,l,s,c,m);else for(var p=v.length;p--;){var b=v[p];if(b&&!1!==b.enable)switch(b.type){case"CIMSolidFill":case"CIMSolidStroke":var x=function(){var y=Object(u.b)(g);if(!y)return"continue";var[d,v,p]=Object(u.d)(y,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),x="CIMSolidFill"===b.type,O={type:"sdf",geom:g,asFill:x},M=e.primitiveName,S=e.size,C=e.rotation||0,k=e.offsetX,P=e.offsetY,z=b.primitiveName,w=Object(f.e)(x?h.a.getFillColor(b):h.a.getStrokeColor(b)),j=x?{r:0,g:0,b:0,a:0}:Object(f.e)(h.a.getStrokeColor(b)),I=h.a.getStrokeWidth(b);if(!x&&!I)return"break";var N=!1,L="";for(var R of r)R.primitiveName!==z&&R.primitiveName!==M||(void 0!==R.value?L+="-".concat(R.primitiveName,"-").concat(R.propertyName,"-").concat(JSON.stringify(R.value)):R.valueExpressionInfo&&(N=!0));var _=JSON.stringify(Object(a.a)(Object(a.a)({},e),{},{markerGraphics:null})),H=Object(n.b)(JSON.stringify(O)).toString(),X={type:"marker",templateHash:Object(n.b)(JSON.stringify(t)+JSON.stringify(b)+_+L).toString(),materialHash:N?()=>H:H,cim:O,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:s,anchorPoint:{x:v,y:p},isAbsoluteAnchorPoint:!1,size:F(e.primitiveName,i,"Size",o,S),rotation:F(e.primitiveName,i,"Rotation",o,C),offsetX:F(e.primitiveName,i,"OffsetX",o,k),offsetY:F(e.primitiveName,i,"OffsetY",o,P),scaleX:1,frameHeight:m,rotateClockwise:e.rotateClockwise,referenceSize:c,sizeRatio:d,color:F(z,i,"Color",o,w,Y),outlineColor:F(z,i,"Color",o,j,Y),outlineWidth:F(z,i,"Width",o,I),markerPlacement:e.markerPlacement};return l.push(X),"break"}();if("continue"===x)continue;if("break"===x)break;default:X(e,t,i,r,o,l,s,c,m)}}}}function X(e,t,r,a,i,o,l,s,f){var m,u=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}(e,t),y=["Rotation","OffsetX","OffsetY"];m=a.filter((t=>t.primitiveName!==e.primitiveName||-1===y.indexOf(t.propertyName)));var d="";for(var g of a)void 0!==g.value&&(d+="-".concat(g.primitiveName,"-").concat(g.propertyName,"-").concat(JSON.stringify(g.value)));var[v,p,b]=h.a.getTextureAnchor(u),x=e.primitiveName,O=e.rotation||0,M=e.offsetX||0,S=e.offsetY||0,C=Object(n.b)(JSON.stringify(u)+d).toString(),k={type:"marker",templateHash:C,materialHash:0===m.length?C:D(C,r,m,i),cim:u,materialOverrides:m,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:v,y:p},isAbsoluteAnchorPoint:!1,size:e.size,rotation:F(x,r,"Rotation",i,O),offsetX:F(x,r,"OffsetX",i,M),offsetY:F(x,r,"OffsetY",i,S),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:f,rotateClockwise:e.rotateClockwise,referenceSize:s,sizeRatio:b/Object(c.h)(e.size),markerPlacement:e.markerPlacement};o.push(k)}function A(e){if(e&&0===e.indexOf("Level_")){var t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function Y(e){if(!e||0===e.length)return null;var t=new s.a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function F(e,t,r,a,i,n,o){var s=t[e];if(s){var c=s[r];if("string"==typeof c||"number"==typeof c||c instanceof Array)return n?n.call(null,c,o):c;if(null!=c&&c instanceof l.a)return(e,t,r)=>{var l=Object(m.a)(c,e,{$view:r},a.geometryType,t);return null!==l&&n&&(l=n.call(null,l,o)),null!==l?l:i}}return i}function D(e,t,r,a){for(var i of r)i.valueExpressionInfo&&function(){var e=t[i.primitiveName]&&t[i.primitiveName][i.propertyName];e instanceof l.a&&(i.fn=(t,r,i)=>Object(m.a)(e,t,{$view:i},a.geometryType,r))}();return(t,a,i)=>{for(var o of r)o.fn&&(o.value=o.fn(t,a,i));return Object(n.b)(e+h.b.buildOverrideKey(r)).toString()}}function J(e,t){if(!t||0===t.length)return e;var r=JSON.parse(JSON.stringify(e));return h.b.applyOverrides(r,t),r}},419:function(e,t,r){"use strict";var a=r(91),i=r(81),n=r(93),o=r(311);var l=new Map;function s(e,t,r){var{transform:s,hasZ:c,hasM:f}=r;l.has(t)||l.set(t,function(e){var t={};switch(e){case"esriGeometryPoint":return(e,r,a,i)=>Object(o.e)(r,t,e,a,i);case"esriGeometryPolygon":return(e,r,a,i)=>Object(o.f)(r,t,e,a,i);case"esriGeometryPolyline":return(e,r,a,i)=>Object(o.g)(r,t,e,a,i);case"esriGeometryMultipoint":return(e,r,a,i)=>Object(o.d)(r,t,e,a,i);default:return i.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.a("mapview-arcade","Unable to handle geometryType: ".concat(e))),e=>e}}(t));var m=l.get(t)(e.geometry,s,c,f);return Object(a.a)(Object(a.a)({},e),{},{geometry:m})}t.a=function(e,t,r,n,o){var l=e.referencesGeometry()&&o?s(t,n,o):t,c=e.repurposeFeature(l);try{return e.evaluate(Object(a.a)(Object(a.a)({},r),{},{$feature:c}))}catch(f){return i.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",f),null}}},493:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c}));var a=r(100),i=r(350),n=r(427);function o(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":var t=e.symbolLayers;return t&&1===t.length?o(t[0]):null;case"CIMVectorMarker":var r=e.markerGraphics;if(!r||1!==r.length)return null;var a=r[0];if(!a)return null;var i=a.geometry;if(!i)return null;var n=a.symbol;return!n||"CIMPolygonSymbol"!==n.type&&"CIMLineSymbol"!==n.type?null:{geom:i,asFill:"CIMPolygonSymbol"===n.type};case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function l(e){var t=1/0,r=-1/0,a=1/0,i=-1/0;for(var n of e)for(var o of n)o[0]<t&&(t=o[0]),o[0]>r&&(r=o[0]),o[1]<a&&(a=o[1]),o[1]>i&&(i=o[1]);return[t,a,r,i]}function s(e){return e?e.rings?l(e.rings):e.paths?l(e.paths):Object(a.d)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function c(e,t,r,a,i){var[n,o,l,s]=e;if(l<n||s<o)return[0,0,0];var c=l-n,f=s-o,m=Math.floor(31.5),h=(128-2*(m+1))/Math.max(c,f),u=Math.round(c*h)+2*m,y=Math.round(f*h)+2*m,d=1;t&&(d=y/h/(t.ymax-t.ymin));var g=0,v=0;if(a)if(i){if(t&&r&&t.ymax-t.ymin>0){var p=(t.xmax-t.xmin)/(t.ymax-t.ymin);g=a.x/(r*p),v=a.y/r}}else g=a.x,v=a.y;return g=.5*(t.xmax+t.xmin)+g*(t.xmax-t.xmin),v=.5*(t.ymax+t.ymin)+v*(t.ymax-t.ymin),g-=n,v-=o,g*=h,v*=h,[d,(g+=m)/u-.5,-((v+=m)/y-.5)]}function f(e){var t=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),r=function(e){var t=1/0,r=-1/0,a=1/0,n=-1/0;for(var o of e)for(var l of o)l[0]<t&&(t=l[0]),l[0]>r&&(r=l[0]),l[1]<a&&(a=l[1]),l[1]>n&&(n=l[1]);return new i.a(t,a,r-t,n-a)}(t),a=Math.floor(31.5),n=(128-2*(a+1))/Math.max(r.width,r.height),o=Math.round(r.width*n)+2*a,l=Math.round(r.height*n)+2*a,s=[];for(var c of t)if(c&&c.length>1){var f=[];for(var h of c){var[u,y]=h;u-=r.x,y-=r.y,u*=n,y*=n,u+=a-.5,y+=a-.5,f.push([u,y])}if(e.asFill){var d=f.length-1;f[0][0]===f[d][0]&&f[0][1]===f[d][1]||f.push(f[0])}s.push(f)}var g=function(e,t,r,a){for(var i=t*r,n=new Array(i),o=a*a+1,l=0;l<i;++l)n[l]=o;for(var s of e)for(var c=s.length,f=1;f<c;++f){var m=s[f-1],h=s[f],u=void 0,y=void 0,d=void 0,g=void 0;m[0]<h[0]?(u=m[0],y=h[0]):(u=h[0],y=m[0]),m[1]<h[1]?(d=m[1],g=h[1]):(d=h[1],g=m[1]);var v=Math.floor(u)-a,p=Math.floor(y)+a,b=Math.floor(d)-a,x=Math.floor(g)+a;v<0&&(v=0),p>t&&(p=t),b<0&&(b=0),x>r&&(x=r);for(var O=h[0]-m[0],M=h[1]-m[1],S=O*O+M*M,C=v;C<p;C++)for(var k=b;k<x;k++){var P=void 0,z=void 0,w=(C-m[0])*O+(k-m[1])*M;w<0?(P=m[0],z=m[1]):w>S?(P=h[0],z=h[1]):(w/=S,P=m[0]+w*O,z=m[1]+w*M);var j=(C-P)*(C-P)+(k-z)*(k-z),I=(r-k-1)*t+C;j<n[I]&&(n[I]=j)}}for(var N=0;N<i;++N)n[N]=Math.sqrt(n[N]);return n}(s,o,l,a);return e.asFill&&function(e,t,r,a,i){for(var n of e)for(var o=n.length,l=1;l<o;++l){var s=n[l-1],c=n[l],f=void 0,m=void 0,h=void 0,u=void 0;s[0]<c[0]?(f=s[0],m=c[0]):(f=c[0],m=s[0]),s[1]<c[1]?(h=s[1],u=c[1]):(h=c[1],u=s[1]);var y=Math.floor(f),d=Math.floor(m)+1,g=Math.floor(h),v=Math.floor(u)+1;y<a&&(y=a),d>t-a&&(d=t-a),g<a&&(g=a),v>r-a&&(v=r-a);for(var p=g;p<v;++p)if(s[1]>p!=c[1]>p){for(var b=(r-p-1)*t,x=y;x<d;++x)x<(c[0]-s[0])*(p-s[1])/(c[1]-s[1])+s[0]&&(i[b+x]=-i[b+x]);for(var O=a;O<y;++O)i[b+O]=-i[b+O]}}}(s,o,l,a,g),[m(g,a),o,l]}function m(e,t){for(var r=2*t,a=e.length,i=new Uint8Array(4*a),o=0;o<a;++o){var l=.5-e[o]/r;Object(n.a)(l,i,4*o)}return i}},706:function(e,t,r){"use strict";r.r(t),r.d(t,"previewCIMSymbol",(function(){return S}));var a=r(7),i=r(105),n=r(423),o=r(143),l=r(94),s=r(100),c=r(1073),f=r(106),m=r(320),h=r(418),u=r(957);class y{constructor(){}rasterizeText(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var r=this._textRasterizationCanvas,a=r.getContext("2d");this.setFontProperties(a,t),this.parameters=t,this.textLines=e.split(/\r?\n/),this.lineHeight=this.computeLineHeight();var i=this.computeTextWidth(a,t),n=this.lineHeight*this.textLines.length;r.width=i,r.height=n,this.renderedLineHeight=Math.round(this.lineHeight*t.pixelRatio),this.renderedHaloSize=t.halo.size*t.pixelRatio,this.renderedWidth=i*t.pixelRatio,this.renderedHeight=n*t.pixelRatio,this.fillStyle=function(e){return"rgba(".concat(e.slice(0,3).toString(),",").concat(e[3],")")}(t.color),this.haloStyle=function(e){return"rgb(".concat(e.slice(0,3).toString(),")")}(t.halo.color);var o=this.renderedLineHeight,l=this.renderedHaloSize;this.setFontProperties(a,t);var s=function(e,t){return"center"===e?.5*t:"right"===e?t:0}(a.textAlign,this.renderedWidth)+l,c=l,f=0,m=0;for(var h of(l>0&&this.renderHalo(a,s,c,f,m,t),m+=c,f+=s,this.textLines))a.globalCompositeOperation="destination-out",a.fillStyle="rgb(0, 0, 0)",a.fillText(h,f,m),a.globalCompositeOperation="source-over",a.fillStyle=this.fillStyle,a.fillText(h,f,m),m+=o;var u=a.getImageData(0,0,this.renderedWidth,this.renderedHeight),y=new Uint8Array(u.data);if(t.premultiplyColors)for(var d,g=0;g<y.length;g+=4)d=y[g+3]/255,y[g]=y[g]*d,y[g+1]=y[g+1]*d,y[g+2]=y[g+2]*d;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(y.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}renderHalo(e,t,r,a,i,n){var o=this.renderedWidth,l=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=l;var s=this._haloRasterizationCanvas,c=s.getContext("2d");c.clearRect(0,0,o,l),this.setFontProperties(c,n),c.fillStyle=this.haloStyle,c.strokeStyle=this.haloStyle;var f=this.renderedHaloSize<3;c.lineJoin=f?"miter":"round",f?this.renderHaloEmulated(c,t,r):this.renderHaloNative(c,t,r),e.globalAlpha=this.parameters.halo.color[3],e.drawImage(s,0,0,o,l,a,i,o,l),e.globalAlpha=1}renderHaloEmulated(e,t,r){var a=this.renderedLineHeight,i=this.renderedHaloSize;for(var n of this.textLines){for(var[o,l]of d)e.fillText(n,t+i*o,r+i*l);r+=a}}renderHaloNative(e,t,r){var a=this.renderedLineHeight,i=this.renderedHaloSize;for(var n of this.textLines){for(var o=2*i,l=0;l<5;l++){var s=.6+.1*l;e.lineWidth=s*o,e.strokeText(n,t,r)}r+=a}}setFontProperties(e,t){var r,a=t.font,n="".concat(a.style," ").concat(a.weight," ").concat(Object(i.h)(t.size*t.pixelRatio),"px ").concat(a.family,", sans-serif");switch(e.font=n,e.textBaseline="top",t.horizontalAlignment){case"left":r="left";break;case"right":r="right";break;case"center":r="center";break;default:r="left"}e.textAlign=r}computeTextWidth(e,t){var r=0;for(var a of this.textLines)r=Math.max(r,e.measureText(a).width);var i=t.font;return("italic"===i.style||"oblique"===i.style||"string"==typeof i.weight&&("bold"===i.weight||"bolder"===i.weight)||"number"==typeof i.weight&&i.weight>600)&&(r+=.3*e.measureText("A").width),r+=2*this.parameters.halo.size,Math.round(r)}computeLineHeight(){var e=1.275*this.parameters.size;return Math.round(e+2*this.parameters.halo.size)}}for(var d=[],g=0;g<360;g+=22.5)d.push([Math.cos(Math.PI*g/180),Math.sin(Math.PI*g/180)]);var v,p;(p=v||(v={})).Legend="legend",p.Preview="preview";var b=(e,t,r)=>{if(e&&e.targetSize){var a;if(r){var n=Math.max(r.frame.xmax-r.frame.xmin,r.frame.ymax-r.frame.ymin);a=e.targetSize/Object(i.h)(n)}else a=e.targetSize/t.referenceSize;return a}return e&&e.scaleFactor?e.scaleFactor:1},x={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:-2,ymin:2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};function O(e,t,r,a){var i,n;return"function"==typeof e.materialHash?(i=(0,e.materialHash)(t,r,a),n=Object(h.a)(e.cim,e.materialOverrides)):(i=e.materialHash,n=e.cim),{analyzedCIM:n,hash:i}}var M=new class{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._rasterizer=new u.a,this._textRasterizer=new y,this._pictureMarkerCache=new Map}rasterizeCIMSymbolAsync(e,t,r,i,n,o,l,c){var f=this;return Object(a.a)((function*(){i=i||(t?null!=t.centroid?"esriGeometryPolygon":Object(s.c)(t.geometry):null)||function(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(e);var a=yield f.analyzeCIMSymbol(e,t?function(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}(t.attributes):null,r,i,c);return f.rasterizeCIMSymbol(a,t,i,n,o,l)}))()}analyzeCIMSymbol(e,t,r,i,n){var o=this;return Object(a.a)((function*(){var a,s=[],c=t?{geometryType:i,spatialReference:o._spatialReference,fields:t}:null;for(var f of(yield Object(h.b)(e.data,c,s,o._avoidSDF),Object(l.u)(n),s))"CIMPictureMarker"!==f.cim.type&&"CIMPictureFill"!==f.cim.type&&"CIMPictureStroke"!==f.cim.type||(a||(a=[]),a.push(o.fetchPictureMarkerResource(f,n))),r&&"text"===f.type&&"string"==typeof f.text&&f.text.indexOf("[")>-1&&(f.text=Object(m.c)(r,f.text,f.cim.textCase));return a&&(yield Promise.all(a)),s}))()}fetchPictureMarkerResource(e,t){var r=this;return Object(a.a)((function*(){var a=e.materialHash;if(!r._pictureMarkerCache.get(a)){var i=(yield Object(f.default)(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;r._pictureMarkerCache.set(a,i)}}))()}rasterizeCIMSymbol(e,t,r,a,i,n){var o=[];for(var l of e){a&&"function"==typeof a.scaleFactor&&(a.scaleFactor=a.scaleFactor(t,i,n));var s=this._getRasterizedResource(l,t,r,a,i,n);if(s){var c=0,f=s.anchorX||0,h=s.anchorY||0,u=!1,y=0,d=0;if("esriGeometryPoint"===r){var g=b(a,l,null);if(y=Object(m.d)(l.offsetX,t,i,n)*g||0,d=Object(m.d)(l.offsetY,t,i,n)*g||0,"marker"===l.type)c=Object(m.d)(l.rotation,t,i,n)||0,u=!!l.rotateClockwise&&l.rotateClockwise;else if("text"===l.type){if(c=Object(m.d)(l.angle,t,i,n)||0,void 0!==l.horizontalAlignment)switch(l.horizontalAlignment){case"left":f=-.5;break;case"right":f=.5;break;default:f=0}if(void 0!==l.verticalAlignment)switch(l.verticalAlignment){case"top":h=.5;break;case"bottom":h=-.5;break;case"baseline":h=-.25;break;default:h=0}}}null!=s&&o.push({angle:c,rotateClockWise:u,anchorX:f,anchorY:h,offsetX:y,offsetY:d,rasterizedResource:s})}}return this.getSymbolImage(o)}getSymbolImage(e){for(var t=document.createElement("canvas"),r=t.getContext("2d"),a=0,n=0,o=0,l=0,s=[],f=0;f<e.length;f++){var m=e[f],h=m.rasterizedResource;if(h){var u=h.size,y=m.offsetX,d=m.offsetY,g=m.anchorX,v=m.anchorY,p=m.rotateClockWise||!1,b=m.angle,x=Object(i.h)(y)-u[0]*(.5+g),O=Object(i.h)(d)-u[1]*(.5+v),M=x+u[0],S=O+u[1];if(b){p&&(b=-b);var C=Math.sin(b*Math.PI/180),k=Math.cos(b*Math.PI/180),P=x*k-O*C,z=x*C+O*k,w=x*k-S*C,j=x*C+S*k,I=M*k-S*C,N=M*C+S*k,L=M*k-O*C,R=M*C+O*k;x=Math.min(P,w,I,L),O=Math.min(z,j,N,R),M=Math.max(P,w,I,L),S=Math.max(z,j,N,R)}a=x<a?x:a,n=O<n?O:n,o=M>o?M:o,l=S>l?S:l;var _=r.createImageData(h.size[0],h.size[1]);_.data.set(new Uint8ClampedArray(h.image.buffer));var H={offsetX:y,offsetY:d,rotateClockwise:p,angle:b,rasterizedImage:_,anchorX:g,anchorY:v};s.push(H)}}t.width=o-a,t.height=l-n;for(var X=-a,A=l,Y=0;Y<s.length;Y++){var F=s[Y],D=this._imageDataToCanvas(F.rasterizedImage),J=F.rasterizedImage.width,T=F.rasterizedImage.height,W=X-J*(.5+F.anchorX),U=A-T*(.5-F.anchorY);if(F.angle){var G=(360-F.angle)*Math.PI/180;r.save(),r.translate(Object(i.h)(F.offsetX),-Object(i.h)(F.offsetY)),r.translate(X,A),r.rotate(G),r.translate(-X,-A),r.drawImage(D,W,U),r.restore()}else r.drawImage(D,W+Object(i.h)(F.offsetX),U-Object(i.h)(F.offsetY))}var E=new c.b({x:X/t.width-.5,y:A/t.height-.5});return{imageData:0!==t.width&&0!==t.height?r.getImageData(0,0,t.width,t.height):r.createImageData(1,1),anchorPosition:E}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var t=this._imageDataCanvas,r=t.getContext("2d");return t.width=e.width,t.height=e.height,r.putImageData(e,0,0),t}_imageTo32Array(e,t,r){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var a=this._imageDataCanvas,i=a.getContext("2d");return a.width=t,a.height=r,i.drawImage(e,0,0,t,r),new Uint32Array(i.getImageData(0,0,t,r).data.buffer)}_getRasterizedResource(e,t,r,a,i,l){var s,c,f,h;if("esriGeometryPolyline"===r||"esriGeometryPolygon"===r){var u=a&&a.style?a.style:v.Legend,y="esriGeometryPolyline"===r?x.stroke[u]:x.fill[u];if("line"===e.type){if("CIMSolidStroke"!==e.cim.type){if("CIMPictureStroke"===e.cim.type){var d=Object(m.d)(e.width,t,i,l),{image:g,width:p,height:M}=this._getPictureResource(e,d);return this._rasterizePictureResource(e,g,p,M,y,d)}return null}({analyzedCIM:s,hash:f}=O(e,t,i,l)),c=this._embedCIMLayerInVectorMarker(s,y)}else if("marker"===e.type){if("CIMPictureMarker"===e.cim.type)return null;if("CIMVectorMarker"!==e.cim.type)return null;e.cim.offsetX=Object(m.d)(e.offsetX,t,i,l),e.cim.offsetY=Object(m.d)(e.offsetY,t,i,l),e.cim.rotation=Object(m.d)(e.rotation,t,i,l),e.cim.markerPlacement=e.markerPlacement,({analyzedCIM:s}=O(e,t,i,l)),f=Object(o.b)(JSON.stringify(s)).toString(),c=this._embedCIMLayerInVectorMarker(s,y)}else{if("text"===e.type)return null;if("fill"===e.type){if("CIMHatchFill"===e.cim.type||"CIMVectorMarker"===e.cim.type||"CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){var S,C,k,P=e.cim.size||e.cim.height;if("CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type)({image:S,width:C,height:k}=this._getPictureResource(e,P));else{({analyzedCIM:s,hash:f}=O(e,t,i,l));var z=this._rasterizer.rasterizeJSONResource(s,1,this._avoidSDF);S=z.image,C=z.size[0],k=z.size[1]}return this._rasterizePictureResource(e,S,C,k,y,null)}if("CIMSolidFill"!==e.cim.type)return null;({analyzedCIM:s,hash:f}=O(e,t,i,l)),c=this._embedCIMLayerInVectorMarker(s,y)}}}else{if("text"===e.type)return h=this._rasterizeTextResource(e,t,a,i,l);({analyzedCIM:s,hash:f}=O(e,t,i,l));var w=b(a,e,null);if("CIMPictureMarker"===e.cim.type){var j=Object(m.d)(e.size,t,i,l)*w,{image:I,width:N,height:L}=this._getPictureResource(e,j);return h={image:I,size:[N,L],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0}}Object(n.d)(s,w,{preserveOutlineWidth:!1}),c=s}f+=r,a&&(f+=JSON.stringify(a));var R=this._resourceCache;return R.has(f)?R.get(f):(h=this._rasterizer.rasterizeJSONResource(c,window.devicePixelRatio||1,this._avoidSDF),R.set(f,h),h)}_rasterizeTextResource(e,t,r,a,i){var n=b(r,e,null),o=Object(m.d)(e.text,t,a,i);if(!o||0===o.length)return null;var l=Object(m.d)(e.fontName,t,a,i),s=Object(m.d)(e.style,t,a,i),c=Object(m.d)(e.weight,t,a,i),f=Object(m.d)(e.decoration,t,a,i),h=Object(m.d)(e.size,t,a,i)*n,u=Object(m.d)(e.horizontalAlignment,t,a,i),y=Object(m.d)(e.verticalAlignment,t,a,i),d=Object(m.b)(Object(m.d)(e.color,t,a,i)),g=Object(m.b)(Object(m.d)(e.outlineColor,t,a,i)),v={color:d,size:h,horizontalAlignment:u,verticalAlignment:y,font:{family:l,style:s,weight:c,decoration:f},halo:{size:Object(m.d)(e.outlineSize,t,a,i)||0,color:g,style:s},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(o,v)}_rasterizePictureResource(e,t,r,a,n,o){var l=document.createElement("canvas"),c=l.getContext("2d");l.height=Object(i.h)(Math.max(Math.abs(n.frame.ymax-n.frame.ymin),o)),l.width=Object(i.h)(Math.abs(n.frame.xmax-n.frame.xmin));var f=c.createImageData(r,a);f.data.set(new Uint8ClampedArray(t.buffer));var m=this._imageDataToCanvas(f),h=c.createPattern(m,"repeat"),u=Math.cos((-e.cim.rotation||0)*Math.PI/180),y=Math.sin((-e.cim.rotation||0)*Math.PI/180);h.setTransform({m11:u,m12:y,m21:-y,m22:u,m41:Object(i.h)(e.cim.offsetX)||0,m42:Object(i.h)(e.cim.offsetY)||0});var d,g,v,p=n.canvasPaths;for(var b of(Object(s.g)(p)?(d=p.rings,c.fillStyle=h,g=c.fill,v=["evenodd"]):Object(s.h)(p)&&(d=p.paths,c.strokeStyle=h,c.lineWidth=o,g=c.stroke,d[0][0][1]=l.height/2,d[0][1][1]=l.height/2),c.beginPath(),d)){var x=b?b.length:0;if(x>1){var O=b[0];c.moveTo(Object(i.h)(O[0]),Object(i.h)(O[1]));for(var M=1;M<x;++M)O=b[M],c.lineTo(Object(i.h)(O[0]),Object(i.h)(O[1]));c.closePath()}}g.apply(c,v);var S=c.getImageData(0,0,l.width,l.height),C=new Uint8Array(S.data);return{size:[l.width,l.height],image:new Uint32Array(C.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(e,t){var r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;var a=r.height/r.width,n=t?a>1?Object(i.h)(t):Object(i.h)(t)/a:r.width,o=t?a>1?Object(i.h)(t)*a:Object(i.h)(t):r.height;return{image:this._imageTo32Array(r,n,o),width:n,height:o}}_embedCIMLayerInVectorMarker(e,t){var r=Object(s.g)(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol";return{type:"CIMVectorMarker",frame:t.frame,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:r,symbolLayers:[e]}}]}}}(null,!0);function S(e){return C.apply(this,arguments)}function C(){return(C=Object(a.a)((function*(e,t={}){var{size:r,maxSize:a,node:o,opacity:l}=t,s=t.cimOptions||t,{feature:c,fieldMap:f,geometryType:m,style:h}=s,u=Object(n.c)(e),y=Math.min(null!=r?r:u,null!=a?a:Object(i.i)(120));y!==u&&(e=e.clone(),Object(n.e)(e,y,{preserveOutlineWidth:!0}));var d=3;e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(d=1);var g=yield M.rasterizeCIMSymbolAsync(e,c,f,m,{scaleFactor:d,style:h}),v=document.createElement("canvas");v.width=g.imageData.width,v.height=g.imageData.height,v.getContext("2d").putImageData(g.imageData,0,0);var p=v.width/d,b=v.height/d;if(null!=r&&(null==(null==t?void 0:t.scale)||(null==t?void 0:t.scale))){var x=p/b;p=x<=1?Math.ceil(y*x):y,b=x<=1?y:Math.ceil(y/x)}var O=new Image(p,b);return O.src=v.toDataURL(),null!=l&&(O.style.opacity="".concat(l)),o&&o.appendChild(O),O}))).apply(this,arguments)}},957:function(e,t,r){"use strict";var a=r(320),i=r(350),n=r(352),o=r(493);t.a=class{dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(e,t,r){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){var[a,l,s]=n.c.rasterizeSimpleFill(this._rasterizationCanvas,e.style,t);return{size:[l,s],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type){var[c,f,m]=n.c.rasterizeSimpleLine(e.style,e.cap);return{size:[f,m],image:new Uint32Array(c.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}var h,u,y;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(h=n.a.fromSimpleMarker(e),y=Object(o.c)(h)):"CIMHatchFill"===e.type?(h=n.a.fromCIMHatchFill(e),u=new i.a(h.frame.xmin,-h.frame.ymax,h.frame.xmax-h.frame.xmin,h.frame.ymax-h.frame.ymin)):e.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type?(h=n.a.fromCIMInsidePolygon(e),u=new i.a(h.frame.xmin,-h.frame.ymax,h.frame.xmax-h.frame.xmin,h.frame.ymax-h.frame.ymin)):(h=e,y=Object(o.c)(h)),y&&!r){var[d,g,v]=Object(o.a)(y);return d?{size:[g,v],image:new Uint32Array(d.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}var[p,b,x,O,M]=n.a.rasterize(this._rasterizationCanvas,h,u,!r);return p?{size:[b,x],image:new Uint32Array(p.buffer),sdf:!1,simplePattern:!1,anchorX:O,anchorY:M}:null}rasterizeImageResource(e,t,r,i){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;var n=this._rasterizationCanvas.getContext("2d");r instanceof ImageData?n.putImageData(r,0,0):(r.setAttribute("width","".concat(e,"px")),r.setAttribute("height","".concat(t,"px")),n.drawImage(r,0,0,e,t));var o,l=n.getImageData(0,0,e,t),s=new Uint8Array(l.data);if(i)for(var c of i)if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){var[f,m,h,u]=c.oldColor,[y,d,g,v]=c.newColor;if(f===y&&m===d&&h===g&&u===v)continue;for(var p=0;p<s.length;p+=4)f===s[p]&&m===s[p+1]&&h===s[p+2]&&u===s[p+3]&&(s[p]=y,s[p+1]=d,s[p+2]=g,s[p+3]=v)}for(var b=0;b<s.length;b+=4)o=s[b+3]/255,s[b]=s[b]*o,s[b+1]=s[b+1]*o,s[b+2]=s[b+2]*o;var x=s,O=e,M=t,S=512;if(O>=S||M>=S){var C=O/M;C>1?(O=S,M=Math.round(S/C)):(M=S,O=Math.round(S*C)),x=new Uint8Array(4*O*M);var k=new Uint8ClampedArray(x.buffer);Object(a.j)(s,e,t,k,O,M,!1)}return{size:[e,t],image:new Uint32Array(x.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}}}]);
//# sourceMappingURL=133.53875db3.chunk.js.map