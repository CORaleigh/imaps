(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[7410],{67435:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=67435,e.exports=t},1843:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PropertySearch:()=>I,default:()=>T});var s=r(72791),n=r(14076),o=r(40281),u=r(20804);let a,l,i,c;const d=(e,t,r,s,n,o,a,l,i)=>new u.Z({placeholder:e,name:t,maxSuggestions:6,getSuggestions:e=>((e,t,r,s,n,o,u,a)=>{const l=[],i=e.suggestTerm.toUpperCase().replace(/'/g,"''").replace(/[\u2018\u2019]/g,"''");return o.forEach((e=>{u?l.push(`${e} LIKE '${i}%'`):l.push(`${e} LIKE '%${i}%'`)})),r.queryFeatures({returnDistinctValues:!0,outFields:s,returnGeometry:!1,orderByFields:n,num:a.activeSource?50:6,where:l.join(" OR ")}).then((r=>((e,t,r)=>{const s=[],n=[];for(let o=0;o<r.length;o++)0===r[o].attributes[t].indexOf(e)?s.push(r[o]):n.push(r[o]);return s.sort(),n.sort(),s.concat(n)})(e.suggestTerm.toUpperCase(),o[0],r.features).map((r=>({key:t,text:r.getAttribute(s[0]),sourceIndex:e.sourceIndex})))))})(e,t,r,s,n,o,a,i),getResults:e=>{const s=e.suggestResult.text.toUpperCase().replace(/'/g,"''").replace(/[\u2018\u2019]/g,"''");return r.queryFeatures({where:`${n[0]} = '${s}'`,outFields:l}).then((e=>e.features.map((e=>({feature:e,name:t})))))}}),h=e=>new Promise((t=>{const r=a.relationships.find((e=>"CONDO_PROPERTY"===e.name));a.queryRelatedFeatures({relationshipId:null===r||void 0===r?void 0:r.id,objectIds:e,outFields:["OBJECTID","REID"],returnGeometry:!1}).then((e=>{const r=[];for(const t in e)e[t].features.forEach((e=>{r.push(e.getAttribute("OBJECTID"))}));c.queryFeatures({objectIds:r,outFields:["*"],returnGeometry:!0,outSpatialReference:{wkid:102100}}).then((e=>{i.view.goTo({target:e.features}),t(e.features)}))}))})),p=(e,t)=>new Promise(((r,s)=>{const n={outFields:["*"]};""!=e?n.where=e:n.objectIds=t,a.queryFeatures(n).then((e=>{const t=[];e.features.forEach((e=>{t.push(e.getAttribute("OBJECTID"))})),h(t).then((t=>{if(e.features.length>1&&r({properties:t,features:e.features}),1===e.features.length){const s=e.features[0];s.geometry=t[0].geometry,s.layer=a,r({properties:t,features:e.features,feature:s})}s("no results")}))}))})),E=(e,t,r,s)=>new Promise((n=>{var o;e||"Owner"!==t||(e=a),!e&&["Site Address","Street Name"].includes(t)&&(e=l);const u=[];r.forEach((e=>{u.push(e.feature.getAttribute("OBJECTID"))}));let i="";4===(null===(o=e)||void 0===o?void 0:o.layerId)?(i=`${"Street Name"===t?"FULL_STREET_NAME":"SITE_ADDRESS"} = '${s}'`,((e,t)=>new Promise((r=>{const s=t.relationships.find((e=>"ADDRESSES_CONDO"===e.name)),n={outFields:["*"],objectIds:e,relationshipId:null===s||void 0===s?void 0:s.id};t.queryRelatedFeatures(n).then((e=>{const t=[],s=[];for(const r in e)e[r].features.forEach((e=>{t.push(e.getAttribute("OBJECTID")),s.push(e)}));h(t).then((e=>{if(s.length>1&&r({properties:e,features:s}),1===s.length){const t=s[0];t.geometry=e[0].geometry,t.layer=a,r({properties:e,features:s,feature:t})}}))}))})))(u,e).then((e=>{e?n(e):p(i,u).then((e=>{n(e)}))}))):p(i,u).then((e=>{n(e)}))})),f=e=>new Promise((t=>{if(!i.viewModel.selectedSuggestion){let s=[];var r;if(i.activeSource)s=null===(r=i.activeSource)||void 0===r?void 0:r.searchFields;const n=((e,t)=>{let r="";return e.length?(e.includes("OWNER")&&(r=`OWNER like '_%${t}%'`),e.includes("PIN_NUM")&&(r=`PIN_NUM like '%${t}%'`),e.includes("REID")&&(r=`REID like '%${t}%'`)):r=`SITE_ADDRESS like '%${t}%' OR FULL_STREET_NAME like '%${t}%' OR OWNER like '%${t}%' OR REID like '${t}%' OR PIN_NUM like '${t}%'`,r})(s,e.searchTerm.toUpperCase().replace(/'/g,"''").replace(/[\u2018\u2019]/g,"''"));t(((e,t)=>new Promise((r=>{var s;null===(s=document.querySelector(".esri-search__warning-menu"))||void 0===s||s.setAttribute("style","visibility: hidden");const n=[];t.queryFeatures({where:e,outFields:["*"]}).then((e=>{e.features.forEach((e=>{n.push(e.getAttribute("OBJECTID"))})),n.length&&h(n).then((t=>{r({features:e.features,properties:t})}))}))})))(n,a))}e.numResults&&E(e.results[0].source.layer,e.results[0].source.name,e.results[0].results,e.searchTerm).then((e=>{t(e)}))})),R=e=>(19===e.length&&"."===e[4]&&[e[7],e[10],e[15]].every((e=>" "===e))&&(e=e.substring(0,4)+e.substring(8,10)+e.substring(11,15)),e),g=(e,t,r,s)=>(a=t,l=e,c=r,i=s,new o.Z([d("example: 222 W HARGETT ST","Site Address",e,["ADDRESS"],["ADDRESS"],["ADDRESS"],!0,["ADDRESS","REA_REID","OBJECTID"],s),d("example: SMITH, JOHN","Owner",t,["OWNER"],["OWNER"],["OWNER"],!0,["OWNER","OBJECTID"],s),d("PIN","PIN",t,["PIN_NUM"],["PIN_NUM"],["PIN_NUM"],!0,["PIN_NUM","OBJECTID"],s),d("REID","REID",t,["REID"],["REID"],["REID"],!0,["REID","OBJECTID"],s),d("example: W HARGETT ST","Street Name",e,["STREET","ADDR_LIST"],["STREET"],["STREET"],!0,["STREET","REA_REID","OBJECTID"],s)]));var m=r(80184);const I=e=>{const t=(0,s.useRef)(null),r=(0,s.useRef)(),[o,u]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{if(!o){t.current;const s=new n.Z({container:t.current,view:e.view,allPlaceholder:"Address, owner, PIN, or REID",includeDefaultSources:!1,popupEnabled:!1});r.current=s,s.sources=g(e.addressTable,e.condosTable,e.propertyLayer,s),s.on("search-complete",(t=>{f(t).then((t=>{e.searchComplete(t)}))})),s.watch("searchTerm",(e=>{e!=R(e)&&(s.searchTerm=R(e))})),u(!0)}}),[e.view,e.addressTable,e.condosTable,e.propertyLayer,e.searchComplete]),(0,s.useEffect)((()=>{"OBJECTID IS NULL"!=e.where&&p(e.where,[]).then((t=>{e.searchComplete(t)})).catch((e=>{console.log(e)}))}),[e.where]),(0,m.jsxs)("div",{className:"flex",children:[(0,m.jsx)("div",{ref:t}),(0,m.jsxs)("calcite-tooltip-manager",{children:[(0,m.jsx)("calcite-action",{id:"propertyClear",icon:"trash",scale:"s",onClick:()=>{var t;null===(t=r.current)||void 0===t||t.clear(),e.clear()}}),(0,m.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"propertyClear",placement:"bottom",children:"Clear selected properties"})]})]})},T=I},23084:(e,t,r)=>{"use strict";r.d(t,{cv:()=>a,en:()=>u,lA:()=>o});var s=r(84652),n=r(35995);function o(e,t){return t?{...t,query:{...e,...t.query}}:{query:e}}function u(e){return"string"==typeof e?(0,n.mN)(e):(0,s.d9)(e)}function a(e,t,r){const s={};for(const n in e){if("declaredClass"===n)continue;const o=e[n];if(null!=o&&"function"!=typeof o)if(Array.isArray(o)){s[n]=[];for(let e=0;e<o.length;e++)s[n][e]=a(o[e])}else if("object"==typeof o)if(o.toJSON){const e=o.toJSON(r&&r[n]);s[n]=t?e:JSON.stringify(e)}else s[n]=t?o:JSON.stringify(o);else s[n]=o}return s}}}]);
//# sourceMappingURL=7410.f24f642a.chunk.js.map