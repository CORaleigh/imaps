"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[9381],{89381:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Z});var s=r(85580),a=r(72791),o=r(64326),i=r(91946),n=r(83777),c=r(20804),l=r(44443),u=r(83589),d=(r(76200),r(23084),r(55465),r(27366)),p=(r(59486),r(46784)),h=r(49861),g=r(25243),y=(r(63780),r(69912)),m=r(78952);let v=class extends p.wq{constructor(e){super(e),this.addresses=null,this.categories=null,this.countryCode=null,this.locationType=null,this.outSpatialReference=null}};(0,d._)([(0,h.Cb)({type:[Object],json:{read:{reader:e=>e&&e.records?e.records.map((e=>e.attributes)):null},write:{writer:(e,t)=>{const r=[];Array.isArray(e)&&e.forEach((e=>{r.push({attributes:e})})),t.addresses={records:r}}}}})],v.prototype,"addresses",void 0),(0,d._)([(0,h.Cb)({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],v.prototype,"categories",void 0),(0,d._)([(0,h.Cb)({type:String,json:{read:{source:"sourceCountry"},write:{target:"sourceCountry"}}})],v.prototype,"countryCode",void 0),(0,d._)([(0,h.Cb)({type:String,json:{write:!0}})],v.prototype,"locationType",void 0),(0,d._)([(0,h.Cb)({type:m.Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],v.prototype,"outSpatialReference",void 0),v=(0,d._)([(0,y.j)("esri.rest.support.AddressesToLocationsParameters")],v),v.from=(0,g.se)(v);r(88736),r(1360);var w=r(52639),f=r(61459),b=r(51995),S=r(26997);const C=async()=>{const e=new o.default({portalItem:{id:"edb2153e06c2477995f95b27e5c24661"},title:"Intersection",layerId:0});await e.load();return new c.Z({name:"Intersection",placeholder:"Enter first street name",layer:e,autoNavigate:!1,resultGraphicEnabled:!1})},T=()=>new l.Z({name:"Street Address",placeholder:"Enter an address",url:"https://maps.raleighnc.gov/arcgis/rest/services/Locators/Locator/GeocodeServer",autoNavigate:!0,resultSymbol:new i.Z({url:"assets/pin.svg",height:36,width:36})}),j=(e,t)=>{"point"===t.type?e.graphics.add(new w.Z({geometry:t,attributes:{type:"location"},symbol:new i.Z({url:"assets/pin.svg",height:36,width:36})})):e.graphics.add(new w.Z({geometry:t,attributes:{type:"location"},symbol:new f.Z({color:new b.Z([0,255,255,.25]),outline:{color:new b.Z([0,255,255,1]),width:2}})}))},A=e=>{e.graphics.removeMany(e.graphics.filter((e=>"location"===e.getAttribute("type"))))},x={title:"Location Search Tips",tips:[{title:"Search By Place",text:"Search for places of interest such as schools and parks by typing the name of the school or park you are looking for."}]},R=e=>{const t=(0,a.useRef)(null),r=(0,a.useRef)(null),s=(0,a.useRef)(!1),o=(0,a.useRef)(),i=(0,a.useRef)(),[c,l]=(0,a.useState)(!1),[u,d]=(0,a.useState)([]),[p,h]=(0,a.useState)(""),[g,y]=(0,a.useState)(!1);(0,a.useEffect)((()=>{var a,c;!s.current&&t.current&&(s.current=!0,(async(e,t)=>{const r=[],s=await T();r.push(s);const a=await C();r.push(a);const o=new n.Z({view:e,maxSuggestions:30,searchAllEnabled:!0,popupEnabled:!1,container:t,goToOverride:(e,t)=>{e.goTo({target:t.target.target,zoom:17},{duration:1e3,easing:"ease"})}});return o.sources.addMany(r),o.allSources.on("after-add",(e=>{if(e.item.layer){const t=e.item;t.name=e.item.layer.title,t.placeholder=e.item.layer.title}e.item.name.includes("World Geocoding")&&o.allSources.remove(e.item)})),o})(e.view,t.current).then((t=>{o.current=t,((e,t,r,s,a,o)=>{e.on("search-complete",(async t=>{if(o.graphic=null,a(t.searchTerm),r("Intersection"===t.results[0].source.name),"Intersection"===t.results[0].source.name){const e=await t.results[0].source.layer.queryFeatures({geometry:t.results[0].results[0].feature.geometry,returnGeometry:!1,outFields:["CARTONAME"],orderByFields:["CARTONAME"]});s(e.features.map((e=>e.getAttribute("CARTONAME"))))}else{A(e.view);const r=[];t.results[0].results.forEach((t=>{j(e.view,t.feature.geometry),r.push(t.feature),o.graphic=t.feature}))}}))})(t,e.view,l,d,h,i.current)})),i.current=(a=e.view,c=r.current,new S.Z({view:a,container:c})))})),(0,a.useEffect)((()=>{y(e.isActive)}),[e.isActive]);const m=(0,a.useCallback)((t=>{e.panelDismissed()}),[]),v=(0,a.useCallback)((t=>{e.showTips(x)}),[]);return{searchDiv:t,featureDiv:r,search:o,isIntersection:c,intersections:u,searchTerm:p,isActive:g,panelDismissed:m,tipsClicked:v}};var k=r(80184);function E(e){const{searchDiv:t,featureDiv:r,search:a,isIntersection:o,intersections:i,searchTerm:n,isActive:c,panelDismissed:l,tipsClicked:d}=R(e);return(0,k.jsxs)(s.N$,{id:"location-panel",heading:"Location Search",hidden:!c,closed:!c||void 0,closable:!0,onCalcitePanelClose:l,children:[(0,k.jsx)(s.G1,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:d}),(0,k.jsx)(s.$A,{label:"Show Tip",referenceElement:"tip",closeOnClick:!0,children:"Show Tip"}),(0,k.jsxs)("div",{id:"location-search",children:[(0,k.jsx)("div",{ref:t}),o&&(0,k.jsx)("div",{id:"intersection-search",children:(0,k.jsxs)(s.ZK,{children:["Intersections",(0,k.jsx)(s.Y,{label:"",selectionMode:"single",scale:"l",children:i.map(((e,t)=>(0,k.jsx)(s.tp,{textLabel:e,value:e,onCalciteComboboxItemChange:t=>{var r;t.target.selected&&(async(e,t,r)=>{const s=`${e} & ${t}`,a=await(0,u.h)("https://maps.raleighnc.gov/arcgis/rest/services/Locators/Locator/GeocodeServer",{address:{outSpatialReference:r.spatialReference,SingleLine:s}});a.length&&(A(r),j(r,a[0].location),r.goTo({target:a[0].location,zoom:17},{duration:1e3,easing:"ease"}))})(e,n,null===a||void 0===a||null===(r=a.current)||void 0===r?void 0:r.view)}},t)))})]})}),(0,k.jsx)("div",{id:"location-feature",ref:r})]})]})}const Z=a.memo(E)}}]);
//# sourceMappingURL=9381.a135ceb3.chunk.js.map