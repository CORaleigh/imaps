"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[5107],{35107:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var i=s(27366),n=s(66978),a=s(68860),r=s(8025),l=(s(63780),s(93169),s(25243),s(49861)),o=s(69912),u=s(69407),h=s(100),d=s(92026),c=s(94172),m=s(79803),p=s(77671),_=(s(59486),s(52639)),v=(s(59166),s(51508),s(5163)),y=s(2170),b=s(15559),w=s(93655),g=s(50951),C=s(59968),f=s(74229),M=s(2346),D=s(45900),L=s(41201),S=s(36257),I=s(7882),O=s(75021),T=s(58009),k=s(73268),Z=s(16072),$=s(29909),U=s(78952);const x=1e5;let A=class extends D.m{constructor(e){super(e),this._drawActive=!1,this._handles=new h.Z,this._measurementLayer=new w.Z({internal:!0,listMode:"hide",visible:!1}),this._manipulatorLayer=new w.Z({internal:!0,listMode:"hide",visible:!1}),this._vertices=[],this.geodesicDistanceThreshold=1e5,this.measurement=null,this.measurementLabel=null}initialize(){(0,L.ME)("esri/core/t9n/Units").then((e=>{this.messages=e})),this._handles.add((0,S.qe)((async()=>{this.messages=await(0,L.ME)("esri/core/t9n/Units")})));const e=this.view;this._draw=new C.Z({view:e}),e.map.addMany([this._measurementLayer,this._manipulatorLayer]),e.focus(),this._handles.add([(0,c.YP)((()=>[this.unit,this.geodesicDistanceThreshold,this.palette,this.messages]),(()=>{this._vertices.length>0&&this._updatePolylines()}),c.nn)])}destroy(){const{map:e}=this.view;this._draw.view=null,this._draw=(0,d.SC)(this._draw),e.removeMany([this._measurementLayer,this._manipulatorLayer]),this._handles.removeAll(),this._measurementLayer.removeAll(),this._manipulatorLayer.removeAll(),this._set("measurement",null),this._set("measurementLabel",null),this._handles=(0,d.SC)(this._handles),this._measurementLayer=(0,d.SC)(this._measurementLayer),this._manipulatorLayer=(0,d.SC)(this._manipulatorLayer)}get cursor(){return this._drawActive?"crosshair":null}set editable(e){this._set("editable",e),e||this._draw.reset()}onActivate(){this._drawActive||0!==this._vertices.length||this._startSketch()}onShow(){this._measurementLayer.visible=!0,this._manipulatorLayer.visible=!0}onHide(){this._measurementLayer.visible=!1,this._manipulatorLayer.visible=!1}reset(){this._vertices=[],this._measurementLayer.removeAll(),this._set("measurement",null),this._set("measurementLabel",null),this._draw.reset(),this._drawActive=!1,this._updateSketch([])}_startSketch(){this._drawActive=!0;const e=this._draw.create("polyline",{mode:"click"});e.on(["vertex-add","vertex-update","vertex-remove","cursor-update","undo","redo"],(e=>this._updateSketch(e.vertices))),e.on("draw-complete",(()=>{this._stopSketch()}))}_stopSketch(){this.manipulators.forEach((e=>{e.manipulator.interactive=!0})),this._drawActive=!1,this.finishToolCreation()}_updateSketch(e){if(e.length<2)return this._vertices=[],this.manipulators.removeAll(),void this._measurementLayer.removeAll();const{spatialReference:t}=this.view;for(;this._vertices.length>e.length;){const{manipulatorId:e}=this._vertices.pop();this.manipulators.remove(e)}for(let l=this._vertices.length;l<e.length;l++){const[s,i]=e[l],n=W(new I.Z({x:s,y:i,spatialReference:t}),this.view,this._manipulatorLayer,this.palette),a=this.manipulators.add(n);(0,f.Xd)(n,((e,t)=>{t.next((0,f.Cf)(this.view)).next((0,f.a9)(e.graphic,g.JY.Local)).next((()=>{const t=e.graphic.geometry;this._vertices[l].coord=[t.x,t.y],this._updatePolylines()}))})),this._vertices.push({manipulatorId:a,coord:[s,i]})}const s=this._vertices.length-1,i=this._vertices[s],[n,a]=e[s];if(i.coord[0]!==n||i.coord[1]!==a){i.coord=[n,a];const e=new I.Z({x:n,y:a,spatialReference:t});this.manipulators.findById(i.manipulatorId).graphic.geometry=e}const r=this._drawActive?this._vertices[s].manipulatorId:null;this.manipulators.forEach((e=>{e.manipulator.interactive=null==r||e.id!==r})),this._updatePolylines()}_updatePolylines(){const e=this._vertices.map((e=>e.coord)),{measurement:t,drawing:s,original:i}=function(e,t,s){const i=new $.Z({paths:[e],spatialReference:t});let n,a;if(t.isGeographic)if((0,b.Gb)(t))n=(0,b.Jf)([i],"meters")[0],a=(0,b.j2)(i,x);else{const e=(0,m.iV)(i,U.Z.WGS84),s=(0,b.j2)(e,x);n=(0,b.Jf)([e],"meters")[0],a=(0,m.iV)(s,t)}else if(t.isWebMercator)n=(0,y.geodesicLength)(i,"meters"),a=(0,y.geodesicDensify)(i,x,"meters");else{const e=(0,y.planarLength)(i,"meters");if(e>=s){const e=(0,m.iV)(i,U.Z.WGS84),s=(0,b.j2)(e,x);n=(0,b.Jf)([e],"meters")[0],a=(0,m.iV)(s,t)}else n=e,a=i}return{measurement:{geometry:a,length:n},original:i,drawing:a}}(e,this.view.spatialReference,this.geodesicDistanceThreshold);this._set("measurement",t);const n=function(e,t,s){if(!t||!e)return null;switch(s){case"metric":return(0,v.Rd)(e,t.length,"meters");case"imperial":return(0,v.Ud)(e,t.length,"meters");default:return(0,v.VG)(e,(0,a.En)(t.length,"meters",s),s)}}(this.messages,t,this.unit);let r,l;this._set("measurementLabel",n);const{graphics:o}=this._measurementLayer;if(2===o.length)r=o.getItemAt(0),l=o.getItemAt(1);else{const{pathPrimaryColor:e,pathSecondaryColor:t,pathWidth:s}=this.palette;r=new _.Z({symbol:new O.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[14,12],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:s-1.5,color:t},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:s,color:e}]}}})}),l=new _.Z({symbol:new T.Z({color:[255,255,255,1],haloColor:[0,0,0,.5],haloSize:2,font:new k.Z({size:14,family:"sans-serif"})})}),o.removeAll(),o.addMany([r,l])}r.geometry=s,l.geometry=i.extent.center,l.symbol.text=n}};function W(e,t,s,i){const n=new Z.Z({style:"circle",color:i.handleColor,size:i.handleWidth,outline:{type:"simple-line",width:0}}),a=new Z.Z({style:"circle",color:i.handleColor,size:1.5*i.handleWidth,outline:{type:"simple-line",width:0}}),r=new _.Z({geometry:e,symbol:n});return new M.L({view:t,layer:s,graphic:r,focusedSymbol:a})}(0,i._)([(0,l.Cb)()],A.prototype,"_drawActive",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],A.prototype,"cursor",null),(0,i._)([(0,l.Cb)({value:!0})],A.prototype,"editable",null),(0,i._)([(0,l.Cb)({type:Number})],A.prototype,"geodesicDistanceThreshold",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],A.prototype,"measurement",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],A.prototype,"measurementLabel",void 0),(0,i._)([(0,l.Cb)()],A.prototype,"messages",void 0),(0,i._)([(0,l.Cb)()],A.prototype,"palette",void 0),(0,i._)([(0,l.Cb)()],A.prototype,"unit",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],A.prototype,"view",void 0),A=(0,i._)([(0,o.j)("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DTool")],A);var R=s(32845);const P={handleWidth:8,handleColor:[255,128,0,.5],pathWidth:5,pathPrimaryColor:[255,128,0,255],pathSecondaryColor:[255,255,255,255]};let E=class extends R.V{constructor(e){super(e),this.supportedViewType="2d",this.unsupportedErrorMessage="DistanceMeasurement2DViewModel is only supported in 2D views.",this._handles=new h.Z,this.geodesicDistanceThreshold=1e5,this.measurement=null,this.measurementLabel=null,this.palette=P}initialize(){this._handles.add([(0,c.YP)((()=>(0,d.Wg)(this.view)?.spatialReference),(()=>this.clear())),(0,c.YP)((()=>this.unit),(e=>{(0,d.pC)(this.tool)&&(this.tool.unit=e)}),c.nn),(0,c.YP)((()=>this.geodesicDistanceThreshold),(e=>{(0,d.pC)(this.tool)&&(this.tool.geodesicDistanceThreshold=e)}),c.nn),(0,c.YP)((()=>this.palette),(e=>{(0,d.pC)(this.tool)&&(this.tool.palette=e)}),c.nn)])}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}get state(){return this.disabled||(0,d.Wi)(this.view)||(e=this.view?.spatialReference,null==e)?"disabled":(0,d.pC)(this.tool)&&this.measurement?this.tool.active?"measuring":"measured":"ready";var e}get unit(){return this._validateUnit(this.defaultUnit)}set unit(e){void 0!==e?this._override("unit",this._validateUnit(e)):this._clearOverride("unit")}get unitOptions(){return a.oD}set unitOptions(e){void 0!==e?this._override("unitOptions",this._validateUnits(e)):this._clearOverride("unitOptions")}async start(){const e=this.view;(0,d.pC)(e)&&(await(0,c.N1)((()=>e.ready)),function(e){if(!e)return!1;const{isGeographic:t,isWebMercator:s,isWGS84:i}=e;return t&&!i&&!(0,b.Gb)(e)||!t&&!s}(e.spatialReference)&&await(0,m.zD)()),this.createTool({interactive:!0})}clear(){this.removeTool()}constructTool(){return new A({view:(0,d.Wg)(this.view),visible:this.visible,geodesicDistanceThreshold:this.geodesicDistanceThreshold,palette:this.palette,unit:this.unit})}_validateUnit(e){return this.unitOptions.includes(e)?e:this.unitOptions.includes(this.defaultUnit)?this.defaultUnit:this.unitOptions[0]}_validateUnits(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((e=>a.oD.includes(e)));return 0===e.length?a.oD.slice():e}};(0,i._)([(0,l.Cb)(p.Y)],E.prototype,"defaultUnit",void 0),(0,i._)([(0,l.Cb)({type:Number})],E.prototype,"geodesicDistanceThreshold",void 0),(0,i._)([(0,l.Cb)({readOnly:!0,aliasOf:"tool.measurement"})],E.prototype,"measurement",void 0),(0,i._)([(0,l.Cb)({readOnly:!0,aliasOf:"tool.measurementLabel"})],E.prototype,"measurementLabel",void 0),(0,i._)([(0,l.Cb)()],E.prototype,"palette",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],E.prototype,"state",null),(0,i._)([(0,l.Cb)({type:String})],E.prototype,"unit",null),(0,i._)([(0,l.Cb)({type:[String]})],E.prototype,"unitOptions",null),E=(0,i._)([(0,o.j)("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DViewModel")],E);const V=E;var B=s(78088),G=s(80532),j=s(67005);s(80975);const z="esri-distance-measurement-2d",Y={buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-measure-line",base:`${z} esri-widget esri-widget--panel`,container:`${z}__container`,hint:`${z}__hint`,hintText:`${z}__hint-text`,panelError:`${z}__panel--error`,measurement:`${z}__measurement`,measurementItem:`${z}__measurement-item`,measurementItemDisabled:`${z}__measurement-item--disabled`,measurementItemTitle:`${z}__measurement-item-title`,measurementItemValue:`${z}__measurement-item-value`,settings:`${z}__settings`,units:`${z}__units`,unitsLabel:`${z}__units-label`,unitsSelect:`${z}__units-select esri-select`,unitsSelectWrapper:`${z}__units-select-wrapper`,actionSection:`${z}__actions`,newMeasurementButton:`${z}__clear-button esri-button esri-button--primary`};let J=class extends u.Z{constructor(e,t){super(e,t),this.iconClass=Y.widgetIcon,this.label=void 0,this.messages=null,this.messagesUnits=null,this.unit=null,this.unitOptions=null,this.view=null,this.viewModel=new V}render(){const{id:e,messages:t,messagesUnits:s,viewModel:i,visible:n}=this,{active:r,supported:l,measurementLabel:o,state:u,unit:h,unitOptions:d}=i,c="disabled"===u,m="measuring"===u||"measured"===u,p=r&&"ready"===u?(0,j.u)("section",{key:"hint",class:Y.hint},(0,j.u)("p",{class:Y.hintText},t.hint)):null,_=l?null:(0,j.u)("section",{key:"unsupported",class:Y.panelError},(0,j.u)("p",null,t.unsupported)),v=m?(0,j.u)("section",{key:"measurement",class:Y.measurement},((e,t,s)=>t?(0,j.u)("div",{key:`${s}-enabled`,class:Y.measurementItem},(0,j.u)("span",{class:Y.measurementItemTitle},e),(0,j.u)("span",{class:Y.measurementItemValue},t)):(0,j.u)("div",{key:`${s}-disabled`,class:this.classes(Y.measurementItem,Y.measurementItemDisabled),"aria-disabled":"true"},(0,j.u)("span",{class:Y.measurementItemTitle},e)))(t.distance,o,"distance")):null,y=`${e}-units`,b=m?(0,j.u)("section",{key:"units",class:Y.units},(0,j.u)("label",{class:Y.unitsLabel,for:y},t.unit),(0,j.u)("div",{class:Y.unitsSelectWrapper},(0,j.u)("select",{class:Y.unitsSelect,id:y,onchange:this._changeUnit,bind:this,value:h},d.map((e=>(0,j.u)("option",{key:e,value:e},(0,a.ZO)(e)?s.systems[e]:s.units[e]?.pluralCapitalized)))))):null,w=m?(0,j.u)("div",{key:"settings",class:Y.settings},b):null,g=!l||r&&!m?null:(0,j.u)("div",{class:Y.actionSection},(0,j.u)("button",{disabled:c,class:this.classes(Y.newMeasurementButton,c&&Y.buttonDisabled),bind:this,onclick:this._newMeasurement,title:t.newMeasurement,"aria-label":t.newMeasurement,type:"button"},t.newMeasurement)),C=n?(0,j.u)("div",{class:Y.container},_,p,w,v,g):null;return(0,j.u)("div",{class:Y.base},C)}_newMeasurement(){(0,n.R8)(this.viewModel.start())}_changeUnit(e){const t=e.target,s=t.options[t.selectedIndex];s&&(this.viewModel.unit=s.value)}};(0,i._)([(0,r.B)("viewModel.active")],J.prototype,"active",void 0),(0,i._)([(0,l.Cb)()],J.prototype,"iconClass",void 0),(0,i._)([(0,l.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],J.prototype,"label",void 0),(0,i._)([(0,l.Cb)()],J.prototype,"uiStrings",void 0),(0,i._)([(0,l.Cb)(),(0,G.H)("esri/widgets/DistanceMeasurement2D/t9n/DistanceMeasurement2D")],J.prototype,"messages",void 0),(0,i._)([(0,l.Cb)(),(0,G.H)("esri/core/t9n/Units")],J.prototype,"messagesUnits",void 0),(0,i._)([(0,r.B)("viewModel.unit")],J.prototype,"unit",void 0),(0,i._)([(0,r.B)("viewModel.unitOptions")],J.prototype,"unitOptions",void 0),(0,i._)([(0,r.B)("viewModel.view")],J.prototype,"view",void 0),(0,i._)([(0,l.Cb)({type:V})],J.prototype,"viewModel",void 0),(0,i._)([(0,r.B)("viewModel.visible")],J.prototype,"visible",void 0),(0,i._)([(0,B.h)()],J.prototype,"_newMeasurement",null),(0,i._)([(0,B.h)()],J.prototype,"_changeUnit",null),J=(0,i._)([(0,o.j)("esri.widgets.DistanceMeasurement2D")],J);const N=J}}]);
//# sourceMappingURL=5107.9a713b96.chunk.js.map