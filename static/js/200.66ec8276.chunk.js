(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[200],{1191:function(e,t,r){"use strict";r.r(t),r.d(t,"GraphicsSnappingSource",(function(){return S}));var a=r(7),i=r(82),n=(r(80),r(89)),s=(r(81),r(88),r(85)),o=r(84),c=(r(83),r(86),r(87),r(209)),d=r(94),u=r(97),p=r(113),l=r(130),h=r(183),m=r(223),f=r(292),y=r(168),x=r(167),b=r(312),v=r(553),O=r(876),g=r(766),j=r(868),S=class extends(Object(x.b)(u.a)){constructor(e){super(e),this.availability=1,this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){var e=this.pendingAdds;for(var t of(this.pendingAdds.length=0,e))t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on("graphic-update",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}fetchCandidates(e,t){var r=this;return Object(a.a)((function*(){var a=(yield Object(d.k)(r.mapSources((r=>r.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.toPoint(e.point,new p.a).toJSON(),distance:e.distance,types:e.types,query:Object(n.k)(e.filter)?e.filter.createQuery().toJSON():{where:"1=1"}},t).then((({candidates:e})=>e)))))).flat().map((t=>Object(j.a)(t,e.coordinateHelper)));return Object(b.e)(e.point,a),{candidates:a}}))()}refresh(){}onGraphicUpdate(e){switch(e.property){case"geometry":case"visible":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(var t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){var t=[],r=new Map;for(var a of e)Object(n.j)(a.geometry)||(this.needsInitializeProjection(a.geometry.spatialReference)?(t.push(a.geometry.spatialReference),r.set(a.uid,a)):this.add(a));this.createPendingAdd(t,r)}createPendingAdd(e,t){var r=this;if(e.length){var i=Object(d.h)(function(){var i=Object(a.a)((function*(a){for(var[,i]of(yield Object(m.f)(e.map((e=>({source:e,dest:r.spatialReference}))),{signal:a}),r.markLoadedSpatialReferences(e),t))r.add(i)}));return function(e){return i.apply(this,arguments)}}());this.updatingHandles.addPromise(i.promise);var n={task:i,graphics:t},s=()=>Object(c.j)(this.pendingAdds,n);i.promise.then(s,s),this.pendingAdds.push(n)}}markLoadedSpatialReferences(e){for(var t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if(!Object(n.j)(e.geometry)&&e.visible){var t=e.geometry;if("mesh"!==t.type){"extent"===t.type&&(t=l.a.fromExtent(t));var r=this.ensureSource(t.type);if(!Object(n.j)(r)){var a=this.createOptimizedFeature(e.uid,t);Object(n.k)(a)&&r.featureStore.add(a)}}}}needsInitializeProjection(e){return(null==e.wkid||!this.loadedWkids.has(e.wkid))&&(null==e.wkt||!this.loadedWkts.has(e.wkt))&&!Object(m.b)(e,this.spatialReference)}createOptimizedFeature(e,t){var r=Object(m.j)(Object(v.a)(t),this.spatialReference);return r?new f.a(Object(y.d)(r,!1,!1),{[w]:e},null,e):null}ensureSource(e){var t=this.sources[e];if(Object(n.k)(t))return t;var r=this.createSource(e);return this.sources[e]=r,r}createSource(e){var t=h.a.toJSON(e),r=new O.a({geometryType:t,hasZ:!1,hasM:!1});return{featureStore:r,queryEngine:new g.a({featureStore:r,fields:[{name:w,type:"esriFieldTypeOID",alias:w}],geometryType:t,hasM:!1,hasZ:!1,objectIdField:w,spatialReference:this.spatialReference,scheduler:Object(n.k)(this.view)&&"3d"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){for(var t of(this.mapSources((t=>this.removeFromSource(t,e))),this.pendingAdds))t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){var r=t.uid;e.featureStore.has(r)&&e.featureStore.removeById(t.uid)}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){var{point:t,polygon:r,polyline:a,multipoint:i}=this.sources,s=[];return Object(n.k)(t)&&s.push(e(t)),Object(n.k)(r)&&s.push(e(r)),Object(n.k)(a)&&s.push(e(a)),Object(n.k)(i)&&s.push(e(i)),s}};Object(i.a)([Object(s.b)({constructOnly:!0})],S.prototype,"spatialReference",void 0),Object(i.a)([Object(s.b)({constructOnly:!0})],S.prototype,"layerSource",void 0),Object(i.a)([Object(s.b)({constructOnly:!0})],S.prototype,"view",void 0),Object(i.a)([Object(s.b)({readOnly:!0})],S.prototype,"updating",null),Object(i.a)([Object(s.b)({readOnly:!0})],S.prototype,"availability",void 0),S=Object(i.a)([Object(o.a)("esri.views.interactive.snapping.featureSources.GraphicsSnappingSource")],S);var w="OBJECTID"},553:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var a=r(112),i=r(354),n=r(210),s=r(100),o=r(125),c=r(243);function d(e){if(!e)return null;if("mesh"===e.type)return e.toJSON();var t=null,r=e.spatialReference,o=Object(a.d)(r);if(!o)return e.toJSON();var d,l=r.isWebMercator?102100:4326,h=c.a[l].maxX,m=c.a[l].minX,x=c.a[l].plus180Line,b=c.a[l].minus180Line,v=e.toJSON();if(Object(s.f)(v))d=p(v,h,m);else if(Object(s.e)(v))v.points=v.points.map((e=>p(e,h,m))),d=v;else if(Object(s.d)(v))d=u(v,o);else if(Object(s.g)(v)||Object(s.h)(v)){var O=y;Object(n.a)(O,v);var g={xmin:O[0],ymin:O[1],xmax:O[2],ymax:O[3]},j=Object(c.d)(g.xmin,m)*(2*h),S=0===j?v:function(e,t){var r=Object(c.b)(e);for(var a of r)for(var i of a)i[0]+=t;return e}(v,j);g.xmin+=j,g.xmax+=j,Object(i.a)(g,x)&&g.xmax!==h||Object(i.a)(g,b)&&g.xmin!==m?t=S:d=S}else d=e.toJSON();return null!==t?(new f).cut(t,h):d}function u(e,t){if(!t)return e;var r=function(e,t){var r,a=[],{ymin:i,ymax:n}=e,s=e.xmax-e.xmin,o=e.xmin,c=e.xmax,[d,u]=t.valid,p=(r=l(e.xmin,t)).x,m=r.frameId,f=(r=l(e.xmax,t)).x,y=r.frameId,x=p===f&&s>0;if(s>2*u){var b={xmin:o<c?p:f,ymin:i,xmax:u,ymax:n},v={xmin:d,ymin:i,xmax:o<c?f:p,ymax:n},O={xmin:0,ymin:i,xmax:u,ymax:n},g={xmin:d,ymin:i,xmax:0,ymax:n},j=[],S=[];h(b,O)&&j.push(m),h(b,g)&&S.push(m),h(v,O)&&j.push(y),h(v,g)&&S.push(y);for(var w=m+1;w<y;w++)j.push(w),S.push(w);a.push({extent:b,frameIds:[m]},{extent:v,frameIds:[y]},{extent:O,frameIds:j},{extent:g,frameIds:S})}else p>f||x?a.push({extent:{xmin:p,ymin:i,xmax:u,ymax:n},frameIds:[m]},{extent:{xmin:d,ymin:i,xmax:f,ymax:n},frameIds:[y]}):a.push({extent:{xmin:p,ymin:i,xmax:f,ymax:n},frameIds:[m]});return a}(e,t).map((e=>e.extent));return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}}function p(e,t,r){if(Array.isArray(e)){var a=e[0];if(a>t){var i=Object(c.d)(a,t);e[0]=a+i*(-2*t)}else if(a<r){var n=Object(c.d)(a,r);e[0]=a+n*(-2*r)}}else{var s=e.x;if(s>t){var o=Object(c.d)(s,t);e.x+=o*(-2*t)}else if(s<r){var d=Object(c.d)(s,r);e.x+=d*(-2*r)}}return e}function l(e,t){var r,[a,i]=t.valid,n=2*i,s=0;return e>i?(e-=(r=Math.ceil(Math.abs(e-i)/n))*n,s=r):e<a&&(e+=(r=Math.ceil(Math.abs(e-a)/n))*n,s=-r),{x:e,frameId:s}}function h(e,t){var{xmin:r,ymin:a,xmax:i,ymax:n}=t;return m(e,r,a)&&m(e,r,n)&&m(e,i,n)&&m(e,i,a)}function m(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}class f{cut(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var a=r.length,i=-2*t,n=0;n<a;n++){var s=r[n];if(s&&s.length>=this.minPts){var o=[];for(var c of s)o.push([c[0]+i,c[1]]);r.push(o)}}return this.closed?e.rings=r:e.paths=r,e}}var y=Object(o.i)()},868:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(91),i=r(530),n=r(691),s=r(552);class o extends n.a{constructor(e){super(Object(a.a)(Object(a.a)({},e),{},{constraint:new s.b(e.coordinateHelper,e.edgeStart,e.edgeEnd)}))}get hints(){return[new i.a(1,this.constraint.start,this.constraint.end)]}}var c=r(662);class d extends n.a{constructor(e){super(Object(a.a)(Object(a.a)({},e),{},{constraint:new s.d(e.coordinateHelper,e.targetPoint)}))}get hints(){return[new c.a(this.targetPoint)]}}function u(e,t){switch(e.type){case"edge":return new o({coordinateHelper:t,edgeStart:t.fromPoint(e.start),edgeEnd:t.fromPoint(e.end),targetPoint:t.fromPoint(e.target),objectId:e.objectId});case"vertex":return new d({coordinateHelper:t,targetPoint:t.fromPoint(e.target),objectId:e.objectId})}}}}]);
//# sourceMappingURL=200.66ec8276.chunk.js.map