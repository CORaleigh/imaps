"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[8178],{40237:(t,e,s)=>{s.d(e,{N:()=>n});const n={convertToGEGeometry:function(t,e){return null==e?null:t.convertJSONToGeometry(e)},exportPoint:function(t,e,s){const n=new i(t.getPointX(e),t.getPointY(e),s),r=t.hasZ(e),a=t.hasM(e);return r&&(n.z=t.getPointZ(e)),a&&(n.m=t.getPointM(e)),n},exportPolygon:function(t,e,s){return new r(t.exportPaths(e),s,t.hasZ(e),t.hasM(e))},exportPolyline:function(t,e,s){return new a(t.exportPaths(e),s,t.hasZ(e),t.hasM(e))},exportMultipoint:function(t,e,s){return new o(t.exportPoints(e),s,t.hasZ(e),t.hasM(e))},exportExtent:function(t,e,s){const n=t.hasZ(e),i=t.hasM(e),r=new h(t.getXMin(e),t.getYMin(e),t.getXMax(e),t.getYMax(e),s);if(n){const s=t.getZExtent(e);r.zmin=s.vmin,r.zmax=s.vmax}if(i){const s=t.getMExtent(e);r.mmin=s.vmin,r.mmax=s.vmax}return r}};class i{constructor(t,e,s){this.x=t,this.y=e,this.spatialReference=s,this.z=void 0,this.m=void 0}}class r{constructor(t,e,s,n){this.rings=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),n&&(this.hasM=n)}}class a{constructor(t,e,s,n){this.paths=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),n&&(this.hasM=n)}}class o{constructor(t,e,s,n){this.points=t,this.spatialReference=e,this.hasZ=void 0,this.hasM=void 0,s&&(this.hasZ=s),n&&(this.hasM=n)}}class h{constructor(t,e,s,n,i){this.xmin=t,this.ymin=e,this.xmax=s,this.ymax=n,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},19995:(t,e,s)=>{s.d(e,{_W:()=>p,iV:()=>f,oj:()=>d});var n=s(92026),i=s(79803),r=s(40237),a=s(92975),o=s(81753);const h=[0,0];function u(t,e){if(!e)return null;if("x"in e){const s={x:0,y:0};return[s.x,s.y]=t(e.x,e.y,h),null!=e.z&&(s.z=e.z),null!=e.m&&(s.m=e.m),s}if("xmin"in e){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=t(e.xmin,e.ymin,h),[s.xmax,s.ymax]=t(e.xmax,e.ymax,h),e.hasZ&&(s.zmin=e.zmin,s.zmax=e.zmax,s.hasZ=!0),e.hasM&&(s.mmin=e.mmin,s.mmax=e.mmax,s.hasM=!0),s}return"rings"in e?{rings:l(e.rings,t),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:l(e.paths,t),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:c(e.points,t),hasM:e.hasM,hasZ:e.hasZ}:null}function l(t,e){const s=[];for(const n of t)s.push(c(n,e));return s}function c(t,e){const s=[];for(const n of t){const t=e(n[0],n[1],[0,0]);s.push(t),n.length>2&&t.push(n[2]),n.length>3&&t.push(n[3])}return s}async function p(t,e){if(!t||!e)return;const s=Array.isArray(t)?t.map((t=>(0,n.pC)(t.geometry)?t.geometry.spatialReference:null)).filter(n.pC):[t];await(0,i.iQ)(s.map((t=>({source:t,dest:e}))))}const m=u.bind(null,o.hG),y=u.bind(null,o.R6);function f(t,e,s,n){if(!t)return t;if(s||(s=e,e=t.spatialReference),!(0,a.JY)(e)||!(0,a.JY)(s)||(0,a.fS)(e,s))return t;if((0,o.Q8)(e,s)){const e=(0,a.sS)(s)?m(t):y(t);return e.spatialReference=s,e}return(0,i.oj)(r.N,[t],e,s,null,n)[0]}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(t,e,s){if(!t||!t.length||!e||!s||(0,a.fS)(e,s))return t;const n={geometries:t,inSpatialReference:e,outSpatialReference:s,resolve:null};return this._jobs.push(n),new Promise((t=>{n.resolve=t,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const t=this._jobs.shift();if(!t)return;const{geometries:e,inSpatialReference:s,outSpatialReference:n,resolve:h}=t;(0,o.Q8)(s,n)?(0,a.sS)(n)?h(e.map(m)):h(e.map(y)):h((0,i.oj)(r.N,e,s,n,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function d(t,e,s){return g.push(t,e,s)}},58178:(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var n=s(14921),i=s(10064),r=s(32718),a=s(92026),o=s(66978),h=s(92975),u=s(83406),l=s(68928),c=s(19995),p=s(14e3),m=s(47615),y=s(68808),f=s(12622),g=s(52410);class d{constructor(){this._queryEngine=null,this._customParameters=null,this._snapshotFeatures=async t=>{const{objectIdField:e}=this._queryEngine,s=await(0,f.Bm)(this._getFeatureUrl??"",this._featureType.typeName,this._getFeatureOutputFormat,{customParameters:this._customParameters,dateFields:this._queryEngine.fieldsIndex.dateFields.map((t=>t.name)),signal:t});await(0,m.O3)(s),(0,o.k_)(t);const n=(0,m.lG)(s,{geometryType:this._queryEngine.geometryType,hasZ:!1,objectIdField:e});if(!(0,h.fS)(this._queryEngine.spatialReference,h.Zn))for(const r of n)(0,a.pC)(r.geometry)&&(r.geometry=(0,u.GH)((0,c.iV)((0,u.di)(r.geometry,this._queryEngine.geometryType,!1,!1),h.Zn,this._queryEngine.spatialReference)));let i=1;for(const r of n){const t={};(0,y.O0)(this._fieldsIndex,t,r.attributes,!0),r.attributes=t,null==r.attributes[e]&&(r.objectId=r.attributes[e]=i++)}return n}}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(t,e){const{getFeatureUrl:s,getFeatureOutputFormat:n,spatialReference:i,fields:r,geometryType:h,featureType:u,objectIdField:c,customParameters:m}=t;this._featureType=u,this._customParameters=m,this._getFeatureUrl=s,this._getFeatureOutputFormat=n,this._fieldsIndex=new g.Z(r),await this._checkProjection(i),(0,o.k_)(e),this._queryEngine=new p.q({fields:r,geometryType:h,hasM:!1,hasZ:!1,objectIdField:c,spatialReference:i,timeInfo:null,featureStore:new l.Z({geometryType:h,hasM:!1,hasZ:!1})});const y=await this._snapshotFeatures((0,a.Wg)(e.signal));return this._queryEngine.featureStore.addMany(y),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new i.Z("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")}async queryFeatures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(t,e.signal)}async queryFeatureCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(t,e.signal)}async queryObjectIds(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForIds(t,e.signal)}async queryExtent(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(t,e.signal)}async querySnapping(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForSnapping(t,e.signal)}async refresh(t){return this._customParameters=t,this._snapshotTask?.abort(),this._snapshotTask=(0,n.vr)(this._snapshotFeatures),this._snapshotTask.promise.then((t=>{this._queryEngine.featureStore.clear(),t&&this._queryEngine.featureStore.addMany(t)}),(t=>{this._queryEngine.featureStore.clear(),(0,o.D_)(t)||r.Z.getLogger("esri.layers.WFSLayer").error(new i.Z("wfs-layer:getfeature-error","An error occurred during the GetFeature request",{error:t}))})),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _checkProjection(t){try{await(0,c._W)(h.Zn,t)}catch{throw new i.Z("unsupported-projection","Projection not supported",{spatialReference:t})}}}},68808:(t,e,s)=>{s.d(e,{O0:()=>p,av:()=>h,b:()=>g,d1:()=>l,og:()=>f});var n=s(92026),i=s(92975),r=s(37270);class a{constructor(){this.code=null,this.description=null}}class o{constructor(t){this.error=new a,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=t}}function h(t){return new o(t)}class u{constructor(t){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=t}}function l(t){return new u(t)}const c=new Set;function p(t,e,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;c.clear();for(const a in s){const o=t.get(a);if(!o)continue;const u=s[a],l=m(o,u);if(l!==u&&i&&i.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:o,originalValue:u,sanitizedValue:l}}),c.add(o.name),o&&(n||o.editable)){const t=(0,r.Qc)(o,l);if(t)return h((0,r.vP)(t,o,l));e[o.name]=l}}for(const r of t?.requiredFields??[])if(!c.has(r.name))return h(`missing required field "${r.name}"`);return null}function m(t,e){let s=e;return"string"==typeof e&&(0,r.H7)(t)?s=parseFloat(e):null!=e&&(0,r.qN)(t)&&"string"!=typeof e&&(s=String(e)),(0,r.Pz)(s)}let y;function f(t,e){if(!t||!(0,i.JY)(e))return t;if("rings"in t||"paths"in t){if((0,n.Wi)(y))throw new TypeError("geometry engine not loaded");return y.simplify(e,t)}return t}async function g(t,e){!(0,i.JY)(t)||"esriGeometryPolygon"!==e&&"esriGeometryPolyline"!==e||await async function(){return(0,n.Wi)(y)&&(y=await Promise.all([s.e(9058),s.e(3645)]).then(s.bind(s,50309))),y}()}}}]);
//# sourceMappingURL=8178.cdea34a5.chunk.js.map