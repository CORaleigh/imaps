{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/GraphicsSnappingSource.js","../node_modules/@arcgis/core/geometry/support/normalizeUtilsSync.js","../node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"],"names":["k","s","t","constructor","e","super","this","availability","sources","multipoint","point","polygon","polyline","loadedWkids","Set","loadedWkts","pendingAdds","updating","updatingHandles","layer","layerSource","destroy","length","task","abort","mapSources","destroySource","initialize","handles","add","on","onGraphicUpdate","addOnCollectionChange","graphics","onGraphicsChanged","addMany","toArray","a","r","queryEngine","executeQueryForSnapping","coordinateHelper","vectorToPoint","toJSON","distance","types","query","o","filter","createQuery","where","then","candidates","flat","map","v","w","refresh","property","remove","graphic","removed","added","Map","i","geometry","needsInitializeProjection","spatialReference","push","set","uid","createPendingAdd","n","async","h","source","dest","signal","markLoadedSpatialReferences","addPromise","promise","wkid","wkt","visible","type","c","fromExtent","ensureSource","createOptimizedFeature","featureStore","has","l","u","m","f","g","O","createSource","y","S","geometryType","hasZ","hasM","j","fields","name","alias","objectIdField","scheduler","view","resourceController","removeFromSource","delete","size","removeById","p","constructOnly","prototype","readOnly","d","isWebMercator","I","maxX","minX","b","plus180Line","minus180Line","J","N","points","x","M","xmin","ymin","xmax","ymax","cut","valid","frameId","extent","frameIds","rings","Array","isArray","Math","ceil","abs","closed","minPts","paths","equals","constraint","targetPoint","hints","edgeStart","pointToVector","start","edgeEnd","end","target","objectId"],"mappings":"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","file":"static/js/187.2fd85098.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import{removeUnordered as r}from\"../../../../core/arrayUtils.js\";import{HandleOwnerMixin as s}from\"../../../../core/HandleOwner.js\";import{isSome as o,isNone as i}from\"../../../../core/maybe.js\";import{eachAlwaysValues as a,createTask as n}from\"../../../../core/promiseUtils.js\";import{property as p}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as d}from\"../../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../../geometry/Polygon.js\";import{canProjectWithoutEngine as l,project as u,initializeProjection as h}from\"../../../../geometry/projection.js\";import{normalizeCentralMeridianSync as m}from\"../../../../geometry/support/normalizeUtilsSync.js\";import{featureGeometryTypeKebabDictionary as y}from\"../../../../geometry/support/typeUtils.js\";import{convertFromGeometry as g}from\"../../../../layers/graphics/featureConversionUtils.js\";import f from\"../../../../layers/graphics/OptimizedFeature.js\";import S from\"../../../../layers/graphics/data/FeatureStore.js\";import j from\"../../../../layers/graphics/data/QueryEngine.js\";import{sortCandidatesInPlace as w}from\"../snappingUtils.js\";import{convertSnappingCandidate as v}from\"./queryEngineUtils.js\";let k=class extends(s(t)){constructor(e){super(e),this.availability=1,this.sources={multipoint:null,point:null,polygon:null,polyline:null},this.loadedWkids=new Set,this.loadedWkts=new Set,this.pendingAdds=[]}get updating(){return this.updatingHandles.updating}get layer(){return this.layerSource.layer}destroy(){const e=this.pendingAdds;this.pendingAdds.length=0;for(const t of e)t.task.abort();this.mapSources((e=>this.destroySource(e)))}initialize(){this.handles.add([this.layer.on(\"graphic-update\",(e=>this.onGraphicUpdate(e))),this.updatingHandles.addOnCollectionChange(this.layer.graphics,(e=>this.onGraphicsChanged(e)))]),this.addMany(this.layer.graphics.toArray())}async fetchCandidates(e,t){const r=await a(this.mapSources((r=>r.queryEngine.executeQueryForSnapping({point:e.coordinateHelper.vectorToPoint(e.point).toJSON(),distance:e.distance,types:e.types,query:o(e.filter)?e.filter.createQuery().toJSON():{where:\"1=1\"}},t).then((({candidates:e})=>e))))),s=r.flat().map((t=>v(t,e.coordinateHelper)));return w(e.point,s),s}refresh(){}onGraphicUpdate(e){switch(e.property){case\"geometry\":case\"visible\":this.remove(e.graphic),this.addMany([e.graphic])}}onGraphicsChanged(e){for(const t of e.removed)this.remove(t);this.addMany(e.added)}addMany(e){const t=[],r=new Map;for(const s of e)i(s.geometry)||(this.needsInitializeProjection(s.geometry.spatialReference)?(t.push(s.geometry.spatialReference),r.set(s.uid,s)):this.add(s));this.createPendingAdd(t,r)}createPendingAdd(e,t){if(!e.length)return;const s=n((async r=>{await h(e.map((e=>({source:e,dest:this.spatialReference}))),{signal:r}),this.markLoadedSpatialReferences(e);for(const[,e]of t)this.add(e)}));this.updatingHandles.addPromise(s.promise);const o={task:s,graphics:t},i=()=>r(this.pendingAdds,o);s.promise.then(i,i),this.pendingAdds.push(o)}markLoadedSpatialReferences(e){for(const t of e)null!=t.wkid&&this.loadedWkids.add(t.wkid),null!=t.wkt&&this.loadedWkts.add(t.wkt)}add(e){if(i(e.geometry)||!e.visible)return;let t=e.geometry;if(\"mesh\"===t.type)return;\"extent\"===t.type&&(t=c.fromExtent(t));const r=this.ensureSource(t.type);if(i(r))return;const s=this.createOptimizedFeature(e.uid,t);o(s)&&r.featureStore.add(s)}needsInitializeProjection(e){return(null==e.wkid||!this.loadedWkids.has(e.wkid))&&((null==e.wkt||!this.loadedWkts.has(e.wkt))&&!l(e,this.spatialReference))}createOptimizedFeature(e,t){const r=u(m(t),this.spatialReference);return r?new f(g(r,!1,!1),{[O]:e},null,e):null}ensureSource(e){const t=this.sources[e];if(o(t))return t;const r=this.createSource(e);return this.sources[e]=r,r}createSource(e){const t=y.toJSON(e),r=new S({geometryType:t,hasZ:!1,hasM:!1});return{featureStore:r,queryEngine:new j({featureStore:r,fields:[{name:O,type:\"esriFieldTypeOID\",alias:O}],geometryType:t,hasM:!1,hasZ:!1,objectIdField:O,spatialReference:this.spatialReference,scheduler:o(this.view)&&\"3d\"===this.view.type?this.view.resourceController.scheduler:null}),type:e}}remove(e){this.mapSources((t=>this.removeFromSource(t,e)));for(const t of this.pendingAdds)t.graphics.delete(e.uid),0===t.graphics.size&&t.task.abort()}removeFromSource(e,t){const r=t.uid;e.featureStore.has(r)&&e.featureStore.removeById(t.uid)}destroySource(e){e.queryEngine.destroy(),this.sources[e.type]=null}mapSources(e){const{point:t,polygon:r,polyline:s,multipoint:i}=this.sources,a=[];return o(t)&&a.push(e(t)),o(r)&&a.push(e(r)),o(s)&&a.push(e(s)),o(i)&&a.push(e(i)),a}};e([p({constructOnly:!0})],k.prototype,\"spatialReference\",void 0),e([p({constructOnly:!0})],k.prototype,\"layerSource\",void 0),e([p({constructOnly:!0})],k.prototype,\"view\",void 0),e([p({readOnly:!0})],k.prototype,\"updating\",null),e([p({readOnly:!0})],k.prototype,\"availability\",void 0),k=e([d(\"esri.views.interactive.snapping.featureSources.GraphicsSnappingSource\")],k);const O=\"OBJECTID\";export{k as GraphicsSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{create as n}from\"./aaBoundingRect.js\";import{getBoundsXY as t}from\"./boundsUtils.js\";import{extentIntersectsPolyline as i}from\"./intersectsBase.js\";import{isPoint as s,isMultipoint as m,isExtent as e,isPolygon as x,isPolyline as o}from\"./jsonUtils.js\";import{cutParams as r,getGeometryParts as a,offsetMagnitude as f}from\"./normalizeUtilsCommon.js\";import{getInfo as c}from\"./spatialReferenceUtils.js\";function l(n){if(!n)return null;if(\"mesh\"===n.type)return n.toJSON();let a=null;const l=n.spatialReference,h=c(l);if(!h)return n.toJSON();const d=l.isWebMercator?102100:4326,I=r[d].maxX,g=r[d].minX,b=r[d].plus180Line,v=r[d].minus180Line;let J;const N=n.toJSON();if(s(N))J=y(N,I,g);else if(m(N))N.points=N.points.map((n=>y(n,I,g))),J=N;else if(e(N))J=p(N,h);else if(x(N)||o(N)){const n=M;t(n,N);const s={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},m=f(s.xmin,g)*(2*I),e=0===m?N:u(N,m);s.xmin+=m,s.xmax+=m,i(s,b)&&s.xmax!==I||i(s,v)&&s.xmin!==g?a=e:J=e}else J=n.toJSON();if(null!==a){return(new j).cut(a,I)}return J}function u(n,t){const i=a(n);for(const s of i)for(const n of s)n[0]+=t;return n}function p(n,t){if(!t)return n;const i=h(n,t).map((n=>n.extent));return i.length<2?i[0]||n:i.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:i.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}function y(n,t,i){if(Array.isArray(n)){const s=n[0];if(s>t){const i=f(s,t);n[0]=s+i*(-2*t)}else if(s<i){const t=f(s,i);n[0]=s+t*(-2*i)}}else{const s=n.x;if(s>t){const i=f(s,t);n.x+=i*(-2*t)}else if(s<i){const t=f(s,i);n.x+=t*(-2*i)}}return n}function h(n,t){const i=[],{ymin:s,ymax:m}=n,e=n.xmax-n.xmin,x=n.xmin,o=n.xmax;let r;const[a,f]=t.valid;r=d(n.xmin,t);const c=r.x,l=r.frameId;r=d(n.xmax,t);const u=r.x,p=r.frameId,y=c===u&&e>0;if(e>2*f){const n={xmin:x<o?c:u,ymin:s,xmax:f,ymax:m},t={xmin:a,ymin:s,xmax:x<o?u:c,ymax:m},e={xmin:0,ymin:s,xmax:f,ymax:m},r={xmin:a,ymin:s,xmax:0,ymax:m},y=[],h=[];I(n,e)&&y.push(l),I(n,r)&&h.push(l),I(t,e)&&y.push(p),I(t,r)&&h.push(p);for(let i=l+1;i<p;i++)y.push(i),h.push(i);i.push({extent:n,frameIds:[l]},{extent:t,frameIds:[p]},{extent:e,frameIds:y},{extent:r,frameIds:h})}else c>u||y?i.push({extent:{xmin:c,ymin:s,xmax:f,ymax:m},frameIds:[l]},{extent:{xmin:a,ymin:s,xmax:u,ymax:m},frameIds:[p]}):i.push({extent:{xmin:c,ymin:s,xmax:u,ymax:m},frameIds:[l]});return i}function d(n,t){const[i,s]=t.valid,m=2*s;let e,x=0;return n>s?(e=Math.ceil(Math.abs(n-s)/m),n-=e*m,x=e):n<i&&(e=Math.ceil(Math.abs(n-i)/m),n+=e*m,x=-e),{x:n,frameId:x}}function I(n,t){const{xmin:i,ymin:s,xmax:m,ymax:e}=t;return g(n,i,s)&&g(n,i,e)&&g(n,m,e)&&g(n,m,s)}function g(n,t,i){return t>=n.xmin&&t<=n.xmax&&i>=n.ymin&&i<=n.ymax}class j{cut(n,t){let i;if(n.rings)this.closed=!0,i=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,i=n.paths,this.minPts=2}const s=i.length,m=-2*t;for(let e=0;e<s;e++){const n=i[e];if(n&&n.length>=this.minPts){const t=[];for(const i of n)t.push([i[0]+m,i[1]]);i.push(t)}}return this.closed?n.rings=i:n.paths=i,n}}const M=n();export{l as normalizeCentralMeridianSync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{objectEqual as t}from\"../snappingUtils.js\";import{SnappingHint as n}from\"./SnappingHint.js\";class s extends n{constructor(t){super(),this.point=t}equals(n){return n instanceof s&&t(this.point,n.point)}}export{s as PointSnappingHint};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{PointConstraint as t}from\"../SnappingConstraint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointSnappingHint as r}from\"../hints/PointSnappingHint.js\";class i extends n{constructor(n){super({...n,constraint:new t(n.coordinateHelper,n.targetPoint)})}get hints(){return[new r(this.targetPoint)]}}export{i as VertexSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{EdgeSnappingCandidate as e}from\"../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as t}from\"../candidates/VertexSnappingCandidate.js\";function o(o,r){switch(o.type){case\"edge\":return new e({coordinateHelper:r,edgeStart:r.pointToVector(o.start),edgeEnd:r.pointToVector(o.end),targetPoint:r.pointToVector(o.target),objectId:o.objectId});case\"vertex\":return new t({coordinateHelper:r,targetPoint:r.pointToVector(o.target),objectId:o.objectId})}}export{o as convertSnappingCandidate};\n"],"sourceRoot":""}