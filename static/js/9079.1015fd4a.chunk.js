"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[9079,2463,2170],{92463:(e,t,i)=>{i.r(t),i.d(t,{hydratedAdapter:()=>l});var s=i(53866),n=i(77577),r=i(585),a=i(80885),o=i(29909);const l={convertToGEGeometry:function(e,t){if(null==t)return null;let i="cache"in t?t.cache._geVersion:void 0;return null==i&&(i=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=i)),i},exportPoint:function(e,t,i){const s=e.hasZ(t),n=e.hasM(t),a=new r.Z({x:e.getPointX(t),y:e.getPointY(t),spatialReference:i});return s&&(a.z=e.getPointZ(t)),n&&(a.m=e.getPointM(t)),a.cache._geVersion=t,a},exportPolygon:function(e,t,i){const s=new a.Z({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return s.cache._geVersion=t,s},exportPolyline:function(e,t,i){const s=new o.Z({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return s.cache._geVersion=t,s},exportMultipoint:function(e,t,i){const s=new n.Z({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:i});return s.cache._geVersion=t,s},exportExtent:function(e,t,i){const n=e.hasZ(t),r=e.hasM(t),a=new s.Z({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:i});if(n){const i=e.getZExtent(t);a.zmin=i.vmin,a.zmax=i.vmax}if(r){const i=e.getMExtent(t);a.mmin=i.vmin,a.mmax=i.vmax}return a.cache._geVersion=t,a}}},2170:(e,t,i)=>{i.r(t),i.d(t,{buffer:()=>C,changeDefaultSpatialReferenceTolerance:()=>q,clearDefaultSpatialReferenceTolerance:()=>H,clip:()=>o,contains:()=>c,convexHull:()=>v,crosses:()=>u,cut:()=>l,densify:()=>B,difference:()=>S,disjoint:()=>g,distance:()=>h,equals:()=>p,extendedSpatialReferenceInfo:()=>a,flipHorizontal:()=>G,flipVertical:()=>W,generalize:()=>Z,geodesicArea:()=>P,geodesicBuffer:()=>A,geodesicDensify:()=>D,geodesicLength:()=>F,intersect:()=>T,intersectLinesToPoints:()=>U,intersects:()=>d,isSimple:()=>b,nearestCoordinate:()=>E,nearestVertex:()=>M,nearestVertices:()=>L,offset:()=>R,overlaps:()=>y,planarArea:()=>N,planarLength:()=>z,relate:()=>_,rotate:()=>I,simplify:()=>w,symmetricDifference:()=>k,touches:()=>m,union:()=>x,within:()=>f});var s=i(99058),n=i(92463);function r(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function a(e){return s.G.extendedSpatialReferenceInfo(e)}function o(e,t){return s.G.clip(n.hydratedAdapter,r(e),e,t)}function l(e,t){return s.G.cut(n.hydratedAdapter,r(e),e,t)}function c(e,t){return s.G.contains(n.hydratedAdapter,r(e),e,t)}function u(e,t){return s.G.crosses(n.hydratedAdapter,r(e),e,t)}function h(e,t,i){return s.G.distance(n.hydratedAdapter,r(e),e,t,i)}function p(e,t){return s.G.equals(n.hydratedAdapter,r(e),e,t)}function d(e,t){return s.G.intersects(n.hydratedAdapter,r(e),e,t)}function m(e,t){return s.G.touches(n.hydratedAdapter,r(e),e,t)}function f(e,t){return s.G.within(n.hydratedAdapter,r(e),e,t)}function g(e,t){return s.G.disjoint(n.hydratedAdapter,r(e),e,t)}function y(e,t){return s.G.overlaps(n.hydratedAdapter,r(e),e,t)}function _(e,t,i){return s.G.relate(n.hydratedAdapter,r(e),e,t,i)}function b(e){return s.G.isSimple(n.hydratedAdapter,r(e),e)}function w(e){return s.G.simplify(n.hydratedAdapter,r(e),e)}function v(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return s.G.convexHull(n.hydratedAdapter,r(e),e,t)}function S(e,t){return s.G.difference(n.hydratedAdapter,r(e),e,t)}function k(e,t){return s.G.symmetricDifference(n.hydratedAdapter,r(e),e,t)}function T(e,t){return s.G.intersect(n.hydratedAdapter,r(e),e,t)}function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return s.G.union(n.hydratedAdapter,r(e),e,t)}function R(e,t,i,a,o,l){return s.G.offset(n.hydratedAdapter,r(e),e,t,i,a,o,l)}function C(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return s.G.buffer(n.hydratedAdapter,r(e),e,t,i,a)}function A(e,t,i,a,o,l){return s.G.geodesicBuffer(n.hydratedAdapter,r(e),e,t,i,a,o,l)}function E(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return s.G.nearestCoordinate(n.hydratedAdapter,r(e),e,t,i)}function M(e,t){return s.G.nearestVertex(n.hydratedAdapter,r(e),e,t)}function L(e,t,i,a){return s.G.nearestVertices(n.hydratedAdapter,r(e),e,t,i,a)}function O(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent?.center??null:null}function I(e,t,i){if(null==e)throw new Q;const n=e.spatialReference;if(null==(i=i??O(e)))throw new Q;const r=e.constructor.fromJSON(s.G.rotate(e,t,i));return r.spatialReference=n,r}function G(e,t){if(null==e)throw new Q;const i=e.spatialReference;if(null==(t=t??O(e)))throw new Q;const n=e.constructor.fromJSON(s.G.flipHorizontal(e,t));return n.spatialReference=i,n}function W(e,t){if(null==e)throw new Q;const i=e.spatialReference;if(null==(t=t??O(e)))throw new Q;const n=e.constructor.fromJSON(s.G.flipVertical(e,t));return n.spatialReference=i,n}function Z(e,t,i,a){return s.G.generalize(n.hydratedAdapter,r(e),e,t,i,a)}function B(e,t,i){return s.G.densify(n.hydratedAdapter,r(e),e,t,i)}function D(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return s.G.geodesicDensify(n.hydratedAdapter,r(e),e,t,i,a)}function N(e,t){return s.G.planarArea(n.hydratedAdapter,r(e),e,t)}function z(e,t){return s.G.planarLength(n.hydratedAdapter,r(e),e,t)}function P(e,t,i){return s.G.geodesicArea(n.hydratedAdapter,r(e),e,t,i)}function F(e,t,i){return s.G.geodesicLength(n.hydratedAdapter,r(e),e,t,i)}function U(e,t){return s.G.intersectLinesToPoints(n.hydratedAdapter,r(e),e,t)}function q(e,t){s.G.changeDefaultSpatialReferenceTolerance(e,t)}function H(e){s.G.clearDefaultSpatialReferenceTolerance(e)}class Q extends Error{constructor(){super("Illegal Argument Exception")}}},54134:(e,t,i)=>{var s,n,r,a,o,l,c;i.d(t,{NH:()=>o,Xo:()=>r,fu:()=>s}),function(e){e[e.INNER=0]="INNER",e[e.OUTER=1]="OUTER"}(s||(s={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",e[e.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",e[e.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(n||(n={})),function(e){e[e.NORTH=0]="NORTH",e[e.NORTH_EAST=1]="NORTH_EAST",e[e.EAST=2]="EAST",e[e.SOUTH_EAST=3]="SOUTH_EAST",e[e.SOUTH=4]="SOUTH",e[e.SOUTH_WEST=5]="SOUTH_WEST",e[e.WEST=6]="WEST",e[e.NORTH_WEST=7]="NORTH_WEST"}(r||(r={})),function(e){e[e.OFF=0]="OFF",e[e.ON=1]="ON"}(a||(a={})),function(e){e[e.Color=0]="Color",e[e.ColorNoRasterImage=1]="ColorNoRasterImage",e[e.Highlight=2]="Highlight",e[e.Water=3]="Water",e[e.Occluded=4]="Occluded",e[e.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor"}(o||(o={})),function(e){e[e.FADING=0]="FADING",e[e.IMMEDIATE=1]="IMMEDIATE",e[e.UNFADED=2]="UNFADED"}(l||(l={})),function(e){e[e.INSIDE=0]="INSIDE",e[e.INTERSECTS=1]="INTERSECTS",e[e.OUTSIDE=2]="OUTSIDE"}(c||(c={}))},97731:(e,t,i)=>{i.d(t,{E6:()=>c,T:()=>a,ep:()=>l,hu:()=>r,kG:()=>h,u_:()=>u,yK:()=>o});var s=i(6394);i(90045);(0,i(67077).c)();class n{constructor(e){this.message=e}toString(){return`AssertException: ${this.message}`}}function r(e,t){if(!e){t=t||"Assertion";const e=new Error(t).stack;throw new n(`${t} at ${e}`)}}function a(e,t){e||(t=t||"",console.warn("Verify failed: "+t+"\n"+new Error("verify").stack))}function o(e,t,i,s){let n,r=(i[0]-e[0])/t[0],a=(s[0]-e[0])/t[0];r>a&&(n=r,r=a,a=n);let o=(i[1]-e[1])/t[1],l=(s[1]-e[1])/t[1];if(o>l&&(n=o,o=l,l=n),r>l||o>a)return!1;o>r&&(r=o),l<a&&(a=l);let c=(i[2]-e[2])/t[2],u=(s[2]-e[2])/t[2];return c>u&&(n=c,c=u,u=n),!(r>u||c>a)&&(u<a&&(a=u),!(a<0))}function l(e,t,i,n,r){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:(0,s.a)();const o=(n[r]-i[r])*(t[0]-e[0])-(n[0]-i[0])*(t[r]-e[r]),l=(n[0]-i[0])*(e[r]-i[r])-(n[r]-i[r])*(e[0]-i[0]);if(0===o)return!1;const c=l/o;return a[0]=e[0]+c*(t[0]-e[0]),a[1]=e[r]+c*(t[r]-e[r]),!0}function c(e,t){return Math.log(e)/Math.log(t)}function u(e,t,i,s){e[12]=t,e[13]=i,e[14]=s}function h(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]}},92028:(e,t,i)=>{i.d(t,{D:()=>r});var s=i(72619),n=i(50951);function r(e,t){return null!=e&&(null==t||(t===n.JY.Local?!e.isGeographic||e.isWGS84||e.wkid===s.W.CGCS2000:e.isWebMercator||e.isWGS84||e.wkid===s.W.CGCS2000||e.wkid===s.W.GCSMARS2000||e.wkid===s.W.GCSMARS2000_SPHERE||e.wkid===s.W.GCSMOON2000))}},50890:(e,t,i)=>{i.d(t,{Z:()=>Ee});var s=i(27366),n=i(65905),r=i(100),a=i(94172),o=i(49861),l=(i(25243),i(63780)),c=i(69912),u=i(69407),h=i(29479),p=i(40281),d=i(41691),m=i(54472),f=i(92026),g=i(89125),y=i(79803),_=i(92975),b=i(23037),w=i(10064),v=i(66978),S=i(37933),k=i(50951),T=i(76200),x=i(85015),R=i(84652),C=i(97731);class A{constructor(e){this.typeWorkerQuota=e,this.tasks=new Array,this.numWorkers=0,this.statistics=new E}}class E{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}}class M{constructor(e,t,i,s){this._workerFunc=e,this._callbackFunc=t,this._maxTotalNumWorkers=i,this._totalNumWorkers=0,this._clients=s.map((e=>new A(e)))}destroy(){this._clients.length=0}hasQuota(e){const t=this._clients[e];return!!t&&(this._totalNumWorkers<this._maxTotalNumWorkers||t.numWorkers+t.tasks.length<t.typeWorkerQuota)}push(e){const t=this._clients[e.client];t&&(this._totalNumWorkers<this._maxTotalNumWorkers?(t.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,((e,t)=>this._taskCallback(e,t)))):t.tasks.push(e))}cancel(e){this._taskFinished(e),e._cancelled=!0}_taskFinished(e){const t=this._clients[e.client];this._totalNumWorkers--,t.numWorkers--,t.statistics.requests++,t.statistics.size+=e.size||0,t.statistics.duration+=e.duration||0,t.statistics.speed=t.statistics.duration>0?t.statistics.size/t.statistics.duration:0,(0,C.hu)(t.numWorkers>=0),this._next()}_next(){for(const e of this._clients)if(e&&e.numWorkers<e.typeWorkerQuota&&this._processQueue(e))return;for(const e of this._clients)if(e&&this._processQueue(e))return}_processQueue(e){for(;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),((e,t)=>this._taskCallback(e,t))))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(e,t){e._cancelled||(this._callbackFunc(e,t),this._taskFinished(e))}getStatsForType(e){const t=this._clients[e];return t?{quota:t.typeWorkerQuota,workers:t.numWorkers,queueSize:t.tasks.length,requestStats:t.statistics}:null}get test(){const e=this;return{set workerFunc(t){e._workerFunc=t}}}}var L=i(78307);let O=class extends x.Z{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(e,t,i){this._loadQueue=new M(((e,t)=>this._startLoading(e,t)),((e,t)=>this._doneLoadingCB(e,t)),e,t),i&&(this._frameTask=i.registerTask(L.T8.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=(0,f.hw)(this._frameTask),this._tasks.forEach((e=>(0,f.IM)(e.abortController))),this._loadQueue=(0,f.SC)(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(e){return this._loadQueue.hasQuota(e)}request(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=(0,v.hh)();n.__signal=(0,f.pC)(s)?s.signal:null;const r=this._createOrUpdateTask(e,t,i,s,n);return(0,v.fu)(s,(()=>this._cancelRequest(r,n))),n.promise}_createTask(e,t,i,s,n,r){const a=new W(e,t,i,s,n);return this._updateTask(a,r),this._tasks.set(n,a),1===this._tasks.size&&this._set("updating",!0),this._loadQueue.push(a),a}_cancelRequest(e,t){(0,l.e$)(e.resolvers,t),t.reject((0,v.zE)()),0===e.resolvers.length&&(e.status===Z.DOWNLOADING&&(e.status=Z.CANCELLED,this._loadQueue.cancel(e),e.abortController?.abort(),e.request=null,e.abortController=null),e.status=Z.CANCELLED,this._tasks.delete(e.key),0===this._tasks.size&&this._set("updating",!1))}_updateTask(e,t){e.resolvers.push(t)}_createOrUpdateTask(e,t,i,s,n){const r=function(e,t,i){return`${e}:${t}:${i}`}((0,f.pC)(s)&&s.uid||e,t,i),a=this._tasks.get(r);return a?(this._updateTask(a,n),a):this._createTask(e,s,t,i,r,n)}_doneLoadingCB(e,t){this._loadQueue&&((0,C.hu)(e.status===Z.DOWNLOADING),e.status=Z.DOWNLOADED,this._frameTask?this._doneQueue.push({task:e,err:t}):this._doneLoading(e,t))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(e){for(;!e.done&&this._onLoadQueue.length>0;){const t=this._onLoadQueue.shift();(0,v.k_)(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this._doneQueue.length>0;){const t=this._doneQueue.shift();t.task.status!==Z.DOWNLOADED&&(t.err=t.err||(0,v.zE)()),this._doneLoading(t.task,t.err),e.madeProgress()}}_doneLoading(e,t){if(t&&!(0,v.D_)(t)&&e.numRetries>0)return--e.numRetries,void this._loadQueue.push(e);let i=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const s of e.resolvers)if(t)(0,v.D_)(t)?s.reject(t):s.reject(new w.Z("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else{--i;const t=i<=0?e.result:(0,R.d9)(e.result);s.resolve(t)}this._tasks.delete(e.key),0===this._tasks.size&&this._set("updating",!1)}_startLoading(e,t){if(e.status===Z.CANCELLED)return!1;let i,s;switch(e.startTime=performance.now(),e.status=Z.DOWNLOADING,e.docType){case"binary":s="array-buffer",i=0;break;case"image":s="image";break;case"image+type":s="array-buffer";break;default:s="json"}e.abortController=new AbortController;const n=e.abortController.signal;e.request=(0,T.default)(e.url,{...e.options,responseType:s,timeout:i,signal:n});let r=()=>{};const a=i=>{e.duration=performance.now()-e.startTime,e.size=i instanceof ArrayBuffer?i.byteLength:e.size||0,e.result=i,this._frameTask?this._onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},o=i=>{e.status===Z.DOWNLOADING&&t(e,i),r()};return"image+type"!==e.docType?(e.request.then((e=>a(e.data)),o),!0):(e.request.then((t=>{const l=t.data,c=function(e){if(e.byteLength<2)return"unknown";const t=new Uint8Array(e,0,e.byteLength);return 137===t[0]&&80===t[1]?"image/png":71===t[0]&&73===t[1]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":255===t[0]&&216===t[1]?"image/jpeg":"unknown"}(l);if(s="image",e.size=l.byteLength,"unknown"===c)return e.request=(0,T.default)(e.url,{responseType:s,timeout:i,signal:n}),void e.request.then((e=>a(e.data)),o);const u=new Blob([l],{type:c}),h=window.URL.createObjectURL(u);r=()=>window.URL.revokeObjectURL(h),e.request=(0,T.default)(h,{responseType:s,timeout:i,signal:n}),e.request.then((e=>a(new G(e.data,c,r))),o)}),o),!0)}get test(){return{loadQueue:this._loadQueue}}};(0,s._)([(0,o.Cb)({readOnly:!0})],O.prototype,"updating",void 0),O=(0,s._)([(0,c.j)("esri.views.3d.support.StreamDataLoader")],O);const I=0;class G{constructor(e,t,i){this.image=e,this.type=t,this.release=i}get isOpaque(){return"image/jpeg"===this.type}}class W extends class{constructor(e){this.client=e,this._cancelled=!1,this.size=0,this.duration=0}}{constructor(e,t,i,s,n){super(s),this.url=e,this.options=t,this.docType=i,this.key=n,this.result=null,this.status=Z.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=I}}var Z;!function(e){e[e.QUEUED=1]="QUEUED",e[e.DOWNLOADING=2]="DOWNLOADING",e[e.DOWNLOADED=3]="DOWNLOADED",e[e.CANCELLED=4]="CANCELLED"}(Z||(Z={}));var B=i(54134),D=i(11186),N=i(71353),z=i(65156),P=i(16889),F=(i(59486),i(68860)),U=i(53866),q=i(78952),H=i(81753),Q=i(59068),j=i(22824),V=i(585);class ${constructor(e){const t=$.checkUnsupported(e);if((0,f.pC)(t))throw t;const i=(0,f.Wg)(e);this.spatialReference=i.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=(0,y.jF)(this.spatialReference)||(0,_.BZ)(this.spatialReference)||(0,_.V2)(this.spatialReference),this.origin=[i.origin.x,i.origin.y],this.pixelSize=i.size[0],this.dpi=i.dpi;const s=i.lods.reduce(((e,t,i)=>(t.level<e.min&&(e.min=t.level,e.minIndex=i),e.max=Math.max(e.max,t.level),e)),{min:1/0,minIndex:0,max:-1/0}),n=i.lods[s.minIndex],r=2**n.level;let a=n.resolution*r,o=n.scale*r;this.levels=new Array(s.max+1);for(let l=0;l<this.levels.length;l++)this.levels[l]={resolution:a,scale:o,tileSize:[a*i.size[0],a*i.size[1]]},a/=2,o/=2}clone(){return new $(this.toTileInfo())}toTileInfo(){return new j.Z({dpi:this.dpi,origin:new V.Z({x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference}),size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map(((e,t)=>new Q.Z({level:t,scale:e.scale,resolution:e.resolution})))})}getExtent(e,t,i,s){const n=this.levels[e],r=n.tileSize[0],a=n.tileSize[1];s[0]=this.origin[0]+i*r,s[2]=this.origin[0]+(i+1)*r,s[3]=this.origin[1]-t*a,s[1]=this.origin[1]-(t+1)*a}convertExtentToRadians(e,t){this._isWebMercator?(t[0]=(0,H.tp)(e[0]),t[1]=(0,H.mZ)(e[1]),t[2]=(0,H.tp)(e[2]),t[3]=(0,H.mZ)(e[3])):this._isGCS&&(t[0]=(0,P.Vl)(e[0]),t[1]=(0,P.Vl)(e[1]),t[2]=(0,P.Vl)(e[2]),t[3]=(0,P.Vl)(e[3]))}getExtentGeometry(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new U.Z;return this.getExtent(e,t,i,X),s.spatialReference=this.spatialReference,s.xmin=X[0],s.ymin=X[1],s.xmax=X[2],s.ymax=X[3],s.zmin=void 0,s.zmax=void 0,s}ensureMaxLod(e){if(null==e)return!1;let t=!1;for(;this.levels.length<=e;){const e=this.levels[this.levels.length-1],i=e.resolution/2;this.levels.push({resolution:i,scale:e.scale/2,tileSize:[i*this.pixelSize,i*this.pixelSize]}),t=!0}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){const t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e){if(!(e instanceof $)){if($.checkUnsupported(e))return!1;e=new $(e)}if(!e.spatialReference.equals(this.spatialReference))return!1;if(e.pixelSize!==this.pixelSize)return!1;const t=Math.min(this.levels.length,e.levels.length)-1,i=this.levels[t].resolution;let s=.5*i;return!(!(0,P.W8)(e.origin[0],this.origin[0],s)||!(0,P.W8)(e.origin[1],this.origin[1],s))&&(s=.5*i/2**t/this.pixelSize*12,(0,P.W8)(i,e.levels[t].resolution,s))}rootTilesInExtent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;const s=new Array,n=this.levels[0].tileSize;if((0,f.Wi)(e)||0===n[0]||0===n[1])return s;$.computeRowColExtent(e,n,this.origin,X);let r=X[1],a=X[3],o=X[0],l=X[2];const c=l-o,u=a-r;if(c*u>i){const e=Math.floor(Math.sqrt(i));u>e&&(r=r+Math.floor(.5*u)-Math.floor(.5*e),a=r+e),c>e&&(o=o+Math.floor(.5*c)-Math.floor(.5*e),l=o+e)}for(let h=r;h<a;h++)for(let e=o;e<l;e++)s.push([0,h,e]);return(0,f.pC)(t)&&(t[0]=this.origin[0]+o*n[0],t[1]=this.origin[1]-a*n[1],t[2]=this.origin[0]+l*n[0],t[3]=this.origin[1]-r*n[1]),s}static computeRowColExtent(e,t,i,s){const n=.001*(e[2]-e[0]+(e[3]-e[1]));s[0]=Math.max(0,Math.floor((e[0]+n-i[0])/t[0])),s[2]=Math.max(0,Math.ceil((e[2]-n-i[0])/t[0])),s[1]=Math.max(0,Math.floor((i[1]-e[3]+n)/t[1])),s[3]=Math.max(0,Math.ceil((i[1]-e[1]-n)/t[1]))}static isPowerOfTwo(e){const t=e.lods,i=t[0].resolution*2**t[0].level;return!t.some((e=>!(0,P.Y8)(e.resolution,i/2**e.level)))}static hasGapInLevels(e){const t=e.lods.map((e=>e.level));t.sort(((e,t)=>e-t));for(let i=1;i<t.length;i++)if(t[i]!==t[0]+i)return!0;return!1}static tileSizeSupported(e){const t=e.size[1];return t===e.size[0]&&0==(t&t-1)&&t>=128&&t<=512}static hasOriginPerLODs(e){const t=e.origin;return e.lods.some((e=>null!=e.origin&&(e.origin[0]!==t.x||e.origin[1]!==t.y)))}static getMissingTileInfoError(){return new w.Z("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(e){return(0,f.Wi)(e)?Y():e.lods.length<1?new w.Z("tilingscheme:generic","Tiling scheme must have at least one level"):$.isPowerOfTwo(e)?$.hasGapInLevels(e)?new w.Z("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):$.tileSizeSupported(e)?$.hasOriginPerLODs(e)?new w.Z("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new w.Z("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new w.Z("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,t){const i=e[2]-e[0],s=e[3]-e[1],n=(0,F.c9)(t),r=1.2*Math.max(i,s),a=256,o=new $(new j.Z({size:[a,a],origin:new V.Z({x:e[0]-.5*(r-i),y:e[3]+.5*(r-s)}),lods:[new Q.Z({level:0,resolution:r/a,scale:1/(a/96*.0254/(r*n))})],spatialReference:t}));return o.ensureMaxLod(20),o}static makeWebMercatorAuxiliarySphere(e){const t=new $($.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16;const s=256/t,n=new $(new j.Z({size:[t,t],origin:new V.Z({x:-180,y:90,spatialReference:e}),spatialReference:e,lods:[new Q.Z({level:0,resolution:.703125*s,scale:295497598.570834*s})]}));return n.ensureMaxLod(i),n}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}}function Y(){return new w.Z("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}$.WebMercatorAuxiliarySphereTileInfo=new j.Z({size:[256,256],origin:new V.Z({x:-20037508.342787,y:20037508.342787,spatialReference:q.Z.WebMercator}),spatialReference:q.Z.WebMercator,lods:[new Q.Z({level:0,resolution:156543.03392800014,scale:591657527.591555})]}),$.WebMercatorAuxiliarySphere=$.makeWebMercatorAuxiliarySphere(19);const X=(0,z.Ue)(),J=((0,P.oK)(P._3/10),(0,z.Ue)());$.WebMercatorAuxiliarySphere.getExtent(0,0,0,J);(0,z.Ue)([-180,-90,180,90]);const K=(0,N.c)(),ee=(0,N.c)(),te=(0,N.c)(),ie=(0,N.c)();function se(e,t,i,s){(0,D.c)(K,i),K[s]=t[s];const n=(0,D.b)(K,K,t),r=(0,D.b)(ee,e,t),a=(0,D.e)(r,n),o=(0,D.e)(n,n);let l;l=a<=0?t:o<=a?i:(0,D.a)(K,t,(0,D.g)(n,n,a/o));const c=(0,D.b)(K,e,l);return Math.PI/2-Math.atan(c[2]/Math.sqrt(c[0]*c[0]+c[1]*c[1]))}const ne=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:function(e,t,i){if((0,f.Wi)(e))return Y();if(e.spatialReference.isGeographic&&!(0,y.jF)(e.spatialReference))return new w.Z("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const s=$.checkUnsupported(e);if((0,f.pC)(s))return s;if((0,f.Wi)(i))return new w.Z("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const n=function(e,t){const i=e.lods,s=i[0].resolution*2**i[0].level,n=[s*e.size[0],s*e.size[1]],r=[e.origin.x,e.origin.y],a=(0,z.oJ)(t),o=(0,z.Ue)();$.computeRowColExtent(a,n,r,o);const l=(o[2]-o[0])*(o[3]-o[1]);if(l>64){const t=i[0].scale*2**i[0].level;let n=Math.max((a[3]-a[1])/e.size[1],(a[2]-a[0])/e.size[0])*t/s;const r=Math.floor(Math.log(n)/Math.log(10));return n=Math.ceil(n/10**r)*10**r,new w.Z("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(t).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+n.toLocaleString()+".",{level0Scale:t,suggestedLevel0Scale:n,requiredNumRootTiles:l,allowedNumRootTiles:64})}return null}(e,i);if(n)return n;const r=e.spatialReference;return(0,f.pC)(t)&&!(r.equals(t)||t.isWGS84&&r.isWebMercator)?new w.Z("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null},isInsideExtent:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=e.extent;if((0,f.Wi)(s))return!1;if(0===i)return(0,z.BD)(s,t);const n=Math.min(s[2]-s[0],s[3]-s[1]);return(0,z.Zm)(s,t,i*n)},tiltToExtentEdge:function(e,t,i){const s=e.extent;if((0,f.Wi)(s))return 0;te[0]=s[0],te[1]=s[1],te[2]=i,ie[0]=s[2],ie[1]=s[3],ie[2]=i;let n=1/0,r=1/0;return t[0]<te[0]?n=se(t,te,ie,0):t[0]>ie[0]&&(n=se(t,ie,te,0)),t[1]<te[1]?r=se(t,te,ie,1):t[1]>ie[1]&&(r=se(t,ie,te,1)),Math.min(n,r)}},Symbol.toStringTag,{value:"Module"}));const re=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:function(e,t){if((0,f.Wi)(e))return Y();const i=e.lods.length-1,s=e.spatialReference,n=(0,y.jF)(s)||(0,_.BZ)(s)||(0,_.V2)(s);if(s.isWebMercator){if(!$.makeWebMercatorAuxiliarySphere(i).compatibleWith(e))return new w.Z("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!n)return new w.Z("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!$.makeGCSWithTileSize(e.spatialReference,e.size[0],i).compatibleWith(e))return e.spatialReference.isWGS84?new w.Z("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new w.Z("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return(0,f.pC)(t)&&!e.spatialReference.equals(t)?new w.Z("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene"):void 0},isInsideExtent:function(){return!0},tiltToExtentEdge:function(){return 0}},Symbol.toStringTag,{value:"Module"})),ae={[k.JY.Global]:re,[k.JY.Local]:ne};function oe(e,t,i,s){return ae[s].checkIfTileInfoSupportedForViewSR(e,i,t)}function le(e,t,i){const s=(0,S.mt)(e);if((0,f.pC)(s)){if(!p.Z.isCollection(s))return{tileInfo:s.tileInfo,fullExtent:s.fullExtent};{const e=s.find((e=>null==oe(e.tileInfo,e.fullExtent,t,i)));if(e)return{tileInfo:e.tileInfo,fullExtent:e.fullExtent}}}return{tileInfo:null,fullExtent:null}}B.Xo.NORTH,B.Xo.EAST,B.Xo.SOUTH,B.Xo.WEST,B.Xo.NORTH_EAST,B.Xo.SOUTH_EAST,B.Xo.SOUTH_WEST,B.Xo.NORTH_WEST;var ce=i(92028);async function ue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await de(e,t),(0,v.k_)(t)}async function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{basemap:i,view:s}=e;if((0,v.k_)(t),"spatialReferenceLocked"in s&&!s.spatialReferenceLocked)return;if(await i.load(t),(0,v.k_)(t),0===i.baseLayers.length)return;const n=i.baseLayers.getItemAt(0);if(!(0,S.iC)(n))return;if(i.spatialReference){if(s.spatialReference.equals(i.spatialReference))return;pe()}await n.load(t),(0,v.k_)(t);const r=(("supportedSpatialReferences"in n?n.supportedSpatialReferences:null)||["tileInfo"in n?n.tileInfo?.spatialReference:null]).filter(f.pC);0!==r.length&&r.every((e=>!s.spatialReference.equals(e)))&&pe()}function pe(){throw new w.Z("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}async function de(e,t){const{basemap:i,view:s}=e;if(await i.load(t),0===i.baseLayers.length)return;const n=i.baseLayers.concat(i.referenceLayers).toArray().filter((e=>!(0,S.qq)(e))).map((e=>new w.Z("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:e,operationalLayerType:e.operationalLayerType||"unknown"})));if(n.length)throw n[0];const r=i.baseLayers.getItemAt(0);if((0,S.qq)(r)){try{await r.load(t)}catch(a){const e="basemap-compatibility:unknown-error",t="Unknown basemap compatibility error",{name:i=e,message:s=t,details:n}=a;throw new w.Z(i,s,n)}!function(e,t){const i=t.state.viewingMode;if(!i)return;let s,n;if("wmts"===e?.type){const r=le(e,t.spatialReference,i);if((0,f.Wi)(r.tileInfo))throw new w.Z("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view");s=r.tileInfo,n=r.fullExtent}else s=e.tileInfo,n=e.fullExtent;if((0,f.Wi)(s))return;if(!(0,ce.D)(s.spatialReference,i))throw new w.Z(`basemapgalleryitem:spatial-reference-unsupported-${(0,k.M7)(i)}`,`Basemap spatial reference is unsupported in ${(0,k.M7)(i)} mode`);const r=s.spatialReference.isGeographic,a="vector-tile"===e?.type?s.getOrCreateCompatible(256,r?1:2):null;if(i===k.JY.Global){let t=oe(s,n,null,i);if(t&&"vector-tile"===e?.type&&(0,f.pC)(n)&&a&&!oe(a,n,null,i)&&(t=null),t){const e=s.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new w.Z(`basemapgalleryitem:tiling-scheme-unsupported-${e}-global`,"Basemap tiling scheme is unsupported in global mode",{error:t})}}else if($.checkUnsupported(s))throw new w.Z("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const o=t.get("basemapTerrain.tilingScheme");if(o&&!o.compatibleWith(s)&&("vector-tile"!==e?.type||!a||!o.compatibleWith(a)))throw new w.Z("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}(r,s)}}var me=i(79056);let fe=class extends((0,me.IG)((0,d.p)(x.Z))){constructor(e){super(e),this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null}initialize(){const e=()=>this.refresh();this.handles.add([(0,a.YP)((()=>this.basemap?.loadStatus),e),(0,a.YP)((()=>this.compatibilityFunction),e),(0,a.YP)((()=>this.view&&"basemapTerrain"in this.view&&this.view.basemapTerrain?.tilingScheme),e),(0,a.YP)((()=>this.view?.ready),e),(0,a.YP)((()=>this.view?.spatialReference),e)]),this.refresh()}destroy(){this._cancelRefresh(),this.basemap=null,this.compatibilityFunction=null,this.view=null}get _spatialReferenceTask(){return(0,b.Us)(this.view,this.basemap)}set basemap(e){const t=this._get("basemap");t&&t.cancelLoad(),e&&e.load().catch((()=>{})),this._set("basemap",e)}get spatialReference(){return this._spatialReferenceTask.spatialReference}refresh(){this._cancelRefresh(),this._set("state","loading");const e=this.basemap?.loadStatus;if("loaded"!==e&&"failed"!==e)return;if(!this.compatibilityFunction)return void("loaded"===e?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const t=new AbortController,{signal:i}=t;this.compatibilityFunction(this,{signal:i}).then((()=>(0,a.N1)((()=>!this._spatialReferenceTask.updating),i))).then((()=>{this._set("state","ready"),this._set("error",null)})).catch((e=>{(0,v.D_)(e)||(this._set("state","error"),this._set("error",e))})),this._refreshController=t}_cancelRefresh(){this._refreshController&&(this._refreshController.abort(),this._refreshController=null)}};(0,s._)([(0,o.Cb)({readOnly:!0})],fe.prototype,"_spatialReferenceTask",null),(0,s._)([(0,o.Cb)()],fe.prototype,"basemap",null),(0,s._)([(0,o.Cb)()],fe.prototype,"compatibilityFunction",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],fe.prototype,"error",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],fe.prototype,"spatialReference",null),(0,s._)([(0,o.Cb)({readOnly:!0})],fe.prototype,"state",void 0),(0,s._)([(0,o.Cb)()],fe.prototype,"view",void 0),fe=(0,s._)([(0,c.j)("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],fe);const ge=fe;var ye=i(76243),_e=i(97862);const be=p.Z.ofType(ge);let we=class extends((0,d.p)(m.Z)){constructor(e){super(e),this._loadingProjectionEngine=!1,this.items=new be,this.source=new _e.Z,this.view=null}initialize(){const e=()=>this._recreateItems();this.handles.add([(0,a.YP)((()=>"ready"===this.state?this.compatibilityFunction:null),(()=>this._updateItems())),(0,a.on)((()=>this.source?.basemaps),"change",e,{onListenerAdd:e})])}get activeBasemap(){return this.view?.map?.basemap??null}set activeBasemap(e){if(!this.view.map)return;const t="string"==typeof e?h.default.fromId(e):e;if(!t||!this.view.ready)return this.view.map.basemap=t,void this._clearOverride("activeBasemap");const i=t.spatialReference||this.items?.find((e=>this.basemapEquals(t,e.basemap)))?.spatialReference;if(i&&"spatialReferenceLocked"in this.view&&!this.view.spatialReferenceLocked){const s=this.view.spatialReference;if((0,f.pC)(i)&&!(0,_.fS)(s,i)&&!(0,y.Up)(this.view.spatialReference,i)&&!(0,y.kR)())return this._override("activeBasemap",t),this._loadingProjectionEngine=!0,void(0,y.zD)().then((()=>{this._get("activeBasemap")===e&&(this.view.map.basemap=e,this.view.spatialReference=i,this._clearOverride("activeBasemap"))}),(()=>{})).then((()=>{this._loadingProjectionEngine=!1}));this.view.map.basemap=t,this._clearOverride("activeBasemap"),(0,f.pC)(i)&&!(0,_.fS)(this.view.spatialReference,i)&&(this.view.spatialReference=i)}else this.view.map.basemap=t,this._clearOverride("activeBasemap")}get activeBasemapIndex(){const{state:e,items:t,activeBasemap:i}=this;if("ready"!==e)return-1;const s=t.findIndex((e=>e.basemap===i));return-1===s?t.findIndex((e=>this.basemapEquals(e.basemap,i))):s}get compatibilityFunction(){return"3d"===this.view?.type?ue:he}set compatibilityFunction(e){this._overrideIfSome("compatibilityFunction",e)}castSource(e){return Array.isArray(e)||p.Z.isCollection(e)?new ye.Z({basemaps:e}):function(e){return e&&"esri.portal.Portal"===e.declaredClass}(e)?new _e.Z({portal:e}):function(e){return e&&!(e instanceof _e.Z)&&(!!e.portal||!!e.query)}(e)?new _e.Z(e):function(e){return e&&"basemaps"in e&&"state"in e&&"refresh"in e}(e)?e:null}get state(){return this.view?.ready&&this.source?this._loadingProjectionEngine?"loading":"ready":"disabled"}basemapEquals(e,t){return(0,b.Bj)(e,t)}refresh(){this._recreateItems()}load(e){return this.addResolvingPromise(m.Z.isLoadable(this.source)?this.source.load(e):null),Promise.resolve(this)}_recreateItems(){const e=this.source?.basemaps,{view:t,compatibilityFunction:i}=this;this.items.removeAll().forEach((e=>e.destroy())),e&&this.items.addMany(e.map((e=>new ge({basemap:e,compatibilityFunction:i,view:t}))))}_updateItems(){for(const e of this.items)e.compatibilityFunction=this.compatibilityFunction,e.view=this.view}};(0,s._)([(0,o.Cb)()],we.prototype,"_loadingProjectionEngine",void 0),(0,s._)([(0,o.Cb)()],we.prototype,"activeBasemap",null),(0,s._)([(0,o.Cb)({readOnly:!0})],we.prototype,"activeBasemapIndex",null),(0,s._)([(0,o.Cb)()],we.prototype,"compatibilityFunction",null),(0,s._)([(0,o.Cb)({readOnly:!0,type:be})],we.prototype,"items",void 0),(0,s._)([(0,o.Cb)()],we.prototype,"source",void 0),(0,s._)([(0,g.p)("source")],we.prototype,"castSource",null),(0,s._)([(0,o.Cb)({readOnly:!0})],we.prototype,"state",null),(0,s._)([(0,o.Cb)()],we.prototype,"view",void 0),we=(0,s._)([(0,c.j)("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],we);const ve=we,Se="esri-basemap-gallery",ke={base:`${Se} esri-widget esri-widget--panel-height-only`,sourceLoading:`${Se}--source-loading`,loader:`${Se}__loader`,item:`${Se}__item`,itemContainer:`${Se}__item-container`,itemTitle:`${Se}__item-title`,itemThumbnail:`${Se}__item-thumbnail`,selectedItem:`${Se}__item--selected`,itemError:`${Se}__item--error`,emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};var Te=i(96919),xe=i(78088),Re=i(80532),Ce=i(67005);i(80975);let Ae=class extends u.Z{constructor(e,t){super(e,t),this._handles=new r.Z,this._focusBasemapItemEnabled=!1,this.disabled=!1,this.headingLevel=2,this.iconClass=ke.widgetIcon,this.messages=null,this.viewModel=new ve}initialize(){const e=this._handles;this.addHandles([(0,a.on)((()=>this.viewModel.items),"change",(t=>{const i="basemap-gallery-item-changes",{added:s,moved:n}=t;e.remove(i),e.add([...s,...n].map((e=>(0,a.YP)((()=>e.state),(()=>this.scheduleRender())))),i),this.scheduleRender()})),(0,a.gx)((()=>this.source),(()=>this.viewModel.load()),{initial:!0,once:!0})])}destroy(){this._handles.destroy()}loadDependencies(){return Promise.resolve().then(i.bind(i,99174))}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(e){this.viewModel.activeBasemap=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get source(){return this.viewModel.source}set source(e){this.viewModel.source=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="loading"===this.source.state,t=this.disabled||"disabled"===this.viewModel.state,i=this.viewModel.items.map(((e,t)=>this._renderBasemapGalleryItem(e,t))).toArray(),s={[ke.sourceLoading]:e,[ke.disabled]:t},n=e?(0,Ce.u)("div",{class:ke.loader,key:"esri-basemap-gallery__loader"}):null,r=e?null:i.length>0?(0,Ce.u)("ul",{bind:this,"aria-disabled":this.disabled,"aria-label":this.label,class:ke.itemContainer,key:"esri-basemap-gallery__item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},i):(0,Ce.u)("div",{class:ke.emptyMessage,key:"esri-basemap-gallery__empty-message"},(0,Ce.u)(Te.X6,{level:this.headingLevel},this.messages.noBasemaps));return(0,Ce.u)("div",{class:this.classes(ke.base,s)},n,r)}_getRoundRobinIndex(e,t){return(e+t)%t}_handleKeyDown(e){const{key:t}=e;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t))return;e.preventDefault();const{items:i,activeBasemapIndex:s}=this.viewModel,n="ArrowUp"===t||"ArrowLeft"===t?this._getRoundRobinIndex(Math.max(s-1,-1),i.length):this._getRoundRobinIndex(s+1,i.length),r=i.getItemAt(n);"ready"===r?.state&&(this.viewModel.activeBasemap=r.basemap),this._focusBasemapItemEnabled=!0}_focusBasemapItem(e){this._focusBasemapItemEnabled&&0===e.tabIndex&&(e.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(e){const t=e.currentTarget["data-item"];"ready"===t.state&&(this.viewModel.activeBasemap=t.basemap)}_renderBasemapGalleryItem(e,t){const i=e.basemap.thumbnailUrl||(0,n.V)("esri/themes/base/images/basemap-toggle-64.svg"),s=e.basemap.title,r=e.basemap.portalItem?.snippet,a=e.error?.message||r||s,{viewModel:{state:o,activeBasemapIndex:l}}=this,c=this.disabled||"disabled"===o,u=l===t,h=u||-1===l&&0===t?0:-1,p="loading"===o,d={[ke.selectedItem]:u,[ke.itemError]:"error"===e.state},m=`basemapgallery-item-${e.uid}`;return(0,Ce.u)("li",{"aria-checked":u.toString(),"aria-disabled":c.toString(),"aria-labelledby":m,bind:this,class:this.classes(ke.item,d),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"radio",tabIndex:h,afterUpdate:this._focusBasemapItem,title:a},(0,Ce.u)("img",{alt:"",class:ke.itemThumbnail,src:i}),(0,Ce.u)("div",{id:m,class:ke.itemTitle},s),"loading"===e.state||u&&p?(0,Ce.u)("calcite-scrim",null,(0,Ce.u)("span",{"aria-hidden":"true",role:"presentation",class:ke.loaderAnimation})):null)}};(0,s._)([(0,o.Cb)()],Ae.prototype,"activeBasemap",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"disabled",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"headingLevel",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"iconClass",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"label",null),(0,s._)([(0,o.Cb)(),(0,Re.H)("esri/widgets/BasemapGallery/t9n/BasemapGallery")],Ae.prototype,"messages",void 0),(0,s._)([(0,o.Cb)()],Ae.prototype,"source",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"view",null),(0,s._)([(0,o.Cb)()],Ae.prototype,"viewModel",void 0),(0,s._)([(0,xe.h)()],Ae.prototype,"_handleClick",null),Ae=(0,s._)([(0,c.j)("esri.widgets.BasemapGallery")],Ae);const Ee=Ae},76243:(e,t,i)=>{i.d(t,{Z:()=>h});var s=i(27366),n=i(29479),r=i(85015),a=i(40281),o=i(49861),l=(i(25243),i(63780),i(69912));const c=a.Z.ofType(n.default);let u=class extends r.Z{constructor(e){super(e),this.basemaps=new c}get state(){return"ready"}refresh(){}};(0,s._)([(0,o.Cb)({type:c})],u.prototype,"basemaps",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],u.prototype,"state",null),u=(0,s._)([(0,l.j)("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],u);const h=u},97862:(e,t,i)=>{i.d(t,{Z:()=>b});var s=i(27366),n=i(29479),r=i(40281),a=i(10064),o=i(100),l=i(54472),c=i(32718),u=i(67426),h=i(66978),p=i(94172),d=i(49861),m=(i(25243),i(63780),i(69912)),f=i(70032),g=i(76243);const y=r.Z.ofType(n.default);let _=class extends(l.Z.LoadableMixin((0,u.v)(g.Z))){constructor(e){super(e),this._handles=new o.Z,this.basemaps=new y,this.filterFunction=null,this.portal=f.Z.getDefault(),this.query=null,this.updateBasemapsCallback=null}initialize(){this._handles.add([(0,p.YP)((()=>[this.filterFunction,this.loadStatus,this.portal?.basemapGalleryGroupQuery,this.portal?.user,this.query,this.updateBasemapsCallback]),(()=>this.refresh()),p.nn)])}destroy(){this._handles.destroy(),this._handles=null,this.filterFunction=null,this.portal=null}get state(){return"not-loaded"===this.loadStatus?"not-loaded":"loading"===this.loadStatus||this._lastPortalBasemapFetchController?"loading":"ready"}load(e){return this.addResolvingPromise(this.portal.load(e)),this.notifyChange("state"),Promise.resolve(this)}async refresh(){if("ready"!==this.state)return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const e=this.portal,t=new AbortController;this._lastPortalBasemapFetchController=t,this.notifyChange("state");try{const i=await e.fetchBasemaps(this._toQueryString(this.query),t);this._updateBasemaps(i)}catch(i){if((0,h.D_)(i))throw i;c.Z.getLogger(this.declaredClass).warn(new a.Z("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:i})),this._updateBasemaps()}this._lastPortalBasemapFetchController=null,this.notifyChange("state")}_toQueryString(e){return e&&"string"!=typeof e?Object.keys(e).map((t=>`${t}:${e[t]}`)).join(" AND "):e}_updateBasemaps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.filterFunction?e.filter(this.filterFunction):e;t=this.updateBasemapsCallback?this.updateBasemapsCallback(t):t,this.basemaps.removeAll(),this.basemaps.addMany(t)}};(0,s._)([(0,d.Cb)({readOnly:!0,type:y})],_.prototype,"basemaps",void 0),(0,s._)([(0,d.Cb)()],_.prototype,"filterFunction",void 0),(0,s._)([(0,d.Cb)({type:f.Z})],_.prototype,"portal",void 0),(0,s._)([(0,d.Cb)()],_.prototype,"query",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],_.prototype,"state",null),(0,s._)([(0,d.Cb)()],_.prototype,"updateBasemapsCallback",void 0),_=(0,s._)([(0,m.j)("esri.widgets.BasemapGallery.support.PortalBasemapsSource")],_);const b=_}}]);
//# sourceMappingURL=9079.1015fd4a.chunk.js.map