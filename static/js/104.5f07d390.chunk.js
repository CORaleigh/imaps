(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[104],{1051:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return l}));var r,n,a=i(120),s=i(119),o=i(254);function l(){var e=new o.a;e.vertex.uniforms.add("proj","mat4").add("view","mat4").add("width","float"),e.attributes.add("position","vec3"),e.attributes.add("normal","vec3"),e.attributes.add("uv0","vec2"),e.attributes.add("auxpos1","float"),e.varyings.add("vtc","vec2"),e.varyings.add("vlength","float"),e.varyings.add("vradius","float"),e.vertex.code.add(Object(s.a)(r||(r=Object(a.a)(["\n    void main(void) {\n      vec3 bitangent = normal;\n\n      vtc = uv0;\n      vlength = auxpos1;\n      vradius = 0.5 * width;\n\n      vec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\n      gl_Position = proj * pos;\n    }\n  "])))),e.fragment.uniforms.add("outlineSize","float").add("outlineColor","vec4").add("stripeLength","float").add("stripeEvenColor","vec4").add("stripeOddColor","vec4");var t=1/Math.sqrt(2);return e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      } else if (d < outlineSize) {\n        return outlineColor;\n      } else {\n        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n      }\n    }\n\n    void main(void) {\n      vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n      vec4 color = arrowColor(ntc, vlength / vradius);\n      if (color.a == 0.0) {\n        discard;\n      }\n      gl_FragColor = color;\n    }\n  "])),s.a.float(t))),e}var c=Object.freeze({__proto__:null,build:l})},1057:function(e,t,i){"use strict";i.d(t,"a",(function(){return C})),i.d(t,"b",(function(){return P}));var r=i(89),n=i(105),a=i(104),s=i(111),o=i(115),l=i(135),c=i(517),d=i(760),h=i(82),u=(i(80),i(81),i(88),i(85)),p=i(84),v=(i(83),i(86),i(87),i(97)),b=(i(302),(e,t,i)=>{for(var r=0,n=t.length;r<n;r++){var a=t[r];Array.isArray(a)?b(e,a,i):null!=a&&!1!==a&&("string"==typeof a&&(a={vnodeSelector:"",properties:void 0,children:void 0,text:a.toString(),domNode:null}),i.push(a))}});function m(e,t,i){if(Array.isArray(t))i=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");var r,n;return i&&1===i.length&&"string"==typeof i[0]?r=i[0]:i&&(b(e,i,n=[]),0===n.length&&(n=void 0)),{vnodeSelector:e,properties:t,children:n,text:""===r?void 0:r,domNode:null}}i(367);var f=class extends v.a{constructor(e){super(e),this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.width=1,this.color=[0,0,0,.5],this.visible=!0}get startPosition(){return[this.startX,this.startY]}set startPosition(e){this._set("startX",e[0]),this._set("startY",e[1])}get endPosition(){return[this.endX,this.endY]}set endPosition(e){this._set("endX",e[0]),this._set("endY",e[1])}get strokeStyle(){var e=this.color;return"rgba(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ").concat(e[3],")")}get lineCap(){return"round"}render(){var{height:e,left:t,top:i,width:r,x1:n,x2:a,y1:s,y2:o}=this.calculateCoordinates(g),l="stroke: ".concat(this.strokeStyle,"; stroke-width: ").concat(this.width,"; stroke-linecap: ").concat(this.lineCap,";");return m("div",{classes:{"esri-line-overlay-item":!0},styles:{left:t+"px",top:i+"px",width:r+"px",height:e+"px",visibility:this.visible?"visible":"hidden"}},[m("svg",{width:r,height:e},[m("line",{x1:n,y1:s,x2:a,y2:o,style:l})])])}renderCanvas(e){if(this.visible){e.strokeStyle=this.strokeStyle,e.lineWidth=this.width,e.lineCap=this.lineCap;var t=this.calculateCoordinates(g);e.beginPath(),e.moveTo(t.left+t.x1,t.top+t.y1),e.lineTo(t.left+t.x2,t.top+t.y2),e.stroke()}}calculateCoordinates(e){var t=Math.min(this.startX,this.endX),i=Math.max(this.startX,this.endX),r=Math.min(this.startY,this.endY),n=Math.max(this.startY,this.endY),a=this.width;return e.left=t-a,e.top=r-a,e.width=i-t+2*a,e.height=Math.max(20,n-r+2*a),e.x1=this.startX-t+a,e.y1=this.startY-r+a,e.x2=this.endX-t+a,e.y2=this.endY-r+a,e}};Object(h.a)([Object(u.b)()],f.prototype,"startX",void 0),Object(h.a)([Object(u.b)()],f.prototype,"startY",void 0),Object(h.a)([Object(u.b)()],f.prototype,"endX",void 0),Object(h.a)([Object(u.b)()],f.prototype,"endY",void 0),Object(h.a)([Object(u.b)()],f.prototype,"startPosition",null),Object(h.a)([Object(u.b)()],f.prototype,"endPosition",null),Object(h.a)([Object(u.b)()],f.prototype,"width",void 0),Object(h.a)([Object(u.b)()],f.prototype,"color",void 0),Object(h.a)([Object(u.b)()],f.prototype,"visible",void 0),Object(h.a)([Object(u.b)({readOnly:!0})],f.prototype,"strokeStyle",null),f=Object(h.a)([Object(p.a)("esri.views.overlay.LineOverlayItem")],f);var g={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},O=f,j={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"},_=class extends v.a{constructor(e){super(e),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.backgroundColor="rgba(0, 0, 0, 0.6)",this.textColor="white",this.textShadowColor=[0,0,0],this.textShadowSize=1}get position(){return[this.x,this.y]}set position(e){this._set("x",e[0]),this._set("y",e[1])}get padding(){return.5*this.fontSize}render(){return m("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",backgroundColor:this.backgroundColor,color:this.textColor,padding:this.padding+"px",borderRadius:this.padding+"px",textShadow:"0 0 ".concat(this.textShadowSize,"px rgb(").concat(this.textShadowColor[0],", ").concat(this.textShadowColor[1],", ").concat(this.textShadowColor[2],")")}},[this.text])}renderCanvas(e){if(this.visible){var t=e.font.replace(/^(.*?)px/,"");e.font="".concat(this.fontSize,"px ").concat(t);var i=this.padding,r=this.padding,n=e.measureText(this.text).width,a=this.fontSize,s=y[this.anchor];e.textAlign="center",e.textBaseline="middle";var o=n+2*i,l=a+2*i,c=this.x+s.x*o,d=this.y+s.y*l;this.roundedRect(e,c,d,o,l,r),e.fillStyle=this.backgroundColor,e.fill();var h=this.x+(s.x+.5)*o,u=this.y+(s.y+.5)*l;this._renderTextShadow(e,this.text,h,u),e.fillStyle=this.textColor,e.fillText(this.text,h,u)}}_renderTextShadow(e,t,i,r){e.lineJoin="miter",e.fillStyle="rgba(".concat(this.textShadowColor[0],", ").concat(this.textShadowColor[1],", ").concat(this.textShadowColor[2],", ").concat(1/x.length,")");var n=this.textShadowSize;for(var[a,s]of x)e.fillText(t,i+n*a,r+n*s)}roundedRect(e,t,i,r,n,a){e.beginPath(),e.moveTo(t,i+a),e.arcTo(t,i,t+a,i,a),e.lineTo(t+r-a,i),e.arcTo(t+r,i,t+r,i+a,a),e.lineTo(t+r,i+n-a),e.arcTo(t+r,i+n,t+r-a,i+n,a),e.lineTo(t+a,i+n),e.arcTo(t,i+n,t,i+n-a,a),e.closePath()}_cssClasses(){var e={"esri-text-overlay-item":!0};for(var t in j)e[j[t]]=this.anchor===t;return e}};Object(h.a)([Object(u.b)()],_.prototype,"x",void 0),Object(h.a)([Object(u.b)()],_.prototype,"y",void 0),Object(h.a)([Object(u.b)()],_.prototype,"position",null),Object(h.a)([Object(u.b)()],_.prototype,"text",void 0),Object(h.a)([Object(u.b)()],_.prototype,"fontSize",void 0),Object(h.a)([Object(u.b)()],_.prototype,"anchor",void 0),Object(h.a)([Object(u.b)()],_.prototype,"visible",void 0),Object(h.a)([Object(u.b)()],_.prototype,"padding",null),_=Object(h.a)([Object(p.a)("esri.views.overlay.TextOverlayItem")],_);for(var y={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},x=[],S=0;S<360;S+=22.5)x.push([Math.cos(Math.PI*S/180),Math.sin(Math.PI*S/180)]);var w=_;class C extends c.a{constructor(e){super(e.view),this._handles=new o.a,this._textItem=null,this._calloutItem=null,this._showCallout=!0,this._showText=!0,this._geometry=null,this._text=null,this._fontSize=14,this._distance=25,this._anchor="right",this.applyProps(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._updateLabelPosition()}get textItem(){return this._textItem}get text(){return this._text}set text(e){this._text=e,this.attached&&(this._textItem.text=this._text)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e,this.attached&&(this._textItem.fontSize=this._fontSize)}get distance(){return this._distance}set distance(e){this._distance!==e&&(this._distance=e,this._updateLabelPosition())}get anchor(){return this._anchor}set anchor(e){this._anchor!==e&&(this._anchor=e,this._updateLabelPosition())}overlaps(e){return this.textItem.visible&&e.textItem.visible&&this.view.overlay.overlaps(this._textItem,e.textItem)}_updateLabelPosition(){if(this.attached){if(this._showText=!1,this._showCallout=!1,Object(r.k)(this.geometry)&&this.view._stage)switch(this.geometry.type){case"point":this._computeLabelPositionFromPoint(this.geometry,I)&&(this._textItem.position=[I[0],I[1]],this._textItem.anchor="center",this._showText=!0);break;case"corner":this._computeLabelPositionFromCorner(this.geometry,this._distance,I,q)&&(this._showCallout=this._updatePosition(I,q),this._showText=!0);break;case"segment":this._computeLabelPositionFromSegment(this.geometry,this._distance,this._anchor,I,q)&&(this._showText=!0,this._showCallout=this._updatePosition(I,q))}this.updateVisibility(this.visible)}}_computeLabelPositionFromPoint(e,t){this.view.renderCoordsHelper.toRenderCoords(e,T);var i=this.view._stage.camera;return i.projectToRenderScreen(T,V),!(V[2]<0||V[2]>1)&&(i.renderToScreen(V,t),!0)}_computeLabelPositionFromCorner(e,t,i,r){if(!e)return!1;var n=this.view._stage.camera;return z(e.left,1,n,A),Object(l.n)(A,A),z(e.right,0,n,M),Object(l.h)(R,A,M),Object(l.n)(R,R),Object(l.e)(R,R),n.projectToRenderScreen(e.left.endRenderSpace,V),!(V[2]<0||V[2]>1)&&(n.renderToScreen(V,i),Object(l.a)(R,R,t*n.pixelRatio),Object(l.h)(R,R,V),n.renderToScreen(R,r),!0)}_computeLabelPositionFromSegment(e,t,i,r,n){if(!e)return!1;var a=e.segment,s=this.view._stage.camera;Object(d.e)(a.startRenderSpace,a.endRenderSpace,A,s),Object(l.r)(R,-A[1],A[0]);var o=!1;switch(i){case"top":o=R[1]<0;break;case"bottom":o=R[1]>0;break;case"left":o=R[0]>0;break;case"right":o=R[0]<0}if(o&&Object(l.n)(R,R),0===Object(l.l)(R))switch(i){case"top":R[1]=1;break;case"bottom":R[1]=-1;break;case"left":R[0]=-1;break;case"right":R[0]=1}return a.eval(W[e.sampleLocation],T),s.projectToRenderScreen(T,V),!(V[2]<0||V[2]>1)&&(s.renderToScreen(V,r),Object(l.a)(R,R,t*s.pixelRatio),Object(l.h)(R,R,V),s.renderToScreen(R,n),!0)}_updatePosition(e,t){if(t){var i=t[0]-e[0],r=t[1]-e[1];return this._textItem.position=[t[0],t[1]],this._textItem.anchor=Math.abs(i)>Math.abs(r)?i>0?"left":"right":r>0?"top":"bottom",this._calloutItem.startPosition=[e[0],e[1]],this._calloutItem.endPosition=[t[0],t[1]],!0}return this._textItem.position=[e[0],e[1]],this._textItem.anchor="center",!1}createResources(){this._textItem=new w({visible:!0}),this._textItem.text=Object(r.q)(this._text),this._textItem.fontSize=this._fontSize,this._calloutItem=new O({visible:!0,width:2}),this._updateLabelPosition(),this.view.overlay.items.addMany([this._textItem,this._calloutItem]),this._handles.add(this.view.state.watch("camera",(()=>{this._updateLabelPosition()})))}destroyResources(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}updateVisibility(e){this._textItem.visible=this._showText&&e,this._calloutItem.visible=this._showCallout&&e}}function z(e,t,i,r){e.eval(t,E,D),Object(s.e)(L,E,D),i.projectToRenderScreen(E,F),i.projectToRenderScreen(L,N),Object(l.d)(r,G,U),Object(l.e)(r,r)}function P(e){switch(e){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}var E=Object(a.e)(),L=Object(a.e)(),D=Object(a.e)(),A=Object(n.d)(),M=Object(n.d)(),R=Object(n.d)(),T=Object(a.e)(),V=Object(n.e)(),I=Object(n.g)(),q=Object(n.g)(),F=Object(n.e)(),U=F,N=Object(n.e)(),G=N,W={start:0,center:.5,end:1}},1244:function(e,t,i){"use strict";i.r(t),i.d(t,"DirectLineMeasurement3DView",(function(){return ne}));var r=i(7),n=i(91),a=i(82),s=(i(80),i(89)),o=(i(81),i(88),i(85)),l=i(84),c=(i(83),i(86),i(87),i(97)),d=i(148),h=i(110),u=i(105),p=i(206),v=(i(171),i(104)),b=i(111),m=i(115),f=i(108),g=i(173),O=i(117),j=i(979),_=i(135),y=i(373),x=i(786),S=i(690),w=i(760),C=i(1057),z=i(907),P=i(978),E=i(174),L=i(177),D=i(370),A=i(468),M=i(368),R=i(388),T=i(379),V=i(300),I=i(307),q=i(313),F=i(306),U=i(286),N=i(267),G=i(380),W=i(1051);class k extends I.a{constructor(e,t){super(e,t)}initializeProgram(e){var t=k.shader.get().build();return new U.a(e.rctx,t.generateSource("vertex"),t.generateSource("fragment"),F.a)}bindPass(e,t,i){G.a.bindProjectionMatrix(this.program,i.camera.projectionMatrix),this.program.setUniform1f("width",t.width),this.program.setUniform1f("outlineSize",t.outlineSize),this.program.setUniform4fv("outlineColor",t.outlineColor),this.program.setUniform1f("stripeLength",t.stripeLength),this.program.setUniform4fv("stripeEvenColor",t.stripeEvenColor),this.program.setUniform4fv("stripeOddColor",t.stripeOddColor)}bindDraw(e){G.a.bindView(this.program,e)}initializePipeline(){return Object(N.d)({polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:513},depthWrite:N.c,colorWrite:N.b})}get primitiveType(){return 5}}k.shader=new V.a(W.a,(()=>i.e(299).then(i.bind(null,1219))));class B extends q.a{constructor(){super(...arguments),this.polygonOffsetEnabled=!1}}Object(a.a)([Object(q.b)()],B.prototype,"polygonOffsetEnabled",void 0);class H extends T.a{constructor(e){super(e,J),this.techniqueConfig=new B}getTechniqueConfig(){return this.techniqueConfig.polygonOffsetEnabled=this.params.polygonOffset,this.techniqueConfig}dispose(){}getPassParameters(){return this.params}intersect(){}createBufferWriter(){return new te}getGLMaterial(e){return 0===e.output?new X(e):void 0}}class X extends R.a{constructor(e){super(e),this.updateParameters()}updateParameters(){this.technique=this.techniqueRep.acquireAndReleaseExisting(k,this.material.getTechniqueConfig(),this.technique)}beginSlot(e){return 3===e}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}}var J=Object(n.a)({width:32,outlineSize:.2,outlineColor:[1,.5,0,1],stripeLength:1,stripeEvenColor:[1,1,1,1],stripeOddColor:[1,.5,0,1],polygonOffset:!1},T.b),Q=Object(M.a)().vec3f("position").vec3f("normal").vec2f("uv0").f32("auxpos1"),Y=Object(v.e)(),Z=Object(v.e)(),K=Object(v.e)(),$=Object(v.e)(),ee=Object(v.e)();class te{constructor(){this.vertexBufferLayout=Q}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 2*(e.indices.get("position").length/2+1)}write(e,t,i,r){var n=t.vertexAttributes.get("position").data,a=t.vertexAttributes.get("normal").data,s=n.length/3,o=t&&t.indices&&t.indices.get("position");o&&o.length!==2*(s-1)&&console.warn("MeasurementArrowMaterial does not support indices");for(var l=Y,c=Z,d=K,h=$,u=ee,p=e.transformation,v=e.invTranspTransformation,m=i.position,f=i.normal,g=i.uv0,O=0,j=0;j<s;++j){var _=3*j;if(Object(b.v)(l,n[_],n[_+1],n[_+2]),j<s-1){var y=3*(j+1);Object(b.v)(c,n[y],n[y+1],n[y+2]),Object(b.v)(u,a[y],a[y+1],a[y+2]),Object(b.q)(u,u),Object(b.i)(d,c,l),Object(b.q)(d,d),Object(b.f)(h,u,d),Object(b.q)(h,h)}var x=Object(b.n)(l,c);p&&v&&(Object(b.l)(l,l,p),Object(b.l)(c,c,p),Object(b.l)(h,h,v));var S=r+2*j,w=S+1;m.setVec(S,l),m.setVec(w,l),f.setVec(S,h),f.setVec(w,h),g.set(S,0,O),g.set(S,1,-1),g.set(w,0,O),g.set(w,1,1),j<s-1&&(O+=x)}for(var C=i.auxpos1,z=0;z<2*s;++z)C.set(r+z,O)}}class ie extends A.a{constructor(e){super(e),this._parameters=re,this._handles=null,this._origin=Object(v.e)(),this._originTransform=Object(E.b)(),this._arrowCenter=Object(v.e)(),this._renderOccluded=4,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameterValues({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameterValues({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){var t=this._stripesEnabled?this._parameters.arrowStripeEvenColor:this._parameters.arrowStripeOddColor;this._arrowMaterial.setParameterValues({stripeEvenColor:t})}}createExternalResources(){var e=this._stripesEnabled?this._parameters.arrowStripeEvenColor:this._parameters.arrowStripeOddColor;this._arrowMaterial=new H({outlineColor:this._parameters.arrowOutlineColor,stripeEvenColor:e,stripeOddColor:this._parameters.arrowStripeOddColor,renderOccluded:this.renderOccluded,polygonOffset:!0}),this._handles=new m.a,this._handles.add(this.view.state.watch("camera",(()=>{this.viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles.destroy(),this._handles=null}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(!(Object(s.j)(this._geometry)||Object(s.j)(this._geometry.startRenderSpace)||Object(s.j)(this._geometry.endRenderSpace))){var t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);e.addGeometry(t,this._arrowMaterial,this._originTransform),this.viewChanged()}}_createArrowGeometry(e,t,i,r){var n=this.view.renderCoordsHelper,a=[],s=[],o=(e,t)=>{var r=L.d.get();Object(b.i)(r,e,i),a.push(r),s.push(t)};if("euclidean"===r.type){r.eval(.5,this._arrowCenter);var l=L.d.get();n.worldUpAtPosition(this._arrowCenter,l),o(e,l),o(t,l)}else{r.eval(.5,this._arrowCenter);for(var c=this._parameters.arrowSubdivisions+1&-2,d=0;d<c;++d){var h=d/(c-1),u=L.d.get(),p=L.d.get();r.eval(h,u),n.worldUpAtPosition(u,p),o(u,p)}}return D.a.createPolylineGeometry(a,s)}geometryChanged(){this.recreateGeometry()}viewChanged(){if(this.view.ready&&this.attached&&Object(s.k)(this._geometry)){var e=this.view._stage.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameterValues({width:this._parameters.arrowWidth*e})}}}var re={arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128},ne=class extends c.a{constructor(e){super(e),this._params=Object(n.a)({},le),this._handles=new m.a,this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._segmentLabelDisplayedMeasurement="euclidean",this._startPosition=Object(v.e)(),this._endPosition=Object(v.e)(),this._cornerPosition=Object(v.e)(),this._startPositionAtSeaLevel=Object(v.e)(),this._endPositionAtSeaLevel=Object(v.e)(),this._viewMode="none",this._geometryDirty=!0,this.state="pending",this.messages=null,this._visualizedMeasurement="auto",this._actualVisualizedMeasurement="euclidean",this._visualElementOrientation="auto",this._triangleOrientationOverride=null,this._triangleCollapseRatioThreshold=.03,this._geodesicDistanceThreshold=1e5}initialize(){this._handles.add(Object(f.j)(this.view,"ready",(()=>this._initialize()),!0))}_initialize(){var e=this;switch(this.state){case"ready":throw new Error("invalid state");case"destroyed":return}this._segmentVisualElement=new ie({attached:!0,view:this.view,geometry:null,renderOccluded:4}),this._triangleVisualElement=new z.a({attached:!0,view:this.view,width:this._params.triangleLineWidth,color:this._params.triangleColor,renderOccluded:4}),this._rightAngleQuad=new S.a({attached:!0,view:this.view,color:oe,renderOccluded:4}),this._projectedGeodesicLine=new z.a({attached:!0,view:this.view,width:this._params.geodesicProjectionLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stipplePattern:Object(x.c)(this._params.guideStippleLengthPixels),stippleIntegerRepeats:!1,renderOccluded:4}),this._geodesicStartHint=new z.a({attached:!0,view:this.view,width:this._params.guideLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stipplePattern:Object(x.c)(this._params.guideStippleLengthPixels),stippleIntegerRepeats:!1,renderOccluded:4}),this._geodesicEndHint=new z.a({attached:!0,view:this.view,width:this._params.guideLineWidth,color:this._params.geodesicProjectionLineColor,polygonOffset:!0,stipplePattern:Object(x.c)(this._params.guideStippleLengthPixels),stippleIntegerRepeats:!1,renderOccluded:4}),this._segmentLabel=new C.a({attached:!0,view:this.view,fontSize:this._params.direcLabelFontSize}),this._verticalLabel=new C.a({attached:!0,view:this.view,fontSize:this._params.verticalLabelFontSize}),this._horizontalLabel=new C.a({attached:!0,view:this.view,fontSize:this._params.horizontalLabelFontSize}),this._handles.add([this.dataObject.watch("visible",(()=>this._update(!1)),!0),this.dataObject.watch("startPoint",(()=>this._update()),!0),this.dataObject.watch("endPoint",(()=>this._update()),!0),this.dataObject.watch("measurement",(()=>this._update()),!0),this.dataObject.watch("settings.unit",(()=>{this._updateLabels(),this._updateSegmentStripeLength()}),!0),this.view.state.watch("camera",(()=>this._update()),!0),Object(d.c)(Object(r.a)((function*(){return e._updateMessageBundle()})))]),this._set("state","ready"),this._updateMessageBundle(),this._update()}whenReady(){var e=this;return Object(r.a)((function*(){return Object(f.j)(e,"ready").then((()=>{}))}))()}get ready(){return"ready"===this.state}get viewMode(){return this._viewMode}get visualizedMeasurement(){return this._visualizedMeasurement}set visualizedMeasurement(e){e!==this._visualizedMeasurement&&(this._visualizedMeasurement=e,this._update())}get actualVisualizedMeasurement(){return this._actualVisualizedMeasurement}get visualElementsOrientation(){return this._visualElementOrientation}set visualElementsOrientation(e){e!==this._visualElementOrientation&&(this._visualElementOrientation=e,this._update())}get allowVisualElementsOrientationChange(){return Object(s.j)(this._triangleOrientationOverride)}set allowVisualElementsOrientationChange(e){Object(s.j)(this._triangleOrientationOverride)!==e&&(Object(s.j)(this._triangleOrientationOverride)?this._triangleOrientationOverride=this._getActualVisualElementsOrientation():(this._triangleOrientationOverride=null,this._update()))}get triangleCollapseRatioThreshold(){return this._triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._triangleCollapseRatioThreshold=e,this._update()}get geodesicDistanceThreshold(){return this._geodesicDistanceThreshold}set geodesicDistanceThreshold(e){this._geodesicDistanceThreshold=e,this._update()}get segmentLabel(){return this._segmentLabel}get horizontalLabel(){return this._horizontalLabel}get verticalLabel(){return this._verticalLabel}get testData(){var e="geodesic"===this.actualVisualizedMeasurement;return{labels:{direct:e?this.horizontalLabel:this.segmentLabel,horizontal:e?this.segmentLabel:this.horizontalLabel,vertical:this.verticalLabel},stripeLength:this._segmentVisualElement.stripeLength}}_update(e=!0){switch(this.state){case"destroyed":case"pending":return}var t=this.dataObject.visible;switch(this._geometryDirty=e,this._geometryDirty&&t&&(this._updateGeometryAndViewMode(),this._geometryDirty=!1),this._viewMode){case"none":this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1;break;case"segment":this._segmentVisualElement.visible=t,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1;break;case"segment-and-triangle":this._segmentVisualElement.visible=t,this._triangleVisualElement.visible=t,this._rightAngleQuad.visible=t,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1;break;case"segment-and-projection":this._segmentVisualElement.visible=t,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}this._updateLabels()}destroy(){switch(this.state){case"destroyed":case"pending":return}this._handles.destroy(),this._segmentVisualElement.destroy(),this._segmentVisualElement=null,this._triangleVisualElement.destroy(),this._triangleVisualElement=null,this._rightAngleQuad.destroy(),this._rightAngleQuad=null,this._projectedGeodesicLine.destroy(),this._projectedGeodesicLine=null,this._geodesicStartHint.destroy(),this._geodesicStartHint=null,this._geodesicEndHint.destroy(),this._geodesicEndHint=null,this._segmentLabel.destroy(),this._segmentLabel=null,this._verticalLabel.destroy(),this._verticalLabel=null,this._horizontalLabel.destroy(),this._horizontalLabel=null,this.set("view",null),this._set("state","destroyed")}_updateGeometryAndViewMode(){var e=this.view,t=e.renderCoordsHelper;if(Object(s.j)(this.dataObject.startPoint)||Object(s.j)(this.dataObject.endPoint)||this.dataObject.startPoint.equals(this.dataObject.endPoint))return this._viewMode="none",void(this._actualVisualizedMeasurement="auto"===this._visualizedMeasurement?"euclidean":this._visualizedMeasurement);t.toRenderCoords(this.dataObject.startPoint,this._startPosition),t.toRenderCoords(this.dataObject.endPoint,this._endPosition);var i=this._getActualVisualElementsOrientation(),r=this._updateActualVisualizedMeasurement();this._viewMode=this._computeViewMode(r);var n=this._startPosition,a=this._endPosition,o="above-segment"===i?1:-1,l=o*(t.getAltitude(a)-t.getAltitude(n));l<0&&(n=this._endPosition,a=this._startPosition);var c="geodesic"===r?new P.b(this._startPosition,this._endPosition,t.spatialReference):new P.a(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=c,this._updateSegmentStripeLength(),this._segmentLabelDisplayedMeasurement=r,this._viewMode){case"segment":this._segmentLabel.anchor="above-segment"===i?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:c,sampleLocation:"center"};break;case"segment-and-triangle":var d=this._cornerPosition;t.worldUpAtPosition(n,d),Object(b.d)(d,d,o*Math.abs(l)),Object(b.e)(d,d,n),this._triangleVisualElement.geometry=[[[n[0],n[1],n[2]],[d[0],d[1],d[2]],[a[0],a[1],a[2]]]],this._rightAngleQuad.geometry={previous:n,center:d,next:a};var u=new P.a(n,d),p=new P.a(d,a),v=function(e,t,i,r,n){var a=de,s=he;n.projectToRenderScreen(i,a),n.projectToRenderScreen(t,s);var o={segment:"bottom",horizontal:"top",vertical:a[0]<s[0]?"left":"right"},l=ue,c=pe;if(Object(w.e)(e,i,l,n),Object(w.e)(e,t,c,n),Object(_.g)(l,c)>=ce)o.segment=Object(h.r)(l[1])===Object(h.r)(c[1])?Object(C.b)(o.vertical):o.vertical;else{var d=ve;Object(w.e)(i,t,d,n),Object(_.g)(d,c)>=ce&&(o.segment=Object(h.r)(d[0])===Object(h.r)(c[0])?Object(C.b)(o.horizontal):o.horizontal)}if("below-segment"===r){var u=e=>"top"===e?"bottom":"top";o.segment=u(o.segment),o.horizontal=u(o.horizontal),o.vertical=u(o.vertical)}return o}(n,a,d,i,e.state.camera);this._segmentLabel.geometry={type:"segment",segment:c,sampleLocation:"center"},this._segmentLabel.anchor=v.segment,this._verticalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._verticalLabel.anchor=v.vertical,this._horizontalLabel.geometry={type:"segment",segment:p,sampleLocation:"center"},this._horizontalLabel.anchor=v.horizontal;break;case"segment-and-projection":Object(b.j)(this._startPositionAtSeaLevel,this._startPosition),Object(b.j)(this._endPositionAtSeaLevel,this._endPosition),t.setAltitude(0,this._startPositionAtSeaLevel),t.setAltitude(0,this._endPositionAtSeaLevel);var m=new P.b(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(m),this._geodesicStartHint.setGeometryFromSegment(new P.a(this._startPositionAtSeaLevel,this._startPosition)),this._geodesicEndHint.setGeometryFromSegment(new P.a(this._endPositionAtSeaLevel,this._endPosition)),this._segmentLabel.geometry={type:"segment",segment:m,sampleLocation:"center"},this._segmentLabel.anchor="above-segment"===i?"top":"bottom"}}_updateLabels(){switch(this.state){case"pending":case"destroyed":return}var e=this.messages,t=this.dataObject.measurement;if(Object(s.j)(t)||!e)return this._segmentLabel.visible=!1,this._horizontalLabel.visible=!1,void(this._verticalLabel.visible=!1);var i={verticalDistance:"",horizontalDistance:"",euclideanDistance:"",geodesicDistance:""},r=t.directDistance,n=t.horizontalDistance,a=t.verticalDistance,o=t.geodesicDistance,l=t.geodesicAngle;switch(this.dataObject.settings.unit){case"metric":i.euclideanDistance=r&&Object(j.e)(e,r),i.horizontalDistance=n&&Object(j.e)(e,n),i.verticalDistance=a&&Object(j.f)(e,a),i.geodesicDistance=o&&Object(j.e)(e,o);break;case"imperial":i.euclideanDistance=r&&Object(j.c)(e,r),i.horizontalDistance=n&&Object(j.c)(e,n),i.verticalDistance=a&&Object(j.d)(e,a),i.geodesicDistance=o&&Object(j.c)(e,o);break;case"degrees":var c=l&&Object(j.b)(e,l,"degrees");i.euclideanDistance=c,i.horizontalDistance=c,i.geodesicDistance=c;break;case"degrees-minutes-seconds":i.horizontalDistance=l&&Object(j.a)(l);break;default:var d=this.dataObject.settings.unit;i.euclideanDistance=r&&Object(j.b)(e,r,d),i.horizontalDistance=n&&Object(j.b)(e,n,d),i.verticalDistance=a&&Object(j.b)(e,a,d),i.geodesicDistance=o&&Object(j.b)(e,o,d)}this._segmentLabel.text="euclidean"===this._segmentLabelDisplayedMeasurement?i.euclideanDistance:i.geodesicDistance,this._horizontalLabel.text=i.horizontalDistance,this._verticalLabel.text=i.verticalDistance;var h=this.dataObject.visible;switch(this._viewMode){case"none":this._segmentLabel.visible=!1,this._horizontalLabel.visible=!1,this._verticalLabel.visible=!1;break;case"segment":this._segmentLabel.visible=h,this._horizontalLabel.visible=!1,this._verticalLabel.visible=!1;break;case"segment-and-triangle":this._segmentLabel.visible=h,this._horizontalLabel.visible=h,this._verticalLabel.visible=h;break;case"segment-and-projection":this._segmentLabel.visible=h,this._horizontalLabel.visible=!1,this._verticalLabel.visible=!1}this.notifyChange("segmentLabel"),this.notifyChange("horizontalLabel"),this.notifyChange("verticalLabel")}_updateSegmentStripeLength(){var e=function(e,t){var i=null;if(Object(s.k)(t.measurement)){var r=t.measurement.directDistance;switch(t.settings.unit){case"metric":i=r&&r.toUnit("meters");break;case"imperial":i=r&&r.toUnit(Object(O.s)(r.value,r.unit));break;case"degrees":case"degrees-minutes-seconds":var n=t.measurement.geodesicAngle;i=n&&n.toUnit("degrees");break;default:i=r&&r.toUnit(t.settings.unit)}}if(i){var a=1;return a=Object(h.n)(i.value/30),a*="degrees"===i.unit?Object(g.e)(e.spatialReference).metersPerDegree:Object(O.c)(1,i.unit,"meters")}return null}(this.view,this.dataObject);Object(s.k)(e)?(this._segmentVisualElement.stripeLength=e,this._segmentVisualElement.stripesEnabled=!0):this._segmentVisualElement.stripesEnabled=!1}_computeViewMode(e){var t=this.dataObject,i=t.measurement;if("geodesic"===e){if(!ae(t,this.geodesicDistanceThreshold))return"segment";if(se(this.view,this._startPosition)||se(this.view,this._endPosition))return"segment-and-projection"}return Object(s.j)(i)||Math.min(i.verticalDistance.value/i.horizontalDistance.value,i.horizontalDistance.value/i.verticalDistance.value)<this.triangleCollapseRatioThreshold?"segment":"segment-and-triangle"}_getActualVisualElementsOrientation(){return Object(s.k)(this._triangleOrientationOverride)?this._triangleOrientationOverride:"auto"===this.visualElementsOrientation?this.view.state.camera.aboveGround?"above-segment":"below-segment":this.visualElementsOrientation}_updateActualVisualizedMeasurement(){if("auto"===this._visualizedMeasurement){this._actualVisualizedMeasurement="euclidean";var e=this.dataObject.settings.unit;"degrees"!==e&&"degrees-minutes-seconds"!==e||(this._actualVisualizedMeasurement="geodesic"),ae(this.dataObject,this.geodesicDistanceThreshold)&&(this._actualVisualizedMeasurement="geodesic")}else this._actualVisualizedMeasurement=this._visualizedMeasurement;return this._actualVisualizedMeasurement}_updateMessageBundle(){Object(p.a)("esri/core/t9n/Units").then((e=>{this.messages=e,this.view&&this._updateLabels()}))}};function ae(e,t){return Object(s.k)(e.measurement)&&e.measurement.horizontalDistance&&e.measurement.horizontalDistance.value>t}function se(e,t){if(!e.state)return!1;var i=e.state.camera,r=e.renderCoordsHelper,n=i.computeScreenPixelSizeAt(t);return r.getAltitude(t)/n>=10}Object(a.a)([Object(o.b)({readOnly:!0})],ne.prototype,"state",void 0),Object(a.a)([Object(o.b)()],ne.prototype,"ready",null),Object(a.a)([Object(o.b)()],ne.prototype,"messages",void 0),Object(a.a)([Object(o.b)()],ne.prototype,"view",void 0),Object(a.a)([Object(o.b)()],ne.prototype,"dataObject",void 0),Object(a.a)([Object(o.b)()],ne.prototype,"viewMode",null),Object(a.a)([Object(o.b)()],ne.prototype,"segmentLabel",null),Object(a.a)([Object(o.b)()],ne.prototype,"horizontalLabel",null),Object(a.a)([Object(o.b)()],ne.prototype,"verticalLabel",null),ne=Object(a.a)([Object(l.a)("esri.views.3d.interactive.graphics.DirectLineMeasurement3D.DirectLineMeasurement3DView")],ne);var oe=Object(y.c)(1,.5,0,.75),le={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,laserLineEnabled:!0,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5,triangleColor:oe,triangleLineWidth:3,triangleCornerSize:32,triangleSubdivisions:128,arrowWidth:16,arrowOutlineColor:[1,.5,0,1],arrowOutlineWidth:.2,arrowStripeEvenColor:[1,1,1,1],arrowStripeOddColor:[1,.5,0,1],arrowStripeLength:16,arrowSubdivisions:128,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:oe,guideLineWidth:2,guideLineColor:oe,guideStippleLengthPixels:6,labelDistance:25,direcLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12},ce=Math.cos(Object(h.f)(12)),de=Object(u.e)(),he=Object(u.e)(),ue=Object(u.d)(),pe=Object(u.d)(),ve=Object(u.d)()},373:function(e,t,i){"use strict";function r(){return new Float32Array(4)}function n(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,i,r){var n=new Float32Array(4);return n[0]=e,n[1]=t,n[2]=i,n[3]=r,n}function s(){return r()}function o(){return a(1,1,1,1)}function l(){return a(1,0,0,0)}function c(){return a(0,1,0,0)}function d(){return a(0,0,1,0)}function h(){return a(0,0,0,1)}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return a}));var u=s(),p=o(),v=l(),b=c(),m=d(),f=h();Object.freeze({__proto__:null,create:r,clone:n,fromValues:a,createView:function(e,t){return new Float32Array(e,t,4)},zeros:s,ones:o,unitX:l,unitY:c,unitZ:d,unitW:h,ZEROS:u,ONES:p,UNIT_X:v,UNIT_Y:b,UNIT_Z:m,UNIT_W:f})},426:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r,n,a,s,o,l,c,d=i(120),h=i(119);function u(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add("instanceFeatureAttribute","vec4"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),e.vertex.uniforms.add("vvSymbolAnchor","vec3"),e.vertex.code.add(Object(h.a)(r||(r=Object(d.a)(["\n      vec3 vvScale(vec4 _featureAttribute) {\n        return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n      }\n\n      vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\n        return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n      }\n    "])))),e.vertex.code.add(Object(h.a)(n||(n=Object(d.a)(["\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(h.a)(a||(a=Object(d.a)(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):e.vertex.code.add(Object(h.a)(s||(s=Object(d.a)(["\n      vec4 localPosition() { return vec4(position, 1.0); }\n\n      vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }\n    "])))),t.vvColor?(e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(h.a)(o||(o=Object(d.a)(["\n      uniform float vvColorValues[vvColorNumber];\n      uniform vec4 vvColorColors[vvColorNumber];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[vvColorNumber - 1];\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(h.a)(l||(l=Object(d.a)(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):e.vertex.code.add(Object(h.a)(c||(c=Object(d.a)(["\n      vec4 vvColor() { return vec4(1.0); }\n    "]))))}!function(e){function t(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors))}e.bindUniforms=t,e.bindUniformsWithOpacity=function(e,i){t(e,i),i.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",i.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",i.vvOpacityOpacities))},e.bindUniformsForSymbols=function(e,i){t(e,i),i.vvSizeEnabled&&(e.setUniform3fv("vvSymbolAnchor",i.vvSymbolAnchor),e.setUniformMatrix3fv("vvSymbolRotationMatrix",i.vvSymbolRotationMatrix))}}(u||(u={}))},468:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i(89),n=i(157),a=i(174),s=i(453),o=i(509),l=i(517);class c extends l.a{constructor(e){super(e.view),this._resources=null,this._transform=Object(a.b)()}get object(){return Object(r.k)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(e){Object(n.c)(this._transform,e),Object(r.k)(this._resources)&&(this._resources.object.transformation=this._transform,this._resources.layer.commit())}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(!Object(r.j)(this._resources)){var e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries),this._resources.layer.commit()}}createResources(){this.destroyResources();var e=this.view._stage;if(e){var t=new o.a({isPickable:!1});e.add(t);var i=new s.a({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),t.commit(),this.visible||(i.setVisible(!1),t.commit()),this._resources={layer:t,object:i}}}destroyResources(){var e=this.view._stage;!Object(r.j)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((t=>{e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){Object(r.j)(this._resources)||(this._resources.object.setVisible(e),this._resources.layer.commit())}}},471:function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var r,n=i(91),a=i(89),s=i(81),o=i(110),l=i(105),c=i(104),d=i(111),h=i(135),u=i(368),p=i(255),v=i(179),b=i(378),m=i(357),f=i(388),g=i(379),O=i(332),j=i(461);(r||(r={})).Default={vvSizeEnabled:!1,vvSizeMinSize:Object(j.c)(1,1,1),vvSizeMaxSize:Object(j.c)(100,100,100),vvSizeOffset:Object(j.c)(0,0,0),vvSizeFactor:Object(j.c)(1,1,1),vvSizeValue:Object(j.c)(1,1,1),vvColorEnabled:!1,vvColorValues:[0,0,0,0,0,0,0,0],vvColorColors:[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],vvOpacityEnabled:!1,vvOpacityValues:[0,0,0,0,0,0,0,0],vvOpacityOpacities:[1,1,1,1,1,1,1,1],vvSymbolAnchor:[0,0,0],vvSymbolRotationMatrix:Object(O.a)()};var _=r,y=i(82),x=i(300),S=i(307),w=i(313),C=i(286),z=i(267),P=i(380),E=i(249),L=i(322),D=i(426),A=i(349),M=i(280),R=i(489),T=i(615),V={position:0,subdivisionFactor:1,uv0:2,auxpos1:3,auxpos2:4,size:6,sizeFeatureAttribute:6,color:5,colorFeatureAttribute:5,opacityFeatureAttribute:7};class I extends S.a{constructor(e,t){super(e,t),this.stipplePattern=null,this.stippleTextureBind=null,this.stippleTextureRepository=e.stippleTextureRepository}initializeProgram(e){var t=I.shader.get(),i=this.configuration,r=t.build({OITEnabled:0===i.transparencyPassType,output:i.output,slicePlaneEnabled:i.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,stippleEnabled:i.stippleEnabled,stippleOffColorEnabled:i.stippleOffColorEnabled,stippleUVMaxEnabled:i.stippleIntegerRepeatsEnabled,stippleIntegerRepeatsEnabled:i.stippleIntegerRepeatsEnabled,roundCaps:i.roundCaps,roundJoins:i.roundJoins,vvColor:i.vvColor,vvSize:i.vvSize,vvInstancingEnabled:!0,vvOpacity:i.vvOpacity,falloffEnabled:i.falloffEnabled,innerColorEnabled:i.innerColorEnabled,multipassTerrainEnabled:i.multipassTerrainEnabled,cullAboveGround:i.cullAboveGround});return new C.a(e.rctx,r.generateSource("vertex"),r.generateSource("fragment"),V)}dispose(){super.dispose(),this.stippleTextureRepository.release(this.stipplePattern),this.stipplePattern=null,this.stippleTextureBind=null}bindPass(e,t,i){if(P.a.bindProjectionMatrix(this.program,i.camera.projectionMatrix),4===this.configuration.output&&L.a.bindOutputHighlight(e,this.program,i),i.multipassTerrainEnabled&&(this.program.setUniform2fv("inverseViewport",i.inverseViewport),Object(M.a)(this.program,e,i)),this.program.setUniform1f("intrinsicWidth",t.width),this.program.setUniform4fv("intrinsicColor",t.color),this.program.setUniform1f("miterLimit","miter"!==t.join?0:t.miterLimit),this.program.setUniform2fv("cameraNearFar",i.camera.nearFar),this.program.setUniform1f("pixelRatio",i.camera.pixelRatio),this.program.setUniform2f("screenSize",i.camera.fullViewport[2],i.camera.fullViewport[3]),D.a.bindUniformsWithOpacity(this.program,t),this.stipplePattern!==t.stipplePattern){var r=t.stipplePattern;this.stippleTextureBind=this.stippleTextureRepository.swap(this.stipplePattern,r),this.stipplePattern=r}if(this.configuration.stippleEnabled){var n=Object(a.k)(this.stippleTextureBind)?this.stippleTextureBind(e,0)*i.camera.pixelRatio:1;if(this.program.setUniform1i("stipplePatternTexture",0),this.program.setUniform1f("stipplePatternPixelSizeInv",1/n),this.configuration.stippleOffColorEnabled){var s=Object(a.q)(t.stippleOffColor);this.program.setUniform4f("stippleOffColor",s[0],s[1],s[2],s.length>3?s[3]:1)}}this.configuration.falloffEnabled&&this.program.setUniform1f("falloff",t.falloff),this.configuration.innerColorEnabled&&(this.program.setUniform4fv("innerColor",Object(a.r)(t.innerColor,t.color)),this.program.setUniform1f("innerWidth",t.innerWidth*i.camera.pixelRatio))}bindDraw(e){P.a.bindView(this.program,e),E.a.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e,t){var i=this.configuration,r=3===e,n=2===e;return Object(z.d)({blending:0===i.output||7===i.output?r?A.f:Object(A.a)(e):null,depthTest:{func:Object(A.b)(e)},depthWrite:r?!i.transparent&&i.writeDepth&&z.c:Object(A.c)(e),colorWrite:z.b,stencilWrite:i.sceneHasOcludees?R.h:null,stencilTest:i.sceneHasOcludees?t?R.d:R.c:null,polygonOffset:r||n?i.polygonOffset&&q:A.d})}initializePipeline(){var e=this.configuration,t=e.polygonOffset&&q;return e.occluder&&(this._occluderPipelineTransparent=Object(z.d)({blending:A.f,polygonOffset:t,depthTest:R.a,depthWrite:null,colorWrite:z.b,stencilWrite:null,stencilTest:R.f}),this._occluderPipelineOpaque=Object(z.d)({blending:A.f,polygonOffset:t,depthTest:R.a,depthWrite:null,colorWrite:z.b,stencilWrite:R.g,stencilTest:R.e}),this._occluderPipelineMaskWrite=Object(z.d)({blending:null,polygonOffset:t,depthTest:R.b,depthWrite:null,colorWrite:null,stencilWrite:R.h,stencilTest:R.d})),this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}get primitiveType(){return 5}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?11===e?this._occluderPipelineTransparent:10===e?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:this.pipeline}}I.shader=new x.a(T.a,(()=>i.e(301).then(i.bind(null,1184))));var q={factor:0,units:-4};class F extends w.a{constructor(){super(...arguments),this.output=0,this.occluder=!1,this.slicePlaneEnabled=!1,this.transparent=!1,this.polygonOffset=!1,this.writeDepth=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stippleIntegerRepeatsEnabled=!1,this.roundCaps=!1,this.roundJoins=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.falloffEnabled=!1,this.innerColorEnabled=!1,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}Object(y.a)([Object(w.b)({count:8})],F.prototype,"output",void 0),Object(y.a)([Object(w.b)()],F.prototype,"occluder",void 0),Object(y.a)([Object(w.b)()],F.prototype,"slicePlaneEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"transparent",void 0),Object(y.a)([Object(w.b)()],F.prototype,"polygonOffset",void 0),Object(y.a)([Object(w.b)()],F.prototype,"writeDepth",void 0),Object(y.a)([Object(w.b)()],F.prototype,"stippleEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"stippleOffColorEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"stippleIntegerRepeatsEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"roundCaps",void 0),Object(y.a)([Object(w.b)()],F.prototype,"roundJoins",void 0),Object(y.a)([Object(w.b)()],F.prototype,"vvSize",void 0),Object(y.a)([Object(w.b)()],F.prototype,"vvColor",void 0),Object(y.a)([Object(w.b)()],F.prototype,"vvOpacity",void 0),Object(y.a)([Object(w.b)()],F.prototype,"falloffEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"innerColorEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"sceneHasOcludees",void 0),Object(y.a)([Object(w.b)({count:4})],F.prototype,"transparencyPassType",void 0),Object(y.a)([Object(w.b)()],F.prototype,"multipassTerrainEnabled",void 0),Object(y.a)([Object(w.b)()],F.prototype,"cullAboveGround",void 0);var U=s.a.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial");class N extends g.a{constructor(e){super(e,W),this._vertexAttributeLocations=V,this.techniqueConfig=new F,this.layout=this.createLayout()}isClosed(e,t){return X(this.params,e,t)}dispose(){}getPassParameters(){return this.params}getTechniqueConfig(e,t){this.techniqueConfig.output=e;var i=Object(a.k)(this.params.stipplePattern);return this.techniqueConfig.stippleEnabled=i,this.techniqueConfig.stippleIntegerRepeatsEnabled=i&&this.params.stippleIntegerRepeats,this.techniqueConfig.stippleOffColorEnabled=i&&Object(a.k)(this.params.stippleOffColor),this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.roundJoins="round"===this.params.join,this.techniqueConfig.roundCaps="round"===this.params.cap,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.polygonOffset=this.params.polygonOffset,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.vvColor=this.params.vvColorEnabled,this.techniqueConfig.vvOpacity=this.params.vvOpacityEnabled,this.techniqueConfig.vvSize=this.params.vvSizeEnabled,this.techniqueConfig.innerColorEnabled=this.params.innerWidth>0&&Object(a.k)(this.params.innerColor),this.techniqueConfig.falloffEnabled=this.params.falloff>0,this.techniqueConfig.occluder=8===this.params.renderOccluded,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}intersect(e,t,i,r,n,a,s,o,l){l?this.intersectDrapedLineGeometry(e,r,a,s):this.intersectLineGeometry(e,t,i,r,this.params.width,s)}intersectDrapedLineGeometry(e,t,i,r){if(t.options.selectionMode){var n=e.vertexAttributes.get("position").data,a=e.vertexAttributes.get("size"),s=this.params.width;if(this.params.vvSizeEnabled){var l=e.vertexAttributes.get("sizeFeatureAttribute").data[0];s*=Object(o.d)(this.params.vvSizeOffset[0]+l*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else a&&(s*=a.data[0]);for(var c=i[0],d=i[1],h=(s/2+4)*e.screenToWorldRatio,u=Number.MAX_VALUE,p=0;p<n.length-5;p+=3){var v=n[p],b=n[p+1],m=c-v,f=d-b,g=n[p+3]-v,O=n[p+4]-b,j=Object(o.d)((g*m+O*f)/(g*g+O*O),0,1),_=g*j-m,y=O*j-f,x=_*_+y*y;x<u&&(u=x)}u<h*h&&r()}}intersectLineGeometry(e,t,i,r,n,a){if(r.options.selectionMode&&!Object(m.d)(t))if(Object(v.g)(i)){var s=e.vertexAttributes,l=s.get("position").data,c=n;if(this.params.vvSizeEnabled){var u=s.get("sizeFeatureAttribute").data[0];c*=Object(o.d)(this.params.vvSizeOffset[0]+u*this.params.vvSizeFactor[0],this.params.vvSizeMinSize[0],this.params.vvSizeMaxSize[0])}else s.has("size")&&(c*=s.get("size").data[0]);var b=r.camera,f=ee;Object(h.c)(f,r.point);var g=c*b.pixelRatio/2+4*b.pixelRatio;Object(d.v)(de[0],f[0]-g,f[1]+g,0),Object(d.v)(de[1],f[0]+g,f[1]+g,0),Object(d.v)(de[2],f[0]+g,f[1]-g,0),Object(d.v)(de[3],f[0]-g,f[1]-g,0);for(var O=0;O<4;O++)if(!b.unprojectFromRenderScreen(de[O],he[O]))return;p.e.fromPoints(b.eye,he[0],he[1],ue),p.e.fromPoints(b.eye,he[1],he[2],pe),p.e.fromPoints(b.eye,he[2],he[3],ve),p.e.fromPoints(b.eye,he[3],he[0],be);for(var j=Number.MAX_VALUE,_=H(this.params,s,e.indices)?l.length-2:l.length-5,y=0;y<_;y+=3){Y[0]=l[y]+i[12],Y[1]=l[y+1]+i[13],Y[2]=l[y+2]+i[14];var x=(y+3)%l.length;if(Z[0]=l[x]+i[12],Z[1]=l[x+1]+i[13],Z[2]=l[x+2]+i[14],!(p.e.signedDistance(ue,Y)<0&&p.e.signedDistance(ue,Z)<0||p.e.signedDistance(pe,Y)<0&&p.e.signedDistance(pe,Z)<0||p.e.signedDistance(ve,Y)<0&&p.e.signedDistance(ve,Z)<0||p.e.signedDistance(be,Y)<0&&p.e.signedDistance(be,Z)<0)){if(b.projectToRenderScreen(Y,te),b.projectToRenderScreen(Z,ie),te[2]<0&&ie[2]>0){Object(d.i)(K,Y,Z);var S=b.frustum,w=-p.e.signedDistance(S[4],Y)/Object(d.g)(K,p.e.normal(S[4]));Object(d.d)(K,K,w),Object(d.e)(Y,Y,K),b.projectToRenderScreen(Y,te)}else if(te[2]>0&&ie[2]<0){Object(d.i)(K,Z,Y);var C=b.frustum,z=-p.e.signedDistance(C[4],Z)/Object(d.g)(K,p.e.normal(C[4]));Object(d.d)(K,K,z),Object(d.e)(Z,Z,K),b.projectToRenderScreen(Z,ie)}else if(te[2]<0&&ie[2]<0)continue;te[2]=0,ie[2]=0;var P=p.d.distance2(p.d.fromPoints(te,ie,ae),f);P<j&&(j=P,Object(d.j)(re,Y),Object(d.j)(ne,Z))}}var E=r.rayBeginPoint,L=r.rayEndPoint;if(j<g*g){var D=Number.MAX_VALUE;if(p.d.closestLineSegmentPoint(p.d.fromPoints(re,ne,ae),p.d.fromPoints(E,L,se),$)){Object(d.i)($,$,E);var A=Object(d.o)($);Object(d.d)($,$,1/A),D=A/Object(d.n)(E,L)}a(D,$)}}else U.error("intersection assumes a translation-only matrix")}computeAttachmentOrigin(e,t){var i=e.vertexAttributes;if(!i)return null;var r=e.indices,n=i.get("position");return Object(b.a)(n,r?r.get("position"):null,r&&H(this.params,i,r),t)}createLayout(){var e=Object(u.a)().vec3f("position").f32("subdivisionFactor").vec2f("uv0").vec3f("auxpos1").vec3f("auxpos2");return this.params.vvSizeEnabled?e.f32("sizeFeatureAttribute"):e.f32("size"),this.params.vvColorEnabled?e.f32("colorFeatureAttribute"):e.vec4f("color"),this.params.vvOpacityEnabled&&e.f32("opacityFeatureAttribute"),e}createBufferWriter(){return new k(this.layout,this.params)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output||1===e.output?new G(e):void 0}validateParameterValues(e){"miter"!==e.join&&(e.miterLimit=0),this.requiresTransparent(e)&&(e.transparent=!0)}requiresTransparent(e){return!!((e.color&&e.color[3])<1||e.innerWidth>0&&this.colorRequiresTransparent(e.innerColor)||e.stipplePattern&&this.colorRequiresTransparent(e.stippleOffColor)||e.falloff>0)}colorRequiresTransparent(e){return Object(a.k)(e)&&e[3]<1&&e[3]>0}}class G extends f.a{constructor(e){super(e),this.updateParameters()}updateParameters(e){this.technique=this.techniqueRep.acquireAndReleaseExisting(I,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){return this.technique.configuration.occluder?3===e||10===e||11===e:0===this.output||7===this.output?(this.targetSlot=this.technique.configuration.writeDepth?5:8,e===this.targetSlot):3===e}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&this.material.setParameterValues({sceneHasOcludees:e.hasOccludees})}ensureParameters(e){0!==this.output&&7!==this.output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.technique.bindPass(e,this.material.getPassParameters(),t)}getPipelineState(e,t){return this.technique.getPipelineState(e,t)}}var W=Object(n.a)(Object(n.a)({width:0,color:[1,1,1,1],join:"miter",cap:"butt",miterLimit:5,writeDepth:!0,polygonOffset:!1,stipplePattern:null,stippleIntegerRepeats:!1,stippleOffColor:null,slicePlaneEnabled:!1,vvFastUpdate:!1,transparent:!1,isClosed:!1,falloff:0,innerWidth:0,innerColor:null,sceneHasOcludees:!1},g.b),_.Default);class k{constructor(e,t){switch(this.params=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e,this.params.join){case"miter":case"bevel":this.numJoinSubdivisions=t.stipplePattern?1:0;break;case"round":this.numJoinSubdivisions=Q}}isClosed(e){return H(this.params,e.vertexAttributes,e.indices)}numCapSubdivisions(e){if(this.isClosed(e))return 0;switch(this.params.cap){case"butt":return 0;case"square":return 1;case"round":return J}}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){var t=2*this.numCapSubdivisions(e)+2,i=e.indices.get("position").length/2+1,r=this.isClosed(e),n=r?2:2*t,a=r?0:1,s=r?i:i-1;if(e.vertexAttributes.has("subdivisions"))for(var o=e.vertexAttributes.get("subdivisions").data,l=a;l<s;++l)n+=4+2*o[l];else n+=(s-a)*(2*this.numJoinSubdivisions+4);return n+=2}write(e,t,i,r){var n=oe,a=le,s=ce,o=t.vertexAttributes.get("position").data,l=t.indices&&t.indices.get("position"),c=this.numCapSubdivisions(t);l&&l.length!==2*(o.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");var h=null;t.vertexAttributes.has("subdivisions")&&(h=t.vertexAttributes.get("subdivisions").data);var u=1,p=0;this.params.vvSizeEnabled?p=t.vertexAttributes.get("sizeFeatureAttribute").data[0]:t.vertexAttributes.has("size")&&(u=t.vertexAttributes.get("size").data[0]);var v=[1,1,1,1],b=0;this.params.vvColorEnabled?b=t.vertexAttributes.get("colorFeatureAttribute").data[0]:t.vertexAttributes.has("color")&&(v=t.vertexAttributes.get("color").data);var m=0;this.params.vvOpacityEnabled&&(m=t.vertexAttributes.get("opacityFeatureAttribute").data[0]);var f=o.length/3,g=e.transformation,O=new Float32Array(i.buffer),j=this.vertexBufferLayout.stride/4,_=r*j,y=_,x=(e,t,i,r,n,a,s)=>{if(O[_++]=t[0],O[_++]=t[1],O[_++]=t[2],O[_++]=r,O[_++]=n,O[_++]=a,O[_++]=e[0],O[_++]=e[1],O[_++]=e[2],O[_++]=i[0],O[_++]=i[1],O[_++]=i[2],this.params.vvSizeEnabled?O[_++]=p:O[_++]=u,this.params.vvColorEnabled)O[_++]=b;else{var o=Math.min(4*s,v.length-4);O[_++]=v[o+0],O[_++]=v[o+1],O[_++]=v[o+2],O[_++]=v[o+3]}this.params.vvOpacityEnabled&&(O[_++]=m)};_+=j,Object(d.v)(a,o[0],o[1],o[2]),g&&Object(d.l)(a,a,g);var S=this.isClosed(t);if(S){var w=o.length-3;Object(d.v)(n,o[w],o[w+1],o[w+2]),g&&Object(d.l)(n,n,g)}else{Object(d.j)(n,a),Object(d.v)(s,o[3],o[4],o[5]),g&&Object(d.l)(s,s,g);for(var C=0;C<c;++C){var z=1-C/c;x(n,a,s,z,1,-4,0),x(n,a,s,z,1,4,0)}x(n,a,s,0,0,-4,0),x(n,a,s,0,0,4,0),Object(d.j)(n,a),Object(d.j)(a,s)}for(var P=S?f:f-1,E=S?0:1;E<P;E++){var L=(E+1)%f*3;Object(d.v)(s,o[L+0],o[L+1],o[L+2]),g&&Object(d.l)(s,s,g),x(n,a,s,0,1,-1,E),x(n,a,s,0,1,1,E);for(var D=h?h[E]:this.numJoinSubdivisions,A=0;A<D;++A){var M=(A+1)/(D+1);x(n,a,s,M,1,-2,E),x(n,a,s,M,1,2,E)}x(n,a,s,1,0,-2,E),x(n,a,s,1,0,2,E),Object(d.j)(n,a),Object(d.j)(a,s)}if(S)_=B(O,y+j,O,_,2*j);else{x(n,a,s,0,1,-5,P),x(n,a,s,0,1,5,P);for(var R=0;R<c;++R){var T=(R+1)/c;x(n,a,s,T,1,-5,P),x(n,a,s,T,1,5,P)}}B(O,y+j,O,y,j),_=B(O,_-j,O,_,j)}}function B(e,t,i,r,n){for(var a=0;a<n;a++)i[r++]=e[t++];return r}function H(e,t,i){return X(e,t.get("position").data,i?i.get("position"):null)}function X(e,t,i){return!!e.isClosed&&(i?i.length>2:t.length>6)}var J=3,Q=1,Y=Object(c.e)(),Z=Object(c.e)(),K=Object(c.e)(),$=Object(c.e)(),ee=Object(c.e)(),te=Object(l.e)(),ie=Object(l.e)(),re=Object(c.e)(),ne=Object(c.e)(),ae=p.d.create(),se=p.d.create(),oe=Object(c.e)(),le=Object(c.e)(),ce=Object(c.e)(),de=[Object(l.e)(),Object(l.e)(),Object(l.e)(),Object(l.e)()],he=[Object(c.e)(),Object(c.e)(),Object(c.e)(),Object(c.e)()],ue=p.e.create(),pe=p.e.create(),ve=p.e.create(),be=p.e.create()},551:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r,n,a=i(120),s=i(119);function o(e){e.vertex.code.add(Object(s.a)(r||(r=Object(a.a)(["\n    const float PI = 3.141592653589793;\n  "])))),e.fragment.code.add(Object(s.a)(n||(n=Object(a.a)(["\n    const float PI = 3.141592653589793;\n    const float LIGHT_NORMALIZATION = 1.0 / PI;\n    const float INV_PI = 0.3183098861837907;\n    const float HALF_PI = 1.570796326794897;\n    "]))))}},567:function(e,t,i){"use strict";function r(e,t){for(var[i,r]of e)if(t(r,i))return!0;return!1}i.d(t,"a",(function(){return r}))},599:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r,n,a,s,o=i(120),l=i(119);function c(e,t){e.constants.add("stippleAlphaColorDiscard","float",.001),e.constants.add("stippleAlphaHighlightDiscard","float",.5),t.stippleEnabled?function(e,t){e.vertex.uniforms.add("stipplePatternPixelSizeInv","float"),t.stippleUVMaxEnabled&&e.varyings.add("stipplePatternUvMax","float"),e.varyings.add("stipplePatternUv","float"),e.fragment.uniforms.add("stipplePatternTexture","sampler2D"),t.stippleOffColorEnabled&&e.fragment.uniforms.add("stippleOffColor","vec4"),e.fragment.code.add(Object(l.a)(r||(r=Object(o.a)(["\n  float getStippleAlpha() {\n    float stipplePatternUvClamped = stipplePatternUv * gl_FragCoord.w;\n    ","\n\n    return texture2D(stipplePatternTexture, vec2(mod(stipplePatternUvClamped, 1.0), 0.5)).a;\n  }"])),t.stippleUVMaxEnabled?"stipplePatternUvClamped = clamp(stipplePatternUvClamped, 0.0, stipplePatternUvMax);":"")),t.stippleOffColorEnabled?e.fragment.code.add(Object(l.a)(n||(n=Object(o.a)(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) {}\n    #define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)\n    "])))):e.fragment.code.add(Object(l.a)(a||(a=Object(o.a)(["\n    #define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }\n    #define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)\n    "]))))}(e,t):function(e){e.fragment.code.add(Object(l.a)(s||(s=Object(o.a)(["\n  float getStippleAlpha() { return 1.0; }\n\n  #define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}\n  #define blendStipple(color, _stippleAlpha_) color\n  "]))))}(e)}},601:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return v})),i.d(t,"c",(function(){return b}));var r,n,a=i(180),s=i(89),o=i(104),l=i(157),c=i(223),d=i(174),h=i(327),u=i(583),p=i(584);function v(e,t,i,r,n,a,s,o,l,d,h){var u,p,v=f[h.mode],b=0;if(Object(c.k)(e,t,i,r,l.spatialReference,n,o))return v.requiresAlignment(h)?(b=v.applyElevationAlignmentBuffer(r,n,a,s,o,l,d,h),u=a,p=s):(u=r,p=n),Object(c.k)(u,l.spatialReference,p,a,d.spatialReference,s,o)?b:void 0}function b(e,t,i,r,n){var o=(Object(h.c)(e)?e.z:Object(u.b)(e)?e.array[e.offset+2]:e[2])||0;switch(i.mode){case"on-the-ground":var l=Object(s.r)(Object(u.a)(t,e,"ground"),0);return n&&(n.verticalDistanceToGround=0,n.sampledElevation=l),l;case"relative-to-ground":var c=Object(s.r)(Object(u.a)(t,e,"ground"),0),d=i.geometryZWithOffset(o,r);return n&&(n.verticalDistanceToGround=d,n.sampledElevation=c),d+c;case"relative-to-scene":var p=Object(s.r)(Object(u.a)(t,e,"scene"),0),v=i.geometryZWithOffset(o,r);return n&&(n.verticalDistanceToGround=v,n.sampledElevation=p),v+p;case"absolute-height":var b=i.geometryZWithOffset(o,r);if(n){var m=Object(s.r)(Object(u.a)(t,e,"ground"),0);n.verticalDistanceToGround=b-m,n.sampledElevation=m}return b;default:return Object(a.a)(i.mode),0}}function m(e,t,i,r,n){var a=b(t,i,n,r,O);Object(p.b)(e,O.verticalDistanceToGround);var s=O.sampledElevation,o=Object(l.c)(g,e.transformation);return j[0]=t.x,j[1]=t.y,j[2]=a,Object(c.d)(t.spatialReference,j,o,r.spatialReference)?e.transformation=o:console.warn("Could not locate symbol object properly, it might be misplaced"),s}(n=r||(r={}))[n.NONE=0]="NONE",n[n.UPDATE=1]="UPDATE",n[n.RECREATE=2]="RECREATE";var f={"absolute-height":{applyElevationAlignmentBuffer:function(e,t,i,r,n,a,s,o){var l=o.calculateOffsetRenderUnits(s),c=o.featureExpressionInfoContext;t*=3,r*=3;for(var d=0;d<n;++d){var h=e[t+0],u=e[t+1],p=e[t+2];i[r+0]=h,i[r+1]=u,i[r+2]=null==c?p+l:l,t+=3,r+=3}return 0},requiresAlignment:function(e){var t=e.meterUnitOffset,i=e.featureExpressionInfoContext;return 0!==t||null!=i}},"on-the-ground":{applyElevationAlignmentBuffer:function(e,t,i,r,n,a){var o=0,l=a.spatialReference;t*=3,r*=3;for(var c=0;c<n;++c){var d=e[t+0],h=e[t+1],u=e[t+2],p=Object(s.r)(a.getElevation(d,h,u,l,"ground"),0);o+=p,i[r+0]=d,i[r+1]=h,i[r+2]=p,t+=3,r+=3}return o/n},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(e,t,i,r,n,a,o,l){var c=0,d=l.calculateOffsetRenderUnits(o),h=l.featureExpressionInfoContext,u=a.spatialReference;t*=3,r*=3;for(var p=0;p<n;++p){var v=e[t+0],b=e[t+1],m=e[t+2],f=Object(s.r)(a.getElevation(v,b,m,u,"ground"),0);c+=f,i[r+0]=v,i[r+1]=b,i[r+2]=null==h?m+f+d:f+d,t+=3,r+=3}return c/n},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(e,t,i,r,n,a,o,l){var c=0,d=l.calculateOffsetRenderUnits(o),h=l.featureExpressionInfoContext,u=a.spatialReference;t*=3,r*=3;for(var p=0;p<n;++p){var v=e[t+0],b=e[t+1],m=e[t+2],f=Object(s.r)(a.getElevation(v,b,m,u,"scene"),0);c+=f,i[r+0]=v,i[r+1]=b,i[r+2]=null==h?m+f+d:f+d,t+=3,r+=3}return c/n},requiresAlignment:()=>!0}},g=Object(d.b)(),O={verticalDistanceToGround:0,sampledElevation:0},j=Object(o.e)()},615:function(e,t,i){"use strict";i.d(t,"a",(function(){return k})),i.d(t,"b",(function(){return W}));var r,n,a,s,o,l,c,d,h,u,p,v,b,m,f,g,O,j,_,y,x,S,w,C,z,P,E,L,D=i(120),A=i(119),M=i(254),R=i(358),T=i(249),V=i(308),I=i(333),q=i(280),F=i(627),U=i(490),N=i(599),G=i(551);function W(e){var t=new M.a;t.extensions.add("GL_OES_standard_derivatives"),t.include(G.a),t.include(F.a,e),t.include(N.a,e),1===e.output&&t.include(U.a,e),t.vertex.uniforms.add("proj","mat4").add("view","mat4").add("cameraNearFar","vec2").add("pixelRatio","float").add("miterLimit","float").add("screenSize","vec2"),t.attributes.add("position","vec3"),t.attributes.add("subdivisionFactor","float"),t.attributes.add("uv0","vec2"),t.attributes.add("auxpos1","vec3"),t.attributes.add("auxpos2","vec3"),t.varyings.add("vColor","vec4"),t.varyings.add("vpos","vec3"),t.varyings.add("linearDepth","float"),e.multipassTerrainEnabled&&t.varyings.add("depth","float");var i=e.falloffEnabled,W=e.innerColorEnabled;return W&&t.varyings.add("vLineDistance","float"),i&&t.varyings.add("vLineDistanceNorm","float"),e.falloffEnabled&&t.fragment.uniforms.add("falloff","float"),e.innerColorEnabled&&(t.fragment.uniforms.add("innerColor","vec4"),t.fragment.uniforms.add("innerWidth","float")),t.vertex.code.add(Object(A.a)(r||(r=Object(D.a)(["\n\t\t#define PERPENDICULAR(v) vec2(v.y, -v.x);\n\t\t#define ISOUTSIDE (left.x * right.y - left.y * right.x)*uv0.y > 0.0\n\n\t\tfloat interp(float ncp, vec4 a, vec4 b) {\n\t\t\treturn (-ncp - a.z) / (b.z - a.z);\n\t\t}\n\n\t\tvec2 rotate(vec2 v, float a) {\n\t\t\tfloat s = sin(a);\n\t\t\tfloat c = cos(a);\n\t\t\tmat2 m = mat2(c, -s, s, c);\n\t\t\treturn m * v;\n\t\t}\n"])))),t.vertex.code.add(Object(A.a)(n||(n=Object(D.a)(["\n    vec4 projectAndScale(vec4 pos) {\n      vec4 posNdc = proj * pos;\n\n      // Note that posNdc is in -1:1, scaling by screenSize converts this to a coordinate system\n      // that is twice scaled (going from -size:size).\n      posNdc.xy *= screenSize / posNdc.w;\n      return posNdc;\n    }\n"])))),t.vertex.code.add(Object(A.a)(a||(a=Object(D.a)(["\n    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {\n      float vnp = cameraNearFar[0] * 0.99;\n\n      //current pos behind ncp --\x3e we need to clip\n      if(pos.z > -cameraNearFar[0]) {\n        if (!isStartVertex) {\n          //previous in front of ncp\n          if(prev.z < -cameraNearFar[0]) {\n            pos = mix(prev, pos, interp(vnp, prev, pos));\n            next = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n        //next in front of ncp\n        if(isStartVertex) {\n          if(next.z < -cameraNearFar[0]) {\n            pos = mix(pos, next, interp(vnp, pos, next));\n            prev = pos;\n          } else {\n            pos = vec4(0.0, 0.0, 0.0, 1.0);\n          }\n        }\n      } else {\n        //current position visible\n        //previous behind ncp\n        if (prev.z > -cameraNearFar[0]) {\n          prev = mix(pos, prev, interp(vnp, pos, prev));\n        }\n        //next behind ncp\n        if (next.z > -cameraNearFar[0]) {\n          next = mix(next, pos, interp(vnp, next, pos));\n        }\n      }\n\n      ","\n      linearDepth = (-pos.z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);\n\n      pos = projectAndScale(pos);\n      next = projectAndScale(next);\n      prev = projectAndScale(prev);\n    }\n"])),e.multipassTerrainEnabled?"depth = pos.z;":"")),t.vertex.code.add(Object(A.a)(s||(s=Object(D.a)(["\n  void main(void) {\n    float coverage = 1.0;\n    vpos = position;\n\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y == 0.0) {\n      // Project out of clip space\n      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;\n      bool isJoin = abs(uv0.y)-3.0 < 0.0;\n\n      float lineWidth = getSize() * pixelRatio;\n\n      // convert sub-pixel coverage to alpha\n      if (lineWidth < 1.0) {\n        coverage = lineWidth;\n        lineWidth = 1.0;\n      }else{\n        // Ribbon lines cannot properly render non-integer sizes. Round width to integer size if\n        // larger than one for better quality. Note that we do render < 1 pixels more or less correctly\n        // so we only really care to round anything larger than 1.\n        lineWidth = floor(lineWidth + 0.5);\n      }\n\n      vec4 pos  = view * vec4(position.xyz, 1.0);\n      vec4 prev = view * vec4(auxpos1.xyz, 1.0);\n      vec4 next = view * vec4(auxpos2.xyz, 1.0);\n\n      clipAndTransform(pos, prev, next, isStartVertex);\n\n      vec2 left = (pos.xy - prev.xy);\n      vec2 right = (next.xy - pos.xy);\n\n      float leftLen = length(left);\n      float rightLen = length(right);\n  "])))),e.stippleEnabled&&t.vertex.code.add(Object(A.a)(o||(o=Object(D.a)(["\n      // uv0.x is either 0 or 1, depending on whether this is considered the start of a line segment\n      // or the end. If start, then use pos->next, otherwise use prev->pos to define the line segment\n      // vector\n      vec4 stippleSegmentInfo = mix(vec4(pos.xy, right), vec4(prev.xy, left), uv0.x);\n      vec2 stippleSegmentOrigin = stippleSegmentInfo.xy;\n\n      // Scale s.t. it's in units of stipple pattern size.\n      vec2 stippleSegmentDirection = stippleSegmentInfo.zw;\n    "])))),t.vertex.code.add(Object(A.a)(l||(l=Object(D.a)(['\n    left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);\n    right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);\n\n    vec2 capDisplacementDir = vec2(0, 0);\n    vec2 joinDisplacementDir = vec2(0, 0);\n    float displacementLen = lineWidth;\n\n    if (isJoin) {\n\n      // JOIN handling ---------------------------------------------------\n      // determine if vertex is on the "outside or "inside" of the join\n      bool isOutside = ISOUTSIDE;\n\n      // compute miter join position first\n      joinDisplacementDir = normalize(left + right);\n      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n\n      // compute miter stretch\n      if (leftLen > 0.001 && rightLen > 0.001) {\n        float nDotSeg = dot(joinDisplacementDir, left);\n        displacementLen /= length(nDotSeg * left - joinDisplacementDir);\n\n        // limit displacement of inner vertices\n        if (!isOutside) {\n          displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));\n        }\n      }\n\n      if (isOutside && (displacementLen > miterLimit * lineWidth)) {\n    '])))),e.roundJoins?t.vertex.code.add(Object(A.a)(c||(c=Object(D.a)(["\n        vec2 startDir;\n        vec2 endDir;\n\n        if (leftLen < 0.001) {\n          startDir = right;\n        }\n        else{\n          startDir = left;\n        }\n        startDir = normalize(startDir);\n        startDir = PERPENDICULAR(startDir);\n\n        if (rightLen < 0.001) {\n          endDir = left;\n        }\n        else{\n          endDir = right;\n        }\n        endDir = normalize(endDir);\n        endDir = PERPENDICULAR(endDir);\n\n        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));\n        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * subdivisionFactor * rotationAngle);\n      "])))):t.vertex.code.add(Object(A.a)(d||(d=Object(D.a)(["\n        // convert to bevel join if miterLimit is exceeded\n        if (leftLen < 0.001) {\n          joinDisplacementDir = right;\n        }\n        else if (rightLen < 0.001) {\n          joinDisplacementDir = left;\n        }\n        else {\n          joinDisplacementDir = isStartVertex ? right : left;\n        }\n        joinDisplacementDir = normalize(joinDisplacementDir);\n        joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n  "])))),t.vertex.code.add(Object(A.a)(h||(h=Object(D.a)(["\n        displacementLen = lineWidth;\n      }\n    } else {\n    // CAP handling ---------------------------------------------------\n    if (leftLen < 0.001) {\n      joinDisplacementDir = right;\n    }\n    else if (rightLen < 0.001) {\n      joinDisplacementDir = left;\n    }\n    else {\n      joinDisplacementDir = isStartVertex ? right : left;\n    }\n    joinDisplacementDir = normalize(joinDisplacementDir);\n    joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);\n    displacementLen = lineWidth;\n\n    capDisplacementDir = isStartVertex ? -right : left;\n  "])))),e.roundCaps?t.vertex.code.add(Object(A.a)(u||(u=Object(D.a)(["\n    float angle = subdivisionFactor*PI*0.5;\n    joinDisplacementDir *= cos(angle);\n    capDisplacementDir *= sin(angle);\n    "])))):t.vertex.code.add(Object(A.a)(p||(p=Object(D.a)(["\n    capDisplacementDir *= subdivisionFactor;\n    "])))),t.vertex.code.add(Object(A.a)(v||(v=Object(D.a)(["\n  }\n\n  // Displacement (in pixels) caused by join/or cap\n  vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;\n\n  ","\n\n  ","\n  ","\n\n  pos.xy += dpos;\n  "])),i||W?Object(A.a)(b||(b=Object(D.a)(["float lineDist = lineWidth * sign(uv0.y) * pos.w;"]))):"",W?Object(A.a)(m||(m=Object(D.a)(["vLineDistance = lineDist;"]))):"",i?Object(A.a)(f||(f=Object(D.a)(["vLineDistanceNorm = lineDist / lineWidth;"]))):"")),e.stippleEnabled&&(t.vertex.code.add(Object(A.a)(g||(g=Object(D.a)(["\n    {\n      // Compute the stipple pattern UV coordinate from the actual position, based on the origin\n      // and direction of the line segment on which the stipple pattern is based.\n\n      // Project the vector from the origin of the segment to the vertex onto the line segment.\n      // Note the 0.5 factor due to projected positions being at twice the screen size scale (see projectAndScale)\n      vec2 posVec = pos.xy - stippleSegmentOrigin;\n\n      float stippleSegmentDirectionLength = length(stippleSegmentDirection);\n    "])))),e.stippleIntegerRepeatsEnabled&&t.vertex.code.add(Object(A.a)(O||(O=Object(D.a)(["\n      float numberOfPatternRepeats = stippleSegmentDirectionLength * 0.5 * stipplePatternPixelSizeInv;\n      float roundedNumberOfPatternRepeats = floor(numberOfPatternRepeats);\n      stipplePatternUvMax = roundedNumberOfPatternRepeats;\n      "])))),t.vertex.code.add(Object(A.a)(j||(j=Object(D.a)(["\n      if (stippleSegmentDirectionLength >= 0.001) {\n        // Project the vertex position onto the line segment.\n        float projectedLength = dot(stippleSegmentDirection, posVec) / stippleSegmentDirectionLength * 0.5;\n     ","\n        stipplePatternUv = projectedLength * wholeNumberOfRepeatsScale * stipplePatternPixelSizeInv * pos.w;\n        } else {\n          stipplePatternUv = 1.0;\n        }\n      }\n    "])),e.stippleIntegerRepeatsEnabled?"float wholeNumberOfRepeatsScale = roundedNumberOfPatternRepeats / numberOfPatternRepeats;":"float wholeNumberOfRepeatsScale = 1.0;"))),t.vertex.code.add(Object(A.a)(_||(_=Object(D.a)(["\n      // Convert back into NDC\n      pos.xy = pos.xy / screenSize * pos.w;\n\n      vColor = getColor();\n      vColor.a *= coverage;\n\n      gl_Position = pos;\n    }\n  }\n  "])))),e.multipassTerrainEnabled&&(t.fragment.include(V.a),t.include(q.b,e)),t.include(T.a,e),t.fragment.uniforms.add("intrinsicColor","vec4"),t.fragment.include(R.a),t.fragment.code.add(Object(A.a)(y||(y=Object(D.a)(["\n  void main() {\n    discardBySlice(vpos);\n    ","\n    float stippleAlpha = getStippleAlpha();\n    discardByStippleAlpha(stippleAlpha, stippleAlphaColorDiscard);\n\n    vec4 color = intrinsicColor * vColor;\n  "])),e.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":"")),e.innerColorEnabled&&(t.fragment.uniforms.add("pixelRatio","float"),t.fragment.code.add(Object(A.a)(x||(x=Object(D.a)(["\n    float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;\n    float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);\n    float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);\n    color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);\n    "]))))),t.fragment.code.add(Object(A.a)(S||(S=Object(D.a)(["\n    vec4 finalColor = blendStipple(color, stippleAlpha);\n  "])))),e.falloffEnabled&&t.fragment.code.add(Object(A.a)(w||(w=Object(D.a)(["\n    finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);\n    "])))),t.fragment.code.add(Object(A.a)(C||(C=Object(D.a)(["\n    if (finalColor.a < ",") {\n      discard;\n    }\n\n    ","\n    ","\n    ","\n    ","\n    ","\n  }\n  "])),A.a.float(I.c),7===e.output?Object(A.a)(z||(z=Object(D.a)(["gl_FragColor = vec4(finalColor.a);"]))):"",0===e.output?Object(A.a)(P||(P=Object(D.a)(["gl_FragColor = highlightSlice(finalColor, vpos);"]))):"",0===e.output&&e.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":"",4===e.output?Object(A.a)(E||(E=Object(D.a)(["gl_FragColor = vec4(1.0);"]))):"",1===e.output?Object(A.a)(L||(L=Object(D.a)(["outputDepth(linearDepth);"]))):"")),t}var k=Object.freeze({__proto__:null,build:W})},617:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var r={DIFFUSE:0,NORMAL:1,EMISSION:2,OCCLUSION:3,METALLIC_ROUGHNESS:4,SSAO:6,SHADOW_MAP:7}},627:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r,n,a,s,o,l,c=i(120),d=i(119);function h(e,t){e.vertex.uniforms.add("intrinsicWidth","float"),t.vvSize?(e.attributes.add("sizeFeatureAttribute","float"),e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.code.add(Object(d.a)(r||(r=Object(c.a)(["\n    float getSize() {\n      return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;\n    }\n    "]))))):(e.attributes.add("size","float"),e.vertex.code.add(Object(d.a)(n||(n=Object(c.a)(["\n    float getSize(){\n      return intrinsicWidth * size;\n    }\n    "]))))),t.vvOpacity?(e.attributes.add("opacityFeatureAttribute","float"),e.vertex.constants.add("vvOpacityNumber","int",8),e.vertex.code.add(Object(d.a)(a||(a=Object(c.a)(["\n    uniform float vvOpacityValues[vvOpacityNumber];\n    uniform float vvOpacityOpacities[vvOpacityNumber];\n\n    float interpolateOpacity( float value ){\n      if (value <= vvOpacityValues[0]) {\n        return vvOpacityOpacities[0];\n      }\n\n      for (int i = 1; i < vvOpacityNumber; ++i) {\n        if (vvOpacityValues[i] >= value) {\n          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);\n        }\n      }\n\n      return vvOpacityOpacities[vvOpacityNumber - 1];\n    }\n\n    vec4 applyOpacity( vec4 color ){\n      return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));\n    }\n    "]))))):e.vertex.code.add(Object(d.a)(s||(s=Object(c.a)(["\n    vec4 applyOpacity( vec4 color ){\n      return color;\n    }\n    "])))),t.vvColor?(e.attributes.add("colorFeatureAttribute","float"),e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(d.a)(o||(o=Object(c.a)(["\n    uniform float vvColorValues[vvColorNumber];\n    uniform vec4 vvColorColors[vvColorNumber];\n\n    vec4 interpolateColor( float value ) {\n      if (value <= vvColorValues[0]) {\n        return vvColorColors[0];\n      }\n\n      for (int i = 1; i < vvColorNumber; ++i) {\n        if (vvColorValues[i] >= value) {\n          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return mix(vvColorColors[i-1], vvColorColors[i], f);\n        }\n      }\n\n      return vvColorColors[vvColorNumber - 1];\n    }\n\n    vec4 getColor(){\n      return applyOpacity(interpolateColor(colorFeatureAttribute));\n    }\n    "]))))):(e.attributes.add("color","vec4"),e.vertex.code.add(Object(d.a)(l||(l=Object(c.a)(["\n    vec4 getColor(){\n      return applyOpacity(color);\n    }\n    "])))))}},690:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(89),n=i(104),a=i(111),s=i(115),o=i(157),l=i(174),c=i(191),d=i(373),h=i(177),u=i(463),p=i(370),v=i(471),b=i(560),m=i(468);class f extends m.a{constructor(e){super(e),this._handles=new s.a,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=Object(n.e)(),this._up=Object(n.e)(),this._right=Object(n.e)(),this._renderOccluded=4,this._color=Object(d.c)(1,0,0,1),this._outlineColor=Object(d.c)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=16,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){Object(c.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){Object(c.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){var t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:i}){this._maxSize=Math.min(Object(a.n)(t,e),Object(a.n)(t,i))/3,Object(a.q)(this._up,Object(a.i)(this._up,e,t)),Object(a.q)(this._right,Object(a.i)(this._right,i,t)),Object(a.j)(this._position,t),this.recreateGeometry()}createExternalResources(){this._quadMaterial=new b.a(this.quadMaterialParameters),this._outlineMaterial=new v.a(this.outlineMaterialParameters),this._handles.add(this.view.state.watch("camera",(()=>this._updateTransform())))}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll()}forEachExternalMaterial(e){e(this._quadMaterial),e(this._outlineMaterial)}createGeometries(e){this._createQuadGeometry(e),this._createOutlineGeometry(e),this._updateTransform(e)}_createQuadGeometry(e){var t=this._quadGeometryData(this._up,this._right);e.addGeometry(t,this._quadMaterial)}_createOutlineGeometry(e){if(0!==this._outlineSize){var t=Object(a.e)(h.d.get(),this._up,this._right),i=p.a.createPolylineGeometry([this._up,t,this._right]);e.addGeometry(i,this._outlineMaterial)}}_updateTransform(e=this.object){var t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),n=Math.min(this._maxSize,i);Object(o.i)(g),Object(o.s)(g,g,this._position),Object(o.r)(g,g,[n,n,n]),Object(r.k)(e)&&(e.transformation=g)}_quadGeometryData(e,t){var i=Object(a.e)(h.d.get(),e,t);return new u.a([["position",{size:3,data:[0,0,0,...t,...e,...i],exclusive:!0}]],[["position",new Uint16Array([0,1,2,1,2,3])]])}get quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameterValues(this.quadMaterialParameters)}get outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameterValues(this.outlineMaterialParameters)}}var g=Object(l.b)()},978:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var r=i(104),n=i(111),a=i(330),s=i(173),o=i(223),l=i(177);class c{constructor(e=Object(r.e)(),t=Object(r.e)()){this.startRenderSpace=e,this.endRenderSpace=t,this.type="euclidean"}eval(e,t,i){return Object(n.h)(t,this.startRenderSpace,this.endRenderSpace,e),i&&(Object(n.i)(i,this.endRenderSpace,this.startRenderSpace),Object(n.q)(i,i)),t}createRenderGeometry(e,t){var i=[],r=[],a=(t,a)=>{var s=u;Object(n.i)(s,t,e),i.push([s[0],s[1],s[2]]),r.push([a[0],a[1],a[2]])},s=t.worldUpAtPosition(this.eval(.5,h),l.d.get());return a(this.startRenderSpace,s),a(this.endRenderSpace,s),{points:i,normals:r}}}class d{constructor(e,t,i){this.startRenderSpace=e,this.endRenderSpace=t,this.renderSpatialReference=i,this.type="geodesic",this._start=Object(r.e)(),this._end=Object(r.e)(),this._pcpf=Object(s.g)(i),this._project=Object(o.b)(i,this._pcpf),this._projectIn(e,this._start),this._projectIn(t,this._end)}_projectIn(e,t){this._project?Object(o.r)(e,this.renderSpatialReference,t,this._pcpf):Object(n.j)(t,e)}eval(e,t,i){if(this._project)if(i){var r=u;Object(a.i)(this._start,this._end,e,t,r),Object(n.e)(p,t,r),Object(o.r)(t,this._pcpf,t,this.renderSpatialReference),Object(o.r)(p,this._pcpf,p,this.renderSpatialReference),Object(n.i)(i,p,t),Object(n.q)(i,i)}else Object(a.h)(this._start,this._end,e,t),Object(o.r)(t,this._pcpf,t,this.renderSpatialReference);else Object(n.h)(t,this._start,this._end,e),i&&(Object(n.i)(i,this._end,this._start),Object(n.q)(i,i));return t}createRenderGeometry(e,t){for(var i=[],r=[],a=(t,a)=>{var s=p;Object(n.i)(s,t,e),i.push([s[0],s[1],s[2]]),r.push([a[0],a[1],a[2]])},s=0;s<128;++s){var o=s/127,l=h,c=u;this.eval(o,l),t.worldUpAtPosition(l,c),a(l,c)}return{points:i,normals:r}}}var h=Object(r.e)(),u=Object(r.e)(),p=Object(r.e)()},979:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return l})),i.d(t,"e",(function(){return a})),i.d(t,"f",(function(){return s}));var r=i(488);function n(e,t,i,n=2,a="abbr"){return Object(r.b)(e,t.toUnit(i).value,i,n,a)}function a(e,t,i=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(r.h)(e,t.value,t.unit,i,n)}function s(e,t,i=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(r.i)(e,t.value,t.unit,i,n)}function o(e,t,i=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(r.e)(e,t.value,t.unit,i,n)}function l(e,t,i=2,n="abbr"){if("length"!==t.measure)throw new Error("quantity is not a length");return Object(r.f)(e,t.value,t.unit,i,n)}function c(e){if("angle"!==e.measure)throw new Error("quantity is not an angle");return Object(r.a)(e.value,e.unit)}}}]);
//# sourceMappingURL=104.5f07d390.chunk.js.map