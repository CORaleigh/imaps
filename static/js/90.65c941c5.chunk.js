(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[90,183],{1094:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(81),s=i(158),n=i(83),a=(i(79),i(84),i(80),i(82));let o=class extends s.a{initialize(){}destroy(){}get supportsTileUpdates(){return!1}get spatialReference(){const e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}};Object(r.a)([Object(n.b)({readOnly:!0})],o.prototype,"supportsTileUpdates",null),Object(r.a)([Object(n.b)({constructOnly:!0})],o.prototype,"remoteClient",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],o.prototype,"service",void 0),Object(r.a)([Object(n.b)()],o.prototype,"spatialReference",null),Object(r.a)([Object(n.b)({constructOnly:!0})],o.prototype,"tileInfo",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],o.prototype,"tileStore",void 0),o=Object(r.a)([Object(a.a)("esri.views.2d.layers.features.processors.BaseProcessor")],o);var l=o},115:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i(81),s=i(89),n=i(86),a=i(83),o=(i(79),i(84),i(80),i(82)),l=i(295);const c=new s.a({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});let u=class extends n.a{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const t=new Set;return await this.collectRequiredFields(t,e),Array.from(t).sort()}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};Object(r.a)([Object(a.b)({type:l.a,json:{write:!0}})],u.prototype,"authoringInfo",void 0),Object(r.a)([Object(a.b)({type:c.apiValues,readOnly:!0,json:{type:c.jsonValues,read:!1,write:{writer:c.write,ignoreOrigin:!0}}})],u.prototype,"type",void 0),u=Object(r.a)([Object(o.a)("esri.renderers.Renderer")],u);var h=u},122:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r,s=i(81),n=i(97),a=i(170),o=i(103),l=i(86),c=i(87),u=i(85),h=i(253),p=i(83),d=(i(84),i(79),i(80),i(82)),f=i(95);let y=r=class extends l.a{constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:Object(h.a)(),configurable:!0})}normalizeCtorArgs(e,t,i,r){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:i,popupTemplate:r}}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;for(const t of[this.sourceLayer,this.layer])if(t){if("popupTemplate"in t&&t.popupTemplate)return t.popupTemplate;if(e&&"defaultPopupTemplate"in t&&Object(u.k)(t.defaultPopupTemplate))return t.defaultPopupTemplate}return null}getAttribute(e){return this.attributes&&this.attributes[e]}setAttribute(e,t){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",i,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:Object(u.k)(this.geometry)?this.geometry.toJSON():null,symbol:Object(u.k)(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new r(this.cloneProperties())}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}cloneProperties(){return{attributes:Object(c.a)(this.attributes),geometry:Object(c.a)(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:Object(c.a)(this.symbol),visible:this.visible}}_notifyLayer(e,t,i,r){if(!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:t,newValue:i};"attributes"===e&&(s.attributeName=r),this.layer.graphicChanged(s)}};Object(s.a)([Object(p.b)({value:null})],y.prototype,"attributes",null),Object(s.a)([Object(p.b)({value:null,types:n.a,json:{read:f.a}})],y.prototype,"geometry",null),Object(s.a)([Object(p.b)({type:Boolean})],y.prototype,"isAggregate",void 0),Object(s.a)([Object(p.b)()],y.prototype,"layer",void 0),Object(s.a)([Object(p.b)({type:a.a})],y.prototype,"popupTemplate",void 0),Object(s.a)([Object(p.b)()],y.prototype,"sourceLayer",void 0),Object(s.a)([Object(p.b)({value:null,types:o.e})],y.prototype,"symbol",null),Object(s.a)([Object(p.b)({type:Boolean,value:!0})],y.prototype,"visible",null),y=r=Object(s.a)([Object(d.a)("esri.Graphic")],y),(y||(y={})).generateUID=h.a;var b=y},1250:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return _}));var r=i(81),s=(i(88),i(79)),n=i(80),a=i(85),o=i(91),l=(i(83),i(84),i(82)),c=i(254),u=i(94),h=i(610),p=i(611),d=i(488),f=i(389),y=i(604),b=i(461),m=i(1094),x=i(390);function g(e,t){return(!e.minScale||e.minScale>=t)&&(!e.maxScale||e.maxScale<=t)}function v(e){const t=e.message,i={message:{data:{},tileKey:t.tileKey,tileKeyOrigin:t.tileKeyOrigin},transferList:new Array};for(const r in t.data){const e=t.data[r];if(i.message.data[r]=null,Object(a.k)(e)){const t=e.stride,s=e.indices.slice(0),n=e.vertices.slice(0),o=e.records.slice(0),l={stride:t,indices:s,vertices:n,records:o,metrics:Object(a.b)(e.metrics,(e=>e.slice(0)))};i.transferList.push(s,n,o),i.message.data[r]=l}}return i}n.a.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");let O=class extends m.a{constructor(){super(...arguments),this.type="symbol",this._matchers={feature:null,aggregate:null},this._bufferData=new Map,this._bufferIds=new Map}initialize(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}destroy(){}get supportsTileUpdates(){return!0}forEachBufferId(e){this._bufferIds.forEach((t=>{t.forEach(e)}))}async update(e,t){const i=t.schema.processors[0];if("symbol"!==i.type)return;const r=Object(c.a)(this._schema,i);Object(c.b)(r,"mesh")&&(Object(s.a)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",r),e.mesh=!0,e.why.mesh.push("Symbology changed"),this._schema=i,this._factory=this._createFactory(i),this._factory.update(i,this.tileStore.tileScheme.tileInfo))}onTileMessage(e,t,i,r){return Object(o.v)(r),this._onTileData(e,t,i,r)}onTileClear(e){return this._bufferData.delete(e.key.id),this._bufferIds.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{clear:!0}})}onTileError(e,t,i){const r=i.signal,s={tileKey:e.id,error:t};return this.remoteClient.invoke("tileRenderer.onTileError",s,{signal:r})}onTileUpdate(e){for(const t of e.removed)this._bufferData.has(t.key.id)&&this._bufferData.delete(t.key.id),this._bufferIds.has(t.key.id)&&this._bufferIds.delete(t.key.id);for(const t of e.added)this._bufferData.forEach((e=>{for(const i of e)i.message.tileKey===t.id&&this._updateTileMesh("append",t,v(i),[],!1,!1,null)}))}_addBufferData(e,t){this._bufferData.has(e)||this._bufferData.set(e,[]),this._bufferData.get(e).push(v(t))}_createFactory(e){const{geometryType:t,objectIdField:i,fields:r}=this.service,s={geometryType:t,fields:r,spatialReference:u.a.fromJSON(this.spatialReference)},n=new d.a(((e,t)=>this.remoteClient.invoke("tileRenderer.getMaterialItems",e,t)),this.tileStore.tileScheme.tileInfo),{matcher:o,aggregateMatcher:l}=e.mesh;return this._store=n,this._matchers.feature=Object(y.a)(o,n,s),this._matchers.aggregate=Object(a.b)(l,(e=>Object(y.a)(e,n,s))),new p.a(t,i,n)}async _onTileData(e,t,i,r){Object(o.v)(r);const{type:s,addOrUpdate:n,remove:l}=t,c=t.end,u=!!this._schema.mesh.sortKey;if(!n){const t={type:s,addOrUpdate:null,remove:l,clear:!1,end:c,sort:u};return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:t},r)}const h=this._processFeatures(e,n,i,r);try{const i=await h;if(Object(a.j)(i)){const t={type:s,addOrUpdate:null,remove:l,clear:!1,end:c,sort:u};return this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:t},r)}const n=[];for(const t of i){let i=!1;const r=t.message.bufferIds,s=e.key.id,o=t.message.tileKey;if(s!==o&&Object(a.k)(r)){if(!this.tileStore.get(o))continue;let e=this._bufferIds.get(o);e||(e=new Set,this._bufferIds.set(o,e));const t=Array.from(r);for(const r of t){if(e.has(r)){i=!0;break}e.add(r)}}i||(this._addBufferData(s,t),n.push(t))}await Object(o.b)(n.map((i=>{const n=e.key.id===i.message.tileKey,a=n?t.remove:[],o=n&&t.end;return this._updateTileMesh(s,e,i,a,o,t.clear,r.signal)})))}catch(p){this._handleError(e,p,r)}}async _updateTileMesh(e,t,i,r,s,n,l){const c=e,u=i.message.tileKey,h=!!this._schema.mesh.sortKey;u!==t.key.id&&(s=!1);const p=Object(a.b)(i,(e=>e.message)),d=Object(a.b)(i,(e=>e.transferList))||[],f={type:c,addOrUpdate:p,remove:r,clear:!1,end:s,sort:h},y={transferList:Object(a.s)(d)||[],signal:l};return Object(o.v)(y),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:u,data:f},y)}async _processFeatures(e,t,i,r){if(Object(a.j)(t)||!t.hasFeatures)return null;const s={transform:e.transform,hasZ:!1,hasM:!1},n=this._factory,l={viewingMode:"",scale:e.scale},c=await this._matchers.feature,u=await this._matchers.aggregate;Object(o.v)(r);const h=this._getLabelInfos(e,t);return await n.analyze(t.getCursor(),c,u,s,l),Object(o.v)(r),this._writeFeatureSet(e,t,s,h,n,i)}_writeFeatureSet(e,t,i,r,s,n){const o=t.getSize(),l="simple"===this._schema.mesh.matcher.type&&this._schema.mesh.matcher.isDotDensity,c=new h.a(e.key.id,{features:o,records:o,metrics:0},l,n,!0),u={viewingMode:"",scale:e.scale},p=t.getCursor();for(;p.next();)try{const t=p.getDisplayId(),n=Object(a.k)(r)?r.get(t):null;s.writeCursor(c,p,i,u,e.level,n)}catch(f){}const d=e.tileInfoView.tileInfo.isWrappable;return c.serialize(d)}_handleError(e,t,i){if(!Object(o.m)(t)){const r={tileKey:e.id,error:t.message};return this.remoteClient.invoke("tileRenderer.onTileError",r,{signal:i.signal})}}_getLabelingSchemaForScale(e){const t=this._schema.mesh.labels;if(Object(a.j)(t))return null;if("subtype"===t.type){const i={type:"subtype",classes:{}};let r=!1;for(const s in t.classes){const n=t.classes[s].filter((t=>g(t,e.scale)));r=r||!!n.length,i.classes[s]=n}return r?i:null}const i=t.classes.filter((t=>g(t,e.scale)));return i.length?{type:"simple",classes:i}:null}_getLabels(e,t){if("subtype"===t.type){var i;const r=this.service.subtypeField,s=Object(a.u)(r,"Expected to find subtype Field"),n=e.readAttribute(s);return null==n?[]:null!=(i=t.classes[n])?i:[]}return t.classes}_getLabelInfos(e,t){const i=this._getLabelingSchemaForScale(e);if(Object(a.j)(i))return null;const r=new Map,s=t.getCursor();for(;s.next();){const e=s.getDisplayId(),t=[],n=Object(x.c)(e),a=n&&1!==s.readAttribute("cluster_count")?"aggregate":"feature",o=this._getLabels(s,i);for(const i of o){if(i.target!==a)continue;const r=s.getStorage(),o=n&&"feature"===a?r.getComputedStringAtIndex(s.readAttribute("referenceId"),i.fieldIndex):r.getComputedStringAtIndex(e,i.fieldIndex);if(!o)continue;const l=Object(f.a)(o.toString()),c=l[0],u=l[1];this._store.getMosaicItem(i.symbol,Object(b.a)(c)).then((e=>{t[i.index]={glyphs:e.glyphMosaicItems,rtl:u,index:i.index}}))}r.set(e,t)}return r}};O=Object(r.a)([Object(l.a)("esri.views.2d.layers.features.processors.SymbolProcessor")],O);var _=O},127:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return l}));var r=i(103),s=i(88),n=i(374),a=i(191),o=i(278);function l(e,t,i,r){const l=function(e,t,i){if(!e)return null;if(i&&"web-scene"===i.origin&&!(e instanceof n.a)&&!(e instanceof a.a)){const r="cim"!==e.type?Object(o.a)(e):{symbol:null,error:new s.a("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:e})};return r.symbol?r.symbol.write(t,i):(i.messages&&i.messages.push(new s.a("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:i,error:r.error})),null)}return i&&"web-map"===i.origin&&"web-style"===e.type?(i.messages&&i.messages.push(new s.a("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:e,context:i})),null):e.write(t,i)}(e,{},r);l&&(t[i]=l)}function c(e,t){return Object(r.d)(e,null,t)}},128:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(81),s=i(89),n=i(86),a=i(80),o=i(83),l=(i(79),i(102)),c=i(82),u=i(84),h=i(221);const p=a.a.getLogger("esri.renderers.visualVariables.VisualVariable"),d=new s.a({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let f=class extends n.a{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return null==e?e:"function"==typeof e?(p.error(".field: field must be a string value"),null):Object(u.l)(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};Object(r.a)([Object(o.b)()],f.prototype,"index",void 0),Object(r.a)([Object(o.b)({type:d.apiValues,readOnly:!0,json:{read:d.read,write:d.write}})],f.prototype,"type",void 0),Object(r.a)([Object(o.b)({type:String,json:{write:!0}})],f.prototype,"field",void 0),Object(r.a)([Object(l.a)("field")],f.prototype,"castField",null),Object(r.a)([Object(o.b)({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0),Object(r.a)([Object(o.b)({type:String,json:{write:!0}})],f.prototype,"valueExpressionTitle",void 0),Object(r.a)([Object(o.b)({readOnly:!0})],f.prototype,"arcadeRequired",null),Object(r.a)([Object(o.b)({type:h.a,json:{write:!0}})],f.prototype,"legendOptions",void 0),f=Object(r.a)([Object(c.a)("esri.renderers.visualVariables.VisualVariable")],f);var y=f},132:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var r,s=i(81),n=i(83),a=(i(79),i(84)),o=i(80),l=i(92),c=i(82),u=i(90),h=i(107),p=i(128),d=i(283);let f=r=class extends p.a{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new r({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};Object(s.a)([Object(n.b)({readOnly:!0})],f.prototype,"cache",null),Object(s.a)([Object(n.b)({type:["color"],json:{type:["colorInfo"]}})],f.prototype,"type",void 0),Object(s.a)([Object(n.b)({type:String,json:{write:!0}})],f.prototype,"normalizationField",void 0),Object(s.a)([Object(n.b)({type:[d.a],json:{write:!0}})],f.prototype,"stops",null),f=r=Object(s.a)([Object(c.a)("esri.renderers.visualVariables.ColorVariable")],f);var y,b=f,m=i(86),x=i(240);let g=y=class extends m.a{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return Object(x.b)(t.transparency)}writeOpacity(e,t,i){t[i]=Object(x.a)(e)}clone(){return new y({label:this.label,opacity:this.opacity,value:this.value})}};Object(s.a)([Object(n.b)({type:String,json:{write:!0}})],g.prototype,"label",void 0),Object(s.a)([Object(n.b)({type:Number,json:{type:a.a,write:{target:"transparency"}}})],g.prototype,"opacity",void 0),Object(s.a)([Object(l.a)("opacity",["transparency"])],g.prototype,"readOpacity",null),Object(s.a)([Object(u.a)("opacity")],g.prototype,"writeOpacity",null),Object(s.a)([Object(n.b)({type:Number,json:{write:!0}})],g.prototype,"value",void 0),g=y=Object(s.a)([Object(c.a)("esri.renderers.visualVariables.support.OpacityStop")],g);var v,O=g;let _=v=class extends p.a{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new v({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};Object(s.a)([Object(n.b)({readOnly:!0})],_.prototype,"cache",null),Object(s.a)([Object(n.b)({type:["opacity"],json:{type:["transparencyInfo"]}})],_.prototype,"type",void 0),Object(s.a)([Object(n.b)({type:String,json:{write:!0}})],_.prototype,"normalizationField",void 0),Object(s.a)([Object(n.b)({type:[O],json:{write:!0}})],_.prototype,"stops",null),_=v=Object(s.a)([Object(c.a)("esri.renderers.visualVariables.OpacityVariable")],_);var j=_,w=i(214),S=i(178),M=i(96),V=i(89),I=i(154);const T=o.a.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),z={color:b,size:S.a,opacity:j,rotation:w.a},k=new V.a({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),C=/^\[([^\]]+)\]$/i;let P=class extends M.a{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),(e=e&&e.filter((e=>!!e)))&&e.length){for(const t of e)switch(t.type){case"color":this.colorVariables.push(t);break;case"opacity":this.opacityVariables.push(t);break;case"rotation":this.rotationVariables.push(t);break;case"size":this.sizeVariables.push(t)}this.sizeVariables.length&&this.sizeVariables.some((e=>!!e.target))&&e.sort(((e,t)=>{let i=null;return i=e.target===t.target?0:e.target?1:-1,i}));for(let t=0;t<e.length;t++)e[t].index=t;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,t,i){const{rotationExpression:r,rotationType:s}=t,n=r&&r.match(C),a=n&&n[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:s,field:a})),e)return e.map((e=>{const t=k.read(e.type),r=z[t];r||(T.warn(`Unknown variable type: ${t}`),i&&i.messages&&i.messages.push(new I.a("visual-variable:unsupported",`visualVariable of type '${t}' is not supported`,{definition:e,context:i})));const s=new r;return s.read(e,i),s}))}writeVariables(e,t){const i=[];for(const r of e){const e=r.toJSON(t);e&&i.push(e)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};Object(s.a)([Object(n.b)()],P.prototype,"visualVariables",null),P=Object(s.a)([Object(c.a)("esri.renderers.visualVariables.VisualVariableFactory")],P);var L=P;const E={base:p.a,key:"type",typeMap:{opacity:j,color:b,rotation:w.a,size:S.a}},F=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new L}set visualVariables(e){this._vvFactory.visualVariables=e,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(e,t,i){return this._vvFactory.readVariables(e,t,i)}writeVisualVariables(e,t,i,r){t[i]=this._vvFactory.writeVariables(e,r)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const e of this.visualVariables)if(e.arcadeRequired)return!0;return!1}hasVisualVariables(e,t){return e?this.getVisualVariablesForType(e,t).length>0:this.getVisualVariablesForType("size",t).length>0||this.getVisualVariablesForType("color",t).length>0||this.getVisualVariablesForType("opacity",t).length>0||this.getVisualVariablesForType("rotation",t).length>0}getVisualVariablesForType(e,t){const i=this.visualVariables;return i?i.filter((i=>i.type===e&&("string"==typeof t?i.target===t:!1!==t||!i.target))):[]}async collectVVRequiredFields(e,t){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const r of i)r&&(r.field&&Object(h.f)(e,t,r.field),r.normalizationField&&Object(h.f)(e,t,r.normalizationField),r.valueExpression&&await Object(h.c)(e,t,r.valueExpression))}};return Object(s.a)([Object(n.b)({types:[E],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),Object(s.a)([Object(l.a)("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),Object(s.a)([Object(u.a)("visualVariables")],t.prototype,"writeVisualVariables",null),t=Object(s.a)([Object(c.a)("esri.renderers.mixins.VisualVariablesMixin")],t),t}},136:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return p})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return f})),i.d(t,"e",(function(){return T})),i.d(t,"f",(function(){return g})),i.d(t,"g",(function(){return O})),i.d(t,"h",(function(){return v})),i.d(t,"i",(function(){return a})),i.d(t,"j",(function(){return y})),i.d(t,"k",(function(){return M})),i.d(t,"l",(function(){return b})),i.d(t,"m",(function(){return _})),i.d(t,"n",(function(){return x})),i.d(t,"o",(function(){return j})),i.d(t,"p",(function(){return V})),i.d(t,"q",(function(){return m})),i.d(t,"r",(function(){return S})),i.d(t,"s",(function(){return n})),i.d(t,"t",(function(){return w})),i.d(t,"u",(function(){return d})),i.d(t,"v",(function(){return u})),i.d(t,"w",(function(){return h}));var r=i(195);function s(e,t){return e[0]=t[0],e[1]=t[1],e}function n(e,t,i){return e[0]=t,e[1]=i,e}function a(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e}function o(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function l(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e}function c(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e}function u(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e}function h(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e}function p(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e}function d(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e}function f(e,t){const i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)}function y(e,t){const i=t[0]-e[0],r=t[1]-e[1];return i*i+r*r}function b(e){const t=e[0],i=e[1];return Math.sqrt(t*t+i*i)}function m(e){const t=e[0],i=e[1];return t*t+i*i}function x(e,t){return e[0]=-t[0],e[1]=-t[1],e}function g(e,t){const i=t[0],r=t[1];let s=i*i+r*r;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s),e}function v(e,t){return e[0]*t[0]+e[1]*t[1]}function O(e,t,i){const r=t[0]*i[1]-t[1]*i[0];return e[0]=e[1]=0,e[2]=r,e}function _(e,t,i,r){const s=t[0],n=t[1];return e[0]=s+r*(i[0]-s),e[1]=n+r*(i[1]-n),e}function j(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[2]*s,e[1]=i[1]*r+i[3]*s,e}function w(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[2]*s+i[4],e[1]=i[1]*r+i[3]*s+i[5],e}function S(e,t,i,r){const s=t[0]-i[0],n=t[1]-i[1],a=Math.sin(r),o=Math.cos(r);return e[0]=s*o-n*a+i[0],e[1]=s*a+n*o+i[1],e}function M(e,t){return e[0]===t[0]&&e[1]===t[1]}function V(e,t,i,r,s){let n=t[0]-i[0],a=t[1]-i[1];const o=(r[0]*n+r[1]*a)*(s-1);return n=r[0]*o,a=r[1]*o,e[0]=t[0]+n,e[1]=t[1]+a,e}const I=b,T=o,z=l,k=c,C=f,P=y,L=m;Object.freeze({__proto__:null,copy:s,set:n,add:a,subtract:o,multiply:l,divide:c,ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},min:u,max:h,round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},scale:p,scaleAndAdd:d,distance:f,squaredDistance:y,length:b,squaredLength:m,negate:x,inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},normalize:g,dot:v,cross:O,lerp:_,random:function(e,t){t=t||1;const i=2*Object(r.b)()*Math.PI;return e[0]=Math.cos(i)*t,e[1]=Math.sin(i)*t,e},transformMat2:j,transformMat2d:w,transformMat3:function(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[3]*s+i[6],e[1]=i[1]*r+i[4]*s+i[7],e},transformMat4:function(e,t,i){const r=t[0],s=t[1];return e[0]=i[0]*r+i[4]*s+i[12],e[1]=i[1]*r+i[5]*s+i[13],e},rotate:S,angle:function(e,t){const i=e[0],r=e[1],s=t[0],n=t[1];let a=i*i+r*r;a>0&&(a=1/Math.sqrt(a));let o=s*s+n*n;o>0&&(o=1/Math.sqrt(o));const l=(i*s+r*n)*a*o;return l>1?0:l<-1?Math.PI:Math.acos(l)},str:function(e){return"vec2("+e[0]+", "+e[1]+")"},exactEquals:M,equals:function(e,t){const i=e[0],s=e[1],n=t[0],a=t[1];return Math.abs(i-n)<=r.a*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(s-a)<=r.a*Math.max(1,Math.abs(s),Math.abs(a))},projectAndScale:V,len:I,sub:T,mul:z,div:k,dist:C,sqrDist:P,sqrLen:L})},144:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(81),s=i(82);let n=0;const a=e=>{let t=class extends e{constructor(...e){super(...e),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+n++})}};return t=Object(r.a)([Object(s.a)("esri.core.Identifiable")],t),t};let o=class extends(a(class{})){};o=Object(r.a)([Object(s.a)("esri.core.Identifiable")],o)},161:function(e,t,i){"use strict";i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return x})),i.d(t,"c",(function(){return b})),i.d(t,"d",(function(){return y})),i.d(t,"e",(function(){return c})),i.d(t,"f",(function(){return m})),i.d(t,"g",(function(){return o})),i.d(t,"h",(function(){return l}));var r=i(88),s=i(130),n=i(672);function a(e,t=!1){const i=s.e.SIZE_FIELD_STOPS|s.e.SIZE_MINMAX_VALUE|s.e.SIZE_SCALE_STOPS|s.e.SIZE_UNIT_VALUE,r=(e&(s.f.FIELD_TARGETS_OUTLINE|s.f.MINMAX_TARGETS_OUTLINE|s.f.SCALE_TARGETS_OUTLINE|s.f.UNIT_TARGETS_OUTLINE))>>>4;return t?i&r:i&~r}function o(e,t,i,r,n){switch(e){case s.d.FILL:return f.from(t,r);case s.d.LINE:return b.from(t,i);case s.d.MARKER:return y.from(t);case s.d.TEXT:return m.from(t);case s.d.LABEL:return x.from(t,n);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${e}`)}}function l(e){switch(c.load(e).geometryType){case s.d.MARKER:return new y(e);case s.d.FILL:return new f(e);case s.d.LINE:return new b(e);case s.d.TEXT:return new m(e);case s.d.LABEL:return new x(e)}}class c{constructor(e){this._data=0,this._data=e}static load(e){const t=this.shared;return t.data=e,t}set data(e){this._data=e}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(e){this.setBits(e,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(e){this.setBit(20,e)}get sdf(){return!!this.bit(11)}set sdf(e){this.setBit(11,e)}get pattern(){return!!this.bit(12)}set pattern(e){this.setBit(12,e)}get textureBinding(){return this.bits(0,8)}set textureBinding(e){this.setBits(e,0,8)}get geometryTypeString(){switch(this.geometryType){case s.d.FILL:return"fill";case s.d.MARKER:return"marker";case s.d.LINE:return"line";case s.d.TEXT:return"text";case s.d.LABEL:return"label";default:throw new r.a(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(e,t){const i=1<<e;t?this._data|=i:this._data&=~i}bit(e){return(this._data&1<<e)>>e}setBits(e,t,i){for(let r=t,s=0;r<i;r++,s++)this.setBit(r,0!=(e&1<<s))}bits(e,t){let i=0;for(let r=e,s=0;r<t;r++,s++)i|=this.bit(r)<<s;return i}hasVV(){return!1}setVV(e,t){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}getVariationHash(){return this._data&~(7&this.textureBinding)}}c.shared=new c(0);const u=e=>class extends e{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(e){this.setBit(16,e)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(e){this.setBit(17,e)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(e){this.setBit(18,e)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(e){this.setBit(19,e)}hasVV(){return super.hasVV()||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}setVV(e,t){super.setVV(e,t);const i=a(e,t)&e;this.vvSizeMinMaxValue=!!(i&s.e.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(i&s.e.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(i&s.e.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(i&s.e.SIZE_SCALE_STOPS)}},h=e=>class extends e{get vvRotation(){return 0!==this.bit(15)}set vvRotation(e){this.setBit(15,e)}hasVV(){return super.hasVV()||this.vvRotation}setVV(e,t){super.setVV(e,t),this.vvRotation=!t&&!!(e&s.e.ROTATION)}},p=e=>class extends e{get vvColor(){return 0!==this.bit(13)}set vvColor(e){this.setBit(13,e)}hasVV(){return super.hasVV()||this.vvColor}setVV(e,t){super.setVV(e,t),this.vvColor=!t&&!!(e&s.e.COLOR)}},d=e=>class extends e{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(e){this.setBit(14,e)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(e,t){super.setVV(e,t),this.vvOpacity=!t&&!!(e&s.e.OPACITY)}};class f extends(p(d(c))){static load(e){const t=this.shared;return t.data=e,t}static from(e,t){const i=this.load(0);return i.geometryType=s.d.FILL,t?i.dotDensity=!0:i.setVV(e,!1),i.data}getVariation(){return{...super.getVariation(),dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity}}get dotDensity(){return!!this.bit(15)}set dotDensity(e){this.setBit(15,e)}}f.shared=new f(0);class y extends(p(d(h(u(c))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=s.d.MARKER,t.setVV(e,!1),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}y.shared=new y(0);class b extends(p(d(u(c)))){static load(e){const t=this.shared;return t.data=e,t}static from(e,t){const i=this.load(0);return i.geometryType=s.d.LINE,i.setVV(e,t),i.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}b.shared=new b(0);class m extends(p(d(h(u(c))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(e);return t.geometryType=s.d.TEXT,t.setVV(e,!1),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}m.shared=new m(0);class x extends(u(c)){static load(e){const t=this.shared;return t.data=e,t}static from(e,t){const i=this.load(0);return i.geometryType=s.d.LABEL,i.setVV(e,!1),i.mapAligned=Object(n.a)(t),i.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}x.shared=new x(0)},164:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r,s=i(81),n=i(86),a=i(83),o=(i(79),i(84),i(80),i(82));let l=r=class extends n.a{constructor(){super(...arguments),this.title=null}clone(){return new r({title:this.title})}};Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],l.prototype,"title",void 0),l=r=Object(s.a)([Object(o.a)("esri.renderers.support.LegendOptions")],l);var c=l},167:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(81),s=i(86),n=i(83),a=(i(79),i(84),i(80),i(82));let o=class extends s.a{constructor(e){super(e),this.type=null}};Object(r.a)([Object(n.b)({readOnly:!0,json:{read:!1,write:!0}})],o.prototype,"type",void 0),o=Object(r.a)([Object(a.a)("esri.rest.support.ColorRamp")],o);var l=o},169:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return o}));var r=i(103),s=i(127),n=i(353),a=i(276);const o={types:r.i,json:{write:{writer:s.b},origins:{"web-scene":{types:r.j,write:{writer:s.b}}}}},l={types:{base:n.a,key:"type",typeMap:{"simple-fill":r.e.typeMap["simple-fill"],"picture-fill":r.e.typeMap["picture-fill"],"polygon-3d":r.e.typeMap["polygon-3d"]}},json:{write:{writer:s.b},origins:{"web-scene":{type:a.a,write:{writer:s.b}}}}}},178:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var r,s=i(81),n=i(88),a=i(89),o=i(80),l=i(100),c=i(83),u=(i(79),i(102)),h=i(92),p=i(82),d=i(90),f=i(128),y=i(271),b=i(293),m=i(200),x=i(234);const g=o.a.getLogger("esri.renderers.visualVariables.SizeVariable"),v=new a.a({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),O=new a.a({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function _(e){if(null!=e)return"string"==typeof e||"number"==typeof e?Object(l.k)(e):"size"===e.type?Object(m.c)(e)?e:(delete(e={...e}).type,new w(e)):void 0}function j(e,t,i){if("object"!=typeof e)return e;const r=new w;return r.read(e,i),r}let w=r=class extends f.a{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:x.viewScaleRE.test(this.valueExpression)}}set expression(e){g.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}set index(e){Object(m.c)(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),Object(m.c)(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return Object(m.a)(this)}set maxDataValue(e){e&&this.stops&&(g.warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(g.warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return _(e)}readMaxSize(e,t,i){return j(e,0,i)}set minDataValue(e){e&&this.stops&&(g.warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(g.warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return _(e)}readMinSize(e,t,i){return j(e,0,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)):e&&(g.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return Object(m.b)(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,i,r){if("$view.scale"===e){if(r&&r.messages){const e=this.index,t="string"==typeof e?e:`visualVariables[${e}]`;r.messages.push(new n.a("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:t+".valueExpression",context:r}))}}else t[i]=e}readValueUnit(e){return e?O.read(e):null}clone(){return new r({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Object(m.c)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Object(m.c)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if("clamped-linear"===this.transformationType){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if("stops"===this.transformationType){const e=this.stops,t=e.map((e=>e.size)).reverse(),i=e.length;for(let r=0;r<i;r++)e[r].size=t[r];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};Object(s.a)([Object(c.b)({readOnly:!0})],w.prototype,"cache",null),Object(s.a)([Object(c.b)({type:v.apiValues,json:{type:v.jsonValues,origins:{"web-map":{read:!1}},read:v.read,write:v.write}})],w.prototype,"axis",void 0),Object(s.a)([Object(c.b)({type:String,value:null,json:{read:!1}})],w.prototype,"expression",null),Object(s.a)([Object(c.b)()],w.prototype,"index",null),Object(s.a)([Object(c.b)({type:String,readOnly:!0})],w.prototype,"inputValueType",null),Object(s.a)([Object(c.b)({type:b.a,json:{write:!0}})],w.prototype,"legendOptions",void 0),Object(s.a)([Object(c.b)({type:Number,value:null,json:{write:!0}})],w.prototype,"maxDataValue",null),Object(s.a)([Object(c.b)({type:Number,value:null,json:{write:!0}})],w.prototype,"maxSize",null),Object(s.a)([Object(u.a)("maxSize")],w.prototype,"castMaxSize",null),Object(s.a)([Object(h.a)("maxSize")],w.prototype,"readMaxSize",null),Object(s.a)([Object(c.b)({type:Number,value:null,json:{write:!0}})],w.prototype,"minDataValue",null),Object(s.a)([Object(c.b)({type:Number,value:null,json:{write:!0}})],w.prototype,"minSize",null),Object(s.a)([Object(u.a)("minSize")],w.prototype,"castMinSize",null),Object(s.a)([Object(h.a)("minSize")],w.prototype,"readMinSize",null),Object(s.a)([Object(c.b)({type:String,json:{write:!0}})],w.prototype,"normalizationField",void 0),Object(s.a)([Object(c.b)({readOnly:!0})],w.prototype,"arcadeRequired",null),Object(s.a)([Object(c.b)({type:String})],w.prototype,"scaleBy",void 0),Object(s.a)([Object(c.b)({type:[y.a],value:null,json:{write:!0}})],w.prototype,"stops",null),Object(s.a)([Object(c.b)({type:["outline"],json:{write:!0}})],w.prototype,"target",void 0),Object(s.a)([Object(c.b)({type:String,readOnly:!0})],w.prototype,"transformationType",null),Object(s.a)([Object(c.b)({type:["size"],json:{type:["sizeInfo"]}})],w.prototype,"type",void 0),Object(s.a)([Object(c.b)({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],w.prototype,"useSymbolValue",void 0),Object(s.a)([Object(c.b)({type:String,json:{write:!0}})],w.prototype,"valueExpression",void 0),Object(s.a)([Object(h.a)("valueExpression",["valueExpression","expression"])],w.prototype,"readValueExpression",null),Object(s.a)([Object(d.a)("web-scene","valueExpression")],w.prototype,"writeValueExpressionWebScene",null),Object(s.a)([Object(c.b)({type:["radius","diameter","area","width","distance"],json:{write:!0}})],w.prototype,"valueRepresentation",void 0),Object(s.a)([Object(c.b)({type:O.apiValues,json:{write:O.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],w.prototype,"valueUnit",void 0),Object(s.a)([Object(h.a)("valueUnit")],w.prototype,"readValueUnit",null),w=r=Object(s.a)([Object(p.a)("esri.renderers.visualVariables.SizeVariable")],w);var S=w},186:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r,s=i(81),n=i(96),a=i(144),o=i(83),l=(i(79),i(84),i(80),i(82));let c=r=class extends(Object(a.a)(n.a)){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new r({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};Object(s.a)([Object(o.b)()],c.prototype,"active",void 0),Object(s.a)([Object(o.b)()],c.prototype,"className",void 0),Object(s.a)([Object(o.b)()],c.prototype,"disabled",void 0),Object(s.a)([Object(o.b)()],c.prototype,"id",void 0),Object(s.a)([Object(o.b)()],c.prototype,"indicator",void 0),Object(s.a)([Object(o.b)()],c.prototype,"title",void 0),Object(s.a)([Object(o.b)()],c.prototype,"type",void 0),Object(s.a)([Object(o.b)()],c.prototype,"visible",void 0),c=r=Object(s.a)([Object(l.a)("esri.support.actions.ActionBase")],c);var u=c},194:function(e,t,i){"use strict";i.d(t,"a",(function(){return z}));var r,s=i(81),n=i(103),a=i(89),o=i(87),l=i(80),c=i(85),u=i(83),h=i(102),p=(i(79),i(93)),d=i(92),f=i(82),y=i(90),b=i(84),m=i(107),x=i(115),g=i(132),v=i(284),O=i(169),_=i(164),j=i(123);const w=l.a.getLogger("esri.renderers.ClassBreaksRenderer"),S="percent-of-total",M="field",V=new a.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:S,esriNormalizeByField:M}),I=Object(b.m)(v.a);let T=r=class extends(Object(g.a)(x.a)){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,i){if(!Array.isArray(e))return;let r=t.minValue;return e.map((e=>{const t=new v.a;return t.read(e,i),null==t.minValue&&(t.minValue=r),null==t.maxValue&&(t.maxValue=t.minValue),r=t.maxValue,t}))}writeClassBreakInfos(e,t,i,r){const s=e.map((e=>e.write({},r)));this._areClassBreaksConsecutive()&&s.forEach((e=>delete e.classMinValue)),t[i]=s}castField(e){return null==e?e:"function"==typeof e?(w.error(".field: field must be a string value"),null):Object(b.l)(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,i=null!=this.normalizationTotal;return t||i?(e=(t?M:i&&S)||null,t&&i&&w.warn("warning: both normalizationField and normalizationTotal are set!")):e!==M&&e!==S||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,i){let r=null;r="number"==typeof e?new v.a({minValue:e,maxValue:t,symbol:Object(n.a)(i)}):I(Object(o.a)(e)),this.classBreakInfos.push(r),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const i=this.classBreakInfos.length;for(let r=0;r<i;r++){const i=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(i[0]===e&&i[1]===t){this.classBreakInfos.splice(r,1);break}}}getBreakIndex(e,t){return this.valueExpression&&(Object(c.j)(t)||Object(c.j)(t.arcade))&&w.warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let i=t;this.valueExpression&&(Object(c.j)(t)||Object(c.j)(t.arcade))&&(i={...i,arcade:await Object(j.e)()});const r=this.getBreakIndex(e,i);return-1!==r?this.classBreakInfos[r]:null}getSymbol(e,t){if(this.valueExpression&&(Object(c.j)(t)||Object(c.j)(t.arcade)))return void w.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(e,t);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&(Object(c.j)(t)||Object(c.j)(t.arcade))){const e=await Object(j.e)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),i={...i,arcade:e}}const r=this.getBreakIndex(e,i);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach((t=>{t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new r({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:Object(o.a)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:Object(o.a)(this.visualVariables),legendOptions:Object(o.a)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(e,t))),Object(m.c)(e,t,this.valueExpression)];Object(m.f)(e,t,this.field),Object(m.f)(e,t,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:s,arcade:n}=Object(c.t)(t,{});let a=this._compiledValueExpression.valueExpression===this.valueExpression?this._compiledValueExpression.compiledFunction:null;const o=Object(c.s)(n).arcadeUtils;if(!a){const e=o.createSyntaxTree(this.valueExpression);a=o.createFunction(e),this._compiledValueExpression.compiledFunction=a}this._compiledValueExpression.valueExpression=this.valueExpression;const l=o.executeFunction(a,o.createExecContext(e,o.getViewInfo({viewingMode:i,scale:r,spatialReference:s})));return this._getBreakIndexfromInfos(l)}_getBreakIndexForField(e){const t=this.field,i=e.attributes,r=this.normalizationType;let s=parseFloat(i[t]);if(r){const e=this.normalizationTotal,t=parseFloat(i[this.normalizationField]);if("log"===r)s=Math.log(s)*Math.LOG10E;else if(r!==S||isNaN(e)){if(r===M&&!isNaN(t)){if(isNaN(s)||isNaN(t))return-1;s/=t}}else s=s/e*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(let i=0;i<this.classBreakInfos.length;i++){const r=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(r[0]<=e&&(t?e<=r[1]:e<r[1]))return i}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let i=1;i<t;i++)if(e[i-1].maxValue!==e[i].minValue)return!1;return!0}};Object(s.a)([Object(u.b)(O.a)],T.prototype,"backgroundFillSymbol",void 0),Object(s.a)([Object(u.b)({type:[v.a]})],T.prototype,"classBreakInfos",void 0),Object(s.a)([Object(d.a)("classBreakInfos")],T.prototype,"readClassBreakInfos",null),Object(s.a)([Object(y.a)("classBreakInfos")],T.prototype,"writeClassBreakInfos",null),Object(s.a)([Object(u.b)({type:String,json:{write:!0}})],T.prototype,"defaultLabel",void 0),Object(s.a)([Object(u.b)(O.b)],T.prototype,"defaultSymbol",void 0),Object(s.a)([Object(u.b)({type:String,json:{write:!0}})],T.prototype,"field",void 0),Object(s.a)([Object(h.a)("field")],T.prototype,"castField",null),Object(s.a)([Object(u.b)({type:Boolean})],T.prototype,"isMaxInclusive",void 0),Object(s.a)([Object(u.b)({type:_.a,json:{write:!0}})],T.prototype,"legendOptions",void 0),Object(s.a)([Object(u.b)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],T.prototype,"minValue",null),Object(s.a)([Object(u.b)({type:String,json:{write:!0}})],T.prototype,"normalizationField",void 0),Object(s.a)([Object(u.b)({type:Number,cast:e=>Object(b.i)(e),json:{write:!0}})],T.prototype,"normalizationTotal",void 0),Object(s.a)([Object(u.b)({type:V.apiValues,value:null,json:{type:V.jsonValues,read:V.read,write:V.write}})],T.prototype,"normalizationType",null),Object(s.a)([Object(p.a)({classBreaks:"class-breaks"})],T.prototype,"type",void 0),Object(s.a)([Object(u.b)({type:String,json:{write:!0}})],T.prototype,"valueExpression",void 0),Object(s.a)([Object(u.b)({type:String,json:{write:!0}})],T.prototype,"valueExpressionTitle",void 0),T=r=Object(s.a)([Object(f.a)("esri.renderers.ClassBreaksRenderer")],T);var z=T},196:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var r,s=i(81),n=i(103),a=i(88),o=i(87),l=i(80),c=i(85),u=i(112),h=i(83),p=i(102),d=(i(79),i(93)),f=i(92),y=i(82),b=i(90),m=i(254),x=i(84),g=i(107),v=i(180),O=i(115),_=i(132),j=i(169),w=i(164),S=i(294),M=i(123),V=i(131),I=i(280),T=i(191);const z=l.a.getLogger("esri.renderers.UniqueValueRenderer"),k=Object(x.m)(S.a);let C=r=class extends(Object(_.a)(O.a)){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this.type="unique-value",this.backgroundFillSymbol=null,this.field=null,this.field2=null,this.field3=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.fieldDelimiter=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,t){if(!e&&!t)return;if(!e||!t)return{type:"complete",oldValue:e,newValue:t};let i=!1;const r={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<t.length;s++){const n=e.find((e=>e.value===t[s].value));n?Object(m.a)(n,t[s])?(r.changed.push({type:"complete",oldValue:n,newValue:t[s]}),i=!0):r.unchanged.push({oldValue:n,newValue:t[s]}):(r.added.push(t[s]),i=!0)}for(let s=0;s<e.length;s++)t.find((t=>t.value===e[s].value))||(r.removed.push(e[s]),i=!0);return i?r:void 0}},this._set("uniqueValueInfos",[])}get _cache(){return{compiledFunc:null}}castField(e){return null==e||"function"==typeof e?e:Object(x.l)(e)}writeField(e,t,i,r){"string"==typeof e?t[i]=e:r&&r.messages?r.messages.push(new a.a("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):z.error(".field: cannot write field to JSON since it's not a string value")}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}readPortal(e,t,i){return i.portal||v.a.getDefault()}readStyleOrigin(e,t,i){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const e=Object(V.a)(t.styleUrl,i);return Object.freeze({styleUrl:e})}}writeStyleOrigin(e,t,i,r){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=Object(V.e)(e.styleUrl,r))}set uniqueValueInfos(e){this.styleOrigin?z.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap())}addUniqueValueInfo(e,t){if(this.styleOrigin)return void z.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof e?k(e):new S.a({value:e,symbol:Object(n.a)(t)}),this.uniqueValueInfos.push(i),this._valueInfoMap[i.value]=i}removeUniqueValueInfo(e){if(this.styleOrigin)z.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(let t=0;t<this.uniqueValueInfos.length;t++)if(this.uniqueValueInfos[t].value===e+""){delete this._valueInfoMap[e],this.uniqueValueInfos.splice(t,1);break}}async getUniqueValueInfo(e,t){let i=t;return this.valueExpression&&(Object(c.j)(t)||Object(c.j)(t.arcade))&&(i={...i,arcade:await Object(M.e)()}),this._getUniqueValueInfo(e,i)}getSymbol(e,t){if(this.valueExpression&&(Object(c.j)(t)||Object(c.j)(t.arcade)))return void z.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(e,t);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&(Object(c.j)(i)||Object(c.j)(i.arcade))){const e=await Object(M.e)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),i={...i,arcade:e}}const r=this._getUniqueValueInfo(e,i);return r&&r.symbol||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos)t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return`${JSON.stringify(this.backgroundFillSymbol)}.${JSON.stringify(this.defaultSymbol)}.${this.uniqueValueInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}.${this.valueExpression}`}clone(){const e=new r({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:Object(o.a)(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:Object(o.a)(this.visualVariables),legendOptions:Object(o.a)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:Object(o.a)(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=Object(o.a)(this.uniqueValueInfos);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(Object(o.a)(this.styleOrigin))),Object.freeze(t)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(e,t))),Object(g.c)(e,t,this.valueExpression)];Object(g.f)(e,t,this.field),Object(g.f)(e,t,this.field2),Object(g.f)(e,t,this.field3),await Promise.all(i)}populateFromStyle(){return Object(I.fetchStyle)(this.styleOrigin,{portal:this.portal}).then((e=>{const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach((i=>{const r=new T.a({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==e.data.defaultItem||(this.defaultSymbol=r,this._isDefaultSymbolDerived=!0);const s=new S.a({value:i.name,symbol:r});t.push(s),this._valueInfoMap[i.name]=s})),this._set("uniqueValueInfos",Object.freeze(t)),!this.defaultSymbol&&this.uniqueValueInfos.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateValueInfoMap(){this._valueInfoMap={},this.uniqueValueInfos.forEach((e=>this._valueInfoMap[e.value+""]=e))}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:s,arcade:n}=Object(c.t)(t,{});let a=this._cache.compiledFunc;const o=Object(c.s)(n).arcadeUtils;if(!a){const e=o.createSyntaxTree(this.valueExpression);a=o.createFunction(e),this._cache.compiledFunc=a}const l=o.executeFunction(a,o.createExecContext(e,o.getViewInfo({viewingMode:i,scale:r,spatialReference:s})));return this._valueInfoMap[l+""]}_getUnqiueValueInfoForFields(e){const t=this.field,i=e.attributes;let r;if("function"!=typeof t&&this.field2){const e=this.field2,s=this.field3,n=[];t&&n.push(i[t]),e&&n.push(i[e]),s&&n.push(i[s]),r=n.join(this.fieldDelimiter||"")}else"function"==typeof t?r=t(e):t&&(r=i[t]);return this._valueInfoMap[r+""]}static fromPortalStyle(e,t){const i=new r(t&&t.properties);i._set("styleOrigin",Object.freeze({styleName:e})),i._set("portal",t&&t.portal||v.a.getDefault());const s=i.populateFromStyle();return s.catch((t=>{z.error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",t)})),s}static fromStyleUrl(e,t){const i=new r(t&&t.properties);i._set("styleOrigin",Object.freeze({styleUrl:e}));const s=i.populateFromStyle();return s.catch((t=>{z.error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",t)})),s}};Object(s.a)([Object(h.b)({readOnly:!0})],C.prototype,"_cache",null),Object(s.a)([Object(d.a)({uniqueValue:"unique-value"})],C.prototype,"type",void 0),Object(s.a)([Object(h.b)(j.a)],C.prototype,"backgroundFillSymbol",void 0),Object(s.a)([Object(h.b)({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],C.prototype,"field",void 0),Object(s.a)([Object(p.a)("field")],C.prototype,"castField",null),Object(s.a)([Object(b.a)("field")],C.prototype,"writeField",null),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"field2",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"field3",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"valueExpression",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"valueExpressionTitle",void 0),Object(s.a)([Object(h.b)({type:w.a,json:{write:!0}})],C.prototype,"legendOptions",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"defaultLabel",void 0),Object(s.a)([Object(h.b)(Object(u.a)({...j.b},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],C.prototype,"defaultSymbol",null),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],C.prototype,"fieldDelimiter",void 0),Object(s.a)([Object(h.b)({type:v.a,readOnly:!0})],C.prototype,"portal",void 0),Object(s.a)([Object(f.a)("portal",["styleName"])],C.prototype,"readPortal",null),Object(s.a)([Object(h.b)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],C.prototype,"styleOrigin",void 0),Object(s.a)([Object(f.a)("styleOrigin",["styleName","styleUrl"])],C.prototype,"readStyleOrigin",null),Object(s.a)([Object(b.a)("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],C.prototype,"writeStyleOrigin",null),Object(s.a)([Object(h.b)({type:[S.a],json:{write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],C.prototype,"uniqueValueInfos",null),C=r=Object(s.a)([Object(y.a)("esri.renderers.UniqueValueRenderer")],C);var P=C},199:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return S}));var r,s=i(81),n=i(104),a=i(101),o=i(88),l=i(87),c=i(80),u=i(265),h=i(85),p=i(91),d=i(142),f=i(83),y=(i(84),i(79),i(82)),b=i(90),m=i(107),x=i(115),g=i(132),v=i(123),O=i(382);const _=c.a.getLogger("esri.renderers.DictionaryRenderer"),j={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let w=r=class extends(Object(g.a)(x.a)){constructor(e){super(e),this._ongoingRequests=new Map,this._symbolCache=new u.a(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,i,r){null!=r&&r.origin||super.writeVisualVariables(e,t,i,r)}clone(){return new r({config:Object(l.a)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:Object(l.a)(this.fieldMap),url:Object(l.a)(this.url),visualVariables:Object(l.a)(this.visualVariables)})}async getSymbolAsync(e,t){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(t));try{i=await this._dictionaryPromise}catch(b){if(Object(p.m)(b))return this._dictionaryPromise=null,null}const r={};if(this.fieldMap)for(const n of this._symbolFields){const t=this.fieldMap[n];if(t&&null!==e.attributes[t]&&void 0!==e.attributes[t]){const i=""+e.attributes[t];r[n]=i}else r[n]=""}const s=i(r,t);if(!s||"string"!=typeof s)return null;const a=Object(d.b)(s).toString(),o=this._symbolCache.get(a);if(o)return o.catch((()=>{this._symbolCache.pop(a)})),o;const l=s.split(";"),c=[],u=[];for(const h of l)if(h&&0!==h.length)if(-1===h.indexOf("po:"))if(-1!==h.indexOf("|"))for(const e of h.split("|"))this._itemNames.has(e)&&c.push(e);else this._itemNames.has(h)&&c.push(h);else{const e=h.substr(3).split("|");if(3===e.length){const t=e[0],i=e[1];let r=e[2];if("DashTemplate"===i)r=r.split(" ").map((e=>Number(e)));else if("Color"===i){const e=new n.a(r).toRgba();r=[e[0],e[1],e[2],255*e[3]]}else r=Number(r);u.push({primitiveName:t,propertyName:i,value:r})}}const f=!Object(h.k)(e.geometry)||!e.geometry.hasZ&&"point"===e.geometry.type,y=this._cimPartsToCIMSymbol(c,u,f,t);return this._symbolCache.put(a,y,1),y}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await Object(m.c)(e,t,this.scaleExpression);for(const i in this.fieldMap){const r=this.fieldMap[i];t.has(r)&&e.add(r)}}get arcadeRequired(){return!0}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void _.error("no valid URL!");const t=Object(h.k)(e)?e.abortOptions:null,i=Object(a.default)(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},...t}),[{data:r}]=await Promise.all([i,Object(v.e)()]);if(!r)throw this._dictionaryPromise=null,new o.a("esri.renderers.DictionaryRenderer","Bad dictionary data!");const s=r.expression,n=r.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+r.cimRefTemplateUrl,this._itemNames=new Set(r.itemsNames),this._symbolFields=n.symbol;const l={};if(this.config){const e=this.config;for(const t in e)l[t]=e[t]}if(n.configuration)for(const a of n.configuration)l.hasOwnProperty(a.name)||(l[a.name]=a.value);const c=[];if(Object(h.k)(e)&&e.fields&&this.fieldMap)for(const a of this._symbolFields){const t=this.fieldMap[a],i=e.fields.filter((e=>e.name===t));i.length>0&&c.push({...i[0],name:a})}return this._dictionaryPromise=Object(v.b)(s,Object(h.k)(e)?e.spatialReference:null,c,l).then((e=>{const t={scale:0};return(i,r)=>{const s=e.repurposeFeature({geometry:null,attributes:i});return t.scale=Object(h.k)(r)?r.scale:void 0,e.evaluate({$feature:s,$view:t})}})).catch((e=>(_.error("Creating dictinoary expression failed:",e),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(e,t){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const i=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,e),r=Object(a.default)(i,{responseType:"json",query:{f:"json"},...t});this._ongoingRequests.set(e,r);try{return(await r).data}catch(s){return this._ongoingRequests.delete(e),Promise.reject(s)}}_combineSymbolParts(e,t,i){if(!e||0===e.length)return null;const r={...e[0]};if(e.length>1){r.symbolLayers=[];for(const t of e){const e=t;r.symbolLayers.unshift(...e.symbolLayers)}}return i&&(r.callout=j),{type:"CIMSymbolReference",symbol:r,primitiveOverrides:t}}async _cimPartsToCIMSymbol(e,t,i,r){const s=new Array(e.length);for(let a=0;a<e.length;a++)s[a]=this._getSymbolPart(e[a],r);const n=await Promise.all(s);return new O.a({data:this._combineSymbolParts(n,t,i)})}};Object(s.a)([Object(f.b)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],w.prototype,"config",void 0),Object(s.a)([Object(f.b)({type:Object,json:{write:!0}})],w.prototype,"fieldMap",void 0),Object(s.a)([Object(f.b)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],w.prototype,"scaleExpression",void 0),Object(s.a)([Object(b.a)("scaleExpression")],w.prototype,"writeData",null),Object(s.a)([Object(f.b)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],w.prototype,"scaleExpressionTitle",void 0),Object(s.a)([Object(f.b)({type:String,json:{write:!0}})],w.prototype,"url",void 0),Object(s.a)([Object(b.a)("visualVariables")],w.prototype,"writeVisualVariables",null),w=r=Object(s.a)([Object(y.a)("esri.renderers.DictionaryRenderer")],w);var S=w},200:function(e,t,i){"use strict";function r(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function s(e){return null!=e&&!isNaN(e)&&isFinite(e)}function n(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function a(e,t){const i=t||n(e),r=e.valueUnit||"unknown";return"unknown"===i?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===r?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return s}))},205:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return s}));i(79);function r(e){}function s(e){return()=>e}},209:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r,s=i(81),n=i(87),a=i(83),o=(i(84),i(79),i(80),i(93)),l=i(82),c=i(115),u=i(132),h=i(169);let p=r=class extends(Object(u.a)(c.a)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.getSymbols().map((i=>i.collectRequiredFields(e,t))))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new r({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:Object(n.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],p.prototype,"description",void 0),Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],p.prototype,"label",void 0),Object(s.a)([Object(a.b)(h.b)],p.prototype,"symbol",void 0),Object(s.a)([Object(o.a)({simple:"simple"})],p.prototype,"type",void 0),p=r=Object(s.a)([Object(l.a)("esri.renderers.SimpleRenderer")],p);var d=p},211:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r,s=i(81),n=i(104),a=i(87),o=i(83),l=(i(84),i(79),i(80),i(93)),c=i(82),u=i(107),h=i(115),p=i(307);let d=r=class extends h.a{constructor(e){super(e),this.blurRadius=10,this.colorStops=[new p.a({ratio:0,color:new n.a("rgba(255, 140, 0, 0)")}),new p.a({ratio:.75,color:new n.a("rgba(255, 140, 0, 1)")}),new p.a({ratio:.9,color:new n.a("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.maxPixelIntensity=100,this.minPixelIntensity=0,this.type="heatmap"}async collectRequiredFields(e,t){const i=this.field;i&&"string"==typeof i&&Object(u.f)(e,t,i)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new r({blurRadius:this.blurRadius,colorStops:Object(a.a)(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}};Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],d.prototype,"blurRadius",void 0),Object(s.a)([Object(o.b)({type:[p.a],json:{write:!0}})],d.prototype,"colorStops",void 0),Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],d.prototype,"field",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:{overridePolicy:(e,t,i)=>({enabled:null==i})}}})],d.prototype,"fieldOffset",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],d.prototype,"maxPixelIntensity",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],d.prototype,"minPixelIntensity",void 0),Object(s.a)([Object(l.a)({heatmap:"heatmap"})],d.prototype,"type",void 0),d=r=Object(s.a)([Object(c.a)("esri.renderers.HeatmapRenderer")],d);var f=d},212:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var r,s=i(81),n=i(104),a=i(87),o=i(146),l=i(84),c=(i(79),i(80)),u=i(93),h=i(83),p=i(82),d=i(107),f=i(115),y=i(132),b=i(86),m=i(102);const x=c.a.getLogger("esri.renderers.support.AttributeColorInfo");let g=r=class extends b.a{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return null==e?e:"function"==typeof e?(x.error(".field: field must be a string value"),null):Object(l.l)(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new r({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};Object(s.a)([Object(h.b)({type:n.a,json:{type:[Number],write:!0}})],g.prototype,"color",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"field",void 0),Object(s.a)([Object(m.a)("field")],g.prototype,"castField",null),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"label",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"valueExpression",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],g.prototype,"valueExpressionTitle",void 0),g=r=Object(s.a)([Object(p.a)("esri.renderers.support.AttributeColorInfo")],g);var v,O=g;let _=v=class extends b.a{constructor(){super(...arguments),this.unit=null}clone(){return new v({unit:this.unit})}};Object(s.a)([Object(h.b)({type:String,json:{write:!0}})],_.prototype,"unit",void 0),_=v=Object(s.a)([Object(p.a)("esri.renderers.support.DotDensityLegendOptions")],_);var j,w=_,S=i(172),M=i(183);let V=j=class extends(Object(y.a)(f.a)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new n.a([0,0,0,0]),this.blendDots=!0,this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new M.a,this.dotValue=null,this.referenceDotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new S.a({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes&&this.attributes.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new j({attributes:Object(a.a)(this.attributes),backgroundColor:Object(a.a)(this.backgroundColor),dotBlendingEnabled:Object(a.a)(this.dotBlendingEnabled),dotShape:Object(a.a)(this.dotShape),dotSize:Object(a.a)(this.dotSize),dotValue:Object(a.a)(this.dotValue),legendOptions:Object(a.a)(this.legendOptions),outline:Object(a.a)(this.outline),referenceScale:Object(a.a)(this.referenceScale),visualVariables:Object(a.a)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return`${this.attributes.map((e=>e.field||e.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes)i.valueExpression&&await Object(d.c)(e,t,i.valueExpression),i.field&&e.add(i.field)}};Object(s.a)([Object(h.b)({type:[O],json:{write:!0}})],V.prototype,"attributes",void 0),Object(s.a)([Object(h.b)({type:n.a,json:{write:!0}})],V.prototype,"backgroundColor",void 0),Object(s.a)([Object(h.b)({type:Boolean}),Object(o.a)("dotBlendingEnabled")],V.prototype,"blendDots",void 0),Object(s.a)([Object(h.b)({type:Boolean,json:{write:!0}})],V.prototype,"dotBlendingEnabled",void 0),Object(s.a)([Object(h.b)({type:String,json:{write:!1}})],V.prototype,"dotShape",void 0),Object(s.a)([Object(h.b)({type:Number,json:{write:!1}})],V.prototype,"dotSize",void 0),Object(s.a)([Object(h.b)({type:w,json:{write:!0}})],V.prototype,"legendOptions",void 0),Object(s.a)([Object(h.b)({type:M.a,json:{default:null,write:!0}})],V.prototype,"outline",void 0),Object(s.a)([Object(h.b)({type:Number,json:{write:!0}})],V.prototype,"dotValue",void 0),Object(s.a)([Object(h.b)({type:Number}),Object(o.a)("dotValue")],V.prototype,"referenceDotValue",void 0),Object(s.a)([Object(h.b)({type:Number,json:{write:!0}})],V.prototype,"referenceScale",void 0),Object(s.a)([Object(h.b)({type:Number,json:{write:!0}})],V.prototype,"seed",void 0),Object(s.a)([Object(u.a)({dotDensity:"dot-density"})],V.prototype,"type",void 0),V=j=Object(s.a)([Object(p.a)("esri.renderers.DotDensityRenderer")],V);var I=V},213:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r,s=i(81),n=i(104),a=i(87),o=i(83),l=i(84),c=(i(79),i(80),i(93)),u=i(82),h=i(167);let p=r=class extends h.a{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new r({fromColor:Object(a.a)(this.fromColor),toColor:Object(a.a)(this.toColor),algorithm:this.algorithm})}};Object(s.a)([Object(c.a)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],p.prototype,"algorithm",void 0),Object(s.a)([Object(o.b)({type:n.a,json:{type:[l.a],write:!0}})],p.prototype,"fromColor",void 0),Object(s.a)([Object(o.b)({type:n.a,json:{type:[l.a],write:!0}})],p.prototype,"toColor",void 0),Object(s.a)([Object(o.b)({type:["algorithmic"]})],p.prototype,"type",void 0),p=r=Object(s.a)([Object(u.a)("esri.rest.support.AlgorithmicColorRamp")],p);var d=p},214:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r,s=i(81),n=i(88),a=i(83),o=(i(79),i(84),i(80),i(82)),l=i(90),c=i(128);let u=r=class extends c.a{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,t,i,r){if(r&&r.messages){const e=`visualVariables[${this.index}]`;r.messages.push(new n.a("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:e+".valueExpressionTitle",context:r}))}}clone(){return new r({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};Object(s.a)([Object(a.b)({readOnly:!0})],u.prototype,"cache",null),Object(s.a)([Object(a.b)({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],u.prototype,"axis",void 0),Object(s.a)([Object(a.b)({type:["rotation"],json:{type:["rotationInfo"]}})],u.prototype,"type",void 0),Object(s.a)([Object(a.b)({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],u.prototype,"rotationType",void 0),Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],u.prototype,"valueExpressionTitle",void 0),Object(s.a)([Object(l.a)("web-scene","valueExpressionTitle")],u.prototype,"writeValueExpressionTitleWebScene",null),u=r=Object(s.a)([Object(o.a)("esri.renderers.visualVariables.RotationVariable")],u);var h=u},221:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r,s=i(81),n=i(83),a=(i(79),i(84),i(80),i(82)),o=i(164);let l=r=class extends o.a{constructor(){super(...arguments),this.showLegend=null}clone(){return new r({title:this.title,showLegend:this.showLegend})}};Object(s.a)([Object(n.b)({type:Boolean,json:{write:!0}})],l.prototype,"showLegend",void 0),l=r=Object(s.a)([Object(a.a)("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],l);var c=l},224:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return l})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return h})),i.d(t,"f",(function(){return c})),i.d(t,"g",(function(){return o})),i.d(t,"h",(function(){return n}));const r=0,s=100;function n(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e}function a(e,t){return Math.sqrt(e*e+t*t)}function o(e){const t=a(e[0],e[1]);e[0]/=t,e[1]/=t}function l(e,t){return a(e[0]-t[0],e[1]-t[1])}function c(e){return"function"==typeof e}function u(e=2){return 1/Math.max(e,1)}function h(e,t){return[!!e.minScale&&t.scaleToZoom(e.minScale)||r,!!e.maxScale&&t.scaleToZoom(e.maxScale)||s]}},228:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(116),s=i(139);const n={inches:Object(r.c)(1,"meters","inches"),feet:Object(r.c)(1,"meters","feet"),"us-feet":Object(r.c)(1,"meters","us-feet"),yards:Object(r.c)(1,"meters","yards"),miles:Object(r.c)(1,"meters","miles"),"nautical-miles":Object(r.c)(1,"meters","nautical-miles"),millimeters:Object(r.c)(1,"meters","millimeters"),centimeters:Object(r.c)(1,"meters","centimeters"),decimeters:Object(r.c)(1,"meters","decimeters"),meters:Object(r.c)(1,"meters","meters"),kilometers:Object(r.c)(1,"meters","kilometers"),"decimal-degrees":1/Object(r.m)(1,"meters",s.a.radius)}},229:function(e,t,i){"use strict";function r(){return new Float32Array(2)}function s(e,t){const i=new Float32Array(2);return i[0]=e,i[1]=t,i}function n(){return r()}function a(){return s(1,1)}function o(){return s(1,0)}function l(){return s(0,1)}i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return s}));const c=n(),u=a(),h=o(),p=l();Object.freeze({__proto__:null,create:r,clone:function(e){const t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t},fromValues:s,createView:function(e,t){return new Float32Array(e,t,2)},zeros:n,ones:a,unitX:o,unitY:l,ZEROS:c,ONES:u,UNIT_X:h,UNIT_Y:p})},234:function(e,t,i){"use strict";i.r(t),i.d(t,"getAllSizes",(function(){return w})),i.d(t,"getColor",(function(){return f})),i.d(t,"getOpacity",(function(){return y})),i.d(t,"getRotationAngle",(function(){return b})),i.d(t,"getSize",(function(){return m})),i.d(t,"getSizeForValue",(function(){return v})),i.d(t,"getSizeFromNumberOrVariable",(function(){return x})),i.d(t,"getSizeRangeAtScale",(function(){return O})),i.d(t,"getVisualVariableValues",(function(){return _})),i.d(t,"viewScaleRE",(function(){return d}));var r=i(104),s=i(122),n=i(205),a=i(80),o=i(85),l=i(228),c=i(200);const u=a.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),h=new s.a,p=Math.PI,d=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function f(e,t,i){const s="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"color"===e.type))[0]:e;if(!s)return;if("esri.renderers.visualVariables.ColorVariable"!==s.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n="number"==typeof t,a=n?null:t,l=a&&a.attributes;let c=n?t:null;const h=s.field,{ipData:p,hasExpression:d}=s.cache;let f=s.cache.compiledFunc;if(!h&&!d){const e=s.stops;return e&&e[0]&&e[0].color}if("number"!=typeof c)if(d){if(!Object(o.k)(i)||!Object(o.k)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),n=t.createExecContext(a,r);if(!f){const e=t.createSyntaxTree(s.valueExpression);f=t.createFunction(e),s.cache.compiledFunc=f}c=t.executeFunction(f,n)}else l&&(c=l[h]);const y=s.normalizationField,b=l?parseFloat(l[y]):void 0;if(null!=c&&(!y||n||!isNaN(b)&&0!==b)){isNaN(b)||n||(c/=b);const e=j(c,p);if(e){const t=e[0],n=e[1],a=t===n?s.stops[t].color:r.a.blendColors(s.stops[t].color,s.stops[n].color,e[2],Object(o.k)(i)?i.color:void 0);return new r.a(a)}}}function y(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"opacity"===e.type))[0]:e;if(!r)return;if("esri.renderers.visualVariables.OpacityVariable"!==r.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const s="number"==typeof t,n=s?null:t,a=n&&n.attributes;let l=s?t:null;const c=r.field,{ipData:h,hasExpression:p}=r.cache;let d=r.cache.compiledFunc;if(!c&&!p){const e=r.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof l)if(p){if(Object(o.j)(i)||Object(o.j)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,s=t.getViewInfo(e),a=t.createExecContext(n,s);if(!d){const e=t.createSyntaxTree(r.valueExpression);d=t.createFunction(e),r.cache.compiledFunc=d}l=t.executeFunction(d,a)}else a&&(l=a[c]);const f=r.normalizationField,y=a?parseFloat(a[f]):void 0;if(null!=l&&(!f||s||!isNaN(y)&&0!==y)){isNaN(y)||s||(l/=y);const e=j(l,h);if(e){const t=e[0],i=e[1];if(t===i)return r.stops[t].opacity;{const s=r.stops[t].opacity;return s+(r.stops[i].opacity-s)*e[2]}}}}function b(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"rotation"===e.type))[0]:e;if(!r)return;if("esri.renderers.visualVariables.RotationVariable"!==r.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const s=r.axis||"heading",n="heading"===s&&"arithmetic"===r.rotationType?90:0,a="heading"===s&&"arithmetic"===r.rotationType?-1:1,l="number"==typeof t?null:t,c=l&&l.attributes,h=r.field,{hasExpression:p}=r.cache;let d=r.cache.compiledFunc,f=0;if(!h&&!p)return f;if(p){if(Object(o.j)(i)||Object(o.j)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,s=t.getViewInfo(e),n=t.createExecContext(l,s);if(!d){const e=t.createSyntaxTree(r.valueExpression);d=t.createFunction(e),r.cache.compiledFunc=d}f=t.executeFunction(d,n)}else c&&(f=c[h]||0);return f="number"!=typeof f||isNaN(f)?null:n+a*f,f}function m(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"size"===e.type))[0]:e;if(!r)return;if("esri.renderers.visualVariables.SizeVariable"!==r.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const s=v(function(e,t,i){const r="number"==typeof t,s=r?null:t,n=s&&s.attributes;let a=r?t:null;const{isScaleDriven:l}=e.cache;let h=e.cache.compiledFunc;if(l){const t=Object(o.k)(i)?i.scale:void 0,r=Object(o.k)(i)?i.view:void 0;a=null==t||"3d"===r?function(e){let t=null,i=null;const r=e.stops;return r?(t=r[0].value,i=r[r.length-1].value):(t=e.minDataValue||0,i=e.maxDataValue||0),(t+i)/2}(e):t}else if(!r)switch(e.inputValueType){case"expression":{if(Object(o.j)(i)||Object(o.j)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},r=i.arcade.arcadeUtils,n=r.getViewInfo(t),l=r.createExecContext(s,n);if(!h){const t=r.createSyntaxTree(e.valueExpression);h=r.createFunction(t),e.cache.compiledFunc=h}a=r.executeFunction(h,l);break}case"field":n&&(a=n[e.field]);break;case"unknown":a=null}if(!Object(c.d)(a))return null;if(r||!e.normalizationField)return a;const p=n?parseFloat(n[e.normalizationField]):null;return Object(c.d)(p)&&0!==p?a/p:null}(r,t,i),r,t,i,r.cache.ipData);return null==s||isNaN(s)?0:s}function x(e,t,i){return null==e?null:Object(c.c)(e)?m(e,t,i):Object(c.d)(e)?e:null}function g(e,t,i){return Object(c.d)(i)&&e>i?i:Object(c.d)(t)&&e<t?t:e}function v(e,t,i,r,s){switch(t.transformationType){case"additive":return function(e,t,i,r){return e+(x(t.minSize,i,r)||t.minDataValue)}(e,t,i,r);case"constant":return function(e,t,i){const r=e.stops;let s=r&&r.length&&r[0].size;return null==s&&(s=e.minSize),x(s,t,i)}(t,i,r);case"clamped-linear":return function(e,t,i,r){const s=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),n=x(t.minSize,i,r),a=x(t.maxSize,i,r),l=Object(o.k)(r)?r.shape:void 0;if(e<=t.minDataValue)return n;if(e>=t.maxDataValue)return a;if("area"===t.scaleBy&&l){const e="circle"===l,t=e?p*(n/2)**2:n*n,i=t+s*((e?p*(a/2)**2:a*a)-t);return e?2*Math.sqrt(i/p):Math.sqrt(i)}return n+s*(a-n)}(e,t,i,r);case"proportional":return function(e,t,i,r){const s=Object(o.k)(r)?r.shape:void 0,n=e/t.minDataValue,a=x(t.minSize,i,r),l=x(t.maxSize,i,r);let c=null;return c="circle"===s?2*Math.sqrt(n*(a/2)**2):"square"===s||"diamond"===s||"image"===s?Math.sqrt(n*a**2):n*a,g(c,a,l)}(e,t,i,r);case"stops":return function(e,t,i,r,s){const[n,a,o]=j(e,s);if(n===a)return x(t.stops[n].size,i,r);{const e=x(t.stops[n].size,i,r);return e+(x(t.stops[a].size,i,r)-e)*o}}(e,t,i,r,s);case"real-world-size":return function(e,t,i,r){const s=(Object(o.k)(r)&&r.resolution?r.resolution:1)*l.a[t.valueUnit],n=x(t.minSize,i,r),a=x(t.maxSize,i,r),{valueRepresentation:c}=t;let u=null;return u="area"===c?2*Math.sqrt(e/p)/s:"radius"===c||"distance"===c?2*e/s:e/s,g(u,n,a)}(e,t,i,r);case"identity":return e;case"unknown":return null}}function O(e,t,i){const{isScaleDriven:r}=e.cache;if(!(r&&"3d"===i||t))return null;const s={scale:t,view:i};let n=x(e.minSize,h,s),a=x(e.maxSize,h,s);if(null!=n||null!=a){if(n>a){const e=a;a=n,n=e}return{minSize:n,maxSize:a}}}function _(e,t,i){if(!e.visualVariables)return;const r=[],s=[],n=[],a=[],o=[];for(const l of e.visualVariables)switch(l.type){case"color":s.push(l);break;case"opacity":n.push(l);break;case"rotation":o.push(l);break;case"size":a.push(l)}return s.forEach((e=>{const s=f(e,t,i);r.push({variable:e,value:s})})),n.forEach((e=>{const s=y(e,t,i);r.push({variable:e,value:s})})),o.forEach((e=>{const s=b(e,t,i);r.push({variable:e,value:s})})),a.forEach((e=>{const s=m(e,t,i);r.push({variable:e,value:s})})),r.filter((e=>null!=e.value))}function j(e,t){if(!t)return;let i=0,r=t.length-1;return t.some(((t,s)=>e<t?(r=s,!0):(i=s,!1))),[i,r,(e-t[i])/(t[r]-t[i])]}function w(e,t,i){const r=["proportional","proportional","proportional"];for(const s of e){const e=s.useSymbolValue?"symbol-value":m(s,t,i);switch(s.axis){case"width":r[0]=e;break;case"depth":r[1]=e;break;case"height":r[2]=e;break;case"width-and-depth":r[0]=e,r[1]=e;break;case"all":case void 0:case null:r[0]=e,r[1]=e,r[2]=e;break;default:Object(n.a)(s.axis)}}return r}},239:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return h}));var r=i(194),s=i(199),n=i(212),a=i(211),o=i(115),l=i(209),c=i(196);const u={key:"type",base:o.a,typeMap:{heatmap:a.a,simple:l.a,"unique-value":c.a,"class-breaks":r.a,"dot-density":n.a,dictionary:s.default},errorContext:"renderer"},h={key:"type",base:o.a,typeMap:{simple:l.a,"unique-value":c.a,"class-breaks":r.a},errorContext:"renderer"}},262:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return f})),i.d(t,"f",(function(){return b})),i.d(t,"g",(function(){return y})),i.d(t,"h",(function(){return d}));i(79);var r=i(85),s=i(172),n=i(183),a=i(235),o=i(270),l=i(297);const c=a.a.fromJSON(l.c),u=n.a.fromJSON(l.e),h=s.a.fromJSON(l.d),p=o.a.fromJSON(l.f);function d(e){if(Object(r.j)(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return c;case"polyline":return u;case"polygon":case"extent":return h}return null}const f=a.a.fromJSON(l.g),y=n.a.fromJSON(l.i),b=s.a.fromJSON(l.h)},265:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(247);class s{constructor(e,t){this._storage=new r.b,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}put(e,t,i){this._storage.put(e,t,i,1)}pop(e){return this._storage.pop(e)}get(e){return this._storage.get(e)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}}},269:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return l}));i(79);var r=i(88),s=i(112),n=i(154),a=i(201),o=i(239);function l(e,t,i,n){const a=function(e,t){return e?function(e,t){if(!t||"web-scene"!==t.origin)return!0;switch(e.type){case"simple":case"unique-value":case"class-breaks":return!0;default:return!1}}(e,t)?e.write({},t):(t.messages&&t.messages.push(new r.a("renderer:unsupported",`Renderer of type '${e.declaredClass}' are not supported in scenes.`,{renderer:e,context:t})),null):null}(e,n);a&&Object(s.c)(i,a,t)}function c(e,t){return h(e,null,t)}const u=Object(a.b)({types:o.a});function h(e,t,i){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(i&&i.messages&&i.messages.push(new n.a("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:i})),null):u(e,t,i):null}},271:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r,s=i(81),n=i(86),a=i(100),o=i(83),l=(i(79),i(84),i(80),i(82));let c=r=class extends n.a{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new r({label:this.label,size:this.size,value:this.value})}};Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],c.prototype,"label",void 0),Object(s.a)([Object(o.b)({type:Number,cast:a.k,json:{write:!0}})],c.prototype,"size",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],c.prototype,"value",void 0),c=r=Object(s.a)([Object(l.a)("esri.renderers.visualVariables.support.SizeStop")],c);var u=c},277:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return a}));var r=i(213),s=i(167),n=i(292);const a={key:"type",base:s.a,typeMap:{algorithmic:r.a,multipart:n.a}};function o(e){return e&&e.type?"algorithmic"===e.type?r.a.fromJSON(e):"multipart"===e.type?n.a.fromJSON(e):null:null}},278:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var r=i(103),s=i(88),n=i(191),a=i(387),o=i(183),l=i(398),c=i(235),u=i(349),h=i(172),p=i(276),d=i(270),f=i(397);function y(e,t=!1,i=!1,y=!0){if(!e)return{symbol:null};let b;if(Object(r.c)(e)||e instanceof n.a)b=e.clone();else if("cim"===e.type)b=a.a.fromCIMSymbol(e);else if(e instanceof o.a)b=l.a.fromSimpleLineSymbol(e);else if(e instanceof c.a)b=a.a.fromSimpleMarkerSymbol(e);else if(e instanceof u.a)b=a.a.fromPictureMarkerSymbol(e);else if(e instanceof h.a)b=p.a.fromSimpleFillSymbol(e);else{if(!(e instanceof d.a))return{error:new s.a("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};b=y?f.a.fromTextSymbol(e):a.a.fromTextSymbol(e)}if(t&&(b.id=e.id),i&&Object(r.c)(b))for(let r=0;r<b.symbolLayers.length;++r)b.symbolLayers.getItemAt(r)._ignoreDrivers=!0;return{symbol:b}}},280:function(e,t,i){"use strict";i.r(t),i.d(t,"fetchStyle",(function(){return m})),i.d(t,"fetchSymbolFromStyle",(function(){return g})),i.d(t,"resolveWebStyleSymbol",(function(){return x})),i.d(t,"styleNameFromItem",(function(){return O}));var r=i(101),s=i(103),n=i(285),a=i(88),o=i(98),l=i(180),c=i(314),u=i(79);var h=i(131),p=i(127),d=i(415),f=i(407);const y={};function b(e,t,i){const r=t.portal||l.a.getDefault();let s;const n=`${r.url} - ${r.user&&r.user.username} - ${e}`;return y[n]||(y[n]=function(e,t,i){return t.load(i).then((()=>{const r=new c.a({disableExtraQuery:!0,query:`owner:${j} AND type:${w} AND typekeywords:"${e}"`});return t.queryItems(r,i)})).then((({results:t})=>{let r=null;const s=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t)if(e.typeKeywords.some((e=>e.toLowerCase()===s))&&e.type===w&&e.owner===j){r=e;break}if(!r)throw new a.a("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return r.load(i)}))}(e,r,i).then((e=>(s=e,e.fetchData()))).then((t=>({data:t,baseUrl:s.itemUrl,styleName:e})))),y[n]}function m(e,t,i){return e.styleUrl?function(e,t){return _(e,t).then((t=>({data:t.data,baseUrl:Object(o.G)(e),styleUrl:e})))}(e.styleUrl,i):e.styleName?b(e.styleName,t,i):Promise.reject(new a.a("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function x(e,t,i,r){return e.name?e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName?function(e,t,i){const r=S.replace(/\{SymbolName\}/gi,e.name);return _(r,i).then((e=>{const i=v(e.data);return Object(p.a)(i,{portal:t.portal,url:Object(o.K)(Object(o.G)(r)),origin:"portal-item"})}))}(e,t,r):m(e,t,r).then((s=>g(s,e.name,t,i,r))):Promise.reject(new a.a("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function g(e,t,i,r,l){const c=e.data,y={portal:i.portal,url:Object(o.K)(e.baseUrl),origin:"portal-item"},b=c.items.find((e=>e.name===t));if(!b){const e=`The symbol name '${t}' could not be found`;return Promise.reject(new a.a("symbolstyleutils:symbol-name-not-found",e,{symbolName:t}))}let m=Object(h.a)(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!Object(u.a)("enable-feature:force-wosr"))for(const i of e.formatInfos)if("gltf"===i.type)return i.href;return e.webRef}(b,r),y),x=b.thumbnail&&b.thumbnail.href;const g=b.thumbnail&&b.thumbnail.imageData;Object(n.b)()&&(m=Object(n.a)(m),x=Object(n.a)(x));const O={portal:i.portal,url:Object(o.K)(Object(o.G)(m)),origin:"portal-item"};return _(m,l).then((n=>{const a="cimRef"===r?v(n.data):n.data,o=Object(p.a)(a,O);if(o&&Object(s.c)(o)){if(x){const e=Object(h.a)(x,y);o.thumbnail=new f.a({url:e})}else g&&(o.thumbnail=new f.a({url:`data:image/png;base64,${g}`}));e.styleUrl?o.styleOrigin=new d.a({portal:i.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(o.styleOrigin=new d.a({portal:i.portal,styleName:e.styleName,name:t}))}return o}))}function v(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function O(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}function _(e,t){const i={responseType:"json",query:{f:"json"},...t};return Object(r.default)(Object(o.D)(e),i)}const j="esri_en",w="Style",S="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"},283:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r,s=i(81),n=i(104),a=i(86),o=i(83),l=(i(79),i(84)),c=(i(80),i(82)),u=i(90);let h=r=class extends a.a{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,i){t[i]=null==e?0:e}clone(){return new r({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};Object(s.a)([Object(o.b)({type:n.a,json:{type:[l.a],write:!0}})],h.prototype,"color",void 0),Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],h.prototype,"label",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:{allowNull:!0}}})],h.prototype,"value",void 0),Object(s.a)([Object(u.a)("value")],h.prototype,"writeValue",null),h=r=Object(s.a)([Object(c.a)("esri.renderers.visualVariables.support.ColorStop")],h);var p=h},284:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r,s=i(81),n=i(103),a=i(86),o=i(83),l=(i(79),i(84),i(80),i(82)),c=i(127);let u=r=class extends a.a{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new r({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],u.prototype,"description",void 0),Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],u.prototype,"label",void 0),Object(s.a)([Object(o.b)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],u.prototype,"minValue",void 0),Object(s.a)([Object(o.b)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],u.prototype,"maxValue",void 0),Object(s.a)([Object(o.b)({types:n.i,json:{origins:{"web-scene":{types:n.j,write:c.b}},write:c.b}})],u.prototype,"symbol",void 0),u=r=Object(s.a)([Object(l.a)("esri.renderers.support.ClassBreakInfo")],u);var h=u},285:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s}));var r=i(135);function s(e){return e=e||r.a.location.hostname,u.some((t=>{var i;return null!=(null==(i=e)?void 0:i.match(t))}))}function n(e,t){return e&&(t=t||r.a.location.hostname)?null!=t.match(a)||null!=t.match(l)?e.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(o)||null!=t.match(c)?e.replace("static.arcgis.com","staticqa.arcgis.com"):e:e}const a=/^devext.arcgis.com$/,o=/^qaext.arcgis.com$/,l=/^[\w-]*\.mapsdevext.arcgis.com$/,c=/^[\w-]*\.mapsqa.arcgis.com$/,u=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,a,o,/^jsapps.esri.com$/,l,c]},292:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r,s=i(81),n=i(87),a=i(83),o=(i(84),i(79),i(80),i(82)),l=i(213),c=i(167);let u=r=class extends c.a{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new r({colorRamps:Object(n.a)(this.colorRamps)})}};Object(s.a)([Object(a.b)({type:[l.a],json:{write:!0}})],u.prototype,"colorRamps",void 0),Object(s.a)([Object(a.b)({type:["multipart"]})],u.prototype,"type",void 0),u=r=Object(s.a)([Object(o.a)("esri.rest.support.MultipartColorRamp")],u);var h=u},293:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r,s=i(81),n=i(83),a=(i(79),i(84),i(80),i(82)),o=i(221);let l=r=class extends o.a{constructor(){super(...arguments),this.customValues=null}clone(){return new r({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};Object(s.a)([Object(n.b)({type:[Number],json:{write:!0}})],l.prototype,"customValues",void 0),l=r=Object(s.a)([Object(a.a)("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],l);var c=l},294:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r,s=i(81),n=i(103),a=i(86),o=i(83),l=(i(79),i(84),i(80),i(82)),c=i(127);let u=r=class extends a.a{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new r({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol&&this.symbol.toJSON());return`${this.value}.${e}`}};Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],u.prototype,"description",void 0),Object(s.a)([Object(o.b)({type:String,json:{write:!0}})],u.prototype,"label",void 0),Object(s.a)([Object(o.b)({types:n.i,json:{origins:{"web-scene":{types:n.j,write:c.b}},write:c.b}})],u.prototype,"symbol",void 0),Object(s.a)([Object(o.b)({type:[String,Number],json:{type:String,write:{writer:(e,t)=>{t.value=null==e?void 0:e.toString()}}}})],u.prototype,"value",void 0),u=r=Object(s.a)([Object(l.a)("esri.renderers.support.UniqueValueInfo")],u);var h=u},295:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var r,s=i(81),n=i(89),a=i(86),o=i(87),l=i(83),c=i(84),u=(i(79),i(80),i(92)),h=i(82);let p=r=class extends a.a{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new r({minValue:this.minValue,maxValue:this.maxValue})}};Object(s.a)([Object(l.b)({type:Number,json:{write:!0}})],p.prototype,"minValue",void 0),Object(s.a)([Object(l.b)({type:Number,json:{write:!0}})],p.prototype,"maxValue",void 0),p=r=Object(s.a)([Object(h.a)("esri.renderer.support.AuthoringInfoClassBreakInfo")],p);var d,f=p;let y=d=class extends a.a{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new d({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:Object(o.a)(this.classBreakInfos)})}};Object(s.a)([Object(l.b)({type:String,json:{write:!0}})],y.prototype,"field",void 0),Object(s.a)([Object(l.b)({type:String,json:{write:!0}})],y.prototype,"normalizationField",void 0),Object(s.a)([Object(l.b)({type:String,json:{write:!0}})],y.prototype,"label",void 0),Object(s.a)([Object(l.b)({type:[f],json:{write:!0}})],y.prototype,"classBreakInfos",void 0),y=d=Object(s.a)([Object(h.a)("esri.renderers.support.AuthoringInfoFieldInfo")],y);var b,m=y,x=i(102);const g=new n.a({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),v=new n.a({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),O={key:e=>"number"==typeof e?"number":"string",typeMap:{number:Number,string:String},base:null},_=["high-to-low","above-and-below","centered-on","extremes"],j=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],w=["seconds","minutes","hours","days","months","years"];let S=b=class extends a.a{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return"string"==typeof e||"number"==typeof e?e:null}castStartTime(e){return"string"==typeof e||"number"==typeof e?e:null}get style(){return"color"===this.type?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new b({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};Object(s.a)([Object(l.b)({types:O,json:{write:!0}})],S.prototype,"endTime",void 0),Object(s.a)([Object(x.a)("endTime")],S.prototype,"castEndTime",null),Object(s.a)([Object(l.b)({type:String,json:{write:!0}})],S.prototype,"field",void 0),Object(s.a)([Object(l.b)({type:Number,json:{write:!0}})],S.prototype,"maxSliderValue",void 0),Object(s.a)([Object(l.b)({type:Number,json:{write:!0}})],S.prototype,"minSliderValue",void 0),Object(s.a)([Object(l.b)({types:O,json:{write:!0}})],S.prototype,"startTime",void 0),Object(s.a)([Object(x.a)("startTime")],S.prototype,"castStartTime",null),Object(s.a)([Object(l.b)({type:g.apiValues,value:null,json:{type:g.jsonValues,read:g.read,write:g.write}})],S.prototype,"style",null),Object(s.a)([Object(l.b)({type:j,value:null,json:{type:j,origins:{"web-scene":{type:_,write:{writer:(e,t)=>{_.indexOf(e)>-1&&(t.theme=e)}}}},write:!0}})],S.prototype,"theme",null),Object(s.a)([Object(l.b)({type:v.apiValues,json:{type:v.jsonValues,read:v.read,write:v.write}})],S.prototype,"type",void 0),Object(s.a)([Object(l.b)({type:w,json:{type:w,write:!0}})],S.prototype,"units",void 0),S=b=Object(s.a)([Object(h.a)("esri.renderers.support.AuthoringInfoVisualVariable")],S);var M,V=S,I=i(277);const T=new n.a({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),z=new n.a({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),k=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let C=M=class extends a.a{constructor(e){super(e),this.colorRamp=null,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){if(e)return Object(I.a)(e)}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(e){this._set("field2",e)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new M({classificationMethod:this.classificationMethod,colorRamp:Object(o.a)(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:Object(o.a)(this.field1),field2:Object(o.a)(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}};Object(s.a)([Object(l.b)({type:T.apiValues,value:null,json:{type:T.jsonValues,read:T.read,write:T.write,origins:{"web-document":{default:"manual",type:T.jsonValues,read:T.read,write:T.write}}}})],C.prototype,"classificationMethod",null),Object(s.a)([Object(l.b)({types:I.b,json:{write:!0}})],C.prototype,"colorRamp",void 0),Object(s.a)([Object(u.a)("colorRamp")],C.prototype,"readColorRamp",null),Object(s.a)([Object(l.b)({type:[String],value:null,json:{write:!0}})],C.prototype,"fields",null),Object(s.a)([Object(l.b)({type:m,value:null,json:{write:!0}})],C.prototype,"field1",null),Object(s.a)([Object(l.b)({type:m,value:null,json:{write:!0}})],C.prototype,"field2",null),Object(s.a)([Object(l.b)({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],C.prototype,"focus",null),Object(s.a)([Object(l.b)({type:Number,value:null,json:{type:c.a,write:!0}})],C.prototype,"numClasses",null),Object(s.a)([Object(l.b)({type:k,json:{type:k,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],C.prototype,"lengthUnit",void 0),Object(s.a)([Object(l.b)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],C.prototype,"maxSliderValue",void 0),Object(s.a)([Object(l.b)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],C.prototype,"minSliderValue",void 0),Object(s.a)([Object(l.b)({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],C.prototype,"statistics",null),Object(s.a)([Object(l.b)({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],C.prototype,"standardDeviationInterval",null),Object(s.a)([Object(l.b)({type:z.apiValues,value:null,json:{type:z.jsonValues,read:z.read,write:z.write}})],C.prototype,"type",null),Object(s.a)([Object(l.b)({type:[V],json:{write:!0}})],C.prototype,"visualVariables",void 0),Object(s.a)([Object(l.b)({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],C.prototype,"univariateSymbolStyle",null),Object(s.a)([Object(l.b)({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],C.prototype,"univariateTheme",null),C=M=Object(s.a)([Object(h.a)("esri.renderers.support.AuthoringInfo")],C);var P=C},307:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r,s=i(81),n=i(104),a=i(86),o=i(83),l=(i(79),i(84),i(80),i(82));let c=r=class extends a.a{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new r({color:this.color,ratio:this.ratio})}};Object(s.a)([Object(o.b)({type:n.a,json:{write:!0}})],c.prototype,"color",void 0),Object(s.a)([Object(o.b)({type:Number,json:{write:!0}})],c.prototype,"ratio",void 0),c=r=Object(s.a)([Object(l.a)("esri.renderers.support.HeatmapColorStop")],c);var u=c},319:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return u})),i.d(t,"c",(function(){return h})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return a})),i.d(t,"f",(function(){return o})),i.d(t,"g",(function(){return l})),i.d(t,"h",(function(){return c}));var r=i(195);function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function n(e,t){const i=t[0],r=t[1],s=t[2],n=t[3],a=t[4],o=t[5];let l=i*n-r*s;return l?(l=1/l,e[0]=n*l,e[1]=-r*l,e[2]=-s*l,e[3]=i*l,e[4]=(s*o-n*a)*l,e[5]=(r*a-i*o)*l,e):null}function a(e,t,i){const r=t[0],s=t[1],n=t[2],a=t[3],o=t[4],l=t[5],c=i[0],u=i[1],h=i[2],p=i[3],d=i[4],f=i[5];return e[0]=r*c+n*u,e[1]=s*c+a*u,e[2]=r*h+n*p,e[3]=s*h+a*p,e[4]=r*d+n*f+o,e[5]=s*d+a*f+l,e}function o(e,t,i){const r=t[0],s=t[1],n=t[2],a=t[3],o=t[4],l=t[5],c=Math.sin(i),u=Math.cos(i);return e[0]=r*u+n*c,e[1]=s*u+a*c,e[2]=r*-c+n*u,e[3]=s*-c+a*u,e[4]=o,e[5]=l,e}function l(e,t,i){const r=t[0],s=t[1],n=t[2],a=t[3],o=t[4],l=t[5],c=i[0],u=i[1];return e[0]=r*c,e[1]=s*c,e[2]=n*u,e[3]=a*u,e[4]=o,e[5]=l,e}function c(e,t,i){const r=t[0],s=t[1],n=t[2],a=t[3],o=t[4],l=t[5],c=i[0],u=i[1];return e[0]=r,e[1]=s,e[2]=n,e[3]=a,e[4]=r*c+n*u+o,e[5]=s*c+a*u+l,e}function u(e,t){const i=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=i,e[2]=-i,e[3]=r,e[4]=0,e[5]=0,e}function h(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function p(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e[4]=t[4]-i[4],e[5]=t[5]-i[5],e}const d=a,f=p;Object.freeze({__proto__:null,copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},identity:s,set:function(e,t,i,r,s,n,a){return e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=n,e[5]=a,e},invert:n,determinant:function(e){return e[0]*e[3]-e[1]*e[2]},multiply:a,rotate:o,scale:l,translate:c,fromRotation:u,fromScaling:h,fromTranslation:function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},str:function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},frob:function(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e[4]=t[4]+i[4],e[5]=t[5]+i[5],e},subtract:p,multiplyScalar:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*i,e[5]=t[5]*i,e},multiplyScalarAndAdd:function(e,t,i,r){return e[0]=t[0]+i[0]*r,e[1]=t[1]+i[1]*r,e[2]=t[2]+i[2]*r,e[3]=t[3]+i[3]*r,e[4]=t[4]+i[4]*r,e[5]=t[5]+i[5]*r,e},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},equals:function(e,t){const i=e[0],s=e[1],n=e[2],a=e[3],o=e[4],l=e[5],c=t[0],u=t[1],h=t[2],p=t[3],d=t[4],f=t[5];return Math.abs(i-c)<=r.a*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(s-u)<=r.a*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-h)<=r.a*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-p)<=r.a*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-d)<=r.a*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(l-f)<=r.a*Math.max(1,Math.abs(l),Math.abs(f))},mul:d,sub:f})},323:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i(85),s=i(149),n=i(449),a=i(385);class o{static executeEffects(e,t){const i=Object(s.c)(t);let r=new n.a(i);for(const s of e){const e=Object(a.a)(s);e&&(r=e.execute(r,s,1.3333333333333333))}return r}static next(e){const t=e.next();return Object(s.d)(t),t}}class l{bindFeature(e,t,i){}write(e,t,i){if(Object(r.j)(this._effects))return this._write(e,t);const s=o.executeEffects(this._effects,t.readLegacyGeometryForDisplay());let n=o.next(s);for(;n;)this._write(e,t,n),n=o.next(s)}_write(e,t,i){}}},325:function(e,t,i){"use strict";function r(e,t,i,r){return function(e){return"function"==typeof e}(e)?e(t,i,r):e}function s(e){return[e.r,e.g,e.b,e.a]}function n(e,t,i){const r=e=>{let t=e.length;for(;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},s=[];let n=0,o=-1;do{if(o=t.indexOf("[",n),o>=n){if(o>n){const e=t.substr(n,o-n);s.push([e,null,r(e)])}if(n=o+1,o=t.indexOf("]",n),o>=n){if(o>n){const i=e[t.substr(n,o-n)];i&&s.push([null,i,!1])}n=o+1}}}while(-1!==o);if(n<t.length-1){const e=t.substr(n);s.push([e,null,r(e)])}return e=>{let t="",r=null;for(const i of s){const[s,n,a]=i;if(s)a?r=s:(r&&(t+=r,r=null),t+=s);else{const i=e.attributes[n];i&&(r&&(t+=r,r=null),t+=i)}}return a(t,i)}}function a(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function o(e,t,i,r,s,n,a=!0){const o=t/s,l=i/n,c=Math.ceil(o/2),u=Math.ceil(l/2);for(let h=0;h<n;h++)for(let i=0;i<s;i++){const p=4*(i+(a?n-h-1:h)*s);let d=0,f=0,y=0,b=0,m=0,x=0,g=0;const v=(h+.5)*l;for(let r=Math.floor(h*l);r<(h+1)*l;r++){const s=Math.abs(v-(r+.5))/u,n=(i+.5)*o,a=s*s;for(let l=Math.floor(i*o);l<(i+1)*o;l++){let i=Math.abs(n-(l+.5))/c;const s=Math.sqrt(a+i*i);s>=-1&&s<=1&&(d=2*s*s*s-3*s*s+1,d>0&&(i=4*(l+r*t),g+=d*e[i+3],y+=d,e[i+3]<255&&(d=d*e[i+3]/250),b+=d*e[i],m+=d*e[i+1],x+=d*e[i+2],f+=d))}}r[p]=b/f,r[p+1]=m/f,r[p+2]=x/f,r[p+3]=g/y}}function l(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function c(e){var t;return null==(t=e.data)?void 0:t.symbol}function u(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function h(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function p(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function d(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return r})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return p})),i.d(t,"g",(function(){return u})),i.d(t,"h",(function(){return d})),i.d(t,"i",(function(){return h})),i.d(t,"j",(function(){return o})),i.d(t,"k",(function(){return c}))},326:function(e,t,i){"use strict";function r(){const e=new Float32Array(6);return e[0]=1,e[3]=1,e}function s(e,t,i,r){const s=t[r],n=t[r+1];e[r]=i[0]*s+i[2]*n+i[4],e[r+1]=i[1]*s+i[3]*n+i[5]}function n(e,t,i,r=0,n=0,a=2){const o=n||t.length/a;for(let l=r;l<o;l++)s(e,t,i,l*a)}i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));Object.freeze({__proto__:null,create:r,clone:function(e){const t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},fromValues:function(e,t,i,r,s,n){const a=new Float32Array(6);return a[0]=e,a[1]=t,a[2]=i,a[3]=r,a[4]=s,a[5]=n,a},createView:function(e,t){return new Float32Array(e,t,6)},transform:s,transformMany:n})},334:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r,s=i(81),n=i(83),a=(i(79),i(84),i(80),i(82)),o=i(186);let l=r=class extends o.a{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new r({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};Object(s.a)([Object(n.b)()],l.prototype,"image",void 0),l=r=Object(s.a)([Object(a.a)("esri.support.Action.ActionButton")],l);var c=l},347:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i(88);function s(e,t){if(e&&"name"in e){const i=e;return t&&t.error(new r.a(i.name,i.message,i.details)),!1}return!0}},358:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r,s=i(81),n=i(83),a=(i(79),i(84),i(80),i(82)),o=i(186);let l=r=class extends o.a{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new r({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};Object(s.a)([Object(n.b)()],l.prototype,"image",void 0),Object(s.a)([Object(n.b)()],l.prototype,"value",void 0),l=r=Object(s.a)([Object(a.a)("esri.support.Action.ActionToggle")],l);var c=l},408:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(e,t){this._pos=0;const i=t?this._roundToNearest(t,e.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new e(this._array),this._ctor=e,this._i16View=new Int16Array(this._array)}get length(){return this._pos}_roundToNearest(e,t){const i=Math.round(e);return i+(t-i%t)}_ensureSize(e){if(this._pos+e>=this._buffer.length){const t=this._roundToNearest(1.5*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),i=new ArrayBuffer(t),r=new this._ctor(i);r.set(this._buffer,0),this._array=i,this._buffer=r,this._i16View=new Int16Array(this._array)}}ensureSize(e){this._ensureSize(e)}writeF32(e){this._ensureSize(1);const t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}push(e){this._ensureSize(1);const t=this._pos;return this._buffer[this._pos++]=e,t}writeFixed(e){this._buffer[this._pos++]=e}setValue(e,t){this._buffer[e]=t}i1616Add(e,t,i){this._i16View[2*e]+=t,this._i16View[2*e+1]+=i}getValue(e){return this._buffer[e]}incr(e){if(this._buffer.length<e)throw new Error("Increment index overflows the target buffer");this._buffer[e]++}decr(e){this._buffer[e]--}writeRegion(e){this._ensureSize(e.length);const t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}writeManyFrom(e,t,i){this._ensureSize(i-t);for(let r=t;r!==i;r++)this.writeFixed(e._buffer[r])}buffer(){const e=this._array.slice(0,4*this._pos);return this.destroy(),e}toArray(){const e=this._array,t=[];for(let i=0;i<e.byteLength/4;i++)t.push(e[i]);return t}seek(e){this._pos=e}destroy(){this._array=null,this._buffer=null}}},416:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return o}));Number.POSITIVE_INFINITY;const r=Math.PI,s=128/r,n=1/Math.LN2;function a(e,t){return(e%=t)>=0?e:e+t}function o(e){return a(e*s,256)}function l(e){return a(.7111111111111111*e,256)}function c(e){return Math.log(e)*n}function u(e,t,i){return e>=t&&e<=i||e>=i&&e<=t}},430:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(88),s=i(80),n=i(344);function a(e,t,i,r,n){const a=e.referencesGeometry()&&n?l(t,r,n):t,o=e.repurposeFeature(a);try{return e.evaluate({...i,$feature:o})}catch(c){return s.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",c),null}}const o=new Map;function l(e,t,i){const{transform:a,hasZ:l,hasM:c}=i;o.has(t)||o.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,i,r,s)=>Object(n.e)(i,t,e,r,s);case"esriGeometryPolygon":return(e,i,r,s)=>Object(n.f)(i,t,e,r,s);case"esriGeometryPolyline":return(e,i,r,s)=>Object(n.g)(i,t,e,r,s);case"esriGeometryMultipoint":return(e,i,r,s)=>Object(n.d)(i,t,e,r,s);default:return s.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r.a("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const u=o.get(t)(e.geometry,a,l,c);return{...e,geometry:u}}},441:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l}));var r=i(160),s=i(79);let n=null,a=null;async function o(){return n||(n=async function(){const e=Object(s.a)("csp-restrictions")?await Promise.all([i.e(154),i.e(243)]).then(i.bind(null,737)).then((function(e){return e.l})):await i.e(181).then(i.bind(null,738)).then((function(e){return e.l}));a=await e.load({locateFile:()=>Object(r.a)("esri/core/libs/libtess/libtess.wasm")})}()),n}function l(e,t){const i=Math.max(e.length,128e3);return a.triangulate(e,t,i)}},450:function(e,t,i){"use strict";i.d(t,"a",(function(){return N})),i.d(t,"b",(function(){return g}));var r=i(104),s=i(80),n=i(100),a=i(142),o=i(123),l=i(369),c=i(548),u=i(325),h=i(430);const p=s.a.getLogger("esri.symbols.cim.cimAnalyzer");function d(e){switch(e){case"Butt":return 0;case"Square":return 2;default:return 1}}function f(e){switch(e){case"Bevel":return 0;case"Miter":return 2;default:return 1}}function y(e){switch(e){default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function b(e){switch(e){default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function m(e,t,i,r){let s;e[t]?s=e[t]:(s={},e[t]=s),s[i]=r}function x(e){const t=e.markerPlacement;return t&&t.angleToLine?1:0}async function g(e,t,i,r){const s=null!=i?i:[];if(!e)return s;let n,a;const c={};if("CIMSymbolReference"!==e.type)return p.error("Expect cim type to be 'CIMSymbolReference'"),s;if(n=e.symbol,a=e.primitiveOverrides,a){const e=[];for(const i of a){const r=i.valueExpressionInfo;if(r&&t){const s=r.expression,n=Object(o.d)(s,t.spatialReference,t.fields).then((e=>{e&&m(c,i.primitiveName,i.propertyName,e)}));e.push(n)}else null!=i.value&&m(c,i.primitiveName,i.propertyName,i.value)}await Promise.all(e)}switch(n.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(e,t,i,r,s,n){if(!e)return;const a=e.symbolLayers;if(!a)return;let o;const c=l.a.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(o=1);let u=a.length;for(;u--;){const h=a[u];if(!h||!1===h.enable)continue;const d=[];switch(l.b.findApplicableOverrides(h,t,d),h.type){case"CIMSolidFill":v(h,i,d,r,s);break;case"CIMPictureFill":O(h,i,d,r,s);break;case"CIMHatchFill":_(h,i,d,r,s);break;case"CIMGradientFill":j(h,i,d,r,s);break;case"CIMSolidStroke":w(h,i,d,r,s,"CIMPolygonSymbol"===e.type,c);break;case"CIMPictureStroke":S(h,i,d,r,s,"CIMPolygonSymbol"===e.type,c);break;case"CIMGradientStroke":M(h,i,d,r,s,"CIMPolygonSymbol"===e.type,c);break;case"CIMCharacterMarker":if(V(h,i,d,r,s))break;break;case"CIMPictureMarker":if(V(h,i,d,r,s))break;"CIMLineSymbol"===e.type&&(o=x(h)),I(h,i,d,r,s,o,c);break;case"CIMVectorMarker":if(V(h,i,d,r,s))break;"CIMLineSymbol"===e.type&&(o=x(h)),T(h,i,d,r,s,o,c,n);break;default:p.error("Cannot analyze CIM layer",h.type)}}}(n,a,c,t,s,r)}return s}function v(e,t,i,r,s){const n=e.primitiveName,o=Object(u.e)(e.color),[l,c]=R(i,n),h=Object(a.b)(JSON.stringify(e)+c).toString();s.push({type:"fill",templateHash:h,materialHash:l?()=>h:h,cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:E(n,t,"Color",r,o,L),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function O(e,t,i,r,s){const n=e.primitiveName,o=e.tintColor?Object(u.e)(e.tintColor):{r:255,g:255,b:255,a:1},[l,c]=R(i,n),h=Object(a.b)(JSON.stringify(e)+c).toString(),p=Object(a.b)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString();s.push({type:"fill",templateHash:h,materialHash:l?()=>p:p,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:E(n,t,"TintColor",r,o,L),height:E(n,t,"Height",r,e.height),scaleX:E(n,t,"ScaleX",r,e.scaleX),angle:E(n,t,"Rotation",r,e.rotation),offsetX:E(n,t,"OffsetX",r,e.offsetX),offsetY:E(n,t,"OffsetY",r,e.offsetY)})}function _(e,t,i,r,s){const n=["Rotation","OffsetX","OffsetY"],o=i.filter((t=>t.primitiveName!==e.primitiveName&&-1===n.indexOf(t.propertyName))),l=e.primitiveName,[c,u]=R(i,l),h=Object(a.b)(JSON.stringify(e)+u).toString(),p=Object(a.b)(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();s.push({type:"fill",templateHash:h,materialHash:c?F(p,t,o,r):p,cim:e,materialOverrides:o,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:E(l,t,"Separation",r,e.separation),scaleX:1,angle:E(l,t,"Rotation",r,e.rotation),offsetX:E(l,t,"OffsetX",r,e.offsetX),offsetY:E(l,t,"OffsetY",r,e.offsetY)})}function j(e,t,i,r,s){const n=e.primitiveName,[o,l]=R(i,n),c=Object(a.b)(JSON.stringify(e)+l).toString();s.push({type:"fill",templateHash:c,materialHash:o?F(c,t,i,r):c,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function w(e,t,i,r,s,n,o){const l=e.primitiveName,c=Object(u.e)(e.color),h=void 0!==e.width?e.width:4,p=d(e.capStyle),y=f(e.joinStyle),b=e.miterLimit,[m,x]=R(i,l),g=Object(a.b)(JSON.stringify(e)+x).toString();s.push({type:"line",templateHash:g,materialHash:m?()=>g:g,cim:e,materialOverrides:null,isOutline:n,colorLocked:e.colorLocked,effects:e.effects,color:E(l,t,"Color",r,c,L),width:E(l,t,"Width",r,h),cap:E(l,t,"CapStyle",r,p),join:E(l,t,"JoinStyle",r,y),miterLimit:E(l,t,"MiterLimit",r,b),referenceWidth:o,zOrder:P(e.name),isDashed:!1})}function S(e,t,i,r,s,n,o){const l=Object(a.b)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),c=e.primitiveName,h=Object(u.e)(e.tintColor),p=void 0!==e.width?e.width:4,y=d(e.capStyle),b=f(e.joinStyle),m=e.miterLimit,[x,g]=R(i,c),v=Object(a.b)(JSON.stringify(e)+g).toString();s.push({type:"line",templateHash:v,materialHash:x?()=>l:l,cim:e,materialOverrides:null,isOutline:n,colorLocked:e.colorLocked,effects:e.effects,color:E(c,t,"TintColor",r,h,L),width:E(c,t,"Width",r,p),cap:E(c,t,"CapStyle",r,y),join:E(c,t,"JoinStyle",r,b),miterLimit:E(c,t,"MiterLimit",r,m),referenceWidth:o,zOrder:P(e.name),isDashed:!1})}function M(e,t,i,r,s,n,o){const l=e.primitiveName,c=void 0!==e.width?e.width:4,u=d(e.capStyle),h=f(e.joinStyle),p=e.miterLimit,[y,b]=R(i,l),m=Object(a.b)(JSON.stringify(e)+b).toString();s.push({type:"line",templateHash:m,materialHash:y?F(m,t,i,r):m,cim:e,materialOverrides:null,isOutline:n,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:E(l,t,"Width",r,c),cap:E(l,t,"CapStyle",r,u),join:E(l,t,"JoinStyle",r,h),miterLimit:E(l,t,"MiterLimit",r,p),referenceWidth:o,zOrder:P(e.name),isDashed:!1})}function V(e,t,i,r,s){const n=e.markerPlacement;if(!n||"CIMMarkerPlacementInsidePolygon"!==n.type)return!1;const o=n,l=["Rotation","OffsetX","OffsetY"],c=i.filter((t=>t.primitiveName!==e.primitiveName&&-1===l.indexOf(t.propertyName))),[u,h]=R(i,o.primitiveName),p=Object(a.b)(JSON.stringify(e)+h).toString();return s.push({type:"fill",templateHash:p,materialHash:u?F(p,t,c,r):p,cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:E(o.primitiveName,t,"StepY",r,o.stepY),scaleX:1,angle:E(o.primitiveName,t,"GridAngle",r,o.gridAngle),offsetX:E(o.primitiveName,t,"OffsetX",r,o.offsetX),offsetY:E(o.primitiveName,t,"OffsetY",r,o.offsetY)}),!0}function I(e,t,i,r,s,n,o){const l=e.primitiveName,c=e.size,h=e.scaleX,p=e.rotation,d=e.offsetX,f=e.offsetY,y=e.tintColor?Object(u.e)(e.tintColor):{r:255,g:255,b:255,a:1},b=Object(a.b)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),[m,x]=R(i,l),g=Object(a.b)(JSON.stringify(e)+x).toString();s.push({type:"marker",templateHash:g,materialHash:m?()=>b:b,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:n,size:E(l,t,"Size",r,c),scaleX:E(l,t,"ScaleX",r,h),rotation:E(l,t,"Rotation",r,p),offsetX:E(l,t,"OffsetX",r,d),offsetY:E(l,t,"OffsetY",r,f),color:E(l,t,"TintColor",r,y,L),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:o,sizeRatio:1,markerPlacement:e.markerPlacement})}function T(e,t,i,r,s,n,a,o){const l=e.markerGraphics;if(!l)return;let c=0;if(e.scaleSymbolsProportionally){const t=e.frame;t&&(c=t.ymax-t.ymin)}for(const u of l)if(u){const l=u.symbol;if(!l)continue;switch(l.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":k(e,u,i,t,r,s,n,a,c,o);break;case"CIMTextSymbol":z(e,u,t,i,r,s,n,a,c)}}}function z(e,t,i,r,s,n,o,c,h){l.b.findApplicableOverrides(t,r,[]);const p=t.geometry;if(!("x"in p)||!("y"in p))return;const d=t.symbol,f=function(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}(d),m=function(e){let t="normal",i="normal";if(e){const r=e.toLowerCase();-1!==r.indexOf("italic")?t="italic":-1!==r.indexOf("oblique")&&(t="oblique"),-1!==r.indexOf("bold")?i="bold":-1!==r.indexOf("light")&&(i="lighter")}return{style:t,weight:i}}(d.fontStyleName);d.font={family:d.fontFamilyName,decoration:f,...m};const x=e.frame,g=p.x-.5*(x.xmin+x.xmax),v=p.y-.5*(x.ymin+x.ymax),O=e.size/h,_=e.primitiveName,j=(d.height||0)*O,w=d.angle||0,S=((d.offsetX||0)+g)*O,M=((d.offsetY||0)+v)*O,V=Object(u.e)(l.a.getFillColor(d));let I=Object(u.e)(l.a.getStrokeColor(d)),T=l.a.getStrokeWidth(d);T||(I=Object(u.e)(l.a.getFillColor(d.haloSymbol)),T=d.haloSize*O);let z="";for(const a of r)a.primitiveName===_&&void 0!==a.value&&(z+=`-${a.primitiveName}-${a.propertyName}-${JSON.stringify(a.value)}`);const k=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),C=Object(a.b)(JSON.stringify(t)+k+z).toString();n.push({type:"text",templateHash:C,materialHash:()=>Object(a.b)(JSON.stringify(d.font)).toString(),cim:d,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:o,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:d.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:E(_,i,"Size",s,j),angle:E(_,i,"Rotation",s,w),offsetX:E(_,i,"OffsetX",s,S),offsetY:E(_,i,"OffsetY",s,M),horizontalAlignment:y(d.horizontalAlignment),verticalAlignment:b(d.verticalAlignment),text:E(t.primitiveName,i,"TextString",s,t.textString,u.a,d.textCase),color:V,outlineColor:I,outlineSize:T,referenceSize:c,sizeRatio:1,markerPlacement:e.markerPlacement})}function k(e,t,i,r,s,n,o,h,p,d){const f=t.symbol,y=t.geometry;if(!y)return;const b=f.symbolLayers;if(!b)return;if(d)return void C(e,t,r,i,s,n,o,h,p);let m=b.length;for(;m--;){const d=b[m];if(d&&!1!==d.enable)switch(d.type){case"CIMSolidFill":case"CIMSolidStroke":{const f=Object(c.b)(y);if(!f)continue;const[b,m,x]=Object(c.d)(f,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),g="CIMSolidFill"===d.type,v={type:"sdf",geom:y,asFill:g},O=e.primitiveName,_=e.size,j=e.rotation||0,w=e.offsetX,S=e.offsetY,M=d.primitiveName,V=Object(u.e)(g?l.a.getFillColor(d):l.a.getStrokeColor(d)),I=g?{r:0,g:0,b:0,a:0}:Object(u.e)(l.a.getStrokeColor(d)),T=l.a.getStrokeWidth(d);if(!g&&!T)break;let z=!1,k="";for(const e of i)e.primitiveName!==M&&e.primitiveName!==O||(void 0!==e.value?k+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(z=!0));const C=JSON.stringify({...e,markerGraphics:null}),P=Object(a.b)(JSON.stringify(v)).toString(),F={type:"marker",templateHash:Object(a.b)(JSON.stringify(t)+JSON.stringify(d)+C+k).toString(),materialHash:z?()=>P:P,cim:v,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:m,y:x},isAbsoluteAnchorPoint:!1,size:E(e.primitiveName,r,"Size",s,_),rotation:E(e.primitiveName,r,"Rotation",s,j),offsetX:E(e.primitiveName,r,"OffsetX",s,w),offsetY:E(e.primitiveName,r,"OffsetY",s,S),scaleX:1,frameHeight:p,rotateClockwise:e.rotateClockwise,referenceSize:h,sizeRatio:b,color:E(M,r,"Color",s,V,L),outlineColor:E(M,r,"Color",s,I,L),outlineWidth:E(M,r,"Width",s,T),markerPlacement:e.markerPlacement};n.push(F);break}default:C(e,t,r,i,s,n,o,h,p)}}}function C(e,t,i,r,s,o,c,u,h){const p=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}(e,t);let d=[];const f=["Rotation","OffsetX","OffsetY"];d=r.filter((t=>t.primitiveName!==e.primitiveName||-1===f.indexOf(t.propertyName)));let y="";for(const n of r)void 0!==n.value&&(y+=`-${n.primitiveName}-${n.propertyName}-${JSON.stringify(n.value)}`);const[b,m,x]=l.a.getTextureAnchor(p),g=e.primitiveName,v=e.rotation||0,O=e.offsetX||0,_=e.offsetY||0,j=Object(a.b)(JSON.stringify(p)+y).toString(),w={type:"marker",templateHash:j,materialHash:0===d.length?j:F(j,i,d,s),cim:p,materialOverrides:d,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:c,anchorPoint:{x:b,y:m},isAbsoluteAnchorPoint:!1,size:e.size,rotation:E(g,i,"Rotation",s,v),offsetX:E(g,i,"OffsetX",s,O),offsetY:E(g,i,"OffsetY",s,_),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:h,rotateClockwise:e.rotateClockwise,referenceSize:u,sizeRatio:x/Object(n.h)(e.size),markerPlacement:e.markerPlacement};o.push(w)}function P(e){if(e&&0===e.indexOf("Level_")){const t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function L(e){if(!e||0===e.length)return null;const t=new r.a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function E(e,t,i,r,s,n,a){const l=t[e];if(l){const e=l[i];if("string"==typeof e||"number"==typeof e||e instanceof Array)return n?n.call(null,e,a):e;if(null!=e&&e instanceof o.a)return(t,i,o)=>{let l=Object(h.a)(e,t,{$view:o},r.geometryType,i);return null!==l&&n&&(l=n.call(null,l,a)),null!==l?l:s}}return s}function F(e,t,i,r){for(const s of i)if(s.valueExpressionInfo){const e=t[s.primitiveName]&&t[s.primitiveName][s.propertyName];e instanceof o.a&&(s.fn=(t,i,s)=>Object(h.a)(e,t,{$view:s},r.geometryType,i))}return(t,r,s)=>{for(const e of i)e.fn&&(e.value=e.fn(t,r,s));return Object(a.b)(e+l.b.buildOverrideKey(i)).toString()}}function N(e,t){if(!t||0===t.length)return e;const i=JSON.parse(JSON.stringify(e));return l.b.applyOverrides(i,t),i}function R(e,t){let i=!1,r="";for(const s of e)s.primitiveName===t&&(void 0!==s.value?r+=`-${s.primitiveName}-${s.propertyName}-${JSON.stringify(s.value)}`:s.valueExpressionInfo&&(i=!0));return[i,r]}},460:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var r,s,n,a={exports:{}};r=a,s=function(){function e(e,i,s){s=s||2;var n,a,o,c,u,h,p,d=i&&i.length,f=d?i[0]*s:e.length,y=t(e,0,f,s,!0),b=[];if(!y||y.next===y.prev)return b;if(d&&(y=l(e,i,y,s)),e.length>80*s){n=o=e[0],a=c=e[1];for(var m=s;m<f;m+=s)(u=e[m])<n&&(n=u),(h=e[m+1])<a&&(a=h),u>o&&(o=u),h>c&&(c=h);p=0!==(p=Math.max(o-n,c-a))?1/p:0}return r(y,b,s,n,a,p),b}function t(e,t,i,r,s){var n,a;if(s===I(e,t,i,r)>0)for(n=t;n<i;n+=r)a=S(n,e[n],e[n+1],a);else for(n=i-r;n>=t;n-=r)a=S(n,e[n],e[n+1],a);if(a&&g(a,a.next)){var o=a.next;M(a),a=o}return a}function i(e,t){if(!e)return e;t||(t=e);var i,r=e;do{if(i=!1,r.steiner||!g(r,r.next)&&0!==x(r.prev,r,r.next))r=r.next;else{var s=r.prev;if(M(r),(r=t=s)===r.next)break;i=!0}}while(i||r!==t);return t}function r(e,t,l,c,u,h,p){if(e){!p&&h&&d(e,c,u,h);for(var f,y,b=e;e.prev!==e.next;)if(f=e.prev,y=e.next,h?n(e,c,u,h):s(e))t.push(f.i/l),t.push(e.i/l),t.push(y.i/l),M(e),e=y.next,b=y.next;else if((e=y)===b){p?1===p?r(e=a(i(e),t,l),t,l,c,u,h,2):2===p&&o(e,t,l,c,u,h):r(i(e),t,l,c,u,h,1);break}}}function s(e){var t=e.prev,i=e,r=e.next;if(x(t,i,r)>=0)return!1;for(var s=e.next.next;s!==e.prev;){if(b(t.x,t.y,i.x,i.y,r.x,r.y,s.x,s.y)&&x(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function n(e,t,i,r){var s=e.prev,n=e,a=e.next;if(x(s,n,a)>=0)return!1;for(var o=s.x<n.x?s.x<a.x?s.x:a.x:n.x<a.x?n.x:a.x,l=s.y<n.y?s.y<a.y?s.y:a.y:n.y<a.y?n.y:a.y,c=s.x>n.x?s.x>a.x?s.x:a.x:n.x>a.x?n.x:a.x,u=s.y>n.y?s.y>a.y?s.y:a.y:n.y>a.y?n.y:a.y,h=f(o,l,t,i,r),p=f(c,u,t,i,r),d=e.prevZ,y=e.nextZ;d&&d.z>=h&&y&&y.z<=p;){if(d!==e.prev&&d!==e.next&&b(s.x,s.y,n.x,n.y,a.x,a.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,y!==e.prev&&y!==e.next&&b(s.x,s.y,n.x,n.y,a.x,a.y,y.x,y.y)&&x(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&b(s.x,s.y,n.x,n.y,a.x,a.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;y&&y.z<=p;){if(y!==e.prev&&y!==e.next&&b(s.x,s.y,n.x,n.y,a.x,a.y,y.x,y.y)&&x(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function a(e,t,r){var s=e;do{var n=s.prev,a=s.next.next;!g(n,a)&&v(n,s,s.next,a)&&j(n,a)&&j(a,n)&&(t.push(n.i/r),t.push(s.i/r),t.push(a.i/r),M(s),M(s.next),s=e=a),s=s.next}while(s!==e);return i(s)}function o(e,t,s,n,a,o){var l=e;do{for(var c=l.next.next;c!==l.prev;){if(l.i!==c.i&&m(l,c)){var u=w(l,c);return l=i(l,l.next),u=i(u,u.next),r(l,t,s,n,a,o),void r(u,t,s,n,a,o)}c=c.next}l=l.next}while(l!==e)}function l(e,r,s,n){var a,o,l,u=[];for(a=0,o=r.length;a<o;a++)(l=t(e,r[a]*n,a<o-1?r[a+1]*n:e.length,n,!1))===l.next&&(l.steiner=!0),u.push(y(l));for(u.sort(c),a=0;a<u.length;a++)s=i(s=h(u[a],s),s.next);return s}function c(e,t){return e.x-t.x}function u(e){if(e.next.prev===e)return e;let t=e;for(;;){const i=t.next;if(i.prev===t||i===t||i===e)break;t=i}return t}function h(e,t){var r=function(e,t){var i,r=t,s=e.x,n=e.y,a=-1/0;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var o=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(o<=s&&o>a){if(a=o,o===s){if(n===r.y)return r;if(n===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!i)return null;if(s===a)return i;var l,c=i,u=i.x,h=i.y,d=1/0;r=i;do{s>=r.x&&r.x>=u&&s!==r.x&&b(n<h?s:a,n,u,h,n<h?a:s,n,r.x,r.y)&&(l=Math.abs(n-r.y)/(s-r.x),j(r,e)&&(l<d||l===d&&(r.x>i.x||r.x===i.x&&p(i,r)))&&(i=r,d=l)),r=r.next}while(r!==c);return i}(e,t);if(!r)return t;var s=w(r,e),n=i(r,r.next);let a=u(s);return i(a,a.next),n=u(n),u(t===r?n:t)}function p(e,t){return x(e.prev,e,t.prev)<0&&x(t.next,e,e.next)<0}function d(e,t,i,r){var s=e;do{if(null===s.z&&(s.z=f(s.x,s.y,t,i,r)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,d(e,t,i,r);s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,function(e){var t,i,r,s,n,a,o,l,c=1;do{for(i=e,e=null,n=null,a=0;i;){for(a++,r=i,o=0,t=0;t<c&&(o++,r=r.nextZ);t++);for(l=c;o>0||l>0&&r;)0!==o&&(0===l||!r||i.z<=r.z)?(s=i,i=i.nextZ,o--):(s=r,r=r.nextZ,l--),n?n.nextZ=s:e=s,s.prevZ=n,n=s;i=r}n.nextZ=null,c*=2}while(a>1)}(s)}function f(e,t,i,r,s){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*s)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*s)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function y(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function b(e,t,i,r,s,n,a,o){return(s-a)*(t-o)-(e-a)*(n-o)>=0&&(e-a)*(r-o)-(i-a)*(t-o)>=0&&(i-a)*(n-o)-(s-a)*(r-o)>=0}function m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&v(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(j(e,t)&&j(t,e)&&function(e,t){var i=e,r=!1,s=(e.x+t.x)/2,n=(e.y+t.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}(e,t)&&(x(e.prev,e,t.prev)||x(e,t.prev,t))||g(e,t)&&x(e.prev,e,e.next)>0&&x(t.prev,t,t.next)>0)}function x(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function g(e,t){return e.x===t.x&&e.y===t.y}function v(e,t,i,r){var s=_(x(e,t,i)),n=_(x(e,t,r)),a=_(x(i,r,e)),o=_(x(i,r,t));return s!==n&&a!==o||!(0!==s||!O(e,i,t))||!(0!==n||!O(e,r,t))||!(0!==a||!O(i,e,r))||!(0!==o||!O(i,t,r))}function O(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function _(e){return e>0?1:e<0?-1:0}function j(e,t){return x(e.prev,e,e.next)<0?x(e,t,e.next)>=0&&x(e,e.prev,t)>=0:x(e,t,e.prev)<0||x(e,e.next,t)<0}function w(e,t){var i=new V(e.i,e.x,e.y),r=new V(t.i,t.x,t.y),s=e.next,n=t.prev;return e.next=t,t.prev=e,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}function S(e,t,i,r){var s=new V(e,t,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function M(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function V(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(e,t,i,r){for(var s=0,n=t,a=i-r;n<i;n+=r)s+=(e[a]-e[n])*(e[n+1]+e[a+1]),a=n;return s}return e.deviation=function(e,t,i,r){var s=t&&t.length,n=s?t[0]*i:e.length,a=Math.abs(I(e,0,n,i));if(s)for(var o=0,l=t.length;o<l;o++){var c=t[o]*i,u=o<l-1?t[o+1]*i:e.length;a-=Math.abs(I(e,c,u,i))}var h=0;for(o=0;o<r.length;o+=3){var p=r[o]*i,d=r[o+1]*i,f=r[o+2]*i;h+=Math.abs((e[p]-e[f])*(e[d+1]-e[p+1])-(e[p]-e[d])*(e[f+1]-e[p+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},e.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},r=0,s=0;s<e.length;s++){for(var n=0;n<e[s].length;n++)for(var a=0;a<t;a++)i.vertices.push(e[s][n][a]);s>0&&(r+=e[s-1].length,i.holes.push(r))}return i},e},void 0!==(n=s())&&(r.exports=n);var o=a.exports},461:function(e,t,i){"use strict";function r(e){const t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}i.d(t,"a",(function(){return r}))},482:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var r=i(100),s=i(320),n=i(206),a=i(117),o=i(159),l=i(161),c=i(224),u=i(483),h=i(323),p=i(389);class d extends(Object(u.a)(h.a)){constructor(e,t,i,n,c,u,h,p,d,f,y,b,m,x,g,v,O,_=!1,j,w){super(),this._xOffset=Object(r.h)(b),this._yOffset=Object(r.h)(m),this._decoration=d||"none",this._color=n,this._haloColor=c,this._haloSize=Math.min(Math.floor(5*Object(r.h)(Object(r.k)(i))),127),this._size=Math.min(Math.round(Object(r.h)(t)),127);const S=Math.min(Math.round(Object(r.h)(t)),127);this._referenceSize=Math.round(Math.sqrt(256*S)),this._scale=this._size/24,this._angle=y,this._justify=Object(s.c)(u||"center"),this._xAlignD=Object(s.d)(u||"center"),this._yAlignD=Object(s.f)(h||"baseline"),this._baseline="baseline"===(h||"baseline"),this._bitset=(1===p?1:0)|(f?1:0)<<1;const M=l.e.load(e);M.sdf=!0,this._materialKey=M.data,this._lineWidth=Object(r.h)(x)||512,this._lineHeight=g||1,this._textPlacement=v,this._effects=O,this._isCIM=_,this._minMaxZoom=Object(o.a)(Math.round(j*a.l),Math.round(w*a.l))}static fromText(e,t){const i=new d(e.materialKey,e.font.size,e.haloSize||0,e.color&&Object(n.d)(e.color)||0,e.haloColor&&Object(n.d)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1,c.b,c.a),[,r]=Object(p.a)(e.text);return i.bindTextInfo(t,r),i._vertexBoundsScale=e.maxVVSize?e.maxVVSize/e.font.size:1,i}static fromCIMText(e,t,i){const r=e.scaleFactor||1,s=e.size*e.sizeRatio*r,[a,o]=Object(c.e)(e.scaleInfo,i),l=new d(e.materialKey,s,e.outlineSize*e.sizeRatio,Object(n.c)(e.color),Object(n.c)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*r,e.offsetY*e.sizeRatio*r,512,1,e.markerPlacement,e.effects,!0,a,o),[,u]=Object(p.a)(e.text);return l.bindTextInfo(t,u),l._vertexBoundsScale=e.maxVVSize?e.maxVVSize/s:1,l}}},483:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(85),s=i(100),n=i(166),a=i(484),o=i(117),l=i(130),c=i(159),u=i(161),h=i(491);const p=e=>class extends e{constructor(...e){super(...e),this._isCIM=!1,this._vertexBoundsScale=1,this.geometryType=l.d.TEXT,this._aux=Object(c.b)(0,0,this._referenceSize,this._bitset)}bindTextInfo(e,t){e&&e.length?this._shapingInfo=Object(r.b)(e,(e=>Object(h.a)(e,t,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,512)),lineHeight:o.j*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM}))):this._shapingInfo=null}_write(e,t,i){const r=t.getDisplayId();this._writeGeometry(e,t,r,i)}_writeGeometry(e,t,i,s){const a=this._shapingInfo;if(Object(r.j)(a))return;if(Object(r.k)(this._textPlacement)){const r=null!=s?s:t.readLegacyGeometryForDisplay();return this._writePlacedText(e,i,r,a)}const o=s?Object(n.p)(Object(n.d)(s),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(!Object(r.j)(o)){if(o.isPoint){const[t,r]=o.coords;return this._writeGlyphs(e,i,{x:t,y:r},a)}o.forEachVertex(((t,r)=>this._writeGlyphs(e,i,{x:t,y:r},a)))}}_writePlacedText(e,t,i,n){const o=Object(r.s)(this._textPlacement),l=a.a.getPlacement(i,o,Object(s.h)(1));if(!l)return;let c=l.next();for(;null!=c;){const i=c.getAngle();n.setRotation(i);const r=c.tx,s=c.ty;r<0||r>=512||s<0||s>=512||(this._writeGlyphs(e,t,{x:r,y:s},n),n.setRotation(-i)),c=l.next()}}_writeGlyphs(e,t,i,r){const s=u.e.load(this._materialKey),n=Object(c.a)(Math.round(8*i.x),Math.round(8*i.y)),a=this._vertexBoundsScale,o=r.bounds,l=2*Math.max(o.width,o.height);for(const c of r.glyphs)s.textureBinding=c.textureBinding,e.recordStart(t,s.data,this.geometryType,!1,!0),e.vertexBounds(i.x+o.x+this._xOffset,i.y+o.y-this._yOffset,l*a,l*a),this._writeVertices(e,t,n,c),e.recordEnd()}_writeGlyph(e,t,i,r,s){const n=u.e.load(this._materialKey),a=Object(c.a)(Math.round(8*i),Math.round(8*r));n.textureBinding=s.textureBinding,e.recordStart(t,n.data,this.geometryType,!1,!0);const o=s.bounds,l=this._vertexBoundsScale;e.vertexBounds(i+o.x*l,r+o.y*l,o.width*l,o.height*l),this._writeVertices(e,t,a,s),e.recordEnd()}_writeVertices(e,t,i,r){const s=e.vertexCount();this._writeVertexCommon(e,t,i,r),e.vertexWrite(r.offsets.upperLeft),e.vertexWrite(r.texcoords.upperLeft),e.vertexEnd(),this._writeVertexCommon(e,t,i,r),e.vertexWrite(r.offsets.upperRight),e.vertexWrite(r.texcoords.upperRight),e.vertexEnd(),this._writeVertexCommon(e,t,i,r),e.vertexWrite(r.offsets.lowerLeft),e.vertexWrite(r.texcoords.lowerLeft),e.vertexEnd(),this._writeVertexCommon(e,t,i,r),e.vertexWrite(r.offsets.lowerRight),e.vertexWrite(r.texcoords.lowerRight),e.vertexEnd(),e.indexWrite(s+0),e.indexWrite(s+1),e.indexWrite(s+2),e.indexWrite(s+1),e.indexWrite(s+3),e.indexWrite(s+2)}_writeVertexCommon(e,t,i,r){const s=this._color,n=this._haloColor,a=Object(c.b)(0,0,this._referenceSize,this._bitset),o=Object(c.b)(0,0,this._size,this._haloSize);e.vertexWrite(i),e.vertexWrite(t),e.vertexWrite(s),e.vertexWrite(n),e.vertexWrite(o),e.vertexWrite(a),e.vertexWrite(this._minMaxZoom)}}},484:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(149),s=i(385);class n{static getPlacement(e,t,i){const n=Object(s.b)(t);if(!n)return null;const a=Object(r.c)(e);return n.execute(a,t,i)}}},485:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(85),s=i(100),n=i(326),a=i(229),o=i(206),l=i(117),c=i(159),u=i(161),h=i(224),p=i(486),d=i(323);class f extends(Object(p.a)(d.a)){constructor(e,t,i,r,s,o,h,p,d,f,y,b,m,x,g,v,O,_,j,w,S,M,V){super(),this.angle=r,this.height=h,this.width=o,this.xOffset=t*j,this.yOffset=i*j,this._markerPlacement=w,this._effects=S,this._anchorX=.5-(.5+v)*g.width/g.width,this._anchorY=.5-(.5+O)*g.height/g.height,this._minMaxZoom=Object(c.a)(Math.round(M*l.l),Math.round(V*l.l));const I=(1===x?1:0)|(y?1:0)<<1|(m?1:0)<<2|(b?1:0)<<3,T=g&&g.sdf,z=u.d.load(e);z.sdf=T,z.pattern=!0,z.textureBinding=g.textureBinding,this._materialKey=z.data,this._fillColor=s,this._outlineColor=d,this._sizeOutlineWidth=Object(c.b)(Math.round(Math.min(Math.sqrt(128*o),255)),Math.round(Math.min(Math.sqrt(128*h),255)),Math.round(Math.min(Math.sqrt(128*f),255)),Math.round(Math.min(Math.sqrt(128*p),255)));const k=g.rect.x+l.p,C=g.rect.y+l.p,P=k+g.width,L=C+g.height;this._offsets.xUpperLeft=k,this._offsets.yUpperLeft=C,this._offsets.xUpperRight=P,this._offsets.yUpperRight=C,this._offsets.xBottomLeft=k,this._offsets.yBottomLeft=L,this._offsets.xBottomRight=P,this._offsets.yBottomRight=L,this._texUpperLeft=Object(c.a)(k,C),this._texUpperRight=Object(c.a)(P,C),this._texBottomLeft=Object(c.a)(k,L),this._texBottomRight=Object(c.a)(P,L),o*=_,h*=_,o*=j,h*=j;const E=Math.round(64*_);this._bitestAndDistRatio=Object(c.a)(I,E),this._computedWidth=o,this._computedHeight=h;const F=Object(a.a)(),N=Object(n.a)();this._applyTransformation(N,F)}static fromCIMMarker(e,t,i){const n=t&&t.width||1,a=t&&t.height||1,l=e.size,c=n/a*e.scaleX,u=e.scaleSymbolsProportionally&&e.frameHeight?l/e.frameHeight:1,p=Object(o.c)(e.color),d=Object(o.c)(e.outlineColor),y=Object(s.h)(l),b=y*c,m=Object(s.h)(e.offsetX||0),x=Object(s.h)(e.offsetY||0),g=Object(s.h)(e.outlineWidth||0)*u,v=e.alignment||0,O=Object(s.h)(e.referenceSize),[_,j]=Object(h.e)(e.scaleInfo,i);let w=e.rotation||0;e.rotateClockwise||(w=-w);let S=0,M=0;const V=e.anchorPoint;V&&(e.isAbsoluteAnchorPoint?l&&(S=-V.x/(l*c),M=V.y/l):(S=V.x,M=V.y));const I=new f(e.materialKey,m,x,w,p,b,y,O,d,g,e.colorLocked,e.scaleSymbolsProportionally,!1,v,t,S,M,e.sizeRatio,Object(r.t)(e.scaleFactor,1),e.markerPlacement,e.effects,_,j);return I._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/b:1,I._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/y:1,I}static fromPictureMarker(e,t){const i=Math.round(Object(s.h)(e.width)),r=Math.round(Object(s.h)(e.height)),n=l.o,a=Math.round(Object(s.h)(e.xoffset||0)),o=Math.round(Object(s.h)(e.yoffset||0)),c=new f(e.materialKey,a,o,e.angle,n,i,r,r,0,0,!1,!1,!1,0,t,0,0,1,1,null,null,h.b,h.a);return c._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.width:1,c._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1,c}static fromSimpleMarker(e,t){const i=Object(o.d)(e.color),r=Math.round(Object(s.h)(e.size)),n=r,a=Math.round(Object(s.h)(e.xoffset||0)),l=Math.round(Object(s.h)(e.yoffset||0)),c=e.style,u=e.outline,p=0|(u&&u.color&&Object(o.d)(u.color)),d=0|(u&&u.width&&Math.round(Object(s.h)(u.width))),y=new f(e.materialKey,a,l,e.angle,i,r,n,n,p,d,!1,!1,"esriSMSCross"===c||"esriSMSX"===c,0,t,0,0,126/64,1,null,null,h.b,h.a);return y.boundsType="esriSMSCircle"===c?"circle":"square",y._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1,y._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1,y}static fromLineSymbolMarker(e,t){const i=Object(o.d)(e.color),r=Math.round(Object(s.h)(6*e.lineWidth)),n=r,a="cross"===e.style||"x"===e.style;let l;switch(e.placement){case"begin-end":l="Both";break;case"begin":l="JustBegin";break;case"end":l="JustEnd";break;default:l="None"}const c={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:l,offsetAlongLine:0},u=new f(e.materialKey,0,0,0,i,r,n,n/6,i,a?Math.round(Object(s.h)(e.lineWidth)):0,!1,!1,a,1,t,0,0,126/64,1,c,null,h.b,h.a);return u.boundsType="circle"===e.style?"circle":"square",u}}},486:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(85),s=i(100),n=i(319),a=i(326),o=i(136),l=i(229),c=i(166),u=i(484),h=i(130),p=i(159);const d=3.14159265359/180,f=e=>class extends e{constructor(...e){super(...e),this.angle=0,this.xOffset=0,this.yOffset=0,this.width=0,this.height=0,this.boundsType="square",this._anchorX=0,this._anchorY=0,this._computedWidth=0,this._computedHeight=0,this._vertexBoundsScaleX=1,this._vertexBoundsScaleY=1,this._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},this.geometryType=h.d.MARKER}_write(e,t,i){const r=t.getDisplayId();e.recordStart(r,this._materialKey,this.geometryType,!1,!0),this._writeGeometry(e,t,r,i),e.recordEnd()}_writeGeometry(e,t,i,s){if(Object(r.k)(this._markerPlacement))return this._writePlacedMarkers(e,t,s);const n=s?Object(c.p)(Object(c.d)(s),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readGeometryForDisplay();if(!Object(r.j)(n)){if(n.isPoint){const[t,r]=n.coords;if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(t<-1||t>=513||r<-1||r>=513))return;return this._writeVertices(e,i,this._getPos(t,r),t,r)}n.forEachVertex(((t,r)=>this._writeVertices(e,i,this._getPos(t,r),t,r)))}}_writePlacedMarkers(e,t,i){const n=null!=i?i:t.readLegacyGeometryForDisplay(),o=u.a.getPlacement(n,Object(r.s)(this._markerPlacement),Object(s.h)(1));if(!o)return;const c=t.getDisplayId(),h=Object(l.a)(),p=Object(a.a)();let f=o.next();for(;null!=f;){const{tx:t,ty:i}=f;t>=-128&&t<=640&&i>=-128&&i<=640&&(this._applyTransformation(p,h,f.getAngle()/d),this._writeVertices(e,c,this._getPos(t,i),t,i)),f=o.next()}}_writeVertices(e,t,i,r,s){const n=e.vertexCount();e.vertexBounds(r+this.xOffset,s-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY),e.vertexWrite(i),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(this._texUpperLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(i),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(this._texUpperRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(i),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(this._texBottomLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.vertexWrite(i),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(this._texBottomRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexWrite(this._minMaxZoom),e.vertexEnd(),e.indexWrite(n+0),e.indexWrite(n+1),e.indexWrite(n+2),e.indexWrite(n+1),e.indexWrite(n+3),e.indexWrite(n+2)}_applyTransformation(e,t,i=0){Object(n.d)(e),Object(n.h)(e,e,Object(l.b)(this.xOffset,-this.yOffset)),this.angle+i!==0&&Object(n.f)(e,e,d*(this.angle+i));const r=this._computedWidth,s=this._computedHeight,a=(this._anchorX-.5)*r,c=(this._anchorY-.5)*s;Object(o.s)(t,a,c),Object(o.t)(t,t,e),this._offsetUpperLeft=Object(p.a)(16*t[0],16*t[1]),this._offsets.xUpperLeft=t[0],this._offsets.yUpperLeft=t[1],Object(o.s)(t,a+r,c),Object(o.t)(t,t,e),this._offsetUpperRight=Object(p.a)(16*t[0],16*t[1]),this._offsets.xUpperRight=t[0],this._offsets.yUpperRight=t[1],Object(o.s)(t,a,c+s),Object(o.t)(t,t,e),this._offsetBottomLeft=Object(p.a)(16*t[0],16*t[1]),this._offsets.xBottomLeft=t[0],this._offsets.yBottomLeft=t[1],Object(o.s)(t,a+r,c+s),Object(o.t)(t,t,e),this._offsetBottomRight=Object(p.a)(16*t[0],16*t[1]),this._offsets.xBottomRight=t[0],this._offsets.yBottomRight=t[1]}_getPos(e,t){return Object(p.a)(Math.round(8*e),Math.round(8*t))}}},488:function(e,t,i){"use strict";i.d(t,"a",(function(){return Le})),i.d(t,"b",(function(){return Pe}));var r=i(88),s=i(80),n=i(91),a=i(262),o=i(108),l=i(100),c=i(206),u=i(117),h=i(416),p=i(159),d=i(161),f=i(224),y=i(85),b=i(166),m=i(130),x=(i(460),i(441)),g=i(185),v=i(565);function O(e,t,i,r,s,n,a){G=0;const o=(r-i)*n,l=s&&s.length,c=l?(s[0]-i)*n:o;let u,h,p,d,f,y=_(t,i,r,0,c,n,!0);if(y&&y.next!==y.prev){if(l&&(y=function(e,t,i,r,s,n){const a=new Array;for(let o=0,l=r.length;o<l;o++){const s=_(e,t,i,r[o]*n,o<l-1?r[o+1]*n:i*n,n,!1);s===s.next&&(s.steiner=!0),a.push(T(s))}a.sort(R);for(const o of a)z(o,s),s=j(s,s.next);return s}(t,i,r,s,y,n)),o>80*n){u=p=t[0+i*n],h=d=t[1+i*n];for(let e=n;e<c;e+=n){const r=t[e+i*n],s=t[e+1+i*n];u=Math.min(u,r),h=Math.min(h,s),p=Math.max(p,r),d=Math.max(d,s)}f=Math.max(p-u,d-h),f=0!==f?1/f:0}w(y,e,n,u,h,f,a,0)}}function _(e,t,i,r,s,n,a){let o;if(a===function(e,t,i,r,s,n){let a=0;for(let o=r,l=s-n;o<s;o+=n)a+=(e[l+t*n]-e[o+t*n])*(e[o+1+t*n]+e[l+1+t*n]),l=o;return a}(e,t,0,r,s,n)>0)for(let l=r;l<s;l+=n)o=V(l+t*n,e[l+t*n],e[l+1+t*n],o);else for(let l=s-n;l>=r;l-=n)o=V(l+t*n,e[l+t*n],e[l+1+t*n],o);return o&&N(o,o.next)&&(I(o),o=o.next),o}function j(e,t=e){if(!e)return e;let i,r=e;do{if(i=!1,r.steiner||!N(r,r.next)&&0!==C(r.prev,r,r.next))r=r.next;else{if(I(r),r=t=r.prev,r===r.next)break;i=!0}}while(i||r!==t);return t}function w(e,t,i,r,s,n,a,o){if(!e)return;!o&&n&&(e=k(e,r,s,n));let l=e;for(;e.prev!==e.next;){const c=e.prev,u=e.next;if(n?M(e,r,s,n):S(e))t.push(c.index/i+a),t.push(e.index/i+a),t.push(u.index/i+a),I(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?w(e=A(e,t,i,a),t,i,r,s,n,a,2):2===o&&D(e,t,i,r,s,n,a):w(j(e),t,i,r,s,n,a,1);break}}}function S(e){const t=e.prev,i=e,r=e.next;if(C(t,i,r)>=0)return!1;let s=e.next.next;const n=s;let a=0;for(;s!==e.prev&&(0===a||s!==n);){if(a++,L(t.x,t.y,i.x,i.y,r.x,r.y,s.x,s.y)&&C(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function M(e,t,i,r){const s=e.prev,n=e,a=e.next;if(C(s,n,a)>=0)return!1;const o=s.x<n.x?s.x<a.x?s.x:a.x:n.x<a.x?n.x:a.x,l=s.y<n.y?s.y<a.y?s.y:a.y:n.y<a.y?n.y:a.y,c=s.x>n.x?s.x>a.x?s.x:a.x:n.x>a.x?n.x:a.x,u=s.y>n.y?s.y>a.y?s.y:a.y:n.y>a.y?n.y:a.y,h=F(o,l,t,i,r),p=F(c,u,t,i,r);let d=e.prevZ,f=e.nextZ;for(;d&&d.z>=h&&f&&f.z<=p;){if(d!==e.prev&&d!==e.next&&L(s.x,s.y,n.x,n.y,a.x,a.y,d.x,d.y)&&C(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,f!==e.prev&&f!==e.next&&L(s.x,s.y,n.x,n.y,a.x,a.y,f.x,f.y)&&C(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&L(s.x,s.y,n.x,n.y,a.x,a.y,d.x,d.y)&&C(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;f&&f.z<=p;){if(f!==e.prev&&f!==e.next&&L(s.x,s.y,n.x,n.y,a.x,a.y,f.x,f.y)&&C(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function V(e,t,i,r){const s=W.create(e,t,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function I(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e){let t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function z(e,t){if(t=function(e,t){let i=t;const r=e.x,s=e.y;let n,a=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const e=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=r&&e>a){if(a=e,e===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===a)return n.prev;const o=n,l=n.x,c=n.y;let u,h=1/0;for(i=n.next;i!==o;)r>=i.x&&i.x>=l&&r!==i.x&&L(s<c?r:a,s,l,c,s<c?a:r,s,i.x,i.y)&&(u=Math.abs(s-i.y)/(r-i.x),(u<h||u===h&&i.x>n.x)&&E(i,e)&&(n=i,h=u)),i=i.next;return n}(e,t)){const i=q(t,e);j(i,i.next)}}function k(e,t,i,r){for(let s;s!==e;s=s.next){if(s=s||e,null===s.z&&(s.z=F(s.x,s.y,t,i,r)),s.prev.next!==s||s.next.prev!==s)return s.prev.next=s,s.next.prev=s,k(e,t,i,r);s.prevZ=s.prev,s.nextZ=s.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){let t,i=1;for(;;){let r,s=e;e=null,t=null;let n=0;for(;s;){n++,r=s;let a=0;for(;a<i&&r;a++)r=r.nextZ;let o=i;for(;a>0||o>0&&r;){let i;0===a?(i=r,r=r.nextZ,o--):0!==o&&r?s.z<=r.z?(i=s,s=s.nextZ,a--):(i=r,r=r.nextZ,o--):(i=s,s=s.nextZ,a--),t?t.nextZ=i:e=i,i.prevZ=t,t=i}s=r}if(t.nextZ=null,i*=2,n<2)return e}}(e)}function C(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function P(e,t,i,r){return!!(N(e,t)&&N(i,r)||N(e,r)&&N(i,t))||C(e,t,i)>0!=C(e,t,r)>0&&C(i,r,e)>0!=C(i,r,t)>0}function L(e,t,i,r,s,n,a,o){return(s-a)*(t-o)-(e-a)*(n-o)>=0&&(e-a)*(r-o)-(i-a)*(t-o)>=0&&(i-a)*(n-o)-(s-a)*(r-o)>=0}function E(e,t){return C(e.prev,e,e.next)<0?C(e,t,e.next)>=0&&C(e,e.prev,t)>=0:C(e,t,e.prev)<0||C(e,e.next,t)<0}function F(e,t,i,r,s){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*s)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*s)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function N(e,t){return e.x===t.x&&e.y===t.y}function R(e,t){return e.x-t.x}function A(e,t,i,r){let s=e;do{const n=s.prev,a=s.next.next;!N(n,a)&&P(n,s,s.next,a)&&E(n,a)&&E(a,n)&&(t.push(n.index/i+r),t.push(s.index/i+r),t.push(a.index/i+r),I(s),I(s.next),s=e=a),s=s.next}while(s!==e);return s}function D(e,t,i,r,s,n,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.index!==e.index&&B(o,e)){let l=q(o,e);return o=j(o,o.next),l=j(l,l.next),w(o,t,i,r,s,n,a,0),void w(l,t,i,r,s,n,a,0)}e=e.next}o=o.next}while(o!==e)}function B(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){let i=e;do{if(i.index!==e.index&&i.next.index!==e.index&&i.index!==t.index&&i.next.index!==t.index&&P(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&E(e,t)&&E(t,e)&&function(e,t){let i=e,r=!1;const s=(e.x+t.x)/2,n=(e.y+t.y)/2;do{i.y>n!=i.next.y>n&&i.next.y!==i.y&&s<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==e);return r}(e,t)}function q(e,t){const i=W.create(e.index,e.x,e.y),r=W.create(t.index,t.x,t.y),s=e.next,n=t.prev;return e.next=t,t.prev=e,i.next=s,s.prev=i,r.next=i,i.prev=r,n.next=r,r.prev=n,r}class W{constructor(){this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}static create(e,t,i){const r=G<U.length?U[G++]:new W;return r.index=e,r.x=t,r.y=i,r.prev=null,r.next=null,r.z=null,r.prevZ=null,r.nextZ=null,r.steiner=!1,r}}const U=new Array;let G=0;for(let Ee=0;Ee<8096;Ee++)U.push(new W);const Z=new v.b(0,0,0,1,0),$=new v.b(0,0,0,1,0);function H(e,t,i){let r=0;for(let s=1;s<i;s++){const i=e[2*(t+s-1)],n=e[2*(t+s-1)+1];r+=(e[2*(t+s)]-i)*(e[2*(t+s)+1]+n)}return r}function X(e,t,i,r,s){let n=0;for(let a=i;a<r;a+=3){const i=2*(e.getValue(a)-s),r=2*(e.getValue(a+1)-s),o=2*(e.getValue(a+2)-s);n+=Math.abs((t[i]-t[o])*(t[r+1]-t[i+1])-(t[i]-t[r])*(t[o+1]-t[i+1]))}return n}Z.setExtent(u.D),$.setExtent(u.D);const K=e=>class extends e{constructor(...e){super(...e),this.forceLibtess=!1,this.geometryType=m.d.FILL}_write(e,t,i){const r="esriGeometryPoint"===t.geometryType,s=d.a.load(this._materialKey);e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,s.dotDensity,r),this._writeGeometry(e,t,s,i,r),e.recordEnd()}_writeGeometry(e,t,i,r,s){const n=this._getGeometry(t,r,s);if(Object(y.j)(n))return;const a=e.indexCount();if(!(n.maxLength>100)&&!this.forceLibtess&&function(e,t){const{coords:i,lengths:r,hasIndeterminateRingOrder:s}=t,n=e.indexWriter(),a=e.vertexCount();if(s)return!1;const o=n.length;let l=0;for(let c=0;c<r.length;){let e=c,t=r[c],s=H(i,l,t);const u=[];for(;++e<r.length;){const n=r[e],a=H(i,l+t,n);if(!(a>0))break;s+=a,u.push(l+t),t+=n}const h=n.length;O(n,i,l,l+t,u,2,a);const p=X(n,i,h,n.length,a),d=Math.abs(s);if(Math.abs((p-d)/Math.max(1e-7,d))>1e-5)return n.seek(o),!1;c=e,l+=t}return!0}(e,n))return void(!(a===e.indexCount())&&this._writeVertices(e,t,n.coords,n.lengths,i));const o=function(e,t){const i=e.indexWriter(),r=e.vertexCount(),{coords:s,lengths:n}=t,{buffer:a,vertexCount:o}=Object(x.b)(s,n);i.ensureSize(o);for(let l=0;l<o;l++)i.push(l+r);return a}(e,n);a!==e.indexCount()&&this._writeVertices(e,t,o,[o.length/2],i)}_writeVertices(e,t,i,r,s){const n=t.getDisplayId();let a=0;const o=r.reduce(((e,t)=>e+t)),l=s.dotDensity?4:10;e.vertexEnsureSize(l*o);for(const c of r){const r=c+a;for(let o=a;o<r;o++){const r=i[2*o],a=i[2*o+1],l=Object(p.a)(1*r,1*a);e.vertexBounds(r,a,0,0),e.vertexWrite(l),e.vertexWrite(n),s.dotDensity?e.vertexWriteF32(1/Math.abs(t.readGeometryArea())):(e.vertexWrite(this.fillColor),e.vertexWrite(this.tl),e.vertexWrite(this.br),e.vertexWrite(this.aux1),e.vertexWrite(this.aux2),e.vertexWrite(this.aux3),e.vertexWrite(this._minMaxZoom))}a+=c}}_getGeometry(e,t,i){const r=t?Object(b.p)(Object(b.d)(t),2):e.readGeometryForDisplay();return r?function(e,t){if(Object(y.j)(e))return null;if(!function(e,t,i){let r=0;for(let s=0;s<e.lengths.length;s++){const n=e.lengths[s];for(let s=0;s<n;s++){const n=e.coords[2*(s+r)],a=e.coords[2*(s+r)+1];if(n<t||n>i||a<t||a>i)return!0}r+=n}return!1}(e,-128,u.D+128))return e;Z.setPixelMargin(t),Z.reset(3);let i=0;for(let a=0;a<e.lengths.length;a++){const t=e.lengths[a];let r=e.coords[2*(0+i)],s=e.coords[2*(0+i)+1];Z.moveTo(r,s);for(let n=1;n<t;n++)r=e.coords[2*(n+i)],s=e.coords[2*(n+i)+1],Z.lineTo(r,s);Z.close(),i+=t}const r=Z.result(!1);if(!r)return null;const s=[],n=[];for(const a of r){let e=0;for(const t of a)n.push(t.x),n.push(t.y),e++;s.push(e)}return new g.a(s,n)}(r,i?256:8):null}};var Y=i(450),J=i(323);const Q=s.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");class ee extends J.a{constructor(e){super(),this._ongoingMaterialRequestMap=new Map,this._materialCache=new Map,this._dynamicPropertyMap=new Map,this._cimLayer=e}analyze(e,t,i,r){const s=t.readLegacyFeature(),n=this._materialCache,a=this._cimLayer.materialHash;if(!a)return Q.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);const o="function"==typeof a?a(s,i,r):a;if(n.has(o)){const e=n.get(o);return Promise.resolve(e)}if(this._ongoingMaterialRequestMap.has(o))return this._ongoingMaterialRequestMap.get(o);const l=Object(Y.a)(this._cimLayer.cim,this._cimLayer.materialOverrides);l.mosaicHash=o;const c=e.getMosaicItem(l).then((e=>(this._ongoingMaterialRequestMap.delete(o),n.set(o,e),e))).catch((e=>(this._ongoingMaterialRequestMap.delete(o),Q.error(".analyze()",e.message),null)));return this._ongoingMaterialRequestMap.set(o,c),c}}var te=i(347);const ie=128;class re extends(K(ee)){constructor(e,t,i){var r;if(super(e),this._minMaxZoom=Object(p.a)(Math.round(t*u.l),Math.round(i*u.l)),Object(f.f)(e.color)){const t=(t,i,r)=>{const s=e.color(t,i,r);return s&&Object(c.c)(s)||0};this._dynamicPropertyMap.set("fillColor",t)}else{const t=e.color;this.fillColor=t&&Object(c.c)(t)||0}let s=0;Object(f.f)(e.height)||(s=e.height||0);const n="CIMMarkerPlacementInsidePolygon"===(null==(r=e.cim.placement)?void 0:r.type)&&e.cim.placement.shiftOddRows?2:1;this._dynamicPropertyMap.set("_height",((t,i,r)=>Object(f.f)(e.height)?e.height(t,i,r)*n:s*n));let a=0;Object(f.f)(e.offsetX)||(a=Object(l.h)(e.offsetX||0)+ie,a>255&&(a=255));this._dynamicPropertyMap.set("_offsetX",((t,i,r)=>{if(Object(f.f)(e.offsetX)){let s=Object(l.h)(e.offsetX(t,i,r))+ie;return s>255&&(s=255),s}return a}));let o=1;Object(f.f)(e.scaleX)||(o=e.scaleX||1);this._dynamicPropertyMap.set("_scaleX",((t,i,r)=>Object(f.f)(e.scaleX)?e.scaleX(t,i,r):o));let y=0;Object(f.f)(e.offsetY)||(y=Object(l.h)(-e.offsetY||0)+ie,y>255&&(y=255));this._dynamicPropertyMap.set("_offsetY",((t,i,r)=>{if(Object(f.f)(e.offsetY)){let s=Object(l.h)(-e.offsetY(t,i,r))+ie;return s>255&&(s=255),s}return y}));let b=0;Object(f.f)(e.angle)||(b=Object(h.d)(e.angle)||0);this._dynamicPropertyMap.set("_angle",((t,i,r)=>Object(f.f)(e.angle)?Object(h.d)(e.angle(t,i,r)):b)),this._effects=e.effects,this._cimFillLayer=e,this._fillMaterialKey=d.a.load(e.materialKey)}static fromCIMFill(e,t){const[i,r]=Object(f.e)(e.scaleInfo,t);return new re(e,i,r)}bindFeature(e,t,i){const r=e.readLegacyFeature();this._dynamicPropertyMap.forEach(((e,s)=>{this[s]=e(r,t,i)}));const s=this._fillMaterialKey,n=this._materialCache,a=this._cimFillLayer;this.aux3=Object(p.b)(0,0,this._angle,a.colorLocked?1:0);const c=(0,a.materialHash)(r,t,i),h=n.get(c);let d=null;if(h&&Object(te.a)(h.spriteMosaicItem)&&(d=h.spriteMosaicItem),d){const{rect:e,width:t,height:i}=d,r=e.x+u.p,n=e.y+u.p,a=r+t,c=n+i;let h=Object(o.p)(Object(l.h)(this._height));h>255?h=255:h<=0&&(h=Object(o.p)(c-n));let f=Object(o.p)(Object(l.h)(this._height/i*t||0));f>255?f=255:f<=0&&(f=Object(o.p)(a-r));const y=this._scaleX,b=1;this.tl=Object(p.a)(r,n),this.br=Object(p.a)(a,c),this.aux1=Object(p.b)(f,h,this._offsetX,this._offsetY),this.aux2=Object(p.a)(ie*y,ie*b),s.sdf=d.sdf,s.pattern=!0,s.textureBinding=d.textureBinding}else this.tl=0,this.br=0,this.aux1=0,this.aux2=0,s.sdf=!1,s.pattern=!1,s.textureBinding=0;this._materialKey=s.data}}var se=i(566);const ne=31,ae=e=>class extends e{constructor(...e){super(...e),this.tessellationProperties={},this._tessellationOptions={halfWidth:0,pixelCoordRatio:1,offset:0},this.geometryType=m.d.LINE}_initializeTessellator(e){const t=d.c.load(this._materialKey),i=this._tessellationOptions,r=t.vvSizeFieldStops||t.vvSizeMinMaxValue||t.vvSizeScaleStops||t.vvSizeUnitValue,s=this.tessellationProperties._halfWidth<u.C;this.tessellationProperties.minMaxZoom=this._minMaxZoom;const n=s&&!e&&!r;i.wrapDistance=65535,i.textured=this._isDashed||this._hasPattern,i.offset=this.tessellationProperties.offset,i.halfWidth=this.tessellationProperties._halfWidth;const a=n?0:1;this._lineTessellator=new se.a(oe(this.tessellationProperties,a,a),le(this.tessellationProperties),n)}_write(e,t,i){const r="esriGeometryPoint"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,!1,r),this._writeGeometry(e,t,i,r),e.recordEnd()}_writeGeometry(e,t,i,r){const s=null!=i?i:t.readLegacyGeometryForDisplay(),n=this._getLines(s,r);Object(y.j)(n)||this._writeVertices(e,t,n)}_getLines(e,t){if(Object(y.j)(e))return null;const i=e.paths||e.rings;return Object(y.j)(i)?null:function(e,t){$.setPixelMargin(t);const i=$,r=-t,s=u.D+t;let n=[],a=!1,o=0;for(;o<e.length;){const t=[],l=e[o];if(!l)return null;i.reset(2);let[c,u]=l[0];if(a)i.moveTo(c,u);else{if(c<r||c>s||u<r||u>s){a=!0;continue}t.push({x:c,y:u})}let h=!1;const p=l.length;for(let e=1;e<p;++e)if(c+=l[e][0],u+=l[e][1],a)i.lineTo(c,u);else{if(c<r||c>s||u<r||u>s){h=!0;break}t.push({x:c,y:u})}if(h)a=!0;else{if(a){const e=i.resultWithStarts();if(e)for(const t of e)n.push(t)}else n.push({line:t,start:0});o++,a=!1}}return n=n.filter((e=>e.line.length>1)),0===n.length?null:n}(i,t?256:16)}_writeVertices(e,t,i){const r=t.getDisplayId(),s=e.vertexCount(),n=this.tessellationProperties,a=this._tessellationOptions;n.out=e,n.id=r,n.indexCount=0,n.vertexCount=0,n.offset=s,a.capType=this._capType,a.joinType=this._joinType;for(const{line:o,start:l}of i)a.initialDistance=l%65535,this._lineTessellator.tessellate(o,a)}},oe=(e,t,i)=>(r,s,n,a,o,l,c,u,h,d,f)=>{const y=Object(p.a)(f,Math.ceil(1024*e._halfWidth)),b=Object(p.b)(Math.round(ne*c),Math.round(ne*u),Math.round(ne*h),Math.round(ne*d)),m=Object(p.b)(ne*o,ne*l,0,e._bitset),x=e.out;return x.vertexBounds(r,s,t,i),x.vertexWrite(Object(p.a)(8*r,8*s)),x.vertexWrite(e.id),x.vertexWrite(e._fillColor),x.vertexWrite(b),x.vertexWrite(y),x.vertexWrite(e._tl),x.vertexWrite(e._br),x.vertexWrite(m),x.vertexWrite(Object(p.a)(Math.ceil(1024*e._halfReferenceWidth),0)),x.vertexWrite(e.minMaxZoom),x.vertexEnd(),e.offset+e.vertexCount++},le=e=>(t,i,r)=>{const s=e.out;s.indexWrite(t),s.indexWrite(i),s.indexWrite(r),e.indexCount+=3};class ce extends(ae(ee)){constructor(e,t,i){super(e),this._minMaxZoom=Object(p.a)(Math.round(t*u.l),Math.round(i*u.l)),this._cimLineLayer=e;let r=0;Object(f.f)(e.width)||(r=.5*Object(l.h)(e.width));if(this._dynamicPropertyMap.set("_halfWidth",((t,i,s)=>Object(f.f)(e.width)?.5*Object(l.h)(e.width(t,i,s)):r)),Object(f.f)(e.cap)?this._dynamicPropertyMap.set("_capType",e.cap):this._capType=e.cap,Object(f.f)(e.join)?this._dynamicPropertyMap.set("_joinType",e.join):this._joinType=e.join,Object(f.f)(e.color)){const t=(t,i,r)=>{const s=e.color(t,i,r);return s&&Object(c.c)(s)||0};this._dynamicPropertyMap.set("_fillColor",t)}else{const t=e.color;this._fillColor=t&&Object(c.c)(t)||0}if(Object(f.f)(e.miterLimit)){const t=(t,i,r)=>Object(f.d)(e.miterLimit(t,i,r));this._dynamicPropertyMap.set("_miterLimitCosine",t)}else this._miterLimitCosine=Object(f.d)(e.miterLimit);this._scaleFactor=e.scaleFactor||1,this._isDashed=e.isDashed,this._effects=e.effects,this.tessellationProperties._bitset=e.colorLocked?1:0,this._materialKey=e.materialKey,this._initializeTessellator(!0)}static fromCIMLine(e,t){const[i,r]=Object(f.e)(e.scaleInfo,t);return new ce(e,i,r)}bindFeature(e,t,i){const r=e.readLegacyFeature();this._dynamicPropertyMap.forEach(((e,s)=>{this[s]=e(r,t,i)})),this._halfWidth*=this._scaleFactor;const s=this._materialCache,n=(0,this._cimLineLayer.materialHash)(r,t,i),a=s.get(n);let o=null;if(a&&Object(te.a)(a.spriteMosaicItem)&&(o=a.spriteMosaicItem),o){this._hasPattern=!0;const{rect:e,width:t,height:i}=o,r=e.x+u.p,s=e.y+u.p,n=r+t,a=s+i;this.tessellationProperties._tl=Object(p.a)(r,s),this.tessellationProperties._br=Object(p.a)(n,a)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties.offset=0,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;const l=d.c.load(this._materialKey);o&&(l.sdf=o.sdf,l.pattern=!0,l.textureBinding=o.textureBinding),this._materialKey=l.data}}var ue=i(326),he=i(229),pe=i(486);const de=Object(he.a)(),fe=Object(ue.a)(),ye=s.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");class be extends(Object(pe.a)(ee)){constructor(e,t,i){if(super(e),this._cimMarkerLayer=e,this._minMaxZoom=Object(p.a)(Math.round(t*u.l),Math.round(i*u.l)),Object(f.f)(e.color)){const t=(t,i,r)=>Object(c.c)(e.color(t,i,r));this._dynamicPropertyMap.set("_fillColor",t)}else this._fillColor=Object(c.c)(e.color);if(Object(f.f)(e.outlineColor)){const t=(t,i,r)=>Object(c.c)(e.outlineColor(t,i,r));this._dynamicPropertyMap.set("_outlineColor",t)}else this._outlineColor=Object(c.c)(e.outlineColor);if(Object(f.f)(e.size)){const t=(t,i,r)=>Object(l.h)(e.size(t,i,r));this._dynamicPropertyMap.set("_size",t)}else this._size=Object(l.h)(e.size)||0;if(Object(f.f)(e.scaleX)?this._dynamicPropertyMap.set("_scaleX",e.scaleX):this._scaleX=e.scaleX||1,Object(f.f)(e.offsetX)){const t=(t,i,r)=>Object(l.h)(e.offsetX(t,i,r));this._dynamicPropertyMap.set("xOffset",t)}else this.xOffset=Object(l.h)(e.offsetX)||0;if(Object(f.f)(e.offsetY)){const t=(t,i,r)=>Object(l.h)(e.offsetY(t,i,r));this._dynamicPropertyMap.set("yOffset",t)}else this.yOffset=Object(l.h)(e.offsetY)||0;if(Object(f.f)(e.outlineWidth)){const t=(t,i,r)=>Object(l.h)(e.outlineWidth(t,i,r));this._dynamicPropertyMap.set("_outlineWidth",t)}else this._outlineWidth=Object(l.h)(e.outlineWidth)||0;Object(f.f)(e.rotation)?this._dynamicPropertyMap.set("_angle",e.rotation):this._angle=e.rotation||0,this._scaleFactor=Object(y.t)(e.scaleFactor,1),this._markerPlacement=e.markerPlacement,this._effects=e.effects,this._bitSet=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3,this._materialKey=e.materialKey}static fromCIMMarker(e,t){const[i,r]=Object(f.e)(e.scaleInfo,t);return new be(e,i,r)}bindFeature(e,t,i){const s=e.readLegacyFeature();this._dynamicPropertyMap.forEach(((e,r)=>{this[r]=e(s,t,i)}));const n=this._cimMarkerLayer.materialHash,a="function"==typeof n?n(s,t,i):n,o=this._materialCache.get(a);if(!o||!Object(te.a)(o.spriteMosaicItem)||!o.spriteMosaicItem)return void ye.error(new r.a("mapview-cim","Encountered an error when binding feature"));const c=o.spriteMosaicItem,h=this._cimMarkerLayer.sizeRatio,f=c.width/c.height*this._scaleX,y=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle;let b=this._size,m=b*f;const x=this.xOffset,g=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;const v=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/Object(l.h)(this._cimMarkerLayer.frameHeight):1,O=this._outlineWidth*v,_=Object(l.h)(this._cimMarkerLayer.referenceSize);let j=0,w=0;const S=this._cimMarkerLayer.anchorPoint;S&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(j=-S.x/(this._size*f),w=S.y/this._size):(j=S.x,w=S.y)),this._sizeOutlineWidth=Object(p.b)(Math.round(Math.min(Math.sqrt(128*m),255)),Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*O),255)),Math.round(Math.min(Math.sqrt(128*_),255))),this.angle=y;const M=Math.round(64*h);this._bitestAndDistRatio=Object(p.a)(this._bitSet,M);const V=c.rect.x+u.p,I=c.rect.y+u.p,T=V+c.width,z=I+c.height;this._texUpperLeft=Object(p.a)(V,I),this._texUpperRight=Object(p.a)(T,I),this._texBottomLeft=Object(p.a)(V,z),this._texBottomRight=Object(p.a)(T,z);const k=d.d.load(this._materialKey);k.sdf=c.sdf,k.pattern=!0,k.textureBinding=c.textureBinding,this._materialKey=k.data,this._anchorX=.5-(.5+j)*c.width/c.width,this._anchorY=.5-(.5+w)*c.height/c.height,m*=h,b*=h,m*=this._scaleFactor,b*=this._scaleFactor,m*=c.rect.width/c.width,b*=c.rect.height/c.height,this._computedWidth=m,this._computedHeight=b,this._applyTransformation(fe,de),this.xOffset=x,this.yOffset=g}}var me=i(320),xe=i(483),ge=i(461);class ve extends(Object(xe.a)(ee)){constructor(e,t,i){super(e),this._horizontalAlignment="center",this._verticalAlignment="middle",this._textToGlyphs=new Map,this._minMaxZoom=Object(p.a)(Math.round(t*u.l),Math.round(i*u.l));const r=e.scaleFactor||1;if(this._cimTextLayer=e,Object(f.f)(e.color)){const t=(t,i,r)=>Object(c.c)(e.color(t,i,r));this._dynamicPropertyMap.set("_color",t)}else this._color=Object(c.c)(e.color);if(Object(f.f)(e.color)){const t=(t,i,r)=>Object(c.c)(e.outlineColor(t,i,r));this._dynamicPropertyMap.set("_haloColor",t)}else this._haloColor=Object(c.c)(e.outlineColor);let s;Object(f.f)(e.size)||(s=Math.min(Math.round(Object(l.h)(e.size*e.sizeRatio)),127));if(this._dynamicPropertyMap.set("_size",((t,i,r)=>Object(f.f)(e.size)?Math.min(Math.round(Object(l.h)(e.size(t,i,r)*e.sizeRatio)),127):s)),Object(f.f)(e.outlineSize)){const t=(t,i,r)=>Math.min(Math.floor(5*Object(l.h)(e.outlineSize(t,i,r)*e.sizeRatio)),127);this._dynamicPropertyMap.set("_haloSize",t)}else this._haloSize=Math.min(Math.floor(5*Object(l.h)(e.outlineSize*e.sizeRatio)),127);let n;Object(f.f)(e.offsetX)||(n=Math.round(Object(l.h)(e.offsetX*e.sizeRatio)));let a;this._dynamicPropertyMap.set("_xOffset",((t,i,r)=>Object(f.f)(e.offsetX)?Math.round(Object(l.h)(e.offsetX(t,i,r)*e.sizeRatio)):n)),Object(f.f)(e.offsetY)||(a=Math.round(Object(l.h)(e.offsetY*e.sizeRatio)));this._dynamicPropertyMap.set("_yOffset",((t,i,r)=>Object(f.f)(e.offsetY)?Math.round(Object(l.h)(e.offsetY(t,i,r)*e.sizeRatio)):a)),Object(f.f)(e.angle)?this._dynamicPropertyMap.set("_angle",e.angle):this._angle=e.angle,Object(f.f)(e.horizontalAlignment)?this._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):this._horizontalAlignment=e.horizontalAlignment,Object(f.f)(e.verticalAlignment)?this._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):this._verticalAlignment=e.verticalAlignment,this._scaleFactor=r,Object(f.f)(e.text)?this._dynamicPropertyMap.set("_text",e.text):this._text=e.text;const o=Math.min(Math.round(Object(l.h)(e.referenceSize*e.sizeRatio)),127);this._referenceSize=Math.round(Math.sqrt(256*o)),this._materialKey=e.materialKey;const h=d.f.load(this._materialKey);h.sdf=!0,this._bitset=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1,this._materialKey=h.data,this._decoration="none",this._lineHeight=1,this._lineWidth=512,this._textPlacement=e.markerPlacement,this._effects=e.effects,this._isCIM=!0}static fromCIMText(e,t){const[i,r]=Object(f.e)(e.scaleInfo,t);return new ve(e,i,r)}async analyze(e,t,i,r){const s=t.readLegacyFeature(),n=function(e,t,i,r){return"string"==typeof e.text?e.text:"function"==typeof e.text?e.text(t,i,r):""}(this._cimTextLayer,s,i,r),a=await e.getMosaicItem(this._cimTextLayer.cim,Object(ge.a)(n));return this._textToGlyphs.set(n,a.glyphMosaicItems),a}bindFeature(e,t,i){const r=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach(((e,s)=>{this[s]=e(r,t,i)})),!this._text||0===this._text.length)return void(this._shapingInfo=null);this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=Object(me.d)(this._horizontalAlignment||"center"),this._yAlignD=Object(me.f)(this._verticalAlignment||"baseline");const s=this._textToGlyphs.get(this._text);this.bindTextInfo(s,!1)}}const Oe=128;class _e extends(K(J.a)){constructor(e,t,i,r,s,n,a,o,l,c,h){super(),this._effects=l;const f=d.a.load(e);t&&(f.sdf=t.sdf,f.pattern=!0,f.textureBinding=t.textureBinding),this.fillColor=i,this.tl=r,this.br=s,this.aux1=n,this.aux2=a,this.aux3=o,this._minMaxZoom=Object(p.a)(Math.round(c*u.l),Math.round(h*u.l)),this._materialKey=f.data}static fromCIMFill(e,t,i){const r=e.color,s=r&&Object(c.c)(r)||0,n=e.materialKey,[a,d]=Object(f.e)(e.scaleInfo,i);if(!t){const t=Object(p.b)(0,0,0,e.colorLocked?1:0);return new _e(n,null,s,0,0,0,0,t,e.effects,a,d)}const{rect:y,width:b,height:m}=t,x=y.x+u.p,g=y.y+u.p,v=x+b,O=g+m;let _=Object(o.p)(m);_>255?_=255:_<=0&&(_=Object(o.p)(O-g));let j=Object(o.p)(b||0);j>255?j=255:j<=0&&(j=Object(o.p)(v-x));let w=Object(l.h)(e.offsetX||0)+Oe;w>255&&(w=255);let S=Object(l.h)(-e.offsetY||0)+Oe;S>255&&(S=255);const M=e.scaleX||1,V=Object(p.a)(x,g),I=Object(p.a)(v,O),T=Object(p.b)(j,_,w,S),z=Object(p.a)(Oe*M,128),k=Object(p.b)(0,0,Object(h.b)(e.angle),e.colorLocked?1:0);return new _e(n,t,s,V,I,T,z,k,e.effects,a,d)}static fromSimpleFill(e,t,i=!1){const{color:r}=e,s=r&&"esriSFSNull"!==e.style&&Object(c.d)(r)||0,n=Object(p.b)(0,0,0,i?255:0),a=e.materialKey;if(!t)return new _e(a,null,s,0,0,0,0,n,null,f.b,f.a);const{rect:l,width:h,height:d}=t,y=l.x+u.p,b=l.y+u.p,m=y+h,x=b+d,g=Object(p.a)(y,b),v=Object(p.a)(m,x),O=Object(p.b)(Object(o.p)(m-y),Object(o.p)(x-b),0,0),_=Object(p.a)(Oe,Oe);return new _e(a,t,s,g,v,O,_,n,null,f.b,f.a)}static fromPictureFill(e,t,i=!1){const r=u.o,{rect:s,width:n,height:a}=t,c=s.x+u.p,h=s.y+u.p,d=c+n,y=h+a,b=Object(p.a)(c,h),m=Object(p.a)(d,y);let x=Object(o.p)(Object(l.h)(e.width));x>255&&(x=255);let g=Object(o.p)(Object(l.h)(e.height));g>255&&(g=255);let v=Object(l.h)(e.xoffset)+Oe;v>255&&(v=255);let O=Object(l.h)(-e.yoffset)+Oe;O>255&&(O=255);const _=Object(p.b)(x,g,v,O),j=Object(p.a)(Oe*e.xscale,Oe*e.yscale),w=Object(p.b)(0,0,0,i?255:0),S=e.materialKey;return new _e(S,t,r,b,m,_,j,w,null,f.b,f.a)}}var je=i(163);const we=s.a.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");class Se extends(ae(J.a)){constructor(e,t,i,r,s,n,a,o,l,c,h,y,b,m,x,g,v){super();const O=d.c.load(e);t&&(O.sdf=t.sdf,O.pattern=!0,O.textureBinding=t.textureBinding),this._capType=r,this._joinType=s,this._miterLimitCosine=Object(f.d)(n),this.tessellationProperties._fillColor=a,this.tessellationProperties._tl=o,this.tessellationProperties._br=l,this._hasPattern=c,this._isDashed=h,this._isColorLocked=y,this._zOrder=m,this._effects=x,this._minMaxZoom=Object(p.a)(Math.round(g*u.l),Math.round(v*u.l)),this._materialKey=O.data,this.tessellationProperties._bitset=y?1:0,this.tessellationProperties._halfWidth=.5*i,this.tessellationProperties._halfReferenceWidth=.5*b,this.tessellationProperties.offset=0,this._initializeTessellator(!1)}static fromCIMLine(e,t,i){const r=e.color,s=e.scaleFactor||1,n=e.isDashed;let a=e.cap;n&&1===a&&(a=2);const o=e.join,h=Object(l.h)(e.width)*s,d=Object(l.h)(e.referenceWidth),y=Object(l.h)(e.miterLimit),b=r&&Object(c.c)(r)||0,[m,x]=Object(f.e)(e.scaleInfo,i);if(!t)return new Se(e.materialKey,t,h,a,o,y,b,0,0,!1,n,e.colorLocked,d,e.zOrder,e.effects,m,x);const{rect:g,width:v,height:O}=t,_=g.x+u.p,j=g.y+u.p,w=_+v,S=j+O,M=Object(p.a)(_,j),V=Object(p.a)(w,S);return new Se(e.materialKey,t,h,a,o,y,b,M,V,!0,n,e.colorLocked,d,e.zOrder,e.effects,m,x)}static fromSimpleLine(e,t){const{color:i}=e,r="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,s=Object(je.h)(e.cap||"round"),n=Object(je.i)(e.join||"round");let a=i&&"esriSLSNull"!==e.style&&Object(c.d)(i)||0;"esriSLSNull"===e.style&&(a=0);const o=Object(l.h)(e.width),h=e.miterLimit;if(!t)return new Se(e.materialKey,t,o,s,n,h,a,0,0,!1,r,!1,o,0,null,f.b,f.a);const{rect:d,width:y,height:b}=t,m=d.x+u.p,x=d.y+u.p,g=m+y,v=x+b,O=Object(p.a)(m,x),_=Object(p.a)(g,v);return new Se(e.materialKey,t,o,s,n,h,a,O,_,!0,r,!1,o,0,null,f.b,f.a)}static fromPictureLineSymbol(e,t,i,r){return we.error("PictureLineSymbol support does not exist!"),null}}var Me=i(485),Ve=i(482);class Ie{constructor(){this._resolver=null}isHeld(){return!!this._resolver}async acquire(){if(!this._resolver)return this._resolver=Object(n.g)(),Promise.resolve();await this._resolver.promise,await this.acquire()}release(){const e=this._resolver;this._resolver=null,e.resolve()}}var Te=i(402);const ze=s.a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),ke=new Array;function Ce(e,t){const i=e.length;return e.push(null),t.then((t=>e[i]=t)),e}function Pe(e){return!!(1&e)}class Le{constructor(e,t){this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Ie,this._fetchResource=e,this._tileInfo=t}get _markerError(){return this._errorTemplates.marker[0]}get _fillError(){return this._errorTemplates.fill[0]}get _lineError(){return this._errorTemplates.line[0]}get _textError(){return this._errorTemplates.line[0]}createTemplateGroup(e,t){this._initErrorTemplates();const i=e.hash;if(this._symbolToTemplate.has(i))return this._symbolToTemplate.get(i);const r=new Array;t&&this._createMeshTemplates(r,t,!0),this._createMeshTemplates(r,e,!1);const s=this._createGroupId("expanded-cim"===e.type);return this._idToTemplateGroup.set(s,r),this._symbolToTemplate.set(i,s),s}getTemplateGroup(e){return this._idToTemplateGroup.has(e)?this._idToTemplateGroup.get(e):ke}getDynamicTemplateGroup(e){return this._idToTemplateGroup.has(e)?(Pe(e)||ze.error("mapview-template-store",`Id ${e} does not refer to a dynamic template`),this._idToTemplateGroup.get(e)):ke}getMosaicItem(e,t){const i=this._createTemplateId(),r=new Promise((e=>this._idToResolver.set(i,e)));return this._fetchQueue.push({symbol:e,id:i,glyphIds:t}),r}finalize(e){return this._fetchQueue.length||this._lock.isHeld()?async function(e,t,i){try{await e.acquire(),await t(i),e.release()}catch(r){throw e.release(),r}}(this._lock,this._fetchAllQueuedResources.bind(this),e):Promise.resolve()}_initErrorTemplates(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],Object(Te.c)(a.f),!1),marker:this._createMeshTemplates([],Object(Te.c)(a.e),!1),line:this._createMeshTemplates([],Object(Te.c)(a.g),!1)})}_fetchAllQueuedResources(e){if(!this._fetchQueue.length)return Promise.resolve();const t=this._fetchQueue,i=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(i).then((()=>this._fetchResource(t,e).then((e=>{for(const{id:t,mosaicItem:i}of e)this._idToResolver.get(t)(i),this._idToResolver.delete(t)})))).catch((e=>{Object(n.m)(e)?this._fetchQueue=this._fetchQueue.concat(t):"worker:port-closed"===e.name||ze.error(new r.a("mapview-template-store","Unable to fetch requested texture resources",e))}))}_createGroupId(e){return this._idCounter++<<1|(e?1:0)}_createTemplateId(){return this._templateIdCounter++}async _createSMS(e){const{spriteMosaicItem:t}=await this.getMosaicItem(e);return Object(te.a)(t,ze)?Me.a.fromSimpleMarker(e,t):this._markerError}async _createPMS(e){const{spriteMosaicItem:t}=await this.getMosaicItem(e);return Object(te.a)(t,ze)?Me.a.fromPictureMarker(e,t):this._markerError}async _createSFS(e,t){const{spriteMosaicItem:i}=await this.getMosaicItem(e);return Object(te.a)(i,ze)?_e.fromSimpleFill(e,i,t):this._fillError}async _createPFS(e,t){const{spriteMosaicItem:i}=await this.getMosaicItem(e);return Object(te.a)(i,ze)?_e.fromPictureFill(e,i,t):this._fillError}async _createSLS(e,t){const{spriteMosaicItem:i}=await this.getMosaicItem(e);return Object(te.a)(i,ze)?Se.fromSimpleLine(e,i):this._lineError}async _createLMS(e){const{spriteMosaicItem:t}=await this.getMosaicItem(e);return Object(te.a)(t,ze)?Me.a.fromLineSymbolMarker(e,t):this._markerError}async _createTS(e){const{glyphMosaicItems:t}=await this.getMosaicItem(e);return Ve.a.fromText(e,t)}async _createCIMText(e){const{glyphMosaicItems:t}=await this.getMosaicItem(e.cim,Object(ge.a)(e.text));return Object(te.a)(t,ze)?Ve.a.fromCIMText(e,t,this._tileInfo):this._textError}async _createCIMFill(e){const{spriteMosaicItem:t}=await this.getMosaicItem(e.cim);return Object(te.a)(t,ze)?_e.fromCIMFill(e,t,this._tileInfo):this._fillError}async _createCIMLine(e){const{spriteMosaicItem:t}=await this.getMosaicItem(e.cim);return Object(te.a)(t,ze)?Se.fromCIMLine(e,t,this._tileInfo):this._lineError}async _createCIMMarker(e){const{spriteMosaicItem:t}=await this.getMosaicItem(e.cim);return Object(te.a)(t,ze)?Me.a.fromCIMMarker(e,t,this._tileInfo):this._markerError}async _createCIM(e){const t=e.templateHash;if(this._cimTemplateCache.has(t))return this._cimTemplateCache.get(t);const i={...e,cim:{...e.cim,mosaicHash:e.materialHash}};let r;switch(i.type){case"marker":r=this._createCIMMarker(i);break;case"line":r=this._createCIMLine(i);break;case"fill":r=this._createCIMFill(i);break;case"text":r=this._createCIMText(i)}return r.then((e=>this._cimTemplateCache.set(t,e))),r}_createDynamicCIM(e){const t=e.templateHash;if(this._cimTemplateCache.has(t))return this._cimTemplateCache.get(t);let i;switch(e.type){case"marker":i=be.fromCIMMarker(e,this._tileInfo);break;case"line":i=ce.fromCIMLine(e,this._tileInfo);break;case"fill":i=re.fromCIMFill(e,this._tileInfo);break;case"text":i=ve.fromCIMText(e,this._tileInfo)}return this._cimTemplateCache.set(t,i),i}_createPrimitiveMeshTemplates(e,t,i){switch(t.type){case"esriSMS":return Ce(e,this._createSMS(t));case"esriPMS":return Ce(e,this._createPMS(t));case"esriSFS":return Ce(e,this._createSFS(t,i));case"line-marker":return Ce(e,this._createLMS(t));case"esriPFS":return Ce(e,this._createPFS(t,i));case"esriSLS":return Ce(e,this._createSLS(t,!1));case"esriTS":return Ce(e,this._createTS(t));default:return ze.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}_createMeshTemplates(e,t,i){if(-1!==t.type.indexOf("3d"))return ze.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){for(const i of t.layers)"function"==typeof i.materialHash?e.push(this._createDynamicCIM(i)):Ce(e,this._createCIM(i));return e}if("composite-symbol"===t.type){for(const r of t.layers)this._createPrimitiveMeshTemplates(e,r,i);return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,i)}}},504:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i(103);var r=i(450),s=i(130),n=i(161);const a={marker:s.d.MARKER,fill:s.d.FILL,line:s.d.LINE,text:s.d.TEXT};class o{constructor(e,t,i,r){const s={minScale:null==t?void 0:t.minScale,maxScale:null==t?void 0:t.maxScale},o=function(e){return e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:""}(s);this.layers=e,this.data=t,this.hash=this._createHash()+o,this.rendererKey=i;for(const l of e){const e=a[l.type];l.materialKey=Object(n.g)(e,this.rendererKey,!1,!1),l.maxVVSize=r,l.scaleInfo=s,l.templateHash+=o}}get type(){return"expanded-cim"}_createHash(){let e="";for(const t of this.layers)e+=t.templateHash;return e}}var l=i(191);const c=async(e,t)=>new o(await Object(r.b)(e.data,t),e.data,e.rendererKey,e.maxVVSize),u=async(e,t,i)=>{if(!e)return null;if("cim"===e.type)return c(e,t);if("web-style"===e.type){const r=l.a.fromJSON(e),s={type:"cim",data:(await r.fetchCIMSymbol(i)).data,rendererKey:e.rendererKey,maxVVSize:e.maxVVSize};return c(s,t)}return e}},518:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{constructor(e,t){this.x=e,this.y=t}clone(){return new r(this.x,this.y)}equals(e,t){return e===this.x&&t===this.y}isEqual(e){return e.x===this.x&&e.y===this.y}setCoords(e,t){this.x=e,this.y=t}normalize(){const e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);this.x/=i,this.y/=i}rightPerpendicular(){const e=this.x;this.x=this.y,this.y=-e}move(e,t){this.x+=e,this.y+=t}assign(e){this.x=e.x,this.y=e.y}assignAdd(e,t){this.x=e.x+t.x,this.y=e.y+t.y}assignSub(e,t){this.x=e.x-t.x,this.y=e.y-t.y}rotate(e,t){const i=this.x,r=this.y;this.x=i*e-r*t,this.y=i*t+r*e}scale(e){this.x*=e,this.y*=e}length(){const e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}static distance(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}static add(e,t){return new r(e.x+t.x,e.y+t.y)}static sub(e,t){return new r(e.x-t.x,e.y-t.y)}}},548:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return c}));var r=i(95),s=i(438),n=i(367);function a(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":{const t=e.symbolLayers;return t&&1===t.length?a(t[0]):null}case"CIMVectorMarker":{const t=e.markerGraphics;if(!t||1!==t.length)return null;const i=t[0];if(!i)return null;const r=i.geometry;if(!r)return null;const s=i.symbol;return!s||"CIMPolygonSymbol"!==s.type&&"CIMLineSymbol"!==s.type?null:{geom:r,asFill:"CIMPolygonSymbol"===s.type}}case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function o(e){let t=1/0,i=-1/0,r=1/0,s=-1/0;for(const n of e)for(const e of n)e[0]<t&&(t=e[0]),e[0]>i&&(i=e[0]),e[1]<r&&(r=e[1]),e[1]>s&&(s=e[1]);return[t,r,i,s]}function l(e){return e?e.rings?o(e.rings):e.paths?o(e.paths):Object(r.d)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function c(e,t,i,r,s){const[n,a,o,l]=e;if(o<n||l<a)return[0,0,0];const c=o-n,u=l-a,h=Math.floor(31.5),p=(128-2*(h+1))/Math.max(c,u),d=Math.round(c*p)+2*h,f=Math.round(u*p)+2*h;let y=1;t&&(y=f/p/(t.ymax-t.ymin));let b=0,m=0;if(r)if(s){if(t&&i&&t.ymax-t.ymin>0){const e=(t.xmax-t.xmin)/(t.ymax-t.ymin);b=r.x/(i*e),m=r.y/i}}else b=r.x,m=r.y;return b=.5*(t.xmax+t.xmin)+b*(t.xmax-t.xmin),m=.5*(t.ymax+t.ymin)+m*(t.ymax-t.ymin),b-=n,m-=a,b*=p,m*=p,b+=h,m+=h,[y,b/d-.5,-(m/f-.5)]}function u(e){const t=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),i=function(e){let t=1/0,i=-1/0,r=1/0,s=-1/0;for(const n of e)for(const e of n)e[0]<t&&(t=e[0]),e[0]>i&&(i=e[0]),e[1]<r&&(r=e[1]),e[1]>s&&(s=e[1]);return new n.a(t,r,i-t,s-r)}(t),r=Math.floor(31.5),s=(128-2*(r+1))/Math.max(i.width,i.height),a=Math.round(i.width*s)+2*r,o=Math.round(i.height*s)+2*r,l=[];for(const n of t)if(n&&n.length>1){const t=[];for(const a of n){let[n,o]=a;n-=i.x,o-=i.y,n*=s,o*=s,n+=r-.5,o+=r-.5,e.asFill?t.push([n,o]):t.push([Math.round(n),Math.round(o)])}if(e.asFill){const e=t.length-1;t[0][0]===t[e][0]&&t[0][1]===t[e][1]||t.push(t[0])}l.push(t)}const c=function(e,t,i,r){const s=t*i,n=new Array(s),a=r*r+1;for(let o=0;o<s;++o)n[o]=a;for(const o of e){const e=o.length;for(let s=1;s<e;++s){const e=o[s-1],a=o[s];let l,c,u,h;e[0]<a[0]?(l=e[0],c=a[0]):(l=a[0],c=e[0]),e[1]<a[1]?(u=e[1],h=a[1]):(u=a[1],h=e[1]);let p=Math.floor(l)-r,d=Math.floor(c)+r,f=Math.floor(u)-r,y=Math.floor(h)+r;p<0&&(p=0),d>t&&(d=t),f<0&&(f=0),y>i&&(y=i);const b=a[0]-e[0],m=a[1]-e[1],x=b*b+m*m;for(let r=p;r<d;r++)for(let s=f;s<y;s++){let o,l,c=(r-e[0])*b+(s-e[1])*m;c<0?(o=e[0],l=e[1]):c>x?(o=a[0],l=a[1]):(c/=x,o=e[0]+c*b,l=e[1]+c*m);const u=(r-o)*(r-o)+(s-l)*(s-l),h=(i-s-1)*t+r;u<n[h]&&(n[h]=u)}}}for(let o=0;o<s;++o)n[o]=Math.sqrt(n[o]);return n}(l,a,o,r);return e.asFill&&function(e,t,i,r,s){for(const n of e){const e=n.length;for(let a=1;a<e;++a){const e=n[a-1],o=n[a];let l,c,u,h;e[0]<o[0]?(l=e[0],c=o[0]):(l=o[0],c=e[0]),e[1]<o[1]?(u=e[1],h=o[1]):(u=o[1],h=e[1]);let p=Math.floor(l),d=Math.floor(c)+1,f=Math.floor(u),y=Math.floor(h)+1;p<r&&(p=r),d>t-r&&(d=t-r),f<r&&(f=r),y>i-r&&(y=i-r);for(let n=f;n<y;++n){if(e[1]>n==o[1]>n)continue;const a=(i-n-1)*t;for(let t=p;t<d;++t)t<(o[0]-e[0])*(n-e[1])/(o[1]-e[1])+e[0]&&(s[a+t]=-s[a+t]);for(let e=r;e<p;++e)s[a+e]=-s[a+e]}}}}(l,a,o,r,c),[h(c,r),a,o]}function h(e,t){const i=2*t,r=e.length,n=new Uint8Array(4*r);for(let a=0;a<r;++a){const t=.5-e[a]/i;Object(s.a)(t,n,4*a)}return n}},564:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i(655);function r(e,t,i,r){const s=e.clone(),n=1<<s.level,a=s.col+t,o=s.row+i;return r&&a<0?(s.col=a+n,s.world-=1):a>=n?(s.col=a-n,s.world+=1):s.col=a,s.row=o,s}},565:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return o}));var r=i(117),s=i(518),n=i(416);class a{constructor(e,t,i){this.ratio=e,this.x=t,this.y=i}}class o{constructor(e,t,i,s=8,n=8){this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=s,this.pixelMargin=n,this.tileSize=r.D*s,this.dz=e,this.yPos=t,this.xPos=i}setPixelMargin(e){e!==this.pixelMargin&&(this.pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this.finalRatio=this.tileSize/e*(1<<this.dz);let t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;const i=e>>this.dz;t>i&&(t=i),this.margin=t,this.xmin=i*this.xPos-t,this.ymin=i*this.yPos-t,this.xmax=this.xmin+i+2*t,this.ymax=this.ymin+i+2*t}reset(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0}moveTo(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new s.a(e,t),this._firstPt=new s.a(e,t),this._dist=0}lineTo(e,t){const i=this._isIn(e,t),r=new s.a(e,t),n=s.a.distance(this._prevPt,r);let o,l,c,u,h,p,d,f;if(i)this._prevIsIn?this._lineTo(e,t,!0):(o=this._prevPt,l=r,c=this._intersect(l,o),this.start=this._dist+n*(1-this._r),this._lineTo(c.x,c.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,o=r,c=this._intersect(l,o),this._lineTo(c.x,c.y,!0),this._lineTo(o.x,o.y,!1);else{const e=this._prevPt,t=r;if(e.x<=this.xmin&&t.x<=this.xmin||e.x>=this.xmax&&t.x>=this.xmax||e.y<=this.ymin&&t.y<=this.ymin||e.y>=this.ymax&&t.y>=this.ymax)this._lineTo(t.x,t.y,!1);else{const i=[];if((e.x<this.xmin&&t.x>this.xmin||e.x>this.xmin&&t.x<this.xmin)&&(u=(this.xmin-e.x)/(t.x-e.x),f=e.y+u*(t.y-e.y),f<=this.ymin?p=!1:f>=this.ymax?p=!0:i.push(new a(u,this.xmin,f))),(e.x<this.xmax&&t.x>this.xmax||e.x>this.xmax&&t.x<this.xmax)&&(u=(this.xmax-e.x)/(t.x-e.x),f=e.y+u*(t.y-e.y),f<=this.ymin?p=!1:f>=this.ymax?p=!0:i.push(new a(u,this.xmax,f))),(e.y<this.ymin&&t.y>this.ymin||e.y>this.ymin&&t.y<this.ymin)&&(u=(this.ymin-e.y)/(t.y-e.y),d=e.x+u*(t.x-e.x),d<=this.xmin?h=!1:d>=this.xmax?h=!0:i.push(new a(u,d,this.ymin))),(e.y<this.ymax&&t.y>this.ymax||e.y>this.ymax&&t.y<this.ymax)&&(u=(this.ymax-e.y)/(t.y-e.y),d=e.x+u*(t.x-e.x),d<=this.xmin?h=!1:d>=this.xmax?h=!0:i.push(new a(u,d,this.ymax))),0===i.length)h?p?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):p?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(i.length>1&&i[0].ratio>i[1].ratio)this.start=this._dist+n*i[1].ratio,this._lineTo(i[1].x,i[1].y,!0),this._lineTo(i[0].x,i[0].y,!0);else{this.start=this._dist+n*i[0].ratio;for(let e=0;e<i.length;e++)this._lineTo(i[e].x,i[e].y,!0)}this._lineTo(t.x,t.y,!1)}}this._dist+=n,this._prevIsIn=i,this._prevPt=r}close(){if(this.line.length>2){const e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);const i=this.line;let r=i.length;for(;r>=4&&(i[0].x===i[1].x&&i[0].x===i[r-2].x||i[0].y===i[1].y&&i[0].y===i[r-2].y);)i.pop(),i[0].x=i[r-2].x,i[0].y=i[r-2].y,--r}}result(e=!0){return this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&c.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}resultWithStarts(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();const e=this.lines,t=e.length;if(0===t)return null;const i=[];for(let r=0;r<t;r++)i.push({line:e[r],start:this.starts[r]||0});return i}_isIn(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax}_intersect(e,t){let i,r,n;if(t.x>=this.xmin&&t.x<=this.xmax)r=t.y<=this.ymin?this.ymin:this.ymax,n=(r-e.y)/(t.y-e.y),i=e.x+n*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)i=t.x<=this.xmin?this.xmin:this.xmax,n=(i-e.x)/(t.x-e.x),r=e.y+n*(t.y-e.y);else{r=t.y<=this.ymin?this.ymin:this.ymax,i=t.x<=this.xmin?this.xmin:this.xmax;const s=(i-e.x)/(t.x-e.x),a=(r-e.y)/(t.y-e.y);s<a?(n=s,r=e.y+s*(t.y-e.y)):(n=a,i=e.x+a*(t.x-e.x))}return this._r=n,new s.a(i,r)}_pushLine(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}_moveTo(e,t,i){3!==this.type?i&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new s.a(e,t))):(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new s.a(e,t)),this._is_h=!1,this._is_v=!1)}_lineTo(e,t,i){let r,n;if(3!==this.type)if(i){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(r=this.line[this.line.length-1],r.equals(e,t)))return;this.line.push(new s.a(e,t))}else this.line&&this.line.length>0&&this._pushLine();else if(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){r=this.line[this.line.length-1];const i=r.x===e,a=r.y===t;if(i&&a)return;this._is_h&&i||this._is_v&&a?(r.x=e,r.y=t,n=this.line[this.line.length-2],n.x===e&&n.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(n=this.line[this.line.length-2],this._is_h=n.x===e,this._is_v=n.y===t)):(this._is_h=n.x===e,this._is_v=n.y===t)):(this.line.push(new s.a(e,t)),this._is_h=i,this._is_v=a)}else this.line.push(new s.a(e,t))}}class l{setExtent(e){this._ratio=4096===e?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this.lines=[],this.line=null}moveTo(e,t){this.line&&this.lines.push(this.line),this.line=[];const i=this._ratio;this.line.push(new s.a(e*i,t*i))}lineTo(e,t){const i=this._ratio;this.line.push(new s.a(e*i,t*i))}close(){const e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:this.lines}}class c{static simplify(e,t,i){if(!i)return;const r=-t,s=e+t,n=-t,a=e+t,o=[],l=[],u=i.length;for(let c=0;c<u;++c){const e=i[c];if(!e||e.length<2)continue;let t,u=e[0];const h=e.length;for(let i=1;i<h;++i)t=e[i],u.x===t.x&&(u.x<=r&&(u.y>t.y?(o.push(c),o.push(i),o.push(0),o.push(-1)):(l.push(c),l.push(i),l.push(0),l.push(-1))),u.x>=s&&(u.y<t.y?(o.push(c),o.push(i),o.push(1),o.push(-1)):(l.push(c),l.push(i),l.push(1),l.push(-1)))),u.y===t.y&&(u.y<=n&&(u.x<t.x?(o.push(c),o.push(i),o.push(2),o.push(-1)):(l.push(c),l.push(i),l.push(2),l.push(-1))),u.y>=a&&(u.x>t.x?(o.push(c),o.push(i),o.push(3),o.push(-1)):(l.push(c),l.push(i),l.push(3),l.push(-1)))),u=t}if(0===o.length||0===l.length)return;c.fillParent(i,l,o),c.fillParent(i,o,l);const h=[];c.calcDeltas(h,l,o),c.calcDeltas(h,o,l),c.addDeltas(h,i)}static fillParent(e,t,i){const r=i.length,s=t.length;for(let a=0;a<s;a+=4){const s=t[a],o=t[a+1],l=t[a+2],c=e[s][o-1],u=e[s][o];let h=8092,p=-1;for(let t=0;t<r;t+=4){if(i[t+2]!==l)continue;const r=i[t],s=i[t+1],a=e[r][s-1],o=e[r][s];switch(l){case 0:case 1:if(Object(n.a)(c.y,a.y,o.y)&&Object(n.a)(u.y,a.y,o.y)){const e=Math.abs(o.y-a.y);e<h&&(h=e,p=t)}break;case 2:case 3:if(Object(n.a)(c.x,a.x,o.x)&&Object(n.a)(u.x,a.x,o.x)){const e=Math.abs(o.x-a.x);e<h&&(h=e,p=t)}}}t[a+3]=p}}static calcDeltas(e,t,i){const r=t.length;for(let s=0;s<r;s+=4){const r=[],n=c.calcDelta(s,t,i,r);e.push(t[s]),e.push(t[s+1]),e.push(t[s+2]),e.push(n)}}static calcDelta(e,t,i,r){const s=t[e+3];if(-1===s)return 0;const n=r.length;return n>1&&r[n-2]===s?0:(r.push(s),c.calcDelta(s,i,t,r)+1)}static addDeltas(e,t){const i=e.length;let r=0;for(let s=0;s<i;s+=4){const t=e[s+3];t>r&&(r=t)}for(let s=0;s<i;s+=4){const i=t[e[s]],n=e[s+1],a=r-e[s+3];switch(e[s+2]){case 0:i[n-1].x-=a,i[n].x-=a,1===n&&(i[i.length-1].x-=a),n===i.length-1&&(i[0].x-=a);break;case 1:i[n-1].x+=a,i[n].x+=a,1===n&&(i[i.length-1].x+=a),n===i.length-1&&(i[0].x+=a);break;case 2:i[n-1].y-=a,i[n].y-=a,1===n&&(i[i.length-1].y-=a),n===i.length-1&&(i[0].y-=a);break;case 3:i[n-1].y+=a,i[n].y+=a,1===n&&(i[i.length-1].y+=a),n===i.length-1&&(i[0].y+=a)}}}}},566:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(117);function s(e,t){return e.x===t.x&&e.y===t.y}function n(e){if(!e)return;const t=e.length;if(t<=1)return;let i=0;for(let r=1;r<t;r++)s(e[r],e[i])||++i===r||(e[i]=e[r]);e.length=i+1}function a(e,t){return e.x=t.y,e.y=-t.x,e}function o(e,t){return e.x=-t.y,e.y=t.x,e}function l(e,t){return e.x=t.x,e.y=t.y,e}function c(e,t){return e.x=-t.x,e.y=-t.y,e}function u(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function h(e,t){return e.x*t.y-e.y*t.x}function p(e,t){return e.x*t.x+e.y*t.y}function d(e,t,i,r){return e.x=t.x*i+t.y*r,e.y=t.x*r-t.y*i,e}class f{constructor(e,t,i){this.writeVertex=e,this.writeTriangle=t,this.canUseThinTessellation=i,this.prevNormal={x:void 0,y:void 0},this.nextNormal={x:void 0,y:void 0},this.textureNormalLeft={x:0,y:1},this.textureNormalRight={x:0,y:-1},this.textureNormal={x:void 0,y:void 0},this.joinNormal={x:void 0,y:void 0},this.inner={x:void 0,y:void 0},this.outer={x:void 0,y:void 0},this.roundStart={x:void 0,y:void 0},this.roundEnd={x:void 0,y:void 0},this.startBreak={x:void 0,y:void 0},this.endBreak={x:void 0,y:void 0},this.innerPrev={x:void 0,y:void 0},this.innerNext={x:void 0,y:void 0},this.bevelStart={x:void 0,y:void 0},this.bevelEnd={x:void 0,y:void 0},this.bevelMiddle={x:void 0,y:void 0}}tessellate(e,t){n(e),this.canUseThinTessellation&&t.halfWidth<r.C&&!t.offset?this.tessellateThin_(e,t):this.tessellate_(e,t)}tessellateThin_(e,t){if(e.length<2)return;const i=t.wrapDistance||65535;let r=t.initialDistance||0,s=!1,n=e[0].x,a=e[0].y;const o=e.length;for(let l=1;l<o;++l){s&&(s=!1,r=0);let t=e[l].x,o=e[l].y,c=t-n,u=o-a,h=Math.sqrt(c*c+u*u);if(c/=h,u/=h,r+h>i){s=!0;const e=(i-r)/h;h=i-r,t=(1-e)*n+e*t,o=(1-e)*a+e*o,--l}const p=this.writeVertex(n,a,0,0,c,u,u,-c,0,-1,r),d=this.writeVertex(n,a,0,0,c,u,-u,c,0,1,r);r+=h;const f=this.writeVertex(t,o,0,0,c,u,u,-c,0,-1,r),y=this.writeVertex(t,o,0,0,c,u,-u,c,0,1,r);this.writeTriangle(p,d,f),this.writeTriangle(d,f,y),n=t,a=o}}tessellate_(e,t){const i=e[0],r=e[e.length-1],n=s(i,r),f=n?3:2;if(e.length<f)return;const y=t.pixelCoordRatio,b=null!=t.capType?t.capType:0,m=null!=t.joinType?t.joinType:2,x=null!=t.miterLimit?Math.min(t.miterLimit,4):2,g=null!=t.roundLimit?Math.min(t.roundLimit,1.05):1.05,v=null!=t.halfWidth?t.halfWidth:2,O=!!t.textured;let _,j,w=null,S=null;const M=this.prevNormal,V=this.nextNormal;let I=-1,T=-1;const z=this.joinNormal;let k,C;const P=this.textureNormalLeft,L=this.textureNormalRight,E=this.textureNormal;let F=-1,N=-1;const R=t.wrapDistance||65535;let A=t.initialDistance||0;const D=this.writeVertex,B=this.writeTriangle,q=function(e,t,i,r,s,n){const a=D(_,j,k,C,i,r,e,t,s,n,A);return F>=0&&N>=0&&a>=0&&B(F,N,a),F=N,N=a,a};n&&(w=e[e.length-2],V.x=r.x-w.x,V.y=r.y-w.y,T=u(V),V.x/=T,V.y/=T);let W=!1;for(let s=0;s<e.length;++s){if(W&&(W=!1,A=0),w&&(M.x=-V.x,M.y=-V.y,I=T,A+I>R&&(W=!0)),W){const t=(R-A)/I;I=R-A,w={x:(1-t)*w.x+t*e[s].x,y:(1-t)*w.y+t*e[s].y},--s}else w=e[s];_=w.x,j=w.y;const t=s<=0&&!W,i=s===e.length-1;if(t||(A+=I),S=i?n?e[1]:null:e[s+1],S?(V.x=S.x-_,V.y=S.y-j,T=u(V),V.x/=T,V.y/=T):(V.x=void 0,V.y=void 0),!n){if(t){o(z,V),k=z.x,C=z.y,2===b&&(q(-V.y-V.x,V.x-V.y,V.x,V.y,0,-1),q(V.y-V.x,-V.x-V.y,V.x,V.y,0,1)),1===b&&(q(-V.y-V.x,V.x-V.y,V.x,V.y,-1,-1),q(V.y-V.x,-V.x-V.y,V.x,V.y,-1,1)),1!==b&&0!==b||(q(-V.y,V.x,V.x,V.y,0,-1),q(V.y,-V.x,V.x,V.y,0,1));continue}if(i){a(z,M),k=z.x,C=z.y,1!==b&&0!==b||(q(M.y,-M.x,-M.x,-M.y,0,-1),q(-M.y,M.x,-M.x,-M.y,0,1)),2===b&&(q(M.y-M.x,-M.x-M.y,-M.x,-M.y,0,-1),q(-M.y-M.x,M.x-M.y,-M.x,-M.y,0,1)),1===b&&(q(M.y-M.x,-M.x-M.y,-M.x,-M.y,1,-1),q(-M.y-M.x,M.x-M.y,-M.x,-M.y,1,1));continue}}let r,f,D=-h(M,V);if(Math.abs(D)<.01)p(M,V)>0?(z.x=M.x,z.y=M.y,D=1,r=Number.MAX_VALUE,f=!0):(o(z,V),D=1,r=1,f=!1);else{z.x=(M.x+V.x)/D,z.y=(M.y+V.y)/D,r=u(z);const e=(r-1)*v*y;f=r>4||e>I&&e>T}k=z.x,C=z.y;let B=m;switch(m){case 0:r<1.05&&(B=2);break;case 1:r<g&&(B=2);break;case 2:r>x&&(B=0)}switch(B){case 2:if(q(z.x,z.y,-M.x,-M.y,0,-1),q(-z.x,-z.y,-M.x,-M.y,0,1),i)break;if(O){const e=W?0:A;F=this.writeVertex(_,j,k,C,V.x,V.y,z.x,z.y,0,-1,e),N=this.writeVertex(_,j,k,C,V.x,V.y,-z.x,-z.y,0,1,e)}break;case 0:{const e=D<0;let t,r,s,n;if(e){const e=F;F=N,N=e,t=P,r=L}else t=L,r=P;if(f)s=e?o(this.innerPrev,M):a(this.innerPrev,M),n=e?a(this.innerNext,V):o(this.innerNext,V);else{const t=e?c(this.inner,z):l(this.inner,z);s=t,n=t}const u=e?a(this.bevelStart,M):o(this.bevelStart,M);q(s.x,s.y,-M.x,-M.y,t.x,t.y);const h=q(u.x,u.y,-M.x,-M.y,r.x,r.y);if(i)break;const p=e?o(this.bevelEnd,V):a(this.bevelEnd,V);if(f){const e=this.writeVertex(_,j,k,C,-M.x,-M.y,0,0,0,0,A);F=this.writeVertex(_,j,k,C,V.x,V.y,n.x,n.y,t.x,t.y,A),N=this.writeVertex(_,j,k,C,V.x,V.y,p.x,p.y,r.x,r.y,A),this.writeTriangle(h,e,N)}else{if(O){const e=this.bevelMiddle;e.x=(u.x+p.x)/2,e.y=(u.y+p.y)/2,d(E,e,-M.x,-M.y),q(e.x,e.y,-M.x,-M.y,E.x,E.y),d(E,e,V.x,V.y),F=this.writeVertex(_,j,k,C,V.x,V.y,e.x,e.y,E.x,E.y,A),N=this.writeVertex(_,j,k,C,V.x,V.y,n.x,n.y,t.x,t.y,A)}else{const e=F;F=N,N=e}q(p.x,p.y,V.x,V.y,r.x,r.y)}if(e){const e=F;F=N,N=e}break}case 1:{const e=D<0;let t,s;if(e){const e=F;F=N,N=e,t=P,s=L}else t=L,s=P;const n=e?c(this.inner,z):l(this.inner,z);let u,h;f?(u=e?o(this.innerPrev,M):a(this.innerPrev,M),h=e?a(this.innerNext,V):o(this.innerNext,V)):(u=n,h=n);const y=e?a(this.roundStart,M):o(this.roundStart,M),b=e?o(this.roundEnd,V):a(this.roundEnd,V),m=q(u.x,u.y,-M.x,-M.y,t.x,t.y),x=q(y.x,y.y,-M.x,-M.y,s.x,s.y);if(i)break;const g=this.writeVertex(_,j,k,C,-M.x,-M.y,0,0,0,0,A);f||this.writeTriangle(F,N,g);const v=c(this.outer,n),w=this.writeVertex(_,j,k,C,V.x,V.y,b.x,b.y,s.x,s.y,A);let S,I;const T=r>2;if(T){let t;r!==Number.MAX_VALUE?(v.x/=r,v.y/=r,t=p(M,v),t=(r*(t*t-1)+1)/t):t=-1,S=e?a(this.startBreak,M):o(this.startBreak,M),S.x+=M.x*t,S.y+=M.y*t,I=e?o(this.endBreak,V):a(this.endBreak,V),I.x+=V.x*t,I.y+=V.y*t}d(E,v,-M.x,-M.y);const R=this.writeVertex(_,j,k,C,-M.x,-M.y,v.x,v.y,E.x,E.y,A);d(E,v,V.x,V.y);const B=O?this.writeVertex(_,j,k,C,V.x,V.y,v.x,v.y,E.x,E.y,A):R,W=g,U=O?this.writeVertex(_,j,k,C,V.x,V.y,0,0,0,0,A):g;let G=-1,Z=-1;if(T&&(d(E,S,-M.x,-M.y),G=this.writeVertex(_,j,k,C,-M.x,-M.y,S.x,S.y,E.x,E.y,A),d(E,I,V.x,V.y),Z=this.writeVertex(_,j,k,C,V.x,V.y,I.x,I.y,E.x,E.y,A)),O?T?(this.writeTriangle(W,x,G),this.writeTriangle(W,G,R),this.writeTriangle(U,B,Z),this.writeTriangle(U,Z,w)):(this.writeTriangle(W,x,R),this.writeTriangle(U,B,w)):T?(this.writeTriangle(g,x,G),this.writeTriangle(g,G,Z),this.writeTriangle(g,Z,w)):(this.writeTriangle(g,x,R),this.writeTriangle(g,B,w)),f?(F=this.writeVertex(_,j,k,C,V.x,V.y,h.x,h.y,t.x,t.y,A),N=w):(F=O?this.writeVertex(_,j,k,C,V.x,V.y,h.x,h.y,t.x,t.y,A):m,this.writeTriangle(F,U,w),N=w),e){const e=F;F=N,N=e}break}}}}}},604:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(88),s=i(80),n=i(265),a=i(123),o=i(504),l=i(325),c=i(430),u=i(402);const h=s.a.getLogger("esri/views/2d/engine/webgl/util/Matcher");async function p(e,t,i){switch(e.type){case"simple":return d.fromBasicRenderer(e,t,i);case"map":return b.fromUVRenderer(e,t,i);case"interval":return y.fromCBRenderer(e,t,i);case"dictionary":return m.fromDictionaryRenderer(e,t,i);case"subtype":return f.fromSubtypes(e,t,i)}}class d{constructor(){this.type="feature",this._defaultResult=null}static async fromBasicRenderer(e,t,i){const r=new d;if(e.symbol){const s=await Object(o.a)(e.symbol,i),n=t.createTemplateGroup(s,null);r.setDefault(n)}return r}size(){return 1}getDefault(){return this._defaultResult}setDefault(e){this._defaultResult=e}match(e,t,i,r,s){return this.getDefault()}async analyze(e,t,i,r,s){return null}}class f extends d{constructor(e,t){super(),this._subMatchers=e,this._subtypeField=t}static async fromSubtypes(e,t,i){const r=new Map,s=[];for(const n in e.renderers){const a=parseInt(n,10),o=p(e.renderers[n],t,i).then((e=>r.set(a,e)));s.push(o)}return await Promise.all(s),new f(r,e.subtypeField)}match(e,t,i,r,s){const n=t.readAttribute(this._subtypeField),a=this._subMatchers.get(n);return a?a.match(e,t,i,r,s):null}}class y extends d{constructor(e,t,i,r){super(),this.type="interval",this._intervals=[],this._isMaxInclusive=t,this._fieldIndex=r,this._field=e,this._normalizationInfo=i}static async fromCBRenderer(e,t,i){const{isMaxInclusive:r,normalizationField:s,normalizationTotal:n,normalizationType:a}=e,l=e.field,c=new y(l,r,{normalizationField:s,normalizationTotal:n,normalizationType:a},e.fieldIndex),u=await Object(o.a)(e.backgroundFillSymbol,i);await Promise.all(e.intervals.map((async e=>{const r=await Object(o.a)(e.symbol,i),s=await t.createTemplateGroup(r,u),n={min:e.min,max:e.max};c.add(n,s)})));const h=await Object(o.a)(e.defaultSymbol,i);if(h){const e=await t.createTemplateGroup(h,u);c.setDefault(e)}return c}add(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort(((e,t)=>e.interval.min-t.interval.min))}size(){return super.size()+this._intervals.length}match(e,t,i,r,s){if(null==this._fieldIndex&&!this._field)return this.getDefault();const n=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(!n&&(null==n||isNaN(n)))return this.getDefault();for(let a=0;a<this._intervals.length;a++){const{interval:e,result:t}=this._intervals[a],i=n>=e.min,r=this._isMaxInclusive?n<=e.max:n<e.max;if(i&&r)return t}return this.getDefault()}_needsNormalization(){const e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}_getValueFromField(e){const t=e.readAttribute(this._field);if(!this._needsNormalization()||null==t)return t;const{normalizationField:i,normalizationTotal:r,normalizationType:s}=this._normalizationInfo,n=!!i&&e.readAttribute(i);if(s)switch(s){case"esriNormalizeByField":return n?t/n:void 0;case"esriNormalizeByLog":return Math.log(t)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return t/r*100;default:return void h.error(`Found unknown normalization type: ${s}`)}else h.error("Normalization is required, but no type was set!")}}class b extends d{constructor(e,t,i){super(),this.type="map",this._nullResult=null,this._resultsMap=new Map,this._fieldsIndex=i,this._fields=e,this._seperator=t||""}static async fromUVRenderer(e,t,i){const r=e.fieldDelimiter,s=[e.field];e.field2&&s.push(e.field2),e.field3&&s.push(e.field3);const n=await Object(o.a)(e.backgroundFillSymbol,i),a=new b(s,r,e.fieldIndex);await Promise.all(e.map.map((async e=>{const r=await Object(o.a)(e.symbol,i),s=await t.createTemplateGroup(r,n);"<Null>"===e.value?a.setNullResult(s):a.add(e.value,s)})));const l=await Object(o.a)(e.defaultSymbol,i);if(l){const e=await t.createTemplateGroup(l,n);a.setDefault(e)}return a}setNullResult(e){this._nullResult=e}add(e,t){this._resultsMap.set(e.toString(),t)}size(){return super.size()+this._resultsMap.size}match(e,t,i,r,s){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();const n=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==n||""===n||"<Null>"===n))return this._nullResult;if(!n&&null==n)return this.getDefault();const a=n.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()}_getValueFromFields(e){const t=[];for(const i of this._fields){const r=e.readAttribute(i);null==r||""===r?t.push("<Null>"):t.push(r)}return t.join(this._seperator)}}class m extends d{constructor(e,t,i,r){super(),this.type="dictionary",this._groupIdCache=new n.a(100),this._renderer=e,this._fieldMap=e.fieldMap,this._symbolFields=e.getSymbolFields(),this._templates=t,this._info=i,this._scaleFn=r}static async fromDictionaryRenderer(e,t,r){const s=(await Promise.resolve().then(i.bind(null,199))).default.fromJSON(e.renderer);await s.fetchResources({spatialReference:r.spatialReference,fields:r.fields});const n=await async function(e,t){const i=e||1;if("number"==typeof i)return(e,t,r)=>i;const r=await Object(a.d)(i,t.spatialReference,t.fields);return(e,i,s)=>Object(c.a)(r,e,{$view:s},t.geometryType,i)||1}(s.scaleExpression,r);return new m(s,t,r,n)}async _analyzeFeature(e,t,i,s){const n=e.readLegacyFeature(),a=this._scaleFn(n,t,i),c=this._attributeHash(n)+"-"+a,p=this._groupIdCache.get(c);if(p)return p;const d={...i,spatialReference:this._info.spatialReference,abortOptions:s,fields:this._info.fields},f=await this._renderer.getSymbolAsync(n,d),y=Object(u.c)(f,this._renderer),b=Object(o.a)(y,this._info,s).then((e=>{if("expanded-cim"!==e.type)return h.error(new r.a("mapview-bad-type",`Found unexpected type ${e.type} in dictionary response`)),null;e.hash+="-"+a;for(const t of e.layers)t.scaleFactor=a,t.templateHash+="-"+a,"text"===t.type&&"string"==typeof t.text&&t.text.indexOf("[")>-1&&(t.text=Object(l.c)(this._fieldMap,t.text,t.cim.textCase));return this._templates.createTemplateGroup(e,null)}));return this._groupIdCache.put(c,b,1),b}async analyze(e,t,i,r,s){const n=t.getCursor(),a=[];for(;n.next();)a.push(this._analyzeFeature(n,i,r,s));return Promise.all(a)}match(e,t,i,r,s){return null}_attributeHash(e){let t="";for(const i of this._symbolFields){const r=this._fieldMap[i];r&&(t+=e.attributes[r]+"-")}return t}}},610:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));i(687),i(556);var r=i(336),s=(i(628),i(651),i(117)),n=i(130),a=i(163);const o=new Map;o.set(n.d.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),o.set(n.d.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),o.set(n.d.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),o.set(n.d.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),o.set(n.d.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4});var l=i(408);class c{constructor(e,t,i){this._start={index:0,vertex:0};const r=function(e,t,i){const{indicesPerRecord:r,multiplier:n,verticesPerRecord:a}=o.get(e);return{recordBytes:i*s.d*Uint32Array.BYTES_PER_ELEMENT,indexBytes:n*r*i*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:n*a*i*t}}(e,t,i),n=t/4;this.geometryType=e,this._records=new l.a(Int32Array,r.recordBytes),this._indices=new l.a(Uint32Array,r.indexBytes),this._vertices=new l.a(Uint32Array,r.vertexBytes),this._metrics=new l.a(Float32Array,0),this._strideInt=n}serialize(e){const t=this._records.buffer(),i=this._indices.buffer(),r=this._vertices.buffer(),s=this._metrics.length?this._metrics.buffer():null,n=4*this._strideInt;return e.push(t,i,r),{stride:n,records:t,indices:i,vertices:r,metrics:s}}get strideInt(){return this._strideInt}get recordCount(){return this._records.length/s.d}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}vertexEnsureSize(e){this._vertices.ensureSize(e)}indexEnsureSize(e){this._indices.ensureSize(e)}recordStart(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}recordEnd(e,t,i,r,s,n,a,o){this._records.push(e),this._records.push(t),this._records.push(i),this._records.push(r),this._records.push(s),this._records.push(n),this._records.push(a),this._records.writeF32(o)}writeIndex(e){this._indices.push(e)}writeVertex(e){this._vertices.push(e)}writeVertexF32(e){this._vertices.writeF32(e)}copyLastFrom(e,t,i){const r=e._records.length-s.d,n=e._records.getValue(r),a=e._records.getValue(r+1),o=e._records.getValue(r+2),l=e._records.getValue(r+4),c=e._records.getValue(r+6),u=e._records.getValue(r+7),h=this._vertices.length,p=(e._start.vertex-this._vertices.length)/this._strideInt,d=this._indices.length,f=this.vertexCount;for(let s=e._start.index;s!==e._indices.length;s++){const t=e._indices.getValue(s);this._indices.push(t-p)}for(let s=e._start.vertex;s!==e._vertices.length;s++){const t=e._vertices.getValue(s);this._vertices.push(t)}for(let s=h;s<=this._vertices.length;s+=this._strideInt)this._vertices.i1616Add(s,t,i);this._records.push(n),this._records.push(a),this._records.push(o),this._records.push(d),this._records.push(l),this._records.push(f),this._records.push(c),this._records.push(u)}}var u=i(390),h=i(564);const p=128;function d(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case p:return 1}}function f(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case p:return 1}}class y{constructor(e,t,i,r,s){this._hasDotDensity=!1,this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,sortKey:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=t,this.tileKey=e,this._hasDotDensity=i,this._hasAggregate=r,this._pixelBufferEnabled=s}get hasAggregates(){return this._hasAggregate}get hasPixelBufferEnabled(){return this._pixelBufferEnabled}serialize(e){const t=[];return t.push(this._serializeTileVertexData(this.tileKey,this.tileKey,this._data.self)),this._data.neighbors.forEach(((i,s)=>{const n=1<<s,a=d(n),o=f(n),l=Object(h.a)(new r.a(this.tileKey),a,o,e),c=this._serializeTileVertexData(this.tileKey,l.id,i.vertexData);c.message.bufferIds=i.displayIds,t.push(c)})),t}_serializeTileVertexData(e,t,i){var r,s,a,o,l;const c=new Array;return{message:{tileKeyOrigin:e,tileKey:t,data:{[n.d.MARKER]:null==(r=i.get(n.d.MARKER))?void 0:r.serialize(c),[n.d.FILL]:null==(s=i.get(n.d.FILL))?void 0:s.serialize(c),[n.d.LINE]:null==(a=i.get(n.d.LINE))?void 0:a.serialize(c),[n.d.TEXT]:null==(o=i.get(n.d.TEXT))?void 0:o.serialize(c),[n.d.LABEL]:null==(l=i.get(n.d.LABEL))?void 0:l.serialize(c)}},transferList:c}}featureStart(e,t){this._current.insertAfter=e,this._current.sortKey=t}featureEnd(){}recordStart(e,t,i,r,s){this._current.writer=this._getVertexWriter(i,r),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=s,this._current.id=e,this._current.materialKey=t,this._current.geometryType=i,this._current.isDotDensity=!1,this._current.writer.recordStart()}recordCount(){return this._current.writer.recordCount}vertexCount(){return this._current.writer.vertexCount}indexCount(){return this._current.writer.indexCount}vertexEnsureSize(e){this._current.writer.vertexEnsureSize(e)}indexEnsureSize(e){this._current.writer.indexEnsureSize(e)}vertexBounds(e,t,i,r){this._current.bufferingEnabled&&this._addOverlap(e,t,i,r)}vertexWrite(e){this._current.writer.writeVertex(e)}vertexWriteF32(e){this._current.writer.writeVertexF32(e)}vertexEnd(){}vertexWriter(){return this._current.writer.vertexWriter}indexWrite(e){this._current.writer.writeIndex(e)}indexWriter(){return this._current.writer.indexWriter}metricWriter(){return this._current.writer.metricWriter}metricStart(e,t,i,r,s,a,o,l){this._current.writer=this._getVertexWriter(n.d.LABEL,!1);const c=this._current.writer.metricWriter;c.push(Object(u.b)(e)),c.push(t),c.push(i),c.push(r),c.push(s),c.push(a),c.push(o),c.push(l),c.push(255),this._current.metricBoxLenPointer=c.push(0)}metricEnd(){const e=this._current.writer.metricWriter;0===e.getValue(this._current.metricBoxLenPointer)&&e.seek(e.length-10)}metricBoxWrite(e,t,i,r){const s=this._current.writer.metricWriter;s.incr(this._current.metricBoxLenPointer),s.push(0),s.push(0),s.push(e),s.push(t),s.push(i),s.push(r)}recordEnd(){const e=this._current.indexStart,t=this._current.writer.indexCount;if(e===t)return!1;this.hasRecords=!0;const i=t-e,r=this._current.vertStart,o=this._current.writer.vertexCount-r;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,e,i,r,o,this._current.sortKey),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===n.d.LABEL)return!0;const l=this._current.writer;for(let n=0;n<8;n++){const e=1<<n;if(this._current.overlaps&e){this._data.neighbors[n]||(this._data.neighbors[n]={vertexData:new Map,displayIds:new Set});const t=this._data.neighbors[n],i=this._current.geometryType;if(!t.vertexData.has(i)){const e=Object(a.l)(i,this._current.isDotDensity).geometry,r=new c(i,e,s.n);t.vertexData.set(i,r)}const r=t.vertexData.get(this._current.geometryType),o=8,u=512*-d(e)*o,h=512*-f(e)*o;r.copyLastFrom(l,u,h),t.displayIds.add(this._current.id)}}return!0}_addOverlap(e,t,i,r){const n=255^((e<0+i?148:e>=s.D-i?41:189)|(t<0+r?224:t>=s.D-r?7:231));this._current.overlaps|=n}_getVertexWriter(e,t){if(!this._data.self.has(e)){const t=this._data.self,i=Object(a.l)(e,this._hasDotDensity).geometry;t.set(e,new c(e,i,this.hint.records))}return this._data.self.get(e)}}},611:function(e,t,i){"use strict";i.d(t,"a",(function(){return L}));i(79);var r=i(85),s=i(91),n=i(441),a=i(88),o=i(80),l=i(108),c=i(100),u=i(320),h=i(206),p=i(117),d=i(130),f=i(159),y=i(161),b=i(672),m=i(224);function x(e){return e.length-1}function g(e){let t=0;for(let i=0;i<x(e);i++)t+=v(e,i);return t}function v(e,t,i=1){const[r,s]=function(e,t){return e[t+1]}(e,t);return Math.sqrt(r*r+s*s)*i}class O{constructor(e,t,i,r,s){this._segments=e,this._index=t,this._distance=i,this._xStart=r,this._yStart=s,this._done=!1}static create(e){return new O(e,0,0,e[0][0],e[0][1])}clone(){return new O(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){const e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length);let i=Math.acos(t);return e>0&&(i=2*Math.PI-i),i}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:e,dy:t}=this;return Math.sqrt(e*e+t*t)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<x(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,t){const i=this.backwardLength;if(e<=i)return this._distance=(i-e)/this.length,this;let r=this.backwardLength;for(;this.prev();){if(r+this.length>e)return this._seekBackwards(e-r);r+=this.length}return this._distance=0,t?this:null}seek(e,t=!1){if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let i=this.remainingLength;for(;this.next();){if(i+this.length>e)return this.seek(e-i,t);i+=this.length}return this._distance=1,t?this:null}}function _(e,t,i){const r=g(e),s=O.create(e),n=r/2,a=(r-t)/2,o=Math.floor(a/t),l=n-o*t;s.seek(l);for(let c=-o;c<=o;c++)s.x<512&&s.x>=0&&s.y<512&&s.y>=0&&i(s.clone(),c,n+c*t,r),s.seek(t)}function j(e,t){const i=1e-6;if(t<=0)return;const r=e.length;if(r<3)return;const s=[];let n=0;s.push(0);for(let h=1;h<r;h++)n+=Object(m.c)(e[h],e[h-1]),s.push(n);t=Math.min(t,.2*n);const a=[];a.push(e[0][0]),a.push(e[0][1]);const o=e[r-1][0],l=e[r-1][1],c=Object(m.h)([0,0],e[0],e[1]);Object(m.g)(c),e[0][0]+=t*c[0],e[0][1]+=t*c[1],Object(m.h)(c,e[r-1],e[r-2]),Object(m.g)(c),e[r-1][0]+=t*c[0],e[r-1][1]+=t*c[1];for(let h=1;h<r;h++)s[h]+=t;s[r-1]+=t;const u=.5*t;for(let h=1;h<r-1;h++){let n=0,o=0,l=0;for(let r=h-1;r>=0&&!(s[r+1]<s[h]-u);r--){const a=u+s[r+1]-s[h],c=s[r+1]-s[r],p=s[h]-s[r]<u?1:a/c;if(Math.abs(p)<i)break;const d=p*p,f=p*a-.5*d*c,y=p*c/t,b=e[r+1],m=e[r][0]-b[0],x=e[r][1]-b[1];n+=y/f*(b[0]*p*a+.5*d*(a*m-c*b[0])-d*p*c*m/3),o+=y/f*(b[1]*p*a+.5*d*(a*x-c*b[1])-d*p*c*x/3),l+=y}for(let a=h+1;a<r&&!(s[a-1]>s[h]+u);a++){const r=u-s[a-1]+s[h],c=s[a]-s[a-1],p=s[a]-s[h]<u?1:r/c;if(Math.abs(p)<i)break;const d=p*p,f=p*r-.5*d*c,y=p*c/t,b=e[a-1],m=e[a][0]-b[0],x=e[a][1]-b[1];n+=y/f*(b[0]*p*r+.5*d*(r*m-c*b[0])-d*p*c*m/3),o+=y/f*(b[1]*p*r+.5*d*(r*x-c*b[1])-d*p*c*x/3),l+=y}a.push(n/l),a.push(o/l)}a.push(o),a.push(l);for(let h=0,p=0;h<r;h++)e[h][0]=a[p++],e[h][1]=a[p++]}var w=i(482);const S=o.a.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");const M=function(e){const t=new Map;return i=>(t.has(i)||t.set(i,e(i)),t.get(i))}((e=>{let t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t})),V=e=>Math.floor(127*e+127),I=e=>Math.floor(10*e),T=e=>Math.round(e*(254/360));class z extends w.a{constructor(e,t,i,r){super(e,i.font.size,i.haloSize||0,i.color&&Object(h.d)(i.color)||0,i.haloColor&&Object(h.d)(i.haloColor)||0,i.horizontalAlignment,i.verticalAlignment,Object(b.a)(t.labelPlacement)?1:0,i.font.decoration,!1,i.angle||0,i.xoffset,i.yoffset,i.lineWidth,i.lineHeight,null,null,null,null,null),this._outLineLabelAngle=0,this._refPlacementPadding=0,this._refPlacementDirX=0,this._refPlacementDirY=0,this._refOffsetX=0,this._refOffsetY=0,this._zoomLevel=0,this.geometryType=d.d.LABEL;const s=function(e,t){const i=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return Object(l.f)(i,0,25.5)}(t,r),n=function(e,t){const i=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return Object(l.f)(i,0,25.5)}(t,r),a=t.labelPlacement,[o,f]=Object(u.b)(a);this._xAlignD=o,this._yAlignD=f,this._minZoom=s,this._maxZoom=n,this._refPlacementPadding=Object(c.h)(i.haloSize)+p.B;const m=y.b.load(e);m.sdf=!0,this._materialKey=m.data}static fromLabelClass(e,t){if("esriServerLinePlacementCenterAlong"===e.labelPlacement){const t=e.symbol;t.xoffset=0,t.yoffset=0,t.angle=0,t.font.decoration="none"}return new z(e.materialKey,e,e.symbol,t)}get _shapedBox(){return Object(r.s)(this._shapingInfo).bounds}setZoomLevel(e){this._zoomLevel=e}bindReferenceTemplate(e){let t=Object(u.e)(this._xAlignD),i=Object(u.g)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,Object(r.j)(e))return void(this._refSymbolAndPlacementOffset=Object(f.b)(0,0,V(t),V(i)));if("circle"===e.boundsType&&(t||i)){const e=Math.sqrt(t*t+i*i);t/=e,i/=e}const s=Math.max(e.height,e.width),n=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=Object(f.b)(n,s,V(t),V(i)),this._referenceSize=s,this._refPlacementDirX=t,this._refPlacementDirY=i,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}_write(e,t){if(Object(r.j)(this._shapingInfo))return;const i=this._shapingInfo,s=t.getDisplayId(),n="esriGeometryPolygon"===t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(n)switch(this.current={out:e,inId:s,inShaping:i,zoomLevel:this._zoomLevel},t.geometryType){case"esriGeometryPolyline":this._placeLineLabels(n);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(n);break;default:((e,t="mapview-labeling")=>{S.error(new a.a(t,e))})("mapview-labeling",`Geometry of type ${t.geometryType} is not supported`)}}_isVisible(e,t){const i=I(this.current.zoomLevel);return I(e)<=i&&i<=I(t)}_placePointLabels(e){const{out:t,inId:i,inShaping:r}=this.current;this._writeGlyphs(t,i,e,r)}_placeLineLabels(e){const t=function(e,t){const i=t;for(let r=0;r<e.length;r++){let t=e[r];const s=[];s.push(t[0]);for(let e=1;e<t.length;e++){let[i,r]=s[e-1];i+=t[e][0],r+=t[e][1],s.push([i,r])}j(s,i);const n=[];n.push(s[0]);for(let e=1;e<s.length;e++){const[t,i]=s[e-1],[r,a]=s[e],o=Math.round(r-t),l=Math.round(a-i);n.push([o,l])}e[r]=n,t=n}return e}(e.paths,this.current.inShaping.bounds.width),i=this._placeSubdivGlyphs.bind(this),r=(this._shapedBox.width+128)/2;for(const s of t)_(s,r,i)}_placeSubdivGlyphs(e,t,i,r){const s=M(t),n=this._shapedBox.width/2,a=Math.min(i,r-i),o=Object(l.n)(a/(8+n/2)),c=0===t?o:Math.min(s,o),u=Math.max(this._minZoom,this.current.zoomLevel+1-c),h=this.current.zoomLevel-u,p=this._shapedBox.width/2*2**h;this.current.inShaping.isMultiline?0===t&&this._placeStraight(e,u):this._placeCurved(e,u,p)}_placeStraight(e,t){const{out:i,inId:r,inShaping:s}=this.current;this._writeGlyphs(i,r,e,s,t)}_placeCurved(e,t,i){const{out:r,inId:s}=this.current;r.metricStart(s,t,e.x,e.y,0,0,0,0);const n=e.clone(),a=e.angle*(180/Math.PI)%360,o=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=T(a),this._placeFirst(n,t,1),this._placeBack(e,n,t,i,1),this._placeForward(e,n,t,i,1),this._outLineLabelAngle=T(o),this._placeFirst(n,t,0),this._placeBack(e,n,t,i,0),this._placeForward(e,n,t,i,0),r.metricEnd()}_placeBack(e,t,i,r,s){const n=e.clone();let a=e.backwardLength+0;for(;n.prev()&&!(a>=r);)this._placeOnSegment(n,t,a,i,-1,s),a+=n.length+0}_placeForward(e,t,i,r,s){const n=e.clone();let a=e.remainingLength+0;for(;n.next()&&!(a>=r);)this._placeOnSegment(n,t,a,i,1,s),a+=n.length+0}_placeFirst(e,t,i){const r=e,s=this.current.inShaping,n=s.glyphs,a=this.current.zoomLevel,{out:o,inId:c}=this.current;for(const u of n){const n=u.x>s.bounds.x?i:1-i,h=n*e.remainingLength+(1-n)*e.backwardLength,p=Math.abs(u.x+u.width/2-s.bounds.x),d=Math.max(0,a+Object(l.n)(p/(h+0))),f=Math.max(t,d);if(u.maxZoom=25,u.angle=e.angle+(1-i)*Math.PI,u.minZoom=f,this._writeGlyph(o,c,r.x,r.y,u),i&&this._isVisible(u.minZoom,u.maxZoom)){const e=u.bounds;o.metricBoxWrite(e.center[0],e.center[1],e.width,e.height)}}}_placeOnSegment(e,t,i,r,s,n){const a=this.current.inShaping.glyphs,{out:o,inId:c}=this.current,u=this.current.inShaping,h=this.current.zoomLevel,p=e.dx/e.length,d=e.dy/e.length,f={x:e.x+i*-s*p,y:e.y+i*-s*d};for(const y of a){const a=y.x>u.bounds.x?n:1-n;if(!(a&&1===s||!a&&-1===s))continue;const p=Math.abs(y.x+y.width/2-u.bounds.x),d=Math.max(0,h+Object(l.n)(p/i)-.1),b=Math.max(r,h+Object(l.n)(p/(i+e.length+0)));if(0!==d&&(y.angle=e.angle+(1-n)*Math.PI,y.minZoom=b,y.maxZoom=d,this._writeGlyph(o,c,f.x,f.y,y),n&&this._isVisible(y.minZoom,y.maxZoom))){const i=y.bounds,r=e.x-t.x,s=e.y-t.y;o.metricBoxWrite(i.center[0]+r,i.center[1]+s,i.width,i.height)}}}_writeGlyphs(e,t,i,r,s=this._minZoom){if(i.x<0||i.x>=512||i.y<0||i.y>=512)return;const n=i.x+this._refOffsetX,a=i.y-this._refOffsetY;for(const u of r.glyphs)u.minZoom=s,u.maxZoom=this._maxZoom,this._writeGlyph(e,t,n,a,u);const o=this._refPlacementDirX,l=this._refPlacementDirY,c=r.boundsT;e.metricStart(t,s,n,a,o,l,this._referenceSize,this._materialKey),e.metricBoxWrite(c.center[0],c.center[1],c.width,c.height),e.metricEnd()}_writeVertexCommon(e,t,i,r){const s=this._color,n=this._haloColor,a=Object(f.b)(0,0,this._size,this._haloSize),o=Math.max(r.minZoom,this._minZoom),l=Math.min(r.maxZoom,this._maxZoom),c=Object(f.b)(I(o),I(l),this._outLineLabelAngle,0);e.vertexWrite(i),e.vertexWrite(t),e.vertexWrite(s),e.vertexWrite(n),e.vertexWrite(a),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(c)}}var k=i(485),C=i(488),P=i(390);class L{constructor(e,t,i){this._loadPromise=Object(n.a)(),this._geometryType=e,this._idField=t,this._templateStore=i}update(e,t){Object(r.k)(e.mesh.labels)&&(this._labelTemplates=this._createLabelTemplates(e.mesh.labels,t)),this._schema=e}_createLabelTemplates(e,t){const i=new Map;if("simple"===e.type){for(const r of e.classes){const e=z.fromLabelClass(r,t);i.set(r.index,e)}return i}for(const r in e.classes){const s=e.classes[r];for(const e of s){const r=z.fromLabelClass(e,t);i.set(e.index,r)}}return i}get templates(){return this._templateStore}async analyze(e,t,i,n,a,o){if(Object(s.n)(o))return;let l;"dictionary"===t.type&&(l=await t.analyze(this._idField,e.copy(),n,a,o));let c=0;for(;e.next();){let s;if(s=l?l[c++]:Object(r.k)(i)&&Object(P.c)(e.getDisplayId())&&1!==e.readAttribute("cluster_count")?i.match(this._idField,e,this._geometryType,n,a):t.match(this._idField,e,this._geometryType,n,a),e.setGroupId(s),Object(C.b)(s)){const t=this._templateStore.getDynamicTemplateGroup(s);for(const i of t)i&&i.analyze&&i.analyze(this._templateStore,e,n,a)}}return await this._loadPromise,this._templateStore.finalize(o)}async analyzeGraphics(e,t,i,r,n){if(Object(s.n)(n))return;const a=e.getCursor();for(t&&await t.analyze(this._idField,a.copy(),i,r,n);a.next();){let e=a.getGroupId();if(null!=e&&-1!==e||(e=t.match(this._idField,a,a.geometryType,i,r),a.setGroupId(e)),Object(C.b)(e)){const t=this._templateStore.getDynamicTemplateGroup(e);for(const e of t)e&&e.analyze&&e.analyze(this._templateStore,a,i,r)}a.setGroupId(e)}return await this._loadPromise,this._templateStore.finalize(n)}writeGraphic(e,t,i){const r=t.getGroupId(),s=t.getDisplayId(),n=this._templateStore.getTemplateGroup(r);if(e.featureStart(t.insertAfter,0),null!=s){if(Object(C.b)(r))for(const e of n)e.bindFeature(t,null,null);if(n){for(const r of n)r&&r.write(e,t,i);e.featureEnd()}}}writeCursor(e,t,i,s,n,a){const o=t.getGroupId(),l=t.getDisplayId(),c=this._templateStore.getTemplateGroup(o),u=this._schema.mesh.sortKey;let h=0;if(Object(r.k)(u)&&(h=null!=u.fieldIndex?t.getComputedNumericAtIndex(u.fieldIndex):null!=u.field?t.readAttribute(u.field):t.readAttribute(this._idField),h*="asc"===u.order?1:-1),e.featureStart(0,null==h||isNaN(h)?0:h),null!=l&&c){if(Object(C.b)(o))for(const e of c)e.bindFeature(t,i,s);for(const i of c)i.write(e,t,n);if(Object(r.k)(a)&&e.hasRecords){const i=a&&this._findLabelRef(c);this._writeLabels(e,t,a,i,n)}e.featureEnd()}}_findLabelRef(e){for(const t of e)if(t instanceof k.a)return t;return null}_writeLabels(e,t,i,s,n){for(const a of i)if(Object(r.k)(a)&&a){const{glyphs:i,rtl:r,index:o}=a,l=this._labelTemplates.get(o);l.setZoomLevel(n),l.bindReferenceTemplate(s),l.bindTextInfo(i,r),l.write(e,t,null)}}}},628:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var r=i(81),s=i(96),n=i(83),a=(i(79),i(84),i(80),i(82)),o=i(136),l=i(746);const c=new Set,u=[],h=new Map,p=[0,0];let d=class extends s.a{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:t,strategy:i}=this;this._queue=new l.a({concurrency:e,process:(e,i)=>{const r=this._keyToItem.get(e);return t(r,{signal:i})},peeker:"scale-first"===i?e=>this._peekByScaleFirst(e):e=>this._peekByCenterFirst(e)})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e){const t=e.key.id;if(this._queue.has(t))return this._queue.get(t);const i=this._queue.push(t),r=()=>{this._keyToItem.delete(t),this.notifyChange("updating")};return this._keyToItem.set(t,e),i.then(r,r),this.notifyChange("updating"),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((e=>{const t=this._keyToItem.get(e),s=this.tileInfoView.getTileScale(t.key);h.has(s)||(h.set(s,[]),i=Math.max(s,i),r=Math.min(s,r)),h.get(s).push(t.key),c.add(s)}));let s=this.state.scale;h.has(s)||(function(e,t){e.length=0,t.forEach((t=>e.push(t)))}(u,c),u.sort(),s=u.reduce(((e,t)=>Math.abs(t-s)<Math.abs(e-s)?t:e),u[0])),s=Math.min(s,i),s=Math.max(s,r);const n=h.get(s),a=t.getClosestInfoForScale(s),o=a.getColumnForX(this.state.center[0]),l=a.getRowForY(this.state.center[1]);return n.sort(((e,t)=>{const i=a.denormalizeCol(e.col,e.world),r=a.denormalizeCol(t.col,t.world);return Math.sqrt((o-i)*(o-i)+(l-e.row)*(l-e.row))-Math.sqrt((o-r)*(o-r)+(l-t.row)*(l-t.row))})),c.clear(),h.clear(),n[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,i=this.state.center;let r=Number.POSITIVE_INFINITY,s=null;return e.forEach((e=>{const n=this._keyToItem.get(e);t.getTileCoords(p,n.key);const a=Object(o.d)(p,i);a<r&&(r=a,s=n.key)})),s.id}};Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"concurrency",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"process",void 0),Object(r.a)([Object(n.b)()],d.prototype,"state",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"strategy",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"tileInfoView",void 0),Object(r.a)([Object(n.b)({readOnly:!0})],d.prototype,"updating",null),d=Object(r.a)([Object(a.a)("esri.views.2d.tiling.TileQueue")],d);var f=d},651:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i(118),s=i(136);class n{constructor(e,t,i){this.maxSize=e,this.tileInfoView=t,this.removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const t=this._tilePerId.get(e);if(!t)return null;const i=t.key.level,r=this._tileKeysPerLevel[i];a(this._tilePerId,e);for(let s=0;s<r.length;s++)if(r[s].id===e){r.splice(s,1);break}return t.visible=!0,t}add(e){e.visible=!1;const t=e.key,i=t.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const r=t.level;this._tileKeysPerLevel[r]||(this._tileKeysPerLevel[r]=[]),this._tileKeysPerLevel[r].push(t)}prune(e,t,i){let r=this._tilePerId.size;if(r<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;r>this.maxSize&&s>=0;)s!==e&&(r=this._pruneAroundCenterTile(r,t,i,s)),s--;r>this.maxSize&&(r=this._pruneAroundCenterTile(r,t,i,e))}_pruneAroundCenterTile(e,t,i,r){const n=this._tileKeysPerLevel[r];if(!n||0===n.length)return e;const{size:a,origin:o}=this.tileInfoView.tileInfo,l=i*a[0],c=i*a[1],u=[0,0],h=[0,0];for(n.sort(((e,i)=>(u[0]=o.x+l*(e.col+.5),u[1]=o.y-c*(e.row+.5),h[0]=o.x+l*(i.col+.5),h[1]=o.y-c*(i.row+.5),Object(s.j)(u,t)-Object(s.j)(h,t))));n.length>0;){const t=n.pop();if(this._removeTile(t.id),--e===this.maxSize)break}return e}_removeTile(e){const t=this._tilePerId.get(e);this.removedFunc&&this.removedFunc(t),a(this._tilePerId,e)}}function a(e,t){e.delete(t)}var o=i(716);const l=new(i(336).a)(0,0,0,0),c=new Map,u=[],h=[];class p{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this.resampling=null==e.resampling||!!e.resampling,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),null!=e.buffer&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new n(e.cacheSize,this.tileInfoView,(e=>{this.releaseTile(e)})))}destroy(){this.tileIndex.clear()}update(e){const{resampling:t,tileIndex:i}=this,r=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.coveragePolicy);if(h.length=0,u.length=0,c.clear(),!r)return;const{minScale:s,maxScale:n}=this.tileInfoView.tileInfo,{spans:a,lodInfo:p}=r,{level:d}=p,{scale:f,center:y,resolution:b}=e.state,m=!e.stationary&&f>this._previousScale;if(this._previousScale=f,this.tiles.length=0,!t&&(f>s||f<n))return this.tiles.length=0,c.clear(),i.forEach((e=>{this.releaseTile(e)})),i.clear(),h.length=0,u.length=0,c.clear(),o.a.pool.release(r),!0;i.forEach((e=>e.visible=!0));let x=0,g=0;if(a.length>0)for(const{row:o,colFrom:u,colTo:h}of a)for(let e=u;e<=h;e++){x++;const t=l.set(d,o,p.normalizeCol(e),p.getWorldForColumn(e)).id;if(i.has(t)){const e=i.get(t);e.isReady?(c.set(t,e),g++):m||this._addParentTile(t,c)}else{let e;if(this._tileCache&&this._tileCache.has(t)){if(e=this._tileCache.pop(t),this.tileIndex.set(t,e),e.isReady){c.set(t,e),g++;continue}}else e=this.acquireTile(l),this.tileIndex.set(t,e);m||this._addParentTile(t,c)}}const v=g===x;i.forEach(((e,t)=>{if(l.set(t),c.has(t))return;const i=this.tileInfoView.intersects(r,l),s="purge"===this.cachePolicy?l.level!==d:l.level>d;!i||!m&&v?!s&&i||u.push(t):e.isReady?s&&"purge"===this.cachePolicy&&this._hasReadyAncestor(l,d)?u.push(t):h.push(t):s&&u.push(t)}));for(const o of h){const e=i.get(o);e&&e.isReady&&c.set(o,e)}for(const o of u){const e=i.get(o);this._tileCache?this._tileCache.add(e):this.releaseTile(e),i.delete(o)}return c.forEach((e=>this.tiles.push(e))),i.forEach((e=>{c.has(e.key.id)||(e.visible=!1)})),this._tileCache&&this._tileCache.prune(d,y,b),o.a.pool.release(r),c.clear(),v}clear(e=!0){const{tileIndex:t}=this;e&&t.forEach((e=>{this.releaseTile(e)})),t.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,t){let i=e,r=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(r=this.tileIndex.get(i),r&&r.isReady){t.has(r.key.id)||t.set(r.key.id,r);break}}else if(this._tileCache&&this._tileCache.has(i)&&(r=this._tileCache.pop(i),this.tileIndex.set(i,r),r&&r.isReady)){t.has(r.key.id)||t.set(r.key.id,r);break}}_hasReadyAncestor(e,t){const i=Object(r.l)();this.tileInfoView.getTileBounds(i,e,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=t&&s.key.level<e.level){const e=Object(r.l)();if(this.tileInfoView.getTileBounds(e,s.key,!0),Object(r.f)(e,i))return!0}return!1}}},672:function(e,t,i){"use strict";function r(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}i.d(t,"a",(function(){return r}))},687:function(e,t,i){"use strict";var r=i(81),s=i(96),n=i(83),a=(i(79),i(84),i(80),i(82)),o=i(136),l=i(746);const c=new Set,u=[],h=new Map,p=[0,0];let d=class extends s.a{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:e,process:t}=this;this._queue=new l.a({concurrency:e,process:(e,i)=>{const r=this._keyToItem.get(e);return t(r,{signal:i})},peeker:e=>e.values().next().value})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(e){return"string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause()}push(e,t){const i=e.key.id+"-"+t;if(this.has(i))return this.get(i);const r=this._queue.push(i),s=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,e),r.then(s,s),this.notifyChange("updating"),r}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((e=>{const t=this._keyToItem.get(e),s=this.tileInfoView.getTileScale(t.key);h.has(s)||(h.set(s,[]),i=Math.max(s,i),r=Math.min(s,r)),h.get(s).push(t.key),c.add(s)}));let s=this.state.scale;h.has(s)||(function(e,t){e.length=0,t.forEach((t=>e.push(t)))}(u,c),u.sort(),s=u.reduce(((e,t)=>Math.abs(t-s)<Math.abs(e-s)?t:e),u[0])),s=Math.min(s,i),s=Math.max(s,r);const n=h.get(s),a=t.getClosestInfoForScale(s),o=a.getColumnForX(this.state.center[0]),l=a.getRowForY(this.state.center[1]);return n.sort(((e,t)=>{const i=a.denormalizeCol(e.col,e.world),r=a.denormalizeCol(t.col,t.world);return Math.sqrt((o-i)*(o-i)+(l-e.row)*(l-e.row))-Math.sqrt((o-r)*(o-r)+(l-t.row)*(l-t.row))})),c.clear(),h.clear(),n[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,i=this.state.center;let r=Number.POSITIVE_INFINITY,s=null;return e.forEach((e=>{const n=this._keyToItem.get(e);t.getTileCoords(p,n.key);const a=Object(o.d)(p,i);a<r&&(r=a,s=n.key)})),s.id}};Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"concurrency",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"process",void 0),Object(r.a)([Object(n.b)()],d.prototype,"state",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"strategy",void 0),Object(r.a)([Object(n.b)({constructOnly:!0})],d.prototype,"tileInfoView",void 0),Object(r.a)([Object(n.b)({readOnly:!0})],d.prototype,"updating",null),d=Object(r.a)([Object(a.a)("esri.views.2d.tiling.PagedTileQueue")],d)}}]);
//# sourceMappingURL=90.65c941c5.chunk.js.map