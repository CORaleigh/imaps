(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[51],{1036:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r(2),i=r(3),a=r(46),s=r(834),o=r(537),c=function(){function e(t,r){Object(n.a)(this,e),this.width=t,this.height=r;var i=Math.ceil(t/1),a=Math.ceil(r/1);this._cols=i,this._rows=a,this._cells=s.a.create(i*a)}return Object(i.a)(e,[{key:"insertMetrics",value:function(e){return this._hasCollision(e)?255:(this._markMetrics(e),0)}},{key:"getCellId",value:function(e,t){return e+t*this._cols}},{key:"has",value:function(e){return this._cells.has(e)}},{key:"hasRange",value:function(e,t){return this._cells.hasRange(e,t)}},{key:"set",value:function(e){this._cells.set(e)}},{key:"setRange",value:function(e,t){this._cells.setRange(e,t)}},{key:"_hasCollision",value:function(e){var t=e.id,r=0,n=0;e.save();do{var i=e.boundsCount;r+=i;for(var a=0;a<i;a++){var s=e.boundsComputedAnchorX(a),o=e.boundsComputedAnchorY(a),c=e.boundsWidth(a)+16,u=e.boundsHeight(a)+16;switch(this._collide(s,o,c,u)){case 2:return!0;case 1:n++}}}while(e.peekId()===t&&e.next());return e.restore(),r===n}},{key:"_collide",value:function(e,t,r,n){var i=e-r/2,s=e+r/2,o=t-n/2,c=t+n/2;if(s<0||c<0||i>this.width||o>this.height)return 1;for(var u=Object(a.d)(Math.floor(i/1),0,this._cols),l=Object(a.d)(Math.floor(o/1),0,this._rows),h=Object(a.d)(Math.ceil(s/1),0,this._cols),f=Object(a.d)(Math.ceil(c/1),0,this._rows),v=l;v<=f;v++)for(var d=u;d<=h;d++){var y=this.getCellId(d,v);if(this.has(y))return 2}return 0}},{key:"_mark",value:function(e,t,r,n){for(var i=e-r/2,s=e+r/2,o=t-n/2,c=t+n/2,u=Object(a.d)(Math.floor(i/1),0,this._cols),l=Object(a.d)(Math.floor(o/1),0,this._rows),h=Object(a.d)(Math.ceil(s/1),0,this._cols),f=Object(a.d)(Math.ceil(c/1),0,this._rows),v=l;v<=f;v++)for(var d=u;d<=h;d++){var y=this.getCellId(d,v);this.set(y)}return!1}},{key:"_markMetrics",value:function(e){var t=e.id;do{for(var r=e.boundsCount,n=0;n<r;n++){var i=e.boundsComputedAnchorX(n),a=e.boundsComputedAnchorY(n),s=e.boundsWidth(n)+16,o=e.boundsHeight(n)+16;this._mark(i,a,s,o)}}while(e.peekId()===t&&e.next())}}]),e}(),u=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;Object(n.a)(this,e),this._bucketSize=t,this._rowsLength=o.E/t,this._colsLength=o.E/t,this._elementsPerBucket=r,this._grid=this._initGrid()}return Object(i.a)(e,[{key:"checkOverlap",value:function(e,t){var r=Math.floor(e/this._bucketSize),n=Math.floor(t/this._bucketSize);return r<0||r>=this._rowsLength||n<0||n>=this._colsLength||this._grid[n*this._colsLength+r]>=this._elementsPerBucket}},{key:"markUsed",value:function(e,t){var r=Math.floor(e/this._bucketSize),n=Math.floor(t/this._bucketSize);this._grid[n*this._colsLength+r]+=1}},{key:"reset",value:function(){this._grid=this._initGrid()}},{key:"_initGrid",value:function(){return new Uint8Array(this._rowsLength*this._colsLength)}}]),e}()},1073:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(4),s=r(5),o=r(0),c=(r(14),r(12),r(17),r(1)),u=r(8),l=(r(11),r(18),r(19),function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){var e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}}]),r}(r(99).a));Object(o.a)([Object(c.b)({readOnly:!0})],l.prototype,"supportsTileUpdates",null),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"remoteClient",void 0),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"service",void 0),Object(o.a)([Object(c.b)()],l.prototype,"spatialReference",null),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"tileInfo",void 0),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"tileStore",void 0);var h=l=Object(o.a)([Object(u.a)("esri.views.2d.layers.features.processors.BaseProcessor")],l);t.a=h},1208:function(e,t,r){"use strict";r.r(t);var n=r(15),i=r(7),a=r.n(i),s=r(16),o=r(2),c=r(3),u=r(4),l=r(5),h=r(0),f=r(14),v=r(6),d=r(12),y=(r(17),r(1),r(8)),_=(r(20),r(11),r(18),r(19),r(24)),p=r(44),x=r(540),b=r(537),m=r(867),O=r(1036),g=r(822),j=r(871),k=r(831),M=r(887),w=r(888),S=r(844),E=r(856),T=r(884),L=r(1073);function z(e){var t=e.message,r={message:{data:{},tileKey:t.tileKey},transferList:new Array};for(var n in t.data){var i=t.data[n];if(r.message.data[n]=null,Object(v.k)(i)){var a=i.stride,s=i.indices.slice(0),o=i.vertices.slice(0),c=i.records.slice(0),u={stride:a,indices:s,vertices:o,records:c,metrics:Object(v.b)(i.metrics,(function(e){return e.slice(0)}))};r.transferList.push(s,o,c),r.message.data[n]=u}}return r}d.a.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");var R=function(e){Object(u.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).type="symbol",e._matchers={feature:null,aggregate:null},e._bufferData=new Map,e}return Object(c.a)(r,[{key:"initialize",value:function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])}},{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!0}},{key:"update",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("symbol"===(n=r.schema.processors[0]).type){e.next=3;break}return e.abrupt("return");case 3:i=Object(x.a)(this._schema,n),Object(x.b)(i,"mesh")&&(Object(f.a)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",i),t.mesh=!0,t.why.mesh.push("Symbology changed"),this._schema=n,this._factory=this._createFactory(n),this._factory.update(n,this.tileStore.tileScheme.tileInfo));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"onTileMessage",value:function(e,t,r,n){return Object(_.u)(n),this._onTileData(e,t,r,n)}},{key:"onTileClear",value:function(e){return this._bufferData.delete(e.key.id),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:e.id,data:{clear:!0}})}},{key:"onTileError",value:function(e,t,r){var n=r.signal,i={tileKey:e.id,error:t};return this.remoteClient.invoke("tileRenderer.onTileError",i,{signal:n})}},{key:"onTileUpdate",value:function(e){var t,r=this,i=Object(n.a)(e.removed);try{for(i.s();!(t=i.n()).done;){var a=t.value;this._bufferData.has(a.key.id)&&(this._bufferData.get(a.key.id).forEach((function(e){var t=new Set;Object(g.g)((function(r){var n=e.message.data[r];if(Object(v.k)(n))for(var i=j.a.from(n.records).getCursor();i.next();)t.add(i.id)}));var n=e.message.tileKey;return r.remoteClient.invoke("tileRenderer.onTileData",{tileKey:n,data:{type:"update",addOrUpdate:null}})})),this._bufferData.delete(a.key.id))}}catch(u){i.e(u)}finally{i.f()}var s,o=Object(n.a)(e.added);try{var c=function(){var e=s.value;r._bufferData.forEach((function(t){var i,a=Object(n.a)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.message.tileKey===e.id&&r._updateTileMesh("append",e,z(s),[],!1,!1,null)}}catch(u){a.e(u)}finally{a.f()}}))};for(o.s();!(s=o.n()).done;)c()}catch(u){o.e(u)}finally{o.f()}}},{key:"_addBufferData",value:function(e,t){this._bufferData.has(e)||this._bufferData.set(e,[]),this._bufferData.get(e).push(z(t))}},{key:"_createFactory",value:function(e){var t=this,r=this.service,n=r.geometryType,i=r.objectIdField,a={geometryType:n,fields:r.fields,spatialReference:p.a.fromJSON(this.spatialReference)},s=new E.a((function(e,r){return t.remoteClient.invoke("tileRenderer.getMaterialItems",e,r)}),!1),o=e.mesh,c=o.matcher,u=o.aggregateMatcher;return this._store=s,this._matchers.feature=Object(w.a)(c,s,a),this._matchers.aggregate=Object(v.b)(u,(function(e){return Object(w.a)(e,s,a)})),new T.a(n,i,s)}},{key:"_onTileData",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,i,s){var o,c,u,l,h,f,d,y,p,x,b,m=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.type,c=r.addOrUpdate,u=r.remove,l=r.end,c){e.next=4;break}return h={type:o,addOrUpdate:null,remove:u,clear:!1,end:l},e.abrupt("return",this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:h},s));case 4:return f=this._processFeatures(t,c,i,s),e.prev=5,e.next=8,f;case 8:if(d=e.sent,!Object(v.j)(d)){e.next=12;break}return y={type:o,addOrUpdate:null,remove:u,clear:!1,end:l},e.abrupt("return",this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:y},s));case 12:p=Object(n.a)(d);try{for(p.s();!(x=p.n()).done;)b=x.value,t.key.id!==b.message.tileKey&&this._addBufferData(t.key.id,b)}catch(a){p.e(a)}finally{p.f()}return e.next=16,Object(_.b)(d.map((function(e){var n=t.key.id===e.message.tileKey,i=n?r.remove:[],a=n&&r.end;return m._updateTileMesh(o,t,e,i,a,r.clear,s.signal)})));case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),this._handleError(t,e.t0,s);case 21:case"end":return e.stop()}}),e,this,[[5,18]])})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_updateTileMesh",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n,i,s,o,c){var u,l,h,f,d,y;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=t,(l=n.message.tileKey)!==r.key.id&&(s=!1),h=Object(v.b)(n,(function(e){return e.message})),f=Object(v.b)(n,(function(e){return e.transferList}))||[],d={type:u,addOrUpdate:h,remove:i,clear:!1,end:s},y={transferList:Object(v.q)(f)||[],signal:c},e.abrupt("return",(Object(_.u)(y),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:l,data:d},y)));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,s,o){return e.apply(this,arguments)}}()},{key:"_processFeatures",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n,i){var s,o,c,u,l,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(v.j)(r)&&r.hasFeatures){e.next=2;break}return e.abrupt("return",null);case 2:return s={transform:t.transform,hasZ:!1,hasM:!1},o=this._factory,c={viewingMode:"",scale:t.scale},e.next=7,this._matchers.feature;case 7:return u=e.sent,e.next=10,this._matchers.aggregate;case 10:return l=e.sent,Object(_.u)(i),h=this._getLabelInfos(t,r),e.next=15,o.analyze(r.getCursor(),u,l,s,c);case 15:return Object(_.u)(i),e.abrupt("return",this._writeFeatureSet(t,r,s,h,o,n));case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"_writeFeatureSet",value:function(e,t,r,n,i,a){for(var s=t.getApproximateSize(),o="simple"===this._schema.mesh.matcher.type&&this._schema.mesh.matcher.isDotDensity,c=new M.a(e.key.id,{features:s,records:s,metrics:0},o,a,!0),u={viewingMode:"",scale:e.scale},l=t.getCursor();l.next();)try{var h=l.getDisplayId(),f=Object(v.k)(n)?n.get(h):null;i.writeCursor(c,l,r,u,e.level,f)}catch(y){}var d=e.tileInfoView.tileInfo.isWrappable;return c.serialize(d)}},{key:"_handleError",value:function(e,t,r){if(!Object(_.m)(t)){var n={tileKey:e.id,error:t.message};return this.remoteClient.invoke("tileRenderer.onTileError",n,{signal:r.signal})}}},{key:"_getLabelInfos",value:function(e,t){var r=this,i=this._schema.mesh.labels,a=Object(v.b)(i,(function(t){return t.filter((function(t){return function(e,t){return(!e.minScale||e.minScale>=t)&&(!e.maxScale||e.maxScale<=t)}(t,e.scale)}))}));if(Object(v.j)(a)||0===a.length)return null;for(var s=new Map,o=new O.b(b.e),c=t.getCursor(),u=function(){var e,t=c.getDisplayId(),i=!1,u=[],l=Object(k.c)(t),h=l&&1!==c.readAttribute("cluster_count")?"aggregate":"feature",f=Object(n.a)(a);try{var v=function(){var n=e.value;if(n.target!==h)return"continue";var a=c.getStorage(),s=l&&"feature"===h?a.getComputedStringAtIndex(c.readAttribute("referenceId"),n.fieldIndex):a.getComputedStringAtIndex(t,n.fieldIndex);if(!s)return"continue";var o=Object(m.a)(s.toString()),f=o[0],v=o[1];r._store.getMosaicItem(n.symbol,Object(S.a)(f)).then((function(e){u[n.index]={glyphs:e.glyphMosaicItems,rtl:v,index:n.index}})),i=!0};for(f.s();!(e=f.n()).done;)v()}catch(d){f.e(d)}finally{f.f()}s.set(t,u),i&&r._markUsed(o,c)};c.next();)u();return s}},{key:"_shouldDiscard",value:function(e,t){switch(this.service.geometryType){case"esriGeometryPoint":var r=t.readLegacyPointGeometry();return!r||e.checkOverlap(r.x,r.y);case"esriGeometryPolygon":var n=t.readLegacyCentroid();return!n||e.checkOverlap(n.x,n.y);default:return!1}}},{key:"_markUsed",value:function(e,t){switch(this.service.geometryType){case"esriGeometryPoint":var r=t.readLegacyPointGeometry(),n=r.x,i=r.y;return e.markUsed(n,i);case"esriGeometryPolygon":var a=t.readLegacyCentroid(),s=a.x,o=a.y;return e.markUsed(s,o)}}}]),r}(L.a),C=R=Object(h.a)([Object(y.a)("esri.views.2d.layers.features.processors.SymbolProcessor")],R);t.default=C},823:function(e,t,r){"use strict";r.d(t,"a",(function(){return O})),r.d(t,"b",(function(){return M})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return _})),r.d(t,"f",(function(){return k})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return y}));var n=r(10),i=r(30),a=r(28),s=r(4),o=r(5),c=r(2),u=r(3),l=r(20),h=r(821),f=r(903);function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=h.e.SIZE_FIELD_STOPS|h.e.SIZE_MINMAX_VALUE|h.e.SIZE_SCALE_STOPS|h.e.SIZE_UNIT_VALUE,n=(e&(h.f.FIELD_TARGETS_OUTLINE|h.f.MINMAX_TARGETS_OUTLINE|h.f.SCALE_TARGETS_OUTLINE|h.f.UNIT_TARGETS_OUTLINE))>>>4;return t?r&n:r&~n}function d(e,t,r,n,i){switch(e){case h.d.FILL:return O.from(t,n);case h.d.LINE:return j.from(t,r);case h.d.MARKER:return g.from(t);case h.d.TEXT:return k.from(t);case h.d.LABEL:return M.from(t,i);default:throw new Error("Unable to createMaterialKey for unknown geometryType ".concat(e))}}function y(e){switch(_.load(e).geometryType){case h.d.MARKER:return new g(e);case h.d.FILL:return new O(e);case h.d.LINE:return new j(e);case h.d.TEXT:return new k(e);case h.d.LABEL:return new M(e)}}var _=function(){function e(t){Object(c.a)(this,e),this._data=0,this._data=t}return Object(u.a)(e,[{key:"data",get:function(){return this._data},set:function(e){this._data=e}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(e){this.setBits(e,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(e){this.setBit(20,e)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(e){this.setBit(11,e)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(e){this.setBit(12,e)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(e){this.setBits(e,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case h.d.FILL:return"fill";case h.d.MARKER:return"marker";case h.d.LINE:return"line";case h.d.TEXT:return"text";case h.d.LABEL:return"label";default:throw new l.a("Unable to handle unknown geometryType: ".concat(this.geometryType))}}},{key:"setBit",value:function(e,t){var r=1<<e;t?this._data|=r:this._data&=~r}},{key:"bit",value:function(e){return(this._data&1<<e)>>e}},{key:"setBits",value:function(e,t,r){for(var n=t,i=0;n<r;n++,i++)this.setBit(n,0!=(e&1<<i))}},{key:"bits",value:function(e,t){for(var r=0,n=e,i=0;n<t;n++,i++)r|=this.bit(n)<<i;return r}},{key:"hasVV",value:function(){return!1}},{key:"setVV",value:function(e,t){}},{key:"getVariation",value:function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}},{key:"getVariationHash",value:function(){return this._data&~(7&this.textureBinding)}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}}]),e}();_.shared=new _(0);var p=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(e){this.setBit(16,e)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(e){this.setBit(17,e)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(e){this.setBit(18,e)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(e){this.setBit(19,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t);var n=v(e,t)&e;this.vvSizeMinMaxValue=!!(n&h.e.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(n&h.e.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(n&h.e.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(n&h.e.SIZE_SCALE_STOPS)}}]),r}(e)},x=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(e){this.setBit(15,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvRotation}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t),this.vvRotation=!t&&!!(e&h.e.ROTATION)}}]),r}(e)},b=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(e){this.setBit(13,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvColor}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t),this.vvColor=!t&&!!(e&h.e.COLOR)}}]),r}(e)},m=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(e){this.setBit(14,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvOpacity}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t),this.vvOpacity=!t&&!!(e&h.e.OPACITY)}}]),r}(e)},O=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity})}},{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(e){this.setBit(15,e)}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e,t){var r=this.load(0);return r.geometryType=h.d.FILL,t?r.dotDensity=!0:r.setVV(e,!1),r.data}}]),r}(b(m(_)));O.shared=new O(0);var g=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=h.d.MARKER,t.setVV(e,!1),t.data}}]),r}(b(m(x(p(_)))));g.shared=new g(0);var j=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e,t){var r=this.load(0);return r.geometryType=h.d.LINE,r.setVV(e,t),r.data}}]),r}(b(m(p(_))));j.shared=new j(0);var k=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(e);return t.geometryType=h.d.TEXT,t.setVV(e,!1),t.data}}]),r}(b(m(x(p(_)))));k.shared=new k(0);var M=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e,t){var r=this.load(0);return r.geometryType=h.d.LABEL,r.setVV(e,!1),r.mapAligned=!!Object(f.a)(t),r.data}}]),r}(p(_));M.shared=new M(0)},829:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(6),s=r(15),o=r(913),c=r(835),u=r(874),l=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"executeEffects",value:function(e,t){var r,n=Object(c.c)(t),i=new o.a(n),a=Object(s.a)(e);try{for(a.s();!(r=a.n()).done;){var l=r.value,h=Object(u.a)(l);h&&(i=h.execute(i,l,1.3333333333333333))}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"next",value:function(e){var t=e.next();return Object(c.d)(t),t}}]),e}(),h=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"bindFeature",value:function(e,t,r){}},{key:"write",value:function(e,t){if(Object(a.j)(this._effects))return this._write(e,t);for(var r=l.executeEffects(this._effects,t.readLegacyGeometry()),n=l.next(r);n;)this._write(e,t,n),n=l.next(r)}},{key:"_write",value:function(e,t,r){}}]),e}();t.a=h},830:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(20);function i(e,t){if(e&&"name"in e){var r=e;return t&&t.error(new n.a(r.name,r.message,r.details)),!1}return!0}},832:function(e,t,r){"use strict";var n=r(2),i=r(3),a=function(){function e(t,r){Object(n.a)(this,e),this._pos=0;var i=r?this._roundToNearest(r,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new t(this._array),this._ctor=t,this._i16View=new Int16Array(this._array)}return Object(i.a)(e,[{key:"length",get:function(){return this._pos}},{key:"_roundToNearest",value:function(e,t){var r=Math.round(e);return r+(t-r%t)}},{key:"_ensureSize",value:function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest(1.5*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),r=new ArrayBuffer(t),n=new this._ctor(r);n.set(this._buffer,0),this._array=r,this._buffer=n,this._i16View=new Int16Array(this._array)}}},{key:"writeF32",value:function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}},{key:"push",value:function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t}},{key:"writeFixed",value:function(e){this._buffer[this._pos++]=e}},{key:"setValue",value:function(e,t){this._buffer[e]=t}},{key:"i1616Add",value:function(e,t,r){this._i16View[2*e]+=t,this._i16View[2*e+1]+=r}},{key:"getValue",value:function(e){return this._buffer[e]}},{key:"incr",value:function(e){if(this._buffer.length<e)throw new Error("Increment index overflows the target buffer");this._buffer[e]++}},{key:"decr",value:function(e){this._buffer[e]--}},{key:"writeRegion",value:function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}},{key:"writeManyFrom",value:function(e,t,r){this._ensureSize(r-t);for(var n=t;n!==r;n++)this.writeFixed(e._buffer[n])}},{key:"buffer",value:function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e}},{key:"toArray",value:function(){for(var e=this._array,t=[],r=0;r<e.byteLength/4;r++)t.push(e[r]);return t}},{key:"seek",value:function(e){this._pos=e}},{key:"destroy",value:function(){this._array=null,this._buffer=null}}]),e}();t.a=a},833:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return o}));Number.POSITIVE_INFINITY;var n=Math.PI,i=128/n,a=1/Math.LN2;function s(e,t){return(e%=t)>=0?e:e+t}function o(e){return s(e*i,256)}function c(e){return s(.7111111111111111*e,256)}function u(e){return Math.log(e)*a}function l(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}},844:function(e,t,r){"use strict";function n(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}r.d(t,"a",(function(){return n}))},851:function(e,t,r){"use strict";var n=r(29),i=r(2),a=r(3),s=r(4),o=r(5),c=r(37),u=r(837),l=r(867),h=r(823),f=r(825),v=r(852),d=r(829),y=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(e,n,a,s,o,l,f,v,d,y,_,p,x,b,m,O,g){var j,k=arguments.length>17&&void 0!==arguments[17]&&arguments[17];Object(i.a)(this,r),(j=t.call(this))._xOffset=Object(c.h)(p),j._yOffset=Object(c.h)(x),j._decoration=d||"none",j._color=s,j._haloColor=o,j._haloSize=Math.min(Math.floor(5*Object(c.h)(Object(c.k)(a))),127),j._size=Math.min(Math.round(Object(c.h)(n)),127);var M=Math.min(Math.round(Object(c.h)(n)),127);j._referenceSize=Math.round(Math.sqrt(256*M)),j._scale=j._size/24,j._angle=_,j._justify=Object(u.c)(l||"center"),j._xAlignD=Object(u.d)(l||"center"),j._yAlignD=Object(u.f)(f||"baseline"),j._baseline="baseline"===(f||"baseline"),j._bitset=(1===v?1:0)|(y?1:0)<<1;var w=h.e.load(e);return w.sdf=!0,j._materialKey=w.data,j._lineWidth=Object(c.h)(b)||512,j._lineHeight=m||1,j._textPlacement=O,j._effects=g,j._isCIM=k,j}return Object(a.a)(r,null,[{key:"fromText",value:function(e,t){var i=new r(e.materialKey,e.font.size,e.haloSize||0,e.color&&Object(f.d)(e.color)||0,e.haloColor&&Object(f.d)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1),a=Object(l.a)(e.text),s=Object(n.a)(a,2)[1];return i.bindTextInfo(t,s),i._vertexBoundsScale=e.maxVVSize?e.maxVVSize/e.font.size:1,i}},{key:"fromCIMText",value:function(e,t){var i=e.scaleFactor||1,a=e.size*e.sizeRatio*i,s=new r(e.materialKey,a,e.outlineSize*e.sizeRatio,Object(f.c)(e.color),Object(f.c)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*i,e.offsetY*e.sizeRatio*i,512,1,e.markerPlacement,e.effects,!0),o=Object(l.a)(e.text),c=Object(n.a)(o,2)[1];return s.bindTextInfo(t,c),s._vertexBoundsScale=e.maxVVSize?e.maxVVSize/a:1,s}}]),r}(Object(v.a)(d.a));t.a=y},852:function(e,t,r){"use strict";var n=r(15),i=r(29),a=r(2),s=r(3),o=r(4),c=r(5),u=r(6),l=r(37),h=r(511),f=r(537),v=r(824),d=r(919),y=r(821),_=r(823),p=r(853);t.a=function(e){return function(e){Object(o.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(a.a)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i)))._isCIM=!1,e._vertexBoundsScale=1,e.geometryType=y.d.TEXT,e._aux=Object(v.b)(0,0,e._referenceSize,e._bitset),e}return Object(s.a)(r,[{key:"bindTextInfo",value:function(e,t){var r=this;e&&e.length?this._shapingInfo=Object(u.b)(e,(function(e){return Object(d.a)(e,t,{scale:r._scale,angle:r._angle,xOffset:r._xOffset,yOffset:r._yOffset,hAlign:r._xAlignD,vAlign:r._yAlignD,maxLineWidth:Math.max(32,Math.min(r._lineWidth,512)),lineHeight:f.l*Math.max(.25,Math.min(r._lineHeight,4)),decoration:r._decoration,isCIM:r._isCIM})})):this._shapingInfo=null}},{key:"_write",value:function(e,t,r){var n=t.getDisplayId();this._writeGeometry(e,t,n,r)}},{key:"_writeGeometry",value:function(e,t,r,n){var a=this,s=this._shapingInfo;if(!Object(u.j)(s)){if(Object(u.k)(this._textPlacement)){var o=null!=n?n:t.readLegacyGeometry();return this._writePlacedText(e,r,o,s)}var c=n?Object(h.p)(Object(h.d)(n),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readUnquantizedGeometry();if(c){if(c.isPoint){var l=Object(i.a)(c.coords,2),f=l[0],v=l[1];return this._writeGlyphs(e,r,{x:f,y:v},s)}c.forEachVertex((function(t,n){return a._writeGlyphs(e,r,{x:t,y:n},s)}))}}}},{key:"_writePlacedText",value:function(e,t,r,n){var i=Object(u.q)(this._textPlacement),a=p.a.getPlacement(r,i,Object(l.h)(1));if(a)for(var s=a.next();null!=s;){var o=s.getAngle();n.setRotation(o),this._writeGlyphs(e,t,{x:s.tx,y:s.ty},n),n.setRotation(-o),s=a.next()}}},{key:"_writeGlyphs",value:function(e,t,r,i){var a,s=_.e.load(this._materialKey),o=Object(v.a)(Math.round(8*r.x),Math.round(8*r.y)),c=Object(n.a)(i.glyphs);try{for(c.s();!(a=c.n()).done;){var u=a.value;s.textureBinding=u.textureBinding,e.recordStart(t,s.data,this.geometryType,!1,!0);var l=u.bounds,h=this._vertexBoundsScale;e.vertexBounds(l.x*h,l.y*h,l.width*h,l.height*h),this._writeVertices(e,t,o,u),e.recordEnd()}}catch(f){c.e(f)}finally{c.f()}}},{key:"_writeGlyph",value:function(e,t,r,n,i){var a=_.e.load(this._materialKey),s=Object(v.a)(Math.round(8*r),Math.round(8*n));a.textureBinding=i.textureBinding,e.recordStart(t,a.data,this.geometryType,!1,!0);var o=i.bounds,c=this._vertexBoundsScale;e.vertexBounds(o.x*c,o.y*c,o.width*c,o.height*c),this._writeVertices(e,t,s,i),e.recordEnd()}},{key:"_writeVertices",value:function(e,t,r,n){var i=e.vertexCount();this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.upperLeft),e.vertexWrite(n.texcoords.upperLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.upperRight),e.vertexWrite(n.texcoords.upperRight),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.lowerLeft),e.vertexWrite(n.texcoords.lowerLeft),e.vertexEnd(),this._writeVertexCommon(e,t,r,n),e.vertexWrite(n.offsets.lowerRight),e.vertexWrite(n.texcoords.lowerRight),e.vertexEnd(),e.indexWrite(i+0),e.indexWrite(i+1),e.indexWrite(i+2),e.indexWrite(i+1),e.indexWrite(i+3),e.indexWrite(i+2)}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,s=Object(v.b)(0,0,this._referenceSize,this._bitset),o=Object(v.b)(0,0,this._size,this._haloSize);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(a),e.vertexWrite(o),e.vertexWrite(s)}}]),r}(e)}},853:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(3),a=r(835),s=r(874),o=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"getPlacement",value:function(e,t,r){var n=Object(s.b)(t);if(!n)return null;var i=Object(a.c)(e);return n.execute(i,t,r)}}]),e}()},854:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(4),s=r(5),o=r(6),c=r(37),u=r(537),l=r(399),h=r(513),f=r(824),v=r(823),d=r(825),y=r(829),_=r(855),p=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(e,i,a,s,o,c,d,y,_,p,x,b,m,O,g,j,k,M,w,S,E){var T;Object(n.a)(this,r),(T=t.call(this)).angle=s,T.height=d,T.width=c,T.xOffset=i*w,T.yOffset=a*w,T._markerPlacement=S,T._effects=E,T._anchorX=.5-(.5+j)*g.width/g.width,T._anchorY=.5-(.5+k)*g.height/g.height;var L=(1===O?1:0)|(x?1:0)<<1|(m?1:0)<<2|(b?1:0)<<3,z=g&&g.sdf,R=v.d.load(e);R.sdf=z,R.pattern=!0,R.textureBinding=g.textureBinding,T._materialKey=R.data,T._fillColor=o,T._outlineColor=_,T._sizeOutlineWidth=Object(f.b)(Math.round(Math.min(Math.sqrt(128*c),255)),Math.round(Math.min(Math.sqrt(128*d),255)),Math.round(Math.min(Math.sqrt(128*p),255)),Math.round(Math.min(Math.sqrt(128*y),255)));var C=g.rect.x+u.q,P=g.rect.y+u.q,I=C+g.width,V=P+g.height;T._offsets.xUpperLeft=C,T._offsets.yUpperLeft=P,T._offsets.xUpperRight=I,T._offsets.yUpperRight=P,T._offsets.xBottomLeft=C,T._offsets.yBottomLeft=V,T._offsets.xBottomRight=I,T._offsets.yBottomRight=V,T._texUpperLeft=Object(f.a)(C,P),T._texUpperRight=Object(f.a)(I,P),T._texBottomLeft=Object(f.a)(C,V),T._texBottomRight=Object(f.a)(I,V),c*=M,d*=M,c*=w,d*=w;var W=Math.round(64*M);T._bitestAndDistRatio=Object(f.a)(L,W),T._computedWidth=c,T._computedHeight=d;var A=Object(h.a)(),B=Object(l.a)();return T._applyTransformation(B,A),T}return Object(i.a)(r,null,[{key:"fromCIMMarker",value:function(e,t){var n=t&&t.width||1,i=t&&t.height||1,a=e.size,s=n/i*e.scaleX,u=e.scaleSymbolsProportionally&&e.frameHeight?a/e.frameHeight:1,l=Object(d.c)(e.color),h=Object(d.c)(e.outlineColor),f=Object(c.h)(a),v=f*s,y=Object(c.h)(e.offsetX||0),_=Object(c.h)(e.offsetY||0),p=Object(c.h)(e.outlineWidth||0)*u,x=e.alignment||0,b=Object(c.h)(e.referenceSize),m=e.rotation||0;e.rotateClockwise||(m=-m);var O=0,g=0,j=e.anchorPoint;j&&(e.isAbsoluteAnchorPoint?a&&(O=-j.x/(a*s),g=j.y/a):(O=j.x,g=j.y));var k=new r(e.materialKey,y,_,m,l,v,f,b,h,p,e.colorLocked,e.scaleSymbolsProportionally,!1,x,t,O,g,e.sizeRatio,Object(o.r)(e.scaleFactor,1),e.markerPlacement,e.effects);return k._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/v:1,k._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/f:1,k}},{key:"fromPictureMarker",value:function(e,t){var n=Math.round(Object(c.h)(e.width)),i=Math.round(Object(c.h)(e.height)),a=u.p,s=Math.round(Object(c.h)(e.xoffset||0)),o=Math.round(Object(c.h)(e.yoffset||0)),l=new r(e.materialKey,s,o,e.angle,a,n,i,i,0,0,!1,!1,!1,0,t,0,0,1,1,null,null);return l._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.width:1,l._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.height:1,l}},{key:"fromSimpleMarker",value:function(e,t){var n=Object(d.d)(e.color),i=Math.round(Object(c.h)(e.size)),a=i,s=Math.round(Object(c.h)(e.xoffset||0)),o=Math.round(Object(c.h)(e.yoffset||0)),u=e.style,l=e.outline,h=0|(l&&l.color&&Object(d.d)(l.color)),f=0|(l&&l.width&&Math.round(Object(c.h)(l.width))),v=new r(e.materialKey,s,o,e.angle,n,i,a,a,h,f,!1,!1,"esriSMSCross"===u||"esriSMSX"===u,0,t,0,0,126/64,1,null,null);return v.boundsType="esriSMSCircle"===u?"circle":"square",v._vertexBoundsScaleX=e.maxVVSize?e.maxVVSize/e.size:1,v._vertexBoundsScaleY=e.maxVVSize?e.maxVVSize/e.size:1,v}},{key:"fromLineSymbolMarker",value:function(e,t){var n,i=Object(d.d)(e.color),a=Math.round(Object(c.h)(6*e.lineWidth)),s=a,o="cross"===e.style||"x"===e.style;switch(e.placement){case"begin-end":n="Both";break;case"begin":n="JustBegin";break;case"end":n="JustEnd";break;default:n="None"}var u={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:n,offsetAlongLine:0},l=new r(e.materialKey,0,0,0,i,a,s,s/6,i,o?Math.round(Object(c.h)(e.lineWidth)):0,!1,!1,o,1,t,0,0,126/64,1,u,null);return l.boundsType="circle"===e.style?"circle":"square",l}}]),r}(Object(_.a)(y.a));t.a=p},855:function(e,t,r){"use strict";var n=r(29),i=r(2),a=r(3),s=r(4),o=r(5),c=r(6),u=r(37),l=r(511),h=r(34),f=r(102),v=r(399),d=r(513),y=r(824),_=r(821),p=r(853),x=3.14159265359/180;t.a=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).angle=0,e.xOffset=0,e.yOffset=0,e.width=0,e.height=0,e.boundsType="square",e._anchorX=0,e._anchorY=0,e._computedWidth=0,e._computedHeight=0,e._vertexBoundsScaleX=1,e._vertexBoundsScaleY=1,e._offsets={xUpperLeft:0,yUpperLeft:0,xUpperRight:0,yUpperRight:0,xBottomLeft:0,yBottomLeft:0,xBottomRight:0,yBottomRight:0},e.geometryType=_.d.MARKER,e}return Object(a.a)(r,[{key:"_write",value:function(e,t,r){var n=t.getDisplayId();e.recordStart(n,this._materialKey,this.geometryType,!1,!0),this._writeGeometry(e,t,n,r),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,i){var a=this;if(Object(c.k)(this._markerPlacement))return this._writePlacedMarkers(e,t,i);var s=i?Object(l.p)(Object(l.d)(i),2):"esriGeometryPolygon"===t.geometryType?t.readCentroid():t.readUnquantizedGeometry();if(s){if(s.isPoint){var o=Object(n.a)(s.coords,2),u=o[0],h=o[1];if(!e.hasAggregates&&e.hasPixelBufferEnabled&&(u<-1||u>=513||h<-1||h>=513))return;return this._writeVertices(e,r,this._getPos(u,h),u,h)}s.forEachVertex((function(t,n){return a._writeVertices(e,r,a._getPos(t,n),t,n)}))}}},{key:"_writePlacedMarkers",value:function(e,t,r){var n=null!=r?r:t.readLegacyGeometry(),i=p.a.getPlacement(n,Object(c.q)(this._markerPlacement),Object(u.h)(1));if(i)for(var a=t.getDisplayId(),s=Object(d.a)(),o=Object(v.a)(),l=i.next();null!=l;){var h=l,f=h.tx,y=h.ty;f>=-128&&f<=640&&y>=-128&&y<=640&&(this._applyTransformation(o,s,l.getAngle()/x),this._writeVertices(e,a,this._getPos(f,y),f,y)),l=i.next()}}},{key:"_writeVertices",value:function(e,t,r,n,i){var a=e.vertexCount();e.vertexBounds(n+this.xOffset,i-this.yOffset,this._computedWidth*this._vertexBoundsScaleX,this._computedHeight*this._vertexBoundsScaleY),e.vertexWrite(r),e.vertexWrite(this._offsetUpperLeft),e.vertexWrite(this._texUpperLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetUpperRight),e.vertexWrite(this._texUpperRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomLeft),e.vertexWrite(this._texBottomLeft),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.vertexWrite(r),e.vertexWrite(this._offsetBottomRight),e.vertexWrite(this._texBottomRight),e.vertexWrite(this._bitestAndDistRatio),e.vertexWrite(t),e.vertexWrite(this._fillColor),e.vertexWrite(this._outlineColor),e.vertexWrite(this._sizeOutlineWidth),e.vertexEnd(),e.indexWrite(a+0),e.indexWrite(a+1),e.indexWrite(a+2),e.indexWrite(a+1),e.indexWrite(a+3),e.indexWrite(a+2)}},{key:"_applyTransformation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(f.d)(e),Object(f.h)(e,e,Object(d.b)(this.xOffset,-this.yOffset)),this.angle+r!==0&&Object(f.f)(e,e,x*(this.angle+r));var n=this._computedWidth,i=this._computedHeight,a=(this._anchorX-.5)*n,s=(this._anchorY-.5)*i;Object(h.r)(t,a,s),Object(h.s)(t,t,e),this._offsetUpperLeft=Object(y.a)(16*t[0],16*t[1]),this._offsets.xUpperLeft=t[0],this._offsets.yUpperLeft=t[1],Object(h.r)(t,a+n,s),Object(h.s)(t,t,e),this._offsetUpperRight=Object(y.a)(16*t[0],16*t[1]),this._offsets.xUpperRight=t[0],this._offsets.yUpperRight=t[1],Object(h.r)(t,a,s+i),Object(h.s)(t,t,e),this._offsetBottomLeft=Object(y.a)(16*t[0],16*t[1]),this._offsets.xBottomLeft=t[0],this._offsets.yBottomLeft=t[1],Object(h.r)(t,a+n,s+i),Object(h.s)(t,t,e),this._offsetBottomRight=Object(y.a)(16*t[0],16*t[1]),this._offsets.xBottomRight=t[0],this._offsets.yBottomRight=t[1]}},{key:"_getPos",value:function(e,t){return Object(y.a)(Math.round(8*e),Math.round(8*t))}}]),r}(e)}},856:function(e,t,r){"use strict";r.d(t,"a",(function(){return $e})),r.d(t,"b",(function(){return Je}));var n=r(10),i=r(7),a=r.n(i),s=r(16),o=r(15),c=r(2),u=r(3),l=r(12),h=r(20),f=r(24),v=r(538),d=r(830),y=r(847),_=r(851),p=r(854),x=r(202),b=r(4),m=r(5),O=r(46),g=r(37),j=r(537),k=r(824),M=r(823),w=r(825),S=r(833),E=r(828),T=r(6),L=r(511),z=r(821),R=r(29),C=r(178),P=(r(889),r(875));function I(e,t,r,n,i,a,s){ae=0;var o,c,u,l,h,f=(n-r)*a,v=i&&i.length,d=v?(i[0]-r)*a:f,y=V(t,r,n,0,d,a,!0);if(y&&y.next!==y.prev){if(v&&(y=function(e,t,r,n,i,a){for(var s=new Array,o=0,c=n.length;o<c;o++){var u=V(e,t,r,n[o]*a,o<c-1?n[o+1]*a:r*a,a,!1);u===u.next&&(u.steiner=!0),s.push(Z(u))}s.sort(J);for(var l=0,h=s;l<h.length;l++){N(h[l],i),i=W(i,i.next)}return i}(t,r,n,i,y,a)),f>80*a){o=u=t[0+r*a],c=l=t[1+r*a];for(var _=a;_<d;_+=a){var p=t[_+r*a],x=t[_+1+r*a];o=Math.min(o,p),c=Math.min(c,x),u=Math.max(u,p),l=Math.max(l,x)}h=0!==(h=Math.max(u-o,l-c))?1/h:0}A(y,e,a,o,c,h,s,0)}}function V(e,t,r,n,i,a,s){var o;if(s===function(e,t,r,n,i,a){for(var s=0,o=n,c=i-a;o<i;o+=a)s+=(e[c+t*a]-e[o+t*a])*(e[o+1+t*a]+e[c+1+t*a]),c=o;return s}(e,t,0,n,i,a)>0)for(var c=n;c<i;c+=a)o=F(c+t*a,e[c+t*a],e[c+1+t*a],o);else for(var u=i-a;u>=n;u-=a)o=F(u+t*a,e[u+t*a],e[u+1+t*a],o);return o&&Q(o,o.next)&&(G(o),o=o.next),o}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,n=e;do{if(r=!1,n.steiner||!Q(n,n.next)&&0!==U(n.prev,n,n.next))n=n.next;else{if(G(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function A(e,t,r,n,i,a,s,o){if(e){!o&&a&&(e=K(e,n,i,a));for(var c=e;e.prev!==e.next;){var u=e.prev,l=e.next;if(a?D(e,n,i,a):B(e))t.push(u.index/r+s),t.push(e.index/r+s),t.push(l.index/r+s),G(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?A(e=$(e,t,r,s),t,r,n,i,a,s,2):2===o&&ee(e,t,r,n,i,a,s):A(W(e),t,r,n,i,a,s,1);break}}}}function B(e){var t=e.prev,r=e,n=e.next;if(U(t,r,n)>=0)return!1;for(var i=e.next.next,a=i,s=0;i!==e.prev&&(0===s||i!==a);){if(s++,q(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&U(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function D(e,t,r,n){var i=e.prev,a=e,s=e.next;if(U(i,a,s)>=0)return!1;for(var o=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,c=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,u=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,l=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=H(o,c,t,r,n),f=H(u,l,t,r,n),v=e.prevZ,d=e.nextZ;v&&v.z>=h&&d&&d.z<=f;){if(v!==e.prev&&v!==e.next&&q(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&U(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,d!==e.prev&&d!==e.next&&q(i.x,i.y,a.x,a.y,s.x,s.y,d.x,d.y)&&U(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;v&&v.z>=h;){if(v!==e.prev&&v!==e.next&&q(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&U(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&q(i.x,i.y,a.x,a.y,s.x,s.y,d.x,d.y)&&U(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function F(e,t,r,n){var i=ne.create(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function G(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Z(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function N(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>s){if(s=o,o===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===s)return r.prev;var c,u=r,l=r.x,h=r.y,f=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&q(a<h?i:s,a,l,h,a<h?s:i,a,n.x,n.y)&&(((c=Math.abs(a-n.y)/(i-n.x))<f||c===f&&n.x>r.x)&&Y(n,e)&&(r=n,f=c)),n=n.next;return r}(e,t)){var r=re(t,e);W(r,r.next)}}function K(e,t,r,n){for(var i;i!==e;i=i.next){if(null===(i=i||e).z&&(i.z=H(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,K(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var n=void 0,i=e;e=null,t=null;for(var a=0;i;){a++,n=i;for(var s=0;s<r&&n;s++)n=n.nextZ;for(var o=r;s>0||o>0&&n;){var c=void 0;0===s?(c=n,n=n.nextZ,o--):0!==o&&n?i.z<=n.z?(c=i,i=i.nextZ,s--):(c=n,n=n.nextZ,o--):(c=i,i=i.nextZ,s--),t?t.nextZ=c:e=c,c.prevZ=t,t=c}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function U(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function X(e,t,r,n){return!!(Q(e,t)&&Q(r,n)||Q(e,n)&&Q(r,t))||U(e,t,r)>0!=U(e,t,n)>0&&U(r,n,e)>0!=U(r,n,t)>0}function q(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function Y(e,t){return U(e.prev,e,e.next)<0?U(e,t,e.next)>=0&&U(e,e.prev,t)>=0:U(e,t,e.prev)<0||U(e,e.next,t)<0}function H(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Q(e,t){return e.x===t.x&&e.y===t.y}function J(e,t){return e.x-t.x}function $(e,t,r,n){var i=e;do{var a=i.prev,s=i.next.next;!Q(a,s)&&X(a,i,i.next,s)&&Y(a,s)&&Y(s,a)&&(t.push(a.index/r+n),t.push(i.index/r+n),t.push(s.index/r+n),G(i),G(i.next),i=e=s),i=i.next}while(i!==e);return i}function ee(e,t,r,n,i,a,s){var o=e;do{for(var c=o.next.next;c!==o.prev;){if(o.index!==c.index&&te(o,c)){var u=re(o,c);return o=W(o,o.next),u=W(u,u.next),A(o,t,r,n,i,a,s,0),void A(u,t,r,n,i,a,s,0)}c=c.next}o=o.next}while(o!==e)}function te(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&X(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&Y(e,t)&&Y(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function re(e,t){var r=ne.create(e.index,e.x,e.y),n=ne.create(t.index,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}for(var ne=function(){function e(){Object(c.a)(this,e),this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Object(u.a)(e,null,[{key:"create",value:function(t,r,n){var i=ae<ie.length?ie[ae++]:new e;return i.index=t,i.x=r,i.y=n,i.prev=null,i.next=null,i.z=null,i.prevZ=null,i.nextZ=null,i.steiner=!1,i}}]),e}(),ie=new Array,ae=0,se=0;se<8096;se++)ie.push(new ne);var oe=r(876),ce=new oe.a,ue=new P.b(0,0,0,1,0),le=new P.b(0,0,0,1,0);function he(e,t,r){for(var n=0,i=1;i<r;i++){var a=e[2*(t+i-1)],s=e[2*(t+i-1)+1];n+=(e[2*(t+i)]-a)*(e[2*(t+i)+1]+s)}return n}function fe(e,t,r,n,i){for(var a=0,s=r;s<n;s+=3){var o=2*(e.getValue(s)-i),c=2*(e.getValue(s+1)-i),u=2*(e.getValue(s+2)-i);a+=Math.abs((t[o]-t[u])*(t[c+1]-t[o+1])-(t[o]-t[c])*(t[u+1]-t[o+1]))}return a}ue.setExtent(j.E),le.setExtent(j.E);var ve=function(e){return function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).forceLibtess=!1,e.geometryType=z.d.FILL,e}return Object(u.a)(r,[{key:"_write",value:function(e,t,r){var n="esriGeometryPoint"===t.geometryType,i=M.a.load(this._materialKey);e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,i.dotDensity,n),this._writeGeometry(e,t,i,r,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n,i){var a=this._getGeometry(t,n,i);if(!Object(T.j)(a)){var s=e.indexCount();if(a.lengths[0]>1e3||this.forceLibtess||!function(e,t){var r=t.coords,n=t.lengths,i=t.hasIndeterminateRingOrder,a=e.indexWriter(),s=e.vertexCount();if(i)return!1;for(var o=a.length,c=0,u=0;u<n.length;){for(var l=u,h=n[u],f=he(r,c,h),v=[];++l<n.length;){var d=n[l],y=he(r,c+h,d);if(!(y>0))break;f+=y,v.push(c+h),h+=d}var _=a.length;I(a,r,c,c+h,v,2,s);var p=fe(a,r,_,a.length,s),x=Math.abs(f);if(Math.abs((p-x)/Math.max(1e-7,x))>1e-5)return a.seek(o),!1;u=l,c+=h}return!0}(e,a)){var o=function(e,t){var r=[],n=[],i=e.indexWriter(),a=e.vertexCount(),s=t.coords,o=t.lengths;ce.beginPolygon(r,n);for(var c=0,u=0;u<o.length;u++){var l=t.lengths[u];ce.beginContour();for(var h=0;h<l;h++){var f=[s[2*(c+h)],s[2*(c+h)+1],0];ce.addVertex(f,f)}ce.endContour(),c+=l}ce.endPolygon();for(var v=0;v<n.length;v++)i.push(n[v]+a);return r}(e,a);s!==e.indexCount()&&this._writeVertices(e,t,o,[o.length/2],r)}else!(s===e.indexCount())&&this._writeVertices(e,t,a.coords,a.lengths,r)}}},{key:"_writeVertices",value:function(e,t,r,n,i){var a,s=t.getDisplayId(),c=0,u=Object(o.a)(n);try{for(u.s();!(a=u.n()).done;){for(var l=a.value,h=l+c,f=c;f<h;f++){var v=r[2*f],d=r[2*f+1],y=Object(k.a)(1*v,1*d);e.vertexBounds(v,d,0,0),e.vertexWrite(y),e.vertexWrite(s),i.dotDensity?e.vertexWriteF32(1/Math.abs(t.readGeometryArea())):(e.vertexWrite(this.fillColor),e.vertexWrite(this.tl),e.vertexWrite(this.br),e.vertexWrite(this.aux1),e.vertexWrite(this.aux2),e.vertexWrite(this.aux3))}c+=l}}catch(_){u.e(_)}finally{u.f()}}},{key:"_getGeometry",value:function(e,t,r){var n=t?Object(L.p)(Object(L.d)(t),2):e.readUnquantizedGeometry();return n?function(e,t){if(!function(e,t,r){for(var n=0,i=0;i<e.lengths.length;i++){for(var a=e.lengths[i],s=0;s<a;s++){var o=e.coords[2*(s+n)],c=e.coords[2*(s+n)+1];if(o<t||o>r||c<t||c>r)return!0}n+=a}return!1}(e,-128,j.E+128))return e;ue.setPixelMargin(t),ue.reset(3);for(var r=0,n=0;n<e.lengths.length;n++){var i=e.lengths[n],a=e.coords[2*(0+r)],s=e.coords[2*(0+r)+1];ue.moveTo(a,s);for(var c=1;c<i;c++)a=e.coords[2*(c+r)],s=e.coords[2*(c+r)+1],ue.lineTo(a,s);ue.close(),r+=i}var u=ue.result(!1);if(!u)return null;var l,h=[],f=[],v=Object(o.a)(u);try{for(v.s();!(l=v.n()).done;){var d,y=l.value,_=0,p=Object(o.a)(y);try{for(p.s();!(d=p.n()).done;){var x=d.value;f.push(x.x),f.push(x.y),_++}}catch(b){p.e(b)}finally{p.f()}h.push(_)}}catch(b){v.e(b)}finally{v.f()}return new C.a(h,f)}(n,r?256:128):null}}]),r}(e)},de=r(843),ye=r(829),_e=l.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate"),pe=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this))._ongoingMaterialRequestMap=new Map,n._materialCache=new Map,n._dynamicPropertyMap=new Map,n._cimLayer=e,n}return Object(u.a)(r,[{key:"analyze",value:function(e,t,r,n){var i=this,a=t.readLegacyFeature(),s=this._materialCache,o=this._cimLayer.materialHash;if(!o)return _e.error("A Dynamic mesh template must have a material hash value or function!"),Promise.reject(null);var c="function"==typeof o?o(a,r,n):o;if(s.has(c)){var u=s.get(c);return Promise.resolve(u)}if(this._ongoingMaterialRequestMap.has(c))return this._ongoingMaterialRequestMap.get(c);var l=Object(de.a)(this._cimLayer.cim,this._cimLayer.materialOverrides);l.mosaicHash=c;var h=e.getMosaicItem(l).then((function(e){return i._ongoingMaterialRequestMap.delete(c),s.set(c,e),e})).catch((function(e){return i._ongoingMaterialRequestMap.delete(c),_e.error(".analyze()",e.message),null}));return this._ongoingMaterialRequestMap.set(c,h),h}}]),r}(ye.a),xe=128,be=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e){var n,i;if(Object(c.a)(this,r),n=t.call(this,e),Object(E.c)(e.color)){n._dynamicPropertyMap.set("_fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&Object(w.c)(i)||0}))}else{var a=e.color;n.fillColor=a&&Object(w.c)(a)||0}var s=0;Object(E.c)(e.height)||(s=e.height||0);var o="CIMMarkerPlacementInsidePolygon"===(null==(i=e.cim.placement)?void 0:i.type)&&e.cim.placement.shiftOddRows?2:1;n._dynamicPropertyMap.set("_height",(function(t,r,n){return Object(E.c)(e.height)?e.height(t,r,n)*o:s*o}));var u=0;Object(E.c)(e.offsetX)||(u=Object(g.h)(e.offsetX||0)+xe)>255&&(u=255);n._dynamicPropertyMap.set("_offsetX",(function(t,r,n){if(Object(E.c)(e.offsetX)){var i=Object(g.h)(e.offsetX(t,r,n))+xe;return i>255&&(i=255),i}return u}));var l=1;Object(E.c)(e.scaleX)||(l=e.scaleX||1);n._dynamicPropertyMap.set("_scaleX",(function(t,r,n){return Object(E.c)(e.scaleX)?e.scaleX(t,r,n):l}));var h=0;Object(E.c)(e.offsetY)||(h=Object(g.h)(-e.offsetY||0)+xe)>255&&(h=255);n._dynamicPropertyMap.set("_offsetY",(function(t,r,n){if(Object(E.c)(e.offsetY)){var i=Object(g.h)(-e.offsetY(t,r,n))+xe;return i>255&&(i=255),i}return h}));var f=0;Object(E.c)(e.angle)||(f=Object(S.d)(e.angle)||0);return n._dynamicPropertyMap.set("_angle",(function(t,r,n){return Object(E.c)(e.angle)?Object(S.d)(e.angle(t,r,n)):f})),n._effects=e.effects,n._cimFillLayer=e,n._fillMaterialKey=M.a.load(e.materialKey),Object(x.a)(n)}return Object(u.a)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._fillMaterialKey,s=this._materialCache,o=this._cimFillLayer;this.aux3=Object(k.b)(0,0,this._angle,o.colorLocked?1:0);var c=(0,o.materialHash)(i,t,r),u=s.get(c),l=null;if(u&&Object(d.a)(u.spriteMosaicItem)&&(l=u.spriteMosaicItem),l){var h=l,f=h.rect,v=h.width,y=h.height,_=f.x+j.q,p=f.y+j.q,x=_+v,b=p+y,m=Object(O.o)(Object(g.h)(this._height));m>255?m=255:m<=0&&(m=Object(O.o)(b-p));var M=Object(O.o)(Object(g.h)(this._height/y*v||0));M>255?M=255:M<=0&&(M=Object(O.o)(x-_));var w=this._scaleX;this.tl=Object(k.a)(_,p),this.br=Object(k.a)(x,b),this.aux1=Object(k.b)(M,m,this._offsetX,this._offsetY),this.aux2=Object(k.a)(xe*w,128),a.sdf=l.sdf,a.pattern=!0,a.textureBinding=l.textureBinding}else this.tl=0,this.br=0,this.aux1=0,this.aux2=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data}}],[{key:"fromCIMFill",value:function(e){return new r(e)}}]),r}(ve(pe)),me=r(877),Oe=31,ge=1024,je=1/3.8,ke=function(e){return function(t){var r=e.out,n=Math.ceil(ge*e._halfWidth),i=Math.ceil(ge*e._halfReferenceWidth);t.entry0=e.offset+e.vertexCount++;var a=Object(k.a)(t.distance,n),s=Object(k.b)(Math.round(Oe*t.prevNormal.x),Math.round(Oe*t.prevNormal.y),Math.round(0),Math.round(-31)),o=Object(k.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(k.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(s),r.vertexWrite(a),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(o),r.vertexWrite(Object(k.a)(i,0)),r.vertexEnd(),t.entry2=e.offset+e.vertexCount++;var c=Object(k.a)(t.distance,n),u=Object(k.b)(Math.round(Oe*-t.prevNormal.x),Math.round(Oe*-t.prevNormal.y),Math.round(0),Math.round(31)),l=Object(k.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(k.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(u),r.vertexWrite(c),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(l),r.vertexWrite(Object(k.a)(i,0)),r.vertexEnd(),t.exit0=e.offset+e.vertexCount++;var h=Object(k.a)(t.distance,n),f=Object(k.b)(Math.round(Oe*t.nextNormal.x),Math.round(Oe*t.nextNormal.y),Math.round(0),Math.round(-31)),v=Object(k.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(k.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(f),r.vertexWrite(h),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(v),r.vertexWrite(Object(k.a)(i,0)),r.vertexEnd(),t.exit2=e.offset+e.vertexCount++;var d=Object(k.a)(t.distance,n),y=Object(k.b)(Math.round(Oe*-t.nextNormal.x),Math.round(Oe*-t.nextNormal.y),Math.round(0),Math.round(31)),_=Object(k.b)(0,0,0,e._bitset);r.vertexBounds(t.currentVertex.x,t.currentVertex.y,0,0),r.vertexWrite(Object(k.a)(8*t.currentVertex.x,8*t.currentVertex.y)),r.vertexWrite(e.id),r.vertexWrite(e._fillColor),r.vertexWrite(y),r.vertexWrite(d),r.vertexWrite(e._tl),r.vertexWrite(e._br),r.vertexWrite(_),r.vertexWrite(Object(k.a)(i,0)),r.vertexEnd()}},Me=function(e){return function(t){var r=e.out;r.indexWrite(t.leftExit0),r.indexWrite(t.rightEntry0),r.indexWrite(t.leftExit2),r.indexWrite(t.rightEntry0),r.indexWrite(t.rightEntry2),r.indexWrite(t.leftExit2),e.indexCount+=6}},we=function(e){return function(t,r,n,i,a,s,o,c,u){var l=Object(k.a)(u,Math.ceil(ge*e._halfWidth)),h=Object(k.b)(Math.round(Oe*a),Math.round(Oe*s),Math.round(Oe*o),Math.round(Oe*c)),f=Object(k.b)(Oe*n,Oe*i,0,e._bitset),v=e.out;return v.vertexBounds(t,r,1,1),v.vertexWrite(Object(k.a)(8*t,8*r)),v.vertexWrite(e.id),v.vertexWrite(e._fillColor),v.vertexWrite(h),v.vertexWrite(l),v.vertexWrite(e._tl),v.vertexWrite(e._br),v.vertexWrite(f),v.vertexWrite(Object(k.a)(Math.ceil(ge*e._halfReferenceWidth),0)),v.vertexEnd(),e.offset+e.vertexCount++}},Se=function(e){return function(t,r,n){var i=e.out;i.indexWrite(t),i.indexWrite(r),i.indexWrite(n),e.indexCount+=3}},Ee=function(e){return function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).tessellationProperties={},e._tessellationOptions={},e.geometryType=z.d.LINE,e}return Object(u.a)(r,[{key:"_initializeTessellator",value:function(e){var t=M.c.load(this._materialKey),r=this._tessellationOptions,n=t.vvSizeFieldStops||t.vvSizeMinMaxValue||t.vvSizeScaleStops||t.vvSizeUnitValue,i=this.tessellationProperties._halfWidth<j.D/2;if(r.thin=i&&!e&&!n,r.trackDistance=this._isDashed||this._hasPattern,r.wrapDistance=65535,r.innerBisectorAutoSplitThreshold=je,r.outerBisectorAutoSplitThreshold=je,r.enableInnerBisectorSplit=this._isDashed||this._hasPattern,r.enableOuterBisectorSplit=this._isDashed||this._hasPattern,r.thin)this._tessellationCallbacks={vertex:ke(this.tessellationProperties),bridge:Me(this.tessellationProperties)};else{var a=new me.a(we(this.tessellationProperties),Se(this.tessellationProperties));a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a}}},{key:"_write",value:function(e,t,r){var n="esriGeometryPoint"===t.geometryType;e.recordStart(t.getDisplayId(),this._materialKey,this.geometryType,!1,n),this._writeGeometry(e,t,r,n),e.recordEnd()}},{key:"_writeGeometry",value:function(e,t,r,n){var i=null!=r?r:t.readLegacyGeometry(),a=this._getLines(i,n);Object(T.j)(a)||this._writeVertices(e,t,a)}},{key:"_getLines",value:function(e,t){if(Object(T.j)(e))return null;var r=e.paths||e.rings;return Object(T.j)(r)?null:function(e,t){le.setPixelMargin(t);for(var r=le,n=-t,i=j.E+t,a=[],s=!1,c=0;c<e.length;){var u=[],l=e[c];r.reset(2);var h=Object(R.a)(l[0],2),f=h[0],v=h[1];if(s)r.moveTo(f,v);else{if(f<n||f>i||v<n||v>i){s=!0;continue}u.push({x:f,y:v})}for(var d=!1,y=l.length,_=1;_<y;++_)if(f+=l[_][0],v+=l[_][1],s)r.lineTo(f,v);else{if(f<n||f>i||v<n||v>i){d=!0;break}u.push({x:f,y:v})}if(d)s=!0;else{if(s){var p=r.resultWithStarts();if(p){var x,b=Object(o.a)(p);try{for(b.s();!(x=b.n()).done;){var m=x.value;a.push(m)}}catch(O){b.e(O)}finally{b.f()}}}else a.push({line:u,start:0});c++,s=!1}}return 0===(a=a.filter((function(e){return e.line.length>1}))).length?null:a}(r,t?256:16)}},{key:"_writeVertices",value:function(e,t,r){var n=t.getDisplayId(),i=e.vertexCount(),a=this.tessellationProperties;a.out=e,a.id=n,a.indexCount=0,a.vertexCount=0,a.offset=i;var s,c=Object(o.a)(r);try{for(c.s();!(s=c.n()).done;){var u=s.value,l=u.line,h=u.start;this._tessellationOptions.initialDistance=h%65535,this._tessellationCallbacks instanceof me.a&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),Object(me.d)(l,this._tessellationOptions,this._tessellationCallbacks),Object(me.b)()}}catch(f){c.e(f)}finally{c.f()}}}]),r}(e)},Te=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e){var n;Object(c.a)(this,r),(n=t.call(this,e))._cimLineLayer=e;var i=0;Object(E.c)(e.width)||(i=.5*Object(g.h)(e.width));if(n._dynamicPropertyMap.set("_halfWidth",(function(t,r,n){return Object(E.c)(e.width)?.5*Object(g.h)(e.width(t,r,n)):i})),Object(E.c)(e.cap)?n._dynamicPropertyMap.set("_capType",e.cap):n._capType=e.cap,Object(E.c)(e.join)?n._dynamicPropertyMap.set("_joinType",e.join):n._joinType=e.join,Object(E.c)(e.color)){n._dynamicPropertyMap.set("_fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&Object(w.c)(i)||0}))}else{var a=e.color;n._fillColor=a&&Object(w.c)(a)||0}if(Object(E.c)(e.miterLimit)){n._dynamicPropertyMap.set("_miterLimitCosine",(function(t,r,n){return Object(E.b)(e.miterLimit(t,r,n))}))}else n._miterLimitCosine=Object(E.b)(e.miterLimit);return n._scaleFactor=e.scaleFactor||1,n._isDashed=e.isDashed,n._effects=e.effects,n.tessellationProperties._bitset=e.colorLocked?1:0,n._materialKey=e.materialKey,n._initializeTessellator(!0),n}return Object(u.a)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._halfWidth*=this._scaleFactor;var a=this._materialCache,s=(0,this._cimLineLayer.materialHash)(i,t,r),o=a.get(s),c=null;if(o&&Object(d.a)(o.spriteMosaicItem)&&(c=o.spriteMosaicItem),c){this._hasPattern=!0;var u=c,l=u.rect,h=u.width,f=u.height,v=l.x+j.q,y=l.y+j.q,_=v+h,p=y+f;this.tessellationProperties._tl=Object(k.a)(v,y),this.tessellationProperties._br=Object(k.a)(_,p)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;var x=M.c.load(this._materialKey);c&&(x.sdf=c.sdf,x.pattern=!0,x.textureBinding=c.textureBinding),this._materialKey=x.data}}],[{key:"fromCIMLine",value:function(e){return new r(e)}}]),r}(Ee(pe)),Le=r(399),ze=r(513),Re=r(855),Ce=Object(ze.a)(),Pe=Object(Le.a)(),Ie=l.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate"),Ve=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e){var n;if(Object(c.a)(this,r),(n=t.call(this,e))._cimMarkerLayer=e,Object(E.c)(e.color)){n._dynamicPropertyMap.set("_fillColor",(function(t,r,n){return Object(w.c)(e.color(t,r,n))}))}else n._fillColor=Object(w.c)(e.color);if(Object(E.c)(e.outlineColor)){n._dynamicPropertyMap.set("_outlineColor",(function(t,r,n){return Object(w.c)(e.outlineColor(t,r,n))}))}else n._outlineColor=Object(w.c)(e.outlineColor);if(Object(E.c)(e.size)){n._dynamicPropertyMap.set("_size",(function(t,r,n){return Object(g.h)(e.size(t,r,n))}))}else n._size=Object(g.h)(e.size);if(Object(E.c)(e.scaleX)?n._dynamicPropertyMap.set("_scaleX",e.scaleX):n._scaleX=e.scaleX,Object(E.c)(e.offsetX)){n._dynamicPropertyMap.set("xOffset",(function(t,r,n){return Object(g.h)(e.offsetX(t,r,n))}))}else n.xOffset=Object(g.h)(e.offsetX);if(Object(E.c)(e.offsetY)){n._dynamicPropertyMap.set("yOffset",(function(t,r,n){return Object(g.h)(e.offsetY(t,r,n))}))}else n.yOffset=Object(g.h)(e.offsetY);if(Object(E.c)(e.outlineWidth)){n._dynamicPropertyMap.set("_outlineWidth",(function(t,r,n){return Object(g.h)(e.outlineWidth(t,r,n))}))}else n._outlineWidth=Object(g.h)(e.outlineWidth);return Object(E.c)(e.rotation)?n._dynamicPropertyMap.set("_angle",e.rotation):n._angle=e.rotation,n._scaleFactor=Object(T.r)(e.scaleFactor,1),n._markerPlacement=e.markerPlacement,n._effects=e.effects,n._bitSet=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3,n._materialKey=e.materialKey,Object(x.a)(n)}return Object(u.a)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._cimMarkerLayer.materialHash,s="function"==typeof a?a(i,t,r):a,o=this._materialCache.get(s);if(o&&Object(d.a)(o.spriteMosaicItem)&&o.spriteMosaicItem){var c=o.spriteMosaicItem,u=this._cimMarkerLayer.sizeRatio,l=c.width/c.height*this._scaleX,f=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,v=this._size,y=v*l,_=this.xOffset,p=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;var x=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/Object(g.h)(this._cimMarkerLayer.frameHeight):1,b=this._outlineWidth*x,m=Object(g.h)(this._cimMarkerLayer.referenceSize),O=0,w=0,S=this._cimMarkerLayer.anchorPoint;S&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(O=-S.x/(this._size*l),w=S.y/this._size):(O=S.x,w=S.y)),this._sizeOutlineWidth=Object(k.b)(Math.round(Math.min(Math.sqrt(128*y),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*m),255))),this.angle=f;var E=Math.round(64*u);this._bitestAndDistRatio=Object(k.a)(this._bitSet,E);var T=c.rect.x+j.q,L=c.rect.y+j.q,z=T+c.width,R=L+c.height;this._texUpperLeft=Object(k.a)(T,L),this._texUpperRight=Object(k.a)(z,L),this._texBottomLeft=Object(k.a)(T,R),this._texBottomRight=Object(k.a)(z,R);var C=M.d.load(this._materialKey);C.sdf=c.sdf,C.pattern=!0,C.textureBinding=c.textureBinding,this._materialKey=C.data,this._anchorX=.5-(.5+O)*c.width/c.width,this._anchorY=.5-(.5+w)*c.height/c.height,y*=u,v*=u,y*=this._scaleFactor,v*=this._scaleFactor,y*=c.rect.width/c.width,v*=c.rect.height/c.height,this._computedWidth=y,this._computedHeight=v,this._applyTransformation(Pe,Ce),this.xOffset=_,this.yOffset=p}else Ie.error(new h.a("mapview-cim","Encountered an error when binding feature"))}}],[{key:"fromCIMMarker",value:function(e){return new r(e)}}]),r}(Object(Re.a)(pe)),We=r(844),Ae=r(837),Be=r(852);function De(e,t,r,n){return"string"==typeof e.text?e.text:"function"==typeof e.text?e.text(t,r,n):""}var Fe=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e){var n;Object(c.a)(this,r),(n=t.call(this,e))._horizontalAlignment="center",n._verticalAlignment="middle",n._textToGlyphs=new Map;var i,a=e.scaleFactor||1;if(n._cimTextLayer=e,Object(E.c)(e.color)){n._dynamicPropertyMap.set("_color",(function(t,r,n){return Object(w.c)(e.color(t,r,n))}))}else n._color=Object(w.c)(e.color);if(Object(E.c)(e.color)){n._dynamicPropertyMap.set("_haloColor",(function(t,r,n){return Object(w.c)(e.outlineColor(t,r,n))}))}else n._haloColor=Object(w.c)(e.outlineColor);Object(E.c)(e.size)||(i=Math.min(Math.round(Object(g.h)(e.size*e.sizeRatio)),127));var s;if(n._dynamicPropertyMap.set("_size",(function(t,r,n){return Object(E.c)(e.size)?Math.min(Math.round(Object(g.h)(e.size(t,r,n)*e.sizeRatio)),127):i})),Object(E.c)(e.outlineSize)){n._dynamicPropertyMap.set("_haloSize",(function(t,r,n){return Math.min(Math.floor(5*Object(g.h)(e.outlineSize(t,r,n)*e.sizeRatio)),127)}))}else n._haloSize=Math.min(Math.floor(5*Object(g.h)(e.outlineSize*e.sizeRatio)),127);Object(E.c)(e.offsetX)||(s=Math.round(Object(g.h)(e.offsetX*e.sizeRatio)));var o;n._dynamicPropertyMap.set("_xOffset",(function(t,r,n){return Object(E.c)(e.offsetX)?Math.round(Object(g.h)(e.offsetX(t,r,n)*e.sizeRatio)):s})),Object(E.c)(e.offsetY)||(o=Math.round(Object(g.h)(e.offsetY*e.sizeRatio)));n._dynamicPropertyMap.set("_yOffset",(function(t,r,n){return Object(E.c)(e.offsetY)?Math.round(Object(g.h)(e.offsetY(t,r,n)*e.sizeRatio)):o})),Object(E.c)(e.angle)?n._dynamicPropertyMap.set("_angle",e.angle):n._angle=e.angle,Object(E.c)(e.horizontalAlignment)?n._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):n._horizontalAlignment=e.horizontalAlignment,Object(E.c)(e.verticalAlignment)?n._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):n._verticalAlignment=e.verticalAlignment,n._scaleFactor=a,Object(E.c)(e.text)?n._dynamicPropertyMap.set("_text",e.text):n._text=e.text;var u=Math.min(Math.round(Object(g.h)(e.referenceSize*e.sizeRatio)),127);n._referenceSize=Math.round(Math.sqrt(256*u)),n._materialKey=e.materialKey;var l=M.f.load(n._materialKey);return l.sdf=!0,n._bitset=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1,n._materialKey=l.data,n._decoration="none",n._lineHeight=1,n._lineWidth=512,n._textPlacement=e.markerPlacement,n._effects=e.effects,n._isCIM=!0,n}return Object(u.a)(r,[{key:"analyze",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n,i){var s,o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.readLegacyFeature(),o=De(this._cimTextLayer,s,n,i),e.next=4,t.getMosaicItem(this._cimTextLayer.cim,Object(We.a)(o));case 4:return c=e.sent,e.abrupt("return",(this._textToGlyphs.set(o,c.glyphMosaicItems),c));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._text&&0!==this._text.length){this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=Object(Ae.d)(this._horizontalAlignment||"center"),this._yAlignD=Object(Ae.f)(this._verticalAlignment||"baseline");var a=this._textToGlyphs.get(this._text);this.bindTextInfo(a,!1)}else this._shapingInfo=null}}],[{key:"fromCIMText",value:function(e){return new r(e)}}]),r}(Object(Be.a)(pe)),Ge=128,Ze=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e,n,i,a,s,o,u,l,h){var f;Object(c.a)(this,r),(f=t.call(this))._effects=h;var v=M.a.load(e);return n&&(v.sdf=n.sdf,v.pattern=!0,v.textureBinding=n.textureBinding),f.fillColor=i,f.tl=a,f.br=s,f.aux1=o,f.aux2=u,f.aux3=l,f._materialKey=v.data,f}return Object(u.a)(r,null,[{key:"fromCIMFill",value:function(e,t){var n=e.color,i=n&&Object(w.c)(n)||0,a=e.materialKey;if(!t)return new r(a,null,i,0,0,0,0,Object(k.b)(0,0,0,e.colorLocked?1:0),e.effects);var s=t.rect,o=t.width,c=t.height,u=s.x+j.q,l=s.y+j.q,h=u+o,f=l+c,v=Object(O.o)(c);v>255?v=255:v<=0&&(v=Object(O.o)(f-l));var d=Object(O.o)(o||0);d>255?d=255:d<=0&&(d=Object(O.o)(h-u));var y=Object(g.h)(e.offsetX||0)+Ge;y>255&&(y=255);var _=Object(g.h)(-e.offsetY||0)+Ge;_>255&&(_=255);var p=e.scaleX||1;return new r(a,t,i,Object(k.a)(u,l),Object(k.a)(h,f),Object(k.b)(d,v,y,_),Object(k.a)(Ge*p,128),Object(k.b)(0,0,Object(S.b)(e.angle),e.colorLocked?1:0),e.effects)}},{key:"fromSimpleFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.color,a=i&&"esriSFSNull"!==e.style&&Object(w.d)(i)||0,s=Object(k.b)(0,0,0,n?255:0),o=e.materialKey;if(!t)return new r(o,null,a,0,0,0,0,s,null);var c=t.rect,u=t.width,l=t.height,h=c.x+j.q,f=c.y+j.q,v=h+u,d=f+l,y=Object(k.a)(h,f),_=Object(k.a)(v,d),p=Object(k.b)(Object(O.o)(v-h),Object(O.o)(d-f),0,0),x=Object(k.a)(Ge,Ge);return new r(o,t,a,y,_,p,x,s,null)}},{key:"fromPictureFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=j.p,a=t.rect,s=t.width,o=t.height,c=a.x+j.q,u=a.y+j.q,l=c+s,h=u+o,f=Object(k.a)(c,u),v=Object(k.a)(l,h),d=Object(O.o)(Object(g.h)(e.width));d>255&&(d=255);var y=Object(O.o)(Object(g.h)(e.height));y>255&&(y=255);var _=Object(g.h)(e.xoffset)+Ge;_>255&&(_=255);var p=Object(g.h)(-e.yoffset)+Ge;p>255&&(p=255);var x=Object(k.b)(d,y,_,p),b=Object(k.a)(Ge*e.xscale,Ge*e.yscale),m=Object(k.b)(0,0,0,n?255:0),M=e.materialKey;return new r(M,t,i,f,v,x,b,m,null)}}]),r}(ve(ye.a)),Ne=r(822),Ke=l.a.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),Ue=function(e){Object(b.a)(r,e);var t=Object(m.a)(r);function r(e,n,i,a,s,o,u,l,h,f,v,d,y,_,p,x){var b;Object(c.a)(this,r),b=t.call(this);var m=M.c.load(e);return n&&(m.sdf=n.sdf,m.pattern=!0,m.textureBinding=n.textureBinding),b._capType=a,b._joinType=s,b._miterLimitCosine=Object(E.b)(o),b.tessellationProperties._fillColor=u,b.tessellationProperties._tl=l,b.tessellationProperties._br=h,b._hasPattern=f,b._isDashed=v,b._joinOnUTurn=p,b._isColorLocked=d,b._zOrder=_,b._effects=x,b._materialKey=m.data,b.tessellationProperties._bitset=d?1:0,b.tessellationProperties._halfWidth=.5*i,b.tessellationProperties._halfReferenceWidth=.5*y,b._initializeTessellator(!1),b}return Object(u.a)(r,null,[{key:"fromCIMLine",value:function(e,t,n){var i=e.color,a=e.scaleFactor||1,s=e.isDashed,o=e.cap;s&&1===o&&(o=2);var c=e.join,u=Object(g.h)(e.width)*a,l=Object(g.h)(e.referenceWidth),h=Object(g.h)(e.miterLimit),f=i&&Object(w.c)(i)||0;if(!t)return new r(e.materialKey,t,u,o,c,h,f,0,0,!1,s,e.colorLocked,l,e.zOrder,n,e.effects);var v=t.rect,d=t.width,y=t.height,_=v.x+j.q,p=v.y+j.q,x=_+d,b=p+y,m=Object(k.a)(_,p),O=Object(k.a)(x,b);return new r(e.materialKey,t,u,o,c,h,f,m,O,!0,s,e.colorLocked,l,e.zOrder,n,e.effects)}},{key:"fromSimpleLine",value:function(e,t,n){var i=e.color,a="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,s=Object(Ne.h)(e.cap||"round",a),o=Object(Ne.i)(e.join||"round"),c=i&&"esriSLSNull"!==e.style&&Object(w.d)(i)||0;"esriSLSNull"===e.style&&(c=0);var u=Object(g.h)(e.width),l=e.miterLimit;if(!t)return new r(e.materialKey,t,u,s,o,l,c,0,0,!1,a,!1,u,0,n,null);var h=t.rect,f=t.width,v=t.height,d=h.x+j.q,y=h.y+j.q,_=d+f,p=y+v,x=Object(k.a)(d,y),b=Object(k.a)(_,p);return new r(e.materialKey,t,u,s,o,l,c,x,b,!0,a,!1,u,0,n,null)}},{key:"fromPictureLineSymbol",value:function(e,t,r,n){return Ke.error("PictureLineSymbol support does not exist!"),null}}]),r}(Ee(ye.a));function Xe(){return(Xe=Object(s.a)(a.a.mark((function e(t,r,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.acquire();case 3:return e.next=5,r(n);case 5:t.release(),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(0),t.release(),e.t0;case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}var qe=function(){function e(){Object(c.a)(this,e),this._resolver=null}return Object(u.a)(e,[{key:"isHeld",value:function(){return!!this._resolver}},{key:"acquire",value:function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._resolver){e.next=2;break}return e.abrupt("return",(this._resolver=Object(f.g)(),Promise.resolve()));case 2:return e.next=4,this._resolver.promise;case 4:return e.next=6,this.acquire();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=this._resolver;this._resolver=null,e.resolve()}}]),e}(),Ye=l.a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),He=new Array;function Qe(e,t){var r=e.length;return e.push(null),t.then((function(t){return e[r]=t})),e}function Je(e){return!!(1&e)}var $e=function(){function e(t,r){Object(c.a)(this,e),this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new qe,this._fetchResource=t,this._joinOnUTurn=r}return Object(u.a)(e,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}},{key:"createTemplateGroup",value:function(e,t){this._initErrorTemplates();var r=e.hash;if(this._symbolToTemplate.has(r))return this._symbolToTemplate.get(r);var n=new Array;t&&this._createMeshTemplates(n,t,!0),this._createMeshTemplates(n,e,!1);var i=this._createGroupId("expanded-cim"===e.type);return this._idToTemplateGroup.set(i,n),this._symbolToTemplate.set(r,i),i}},{key:"getTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?this._idToTemplateGroup.get(e):He}},{key:"getDynamicTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?(Je(e)||Ye.error("mapview-template-store","Id ".concat(e," does not refer to a dynamic template")),this._idToTemplateGroup.get(e)):He}},{key:"getMosaicItem",value:function(e,t){var r=this,n=this._createTemplateId(),i=new Promise((function(e){return r._idToResolver.set(n,e)}));return this._fetchQueue.push({symbol:e,id:n,glyphIds:t}),i}},{key:"finalize",value:function(e){return this._fetchQueue.length||this._lock.isHeld()?function(e,t,r){return Xe.apply(this,arguments)}(this._lock,this._fetchAllQueuedResources.bind(this),e):Promise.resolve()}},{key:"_initErrorTemplates",value:function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],Object(y.c)(v.c),!1),marker:this._createMeshTemplates([],Object(y.c)(v.b),!1),line:this._createMeshTemplates([],Object(y.c)(v.d),!1)})}},{key:"_fetchAllQueuedResources",value:function(e){var t=this;if(!this._fetchQueue.length)return Promise.resolve();var r=this._fetchQueue,n=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Promise.all(n).then((function(){return t._fetchResource(r,e).then((function(e){var r,n=Object(o.a)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.id,s=i.mosaicItem;t._idToResolver.get(a)(s),t._idToResolver.delete(a)}}catch(c){n.e(c)}finally{n.f()}}))})).catch((function(e){Object(f.m)(e)?t._fetchQueue=t._fetchQueue.concat(r):function(e){return"worker:port-closed"===e.name}(e)||Ye.error(new h.a("mapview-template-store","Unable to fetch requested texture resources",e))}))}},{key:"_createGroupId",value:function(e){return this._idCounter++<<1|(e?1:0)}},{key:"_createTemplateId",value:function(){return this._templateIdCounter++}},{key:"_createSMS",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(d.a)(n,Ye)?p.a.fromSimpleMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPMS",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(d.a)(n,Ye)?p.a.fromPictureMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createSFS",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,i=n.spriteMosaicItem,e.abrupt("return",Object(d.a)(i,Ye)?Ze.fromSimpleFill(t,i,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createPFS",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,i=n.spriteMosaicItem,e.abrupt("return",Object(d.a)(i,Ye)?Ze.fromPictureFill(t,i,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createSLS",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,i=n.spriteMosaicItem,e.abrupt("return",Object(d.a)(i,Ye)?Ue.fromSimpleLine(t,i,this._joinOnUTurn):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createLMS",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(d.a)(n,Ye)?p.a.fromLineSymbolMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createTS",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",_.a.fromText(t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMText",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t.cim,Object(We.a)(t.text));case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",Object(d.a)(n,Ye)?_.a.fromCIMText(t,n):this._textError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMFill",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t.cim);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(d.a)(n,Ye)?Ze.fromCIMFill(t,n):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMLine",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t.cim);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(d.a)(n,Ye)?Ue.fromCIMLine(t,n,this._joinOnUTurn):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMMarker",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t.cim);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(d.a)(n,Ye)?p.a.fromCIMMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIM",value:function(){var e=Object(s.a)(a.a.mark((function e(t){var r,i,s,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,!this._cimTemplateCache.has(r)){e.next=3;break}return e.abrupt("return",this._cimTemplateCache.get(r));case 3:i=Object(n.a)(Object(n.a)({},t),{},{cim:Object(n.a)(Object(n.a)({},t.cim),{},{mosaicHash:t.materialHash})}),e.t0=i.type,e.next="marker"===e.t0?7:"line"===e.t0?9:"fill"===e.t0?11:"text"===e.t0?13:14;break;case 7:return s=this._createCIMMarker(i),e.abrupt("break",14);case 9:return s=this._createCIMLine(i),e.abrupt("break",14);case 11:return s=this._createCIMFill(i),e.abrupt("break",14);case 13:s=this._createCIMText(i);case 14:return e.abrupt("return",(s.then((function(e){return o._cimTemplateCache.set(r,e)})),s));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createDynamicCIM",value:function(e){var t,r=e.templateHash;if(this._cimTemplateCache.has(r))return this._cimTemplateCache.get(r);switch(e.type){case"marker":t=Ve.fromCIMMarker(e);break;case"line":t=Te.fromCIMLine(e);break;case"fill":t=be.fromCIMFill(e);break;case"text":t=Fe.fromCIMText(e)}return this._cimTemplateCache.set(r,t),t}},{key:"_createPrimitiveMeshTemplates",value:function(e,t,r){switch(t.type){case"esriSMS":return Qe(e,this._createSMS(t));case"esriPMS":return Qe(e,this._createPMS(t));case"esriSFS":return Qe(e,this._createSFS(t,r));case"line-marker":return Qe(e,this._createLMS(t));case"esriPFS":return Qe(e,this._createPFS(t,r));case"esriSLS":return Qe(e,this._createSLS(t,!1));case"esriTS":return Qe(e,this._createTS(t));default:return Ye.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}},{key:"_createMeshTemplates",value:function(e,t,r){if(-1!==t.type.indexOf("3d"))return Ye.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){var n,i=Object(o.a)(t.layers);try{for(i.s();!(n=i.n()).done;){var a=n.value;"function"==typeof a.materialHash?e.push(this._createDynamicCIM(a)):Qe(e,this._createCIM(a))}}catch(l){i.e(l)}finally{i.f()}return e}if("composite-symbol"===t.type){var s,c=Object(o.a)(t.layers);try{for(c.s();!(s=c.n()).done;){var u=s.value;this._createPrimitiveMeshTemplates(e,u,r)}}catch(l){c.e(l)}finally{c.f()}return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,r)}}]),e}()},860:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r(7),i=r.n(n),a=r(16),s=r(182),o=(r(69),r(843)),c=r(15),u=r(2),l=r(3),h=r(821),f=r(823),v={marker:h.d.MARKER,fill:h.d.FILL,line:h.d.LINE,text:h.d.TEXT},d=function(){function e(t,r,n,i){Object(u.a)(this,e),this.layers=t,this.data=r,this.hash=this._createHash(),this.rendererKey=n;var a,s=Object(c.a)(t);try{for(s.s();!(a=s.n()).done;){var o=a.value,l=v[o.type];o.materialKey=Object(f.g)(l,this.rendererKey,!1,!1),o.maxVVSize=i}}catch(h){s.e(h)}finally{s.f()}}return Object(l.a)(e,[{key:"type",get:function(){return"expanded-cim"}},{key:"_createHash",value:function(){var e,t="",r=Object(c.a)(this.layers);try{for(r.s();!(e=r.n()).done;){t+=e.value.templateHash}}catch(n){r.e(n)}finally{r.f()}return t}}]),e}(),y=function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,Object(o.b)(t.data,r);case 3:return e.t1=e.sent,e.t2=t.data,e.t3=t.rendererKey,e.t4=t.maxVVSize,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),_=function(){var e=Object(a.a)(i.a.mark((function e(t,r,n){var a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if("cim"!==t.type){e.next=4;break}return e.abrupt("return",y(t,r));case 4:if("web-style"!==t.type){e.next=13;break}return a=s.a.fromJSON(t),e.next=8,a.fetchCIMSymbol(n);case 8:return e.t0=e.sent.data,e.t1=t.rendererKey,e.t2=t.maxVVSize,o={type:"cim",data:e.t0,rendererKey:e.t1,maxVVSize:e.t2},e.abrupt("return",y(o,r));case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},871:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(2),i=r(3),a=r(6),s=r(537),o=2147483647,c=function(){function e(t){Object(n.a)(this,e),this._head=t,this._cursor=t}return Object(i.a)(e,[{key:"size",value:function(){var e,t;return null!=(e=null==(t=this._cursor)?void 0:t.size())?e:0}},{key:"id",get:function(){return this._cursor.id},set:function(e){this._cursor.id=e}},{key:"materialKey",get:function(){return this._cursor.materialKey},set:function(e){this._cursor.materialKey=e}},{key:"insertAfter",get:function(){return this._cursor.insertAfter}},{key:"indexFrom",get:function(){return this._cursor.indexFrom},set:function(e){this._cursor.indexFrom=e}},{key:"indexCount",get:function(){return this._cursor.indexCount},set:function(e){this._cursor.indexCount=e}},{key:"vertexFrom",get:function(){return this._cursor.vertexFrom},set:function(e){this._cursor.vertexFrom=e}},{key:"vertexCount",get:function(){return this._cursor.vertexCount},set:function(e){this._cursor.vertexCount=e}},{key:"index",get:function(){return this._cursor._index}},{key:"link",value:function(e){if(this._head){for(var t=this._head;t._link;)t=t._link;t._link=e._head}else this._head=e._head}},{key:"getCursor",value:function(){return this.copy()}},{key:"lookup",value:function(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor}},{key:"copy",value:function(){var t,r=new e(null==(t=this._head)?void 0:t.copy());if(!r._head)return r;for(var n=r._head,i=r._head._link;i;)n._link=i.copy(),i=(n=i)._link;return r}},{key:"next",value:function(){return!!this._cursor&&(!!this._cursor.next()||!!this._cursor._link&&(this._cursor=this._cursor._link,this.next()))}},{key:"peekId",value:function(){var e;return null!=(e=this._cursor.peekId())?e:this._cursor._link.peekId()}},{key:"delete",value:function(e){for(var t=this._head,r=null;t;){if(t.delete(e))return t.isEmpty()&&(Object(a.k)(r)&&(r._link=t._link),t===this._head&&(this._head=t._link),t===this._cursor&&(this._cursor=t._link)),!0;r=t,t=t._link}return!1}}],[{key:"from",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength/u.BYTES_PER_RECORD-r,i=new u(new Int32Array(t,r*u.BYTES_PER_RECORD,n*u.ELEMENTS_PER_RECORD));return new e(i)}}]),e}();c.ELEMENTS_PER_RECORD=s.f,c.BYTES_PER_RECORD=c.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;var u=function(){function e(t){Object(n.a)(this,e),this._link=null,this._index=-1,this._deletedCount=0,this._offsets={instance:null},this._packedRecords=t}return Object(i.a)(e,[{key:"delete",value:function(e){var t=this._index,r=this.lookup(e);if(r)for(this.id=o,++this._deletedCount;this.next()&&this.id===e;)this.id=o,++this._deletedCount;return this._index=t,r}},{key:"isEmpty",value:function(){return this._deletedCount===this.size()}},{key:"link",value:function(e){this._link?this._link.link(e):this._link=e}},{key:"lookup",value:function(e){if(Object(a.j)(this._offsets.instance)){this._offsets.instance=new Map;var t=this.copy();t._index=-1;for(var r=0;t.next();)t.id!==r&&(this._offsets.instance.set(t.id,t._index),r=t.id)}if(!this._offsets.instance.has(e))return!1;var n=this._index;return this._index=this._offsets.instance.get(e),this.id!==o||(this._index=n,!1)}},{key:"id",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD]=t}},{key:"materialKey",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+1]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+1]=t}},{key:"insertAfter",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+2]}},{key:"indexFrom",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+3]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+3]=t}},{key:"indexCount",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+4]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+4]=t}},{key:"vertexFrom",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+5]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+5]=t}},{key:"vertexCount",get:function(){return this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+6]},set:function(t){this._packedRecords[this._index*e.ELEMENTS_PER_RECORD+6]=t}},{key:"index",get:function(){return this._index}},{key:"size",value:function(){return this._packedRecords.length/e.ELEMENTS_PER_RECORD}},{key:"next",value:function(){for(;++this._index<this.size()&&this.id===o;);return this._index<this.size()}},{key:"peekId",value:function(){var t=(this._index+1)*e.ELEMENTS_PER_RECORD;return t>=this._packedRecords.length?0:this._packedRecords[t]}},{key:"getCursor",value:function(){return this.copy()}},{key:"copy",value:function(){var t=new e(this._packedRecords);return t._link=this._link,t._index=this._index,t._offsets=this._offsets,t._deletedCount=this._deletedCount,t}}],[{key:"from",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength/this.BYTES_PER_RECORD-r;return new e(new Int32Array(t,r*this.BYTES_PER_RECORD,n*this.ELEMENTS_PER_RECORD))}}]),e}();u.ELEMENTS_PER_RECORD=s.f,u.BYTES_PER_RECORD=u.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT},872:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r(840);function n(e,t,r,n){var i=e.clone(),a=1<<i.level,s=i.col+t,o=i.row+r;return n&&s<0?(i.col=s+a,i.world-=1):s>=a?(i.col=s-a,i.world+=1):i.col=s,i.row=o,i}},878:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r(537),i=r(821),a=new Map;function s(e){return a.get(e)}function o(e,t,r){var i=a.get(e),s=i.indicesPerRecord,o=i.multiplier,c=i.verticesPerRecord;return{recordBytes:r*n.f*Uint32Array.BYTES_PER_ELEMENT,indexBytes:o*s*r*Uint32Array.BYTES_PER_ELEMENT,vertexBytes:o*c*r*t}}a.set(i.d.MARKER,{multiplier:1,indicesPerRecord:6,verticesPerRecord:4}),a.set(i.d.LINE,{multiplier:1,indicesPerRecord:24,verticesPerRecord:8}),a.set(i.d.FILL,{multiplier:1,indicesPerRecord:10,verticesPerRecord:10}),a.set(i.d.TEXT,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4}),a.set(i.d.LABEL,{multiplier:8,indicesPerRecord:6,verticesPerRecord:4})},884:function(e,t,r){"use strict";r.d(t,"a",(function(){return Z}));var n=r(7),i=r.n(n),a=r(15),s=r(16),o=r(2),c=r(3),u=(r(14),r(6)),l=r(24),h=r(831),f=r(29),v=r(4),d=r(5),y=r(12),_=r(20),p=r(46),x=r(37),b=r(537),m=r(837),O=r(824),g=r(821),j=r(903),k=r(823),M=r(825),w=r(828);function S(e,t){return e[t+1]}function E(e){return e.length-1}function T(e){for(var t=0,r=0;r<E(e);r++)t+=L(e,r);return t}function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=S(e,t),i=Object(f.a)(n,2),a=i[0],s=i[1];return Math.sqrt(a*a+s*s)*r}var z=function(){function e(t,r,n,i,a){Object(o.a)(this,e),this._segments=t,this._index=r,this._distance=n,this._xStart=i,this._yStart=a,this._done=!1}return Object(c.a)(e,[{key:"clone",value:function(){return new e(this._segments,this._index,this._distance,this.xStart,this.yStart)}},{key:"equals",value:function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}},{key:"leq",value:function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}},{key:"geq",value:function(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}},{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){var e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length),r=Math.acos(t);return e>0&&(r=2*Math.PI-r),r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){var e=this.dx,t=this.dy;return Math.sqrt(e*e+t*t)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}},{key:"hasPrev",value:function(){return this._index-1>=0}},{key:"hasNext",value:function(){return this._index+1<E(this._segments)}},{key:"next",value:function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}},{key:"prev",value:function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}},{key:"_seekBackwards",value:function(e,t){var r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;for(var n=this.backwardLength;this.prev();){if(n+this.length>e)return this._seekBackwards(e-n);n+=this.length}return this._distance=0,t?this:null}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;for(var r=this.remainingLength;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}],[{key:"create",value:function(t){return new e(t,0,0,t[0][0],t[0][1])}}]),e}();function R(e,t,r){var n=T(e),i=z.create(e),a=n/2,s=(n-t)/2,o=Math.floor(s/t),c=a-o*t;i.seek(c);for(var u=-o;u<=o;u++)i.x<512&&i.x>=0&&i.y<512&&i.y>=0&&r(i.clone(),u,a+u*t,n),i.seek(t)}function C(e,t){var r=1e-6;if(!(t<=0)){var n=e.length;if(!(n<3)){var i=[],a=0;i.push(0);for(var s=1;s<n;s++)a+=Object(w.a)(e[s],e[s-1]),i.push(a);t=Math.min(t,.2*a);var o=[];o.push(e[0][0]),o.push(e[0][1]);var c=e[n-1][0],u=e[n-1][1],l=Object(w.e)([0,0],e[0],e[1]);Object(w.d)(l),e[0][0]+=t*l[0],e[0][1]+=t*l[1],Object(w.e)(l,e[n-1],e[n-2]),Object(w.d)(l),e[n-1][0]+=t*l[0],e[n-1][1]+=t*l[1];for(var h=1;h<n;h++)i[h]+=t;i[n-1]+=t;for(var f=.5*t,v=1;v<n-1;v++){for(var d=0,y=0,_=0,p=v-1;p>=0&&!(i[p+1]<i[v]-f);p--){var x=f+i[p+1]-i[v],b=i[p+1]-i[p],m=i[v]-i[p]<f?1:x/b;if(Math.abs(m)<r)break;var O=m*m,g=m*x-.5*O*b,j=m*b/t,k=e[p+1],M=e[p][0]-k[0],S=e[p][1]-k[1];d+=j/g*(k[0]*m*x+.5*O*(x*M-b*k[0])-O*m*b*M/3),y+=j/g*(k[1]*m*x+.5*O*(x*S-b*k[1])-O*m*b*S/3),_+=j}for(var E=v+1;E<n&&!(i[E-1]>i[v]+f);E++){var T=f-i[E-1]+i[v],L=i[E]-i[E-1],z=i[E]-i[v]<f?1:T/L;if(Math.abs(z)<r)break;var R=z*z,C=z*T-.5*R*L,P=z*L/t,I=e[E-1],V=e[E][0]-I[0],W=e[E][1]-I[1];d+=P/C*(I[0]*z*T+.5*R*(T*V-L*I[0])-R*z*L*V/3),y+=P/C*(I[1]*z*T+.5*R*(T*W-L*I[1])-R*z*L*W/3),_+=P}o.push(d/_),o.push(y/_)}o.push(c),o.push(u);for(var A=0,B=0;A<n;A++)e[A][0]=o[B++],e[A][1]=o[B++]}}}var P=r(851),I=y.a.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate");var V=function(e){var t=new Map;return function(r){return t.has(r)||t.set(r,e(r)),t.get(r)}}((function(e){var t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t})),W=function(e){return Math.floor(127*e+127)},A=function(e){return Math.floor(10*e)},B=function(e){return Math.round(e*(254/360))},D=function(e){Object(v.a)(r,e);var t=Object(d.a)(r);function r(e,n,i,a){var s;Object(o.a)(this,r),(s=t.call(this,e,i.font.size,i.haloSize||0,i.color&&Object(M.d)(i.color)||0,i.haloColor&&Object(M.d)(i.haloColor)||0,i.horizontalAlignment,i.verticalAlignment,Object(j.a)(n.labelPlacement)?1:0,i.font.decoration,!1,i.angle||0,i.xoffset,i.yoffset,i.lineWidth,i.lineHeight,null,null))._outLineLabelAngle=0,s._refPlacementPadding=0,s._refPlacementDirX=0,s._refPlacementDirY=0,s._refOffsetX=0,s._refOffsetY=0,s._zoomLevel=0,s.geometryType=g.d.LABEL;var c=function(e,t){var r=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return Object(p.d)(r,0,25.5)}(n,a),u=function(e,t){var r=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return Object(p.d)(r,0,25.5)}(n,a),l=n.labelPlacement,h=Object(m.b)(l),v=Object(f.a)(h,2),d=v[0],y=v[1];s._xAlignD=d,s._yAlignD=y,s._minZoom=c,s._maxZoom=u,s._refPlacementPadding=Object(x.h)(i.haloSize)+b.C;var _=k.b.load(e);return _.sdf=!0,s._materialKey=_.data,s}return Object(c.a)(r,[{key:"_shapedBox",get:function(){return Object(u.q)(this._shapingInfo).bounds}},{key:"setZoomLevel",value:function(e){this._zoomLevel=e}},{key:"bindReferenceTemplate",value:function(e){var t=Object(m.e)(this._xAlignD),r=Object(m.g)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,Object(u.j)(e))this._refSymbolAndPlacementOffset=Object(O.b)(0,0,W(t),W(r));else{if("circle"===e.boundsType&&(t||r)){var n=Math.sqrt(t*t+r*r);t/=n,r/=n}var i=Math.max(e.height,e.width),a=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=Object(O.b)(a,i,W(t),W(r)),this._referenceSize=i,this._refPlacementDirX=t,this._refPlacementDirY=r,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}}},{key:"_write",value:function(e,t){if(!Object(u.j)(this._shapingInfo)){var r=this._shapingInfo,n=t.getDisplayId(),i="esriGeometryPolygon"===t.geometryType?t.readLegacyCentroid():t.readLegacyGeometry();if(i)switch(this.current={out:e,inId:n,inShaping:r,zoomLevel:this._zoomLevel},t.geometryType){case"esriGeometryPolyline":this._placeLineLabels(i);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(i);break;default:!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mapview-labeling";I.error(new _.a(t,e))}("mapview-labeling","Geometry of type ".concat(t.geometryType," is not supported"))}}}},{key:"_isVisible",value:function(e,t){var r=A(this.current.zoomLevel);return A(e)<=r&&r<=A(t)}},{key:"_placePointLabels",value:function(e){var t=this.current,r=t.out,n=t.inId,i=t.inShaping;this._writeGlyphs(r,n,e,i)}},{key:"_placeLineLabels",value:function(e){var t,r=function(e,t){for(var r=t,n=0;n<e.length;n++){var i=e[n],a=[];a.push(i[0]);for(var s=1;s<i.length;s++){var o=Object(f.a)(a[s-1],2),c=o[0],u=o[1];c+=i[s][0],u+=i[s][1],a.push([c,u])}C(a,r);var l=[];l.push(a[0]);for(var h=1;h<a.length;h++){var v=Object(f.a)(a[h-1],2),d=v[0],y=v[1],_=Object(f.a)(a[h],2),p=_[0],x=_[1],b=Math.round(p-d),m=Math.round(x-y);l.push([b,m])}e[n]=l,i=l}return e}(e.paths,this.current.inShaping.bounds.width),n=this._placeSubdivGlyphs.bind(this),i=(this._shapedBox.width+128)/2,s=Object(a.a)(r);try{for(s.s();!(t=s.n()).done;){R(t.value,i,n)}}catch(o){s.e(o)}finally{s.f()}}},{key:"_placeSubdivGlyphs",value:function(e,t,r,n){var i=V(t),a=this._shapedBox.width/2,s=Math.min(r,n-r),o=Object(p.m)(s/(8+a/2)),c=0===t?o:Math.min(i,o),u=Math.max(this._minZoom,this.current.zoomLevel+1-c),l=this.current.zoomLevel-u,h=this._shapedBox.width/2*Math.pow(2,l);this.current.inShaping.isMultiline?0===t&&this._placeStraight(e,u):this._placeCurved(e,u,h)}},{key:"_placeStraight",value:function(e,t){var r=this.current,n=r.out,i=r.inId,a=r.inShaping;this._writeGlyphs(n,i,e,a,t)}},{key:"_placeCurved",value:function(e,t,r){var n=this.current,i=n.out,a=n.inId;i.metricStart(a,t,e.x,e.y,0,0,0,0);var s=e.clone(),o=e.angle*(180/Math.PI)%360,c=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=B(o),this._placeFirst(s,t,1),this._placeBack(e,s,t,r,1),this._placeForward(e,s,t,r,1),this._outLineLabelAngle=B(c),this._placeFirst(s,t,0),this._placeBack(e,s,t,r,0),this._placeForward(e,s,t,r,0),i.metricEnd()}},{key:"_placeBack",value:function(e,t,r,n,i){for(var a=e.clone(),s=e.backwardLength+0;a.prev()&&!(s>=n);)this._placeOnSegment(a,t,s,r,-1,i),s+=a.length+0}},{key:"_placeForward",value:function(e,t,r,n,i){for(var a=e.clone(),s=e.remainingLength+0;a.next()&&!(s>=n);)this._placeOnSegment(a,t,s,r,1,i),s+=a.length+0}},{key:"_placeFirst",value:function(e,t,r){var n,i=e,s=this.current.inShaping,o=s.glyphs,c=this.current.zoomLevel,u=this.current,l=u.out,h=u.inId,f=Object(a.a)(o);try{for(f.s();!(n=f.n()).done;){var v=n.value,d=v.x>s.bounds.x?r:1-r,y=d*e.remainingLength+(1-d)*e.backwardLength,_=Math.abs(v.x+v.width/2-s.bounds.x),x=Math.max(0,c+Object(p.m)(_/(y+0))),b=Math.max(t,x);if(v.maxZoom=25,v.angle=e.angle+(1-r)*Math.PI,v.minZoom=b,!(i.x<0||i.x>=512||i.y<0||i.y>=512)&&(this._writeGlyph(l,h,i.x,i.y,v),r&&this._isVisible(v.minZoom,v.maxZoom))){var m=v.bounds;l.metricBoxWrite(m.center[0],m.center[1],m.width,m.height)}}}catch(O){f.e(O)}finally{f.f()}}},{key:"_placeOnSegment",value:function(e,t,r,n,i,s){var o,c=this.current.inShaping.glyphs,u=this.current,l=u.out,h=u.inId,f=this.current.inShaping,v=this.current.zoomLevel,d=e.dx/e.length,y=e.dy/e.length,_={x:e.x+r*-i*d,y:e.y+r*-i*y},x=Object(a.a)(c);try{for(x.s();!(o=x.n()).done;){var b=o.value,m=b.x>f.bounds.x?s:1-s;if(m&&1===i||!m&&-1===i){var O=Math.abs(b.x+b.width/2-f.bounds.x),g=Math.max(0,v+Object(p.m)(O/r)-.1),j=Math.max(n,v+Object(p.m)(O/(r+e.length+0)));if(0!==g&&(b.angle=e.angle+(1-s)*Math.PI,b.minZoom=j,b.maxZoom=g,!(_.x<0||_.x>=512||_.y<0||_.y>=512)&&(this._writeGlyph(l,h,_.x,_.y,b),s&&this._isVisible(b.minZoom,b.maxZoom)))){var k=b.bounds,M=e.x-t.x,w=e.y-t.y;l.metricBoxWrite(k.center[0]+M,k.center[1]+w,k.width,k.height)}}}}catch(S){x.e(S)}finally{x.f()}}},{key:"_writeGlyphs",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._minZoom;if(!(r.x<0||r.x>=512||r.y<0||r.y>=512)){var s,o=r.x+this._refOffsetX,c=r.y-this._refOffsetY,u=Object(a.a)(n.glyphs);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.minZoom=i,l.maxZoom=this._maxZoom,this._writeGlyph(e,t,o,c,l)}}catch(_){u.e(_)}finally{u.f()}var h=k.b.load(this._materialKey),f=this._refPlacementDirX,v=this._refPlacementDirY,d=h.vvSizeFieldStops||h.vvSizeMinMaxValue||h.vvSizeScaleStops||h.vvSizeUnitValue,y=n.boundsT;e.metricStart(t,i,o,c,f,v,this._referenceSize,d?1:0),e.metricBoxWrite(y.center[0],y.center[1],y.width,y.height),e.metricEnd()}}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,s=Object(O.b)(0,0,this._size,this._haloSize),o=Math.max(n.minZoom,this._minZoom),c=Math.min(n.maxZoom,this._maxZoom),u=Object(O.b)(A(o),A(c),this._outLineLabelAngle,0);e.vertexWrite(r),e.vertexWrite(t),e.vertexWrite(i),e.vertexWrite(a),e.vertexWrite(s),e.vertexWrite(this._refSymbolAndPlacementOffset),e.vertexWrite(u)}}],[{key:"fromLabelClass",value:function(e,t){if("center-along"===e.labelPlacement){var n=e.symbol;n.xoffset=0,n.yoffset=0,n.angle=0,n.font.decoration="none"}return new r(e.materialKey,e,e.symbol,t)}}]),r}(P.a),F=r(854),G=r(856),Z=function(){function e(t,r,n){Object(o.a)(this,e),this._geometryType=t,this._idField=r,this._templateStore=n}return Object(c.a)(e,[{key:"update",value:function(e,t){Object(u.k)(e.mesh.labels)&&this._setLabelTemplates(e.mesh.labels,t)}},{key:"_setLabelTemplates",value:function(e,t){this._labelTemplates=e.map((function(e){return D.fromLabelClass(e,t)}))}},{key:"templates",get:function(){return this._templateStore}},{key:"analyze",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n,s,o,c){var f,v,d,y,_,p,x;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(l.n)(c)){e.next=2;break}return e.abrupt("return");case 2:if(e.t0="dictionary"===r.type,!e.t0){e.next=7;break}return e.next=6,r.analyze(this._idField,t.copy(),s,o,c);case 6:f=e.sent;case 7:for(v=0;t.next();)if(void 0,d=f?f[v++]:Object(u.k)(n)&&Object(h.c)(t.getDisplayId())&&1!==t.readAttribute("cluster_count")?n.match(this._idField,t,this._geometryType,s,o):r.match(this._idField,t,this._geometryType,s,o),t.setGroupId(d),Object(G.b)(d)){y=this._templateStore.getDynamicTemplateGroup(d),_=Object(a.a)(y);try{for(_.s();!(p=_.n()).done;)(x=p.value)&&x.analyze&&x.analyze(this._templateStore,t,s,o)}catch(i){_.e(i)}finally{_.f()}}return e.abrupt("return",this._templateStore.finalize(c));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a,s){return e.apply(this,arguments)}}()},{key:"analyzeGraphics",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n,s,o){var c,u,h,f,v,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(l.n)(o)){e.next=2;break}return e.abrupt("return");case 2:if(c=t.getCursor(),e.t0=r,!e.t0){e.next=7;break}return e.next=7,r.analyze(this._idField,c.copy(),n,s,o);case 7:if(!c.next()){e.next=13;break}if(null!=(u=c.getGroupId())&&-1!==u||(u=r.match(this._idField,c,c.geometryType,n,s),c.setGroupId(u)),Object(G.b)(u)){h=this._templateStore.getDynamicTemplateGroup(u),f=Object(a.a)(h);try{for(f.s();!(v=f.n()).done;)(d=v.value)&&d.analyze&&d.analyze(this._templateStore,c,n,s)}catch(i){f.e(i)}finally{f.f()}}c.setGroupId(u);case 11:e.next=7;break;case 13:return e.abrupt("return",this._templateStore.finalize(o));case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"writeGraphic",value:function(e,t){var r=t.getGroupId(),n=t.getDisplayId(),i=this._templateStore.getTemplateGroup(r);if(e.featureStart(t.insertAfter),null!=n){if(Object(G.b)(r)){var s,o=Object(a.a)(i);try{for(o.s();!(s=o.n()).done;){s.value.bindFeature(t,null,null)}}catch(h){o.e(h)}finally{o.f()}}if(i){var c,u=Object(a.a)(i);try{for(u.s();!(c=u.n()).done;){var l=c.value;l&&l.write(e,t)}}catch(h){u.e(h)}finally{u.f()}e.featureEnd()}}}},{key:"writeCursor",value:function(e,t,r,n,i,s){var o=t.getGroupId(),c=t.getDisplayId(),l=this._templateStore.getTemplateGroup(o);if(t.getObjectId(),null!=c&&l){if(Object(G.b)(o)){var h,f=Object(a.a)(l);try{for(f.s();!(h=f.n()).done;){h.value.bindFeature(t,r,n)}}catch(_){f.e(_)}finally{f.f()}}var v,d=Object(a.a)(l);try{for(d.s();!(v=d.n()).done;){v.value.write(e,t)}}catch(_){d.e(_)}finally{d.f()}if(Object(u.k)(s)&&e.hasRecords){var y=s&&this._findLabelRef(l);this._writeLabels(e,t,s,y,i)}}}},{key:"_findLabelRef",value:function(e){var t,r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n instanceof F.a)return n}}catch(i){r.e(i)}finally{r.f()}return null}},{key:"_writeLabels",value:function(e,t,r,n,i){var s,o=Object(a.a)(r);try{for(o.s();!(s=o.n()).done;){var c=s.value;if(Object(u.k)(c)&&c){var l=c.glyphs,h=c.rtl,f=c.index,v=this._labelTemplates[f];v.setZoomLevel(i),v.bindReferenceTemplate(n),v.bindTextInfo(l,h),v.write(e,t)}}}catch(d){o.e(d)}finally{o.f()}}}]),e}()},887:function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r(23),i=r(2),a=r(3),s=r(200),o=r(537),c=(r(654),r(539),r(652),r(653),r(821)),u=r(822),l=r(878),h=r(832),f=function(){function e(t,r,n){Object(i.a)(this,e),this._start={index:0,vertex:0};var a=Object(l.b)(t,r,n),s=r/4;this.geometryType=t,this._records=new h.a(Int32Array,a.recordBytes),this._indices=new h.a(Uint32Array,a.indexBytes),this._vertices=new h.a(Uint32Array,a.vertexBytes),this._metrics=new h.a(Float32Array,0),this._strideInt=s}return Object(a.a)(e,[{key:"serialize",value:function(e){var t=this._records.buffer(),r=this._indices.buffer(),n=this._vertices.buffer(),i=this._metrics.length?this._metrics.buffer():null,a=4*this._strideInt;return e.push(t,r,n),{stride:a,records:t,indices:r,vertices:n,metrics:i}}},{key:"strideInt",get:function(){return this._strideInt}},{key:"recordCount",get:function(){return this._records.length/o.f}},{key:"vertexCount",get:function(){return this._vertices.length/this._strideInt}},{key:"indexCount",get:function(){return this._indices.length}},{key:"indexWriter",get:function(){return this._indices}},{key:"vertexWriter",get:function(){return this._vertices}},{key:"metricWriter",get:function(){return this._metrics}},{key:"recordStart",value:function(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}},{key:"recordEnd",value:function(e,t,r,n,i,a,s){this._records.push(e),this._records.push(t),this._records.push(r),this._records.push(n),this._records.push(i),this._records.push(a),this._records.push(s)}},{key:"writeIndex",value:function(e){this._indices.push(e)}},{key:"writeVertex",value:function(e){this._vertices.push(e)}},{key:"writeVertexF32",value:function(e){this._vertices.writeF32(e)}},{key:"copyLastFrom",value:function(e,t,r){for(var n=e._records.length-7,i=e._records.getValue(n),a=e._records.getValue(n+1),s=e._records.getValue(n+2),o=e._records.getValue(n+4),c=e._records.getValue(n+6),u=this._vertices.length,l=(e._start.vertex-this._vertices.length)/this._strideInt,h=this._indices.length,f=this.vertexCount,v=e._start.index;v!==e._indices.length;v++){var d=e._indices.getValue(v);this._indices.push(d-l)}for(var y=e._start.vertex;y!==e._vertices.length;y++){var _=e._vertices.getValue(y);this._vertices.push(_)}for(var p=u;p<=this._vertices.length;p+=this._strideInt)this._vertices.i1616Add(p,t,r);this._records.push(i),this._records.push(a),this._records.push(s),this._records.push(h),this._records.push(o),this._records.push(f),this._records.push(c)}}]),e}(),v=r(831),d=r(872),y=128;function _(e){switch(e){case 1:case 8:case 32:return-1;case 2:case 64:return 0;case 4:case 16:case y:return 1}}function p(e){switch(e){case 1:case 2:case 4:return-1;case 8:case 16:return 0;case 32:case 64:case y:return 1}}var x=function(){function e(t,r,n,a,s){Object(i.a)(this,e),this._hasDotDensity=!1,this._hasAggregate=!1,this.hasRecords=!1,this._data={self:new Map,neighbors:new Array},this._current={geometryType:0,writer:null,overlaps:0,start:0,insertAfter:0,id:0,materialKey:0,indexStart:0,vertStart:0,isDotDensity:!1,bufferingEnabled:!1,metricBoxLenPointer:0},this.hint=r,this.tileKey=t,this._hasDotDensity=n,this._hasAggregate=a,this._pixelBufferEnabled=s}return Object(a.a)(e,[{key:"hasAggregates",get:function(){return this._hasAggregate}},{key:"hasPixelBufferEnabled",get:function(){return this._pixelBufferEnabled}},{key:"serialize",value:function(e){var t=this,r=[];return r.push(this._serializeTileVertexData(this.tileKey,this._data.self)),this._data.neighbors.forEach((function(n,i){var a=1<<i,o=_(a),c=p(a),u=Object(d.a)(new s.a(t.tileKey),o,c,e);r.push(t._serializeTileVertexData(u.id,n))})),r}},{key:"_serializeTileVertexData",value:function(e,t){var r,i,a,s,o,u,l=new Array;return{message:{tileKey:e,data:(r={},Object(n.a)(r,c.d.MARKER,null==(i=t.get(c.d.MARKER))?void 0:i.serialize(l)),Object(n.a)(r,c.d.FILL,null==(a=t.get(c.d.FILL))?void 0:a.serialize(l)),Object(n.a)(r,c.d.LINE,null==(s=t.get(c.d.LINE))?void 0:s.serialize(l)),Object(n.a)(r,c.d.TEXT,null==(o=t.get(c.d.TEXT))?void 0:o.serialize(l)),Object(n.a)(r,c.d.LABEL,null==(u=t.get(c.d.LABEL))?void 0:u.serialize(l)),r)},transferList:l}}},{key:"featureStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._current.insertAfter=e}},{key:"featureEnd",value:function(){}},{key:"recordStart",value:function(e,t,r,n,i){this._current.writer=this._getVertexWriter(r,n),this._current.overlaps=0,this._current.indexStart=this._current.writer.indexCount,this._current.vertStart=this._current.writer.vertexCount,this._current.bufferingEnabled=i,this._current.id=e,this._current.materialKey=t,this._current.geometryType=r,this._current.isDotDensity=!1,this._current.writer.recordStart()}},{key:"recordCount",value:function(){return this._current.writer.recordCount}},{key:"vertexCount",value:function(){return this._current.writer.vertexCount}},{key:"indexCount",value:function(){return this._current.writer.indexCount}},{key:"vertexBounds",value:function(e,t,r,n){this._current.bufferingEnabled&&this._addOverlap(e,t,r,n)}},{key:"vertexWrite",value:function(e){this._current.writer.writeVertex(e)}},{key:"vertexWriteF32",value:function(e){this._current.writer.writeVertexF32(e)}},{key:"vertexEnd",value:function(){}},{key:"vertexWriter",value:function(){return this._current.writer.vertexWriter}},{key:"indexWrite",value:function(e){this._current.writer.writeIndex(e)}},{key:"indexWriter",value:function(){return this._current.writer.indexWriter}},{key:"metricWriter",value:function(){return this._current.writer.metricWriter}},{key:"metricStart",value:function(e,t,r,n,i,a,s,o){this._current.writer=this._getVertexWriter(c.d.LABEL,!1);var u=this._current.writer.metricWriter;u.push(Object(v.b)(e)),u.push(t),u.push(r),u.push(n),u.push(i),u.push(a),u.push(s),u.push(o),u.push(255),this._current.metricBoxLenPointer=u.push(0)}},{key:"metricEnd",value:function(){var e=this._current.writer.metricWriter;0===e.getValue(this._current.metricBoxLenPointer)&&e.seek(e.length-10)}},{key:"metricBoxWrite",value:function(e,t,r,n){var i=this._current.writer.metricWriter;i.incr(this._current.metricBoxLenPointer),i.push(0),i.push(0),i.push(e),i.push(t),i.push(r),i.push(n)}},{key:"recordEnd",value:function(){var e=this._current.indexStart,t=this._current.writer.indexCount;if(e===t)return!1;this.hasRecords=!0;var r=t-e,n=this._current.vertStart,i=this._current.writer.vertexCount-n;if(this._current.writer.recordEnd(this._current.id,this._current.materialKey,this._current.insertAfter,e,r,n,i),!this._pixelBufferEnabled||this._hasAggregate||0===this._current.overlaps||this._current.geometryType===c.d.LABEL)return!0;for(var a=this._current.writer,s=0;s<8;s++){var l=1<<s;if(this._current.overlaps&l){if(!this._data.neighbors[s]){var h=new Map;this._data.neighbors[s]=h}var v=this._data.neighbors[s],d=this._current.geometryType;if(!v.has(d)){var y=Object(u.l)(d,this._current.isDotDensity).geometry;v.set(d,new f(d,y,o.o))}var x=v.get(this._current.geometryType),b=512*-_(l)*8,m=512*-p(l)*8;x.copyLastFrom(a,b,m)}}return!0}},{key:"_addOverlap",value:function(e,t,r,n){var i=255^((e<0+r?148:e>=o.E-r?41:189)|(t<0+n?224:t>=o.E-n?7:231));this._current.overlaps|=i}},{key:"_getVertexWriter",value:function(e,t){if(!this._data.self.has(e)){var r=this._data.self,n=Object(u.l)(e,this._hasDotDensity).geometry;r.set(e,new f(e,n,8e3))}return this._data.self.get(e)}}]),e}()},888:function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));var n=r(7),i=r.n(n),a=r(16),s=r(12),o=r(20),c=r(10),u=r(15),l=r(30),h=r(28),f=r(4),v=r(5),d=r(2),y=r(3),_=r(142),p=r(139),x=r(436),b=r(850),m=r(860),O=r(847),g=s.a.getLogger("esri/views/2d/engine/webgl/util/Matcher"),j=function(){function e(){Object(d.a)(this,e),this.type="feature",this._defaultResult=null}return Object(y.a)(e,[{key:"size",value:function(){return 1}},{key:"getDefault",value:function(){return this._defaultResult}},{key:"setDefault",value:function(e){this._defaultResult=e}},{key:"match",value:function(e,t,r,n,i){return this.getDefault()}},{key:"analyze",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a,s){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()}],[{key:"fromBasicRenderer",value:function(){var t=Object(a.a)(i.a.mark((function t(r,n,a){var s,o,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new e,!r.symbol){t.next=7;break}return t.next=4,Object(m.a)(r.symbol,a);case 4:o=t.sent,c=n.createTemplateGroup(o,null),s.setDefault(c);case 7:return t.abrupt("return",s);case 8:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()}]),e}(),k=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,i,a){var s;return Object(d.a)(this,r),(s=t.call(this)).type="interval",s._intervals=[],s._isMaxInclusive=n,s._fieldIndex=a,s._field=e,s._normalizationInfo=i,s}return Object(y.a)(r,[{key:"add",value:function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort((function(e,t){return e.interval.min-t.interval.min}))}},{key:"size",value:function(){return Object(l.a)(Object(h.a)(r.prototype),"size",this).call(this)+this._intervals.length}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldIndex&&!this._field)return this.getDefault();var a=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(!a&&(null==a||isNaN(a)))return this.getDefault();for(var s=0;s<this._intervals.length;s++){var o=this._intervals[s],c=o.interval,u=o.result,l=a>=c.min,h=this._isMaxInclusive?a<=c.max:a<c.max;if(l&&h)return u}return this.getDefault()}},{key:"_needsNormalization",value:function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}},{key:"_getValueFromField",value:function(e){var t=e.readAttribute(this._field);if(!this._needsNormalization()||null==t)return t;var r=this._normalizationInfo,n=r.normalizationField,i=r.normalizationTotal,a=r.normalizationType,s=!!n&&e.readAttribute(n);if(a)switch(a){case"esriNormalizeByField":return s?t/s:void 0;case"esriNormalizeByLog":return Math.log(t)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return t/i*100;default:return void g.error("Found unknown normalization type: ".concat(a))}else g.error("Normalization is required, but no type was set!")}}],[{key:"fromCBRenderer",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n,s){var o,c,u,l,h,f,v,d,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.isMaxInclusive,c=t.normalizationField,u=t.normalizationTotal,l=t.normalizationType,h=t.field,f=new r(h,o,{normalizationField:c,normalizationTotal:u,normalizationType:l},t.fieldIndex),e.next=8,Object(m.a)(t.backgroundFillSymbol,s);case 8:return v=e.sent,e.next=11,Promise.all(t.intervals.map(function(){var e=Object(a.a)(i.a.mark((function e(t){var r,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(t.symbol,s);case 2:return r=e.sent,e.next=5,n.createTemplateGroup(r,v);case 5:a=e.sent,o={min:t.min,max:t.max},f.add(o,a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.next=13,Object(m.a)(t.defaultSymbol,s);case 13:if(!(d=e.sent)){e.next=19;break}return e.next=17,n.createTemplateGroup(d,v);case 17:y=e.sent,f.setDefault(y);case 19:return e.abrupt("return",f);case 20:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(j),M=function(e){Object(f.a)(r,e);var t=Object(v.a)(r);function r(e,n,i){var a;return Object(d.a)(this,r),(a=t.call(this)).type="map",a._nullResult=null,a._resultsMap=new Map,a._fieldsIndex=i,a._fields=e,a._seperator=n||"",a}return Object(y.a)(r,[{key:"setNullResult",value:function(e){this._nullResult=e}},{key:"add",value:function(e,t){this._resultsMap.set(e.toString(),t)}},{key:"size",value:function(){return Object(l.a)(Object(h.a)(r.prototype),"size",this).call(this)+this._resultsMap.size}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();var a=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==a||""===a||"<Null>"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();var s=a.toString();return this._resultsMap.has(s)?this._resultsMap.get(s):this.getDefault()}},{key:"_getValueFromFields",value:function(e){var t,r=[],n=Object(u.a)(this._fields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=e.readAttribute(i);r.push(a)}}catch(s){n.e(s)}finally{n.f()}return r.join(this._seperator)}}],[{key:"fromUVRenderer",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n,s){var o,c,u,l,h,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.fieldDelimiter,c=[t.field],t.field2&&c.push(t.field2),t.field3&&c.push(t.field3),e.next=4,Object(m.a)(t.backgroundFillSymbol,s);case 4:return u=e.sent,l=new r(c,o,t.fieldIndex),e.next=8,Promise.all(t.map.map(function(){var e=Object(a.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(t.symbol,s);case 2:return r=e.sent,e.next=5,n.createTemplateGroup(r,u);case 5:a=e.sent,"<Null>"===t.value?l.setNullResult(a):l.add(t.value,a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.next=10,Object(m.a)(t.defaultSymbol,s);case 10:if(!(h=e.sent)){e.next=16;break}return e.next=14,n.createTemplateGroup(h,u);case 14:f=e.sent,l.setDefault(f);case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(j);function w(e,t){return S.apply(this,arguments)}function S(){return(S=Object(a.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!=typeof(n=t||1)){e.next=3;break}return e.abrupt("return",(function(e,t,r){return n}));case 3:return e.next=5,Object(_.d)(n,r.spatialReference,r.fields);case 5:return a=e.sent,e.abrupt("return",(function(e,t,n){return Object(b.a)(a,e,{$view:n},r.geometryType,t)||1}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=function(e){Object(f.a)(n,e);var t=Object(v.a)(n);function n(e,r,i,a){var s;return Object(d.a)(this,n),(s=t.call(this)).type="dictionary",s._groupIdCache=new x.a(100),s._renderer=e,s._fieldMap=e.fieldMap,s._symbolFields=e.getSymbolFields(),s._templates=r,s._info=i,s._scaleFn=a,s}return Object(y.a)(n,[{key:"_analyzeFeature",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a){var s,l,h,f,v,d,y,_,x=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.readLegacyFeature(),l=this._scaleFn(s,r,n),h=this._attributeHash(s)+"-"+l,!(f=this._groupIdCache.get(h))){e.next=3;break}return e.abrupt("return",f);case 3:return v=Object(c.a)(Object(c.a)({},n),{},{spatialReference:this._info.spatialReference,abortOptions:a,fields:this._info.fields}),e.next=6,this._renderer.getSymbolAsync(s,v);case 6:return d=e.sent,y=Object(O.c)(d,this._renderer),_=Object(m.a)(y,this._info,a).then((function(e){if("expanded-cim"!==e.type)return g.error(new o.a("mapview-bad-type","Found unexpected type ".concat(e.type," in dictionary response"))),null;e.hash+="-"+l;var t,r=Object(u.a)(e.layers);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.scaleFactor=l,n.templateHash+="-"+l,"text"===n.type&&"string"==typeof n.text&&n.text.indexOf("[")>-1&&(n.text=Object(p.c)(x._fieldMap,n.text,n.cim.textCase))}}catch(i){r.e(i)}finally{r.f()}return x._templates.createTemplateGroup(e,null)})),e.abrupt("return",(this._groupIdCache.put(h,_,1),_));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"analyze",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a,s){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=r.getCursor(),c=[];o.next();)c.push(this._analyzeFeature(o,n,a,s));return e.abrupt("return",Promise.all(c));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"match",value:function(e,t,r,n,i){return null}},{key:"_attributeHash",value:function(e){var t,r="",n=Object(u.a)(this._symbolFields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this._fieldMap[i];a&&(r+=e.attributes[a]+"-")}}catch(s){n.e(s)}finally{n.f()}return r}}],[{key:"fromDictionaryRenderer",value:function(){var e=Object(a.a)(i.a.mark((function e(t,a,s){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.bind(null,441));case 2:return o=e.sent.default.fromJSON(t.renderer),e.next=5,o.fetchResources({spatialReference:s.spatialReference,fields:s.fields});case 5:return e.next=7,w(o.scaleExpression,s);case 7:return c=e.sent,e.abrupt("return",new n(o,a,s,c));case 9:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),n}(j),T=s.a.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");function L(e,t,r){return z.apply(this,arguments)}function z(){return(z=Object(a.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="simple"===e.t0?3:"map"===e.t0?4:"interval"===e.t0?5:"dictionary"===e.t0?6:7;break;case 3:return e.abrupt("return",j.fromBasicRenderer(t,r,n));case 4:return e.abrupt("return",M.fromUVRenderer(t,r,n));case 5:return e.abrupt("return",k.fromCBRenderer(t,r,n));case 6:return e.abrupt("return",E.fromDictionaryRenderer(t,r,n));case 7:return e.abrupt("return",(T.error(new o.a("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},889:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return i}));var n=r(2);function i(e,t,r){var n,i,s,c,u,l=t&&t.length,h=l?t[0]*r:e.length,f=a(e,0,h,r,!0),d=new Array;if(!f||f.next===f.prev)return d;if(l&&(f=v(e,t,f,r)),e.length>80*r){n=s=e[0],i=c=e[1];for(var y=r;y<h;y+=r){var _=e[y],p=e[y+1];n=Math.min(n,_),i=Math.min(i,p),s=Math.max(s,_),c=Math.max(c,p)}u=0!==(u=Math.max(s-n,c-i))?1/u:0}return o(f,d,r,n,i,u),d}function a(e,t,r,n,i){var a;if(i===b(e,t,r,n)>0)for(var s=t;s<r;s+=n)a=l(s,e[s],e[s+1],a);else for(var o=r-n;o>=t;o-=n)a=l(o,e[o],e[o+1],a);return a&&j(a,a.next)&&(h(a),a=a.next),a}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,n=e;do{if(r=!1,n.steiner||!j(n,n.next)&&0!==p(n.prev,n,n.next))n=n.next;else{if(h(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function o(e,t,r,n,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(e){!l&&a&&(e=y(e,n,i,a));for(var f=e;e.prev!==e.next;){var v=e.prev,d=e.next;if(a?u(e,n,i,a):c(e))t.push(v.index/r),t.push(e.index/r),t.push(d.index/r),h(e),e=d.next,f=d.next;else if((e=d)===f){l?1===l?o(e=M(e,t,r),t,r,n,i,a,2):2===l&&w(e,t,r,n,i,a):o(s(e),t,r,n,i,a,1);break}}}}function c(e){var t=e.prev,r=e,n=e.next;if(p(t,r,n)>=0)return!1;for(var i=e.next.next,a=i,s=0;i!==e.prev&&(0===s||i!==a);){if(s++,m(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&p(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(e,t,r,n){var i=e.prev,a=e,s=e.next;if(p(i,a,s)>=0)return!1;for(var o=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,c=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,u=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,l=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=g(o,c,t,r,n),f=g(u,l,t,r,n),v=e.prevZ,d=e.nextZ;v&&v.z>=h&&d&&d.z<=f;){if(v!==e.prev&&v!==e.next&&m(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&p(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,d!==e.prev&&d!==e.next&&m(i.x,i.y,a.x,a.y,s.x,s.y,d.x,d.y)&&p(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;v&&v.z>=h;){if(v!==e.prev&&v!==e.next&&m(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&p(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&m(i.x,i.y,a.x,a.y,s.x,s.y,d.x,d.y)&&p(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function l(e,t,r,n){var i=new T(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function h(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function f(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function v(e,t,r,n){for(var i=new Array,o=0,c=t.length;o<c;o++){var u=a(e,t[o]*n,o<c-1?t[o+1]*n:e.length,n,!1);u===u.next&&(u.steiner=!0),i.push(f(u))}i.sort(k);for(var l=0,h=i;l<h.length;l++){d(h[l],r),r=s(r,r.next)}return r}function d(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>s){if(s=o,o===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===s)return r.prev;var c,u=r,l=r.x,h=r.y,f=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&m(a<h?i:s,a,l,h,a<h?s:i,a,n.x,n.y)&&(((c=Math.abs(a-n.y)/(i-n.x))<f||c===f&&n.x>r.x)&&O(n,e)&&(r=n,f=c)),n=n.next;return r}(e,t)){var r=E(t,e);s(r,r.next)}}function y(e,t,r,n){for(var i;i!==e;i=i.next){if(null===(i=i||e).z&&(i.z=g(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,y(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var n=void 0,i=e;e=null,t=null;for(var a=0;i;){a++,n=i;for(var s=0;s<r&&n;s++)n=n.nextZ;for(var o=r;s>0||o>0&&n;){var c=void 0;0===s?(c=n,n=n.nextZ,o--):0!==o&&n?i.z<=n.z?(c=i,i=i.nextZ,s--):(c=n,n=n.nextZ,o--):(c=i,i=i.nextZ,s--),t?t.nextZ=c:e=c,c.prevZ=t,t=c}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function _(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,s=Math.abs(b(e,0,a,r));if(i)for(var o=0,c=t.length;o<c;o++){var u=t[o]*r,l=o<c-1?t[o+1]*r:e.length;s-=Math.abs(b(e,u,l,r))}for(var h=0,f=0;f<n.length;f+=3){var v=n[f]*r,d=n[f+1]*r,y=n[f+2]*r;h+=Math.abs((e[v]-e[y])*(e[d+1]-e[v+1])-(e[v]-e[d])*(e[y+1]-e[v+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)}function p(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function x(e,t,r,n){return!!(j(e,t)&&j(r,n)||j(e,n)&&j(r,t))||p(e,t,r)>0!=p(e,t,n)>0&&p(r,n,e)>0!=p(r,n,t)>0}function b(e,t,r,n){for(var i=0,a=t,s=r-n;a<r;a+=n)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}function m(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function O(e,t){return p(e.prev,e,e.next)<0?p(e,t,e.next)>=0&&p(e,e.prev,t)>=0:p(e,t,e.prev)<0||p(e,e.next,t)<0}function g(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function j(e,t){return e.x===t.x&&e.y===t.y}function k(e,t){return e.x-t.x}function M(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!j(i,a)&&x(i,n,n.next,a)&&O(i,a)&&O(a,i)&&(t.push(i.index/r),t.push(n.index/r),t.push(a.index/r),h(n),h(n.next),n=e=a),n=n.next}while(n!==e);return n}function w(e,t,r,n,i,a){var c=e;do{for(var u=c.next.next;u!==c.prev;){if(c.index!==u.index&&S(c,u)){var l=E(c,u);return c=s(c,c.next),l=s(l,l.next),o(c,t,r,n,i,a),void o(l,t,r,n,i,a)}u=u.next}c=c.next}while(c!==e)}function S(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&x(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&O(e,t)&&O(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function E(e,t){var r=new T(e.index,e.x,e.y),n=new T(t.index,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}var T=function e(t,r,i){Object(n.a)(this,e),this.index=t,this.x=r,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},903:function(e,t,r){"use strict";function n(e){switch(e){case"above-along":case"below-along":case"center-along":return 1;default:return 0}}r.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=51.5087827e.chunk.js.map