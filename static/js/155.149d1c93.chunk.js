(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[155],{1203:function(e,t,n){"use strict";n.r(t),n.d(t,"registerFunctions",(function(){return S}));var a=n(15),r=n(24),i=n(861),l=n(894),c=n(953),o=n(194),s=n(868),u=n(910),f=n(1024),d=n(1103),b=n(688),y=n(935),m=n(1065),p=n(1105),O=n(1068),h=n(1067),v=n(1069),j=n(1107),g=n(219),F=n(1108),I=n(1129);function E(e,t,n){var a=e.getVariables();if(a.length>0){for(var i=[],l=0;l<a.length;l++){var c={name:a[l]};i.push(t.evaluateIdentifier(n,c))}return Object(r.b)(i).then((function(t){for(var n={},r=0;r<a.length;r++)n[a[r]]=t[r];return e.parameters=n,e}))}return Object(r.s)(e)}function D(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var a in e)if(a.toLowerCase()===t.toLowerCase())return e[a];return n}function w(e){if(null===e)return null;var t={type:D(e,"type",""),name:D(e,"name","")};if("range"===t.type)t.range=D(e,"range",[]);else{t.codedValues=[];var n,r=Object(a.a)(D(e,"codedValues",[]));try{for(r.s();!(n=r.n()).done;){var i=n.value;t.codedValues.push({name:D(i,"name",""),code:D(i,"code",null)})}}catch(l){r.e(l)}finally{r.f()}}return t}function x(e){if(null===e)return null;var t={},n=D(e,"wkt",null);null!==n&&(t.wkt=n);var a=D(e,"wkid",null);return null!==a&&(t.wkid=a),t}function A(e){if(null===e)return null;var t={hasZ:D(e,"hasz",!1),hasM:D(e,"hasm",!1)},n=D(e,"spatialreference",null);n&&(t.spatialReference=x(n));var a=D(e,"x",null);if(null!==a)return t.x=a,t.y=D(e,"y",null),t;var r=D(e,"rings",null);if(null!==r)return t.rings=r,t;var i=D(e,"paths",null);if(null!==i)return t.paths=i,t;var l=D(e,"points",null);if(null!==l)return t.points=l,t;for(var c=0,o=["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"];c<o.length;c++){var s=o[c],u=D(e,s,null);null!==u&&(t[s]=u)}return t}function N(e){return!!e.layerDefinition&&!!e.featureSet&&!1!==function(e,t){var n,r=Object(a.a)(t);try{for(r.s();!(n=r.n()).done;)if(n.value===e)return!0}catch(i){r.e(i)}finally{r.f()}return!1}(e.layerDefinition.geometryType,["","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&null!==e.layerDefinition.objectIdField&&""!==e.layerDefinition.objectIdField&&!1!==Object(i.u)(e.layerDefinition.fields)&&!1!==Object(i.u)(e.featureSet.features)}function S(e){"async"===e.mode&&(e.functions.getuser=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,a){Object(i.J)(a,1,2);var r=Object(i.O)(a[1],""),o=!0===r;if(r=!0===r||!1===r?"":Object(i.x)(r),a[0]instanceof c.a){var s=null;return t.services&&t.services.portal&&(s=t.services.portal),s=Object(I.getPortal)(a[0],s),Object(I.lookupUser)(s,r,o).then((function(e){if(e){for(var t=JSON.parse(JSON.stringify(e)),n=0,a=["lastLogin","created","modified"];n<a.length;n++){var r=a[n];void 0!==t[r]&&null!==t[r]&&(t[r]=new Date(t[r]))}return l.a.convertObjectToArcadeDictionary(t)}return null}))}var u=null;if(Object(i.K)(a[0])&&(u=a[0]),u)return o=!1,r?null:u.load().then((function(){return u.getOwningSystemUrl()})).then((function(e){if(!e)return r?null:u.getIdentityUser().then((function(e){return e?l.a.convertObjectToArcadeDictionary({username:e}):null}));var n=null;return t.services&&t.services.portal&&(n=t.services.portal),n=Object(I.getPortal)(new c.a(e),n),Object(I.lookupUser)(n,r,o).then((function(e){if(e){for(var t=JSON.parse(JSON.stringify(e)),n=0,a=["lastLogin","created","modified"];n<a.length;n++){var r=a[n];void 0!==t[r]&&null!==t[r]&&(t[r]=new Date(t[r]))}return l.a.convertObjectToArcadeDictionary(t)}return null}))}));throw new Error("Invalid Parameter")}))},e.signatures.push({name:"getuser",min:"1",max:"2"}),e.functions.featuresetbyid=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if(Object(i.J)(n,2,4),n[0]instanceof d.a){var a=Object(i.x)(n[1]),r=Object(i.O)(n[2],null),l=Object(i.a)(Object(i.O)(n[3],!0));if(null===r&&(r=["*"]),!1===Object(i.u)(r))throw new Error("Invalid Parameter");return n[0].featureSetById(a,l,r)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyid",min:"2",max:"4"}),e.functions.featuresetbyportalitem=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,a){if(Object(i.J)(a,2,5),null===a[0])throw new Error("Portal is required");if(a[0]instanceof c.a){var r=Object(i.x)(a[1]),l=Object(i.x)(a[2]),o=Object(i.O)(a[3],null),s=Object(i.a)(Object(i.O)(a[4],!0));if(null===o&&(o=["*"]),!1===Object(i.u)(o))throw new Error("Invalid Parameter");var u=null;return t.services&&t.services.portal&&(u=t.services.portal),u=Object(I.getPortal)(a[0],u),Object(I.constructFeatureSetFromPortalItem)(r,l,t.spatialReference,o,s,u,t.lrucache,t.interceptor)}if(!1===Object(i.A)(a[0]))throw new Error("Portal is required");var f=Object(i.x)(a[0]),d=Object(i.x)(a[1]),b=Object(i.O)(a[2],null),y=Object(i.a)(Object(i.O)(a[3],!0));if(null===b&&(b=["*"]),!1===Object(i.u)(b))throw new Error("Invalid Parameter");if(t.services&&t.services.portal)return Object(I.constructFeatureSetFromPortalItem)(f,d,t.spatialReference,b,y,t.services.portal,t.lrucache,t.interceptor);throw new Error("Portal is required")}))},e.signatures.push({name:"featuresetbyportalitem",min:"2",max:"5"}),e.functions.featuresetbyname=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){if(Object(i.J)(n,2,4),n[0]instanceof d.a){var a=Object(i.x)(n[1]),r=Object(i.O)(n[2],null),l=Object(i.a)(Object(i.O)(n[3],!0));if(null===r&&(r=["*"]),!1===Object(i.u)(r))throw new Error("Invalid Parameter");return n[0].featureSetByName(a,l,r)}throw new Error("Invalid Parameter")}))},e.signatures.push({name:"featuresetbyname",min:"2",max:"4"}),e.functions.featureset=function(t,n){return e.standardFunction(t,n,(function(e,n,r){Object(i.J)(r,1,1);var c=r[0],o={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if(Object(i.A)(c))void 0!==(c=JSON.parse(c)).layerDefinition?(o.layerDefinition=c.layerDefinition,o.featureSet=c.featureSet,c.layerDefinition.spatialReference&&(o.layerDefinition.spatialReference=c.layerDefinition.spatialReference)):(o.featureSet.features=c.features,o.featureSet.geometryType=c.geometryType,o.layerDefinition.geometryType=o.featureSet.geometryType,o.layerDefinition.objectIdField=c.objectIdFieldName,o.layerDefinition.typeIdField=c.typeIdFieldName,o.layerDefinition.globalIdField=c.globalIdFieldName,o.layerDefinition.fields=c.fields,c.spatialReference&&(o.layerDefinition.spatialReference=c.spatialReference));else{if(!(r[0]instanceof l.a))throw new Error("Invalid Parameter");var s=D(c=JSON.parse(r[0].castToText()),"layerdefinition");if(null!==s){o.layerDefinition.geometryType=D(s,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.globalIdField=D(s,"globalidfield",""),o.layerDefinition.objectIdField=D(s,"objectidfield",""),o.layerDefinition.typeIdField=D(s,"typeidfield","");var u=D(s,"spatialreference",null);u&&(o.layerDefinition.spatialReference=x(u));var f,d=Object(a.a)(D(s,"fields",[]));try{for(d.s();!(f=d.n()).done;){var b=f.value,y={name:D(b,"name",""),alias:D(b,"alias",""),type:D(b,"type",""),nullable:D(b,"nullable",!0),editable:D(b,"editable",!0),length:D(b,"length",null),domain:w(D(b,"domain"))};o.layerDefinition.fields.push(y)}}catch(_){d.e(_)}finally{d.f()}var m=D(c,"featureset",null);if(m){var p,O={},h=Object(a.a)(o.layerDefinition.fields);try{for(h.s();!(p=h.n()).done;){var v=p.value;O[v.name.toLowerCase()]=v.name}}catch(_){h.e(_)}finally{h.f()}var j,g=Object(a.a)(D(m,"features",[]));try{for(g.s();!(j=g.n()).done;){var I=j.value,E={},S=D(I,"attributes",{});for(var T in S)E[O[T.toLowerCase()]]=S[T];o.featureSet.features.push({attributes:E,geometry:A(D(I,"geometry",null))})}}catch(_){g.e(_)}finally{g.f()}}}else{o.layerDefinition.geometryType=D(c,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.objectIdField=D(c,"objectidfieldname",""),o.layerDefinition.typeIdField=D(c,"typeidfieldname","");var L=D(c,"spatialreference",null);L&&(o.layerDefinition.spatialReference=x(L));var C,R=Object(a.a)(D(c,"fields",[]));try{for(R.s();!(C=R.n()).done;){var P=C.value,W={name:D(P,"name",""),alias:D(P,"alias",""),type:D(P,"type",""),nullable:D(P,"nullable",!0),editable:D(P,"editable",!0),length:D(P,"length",null),domain:w(D(P,"domain"))};o.layerDefinition.fields.push(W)}}catch(_){R.e(_)}finally{R.f()}var k,J={},M=Object(a.a)(o.layerDefinition.fields);try{for(M.s();!(k=M.n()).done;){var G=k.value;J[G.name.toLowerCase()]=G.name}}catch(_){M.e(_)}finally{M.f()}var B,V=Object(a.a)(D(c,"features",[]));try{for(V.s();!(B=V.n()).done;){var H=B.value,z={},K=D(H,"attributes",{});for(var U in K)z[J[U.toLowerCase()]]=K[U];o.featureSet.features.push({attributes:z,geometry:A(D(H,"geometry",null))})}}catch(_){V.e(_)}finally{V.f()}}}if(!1===N(o))throw new Error("Invalid Parameter");return F.a.create(o,t.spatialReference)}))},e.signatures.push({name:"featureset",min:"1",max:"1"}),e.functions.filter=function(t,n){return e.standardFunctionAsync(t,n,(function(n,a,l){return Object(i.J)(l,2,2),Object(i.K)(l[0])?l[0].load().then((function(n){var a=b.WhereClause.create(l[1],n.getFieldsIndex()),i=a.getVariables();if(i.length>0){for(var c=[],o=0;o<i.length;o++){var s={name:i[o]};c.push(e.evaluateIdentifier(t,s))}return Object(r.b)(c).then((function(e){for(var t={},n=0;n<i.length;n++)t[i[n]]=e[n];return a.parameters=t,new m.a({parentfeatureset:l[0],whereclause:a})}))}return Object(r.s)(new m.a({parentfeatureset:l[0],whereclause:a}))})):e.failDefferred("Filter cannot accept this parameter type")}))},e.signatures.push({name:"filter",min:"2",max:"2"}),e.functions.orderby=function(t,n){return e.standardFunctionAsync(t,n,(function(t,n,a){if(Object(i.J)(a,2,2),Object(i.K)(a[0])){var l=new O.a(a[1]);return Object(r.s)(new h.a({parentfeatureset:a[0],orderbyclause:l}))}return e.failDefferred("Order cannot accept this parameter type")}))},e.signatures.push({name:"orderby",min:"2",max:"2"}),e.functions.top=function(t,n){return e.standardFunctionAsync(t,n,(function(t,n,a){return Object(i.J)(a,2,2),Object(i.K)(a[0])?Object(r.s)(new j.a({parentfeatureset:a[0],topnum:a[1]})):Object(i.u)(a[0])?Object(i.N)(a[1])>=a[0].length?a[0].slice(0):a[0].slice(0,Object(i.N)(a[1])):Object(i.v)(a[0])?Object(i.N)(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,Object(i.N)(a[1])):e.failDefferred("Top cannot accept this parameter type")}))},e.signatures.push({name:"top",min:"2",max:"2"}),e.functions.first=function(t,n){return e.standardFunctionAsync(t,n,(function(e,t,n){return Object(i.J)(n,1,1),Object(i.K)(n[0])?n[0].first(e.abortSignal).then((function(e){if(null!==e){var t=u.a.createFromGraphicLikeObject(e.geometry,e.attributes,n[0]);t._underlyingGraphic=e,e=t}return e})):Object(i.u)(n[0])?0===n[0].length?Object(r.s)(null):Object(r.s)(n[0][0]):Object(i.v)(n[0])?0===n[0].length()?Object(r.s)(null):Object(r.s)(n[0].get(0)):null}))},e.signatures.push({name:"first",min:"1",max:"1"}),e.functions.attachments=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,a){Object(i.J)(a,1,2);var r={minsize:-1,maxsize:-1,types:null};if(a.length>1)if(a[1]instanceof l.a){if(a[1].hasField("minsize")&&(r.minsize=Object(i.N)(a[1].field("minsize"))),a[1].hasField("maxsize")&&(r.maxsize=Object(i.N)(a[1].field("maxsize"))),a[1].hasField("types")){var c=Object(i.t)(a[1].field("types"),!1);c.length>0&&(r.types=c)}}else if(null!==a[1])throw new Error("Invalid Parameter");if(a[0]instanceof u.a){var o=a[0]._layer;return o instanceof g.default&&(o=Object(I.constructFeatureSet)(o,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null===o||!1===Object(i.K)(o)?[]:o.load().then((function(){return o.queryAttachments(a[0].field(o.objectIdField),r.minsize,r.maxsize,r.types)}))}if(null===a[0])return[];throw new Error("Invalid Parameter")}))},e.signatures.push({name:"attachments",min:"1",max:"2"}),e.functions.featuresetbyrelationshipname=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,a){Object(i.J)(a,2,4);var r=a[0],l=Object(i.x)(a[1]),c=Object(i.O)(a[2],null),o=Object(i.a)(Object(i.O)(a[3],!0));if(null===c&&(c=["*"]),!1===Object(i.u)(c))throw new Error("Invalid Parameter");if(null===a[0])return null;if(!(a[0]instanceof u.a))throw new Error("Invalid Parameter");var s=r._layer;return s instanceof g.default&&(s=Object(I.constructFeatureSet)(s,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null===s||!1===Object(i.K)(s)?null:s.load().then((function(e){var n=e.relationshipMetaData().filter((function(e){return e.name===l}));if(0===n.length)return null;if(void 0!==n[0].relationshipTableId&&null!==n[0].relationshipTableId&&n[0].relationshipTableId>-1)return Object(I.constructFeatureSetFromRelationship)(e,n[0],r.field(e.objectIdField),e.spatialReference,c,o,t.lrucache,t.interceptor);var a=e.serviceUrl();return a?(a="/"===a.charAt(a.length-1)?a+n[0].relatedTableId.toString():a+"/"+n[0].relatedTableId.toString(),Object(I.constructFeatureSetFromUrl)(a,e.spatialReference,c,o,t.lrucache,t.interceptor).then((function(t){return t.load().then((function(){return t.relationshipMetaData()})).then((function(a){if(a=a.filter((function(e){return e.id===n[0].id})),!1===r.hasField(n[0].keyField)||null===r.field(n[0].keyField))return e.getFeatureByObjectId(r.field(e.objectIdField),[n[0].keyField]).then((function(e){if(e){var r=b.WhereClause.create(a[0].keyField+"= @id",t.getFieldsIndex());return r.parameters={id:e.attributes[n[0].keyField]},t.filter(r)}return new v.a({parentfeatureset:t})}));var i=b.WhereClause.create(a[0].keyField+"= @id",t.getFieldsIndex());return i.parameters={id:r.field(n[0].keyField)},t.filter(i)}))}))):null}))}))},e.signatures.push({name:"featuresetbyrelationshipname",min:"2",max:"4"}),e.functions.featuresetbyassociation=function(t,n){return e.standardFunctionAsync(t,n,(function(e,n,r){Object(i.J)(r,2,3);var l=r[0],c=Object(i.x)(Object(i.O)(r[1],"")).toLowerCase(),f=Object(i.A)(r[2])?Object(i.x)(r[2]):null;if(null===r[0])return null;if(!(r[0]instanceof u.a))throw new Error("Invalid Parameter");var d=l._layer;return d instanceof g.default&&(d=Object(I.constructFeatureSet)(d,t.spatialReference,["*"],!0,t.lrucache,t.interceptor)),null===d||!1===Object(i.K)(d)?null:d.load().then((function(){var e=d.serviceUrl();return Object(I.constructAssociationMetaDataFeatureSetFromUrl)(e,t.spatialReference)})).then((function(e){var t=null,n=null,r=!1;if(null!==f&&""!==f&&void 0!==f){var u,y=Object(a.a)(e.terminals);try{for(y.s();!(u=y.n()).done;){var m=u.value;m.terminalName===f&&(n=m.terminalId)}}catch(z){y.e(z)}finally{y.f()}null===n&&(r=!0)}var O,h=e.associations.getFieldsIndex(),v=h.get("TOGLOBALID").name,j=h.get("FROMGLOBALID").name,g=h.get("TOTERMINALID").name,F=h.get("FROMTERMINALID").name,I=h.get("FROMNETWORKSOURCEID").name,E=h.get("TONETWORKSOURCEID").name,D=h.get("ASSOCIATIONTYPE").name,w=h.get("ISCONTENTVISIBLE").name,x=h.get("OBJECTID").name,A=Object(a.a)(d.fields);try{for(A.s();!(O=A.n()).done;){var N=O.value;if("global-id"===N.type){t=l.field(N.name);break}}}catch(z){A.e(z)}finally{A.f()}var S=null,T=new p.d(new o.a({name:"percentalong",alias:"percentalong",type:"double"}),b.WhereClause.create("0",e.associations.getFieldsIndex())),L=new p.d(new o.a({name:"side",alias:"side",type:"string"}),b.WhereClause.create("''",e.associations.getFieldsIndex())),C="globalid",R="globalId",P={};for(var W in e.lkp)P[W]=e.lkp[W].sourceId;var k=new p.e(new o.a({name:"classname",alias:"classname",type:"string"}),null,P),J="";switch(c){case"midspan":J="((".concat(v,"='").concat(t,"') OR ( ").concat(j,"='").concat(t,"')) AND (").concat(D," IN (5))"),k.codefield=b.WhereClause.create("CASE WHEN (".concat(v,"='").concat(t,"') THEN ").concat(I," ELSE ").concat(E," END"),e.associations.getFieldsIndex());var M=Object(s.c)(p.a.findField(e.associations.fields,j));M.name=C,M.alias=C,S=new p.d(M,b.WhereClause.create("CASE WHEN (".concat(j,"='").concat(t,"') THEN ").concat(v," ELSE ").concat(j," END"),e.associations.getFieldsIndex())),T=e.unVersion>=4?new p.c(p.a.findField(e.associations.fields,h.get("PERCENTALONG").name)):new p.d(new o.a({name:"percentalong",alias:"percentalong",type:"double"}),b.WhereClause.create("0",e.associations.getFieldsIndex()));break;case"junctionedge":J="((".concat(v,"='").concat(t,"') OR ( ").concat(j,"='").concat(t,"')) AND (").concat(D," IN (4,6))"),k.codefield=b.WhereClause.create("CASE WHEN (".concat(v,"='").concat(t,"') THEN ").concat(I," ELSE ").concat(E," END"),e.associations.getFieldsIndex());var G=Object(s.c)(p.a.findField(e.associations.fields,j));G.name=C,G.alias=C,S=new p.d(G,b.WhereClause.create("CASE WHEN (".concat(j,"='").concat(t,"') THEN ").concat(v," ELSE ").concat(j," END"),e.associations.getFieldsIndex())),L=new p.d(new o.a({name:"side",alias:"side",type:"string"}),b.WhereClause.create("CASE WHEN (".concat(D,"=4) THEN 'from' ELSE 'to' END"),e.associations.getFieldsIndex()));break;case"connected":var B="".concat(v,"='@T'"),V="".concat(j,"='@T'");null!==n&&(B+=" AND ".concat(g,"=@A"),V+=" AND ".concat(F,"=@A")),J="(("+B+") OR ("+V+"))",J=Object(i.c)(J,"@T",t),B=Object(i.c)(B,"@T",t),null!==n&&(B=Object(i.c)(B,"@A",n.toString()),J=Object(i.c)(J,"@A",n.toString())),k.codefield=b.WhereClause.create("CASE WHEN "+B+" THEN ".concat(I," ELSE ").concat(E," END"),e.associations.getFieldsIndex());var H=Object(s.c)(p.a.findField(e.associations.fields,j));H.name=C,H.alias=C,S=new p.d(H,b.WhereClause.create("CASE WHEN "+B+" THEN ".concat(j," ELSE ").concat(v," END"),e.associations.getFieldsIndex()));break;case"container":J="".concat(v,"='").concat(t,"' AND ").concat(D," = 2"),null!==n&&(J+=" AND ".concat(g," = ")+n.toString()),k.codefield=I,J="( "+J+" )",S=new p.b(p.a.findField(e.associations.fields,j),C,C);case"content":J="(".concat(j,"='").concat(t,"' AND ").concat(D," = 2)"),null!==n&&(J+=" AND ".concat(F," = ")+n.toString()),k.codefield=E,J="( "+J+" )",S=new p.b(p.a.findField(e.associations.fields,v),C,C);break;case"structure":J="(".concat(v,"='").concat(t,"' AND ").concat(D," = 3)"),null!==n&&(J+=" AND ".concat(g," = ")+n.toString()),k.codefield=I,J="( "+J+" )",S=new p.b(p.a.findField(e.associations.fields,j),C,R);break;case"attached":J="(".concat(j,"='").concat(t,"' AND ").concat(D," = 3)"),null!==n&&(J+=" AND ".concat(F," = ")+n.toString()),k.codefield=E,J="( "+J+" )",S=new p.b(p.a.findField(e.associations.fields,v),C,R);break;default:throw new Error("Invalid Parameter")}return r&&(J="1 <> 1"),new p.a({parentfeatureset:e.associations,adaptedFields:[new p.c(p.a.findField(e.associations.fields,x)),new p.c(p.a.findField(e.associations.fields,w)),S,L,k,T],extraFilter:J?b.WhereClause.create(J,e.associations.getFieldsIndex()):null})}))}))},e.signatures.push({name:"featuresetbyassociation",min:"2",max:"6"}),e.functions.groupby=function(t,n){return e.standardFunctionAsync(t,n,(function(n,c,o){return Object(i.J)(o,3,3),Object(i.K)(o[0])?o[0].load().then((function(n){var c=[],s=[],u=!1,f=[];if(Object(i.A)(o[1]))f.push(o[1]);else if(o[1]instanceof l.a)f.push(o[1]);else if(Object(i.u)(o[1]))f=o[1];else{if(!Object(i.v)(o[1]))return e.failDefferred("Illegal Value: GroupBy");f=o[1].toArray()}var d,m=Object(a.a)(f);try{for(m.s();!(d=m.n()).done;){var p=d.value;if(Object(i.A)(p)){var O=b.WhereClause.create(Object(i.x)(p),n.getFieldsIndex()),h=!0===Object(y.c)(O)?Object(i.x)(p):"%%%%FIELDNAME";c.push({name:h,expression:O}),"%%%%FIELDNAME"===h&&(u=!0)}else{if(!(p instanceof l.a))return e.failDefferred("Illegal Value: GroupBy");var v=p.hasField("name")?p.field("name"):"%%%%FIELDNAME",j=p.hasField("expression")?p.field("expression"):"";if("%%%%FIELDNAME"===v&&(u=!0),!v)return e.failDefferred("Illegal Value: GroupBy");c.push({name:v,expression:b.WhereClause.create(j||v,n.getFieldsIndex())})}}}catch(q){m.e(q)}finally{m.f()}if(f=[],Object(i.A)(o[2]))f.push(o[2]);else if(Object(i.u)(o[2]))f=o[2];else if(Object(i.v)(o[2]))f=o[2].toArray();else{if(!(o[2]instanceof l.a))return e.failDefferred("Illegal Value: GroupBy");f.push(o[2])}var g,F=Object(a.a)(f);try{for(F.s();!(g=F.n()).done;){var I=g.value;if(!(I instanceof l.a))return e.failDefferred("Illegal Value: GroupBy");var D=I.hasField("name")?I.field("name"):"",w=I.hasField("statistic")?I.field("statistic"):"",x=I.hasField("expression")?I.field("expression"):"";if(!D||!w||!x)return e.failDefferred("Illegal Value: GroupBy");s.push({name:D,statistic:w.toLowerCase(),expression:b.WhereClause.create(x,n.getFieldsIndex())})}}catch(q){F.e(q)}finally{F.f()}if(u){var A,N={},S=Object(a.a)(n.fields);try{for(S.s();!(A=S.n()).done;){N[A.value.name.toLowerCase()]=1}}catch(q){S.e(q)}finally{S.f()}var T,L=Object(a.a)(c);try{for(L.s();!(T=L.n()).done;){var C=T.value;"%%%%FIELDNAME"!==C.name&&(N[C.name.toLowerCase()]=1)}}catch(q){L.e(q)}finally{L.f()}var R,P=Object(a.a)(s);try{for(P.s();!(R=P.n()).done;){var W=R.value;"%%%%FIELDNAME"!==W.name&&(N[W.name.toLowerCase()]=1)}}catch(q){P.e(q)}finally{P.f()}var k,J=0,M=Object(a.a)(c);try{for(M.s();!(k=M.n()).done;){var G=k.value;if("%%%%FIELDNAME"===G.name){for(;1===N["field_"+J.toString()];)J++;N["field_"+J.toString()]=1,G.name="FIELD_"+J.toString()}}}catch(q){M.e(q)}finally{M.f()}}for(var B=[],V=0,H=c;V<H.length;V++){var z=H[V];B.push(E(z.expression,e,t))}for(var K=0,U=s;K<U.length;K++){var _=U[K];B.push(E(_.expression,e,t))}return B.length>0?Object(r.b)(B).then((function(){return Object(r.s)(o[0].groupby(c,s))})):Object(r.s)(o[0].groupby(c,s))})):e.failDefferred("Illegal Value: GroupBy")}))},e.signatures.push({name:"groupby",min:"3",max:"3"}),e.functions.distinct=function(t,n){return e.standardFunctionAsync(t,n,(function(n,c,o){return Object(i.K)(o[0])?(Object(i.J)(o,2,2),o[0].load().then((function(n){var c=[],s=[];if(Object(i.A)(o[1]))s.push(o[1]);else if(o[1]instanceof l.a)s.push(o[1]);else if(Object(i.u)(o[1]))s=o[1];else{if(!Object(i.v)(o[1]))return e.failDefferred("Illegal Value: GroupBy");s=o[1].toArray()}var u,f=!1,d=Object(a.a)(s);try{for(d.s();!(u=d.n()).done;){var m=u.value;if(Object(i.A)(m)){var p=b.WhereClause.create(Object(i.x)(m),n.getFieldsIndex()),O=!0===Object(y.c)(p)?Object(i.x)(m):"%%%%FIELDNAME";c.push({name:O,expression:p}),"%%%%FIELDNAME"===O&&(f=!0)}else{if(!(m instanceof l.a))return e.failDefferred("Illegal Value: GroupBy");var h=m.hasField("name")?m.field("name"):"%%%%FIELDNAME",v=m.hasField("expression")?m.field("expression"):"";if("%%%%FIELDNAME"===h&&(f=!0),!h)return e.failDefferred("Illegal Value: GroupBy");c.push({name:h,expression:b.WhereClause.create(v||h,n.getFieldsIndex())})}}}catch(P){d.e(P)}finally{d.f()}if(f){var j,g={},F=Object(a.a)(n.fields);try{for(F.s();!(j=F.n()).done;){g[j.value.name.toLowerCase()]=1}}catch(P){F.e(P)}finally{F.f()}var I,D=Object(a.a)(c);try{for(D.s();!(I=D.n()).done;){var w=I.value;"%%%%FIELDNAME"!==w.name&&(g[w.name.toLowerCase()]=1)}}catch(P){D.e(P)}finally{D.f()}var x,A=0,N=Object(a.a)(c);try{for(N.s();!(x=N.n()).done;){var S=x.value;if("%%%%FIELDNAME"===S.name){for(;1===g["field_"+A.toString()];)A++;g["field_"+A.toString()]=1,S.name="FIELD_"+A.toString()}}}catch(P){N.e(P)}finally{N.f()}}for(var T=[],L=0,C=c;L<C.length;L++){var R=C[L];T.push(E(R.expression,e,t))}return T.length>0?Object(r.b)(T).then((function(){return Object(r.s)(o[0].groupby(c,[]))})):Object(r.s)(o[0].groupby(c,[]))}))):function(e,t,n,a){if(1===a.length){if(Object(i.u)(a[0]))return Object(f.a)(e,a[0],-1);if(Object(i.v)(a[0]))return Object(f.a)(e,a[0].toArray(),-1)}return Object(f.a)(e,a,-1)}("distinct",0,0,o)}))})}}}]);
//# sourceMappingURL=155.149d1c93.chunk.js.map