"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[3345],{42137:(e,t,o)=>{o.d(t,{Z:()=>g});var i,a=o(27366),r=o(68860),s=o(49861),n=(o(25243),o(63780),o(69912)),p=o(83448),l=o(585),h=o(80885),c=o(15559),d=o(81753),u=o(89093);let y=i=class extends h.Z{constructor(){super(...arguments),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(e,t){let o;if(e&&e.center)o=e;else{if(e&&e.rings)return super.normalizeCtorArgs(e,t);o={center:e}}return{...super.normalizeCtorArgs(),...o,...t}}initialize(){const e=this.center,t=this.numberOfPoints;if(this.hasZ=e?.hasZ??!1,0!==this.rings.length||!e)return;const o=(0,r.En)(this.radius,this.radiusUnit,"meters"),i=e.spatialReference;let a,s="geographic";if(i.isWebMercator?s="webMercator":(null!=(i.wkid&&u.Z[i.wkid])||i.wkt&&0===i.wkt.indexOf("PROJCS"))&&(s="projected"),this.geodesic){let i;switch(s){case"webMercator":i=(0,d.Sx)(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":i=e}a=this._createGeodesicCircle(i,o,t),"webMercator"===s&&(a=(0,d.$)(a))}else{let i;"webMercator"===s||"projected"===s?i=o/this._convert2Meters(1,e.spatialReference):"geographic"===s&&(i=(0,r.ty)(o,"meters",(0,p.Iu)(e.spatialReference).radius)),a=this._createPlanarCircle(e,i,t)}this.spatialReference=a.spatialReference,this.addRing(a.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:o,radiusUnit:a,geodesic:r}=this;return new i({center:e?.clone(),numberOfPoints:t,radius:o,radiusUnit:a,geodesic:r})}_createGeodesicCircle(e,t,o){let i=0;const a=[];for(;i<360;){const r=[0,0],s=[e.x,e.y];(0,c.TB)(r,s,i,t),this.hasZ&&r.push(e.z),a.push(r),i+=360/o}return a.push(a[0]),new h.Z(a)}_createPlanarCircle(e,t,o){const i=[],a=2*Math.PI/o;for(let r=0;r<o;++r){const o=a*r,s=[e.x+Math.cos(-o)*t,e.y+Math.sin(-o)*t];this.hasZ&&s.push(e.z),i.push(s)}return i.push(i[0]),new h.Z({spatialReference:e.spatialReference,rings:[i]})}_convert2Meters(e,t){let o;if(t.wkid&&null!=u.Z[t.wkid])o=u.Z.values[u.Z[t.wkid]];else{const e=t.wkt,i=e.lastIndexOf(",")+1,a=e.lastIndexOf("]]");o=parseFloat(e.substring(i,a))}return e*o}};(0,a._)([(0,s.Cb)({type:l.Z})],y.prototype,"center",void 0),(0,a._)([(0,s.Cb)()],y.prototype,"geodesic",void 0),(0,a._)([(0,s.Cb)()],y.prototype,"numberOfPoints",void 0),(0,a._)([(0,s.Cb)()],y.prototype,"radius",void 0),(0,a._)([(0,s.Cb)()],y.prototype,"radiusUnit",void 0),y=i=(0,a._)([(0,n.j)("esri.geometry.Circle")],y);const g=y},93655:(e,t,o)=>{o.d(t,{Z:()=>u});var i=o(27366),a=o(49861),r=(o(25243),o(63780),o(69912)),s=o(68748),n=o(30651),p=o(6693),l=o(56811),h=o(78983),c=o(64575);let d=class extends((0,p.h)((0,l.M)(n.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new h.J,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,i._)([(0,a.Cb)({type:c.Z})],d.prototype,"elevationInfo",void 0),(0,i._)([(0,a.Cb)((0,s.z)(h.J,"graphics"))],d.prototype,"graphics",void 0),(0,i._)([(0,a.Cb)({type:["show","hide"]})],d.prototype,"listMode",void 0),(0,i._)([(0,a.Cb)()],d.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,a.Cb)({readOnly:!0})],d.prototype,"type",void 0),(0,i._)([(0,a.Cb)({constructOnly:!0})],d.prototype,"internal",void 0),d=(0,i._)([(0,r.j)("esri.layers.GraphicsLayer")],d);const u=d},77498:(e,t,o)=>{o.d(t,{Z:()=>a,e:()=>i});var i;o(93169);function a(e){switch(e){case i.SUPPORTED:break;case i.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case i.GEOMETRY_MISSING:return"no geometry";case i.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case i.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case i.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}!function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"}(i||(i={}))},57889:(e,t,o)=>{o.d(t,{P:()=>s});o(93169);var i=o(92026),a=o(74509),r=o(77498);function s(e){if("graphics"!==e.layer?.type)return r.e.GRAPHICS_LAYER_MISSING;if((0,i.Wi)(e.geometry))return r.e.GEOMETRY_MISSING;switch(e.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return r.e.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==(0,a.vu)(e)&&(0,a.Lt)(e)?r.e.ELEVATION_MODE_UNSUPPORTED:r.e.SUPPORTED}},46684:(e,t,o)=>{o.d(t,{P:()=>n,b:()=>p});var i=o(92026),a=o(42137),r=o(74509),s=o(77498);function n(e){return l(e).result}function p(e){return l(e).geometry}function l(e){return"graphics"!==e.layer?.type?{result:s.e.GRAPHICS_LAYER_MISSING,geometry:null}:(0,i.Wi)(e.geometry)?{result:s.e.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==(0,r.vu)(e)&&(0,r.Lt)(e)?{result:s.e.ELEVATION_MODE_UNSUPPORTED,geometry:null}:"point"!==e.geometry.type&&"polyline"!==e.geometry.type&&("polygon"!==e.geometry.type||e.geometry instanceof a.Z)?{result:s.e.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:s.e.SUPPORTED,geometry:e.geometry}}},83089:(e,t,o)=>{o.d(t,{j:()=>r,p:()=>a});var i=o(92026);function a(e,t,o){if(!t||!e||!e.map)return;const{map:i}=e,a=i.layers.find((e=>e===t));a||i.add(t,o),a&&null!=o&&i.layers.reorder(a,o)}function r(e,t){return e.allLayerViews.find((e=>{const o=e.layer;return o===t||"sublayers"in o&&(0,i.pC)(o.sublayers)&&o.sublayers.includes(t)}))}},52349:(e,t,o)=>{o.d(t,{Z:()=>p});var i=o(27366),a=o(85015),r=o(49861),s=(o(25243),o(63780),o(69912));let n=class extends a.Z{constructor(e){super(e),this.enabled=!1}};(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],n.prototype,"enabled",void 0),n=(0,i._)([(0,s.j)("esri.views.interactive.sketch.SketchLabelOptions")],n);const p=n},77560:(e,t,o)=>{o.d(t,{Z:()=>h});var i=o(27366),a=o(85015),r=o(49861),s=(o(25243),o(63780),o(69912));let n=class extends a.Z{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};(0,i._)([(0,r.Cb)({type:String,nonNullable:!0})],n.prototype,"mode",void 0),n=(0,i._)([(0,s.j)("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],n);let p=class extends a.Z{constructor(){super(...arguments),this.distance=!0,this.elevation=!0,this.size=!0,this.scale=!0,this.rotation=!0,this.orientation=!0,this.totalLength=!0,this.area=!0,this.radius=!0,this.helpMessage=!1}toJSON(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}}};(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"distance",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"elevation",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"size",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"scale",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"rotation",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"orientation",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"totalLength",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"area",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"radius",void 0),(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],p.prototype,"helpMessage",void 0),p=(0,i._)([(0,s.j)("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],p);let l=class extends a.Z{constructor(e){super(e),this.enabled=!1,this.elevation=new n,this.visibleElements=new p,this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};(0,i._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"enabled",void 0),(0,i._)([(0,r.Cb)({type:n,nonNullable:!0})],l.prototype,"elevation",void 0),(0,i._)([(0,r.Cb)({type:p,nonNullable:!0})],l.prototype,"visibleElements",void 0),(0,i._)([(0,r.Cb)()],l.prototype,"visualVariables",void 0),l=(0,i._)([(0,s.j)("esri.widgets.Sketch.SketchTooltipOptions")],l);const h=l},74923:(e,t,o)=>{o.d(t,{qm:()=>r});var i=o(92026);function a(e){return(0,i.pC)(e)&&"graphic"===e.type}function r(e){return e.find(a)??null}},43345:(e,t,o)=>{o.d(t,{Z:()=>X});var i=o(27366),a=o(51508),r=o(40281),s=o(10064),n=o(91505),p=o(100),l=o(32718),h=o(92026),c=o(66978),d=o(94172),u=o(49861),y=(o(25243),o(63780),o(69912)),g=o(83448),v=o(79803),m=o(69662),_=o(92975),b=o(93655),f=o(77498),E=o(57889),G=o(46684),O=(o(93169),o(74509));var w=o(83089),C=o(1614),T=o(87888),S=o(52349),A=o(77560),P=o(38856),R=o(98173),M=o(64674),I=o(74923),U=o(72612),k=o(41644);let D=class extends n.Z.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:(0,k.Bg)(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const e=this.activeComponent;e&&("box"!==e.type&&"reshape"!==e.type&&"graphic-mover"!==e.type||e.refresh())}set undo(e){this._set("undo",(()=>{this.canUndo()&&e()}))}set redo(e){this._set("redo",(()=>{this.canRedo()&&e()}))}};(0,i._)([(0,u.Cb)()],D.prototype,"activeComponent",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"cancelled",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"history",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"tool",null),(0,i._)([(0,u.Cb)()],D.prototype,"type",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"canUndo",null),(0,i._)([(0,u.Cb)()],D.prototype,"canRedo",null),(0,i._)([(0,u.Cb)()],D.prototype,"onEnd",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"undo",null),(0,i._)([(0,u.Cb)()],D.prototype,"redo",null),(0,i._)([(0,u.Cb)()],D.prototype,"toggleTool",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"addToSelection",void 0),(0,i._)([(0,u.Cb)()],D.prototype,"removeFromSelection",void 0),D=(0,i._)([(0,y.j)("esri.widgets.Sketch.support.OperationHandle")],D);let H=class extends D{};(0,i._)([(0,u.Cb)()],H.prototype,"activeComponent",void 0),H=(0,i._)([(0,y.j)("esri.widgets.Sketch.support.CreateOperationHandle")],H);let x=class extends D{};(0,i._)([(0,u.Cb)()],x.prototype,"activeComponent",void 0),x=(0,i._)([(0,y.j)("esri.widgets.Sketch.support.UpdateOperationHandle")],x);var L=o(16072),Z=o(61459),N=o(16851);const W={defaultZ:0},V={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};let Y=class extends n.Z.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._handles=new p.Z,this._internalGraphicsLayer=new b.Z({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandles=new p.Z,this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new S.Z,this.layer=null,this.pointSymbol=new L.Z({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Z.Z({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new N.Z({color:[130,130,130,1],width:2}),this._snappingManager=null,this.tooltipOptions=new A.Z,this.updateGraphics=new r.Z,this.updateOnGraphicClick=!0,this.updatePointSymbol=new L.Z({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}}),this.updatePolygonSymbol=new Z.Z({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}}),this.updatePolylineSymbol=new N.Z({color:[12,207,255],width:2}),this.vertexSymbol=new L.Z({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalAutoOpenEnabled=null,this.defaultCreateOptions=W,this.defaultUpdateOptions=V,this.snappingOptions=new R.Z}initialize(){this._handles.add([(0,d.on)((()=>this.view?.map?.layers),"change",(e=>{e.removed.includes(this.layer)&&this.cancel()})),(0,d.on)((()=>this.layer?.graphics),"change",(e=>{if((0,h.pC)(this._operationHandle))for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())})),(0,d.YP)((()=>this.layer?.elevationInfo??null),(e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)}),d.tX),(0,d.YP)((()=>this.view),(e=>{(0,h.SC)(this._snappingManager),e&&(this._snappingManager=new P.N({view:e,options:this.snappingOptions}),"2d"===e.type?Promise.all([o.e(9058),o.e(5652),o.e(4046),o.e(696),o.e(1515),o.e(2113),o.e(1842),o.e(700)]).then(o.bind(o,10461)):"3d"===e.type&&(Promise.all([o.e(1378),o.e(2029),o.e(9058),o.e(5652),o.e(5158),o.e(4046),o.e(696),o.e(2880),o.e(5269),o.e(4184),o.e(1515),o.e(2113),o.e(9212),o.e(1842),o.e(5207)]).then(o.bind(o,65207)),Promise.all([o.e(1378),o.e(2029),o.e(5652),o.e(5158),o.e(2880),o.e(5269),o.e(4184),o.e(9900),o.e(8556),o.e(6211),o.e(5562)]).then(o.bind(o,15562))))}),d.tX),(0,d.YP)((()=>this.view?.spatialReference),((e,t)=>{e&&t&&!e.equals(t)&&this.cancel()}))]),(0,M.Ob)(this)}destroy(){this.cancel(),this._handles=(0,h.SC)(this._handles),this._viewHandles=(0,h.SC)(this._viewHandles),this._removeDefaultLayer(),this._snappingManager=(0,h.SC)(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){return"3d"===this.view?.type?"move":"transform"}get updating(){return this._numUpdating>0||(0,h.pC)(this._snappingManager)&&this._snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return!(0,h.pC)(this.activeComponent)||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):(0,h.Wg)(this.activeComponent.graphic)}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...W,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...V,...e,reshapeOptions:{...V.reshapeOptions,...e?.reshapeOptions}})}set snappingOptions(e){(0,h.pC)(this._snappingManager)&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){const e=!(!this.view?.ready||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:e,map:o}=t;e&&(t.cursor=null),o&&o.remove(this._internalGraphicsLayer),this._viewHandles.removeAll(),this.cancel()}const o="view-ready";this._handles.remove(o),e&&this._handles.add((0,d.gx)((()=>e.ready),(t=>{this._viewHandles.removeAll(),t&&this._viewHandles.add(this._generateViewHandles(e))}),d.tX),o),this._set("view",e)}cancel(){this._moduleLoaderAbortController=(0,h.IM)(this._moduleLoaderAbortController),this._viewReadyAbortController=(0,h.IM)(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if("active"===e&&t.length){const{activeTool:e,layer:o}=this,i=t.toArray();o.removeMany(i),this.cancel(),this._emitDeleteEvent({graphics:i,tool:e})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const e=this.updateGraphics.map((e=>e.clone())).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:o,layer:i}=this;if(!o||"disabled"===this.state)throw i||this._logMissingLayer(),(0,c.zE)();if((0,h.pC)(o.activeTool)&&(o.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");(0,w.p)(o,this._internalGraphicsLayer);const a=await this._setupCreateOperation(e,t);if((0,h.Wi)(a)||this.destroyed)return void o.map.remove(this._internalGraphicsLayer);a.on("complete",(()=>{if(a===this._operationHandle){const t=this.createGraphic,o=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),a.cancelled||null==t||i.add(t),this.emit("create",{graphic:t,state:o?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}})),this._operationHandle=a,o.ready&&o.focus()}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:o,view:i,state:a}=this;if(!i||"disabled"===a)throw o||this._logMissingLayer(),(0,c.zE)();(0,h.pC)(i.activeTool)&&(i.activeTool=null);const r=Array.isArray(e)?e:[e];if(null==e||!r||!r.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(r.some((e=>e.layer!==o?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):!!(0,h.Wi)(e.geometry)&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0))))return;const s=await this._setupUpdateOperation(r,t);this.destroyed||(0,h.Wi)(s)||$(s)||((0,w.p)(i,this._internalGraphicsLayer),this._setUpdateOperationHandle(s,t),this.emit("update",{graphics:r,state:"start",aborted:!1,tool:s.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const o of e)(0,h.pC)(o.geometry)&&"mesh"!==o.geometry.type&&!(0,_.fS)(o.geometry.spatialReference,t.spatialReference)&&((0,v.Up)(o.geometry.spatialReference,t.spatialReference)||(0,v.kR)()||await(0,v.zD)(),o.geometry=(0,v.iV)(o.geometry,t.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if("2d"===t.type){const o=[];t.map.allLayers.forEach((e=>{"vector-tile"!==e.type&&"imagery"!==e.type||o.push(e)}));const i=await t.hitTest(e,{exclude:o});return(0,I.qm)(i.results)}const o=[t.map.ground];t.map.allLayers.forEach((e=>{"integrated-mesh"===e.type&&o.push(e)}));const i=await t.hitTest(e,{exclude:o});if(i.results.length>0){const e=i.results[0];if((0,h.pC)(e)&&"graphic"===e.type&&e.graphic&&(!i.ground.mapPoint||t.map.ground.opacity<1||i.ground.distance-(0,h.Pt)(e.distance,0)>-Math.min(3*i.ground.distance,"global"===t.viewingMode?(0,g.Iu)(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return e}return null}_generateViewHandles(e){return[e.on("immediate-click",(async t=>{const o="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"===this.state||o||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const i=await t.async((()=>this._getFirstHit((0,U.vT)(t))));let a=null;if((0,h.pC)(i)){const o=i.graphic;this.updateGraphics.includes(o)||o.layer===this.layer?(t.stopPropagation(),a=o):"2d"!==e.type||this._isComponentGraphic(o)||"active"!==this.state||this.cancel()}else"active"===this.state&&this.cancel();(0,h.pC)(a)&&!this.updateGraphics.includes(a)&&await this.update([a],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()}),C.f.WIDGET)]}async _setupCreateOperation(e,t){const o=this.view;if(!o)return this._logMissingView(),null;const i={hasZ:"3d"===o.type,...this.defaultCreateOptions,...t},a=await this._setupDrawGraphicTool(e,o,i);return(0,h.Wi)(a)?null:(o.tools.add(a),o.activeTool=a,this._setupCreateOperationHandle(a))}async _setupDrawGraphicTool(e,t,o){if("multipoint"===e&&"3d"===t.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const i="rectangle"!==e,a="rectangle"!==e,r={view:t,mode:"rectangle"===e||"circle"===e?"hybrid":"click",...o,snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:a,centered:i};return"2d"===t.type?this._makeDrawGraphicTool2D(r):this._makeDrawGraphicTool3D(r)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(Promise.all([o.e(9058),o.e(5652),o.e(4046),o.e(696),o.e(1515),o.e(2113),o.e(1842),o.e(700)]).then(o.bind(o,10461)));return $(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:B(e.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(Promise.all([o.e(1378),o.e(2029),o.e(9058),o.e(5652),o.e(5158),o.e(4046),o.e(696),o.e(2880),o.e(5269),o.e(4184),o.e(1515),o.e(2113),o.e(9212),o.e(1842),o.e(5207)]).then(o.bind(o,65207)));if($(t)||this.destroyed)return null;const{elevationInfo:i}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:i,snapToScene:!(0,h.pC)(i)||"absolute-height"===i.mode,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let o=null;const i=e.forceUniformSize,a=e.centered,r=[t.on("key-down",(t=>{if(t.key===T.j.pan)t.stopPropagation(),t.repeat||(e.enabled=!1);else if(t.key===T.j.complete)t.stopPropagation(),e.completeCreateOperation();else if(t.key!==T.j.vertexAdd||t.repeat)t.key===T.j.undo?(t.stopPropagation(),s.undo()):t.key===T.j.redo?(t.stopPropagation(),s.redo()):t.key!==T.j.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType||t.repeat?t.key===T.j.center&&(t.repeat||(e.centered=!a,t.stopPropagation())):(e.forceUniformSize=!i,t.stopPropagation());else{const o=e.drawOperation.geometryType;"polyline"!==o&&"polygon"!==o&&"multipoint"!==o||(t.stopPropagation(),e.drawOperation.commitStagedVertex())}}),C.f.WIDGET),t.on("key-up",(t=>{t.key===T.j.pan?e.enabled=!0:t.key!==T.j.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType?t.key===T.j.center&&(e.centered=a,t.stopPropagation()):(e.forceUniformSize=i,t.stopPropagation())}),C.f.WIDGET),e.on("vertex-add",(t=>{switch(o=(0,h.Wi)(o)?"start":"active",t.operation){case"apply":this.emit("create",{graphic:(0,h.Wg)(e.graphic),state:o,tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[(0,h.Wg)(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[(0,h.Wg)(e.graphic)],tool:e.geometryType})}})),e.on("cursor-update",(t=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:(0,h.Wg)(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:t.vertices[0].coordinates,type:"cursor-update"},type:"create"})})),e.on("vertex-remove",(t=>{switch(t.operation){case"apply":this.emit("create",{graphic:(0,h.Wg)(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[(0,h.Wg)(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[(0,h.Wg)(e.graphic)],tool:e.geometryType})}})),e.on("complete",(e=>{this._set("createGraphic",(0,h.Wg)(e.graphic)),o="complete",e.aborted?s&&s.cancel():s&&s.complete()})),(0,d.YP)((()=>this._getGraphicSymbolFromTool(e.geometryType)),(t=>{e.graphicSymbol=t}))],s=new H({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{r.forEach((e=>e.remove())),r.length=0,t.tools?.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return s}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol}}async _setupUpdateOperation(e,t){const{layer:o,view:i}=this;if(!i)return this._logMissingView(),null;const a={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t?.reshapeOptions}};let r=a.tool;for(const s of e)o.remove(s),o.add(s);if("3d"===i.type){if(0===e.length)return null;switch(r){case"move":return this._setupMove3DOperation(e,a,i,r);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const t=(0,G.P)(e[0]);return t===f.e.SUPPORTED?this._setupReshape3DOperation(e[0],a,i):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${(0,f.Z)(t)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,a,i)}}switch(r){case"move":return this._setupMove2DOperation(e,a,i);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const t=(0,G.P)(e[0]);return t===f.e.SUPPORTED?this._setupTransformOrReshape2DOperation(e,r,a,i):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${(0,f.Z)(t)}).`),null)}case"transform":if(1===e.length){const t=(0,h.U2)(e[0].geometry,"type");"point"!==t&&"multipoint"!==t||(r="reshape")}return this._setupTransformOrReshape2DOperation(e,r,a,i)}}async _setupMove3DOperation(e,t,i,a){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];for(const o of e){const e=(0,E.P)(o);if(e!==f.e.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${(0,f.Z)(e)}).`),null}const s=await this._requireModule(Promise.all([o.e(1378),o.e(2029),o.e(9058),o.e(5652),o.e(5158),o.e(4046),o.e(696),o.e(2880),o.e(5269),o.e(4184),o.e(1515),o.e(2113),o.e(9212),o.e(1842),o.e(5207)]).then(o.bind(o,65207)));if($(s))return s;const n=new s.module.GraphicMoveTool({view:i,enableZ:t.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});i.tools.add(n),n.graphics.addMany(e),r||this.updateGraphics.addMany(e);const p=[],l=new x({activeComponent:n,tool:a,type:"update",onEnd:()=>{p.forEach((e=>e.remove())),p.length=0,i.tools?.remove(n),n.destroyed||n.destroy()},undo:()=>{z(l,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a})},redo:()=>{K(l,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a})},addToSelection:e=>{this.updateGraphics.push(e),n.graphics.push(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);l.history.undo.forEach((e=>e.updates.splice(t,1))),l.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0!==this.updateGraphics.length?n.graphics.remove(e):l.complete()},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;if("transform"!==a)return;const e=this.updateGraphics.getItemAt(0);if((0,G.P)(e)!==f.e.SUPPORTED)return;const o=await this._setupReshape3DOperation(e,t,i,!0);$(o)||(l.onEnd(),l.destroy(),this._setUpdateOperationHandle(o,t))}});return p.push(...this._getHandlesForComponent(l,t),i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(l,e,t)),C.f.WIDGET),i.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(l,e)}),C.f.WIDGET)),l}_setupGraphicTransform3DOperation(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(1===e.length&&function(e){if("graphics"!==e.layer?.type)return f.e.GRAPHICS_LAYER_MISSING;if((0,h.Wi)(e.geometry))return f.e.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return f.e.SUPPORTED;default:return f.e.GEOMETRY_TYPE_UNSUPPORTED}const t=(0,h.pC)(e.symbol)&&"point-3d"===e.symbol.type&&e.symbol.symbolLayers;return t&&t.length>0&&t.some((e=>"object"===e.type))?"on-the-ground"!==(0,O.vu)(e)&&(0,O.Lt)(e)?f.e.ELEVATION_MODE_UNSUPPORTED:f.e.SUPPORTED:f.e.SYMBOL_TYPE_UNSUPPORTED}(e[0])===f.e.SUPPORTED){const a=e[0],r=a.geometry;if((0,h.pC)(r)&&("point"===r.type||"mesh"===r.type))return this._setupPointTransform3DOperation(a,t,o);if((0,h.pC)(r)&&("polygon"===r.type||"polyline"===r.type))return this._setupPolyTransform3DOperation(a,t,o,i)}return this._setupMove3DOperation(e,t,o,"transform",i)}async _setupPointTransform3DOperation(e,t,i){const a="transform",{enableRotation:r,enableScaling:s,enableZ:n}=t,p=await this._requireModule(Promise.all([o.e(1378),o.e(2029),o.e(9058),o.e(5652),o.e(5158),o.e(4046),o.e(696),o.e(2880),o.e(5269),o.e(4184),o.e(1515),o.e(2113),o.e(9212),o.e(1842),o.e(5207)]).then(o.bind(o,65207)));if($(p))return p;const l=new p.module.GraphicTransformTool({graphic:e,view:i,enableRotation:r,enableScaling:s,enableZ:n,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});i.tools.add(l),this.updateGraphics.add(e);const h=[],c=new x({activeComponent:l,tool:a,type:"update",onEnd:()=>{h.forEach((e=>e.remove())),h.length=0,i.tools?.remove(l),l.destroyed||l.destroy()},undo:()=>{z(c,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a})},redo:()=>{K(c,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"});const o=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);$(o)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(o,t))},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),c.complete()},toggleTool:()=>{}});return h.push(...this._getHandlesForComponent(c,t),i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(c,e,t)),C.f.WIDGET),i.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(c,e)}),C.f.WIDGET)),c}async _setupPolyTransform3DOperation(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r="transform",{enableRotation:s,enableScaling:n,enableZ:p,preserveAspectRatio:l}=t,h=await this._requireModule(Promise.all([o.e(1378),o.e(2029),o.e(9058),o.e(5652),o.e(5158),o.e(4046),o.e(696),o.e(2880),o.e(5269),o.e(4184),o.e(1515),o.e(2113),o.e(9212),o.e(1842),o.e(5207)]).then(o.bind(o,65207)));if($(h))return h;const c=new h.module.ExtentTransformTool({graphic:e,view:i,enableRotation:s,enableScaling:n,enableZ:p,preserveAspectRatio:l,tooltipOptions:this.tooltipOptions});i.tools.add(c),a||this.updateGraphics.add(e);const d=[],u=new x({activeComponent:c,tool:r,type:"update",onEnd:()=>{d.forEach((e=>e.remove())),d.length=0,i.tools?.remove(c),c.destroyed||c.destroy()},canUndo:()=>c.canUndo,undo:()=>{c.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},canRedo:()=>c.canRedo,redo:()=>{c.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"});const o=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);$(o)||(u.onEnd(),u.destroy(),this._setUpdateOperationHandle(o,t))},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),u.complete()},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;const e=this.updateGraphics.getItemAt(0);if((0,G.P)(e)!==f.e.SUPPORTED)return;const o=await this._setupReshape3DOperation(e,t,i,!0);$(o)||(u.onEnd(),u.destroy(),this._setUpdateOperationHandle(o,t))}});return d.push(...this._getHandlesForComponent(u,t),i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(u,e,t)),C.f.WIDGET),i.on("key-down",(e=>this._getCommonUpdateOperationKeyDownHandlers(u,e)),C.f.WIDGET),i.on("key-down",(e=>{e.key!==T.j.constraint||e.repeat||(c.preserveAspectRatio=!c.preserveAspectRatio,e.stopPropagation())}),C.f.WIDGET),i.on("key-up",(e=>{e.key===T.j.constraint&&(c.preserveAspectRatio=!c.preserveAspectRatio,e.stopPropagation())}),C.f.WIDGET)),u}async _setupMove2DOperation(e,t,o){const i="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const a=await this._getGraphicMover(e,t,o);if($(a))return a;const r=new x({activeComponent:a,tool:i,type:"update",onEnd:()=>{this._displayDefaultCursor(),p.forEach((e=>e.remove())),n.forEach((e=>e.remove())),p=[],n=[],a.destroy(),this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const e=this.updateGraphics.toArray();z(r,e),r.refreshComponent(),this._emitUndoEvent({graphics:e,tool:i})},redo:()=>{const e=this.updateGraphics.toArray();K(r,e),r.refreshComponent(),this._emitRedoEvent({graphics:e,tool:i})},addToSelection:async e=>{await this._updateSpatialReference(e),this.updateGraphics.push(e),a.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);r.history.undo.forEach((e=>e.updates.splice(t,1))),r.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const o=this.updateGraphics.toArray();this.emit("update",{graphics:o,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0!==this.updateGraphics.length?a.graphics=o:r.complete()}});let s=!1,n=[o.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(r,e,t)),C.f.WIDGET),o.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(r,e),e.key!==T.j.constraint||e.repeat||(s=!0,a.enableMoveAllGraphics=!a.enableMoveAllGraphics)}),C.f.WIDGET),o.on("key-up",(e=>{e.key===T.j.constraint&&s&&(s=!1,a.enableMoveAllGraphics=!a.enableMoveAllGraphics)}),C.f.WIDGET)],p=this._getHandlesForComponent(r,t);return r}async _setupReshape3DOperation(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r="reshape",s=await this._requireModule(Promise.all([o.e(1378),o.e(2029),o.e(9058),o.e(5652),o.e(5158),o.e(4046),o.e(696),o.e(2880),o.e(5269),o.e(4184),o.e(1515),o.e(2113),o.e(9212),o.e(1842),o.e(5207)]).then(o.bind(o,65207)));if($(s))return s;const n=t.reshapeOptions,p=new s.module.GraphicReshapeTool({view:i,graphic:e,enableZVertex:t.enableZ&&"move"===n?.vertexOperation,enableZShape:t.enableZ&&"move"===n?.shapeOperation,enableMoveGraphic:"move"===n?.shapeOperation||"move-xy"===n?.shapeOperation,enableMidpoints:"split"===n?.edgeOperation,enableEdgeOffset:"offset"===n?.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});i.tools.add(p),a||this.updateGraphics.add(e);const l=[],h=new x({activeComponent:p,tool:r,type:"update",onEnd:()=>{l.forEach((e=>e.remove())),l.length=0,i.tools?.remove(p),p.destroyed||p.destroy()},canUndo:()=>p.canUndo,undo:()=>{p.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},canRedo:()=>p.canRedo,redo:()=>{p.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"});const o=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,i,"transform",!0);$(o)||(h.onEnd(),h.destroy(),this._setUpdateOperationHandle(o,t))},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),h.complete()},toggleTool:async()=>{if(!1===t.toggleToolOnClick)return;const e=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,i,!0);$(e)||(h.onEnd(),h.destroy(),this._setUpdateOperationHandle(e,t))}});return l.push(...this._getHandlesForComponent(h,t),i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(h,e,t)),C.f.WIDGET),i.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(h,e)}),C.f.WIDGET)),h}async _setupTransformOrReshape2DOperation(e,t,o,i){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const a="transform"===t?await this._getBox(e,o,i):await this._getReshape(e,o,i);if($(a))return a;const r=new x({activeComponent:a,type:"update",onEnd:()=>{n.forEach((e=>e.remove())),s.forEach((e=>e.remove())),n=[],s=[],r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{z(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{K(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async e=>{let t=r.activeComponent;if("reshape"===t?.type){const t=[...this.updateGraphics,e];this.updateGraphics.removeAll();const a=await this._setupMove2DOperation(t,o,i);if($(a))return;r.onEnd(),r.destroy(),this._setUpdateOperationHandle(a,o)}else this.updateGraphics.add(e),t.graphics=this.updateGraphics.toArray(),t.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async e=>{const t=this.updateGraphics.indexOf(e);r.history.undo.forEach((e=>e.updates.splice(t,1))),r.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const o=this.updateGraphics.toArray();if(0===o.length)r.complete();else{const e=o[0].geometry;1!==o.length||!(0,h.pC)(e)||"point"!==e.type&&"multipoint"!==e.type?r.activeComponent.graphics=o:r.toggleTool()}this.emit("update",{graphics:o,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const e=this.updateGraphics.getItemAt(0),t=e.geometry;if((0,h.pC)(t)&&("reshape"===r.tool&&("point"===t.type||"multipoint"===t.type)||"transform"===r.tool&&"extent"===t.type))return;let a=null;"transform"===r.tool?a=await this._getReshape([e],o,i):"reshape"===r.tool&&(a=await this._getBox([e],o,i)),$(a)||(r.activeComponent?.destroy(),r.activeComponent=a,r.activeComponent&&(n.forEach((e=>e.remove())),n=this._getHandlesForComponent(r,o)))}});let s=[i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(r,e,o)),C.f.WIDGET),i.on("key-down",(e=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,e),e.key===T.j.constraint&&!e.repeat&&r){const e=r.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),C.f.WIDGET),i.on("key-up",(e=>{if(e.key===T.j.constraint&&r){const e=r.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),C.f.WIDGET)],n=this._getHandlesForComponent(r,o);return r}async _getGraphicMover(e,t,i){const{enableMoveAllGraphics:a}=t,r=await this._requireModule(o.e(3503).then(o.bind(o,53503)));return $(r)?r:new r.module.default({enableMoveAllGraphics:a,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:e,view:i,callbacks:{onGraphicMoveStart:e=>{let{dx:t,dy:o,graphic:i}=e;this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:o,mover:i,type:"move-start"},type:"update"})},onGraphicMove:e=>{let{dx:t,dy:o,graphic:i}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:o,mover:i,type:"move"},type:"update"})},onGraphicMoveStop:e=>{let{dx:t,dy:o,graphic:i}=e;this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:o,mover:i,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,i){const{enableRotation:a,enableScaling:r,preserveAspectRatio:s}=t,n=await this._requireModule(Promise.all([o.e(9058),o.e(1515),o.e(6387)]).then(o.bind(o,96306)));return $(n)?n:new n.module.default({graphics:e,enableRotation:a,enableScaling:r,preserveAspectRatio:s,layer:this._internalGraphicsLayer,view:i,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMove:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMoveStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScale:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotate:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"})}})}async _getReshape(e,t,i){const a="split"===t.reshapeOptions?.edgeOperation,r="move"===t.reshapeOptions?.shapeOperation,s=await this._requireModule(Promise.all([o.e(9058),o.e(5652),o.e(4046),o.e(1515),o.e(3362)]).then(o.bind(o,83362)));return $(s)?s:new s.module.default({enableMidpoints:a,enableMovement:r,graphic:e[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:i,callbacks:{onReshapeStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshape:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshapeStop:e=>{let{mover:t,type:o}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:t,type:o},type:"update"})},onMoveStart:e=>{let{dx:t,dy:o,mover:i,type:a}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:o,mover:i,type:a},type:"update"})},onMove:e=>{let{dx:t,dy:o,mover:i,type:a}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:o,mover:i,type:a},type:"update"})},onMoveStop:e=>{let{dx:t,dy:o,mover:i,type:a}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:o,mover:i,type:a},type:"update"})},onVertexAdd:e=>{let{added:t,type:o,vertices:i}=e;const a=t.map((e=>(0,m.nA)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:a,vertices:i,type:o},type:"update"})},onVertexRemove:e=>{let{removed:t,type:o,vertices:i}=e;const a=t.map((e=>(0,m.nA)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:a,vertices:i,type:o},type:"update"})}}})}_getHandlesForComponent(e,t){const o=e.activeComponent;if(!o)return[];switch(o.type){case"graphic-mover":return[o.on("graphic-click",(t=>{let{graphic:o,viewEvent:i}=t;i.native?.shiftKey&&(i.stopPropagation(),e.removeFromSelection(o))})),o.on("graphic-move-start",(t=>e.addToHistory(J(t.allGraphics))))];case"box":return[o.on("graphic-click",(o=>this._onTransformOrReshape2DGraphicClick(e,t,o))),o.on("move-start",(t=>e.addToHistory(J(t.graphics)))),o.on("rotate-start",(t=>e.addToHistory(J(t.graphics)))),o.on("scale-start",(t=>e.addToHistory(J(t.graphics))))];case"reshape":return[o.on("graphic-click",(o=>this._onTransformOrReshape2DGraphicClick(e,t,o))),o.on("move-start",(t=>e.addToHistory(J([t.mover])))),o.on("reshape-start",(t=>e.addToHistory(J([t.graphic])))),o.on("vertex-add",(t=>e.addToHistory(J([t.oldGraphic])))),o.on("vertex-remove",(t=>e.addToHistory(J([t.oldGraphic]))))];case"move-3d":return[o.on("graphic-move-start",(t=>{e.addToHistory(J(t.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:t.allGraphics.length>0?t.allGraphics[0]:null,type:"move-start"},type:"update"})})),o.on("graphic-move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e.dx,dy:e.dy,mover:e.allGraphics.length>0?e.allGraphics[0]:null,type:"move"},type:"update"})})),o.on("graphic-move-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:e.allGraphics.length>0?e.allGraphics[0]:null,type:"move-stop"},type:"update"})})),o.on("immediate-click",(o=>{o.shiftKey?this._toggleSelection([o.graphic],e,t):e.toggleTool()}))];case"transform-3d":return[o.on("record-undo",(t=>{let{record:o}=t;e.addToHistory({updates:[o]})})),o.on("graphic-translate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-start"},type:"update"})})),o.on("graphic-translate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-stop"},type:"update"})})),o.on("graphic-rotate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate-start"},type:"update"})})),o.on("graphic-rotate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate-stop"},type:"update"})})),o.on("graphic-scale-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-start"},type:"update"})})),o.on("graphic-scale-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-stop"},type:"update"})})),o.on("graphic-translate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move"},type:"update"})})),o.on("graphic-rotate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate"},type:"update"})})),o.on("graphic-scale",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale"},type:"update"})})),o.on("immediate-click",(o=>{o.shiftKey?this._toggleSelection([o.graphic],e,t):e.toggleTool()}))];case"reshape-3d":return[o.on("reshape",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),o.on("move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),o.on("vertex-add",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),o.on("vertex-remove",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),o.on("immediate-click",(o=>{o.shiftKey?this._toggleSelection([o.graphic],e,t):e.toggleTool()}))]}}_onTransformOrReshape2DGraphicClick(e,t,o){const{graphic:i,viewEvent:a}=o;return a.native?.shiftKey&&i.layer===this.layer?(a.stopPropagation(),e.removeFromSelection(i)):t.toggleToolOnClick?(a.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const o=this.view?.map;this._disablePopup(t);e.on("complete",(()=>{if(e===this._operationHandle){const i=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),o&&o.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:i,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}}))}async _getCommonUpdateOperationClickHandlers(e,t,o){const i=(0,U.vT)(t),a=await t.async((()=>this._getFirstHit(i)));(0,h.Wi)(a)?e.complete():t.native.shiftKey&&this._toggleSelection([a.graphic],e,o)||this.updateGraphics.includes(a.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,o){const i=!!o.multipleSelectionEnabled;return e.some((e=>null!=e&&!(!i||e.layer!==this.layer)&&(this.updateGraphics.includes(e)?t.removeFromSelection(e):t.addToSelection(e),!0)))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const o=t.key;o===T.j.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):o===T.j.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):o===T.j.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&T.j.delete.includes(o)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||"update"!==this._operationHandle.type)return;const t=this.activeComponent,o=this.updateGraphics.toArray();(0,h.Wi)(t)||"reshape-3d"===t.type||("reshape"!==t.type||1===o.length&&"point"===(0,h.U2)(o[0].geometry,"type"))&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=(0,h.SC)(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||(0,h.Wi)(t))&&(e.attributes&&e.attributes.esriSketchTool||"draw-2d"===t.type&&t.graphic===e||("box"===t.type||"reshape"===t.type)&&t.isUIGraphic(e))}_displayPointerCursor(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(e,t,o){l.Z.getLogger(this.declaredClass).error(new s.Z(e,t,o))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const o=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:o}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){return{operationHandle:this._operationHandle,defaultUpdateOptions:V}}wait(){return(0,d.N1)((()=>!this.updating))}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){return"3d"!==this.view?.type||this.updateOnGraphicClick||((0,h.Wg)(e)?.toggleToolOnClick??!1)}_disablePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view?.popup;t&&(0,h.Wi)(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=t.autoOpenEnabled,t.autoOpenEnabled=!1)}_restorePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view?.popup;t&&(0,h.pC)(this._originalAutoOpenEnabled)&&(t.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)}async _waitViewReady(){const e=this.view;e?((0,h.IM)(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await(0,c.Hl)((0,d.N1)((()=>e?.ready)),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",F("view"))}_logMissingLayer(){this._logError(j,F("layer"))}};(0,i._)([(0,u.Cb)()],Y.prototype,"updating",null),(0,i._)([(0,u.Cb)()],Y.prototype,"_operationHandle",void 0),(0,i._)([(0,u.Cb)({readOnly:!0})],Y.prototype,"activeTool",null),(0,i._)([(0,u.Cb)()],Y.prototype,"activeFillSymbol",void 0),(0,i._)([(0,u.Cb)()],Y.prototype,"activeLineSymbol",void 0),(0,i._)([(0,u.Cb)()],Y.prototype,"activeVertexSymbol",void 0),(0,i._)([(0,u.Cb)()],Y.prototype,"allowDeleteKey",void 0),(0,i._)([(0,u.Cb)({readOnly:!0})],Y.prototype,"createGraphic",null),(0,i._)([(0,u.Cb)()],Y.prototype,"defaultCreateOptions",null),(0,i._)([(0,u.Cb)()],Y.prototype,"defaultUpdateOptions",null),(0,i._)([(0,u.Cb)({type:S.Z,nonNullable:!0})],Y.prototype,"labelOptions",void 0),(0,i._)([(0,u.Cb)()],Y.prototype,"layer",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"pointSymbol",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"polygonSymbol",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"polylineSymbol",void 0),(0,i._)([(0,u.Cb)({type:R.Z,nonNullable:!0})],Y.prototype,"snappingOptions",null),(0,i._)([(0,u.Cb)()],Y.prototype,"_snappingManager",void 0),(0,i._)([(0,u.Cb)({readOnly:!0})],Y.prototype,"state",null),(0,i._)([(0,u.Cb)({type:A.Z,nonNullable:!0})],Y.prototype,"tooltipOptions",void 0),(0,i._)([(0,u.Cb)({readOnly:!0})],Y.prototype,"updateGraphics",void 0),(0,i._)([(0,u.Cb)()],Y.prototype,"updateOnGraphicClick",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"updatePointSymbol",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"updatePolygonSymbol",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"updatePolylineSymbol",void 0),(0,i._)([(0,u.Cb)({types:a.LB})],Y.prototype,"vertexSymbol",void 0),(0,i._)([(0,u.Cb)({value:null})],Y.prototype,"view",null),Y=(0,i._)([(0,y.j)("esri.widgets.Sketch.SketchViewModel")],Y);const j="sketch:missing-property",F=e=>`Property '${e}' is missing on SketchViewModel.`;function B(e){return"polygon"===e||"rectangle"===e||"circle"===e}function z(e,t){q("undo",e.history.undo,e.history.redo,t)}function K(e,t){q("redo",e.history.redo,e.history.undo,t)}function q(e,t,o,i){const a=t.pop();if(!a)return;const r=a.updates,s=[];i.forEach(((t,o)=>{const i=r[o];null!=i&&("geometry"in i&&(0,h.pC)(i.geometry)&&(s.push({geometry:t.geometry}),t.geometry=i.geometry),"symbol"in i&&(0,h.pC)(i.symbol)&&(s.push({symbol:t.symbol}),t.symbol=i.symbol),"undo"in i&&(s.push(i),i[e](t)))})),o.push({updates:s})}function J(e){return{updates:e.map((e=>({geometry:e.geometry})))}}function $(e){return"requireError"in e&&"aborted"===e.requireError}const X=Y}}]);
//# sourceMappingURL=3345.f39e9b72.chunk.js.map