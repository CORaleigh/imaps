"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[2116],{72116:(e,t,i)=>{i.r(t),i.d(t,{Measure:()=>S,default:()=>W});var s=i(85580),r=i(72791),a=i(9283);const n={title:"Measure Tips",tips:[{title:"Coordinate Search",text:"The coordinate search has been moved to the lower left corner of the map"}]};var l=i(27366),o=i(66978),c=i(94172),d=i(49861),u=(i(25243),i(63780),i(69912)),h=i(69407),v=i(85015),p=i(68860),w=i(77671);let g=class extends v.Z{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){this._overrideIfSome("areaUnit",e)}get linearUnit(){return this.defaultUnit}set linearUnit(e){this._overrideIfSome("linearUnit",e)}get state(){const{activeViewModel:e}=this;return e?e.state:"disabled"}};(0,l._)([(0,d.Cb)({type:["area","distance","direct-line"]})],g.prototype,"activeTool",void 0),(0,l._)([(0,d.Cb)()],g.prototype,"activeViewModel",void 0),(0,l._)([(0,d.Cb)({type:p.fN})],g.prototype,"areaUnit",null),(0,l._)([(0,d.Cb)(w.Y)],g.prototype,"defaultUnit",void 0),(0,l._)([(0,d.Cb)({type:p.oD})],g.prototype,"linearUnit",null),(0,l._)([(0,d.Cb)({readOnly:!0})],g.prototype,"state",null),(0,l._)([(0,d.Cb)()],g.prototype,"view",void 0),g=(0,l._)([(0,u.j)("esri.widgets.Measurement.MeasurementViewModel")],g);const m=g;i(80975);var _=i(80532),b=i(67005);const C="esri-measurement",f="esri-icon-measure";let y=class extends h.Z{constructor(e,t){super(e,t),this._widgets=new Map,this.activeWidget=null,this.iconClass=f,this.messages=null,this.viewModel=new m}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then((e=>{this._set("activeWidget",e)})),this.addHandles([(0,c.YP)((()=>[this.view,this.activeTool]),(async()=>{this._set("activeWidget",await this._getActiveWidget())})),(0,c.YP)((()=>this.activeWidget),((e,t)=>{this.viewModel.set("activeViewModel",e?e.viewModel:null),t&&(t.visible=!1)})),(0,c.YP)((()=>[this.areaUnit,this.linearUnit,this.uiStrings]),(()=>this._updateSubWidgetProperties()))])}destroy(){this._destroyWidgets()}get activeTool(){return this.viewModel.activeTool}set activeTool(e){this.viewModel.activeTool=e}get areaUnit(){return this.viewModel.areaUnit}set areaUnit(e){this.viewModel.areaUnit=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get linearUnit(){return this.viewModel.linearUnit}set linearUnit(e){this.viewModel.linearUnit=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{activeWidget:e}=this,t=e&&!e.destroyed?e.render():null;return(0,b.u)("div",{class:C},t)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){const{activeViewModel:e}=this.viewModel;e&&(0,o.R8)(e.start())}async _createWidget(e){const{areaUnit:t,linearUnit:s,view:r}=this;switch(e){case"area":{const{type:s}=r;switch(s){case"2d":return new(0,(await Promise.all([i.e(9058),i.e(5652),i.e(4046),i.e(696),i.e(2113),i.e(5792),i.e(1421)]).then(i.bind(i,41421))).default)({view:r,unit:t,uiStrings:this._createUIStringsForWidget(e)});case"3d":return new(0,(await Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(4046),i.e(696),i.e(2880),i.e(5269),i.e(4184),i.e(9212),i.e(6526),i.e(3826)]).then(i.bind(i,33826))).default)({view:r,unit:t,uiStrings:this._createUIStringsForWidget(e)});default:return null}}case"distance":{const{type:t}=r;return"2d"===t?new(0,(await Promise.all([i.e(9058),i.e(5652),i.e(4046),i.e(696),i.e(2113),i.e(5792),i.e(5107)]).then(i.bind(i,35107))).default)({view:r,unit:s,uiStrings:this._createUIStringsForWidget(e)}):null}case"direct-line":{const{type:t}=r;return"3d"===t?new(0,(await Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(4046),i.e(696),i.e(2880),i.e(5269),i.e(4184),i.e(9212),i.e(6526),i.e(7899)]).then(i.bind(i,47899))).default)({view:r,unit:s,uiStrings:this._createUIStringsForWidget(e)}):null}default:return null}}_destroyWidgets(){this._widgets.forEach((e=>e.destroy())),this._widgets.clear()}async _getActiveWidget(){const{activeTool:e,view:t}=this;if(!t||!e)return null;let i=null;if(this._widgets.has(e))i=this._widgets.get(e),i.visible=!0;else{if(i=await this._createWidget(e),!i)return null;await i.viewModel.start(),this._widgets.set(e,i)}return i}_createUIStringsForWidget(e){if(!this.uiStrings)return null;const t=e+"-"+this.view.type;return this.uiStrings[t]}_updateSubWidgetProperties(){this._widgets.forEach(((e,t)=>{const{areaUnit:i,linearUnit:s}=this;e.unit=function(e){return"esri.widgets.AreaMeasurement2D"===e?.declaredClass||"esri.widgets.AreaMeasurement3D"===e?.declaredClass}(e)?i:s,e.uiStrings=this._createUIStringsForWidget(t)}))}};(0,l._)([(0,d.Cb)()],y.prototype,"activeTool",null),(0,l._)([(0,d.Cb)({readOnly:!0})],y.prototype,"activeWidget",void 0),(0,l._)([(0,d.Cb)()],y.prototype,"areaUnit",null),(0,l._)([(0,d.Cb)()],y.prototype,"iconClass",void 0),(0,l._)([(0,d.Cb)()],y.prototype,"label",null),(0,l._)([(0,d.Cb)()],y.prototype,"linearUnit",null),(0,l._)([(0,d.Cb)(),(0,_.H)("esri/widgets/Measurement/t9n/Measurement")],y.prototype,"messages",void 0),(0,l._)([(0,d.Cb)()],y.prototype,"uiStrings",void 0),(0,l._)([(0,d.Cb)()],y.prototype,"view",null),(0,l._)([(0,d.Cb)({type:m})],y.prototype,"viewModel",void 0),y=(0,l._)([(0,u.j)("esri.widgets.Measurement")],y);const M=y,U=e=>{const t=(0,r.useRef)(),i=(0,r.useRef)(!1),[s,a]=(0,r.useState)(""),[l,o]=(0,r.useState)(!1),c=(0,r.useRef)();(0,r.useEffect)((()=>{if(!i.current){i.current=!0;const n=(s=t.current,r=e.view,new M({view:r,container:s,areaUnit:"imperial",linearUnit:"imperial"}));c.current=n,n.watch("activeTool",(e=>{e&&a(e||"")}))}var s,r;return()=>{}}),[]),(0,r.useEffect)((()=>{o(e.isActive),e.isActive||(c.current.activeTool=null),l&&c.current&&(c.current.activeTool=s)}),[e.isActive]);const d=(0,r.useCallback)((t=>{e.toolDismissed(),c.current.activeTool=null}),[]),u=(0,r.useCallback)((t=>{e.showTips(n)}),[]);return{measureRef:t,measurement:c,selectedTool:s,setSelectedTool:a,isActive:l,toolDismissed:d,tipsClicked:u}};var T=i(80184);const S=e=>{const{measureRef:t,measurement:i,selectedTool:r,setSelectedTool:n,isActive:l,toolDismissed:o,tipsClicked:c}=U(e);return(0,T.jsxs)(s.N$,{id:"measure-panel",heading:"Measure","data-panel":"measure",hidden:!l,closed:!l||void 0,closable:!0,onCalcitePanelClose:o,children:[(0,T.jsx)(s.G1,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:c}),(0,T.jsx)(s.G1,{id:"collapseTool",icon:"chevron-up",text:"",slot:"header-actions-end",onClick:a.F$}),(0,T.jsx)(s.$A,{label:"Show Tip",referenceElement:"tip",closeOnClick:!0,children:"Show Tip"}),(0,T.jsx)(s.$A,{label:"Collapse",referenceElement:"collapseTool",closeOnClick:!0,children:"Collapse"}),(0,T.jsxs)("div",{id:"measure-tools",children:[(0,T.jsxs)("div",{className:"measure-container",children:[(0,T.jsx)(s.$A,{closeOnClick:!0,label:"Distance",referenceElement:"measureDistance",children:"Distance"}),(0,T.jsx)(s.G1,{id:"measureDistance",icon:"measure-line",text:"Distance",active:"distance"===r||void 0,onClick:()=>{n("distance"),i.current&&(i.current.activeTool="distance")}}),(0,T.jsx)(s.$A,{closeOnClick:!0,label:"Area",referenceElement:"measureArea",children:"Area"}),(0,T.jsx)(s.G1,{id:"measureArea",icon:"measure-area",text:"Area",active:"area"===r||void 0,onClick:()=>{n("area"),i.current&&(i.current.activeTool="area")}}),(0,T.jsx)(s.$A,{closeOnClick:!0,label:"Clear",referenceElement:"clearMeasure",children:"Clear"}),(0,T.jsx)(s.G1,{id:"clearMeasure",icon:"trash",text:"Clear",onClick:()=>{var e;i.current&&(null===(e=i.current)||void 0===e||e.clear(),n(""))}})]}),(0,T.jsx)("div",{ref:t}),(0,T.jsx)("section",{hidden:""!==r||void 0,className:"measurement-hint",children:(0,T.jsx)("p",{children:"Select line or distance measurement tool"})})]})]})},W=r.memo(S)},77671:(e,t,i)=>{i.d(t,{Y:()=>r});var s=i(74177);const r={readOnly:!0,get(){return(0,s.R)(this.view)}}},74177:(e,t,i)=>{i.d(t,{R:()=>n});var s=i(92026),r=i(68860),a=i(70032);function n(e){const t="metric";if((0,s.Wi)(e))return t;const i=e.map,n=(i&&"portalItem"in i?i.portalItem?.portal:null)??a.Z.getDefault();switch(n.user?.units??n.units){case t:return t;case"english":return"imperial"}return(0,s.Pt)((0,r.yT)(e.spatialReference),t)}}}]);
//# sourceMappingURL=2116.62100915.chunk.js.map