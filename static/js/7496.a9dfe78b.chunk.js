"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[7496,8860,908,8099],{52639:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(27366),s=i(59486),r=i(44055),o=i(51508),a=i(11582),l=i(46784),c=i(92026),p=i(95439),h=i(49861),d=(i(63780),i(93169),i(25243),i(69912)),u=i(77981);function g(e){if(!(0,c.pC)(e))return null;const t={};for(const i in e){const n=e[i];n&&(t[i]=n.toJSON())}return 0!==Object.keys(t).length?t:null}let y=class extends((0,a.J)(l.wq)){constructor(){super(...arguments),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:(0,p.D)(),configurable:!0})}normalizeCtorArgs(e,t,i,n){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:i,popupTemplate:n}}set aggregateGeometries(e){const t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}getEffectivePopupTemplate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.popupTemplate)return this.popupTemplate;for(const t of[this.sourceLayer,this.layer])if(t){if("popupTemplate"in t&&t.popupTemplate)return t.popupTemplate;if(e&&"defaultPopupTemplate"in t&&(0,c.pC)(t.defaultPopupTemplate))return t.defaultPopupTemplate}return null}getAttribute(e){return this.attributes&&this.attributes[e]}setAttribute(e,t){if(this.attributes){const i=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",i,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{aggregateGeometries:g(this.aggregateGeometries),geometry:(0,c.pC)(this.geometry)?this.geometry.toJSON():null,symbol:(0,c.pC)(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(){(0,c.pC)(this.geometry)&&"mesh"===this.geometry.type&&this._notifyLayer("transform",this.geometry.transform,this.geometry.transform)}_notifyLayer(e,t,i,n){if(!this.layer||!("graphicChanged"in this.layer))return;const s={graphic:this,property:e,oldValue:t,newValue:i};"attributes"===e&&(s.attributeName=n),this.layer.graphicChanged(s)}};(0,n._)([(0,h.Cb)({value:null,json:{read:function(e){if(!e)return null;const t={};for(const i in e){const n=(0,u.im)(e[i]);n&&(t[i]=n)}return 0!==Object.keys(t).length?t:null}}})],y.prototype,"aggregateGeometries",null),(0,n._)([(0,h.Cb)({value:null})],y.prototype,"attributes",null),(0,n._)([(0,h.Cb)({value:null,types:s.qM,json:{read:u.im}})],y.prototype,"geometry",null),(0,n._)([(0,h.Cb)({type:Boolean})],y.prototype,"isAggregate",void 0),(0,n._)([(0,h.Cb)({clonable:"reference"})],y.prototype,"layer",void 0),(0,n._)([(0,h.Cb)({type:r.Z})],y.prototype,"popupTemplate",void 0),(0,n._)([(0,h.Cb)({clonable:"reference"})],y.prototype,"sourceLayer",void 0),(0,n._)([(0,h.Cb)({value:null,types:o.LB})],y.prototype,"symbol",null),(0,n._)([(0,h.Cb)({type:Boolean,value:!0})],y.prototype,"visible",null),y=(0,n._)([(0,d.j)("esri.Graphic")],y),function(e){e.generateUID=p.D}(y||(y={}));const m=y},53283:(e,t,i)=>{i.d(t,{M:()=>g,e:()=>d,f:()=>r,i:()=>h,p:()=>y,r:()=>a,t:()=>o,w:()=>l});var n=i(92026),s=i(35995);function r(e,t){const i=t&&t.url&&t.url.path;if(e&&i&&(e=(0,s.hF)(e,i,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const i=(0,s.PF)(e,t.portalItem.itemUrl);p.test(i)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(i).path)}return u(e,t&&t.portal)}function o(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.YES;if(!e)return e;!(0,s.YP)(e)&&t&&t.blockedRelativeUrls&&t.blockedRelativeUrls.push(e);let n=(0,s.hF)(e);if(t){const i=t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.rootPath||t.url&&t.url.path;if(i){const r=u(i,t.portal);n=(0,s.PF)(u(n,t.portal),r,r),n!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(n)}}return n=d(n,t&&t.portal),(0,s.YP)(n)&&(n=(0,s.Fv)(n)),t?.resources&&t?.portalItem&&!(0,s.YP)(n)&&!(0,s.HK)(n)&&i===g.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(n)}),n}function a(e,t,i){return r(e,i)}function l(e,t,i,n){const s=o(e,n);void 0!==s&&(t[i]=s)}const c=/\/items\/([^\/]+)\/resources\//,p=/^\.\/resources\//;function h(e){const t=(0,n.pC)(e)?e.match(c):null;return(0,n.pC)(t)?t[1]:null}function d(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?(0,s.Ie)(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}function u(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const i=`${t.urlKey}.${t.customBaseUrl}`,n=(0,s.TI)();return(0,s.D6)(n,`${n.scheme}://${i}`)?(0,s.Ie)(e,t.portalHostname,i):(0,s.Ie)(e,i,t.portalHostname)}var g;!function(e){e[e.YES=0]="YES",e[e.NO=1]="NO"}(g||(g={}));const y=Object.freeze(Object.defineProperty({__proto__:null,fromJSON:r,toJSON:o,read:a,write:l,itemIdFromResourceUrl:h,ensureMainOnlineDomain:d,get MarkKeep(){return g}},Symbol.toStringTag,{value:"Module"}))},79056:(e,t,i)=>{i.d(t,{IG:()=>o});var n=i(27366),s=i(69912);let r=0;const o=e=>{let t=class extends e{constructor(){super(...arguments),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+r++})}};return t=(0,n._)([(0,s.j)("esri.core.Identifiable")],t),t};let a=class extends(o(class{})){};a=(0,n._)([(0,s.j)("esri.core.Identifiable")],a)},8025:(e,t,i)=>{i.d(t,{B:()=>s});var n=i(49861);function s(e,t){const i=t?{...t,source:e}:e;return(0,n.Cb)({aliasOf:i})}},29616:(e,t,i)=>{i.d(t,{Qc:()=>p,WU:()=>a,lt:()=>c,ti:()=>o});var n=i(643),s=i(36257);const r={ar:[".",","],bg:[",","\xa0"],bs:[",","."],ca:[",","."],cs:[",","\xa0"],da:[",","."],de:[",","."],"de-ch":[".","\u2019"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",","\xa0"],fi:[",","\xa0"],fr:[",","\u202f"],"fr-ch":[",","\u202f"],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",","\xa0"],id:[",","."],it:[",","."],"it-ch":[".","\u2019"],ja:[".",","],ko:[".",","],lt:[",","\xa0"],lv:[",","\xa0"],mk:[",","."],nb:[",","\xa0"],nl:[",","."],pl:[",","\xa0"],pt:[",","."],"pt-pt":[",","\xa0"],ro:[",","."],ru:[",","\xa0"],sk:[",","\xa0"],sl:[",","."],sr:[",","."],sv:[",","\xa0"],th:[".",","],tr:[",","."],uk:[",","\xa0"],vi:[",","."],zh:[".",","]};function o(e){e||(e=(0,s.Kd)());let t=e in r;if(!t){const i=e.split("-");i.length>1&&i[0]in r&&(e=i[0],t=!0),t||(e="en")}const[i,n,o="#,##0.###"]=r[e];return{decimal:i,group:n,pattern:o}}function a(e,t){const i=o((t={...t}).locale);t.customs=i;const n=t.pattern||i.pattern;return isNaN(e)||Math.abs(e)===1/0?null:function(e,t,i){const n=(i=i||{}).customs.group,s=i.customs.decimal,r=t.split(";"),o=r[0];if((t=r[e<0?1:0]||"-"+o).includes("%"))e*=100;else if(t.includes("\u2030"))e*=1e3;else{if(t.includes("\xa4"))throw new Error("currency notation not supported");if(t.includes("E"))throw new Error("exponential notation not supported")}const a=l,c=o.match(a);if(!c)throw new Error("unable to find a number expression in pattern: "+t);return!1===i.fractional&&(i.places=0),t.replace(a,function(e,t,i){!0===(i=i||{}).places&&(i.places=0),i.places===1/0&&(i.places=6);const n=t.split("."),s="string"==typeof i.places&&i.places.indexOf(",");let r=i.places;s?r=i.places.substring(s+1):r>=0||(r=(n[1]||[]).length),i.round<0||(e=Number(e.toFixed(Number(r))));const o=String(Math.abs(e)).split("."),a=o[1]||"";if(n[1]||i.places){s&&(i.places=i.places.substring(0,s));const e=void 0!==i.places?i.places:n[1]&&n[1].lastIndexOf("0")+1;e>a.length&&(o[1]=a.padEnd(Number(e),"0")),r<a.length&&(o[1]=a.substr(0,Number(r)))}else o[1]&&o.pop();const l=n[0].replace(",","");let c=l.indexOf("0");-1!==c&&(c=l.length-c,c>o[0].length&&(o[0]=o[0].padStart(c,"0")),l.includes("#")||(o[0]=o[0].substr(o[0].length-c)));let p,h,d=n[0].lastIndexOf(",");if(-1!==d){p=n[0].length-d-1;const e=n[0].substr(0,d);d=e.lastIndexOf(","),-1!==d&&(h=e.length-d-1)}const u=[];for(let g=o[0];g;){const e=g.length-p;u.push(e>0?g.substr(e):g),g=e>0?g.slice(0,e):"",h&&(p=h,h=void 0)}return o[0]=u.reverse().join(i.group||","),o.join(i.decimal||".")}(e,c[0],{decimal:s,group:n,places:i.places,round:i.round}))}(e,n,t)}const l=/[#0,]*[#0](?:\.0*#*)?/;function c(e){const t=o((e=e||{}).locale),i=e.pattern||t.pattern,s=t.group,r=t.decimal;let a=1;if(i.includes("%"))a/=100;else if(i.includes("\u2030"))a/=1e3;else if(i.includes("\xa4"))throw new Error("currency notation not supported");const c=i.split(";");1===c.length&&c.push("-"+c[0]);const p=d(c,(t=>(t="(?:"+(0,n.Qs)(t,".")+")").replace(l,(t=>{const i={signed:!1,separator:e.strict?s:[s,""],fractional:e.fractional,decimal:r,exponent:!1},n=t.split(".");let o=e.places;1===n.length&&1!==a&&(n[1]="###"),1===n.length||0===o?i.fractional=!1:(void 0===o&&(o=e.pattern?n[1].lastIndexOf("0")+1:1/0),o&&null==e.fractional&&(i.fractional=!0),!e.places&&o<n[1].length&&(o+=","+n[1].length),i.places=o);const l=n[0].split(",");return l.length>1&&(i.groupSize=l.pop().length,l.length>1&&(i.groupSize2=l.pop().length)),"("+function(e){"places"in(e=e||{})||(e.places=1/0),"string"!=typeof e.decimal&&(e.decimal="."),"fractional"in e&&!/^0/.test(String(e.places))||(e.fractional=[!0,!1]),"exponent"in e||(e.exponent=[!0,!1]),"eSigned"in e||(e.eSigned=[!0,!1]);const t=h(e),i=d(e.fractional,(t=>{let i="";return t&&0!==e.places&&(i="\\"+e.decimal,e.places===1/0?i="(?:"+i+"\\d+)?":i+="\\d{"+e.places+"}"),i}),!0);let n=t+i;return i&&(n="(?:(?:"+n+")|(?:"+i+"))"),n+d(e.exponent,(t=>t?"([eE]"+h({signed:e.eSigned})+")":""))}(i)+")"}))),!0);return{regexp:p.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:s,decimal:r,factor:a}}function p(e,t){const i=c(t),n=new RegExp("^"+i.regexp+"$").exec(e);if(!n)return NaN;let s=n[1];if(!n[1]){if(!n[2])return NaN;s=n[2],i.factor*=-1}return s=s.replace(new RegExp("["+i.group+"\\s\\xa0]","g"),"").replace(i.decimal,"."),Number(s)*i.factor}function h(e){return"signed"in(e=e||{})||(e.signed=[!0,!1]),"separator"in e?"groupSize"in e||(e.groupSize=3):e.separator="",d(e.signed,(e=>e?"[-+]":""),!0)+d(e.separator,(t=>{if(!t)return"(?:\\d+)";" "===(t=(0,n.Qs)(t))?t="\\s":"\xa0"===t&&(t="\\s\\xa0");const i=e.groupSize,s=e.groupSize2;if(s){const e="(?:0|[1-9]\\d{0,"+(s-1)+"}(?:["+t+"]\\d{"+s+"})*["+t+"]\\d{"+i+"})";return i-s>0?"(?:"+e+"|(?:0|[1-9]\\d{0,"+(i-1)+"}))":e}return"(?:0|[1-9]\\d{0,"+(i-1)+"}(?:["+t+"]\\d{"+i+"})*)"}),!0)}const d=(e,t,i)=>{if(!(e instanceof Array))return t(e);const n=[];for(let s=0;s<e.length;s++)n.push(t(e[s]));return u(n.join("|"),i)},u=(e,t)=>"("+(t?"?:":"")+e+")"},68748:(e,t,i)=>{i.d(t,{a:()=>h,z:()=>d});var n=i(27366),s=i(40281),r=i(60354),o=i(41691),a=(i(93169),i(32718)),l=i(92026),c=i(49861),p=(i(63780),i(25243),i(69912));a.Z.getLogger("esri.core.support.OwningCollection");let h=class extends((0,o.p)(s.Z)){constructor(e){super(e),this.handles.add([this.on("before-add",(e=>{(0,l.Wi)(e.item)&&e.preventDefault()})),this.on("after-add",(e=>this._own(e.item))),this.on("after-remove",(e=>this._release(e.item)))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(s.Z.ofType(this.itemType.Type))(e):new s.Z(e)}};function d(e,t){return{type:e,cast:r.R,set(i){const n=(0,r.Z)(i,this._get(t),e);n.owner=this,this._set(t,n)}}}(0,n._)([(0,c.Cb)()],h.prototype,"owner",null),h=(0,n._)([(0,p.j)("esri.core.support.OwningCollection")],h)},68860:(e,t,i)=>{i.d(t,{$C:()=>V,En:()=>O,FN:()=>G,Jo:()=>$,KU:()=>P,OG:()=>I,RG:()=>Y,UF:()=>x,Yl:()=>A,ZO:()=>T,_R:()=>H,c9:()=>U,cM:()=>k,fN:()=>w,gV:()=>K,hd:()=>p,j5:()=>j,oD:()=>E,oq:()=>q,qE:()=>Z,qv:()=>R,tQ:()=>M,ty:()=>N,y:()=>z});i(93169);var n=i(43404),s=i(92026),r=i(92183),o=i(78952),a=i(22186),l=i(92975),c=i(89093);const p=39.37,h=a.sv.radius*Math.PI/200,d=/UNIT\[([^\]]+)\]\]$/i,u=c.Z,g=/UNIT\[([^\]]+)\]/i,y=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),m=(0,n.w)()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),f=e=>e*e,v=e=>e*e*e,_={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:f(.001)},"square-centimeters":{inBaseUnits:f(.01)},"square-decimeters":{inBaseUnits:f(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:f(1e3)},"square-inches":{inBaseUnits:f(.0254)},"square-feet":{inBaseUnits:f(.3048)},"square-yards":{inBaseUnits:f(.9144)},"square-miles":{inBaseUnits:f(1609.344)},"square-us-feet":{inBaseUnits:f(1200/3937)},acres:{inBaseUnits:.0015625*f(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*v(.001)},"cubic-centimeters":{inBaseUnits:1e3*v(.01)},"cubic-decimeters":{inBaseUnits:1e3*v(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*v(1e3)},"cubic-inches":{inBaseUnits:1e3*v(.0254)},"cubic-feet":{inBaseUnits:1e3*v(.3048)},"cubic-yards":{inBaseUnits:1e3*v(.9144)},"cubic-miles":{inBaseUnits:1e3*v(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},b=(()=>{const e={};for(const t in _)for(const i in _[t].units)e[i]=t;return e})();const w=["metric","imperial","square-inches","square-feet","square-yards","square-miles","square-us-feet","square-meters","square-kilometers","acres","ares","hectares"],E=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],S=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function T(e){return"imperial"===e||"metric"===e}function x(e){const t=b[e];if(!t)throw new Error("unknown type");return t}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=t||x(e),_[t].baseUnit===e}function O(e,t,i){if(t===i)return e;const n=x(t);if(n!==x(i))throw new Error("incompatible units");const s=C(t,n)?e:function(e,t,i){return e*_[i].units[t].inBaseUnits}(e,t,n);return C(i,n)?s:function(e,t,i){return e/_[i].units[t].inBaseUnits}(s,i,n)}function P(e,t){const i=O(e,t,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function I(e,t){const i=O(e,t,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function G(e,t){const i=O(e,t,"feet");return Math.abs(i)<1e3?"feet":"miles"}function R(e,t){const i=O(e,t,"feet");return Math.abs(i)<1e5?"feet":"miles"}function M(e,t){const i=O(e,t,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function A(e,t){const i=O(e,t,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function N(e,t,i){return O(e,t,"meters")/(i*Math.PI/180)}function V(e){return m.fromJSON(e.toLowerCase())||null}function H(e){if(e&&"object"==typeof e&&!(0,l.N$)(e))return 1;const t=U(e);return t>1e5?1:t}function k(e){return U(e)>=(e instanceof o.Z?(0,r.Iu)(e).metersPerDegree:1e5)?"meters":Z(e)}function U(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.sv.metersPerDegree;return(0,s.Pt)(F(e,!0),t)}function F(e){let t,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=null;if(null!=e&&("object"==typeof e?(t=e.wkid,i=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(i=e)),t){if((0,l.o$)(t))return a.yr.metersPerDegree;if((0,l.ME)(t))return a.Z1.metersPerDegree;s=u.values[u[t]],!s&&n&&y.has(t)&&(s=h)}else i&&(B(i)?s=D(d.exec(i),s):W(i)&&(s=D(g.exec(i),s)));return s}function D(e,t){return e&&e[1]?L(e[1]):t}function L(e){return parseFloat(e.split(",")[1])}function Z(e){let t,i,n=null;if(null!=e&&("object"==typeof e?(t=e.wkid,i=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(i=e)),t)n=u.units[u[t]];else if(i){const e=B(i)?d:W(i)?g:null;if(e){const t=e.exec(i);t&&t[1]&&(n=function(e){const t=/[\\"\\']{1}([^\\"\\']+)/.exec(e);let i=t&&t[1];if(!i||!u.units.includes(i)){const t=L(e);i=null;const n=u.values;for(let e=0;e<n.length;++e)if(Math.abs(t-n[e])<1e-7){i=u.units[e];break}}return i}(t[1]))}}return(0,s.pC)(n)?V(n):null}function j(e){const t=Z(e);return(0,s.Wi)(t)||!E.includes(t)?null:t}function z(e){const t=k(e);return(0,s.Wi)(t)||!E.includes(t)?null:t}function q(e){const t=Z(e);return(0,s.Wi)(t)?null:S.get(t)}function W(e){return/^GEOCCS/i.test(e)}function B(e){return/^PROJCS/i.test(e)}function Y(e){const t="metric";if((0,s.Wi)(e))return t;const i=e.map,n=i&&"portalItem"in i?i.portalItem?.portal:null;if(n)switch(n?.user?.units??n.units){case t:return t;case"english":return"imperial"}return(0,s.Pt)(function(e){const t=Z(e);if((0,s.Wi)(t))return null;switch(t){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}(e.spatialReference),t)}const X={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},J={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},K=(0,n.w)()(X),$=(0,n.w)()(J);(0,n.w)()({...X,...J})},42137:(e,t,i)=>{i.d(t,{Z:()=>y});var n,s=i(27366),r=i(68860),o=i(49861),a=(i(63780),i(93169),i(25243),i(69912)),l=i(7882),c=i(80885),p=i(92183),h=i(15559),d=i(81753),u=i(89093);let g=n=class extends c.Z{constructor(){super(...arguments),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(e,t){let i;if(e&&e.center)i=e;else{if(e&&e.rings)return super.normalizeCtorArgs(e,t);i={center:e}}return{...super.normalizeCtorArgs(),...i,...t}}initialize(){const e=this.center,t=this.numberOfPoints;if(this.hasZ=e&&e.hasZ,0!==this.rings.length||!e)return;const i=(0,r.En)(this.radius,this.radiusUnit,"meters"),n=e.spatialReference;let s,o="geographic";if(n.isWebMercator?o="webMercator":(null!=u.Z[n.wkid]||n.wkt&&0===n.wkt.indexOf("PROJCS"))&&(o="projected"),this.geodesic){let n;switch(o){case"webMercator":n=(0,d.Sx)(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":n=e}s=this._createGeodesicCircle(n,i,t),"webMercator"===o&&(s=(0,d.$)(s))}else{let n;"webMercator"===o||"projected"===o?n=i/this._convert2Meters(1,e.spatialReference):"geographic"===o&&(n=(0,r.ty)(i,"meters",(0,p.Iu)(e.spatialReference).radius)),s=this._createPlanarCircle(e,n,t)}this.spatialReference=s.spatialReference,this.addRing(s.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:i,radiusUnit:s,geodesic:r}=this;return new n({center:e.clone(),numberOfPoints:t,radius:i,radiusUnit:s,geodesic:r})}_createGeodesicCircle(e,t,i){let n=0;const s=[];for(;n<360;){const r=[0,0],o=[e.x,e.y];(0,h.TB)(r,o,n,t),this.hasZ&&r.push(e.z),s.push(r),n+=360/i}return s.push(s[0]),new c.Z(s)}_createPlanarCircle(e,t,i){const n=[],s=2*Math.PI/i;for(let r=0;r<i;++r){const i=s*r,o=[e.x+Math.cos(-i)*t,e.y+Math.sin(-i)*t];this.hasZ&&o.push(e.z),n.push(o)}return n.push(n[0]),new c.Z({spatialReference:e.spatialReference,rings:[n]})}_convert2Meters(e,t){let i;if(null!=u.Z[t.wkid])i=u.Z.values[u.Z[t.wkid]];else{const e=t.wkt,n=e.lastIndexOf(",")+1,s=e.lastIndexOf("]]");i=parseFloat(e.substring(n,s))}return e*i}};(0,s._)([(0,o.Cb)({type:l.Z})],g.prototype,"center",void 0),(0,s._)([(0,o.Cb)()],g.prototype,"geodesic",void 0),(0,s._)([(0,o.Cb)()],g.prototype,"numberOfPoints",void 0),(0,s._)([(0,o.Cb)()],g.prototype,"radius",void 0),(0,s._)([(0,o.Cb)()],g.prototype,"radiusUnit",void 0),g=n=(0,s._)([(0,a.j)("esri.geometry.Circle")],g);const y=g},40237:(e,t,i)=>{i.d(t,{N:()=>n});const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,i){const n=new s(e.getPointX(t),e.getPointY(t),i),r=e.hasZ(t),o=e.hasM(t);return r&&(n.z=e.getPointZ(t)),o&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,i){return new r(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,i){return new o(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,i){return new a(e.exportPoints(t),i,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,i){const n=e.hasZ(t),s=e.hasM(t),r=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),i);if(n){const i=e.getZExtent(t);r.zmin=i.vmin,r.zmax=i.vmax}if(s){const i=e.getMExtent(t);r.mmin=i.vmin,r.mmax=i.vmax}return r}};class s{constructor(e,t,i){this.x=e,this.y=t,this.spatialReference=i,this.z=void 0,this.m=void 0}}class r{constructor(e,t,i,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class o{constructor(e,t,i,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class a{constructor(e,t,i,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class l{constructor(e,t,i,n,s){this.xmin=e,this.ymin=t,this.xmax=i,this.ymax=n,this.spatialReference=s,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},92183:(e,t,i)=>{i.d(t,{GG:()=>a,HQ:()=>l,Iu:()=>d,VY:()=>c,e8:()=>u,rS:()=>h,wY:()=>p});var n=i(78952),s=i(22186),r=i(92975);function o(e){return new n.Z({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${e.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}const a=o(s.sv),l=o(s.yr),c=o(s.Z1),p=new n.Z({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${s.sv.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});function h(e){return e&&((0,r.BZ)(e)||e===l)?l:e&&((0,r.V2)(e)||e===c)?c:a}function d(e){return e&&((0,r.BZ)(e)||e===l)?s.yr:e&&((0,r.V2)(e)||e===c)?s.Z1:s.sv}function u(e){return(0,r.o$)(e)?s.yr:(0,r.ME)(e)?s.Z1:s.sv}},41414:(e,t,i)=>{i.d(t,{BD:()=>E,G1:()=>d,Gv:()=>H,HH:()=>l,JR:()=>M,KE:()=>C,TC:()=>c,Tn:()=>P,Ue:()=>o,VK:()=>p,Wi:()=>u,Zp:()=>S,aO:()=>w,al:()=>a,bA:()=>x,be:()=>_,cS:()=>G,cv:()=>T,dp:()=>b,fS:()=>V,op:()=>O,pp:()=>h,sU:()=>g,t8:()=>I,wp:()=>N,wz:()=>v,xE:()=>k,y8:()=>R});var n=i(92026),s=i(53866),r=i(65156);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k;return[e[0],e[1],e[2],e[3],e[4],e[5]]}function a(e,t,i,n,s,r){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o();return a[0]=e,a[1]=t,a[2]=i,a[3]=n,a[4]=s,a[5]=r,a}function l(e,t){const i=isFinite(e[2])||isFinite(e[5]);return new s.Z(i?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function c(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function p(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function h(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function d(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length/3,s=e[0],r=e[1],o=e[2],a=e[3],l=e[4],c=e[5];for(let p=0;p<n;p++)s=Math.min(s,t[i+3*p]),r=Math.min(r,t[i+3*p+1]),o=Math.min(o,t[i+3*p+2]),a=Math.max(a,t[i+3*p]),l=Math.max(l,t[i+3*p+1]),c=Math.max(c,t[i+3*p+2]);e[0]=s,e[1]=r,e[2]=o,e[3]=a,e[4]=l,e[5]=c}function u(e,t,i){const n=t.length;let s=e[0],r=e[1],o=e[2],a=e[3],l=e[4],c=e[5];if(i)for(let p=0;p<n;p++){const e=t[p];s=Math.min(s,e[0]),r=Math.min(r,e[1]),o=Math.min(o,e[2]),a=Math.max(a,e[0]),l=Math.max(l,e[1]),c=Math.max(c,e[2])}else for(let p=0;p<n;p++){const e=t[p];s=Math.min(s,e[0]),r=Math.min(r,e[1]),a=Math.max(a,e[0]),l=Math.max(l,e[1])}e[0]=s,e[1]=r,e[2]=o,e[3]=a,e[4]=l,e[5]=c}function g(e){for(let t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0}function y(e){return e[0]>=e[3]?0:e[3]-e[0]}function m(e){return e[1]>=e[4]?0:e[4]-e[1]}function f(e){return e[2]>=e[5]?0:e[5]-e[2]}function v(e){const t=y(e),i=f(e),n=m(e);return Math.sqrt(t*t+i*i+n*n)}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=e[0]+y(e)/2,t[1]=e[1]+m(e)/2,t[2]=e[2]+f(e)/2,t}function b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return t[0]=y(e),t[1]=m(e),t[2]=f(e),t}function w(e){return Math.max(y(e),f(e),m(e))}function E(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]}function S(e,t){return!!(0,n.Wi)(t)||function(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])}(e,t)}function T(e,t,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e;return s[0]=e[0]+t,s[1]=e[1]+i,s[2]=e[2]+n,s[3]=e[3]+t,s[4]=e[4]+i,s[5]=e[5]+n,s}function x(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n=e[0]+y(e)/2,s=e[1]+m(e)/2,r=e[2]+f(e)/2;return i[0]=n+(e[0]-n)*t,i[1]=s+(e[1]-s)*t,i[2]=r+(e[2]-r)*t,i[3]=n+(e[3]-n)*t,i[4]=s+(e[4]-s)*t,i[5]=r+(e[5]-r)*t,i}function C(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function O(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i!==e&&(i[3]=e[3],i[4]=e[4],i[5]=e[5]),i}function P(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return i[3]=t[0],i[4]=t[1],i[5]=t[2],i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2]),e}function I(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function G(e){return e?I(e,H):o(H)}function R(e,t){return t||(t=(0,r.Ue)()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t}function M(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function A(e){return 6===e.length}function N(e){return 0===y(e)&&0===m(e)&&0===f(e)}function V(e,t,i){if((0,n.Wi)(e)||(0,n.Wi)(t))return e===t;if(!A(e)||!A(t))return!1;if(i){for(let n=0;n<e.length;n++)if(!i(e[n],t[n]))return!1}else for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const H=[1/0,1/0,1/0,-1/0,-1/0,-1/0],k=[0,0,0,0,0,0];o()},93501:(e,t,i)=>{i.d(t,{k:()=>o});var n=i(92026),s=i(68860),r=i(92975);function o(e,t,i){if((0,n.Wi)(t)||(0,n.Wi)(i)||i.vcsWkid||(0,r.fS)(t,i))return null;const o=(0,s._R)(t)/(0,s._R)(i);if(1===o)return null;switch(e){case"point":case"esriGeometryPoint":return e=>function(e,t){e&&null!=e.z&&(e.z*=t)}(e,o);case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(const i of e.paths)for(const e of i)e.length>2&&(e[2]*=t)}(e,o);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(const i of e.rings)for(const e of i)e.length>2&&(e[2]*=t)}(e,o);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(const i of e.points)i.length>2&&(i[2]*=t)}(e,o);case"extent":case"esriGeometryExtent":return e=>function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,o);default:return null}}},93655:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(27366),s=i(49861),r=(i(63780),i(93169),i(25243),i(69912)),o=i(68748),a=i(30651),l=i(6693),c=i(56811),p=i(78983),h=i(64575);let d=class extends((0,l.h)((0,c.M)(a.Z))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new p.J,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,n._)([(0,s.Cb)({type:h.ZP})],d.prototype,"elevationInfo",void 0),(0,n._)([(0,s.Cb)((0,o.z)(p.J,"graphics"))],d.prototype,"graphics",void 0),(0,n._)([(0,s.Cb)({type:["show","hide"]})],d.prototype,"listMode",void 0),(0,n._)([(0,s.Cb)()],d.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],d.prototype,"type",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0})],d.prototype,"internal",void 0),d=(0,n._)([(0,r.j)("esri.layers.GraphicsLayer")],d);const u=d},92536:(e,t,i)=>{i.d(t,{y:()=>m,r:()=>h});var n=i(92026),s=i(4954),r=i(94446),o=i(58971),a=i(92975),l=i(33392),c=i(15903);class p{constructor(e,t,i){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=i,this.featureAdapter=t;const n=e.outFields;if(n&&!n.includes("*")){this.outFields=n;let e=0;for(const t of n){const n=(0,l.hr)(t),s=this.fieldsIndex.get(n),r=s?null:(0,l.Jc)(n,i),o=s?s.name:(0,l.nu)(t)||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:o,clause:r})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,i){const n=i?i.name:t;let s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:i||(s=(0,l.Jc)(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),i?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)}getNormalizedValue(e,t){const i=t.normalizationType,n=t.normalizationTotal;let s=this.getFieldValue(e,t.field,t.fieldInfo);if(i&&Number.isFinite(s)){const r=this.getFieldValue(e,t.normalizationField,t.normalizationFieldInfo);s=(0,c.fk)(s,i,r,n)}return s}getExpressionValue(e,t,i,n){const s={attributes:this.featureAdapter.getAttributes(e),layer:{fields:this.fieldsIndex.fields}},r=n.createExecContext(s,i);return n.executeFunction(t,r)}getExpressionValues(e,t,i,n){const s={fields:this.fieldsIndex.fields};return e.map((e=>{const r={attributes:this.featureAdapter.getAttributes(e),layer:s},o=n.createExecContext(r,i);return n.executeFunction(t,o)}))}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:(0,l.Jc)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:(0,l.Jc)(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)}_processAttributesForOutFields(e){const t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);const i={};for(const n of t){const{alias:t,clause:s}=this._fieldDataCache.get(n);i[t]=s?s.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return i}_processAttributesForDistinctValues(e){if((0,n.Wi)(e)||!this.returnDistinctValues)return e;const t=this.outFields,i=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);i.push(e[t])}else for(const n in e)i.push(e[n]);const s=`${(t||["*"]).join(",")}=${i.join(",")}`;let r=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++r),r>1?null:e}}var h,d=i(19995),u=i(31904),g=i(37270),y=i(819);class m{constructor(e,t,i){this.items=e,this.query=t,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.fieldsIndex=i.fieldsIndex,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.featureAdapter=i.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new p(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:i,outStatistics:n}=this.query,s=t?.length;if(!s)return 1;const r=new Map,o=new Map,a=new Set;for(const l of n){const{statisticType:n}=l,s="exceedslimit"!==n?l.onStatisticField:void 0;if(!o.has(s)){const i=[];for(const n of t){const t=this._getAttributeValues(e,n,r);i.push(t)}o.set(s,this._calculateUniqueValues(i,e.returnDistinctValues))}const c=o.get(s);for(const t in c){const{data:n,items:s}=c[t],r=n.join(",");i&&!e.validateItems(s,i)||a.add(r)}}return a.size}async createQueryResponse(){let e;return e=this.query.outStatistics?this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry&&((0,a.JY)(this.query.outSR)&&!(0,a.fS)(this.query.geometry.spatialReference,this.query.outSR)?e.queryGeometry=(0,u.S2)({spatialReference:this.query.outSR,...(0,d.iV)(this.query.geometry,this.query.geometry.spatialReference,this.query.outSR)}):e.queryGeometry=(0,u.S2)({spatialReference:this.query.outSR,...this.query.geometry})),e}createSnappingResponse(e,t){const i=this.featureAdapter,s=function(e,t){return e?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:r,y:o}=e.point,a="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,c={candidates:[]},p="esriGeometryPolygon"===this.geometryType,d=this._getPointCreator(e.point,this.spatialReference,t);for(const u of this.items){const t=i.getGeometry(u);if((0,n.Wi)(t))continue;const{coords:g,lengths:y}=t;if(e.types&h.EDGE){let e=0;for(let t=0;t<y.length;t++){const n=y[t];for(let t=0;t<n;t++,e+=s){const p=g[e],h=g[e+1];if(t!==n-1){const t=g[e+s],n=g[e+s+1],{x:y,y:m}=f(r,o,p,h,t,n),v=(r-y)/a,_=(o-m)/l,b=v*v+_*_;b<=1&&c.candidates.push({type:"edge",objectId:i.getObjectId(u),distance:Math.sqrt(b),target:d(y,m),start:d(p,h),end:d(t,n)})}}}}if(e.types&h.VERTEX){const e=p?g.length-s:g.length;for(let t=0;t<e;t+=s){const e=g[t],n=g[t+1],s=(r-e)/a,p=(o-n)/l,h=s*s+p*p;h<=1&&c.candidates.push({type:"vertex",objectId:i.getObjectId(u),distance:Math.sqrt(h),target:d(e,n)})}}}return c.candidates.sort(((e,t)=>e.distance-t.distance)),c}_getPointCreator(e,t,i){const s=(0,n.pC)(i)&&!(0,a.fS)(t,i)?e=>(0,d.iV)(e,t,i):e=>e;return null!=e.z&&null!=e.m?(t,i)=>s({x:t,y:i,z:e.z,m:e.m}):null!=e.z?(t,i)=>s({x:t,y:i,z:e.z}):null!=e.m?(t,i)=>s({x:t,y:i,m:e.m}):(e,t)=>s({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:r,minValue:o,maxValue:a,scale:l}=e,p=this.fieldsIndex.isDateField(t),h=await this._getDataValues({field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:r,scale:l}),d=(0,c.S5)({normalizationType:s,normalizationField:n,minValue:o,maxValue:a}),u=this.fieldsIndex.get(t),y={value:.5,fieldType:u?.type},m=(0,g.qN)(u)?(0,c.H0)({values:h,supportsNullCount:d,percentileParams:y}):(0,c.i5)({values:h,minValue:o,maxValue:a,useSampleStdDev:!s,supportsNullCount:d,percentileParams:y});return(0,c.F_)(m,p)}async createUniqueValuesResponse(e){const{field:t,valueExpression:i,domain:n,returnAllCodedValues:s,scale:r}=e,o=await this._getDataValues({field:t,valueExpression:i,scale:r}),a=(0,c.eT)(o);return(0,c.Qm)(a,n,s)}async createClassBreaksResponse(e){const{field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:r,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:p,numClasses:h,scale:d}=e,u=await this._getDataValues({field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:r,scale:d}),g=(0,c.G2)(u,{field:t,normalizationField:n,normalizationType:s,normalizationTotal:r,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:p,numClasses:h});return(0,c.DL)(g,o)}async createHistogramResponse(e){const{field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:r,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:p,numBins:h,scale:d}=e,u=await this._getDataValues({field:t,valueExpression:i,normalizationField:n,normalizationType:s,normalizationTotal:r,scale:d});return(0,c.oF)(u,{field:t,normalizationField:n,normalizationType:s,normalizationTotal:r,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:p,numBins:h})}_sortFeatures(e,t,i){if(e.length>1&&t&&t.length)for(const n of t.reverse()){const t=n.split(" "),s=t[0],r=this.fieldsIndex.get(s),o=t[1]&&"desc"===t[1].toLowerCase(),a=(0,c.Lq)(r?.type,o);e.sort(((e,t)=>{const n=i(e,s,r),o=i(t,s,r);return a(n,o)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:i,hasM:n,hasZ:s,objectIdField:r,spatialReference:a}=this,{outFields:l,outSR:c,quantizationParameters:p,resultRecordCount:h,resultOffset:d,returnZ:g,returnM:y}=e,m=null!=h&&t.length>(d||0)+h,f=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:m,features:this._createFeatures(e,t),fields:f,geometryType:i,hasM:n&&y,hasZ:s&&g,objectIdFieldName:r,spatialReference:(0,u.S2)(c||a),transform:p&&(0,o.vY)(p)||null}}_createFeatures(e,t){const i=new p(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:s}=this,{orderByFields:r,quantizationParameters:a,returnGeometry:l,returnCentroid:c,maxAllowableOffset:h,resultOffset:d,resultRecordCount:g,returnZ:y=!1,returnM:m=!1}=e,f=s&&y,v=n&&m;let _=[],b=0;const w=[...t];if(this._sortFeatures(w,r,((e,t,n)=>i.getFieldValue(e,t,n))),l||c){const e=(0,o.vY)(a);if(l&&!c)for(const t of w)_[b++]={attributes:i.getAttributes(t),geometry:(0,u.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),h,e,f,v)};else if(!l&&c)for(const t of w)_[b++]={attributes:i.getAttributes(t),centroid:(0,u.EG)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of w)_[b++]={attributes:i.getAttributes(t),centroid:(0,u.EG)(this,this.featureAdapter.getCentroid(t,this),e),geometry:(0,u.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),h,e,f,v)}}else for(const o of w){const e=i.getAttributes(o);e&&(_[b++]={attributes:e})}const E=d||0;if(null!=g){const e=E+g;_=_.slice(E,Math.min(_.length,e))}return _}_createExceedsLimitQueryResponse(e){let t=!1,i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(const n of e.outStatistics)if("exceedslimit"===n.statisticType){i=null!=n.maxPointCount?n.maxPointCount:Number.POSITIVE_INFINITY,s=null!=n.maxRecordCount?n.maxRecordCount:Number.POSITIVE_INFINITY,r=null!=n.maxVertexCount?n.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>i;else if(this.items.length>s)t=!0;else{const e=this.hasZ?this.hasM?4:3:this.hasM?3:2,i=this.featureAdapter;t=this.items.reduce(((e,t)=>{const s=i.getGeometry(t);return e+((0,n.pC)(s)&&s.coords.length||0)}),0)/e>r}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},i=[],n=new Map,s=new Map,r=new Map,o=new Map,a=new p(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,{groupByFieldsForStatistics:c,having:h,orderByFields:d}=e,u=c&&c.length,g=!!u,y=g&&c[0],m=g&&!this.fieldsIndex.get(y);for(const p of l){const{outStatisticFieldName:e,statisticType:l}=p,d=p,f="exceedslimit"!==l?p.onStatisticField:void 0,v="percentile_disc"===l||"percentile_cont"===l,_="EnvelopeAggregate"===l||"CentroidAggregate"===l||"ConvexHullAggregate"===l,b=g&&1===u&&(f===y||m)&&"count"===l;if(g){if(!r.has(f)){const e=[];for(const t of c){const i=this._getAttributeValues(a,t,n);e.push(i)}r.set(f,this._calculateUniqueValues(e,a.returnDistinctValues))}const t=r.get(f);for(const i in t){const{count:s,data:r,items:l,itemPositions:p}=t[i],u=r.join(",");if(!h||a.validateItems(l,h)){const t=o.get(u)||{attributes:{}};if(_){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:i}=await this._getAggregateGeometry(d,l);t.aggregateGeometries[i]=e}else{let i=null;if(b)i=s;else{const e=this._getAttributeValues(a,f,n),t=p.map((t=>e[t]));i=v&&"statisticParameters"in d?this._getPercentileValue(d,t):this._getStatisticValue(d,t,null,a.returnDistinctValues)}t.attributes[e]=i}c.forEach(((e,i)=>t.attributes[this.fieldsIndex.get(e)?e:`EXPR_${i+1}`]=r[i])),o.set(u,t)}}}else if(_){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:i}=await this._getAggregateGeometry(d,this.items);t.aggregateGeometries[i]=e}else{const i=this._getAttributeValues(a,f,n);t.attributes[e]=v&&"statisticParameters"in d?this._getPercentileValue(d,i):this._getStatisticValue(d,i,s,a.returnDistinctValues)}i.push({name:e,alias:e,type:"esriFieldTypeDouble"})}const f=g?Array.from(o.values()):[t];return this._sortFeatures(f,d,((e,t)=>e.attributes[t])),{fields:i,features:f}}async _getAggregateGeometry(e,t){const n=await Promise.all([i.e(9058),i.e(3645)]).then(i.bind(i,50309)),{statisticType:o,outStatisticFieldName:a}=e,{featureAdapter:l,spatialReference:c,geometryType:p,hasZ:h,hasM:d}=this,g=t.map((e=>(0,u.Op)(p,h,d,l.getGeometry(e)))),y=n.convexHull(c,g,!0)[0],m={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===o){const e=y?(0,r._w)(y):(0,r.aO)(n.union(c,g));m.aggregateGeometries={...e,spatialReference:c},m.outStatisticFieldName=a||"extent"}else if("CentroidAggregate"===o){const e=y?(0,s.tO)(y):(0,s.$G)((0,r.aO)(n.union(c,g)));m.aggregateGeometries={x:e[0],y:e[1],spatialReference:c},m.outStatisticFieldName=a||"centroid"}else"ConvexHullAggregate"===o&&(m.aggregateGeometries=y,m.outStatisticFieldName=a||"convexHull");return m}_getStatisticValue(e,t,i,n){const{onStatisticField:s,statisticType:r}=e;let o=null;return o=i?.has(s)?i.get(s):(0,g.qN)(this.fieldsIndex.get(s))?(0,c.H0)({values:t,returnDistinct:n}):(0,c.i5)({values:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(s,o),o["var"===r?"variance":r]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:n,statisticType:s}=e,{value:r,orderBy:o}=n,a=this.fieldsIndex.get(i);return(0,c.XL)(t,{value:r,orderBy:o,fieldType:a?.type,isDiscrete:"percentile_disc"===s})}_getAttributeValues(e,t,i){if(i.has(t))return i.get(t);const n=this.fieldsIndex.get(t),s=this.items.map((i=>e.getFieldValue(i,t,n)));return i.set(t,s),s}_getAttributeNormalizedValues(e,t){return this.items.map((i=>e.getNormalizedValue(i,{field:t.field,fieldInfo:this.fieldsIndex.get(t.field),normalizationField:t.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(t.normalizationField),normalizationType:t.normalizationType,normalizationTotal:t.normalizationTotal})))}async _getAttributeExpressionValues(e,t,i){const{arcadeUtils:n}=await(0,y.LC)(),s=n.createFunction(t),r=i&&n.getViewInfo(i);return e.getExpressionValues(this.items,s,r,n)}_calculateUniqueValues(e,t){const i={},n=this.items,s=n.length;for(let r=0;r<s;r++){const s=n[r],o=[];for(const t of e)o.push(t[r]);const a=o.join(",");t?null==i[a]&&(i[a]={count:1,data:o,items:[s],itemPositions:[r]}):null==i[a]?i[a]={count:1,data:o,items:[s],itemPositions:[r]}:(i[a].count++,i[a].items.push(s),i[a].itemPositions.push(r))}return i}async _getDataValues(e){const t=new p(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:i,field:n,normalizationField:s,normalizationType:r,normalizationTotal:o,scale:a}=e,l=i?{viewingMode:"map",scale:a,spatialReference:this.query.outSR||this.spatialReference}:null;return i?this._getAttributeExpressionValues(t,i,l):this._getAttributeNormalizedValues(t,{field:n,normalizationField:s,normalizationType:r,normalizationTotal:o})}}function f(e,t,i,n,s,r){const o=s-i,a=r-n,l=o*o+a*a,c=(e-i)*o+(t-n)*a,p=Math.min(1,Math.max(0,c/l));return{x:i+o*p,y:n+a*p}}!function(e){e[e.NONE=0]="NONE",e[e.EDGE=1]="EDGE",e[e.VERTEX=2]="VERTEX"}(h||(h={}))},33392:(e,t,i)=>{i.d(t,{nu:()=>y,hr:()=>g,Jc:()=>d,G3:()=>m,Of:()=>u,z4:()=>h,hO:()=>p});var n=i(10064),s=i(59026),r=i(48562);const o=new class{constructor(e,t){this._cache=new s.Z(e),this._invalidCache=new s.Z(t)}get(e,t){const i=`${t.uid}:${e}`,n=this._cache.get(i);if(n)return n;if(void 0!==this._invalidCache.get(i))return null;try{const n=r.WhereClause.create(e,t);return this._cache.put(i,n),n}catch{return this._invalidCache.put(i,null),null}}}(50,500),a="feature-store:unsupported-query",l=" as ",c=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function p(e,t){if(!t)return!0;const i=o.get(t,e);if(!i)throw new n.Z(a,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new n.Z(a,"where clause is not standard",{where:t});return u(e,i.fieldNames,"where clause contains missing fields"),!0}function h(e,t,i){if(!t)return!0;const s=o.get(t,e);if(!s)throw new n.Z(a,"invalid SQL expression",{having:t});if(!s.isAggregate)throw new n.Z(a,"having does not contain a valid aggregate function",{having:t});const r=s.fieldNames;if(u(e,r,"having contains missing fields"),!s.getExpressions().every((t=>{const{aggregateType:n,field:s}=t,r=e.has(s)&&e.get(s).name;return i.some((t=>{const{onStatisticField:i,statisticType:s}=t;return(e.has(i)&&e.get(i).name)===r&&s.toLowerCase().trim()===n}))})))throw new n.Z(a,"expressions in having should also exist in outStatistics",{having:t});return!0}function d(e,t){return e?o.get(e,t):null}function u(e,t,i){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=[];for(const o of t)if("*"!==o&&!e.has(o))if(s){const t=g(o);try{const i=d(t,e);if(!i)throw new n.Z(a,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new n.Z(a,"expression is not standard",{clause:i});u(e,i.fieldNames,"expression contains missing fields")}catch(h){const t=h&&h.details;if(t&&(t.clause||t.where))throw h;t&&t.missingFields?r.push(...t.missingFields):r.push(o)}}else r.push(o);if(r.length)throw new n.Z(a,i,{missingFields:r})}function g(e){return e.split(l)[0]}function y(e){return e.split(l)[1]}function m(e,t){const i=t.get(e);return!!i&&!c.has(i.type)}},19995:(e,t,i)=>{i.d(t,{_W:()=>d,iV:()=>y,oj:()=>f});var n=i(92026),s=i(79803),r=i(40237),o=i(92975),a=i(81753);const l=[0,0];function c(e,t){if(!t)return null;if("x"in t){const i={x:0,y:0};return[i.x,i.y]=e(t.x,t.y,l),null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){const i={xmin:0,ymin:0,xmax:0,ymax:0};return[i.xmin,i.ymin]=e(t.xmin,t.ymin,l),[i.xmax,i.ymax]=e(t.xmax,t.ymax,l),t.hasZ&&(i.zmin=t.zmin,i.zmax=t.zmax,i.hasZ=!0),t.hasM&&(i.mmin=t.mmin,i.mmax=t.mmax,i.hasM=!0),i}return"rings"in t?{rings:p(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:p(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:h(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:void 0}function p(e,t){const i=[];for(const n of e)i.push(h(n,t));return i}function h(e,t){const i=[];for(const n of e){const e=t(n[0],n[1],[0,0]);i.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return i}async function d(e,t){if(!t)return;const i=Array.isArray(e)?e.map((e=>(0,n.pC)(e.geometry)&&e.geometry.spatialReference)):[e];await(0,s.iQ)(i.map((e=>({source:e,dest:t}))))}const u=c.bind(null,a.hG),g=c.bind(null,a.R6);function y(e,t,i,n){if(!e)return e;if(i||(i=t,t=e.spatialReference),!(0,o.JY)(t)||!(0,o.JY)(i)||(0,o.fS)(t,i))return e;if((0,a.Q8)(t,i)){const t=(0,o.sS)(i)?u(e):g(e);return t.spatialReference=i,t}return(0,s.oj)(r.N,[e],t,i,null,n)[0]}const m=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,i){if(!e||!e.length||!t||!i||(0,o.fS)(t,i))return e;const n={geometries:e,inSpatialReference:t,outSpatialReference:i,resolve:null};return this._jobs.push(n),new Promise((e=>{n.resolve=e,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:i,outSpatialReference:n,resolve:l}=e;(0,a.Q8)(i,n)?(0,o.sS)(n)?l(t.map(u)):l(t.map(g)):l((0,s.oj)(r.N,t,i,n,null,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function f(e,t,i){return m.push(e,t,i)}},31904:(e,t,i)=>{i.d(t,{EG:()=>_,Op:()=>b,S2:()=>S,Up:()=>w,j6:()=>E,vF:()=>g});var n=i(43404),s=i(92026),r=i(68860),o=i(94446),a=i(77981),l=i(50689),c=i(92975),p=i(83406),h=i(80457),d=i(19995);const u=new n.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),g=Object.freeze({}),y=new h.Z,m=new h.Z,f=new h.Z,v={esriGeometryPoint:p.fQ,esriGeometryPolyline:p.J6,esriGeometryPolygon:p.eG,esriGeometryMultipoint:p.Iv};function _(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.hasZ,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.hasM;if((0,s.Wi)(t))return null;const o=e.hasZ&&n,a=e.hasM&&r;if(i){const s=(0,p.Nh)(f,t,e.hasZ,e.hasM,"esriGeometryPoint",i,n,r);return(0,p.fQ)(s,o,a)}return(0,p.fQ)(t,o,a)}function b(e,t,i,n,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:i;const c=t&&a,h=i&&l,d=(0,s.pC)(n)?"coords"in n?n:n.geometry:null;if((0,s.Wi)(d))return null;if(r){let n=(0,p.zj)(m,d,t,i,e,r,a,l);return o&&(n=(0,p.Nh)(f,n,c,h,e,o)),v[e](n,c,h)}if(o){const n=(0,p.Nh)(f,d,t,i,e,o,a,l);return v[e](n,c,h)}return(0,p.hY)(y,d,t,i,a,l),v[e](y,c,h)}async function w(e,t,i){const{outFields:n,orderByFields:s,groupByFieldsForStatistics:r,outStatistics:o}=e;if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(s)for(let a=0;a<s.length;a++)s[a]=s[a].trim();if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(o)for(let a=0;a<o.length;a++)o[a].onStatisticField&&(o[a].onStatisticField=o[a].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),E(e,t,i)}async function E(e,t,n){if(!e)return null;let{where:p}=e;if(e.where=p=p&&p.trim(),(!p||/^1 *= *1$/.test(p)||t&&t===p)&&(e.where=null),!e.geometry)return e;let h=await async function(e){const{geometry:t,distance:n,units:s}=e;if(null==n||"vertexAttributes"in t)return t;const o=t.spatialReference,a=s?u.fromJSON(s):(0,r.qE)(o),l=o&&((0,c.sT)(o)||(0,c.sS)(o))?t:await(0,d._W)(o,c.Zn).then((()=>(0,d.iV)(t,c.Zn)));return(await async function(){return(await Promise.all([i.e(9058),i.e(3645)]).then(i.bind(i,50309))).geodesicBuffer}())(l.spatialReference,l,n,a)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;h=(0,o.aO)(h),h.spatialReference=t}e.geometry=h,await(0,d._W)(h.spatialReference,n);const y=(await(0,l.aX)((0,a.im)(h)))[0];if((0,s.Wi)(y))throw g;const m=y.toJSON(),f=await(0,d.iV)(m,m.spatialReference,n);if(!f)throw g;return f.spatialReference=n,e.geometry=f,e}function S(e){return e&&T in e?JSON.parse(JSON.stringify(e,x)):e}const T="_geVersion",x=(e,t)=>e!==T?t:void 0},78983:(e,t,i)=>{i.d(t,{J:()=>c});var n=i(27366),s=i(52639),r=(i(32718),i(25243)),o=(i(63780),i(93169),i(75366),i(42017)),a=i(69912),l=i(68748);let c=class extends l.a{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};(0,n._)([(0,o.c)({Type:s.Z,ensureType:(0,r.se)(s.Z)})],c.prototype,"itemType",void 0),c=(0,n._)([(0,a.j)("esri.support.GraphicsCollection")],c)},57976:(e,t,i)=>{i.d(t,{Z:()=>p});var n,s=i(27366),r=i(85015),o=i(79056),a=i(49861),l=(i(63780),i(93169),i(25243),i(69912));let c=n=class extends((0,o.IG)(r.Z)){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new n({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};(0,s._)([(0,a.Cb)()],c.prototype,"active",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"className",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"disabled",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"id",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"indicator",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"title",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"type",void 0),(0,s._)([(0,a.Cb)()],c.prototype,"visible",void 0),c=n=(0,s._)([(0,l.j)("esri.support.actions.ActionBase")],c);const p=c},6945:(e,t,i)=>{i.d(t,{Z:()=>c});var n,s=i(27366),r=i(49861),o=(i(63780),i(93169),i(25243),i(69912)),a=i(57976);let l=n=class extends a.Z{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new n({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};(0,s._)([(0,r.Cb)()],l.prototype,"image",void 0),l=n=(0,s._)([(0,o.j)("esri.support.Action.ActionButton")],l);const c=l},9676:(e,t,i)=>{i.d(t,{Z:()=>c});var n,s=i(27366),r=i(49861),o=(i(63780),i(93169),i(25243),i(69912)),a=i(57976);let l=n=class extends a.Z{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new n({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};(0,s._)([(0,r.Cb)()],l.prototype,"image",void 0),(0,s._)([(0,r.Cb)()],l.prototype,"value",void 0),l=n=(0,s._)([(0,o.j)("esri.support.Action.ActionToggle")],l);const c=l},74509:(e,t,i)=>{i.d(t,{Lt:()=>c,Ou:()=>h,RL:()=>l,VW:()=>o,Zz:()=>r,vQ:()=>d,vu:()=>a,zx:()=>u});var n=i(92026),s=i(88152);function r(e,t){return(0,n.Wi)(t)||!t.mode?e?"absolute-height":"on-the-ground":t.mode}function o(e,t){return r(!!(0,n.pC)(e)&&e.hasZ,t)}function a(e){const t=p(e);return o(e.geometry,t)}function l(e){const t=p(e),i=o(e.geometry,t);return{mode:i,offset:(0,n.pC)(t)&&"on-the-ground"!==i?(0,n.Pt)(t.offset,0)*(0,s.Z7)((0,n.Pt)(t.unit,"meters")):0}}function c(e){if("on-the-ground"===a(e))return!1;const t=p(e),i=(0,n.pC)(t)&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!i||"0"===i)}function p(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function h(e,t,i){if((0,n.Wi)(i)||!i.mode)return;const s=e.hasZ?e.z:0,r=(0,n.pC)(i.offset)?i.offset:0;switch(i.mode){case"absolute-height":return s-r;case"on-the-ground":return 0;case"relative-to-ground":return s-((0,n.Pt)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+r);case"relative-to-scene":return s-((0,n.Pt)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+r)}}function d(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return g(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,n)}function u(e,t,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return g(e,t[0],t[1],t.length>2?t[2]:0,i,n,s)}function g(e,t,i,s,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if((0,n.Wi)(o))return;const l=(0,n.pC)(a)?a.mode:"absolute-height";if("on-the-ground"===l)return 0;const{absoluteZ:c}=y(t,i,s,r,e,o);return m(c,t,i,s,r,e,a,l)}function y(e,t,i,s,r,o){const a=(0,n.pC)(o.offset)?o.offset:0;switch(o.mode){case"absolute-height":return{absoluteZ:i+a,elevation:0};case"on-the-ground":{const i=(0,n.Pt)(r.elevationProvider.getElevation(e,t,0,s,"ground"),0);return{absoluteZ:i,elevation:i}}case"relative-to-ground":{const o=(0,n.Pt)(r.elevationProvider.getElevation(e,t,i,s,"ground"),0);return{absoluteZ:i+o+a,elevation:o}}case"relative-to-scene":{const o=(0,n.Pt)(r.elevationProvider.getElevation(e,t,i,s,"scene"),0);return{absoluteZ:i+o+a,elevation:o}}}}function m(e,t,i,s,r,o,a,l){const c=(0,n.pC)(a)&&(0,n.pC)(a.offset)?a.offset:0;switch(l){case"absolute-height":return e-c;case"relative-to-ground":return e-((0,n.Pt)(o.elevationProvider.getElevation(t,i,s,r,"ground"),0)+c);case"relative-to-scene":return e-((0,n.Pt)(o.elevationProvider.getElevation(t,i,s,r,"scene"),0)+c)}}},77498:(e,t,i)=>{i.d(t,{Z:()=>s,e:()=>n});var n;i(93169);function s(e){switch(e){case n.SUPPORTED:break;case n.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case n.GEOMETRY_MISSING:return"no geometry";case n.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case n.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case n.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}!function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"}(n||(n={}))},57889:(e,t,i)=>{i.d(t,{P:()=>o});i(93169);var n=i(92026),s=i(74509),r=i(77498);function o(e){if("graphics"!==e.layer?.type)return r.e.GRAPHICS_LAYER_MISSING;if((0,n.Wi)(e.geometry))return r.e.GEOMETRY_MISSING;switch(e.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return r.e.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==(0,s.vu)(e)&&(0,s.Lt)(e)?r.e.ELEVATION_MODE_UNSUPPORTED:r.e.SUPPORTED}},46684:(e,t,i)=>{i.d(t,{P:()=>a,b:()=>l});var n=i(92026),s=i(42137),r=i(74509),o=i(77498);function a(e){return c(e).result}function l(e){return c(e).geometry}function c(e){return"graphics"!==e.layer?.type?{result:o.e.GRAPHICS_LAYER_MISSING,geometry:null}:(0,n.Wi)(e.geometry)?{result:o.e.GEOMETRY_MISSING,geometry:null}:"on-the-ground"!==(0,r.vu)(e)&&(0,r.Lt)(e)?{result:o.e.ELEVATION_MODE_UNSUPPORTED,geometry:null}:"point"!==e.geometry.type&&"polyline"!==e.geometry.type&&("polygon"!==e.geometry.type||e.geometry instanceof s.Z)?{result:o.e.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:o.e.SUPPORTED,geometry:e.geometry}}},83089:(e,t,i)=>{i.d(t,{j:()=>r,p:()=>s});var n=i(92026);function s(e,t,i){if(!t||!e||!e.map)return;const{map:n}=e,s=n.layers.find((e=>e===t));s||n.add(t,i),null!=i&&n.layers.reorder(s,i)}function r(e,t){return e.allLayerViews.find((e=>{const i=e.layer;return i===t||"sublayers"in i&&(0,n.pC)(i.sublayers)&&i.sublayers.includes(t)}))}},87888:(e,t,i)=>{i.d(t,{j:()=>n});const n={redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "}},52349:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(27366),s=i(85015),r=i(49861),o=(i(63780),i(93169),i(25243),i(69912));let a=class extends s.Z{constructor(e){super(e),this.enabled=!1}};(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],a.prototype,"enabled",void 0),a=(0,n._)([(0,o.j)("esri.views.interactive.sketch.SketchLabelOptions")],a);const l=a},61920:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(27366),s=i(85015),r=i(49861),o=(i(63780),i(93169),i(25243),i(69912));let a=class extends s.Z{constructor(e){super(e),this.mode="absolute-height"}};(0,n._)([(0,r.Cb)({type:String,nonNullable:!0})],a.prototype,"mode",void 0),a=(0,n._)([(0,o.j)("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],a);let l=class extends s.Z{constructor(){super(...arguments),this.distance=!0,this.elevation=!0,this.size=!0,this.scale=!0,this.rotation=!0,this.orientation=!0,this.totalLength=!0,this.area=!0,this.radius=!0}};(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"distance",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"elevation",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"size",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"scale",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"rotation",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"orientation",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"totalLength",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"area",void 0),(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],l.prototype,"radius",void 0),l=(0,n._)([(0,o.j)("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],l);let c=class extends s.Z{constructor(e){super(e),this.enabled=!1,this.elevation=new a,this.visibleElements=new l,this.visualVariables=null}};(0,n._)([(0,r.Cb)({type:Boolean,nonNullable:!0})],c.prototype,"enabled",void 0),(0,n._)([(0,r.Cb)({type:a,nonNullable:!0})],c.prototype,"elevation",void 0),(0,n._)([(0,r.Cb)({type:l,nonNullable:!0})],c.prototype,"visibleElements",void 0),(0,n._)([(0,r.Cb)()],c.prototype,"visualVariables",void 0),c=(0,n._)([(0,o.j)("esri.widgets.Sketch.SketchTooltipOptions")],c);const p=c},22006:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(27366),s=i(85015),r=i(49861),o=(i(63780),i(93169),i(25243),i(69912));let a=class extends s.Z{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1}};(0,n._)([(0,r.Cb)({constructOnly:!0})],a.prototype,"layer",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"enabled",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"updating",void 0),(0,n._)([(0,r.Cb)()],a.prototype,"availability",void 0),a=(0,n._)([(0,o.j)("esri.views.interactive.snapping.SnappingLayerSource")],a);const l=a},76014:(e,t,i)=>{i.d(t,{c:()=>p});var n=i(27366),s=i(51995),r=i(46784),o=i(49861),a=i(69912);let l=class extends r.wq{constructor(){super(...arguments),this.enabled=!0}};(0,n._)([(0,o.Cb)({type:Boolean})],l.prototype,"enabled",void 0),l=(0,n._)([(0,a.j)("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],l);let c=class extends r.wq{constructor(e){super(e),this.lineSnapper=new l,this.parallelLineSnapper=new l,this.rightAngleSnapper=new l,this.rightAngleTriangleSnapper=new l,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new s.Z([255,127,0]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5}};(0,n._)([(0,o.Cb)({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],c.prototype,"lineSnapper",void 0),(0,n._)([(0,o.Cb)({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],c.prototype,"parallelLineSnapper",void 0),(0,n._)([(0,o.Cb)({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],c.prototype,"rightAngleSnapper",void 0),(0,n._)([(0,o.Cb)({type:l,constructOnly:!0,nonNullable:!0,json:{write:!0}})],c.prototype,"rightAngleTriangleSnapper",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],c.prototype,"shortLineThreshold",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],c.prototype,"distance",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],c.prototype,"pointThreshold",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],c.prototype,"intersectionParallelLineThreshold",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],c.prototype,"parallelLineThreshold",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],c.prototype,"touchSensitivityMultiplier",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],c.prototype,"pointOnLineThreshold",void 0),(0,n._)([(0,o.Cb)({type:s.Z,nonNullable:!0})],c.prototype,"orange",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],c.prototype,"lineHintWidthReference",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],c.prototype,"lineHintWidthTarget",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],c.prototype,"lineHintFadedExtensions",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],c.prototype,"parallelLineHintWidth",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],c.prototype,"parallelLineHintLength",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],c.prototype,"parallelLineHintOffset",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],c.prototype,"rightAngleHintSize",void 0),(0,n._)([(0,o.Cb)({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],c.prototype,"rightAngleHintOutlineSize",void 0),c=(0,n._)([(0,a.j)("esri.views.interactive.snapping.Settings.Defaults")],c);const p=new c},95122:(e,t,i)=>{i.d(t,{Bq:()=>u,Hk:()=>c,UL:()=>g,ku:()=>d,yG:()=>h});var n=i(88396),s=i(6394),r=i(76014),o=i(64674),a=i(94163);class l{constructor(e){this.coordinateHelper=e}}class c extends l{constructor(e,t){super(e),this.point=t}objectEqual(e){return e instanceof c&&(0,o.Xv)(this.point,e.point)}check(e){return(0,n.s)(e,this.point)<r.c.pointThreshold}closestTo(){return this.coordinateHelper.clone(this.point)}intersect(e){const t=[];return e instanceof p?t.push(...(0,a.pk)({start:e.start,end:e.end,type:e instanceof d?a.SP.LINE:a.SP.RAY},this.point)):e instanceof g&&t.push(...(0,a.l0)(e.center,e.radius,this.point)),t.map((t=>new u(this.coordinateHelper,t,this,e)))}}class p extends l{constructor(e,t,i){super(e),this.start=t,this.end=i}objectEqual(e){return e instanceof p&&(0,o.Xv)(this.start,e.start)&&(0,o.Xv)(this.end,e.end)}intersect(e){const t=[];return e instanceof c?t.push(...(0,a.pk)({start:this.start,end:this.end,type:this instanceof d?a.SP.LINE:a.SP.RAY},e.point)):e instanceof p?t.push(...(0,a.dU)({start:this.start,end:this.end,type:this instanceof d?a.SP.LINE:a.SP.RAY},{start:e.start,end:e.end,type:e instanceof d?a.SP.LINE:a.SP.RAY})):e instanceof g&&t.push(...(0,a.UG)({start:this.start,end:this.end,type:this instanceof d?a.SP.LINE:a.SP.RAY},e.center,e.radius)),t.map((t=>new u(this.coordinateHelper,t,this,e)))}}class h extends p{constructor(e,t,i){super(e,t,i),this.dir=(0,s.a)(),this.p=(0,s.a)()}objectEqual(e){return e instanceof h&&super.objectEqual(e)}check(e){return(0,n.g)(this.dir,this.end,this.start),(0,n.g)(this.p,e,this.start),(0,n.h)(this.dir,this.p)>=0&&(0,a.Oy)(e,this.start,this.end)<r.c.pointOnLineThreshold}closestTo(e){const t=this.coordinateHelper.clone(e);return(0,a.aW)(t,e,this.start,this.end),t}}class d extends p{constructor(e,t,i){super(e,t,i)}objectEqual(e){return e instanceof d&&super.objectEqual(e)}check(e){return(0,a.Oy)(e,this.start,this.end)<r.c.pointOnLineThreshold}closestTo(e){const t=this.coordinateHelper.clone(e);return(0,a.k0)(t,e,this.start,this.end),t}}class u extends l{constructor(e,t,i,n){super(e),this.intersection=t,this.first=i,this.second=n}objectEqual(e){return e instanceof u&&this.first.objectEqual(e.first)&&this.second.objectEqual(e.second)}check(){return!1}closestTo(e){const t=this.coordinateHelper.clone(e);return(0,n.c)(t,this.intersection),t}intersect(){return[]}}class g extends l{constructor(e,t,i){super(e),this.center=t,this.radius=i}objectEqual(e){return e instanceof g&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}check(){return!1}closestTo(e){const t=this.coordinateHelper.clone(e);return(0,a.xO)(t,e,this.center,this.radius),t}intersect(e){const t=[];return e instanceof p?t.push(...(0,a.UG)({start:e.start,end:e.end,type:e instanceof d?a.SP.LINE:a.SP.RAY},this.center,this.radius)):e instanceof c&&t.push(...(0,a.l0)(this.center,this.radius,e.point)),t.map((t=>new u(this.coordinateHelper,t,this,e)))}}},98173:(e,t,i)=>{i.d(t,{Z:()=>h});var n=i(27366),s=i(85015),r=i(40281),o=i(49861),a=(i(63780),i(93169),i(25243),i(69912)),l=i(22006),c=i(76014);let p=class extends s.Z{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new r.Z,this.distance=c.c.distance,this.touchSensitivityMultiplier=c.c.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};(0,n._)([(0,o.Cb)()],p.prototype,"enabled",void 0),(0,n._)([(0,o.Cb)()],p.prototype,"enabledToggled",void 0),(0,n._)([(0,o.Cb)()],p.prototype,"selfEnabled",void 0),(0,n._)([(0,o.Cb)()],p.prototype,"featureEnabled",void 0),(0,n._)([(0,o.Cb)({type:r.Z.ofType(l.Z)})],p.prototype,"featureSources",void 0),(0,n._)([(0,o.Cb)()],p.prototype,"distance",void 0),(0,n._)([(0,o.Cb)()],p.prototype,"touchSensitivityMultiplier",void 0),(0,n._)([(0,o.Cb)({readOnly:!0})],p.prototype,"effectiveEnabled",null),(0,n._)([(0,o.Cb)({readOnly:!0})],p.prototype,"effectiveSelfEnabled",null),(0,n._)([(0,o.Cb)({readOnly:!0})],p.prototype,"effectiveFeatureEnabled",null),p=(0,n._)([(0,a.j)("esri.views.interactive.snapping.SnappingOptions")],p);const h=p},95905:(e,t,i)=>{i.d(t,{L:()=>a});var n=i(95122),s=i(64674),r=i(75691),o=i(53397);class a extends r.a{constructor(e){super({...e,constraint:new n.ku(e.coordinateHelper,e.edgeStart,e.edgeEnd)})}get hints(){return[new o.w(s.ze.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo)]}}},75691:(e,t,i)=>{i.d(t,{a:()=>s});var n=i(92605);class s extends n.j{constructor(e){let{coordinateHelper:t,targetPoint:i,objectId:n,constraint:s,elevationInfo:r}=e;super(t,i,s,r),this.objectId=n}}},92605:(e,t,i)=>{i.d(t,{j:()=>n});class n{constructor(e,t,i,n){this.coordinateHelper=e,this.targetPoint=t,this.constraint=i,this.elevationInfo=n}}},90609:(e,t,i)=>{i.d(t,{w:()=>r});var n=i(64674),s=i(55054);class r extends s.r{constructor(e,t){super(t),this.intersectionPoint=e}equals(e){return e instanceof r&&(0,n.Xv)(this.intersectionPoint,e.intersectionPoint)}}},53397:(e,t,i)=>{i.d(t,{w:()=>o});i(93169);var n=i(32718),s=i(64674),r=i(55054);n.Z.getLogger("esri.views.interactive.snapping.hints.LineSnappingHint");class o extends r.r{constructor(e,t,i,n){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];super(n),this.type=e,this.lineStart=t,this.lineEnd=i,this.fadeLeft=s,this.fadeRight=r}equals(e){return e instanceof o&&this.type===e.type&&(0,s.Xv)(this.lineStart,e.lineStart)&&(0,s.Xv)(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}}},5916:(e,t,i)=>{i.d(t,{L:()=>o});i(93169);var n=i(32718),s=i(64674),r=i(55054);n.Z.getLogger("esri.views.interactive.snapping.hints.ParallelSnappingHint");class o extends r.r{constructor(e,t,i){super(i),this.lineStart=e,this.lineEnd=t}equals(e){return e instanceof o&&(0,s.Xv)(this.lineStart,e.lineStart)&&(0,s.Xv)(this.lineEnd,e.lineEnd)}}},41216:(e,t,i)=>{i.d(t,{y:()=>o});i(93169);var n=i(32718),s=i(64674),r=i(55054);n.Z.getLogger("esri.views.interactive.snapping.hints.RightAngleSnappingHint");class o extends r.r{constructor(e,t,i,n){super(n),this.previousVertex=e,this.centerVertex=t,this.nextVertex=i}equals(e){return e instanceof o&&(0,s.Xv)(this.previousVertex,e.previousVertex)&&(0,s.Xv)(this.centerVertex,e.centerVertex)&&(0,s.Xv)(this.nextVertex,e.nextVertex)}}},55054:(e,t,i)=>{i.d(t,{r:()=>n});class n{constructor(e){this.elevationInfo=e}}},64674:(e,t,i)=>{i.d(t,{Xv:()=>o,lQ:()=>a,tp:()=>r,ze:()=>n});var n,s=i(88396);function r(e,t){const i=e.x-t.x,n=e.y-t.y;return i*i+n*n}function o(e,t){const i=e.length===t.length&&e[0]===t[0]&&e[1]===t[1];switch(e.length){case 2:return i;case 3:return i&&e[2]===t[2];case 4:return i&&e[3]===t[3]}return!1}function a(e,t){t.sort(((t,i)=>(0,s.s)(t.targetPoint,e)-(0,s.s)(i.targetPoint,e)))}!function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"}(n||(n={}))},11208:(e,t,i)=>{i.d(t,{$r:()=>l,By:()=>h,RS:()=>c,a7:()=>p});var n=i(17842),s=(i(88396),i(11186)),r=i(71353),o=i(7882),a=i(74509);function l(e,t,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,r.c)();const o=t.toXYZ(e);return o[2]=(0,a.zx)(n,o,t.spatialReference,i)||0,n.renderCoordsHelper.toRenderCoords(o,t.spatialReference,s),s}function c(e,t,i,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,r.c)();const l=(0,s.c)(u,e);return l[2]=(0,a.zx)(n,l,t,i)||0,n.renderCoordsHelper.toRenderCoords(l,t,o),o}function p(e,t,i,s){return"2d"===s.type?s.toScreen(t.vectorToPoint(e,d)):(l(e,t,i,s,u),s.state.camera.projectToScreen(u,g),(0,n.vW)(g[0],g[1]))}function h(e,t,i,n,s,r,o){const l=i.toXYZ(e),c=i.toXYZ(t);if("absolute-height"!==n.mode){const e=(0,a.zx)(s,l,i.spatialReference,n),t=(0,a.zx)(s,c,i.spatialReference,n),r=(null==e?t:null==t?e:Math.min(e,t))||0;l[2]=r,c[2]=r}s.renderCoordsHelper.toRenderCoords(l,i.spatialReference,r),s.renderCoordsHelper.toRenderCoords(c,i.spatialReference,o)}const d=new o.Z,u=(0,r.c)(),g=((0,n.J$)(),(0,n.J$)(),(0,n.s1)());(0,n.s1)()},94163:(e,t,i)=>{i.d(t,{Oy:()=>l,SP:()=>n,UG:()=>m,aW:()=>h,dU:()=>y,k0:()=>p,l0:()=>g,pk:()=>u,xO:()=>d});var n,s=i(16889),r=i(88396),o=i(6394);function a(e,t){return e[0]*t[1]-e[1]*t[0]}function l(e,t,i){const n=(t[0]-e[0])*(i[1]-e[1])-(t[1]-e[1])*(i[0]-e[0]);return Math.abs(n)/(0,r.j)(t,i)}function c(e,t,i){const n=(0,r.h)(i,t)/(0,r.u)(i);return(0,r.f)(e,i,n)}function p(e,t,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i;return(0,r.g)(v,n,i),(0,r.g)(b,t,s),c(w,b,v),(0,r.b)(e,s,w)}function h(e,t,i,n){(0,r.g)(v,n,i),(0,r.g)(b,t,i);const s=(0,r.h)(v,b)/(0,r.u)(v);return s>0?(0,r.v)(e,i,v,s):(0,r.c)(e,i)}function d(e,t,i,n){(0,r.g)(v,t,i);const s=n/(0,r.o)(v);return(0,r.v)(e,i,v,s)}function u(e,t){return p(b,t,e.start,e.end),(0,s.W8)(b[0],t[0])&&(0,s.W8)(b[1],t[1])?[(0,o.d)(t)]:[]}function g(e,t,i){return d(b,i,e,t),(0,s.W8)(b[0],i[0])&&(0,s.W8)(b[1],i[1])?[(0,o.d)(i)]:[]}function y(e,t){const i=e.start,s=e.end,o=t.start,l=t.end,c=(0,r.g)(v,s,i),p=(0,r.g)(_,l,o),h=a(c,p);if(Math.abs(h)<=f)return[];const d=(0,r.g)(b,i,o),u=a(p,d)/h,g=a(c,d)/h;if(u>=0){if(g>=0||t.type===n.LINE)return[(0,r.v)(w,i,c,u)]}else if(e.type===n.LINE&&(g>=0||t.type===n.LINE))return[(0,r.v)(w,i,c,u)];return[]}function m(e,t,i){const s=[],o=(0,r.g)(v,e.end,e.start),a=(0,r.g)(_,e.start,t),l=(0,r.u)(o),c=2*(0,r.h)(o,a),p=c*c-4*l*((0,r.u)(a)-i*i);if(0===p){const t=-c/(2*l);(e.type===n.LINE||t>=0)&&s.push((0,r.v)(w,e.start,o,t))}else if(p>0){const t=Math.sqrt(p),i=(-c+t)/(2*l);(e.type===n.LINE||i>=0)&&s.push((0,r.v)(w,e.start,o,i));const a=(-c-t)/(2*l);(e.type===n.LINE||a>=0)&&s.push((0,r.v)(b,e.start,o,a))}return s}!function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"}(n||(n={}));const f=1e-6,v=(0,o.a)(),_=(0,o.a)(),b=(0,o.a)(),w=(0,o.a)()},15067:(e,t,i)=>{i.d(t,{Z:()=>ke});var n=i(27366),s=i(51508),r=i(40281),o=(i(93169),i(10064)),a=i(91505),l=i(100),c=i(32718),p=i(92026),h=i(66978),d=i(94172),u=i(49861),g=(i(63780),i(25243),i(69912)),y=i(79803),m=i(92183),f=i(69662),v=i(92975),_=i(93655),b=i(15404),w=i(77498),E=i(57889),S=i(46684),T=i(74509);var x,C=i(83089),O=i(91806),P=i(87888),I=i(52349),G=i(61920),R=i(41691),M=i(88396),A=i(77427),N=i(71353),V=i(92536),H=i(95122),k=i(64674),U=i(95905),F=i(75691),D=i(92605),L=i(53397),Z=i(41216);class j extends D.j{constructor(e){let{coordinateHelper:t,targetPoint:i,constraint:n,previousVertex:s,otherVertex:r,otherVertexType:o,objectId:a,elevationInfo:l}=e;super(t,i,n,l),this.previousVertex=s,this.otherVertex=r,this.otherVertexType=o,this.objectId=a}get hints(){const e=this.previousVertex,t=this.otherVertexType===x.CENTER?this.otherVertex:this.targetPoint,i=this.otherVertexType===x.CENTER?this.targetPoint:this.otherVertex,n=this.elevationInfo;return[new L.w(k.ze.TARGET,t,i,n),new L.w(k.ze.REFERENCE,e,t,n),new Z.y(this.previousVertex,t,i,n)]}}!function(e){e[e.NEXT=0]="NEXT",e[e.CENTER=1]="CENTER"}(x||(x={}));var z=i(11208);let q=class extends R.r{constructor(e){super(e),this.options=null,this.sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null}}}get updating(){return(0,A.oE)(this.snappingSources,(e=>{let{snappingSource:t}=e;return t.updating}))||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,t=new Map;if((0,p.pC)(this.options)&&(0,p.pC)(this.options.featureSources))for(const i of this.options.featureSources.items){const n=i.layer.uid,s=e.get(n);if(s){e.delete(n),t.set(n,s);continue}if(!i.layer.loaded){this.updatingHandles.addPromise(i.layer.load());continue}const r=this._createSourceInfo(i);(0,p.pC)(r)&&t.set(n,r)}for(const[,i]of e)i.destroy();return t}initialize(){this.updatingHandles.add((()=>this.snappingSources),(()=>this.notifyChange("updating")),d.Z_),(0,p.pC)(this.view)&&this.handles.add([this.view.on("layerview-create",(e=>this._updateLayerView(e.layer,e.layerView))),this.view.on("layerview-destroy",(e=>this._updateLayerView(e.layer,null)))])}_updateLayerView(e,t){for(const[,i]of this.snappingSources)i.snappingSource.layerSource.layer===e&&(i.layerView=t)}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,t,i){if((0,p.Wi)(this.options)||!this.options.effectiveFeatureEnabled)return[];const n=[],s=this._computeScreeenSizeDistanceParameters(e,t),r={distance:s,point:e,coordinateHelper:t.coordinateHelper,types:this.types,filter:null};for(const[,{snappingSource:a,layerView:l}]of this.snappingSources)!a.layerSource.enabled||(0,p.pC)(l)&&l.suspended||n.push(a.fetchCandidates(r,i).then((e=>e.filter((e=>!this._candidateIsExcluded(a,e,t.excludeFeature))))));const o=(await(0,h.WW)(n)).flat();return this._addRightAngleCandidates(o,e,s,t),(0,h.k_)(i),(0,k.lQ)(e,o),o}_addRightAngleCandidates(e,t,i,n){const s=(0,p.pC)(n.vertexHandle)?n.vertexHandle.rightEdge?.rightVertex?.pos:(0,p.pC)(n.editGeometryOperations)&&"polygon"===n.editGeometryOperations.data.type?(0,p.Wg)(n.editGeometryOperations.data.components[0]?.getFirstVertex())?.pos:null,r=(0,p.pC)(n.vertexHandle)?n.vertexHandle.leftEdge?.leftVertex?.pos:(0,p.pC)(n.editGeometryOperations)?(0,p.Wg)(n.editGeometryOperations.data.components[0]?.getLastVertex())?.pos:null,o=e.length;for(let a=0;a<o;a++)this._addRightAngleCandidate(e[a],r,t,i,n,e),this._addRightAngleCandidate(e[a],s,t,i,n,e)}_addRightAngleCandidate(e,t,i,n,s,r){if((0,p.Wi)(t)||!(e instanceof U.L))return;const o=e.constraint.closestTo(t),a=(o[0]-i[0])/n.x,l=(o[1]-i[1])/n.y;if(a*a+l*l<=1){const i=s.coordinateHelper;r.push(new j({coordinateHelper:i,targetPoint:o,otherVertex:t,otherVertexType:x.NEXT,previousVertex:e.constraint.start,constraint:new H.yG(i,t,o),objectId:e.objectId,elevationInfo:e.elevationInfo}))}}_computeScreeenSizeDistanceParameters(e,t){const i=(0,p.pC)(this.options)?this.options.distance*("touch"===t.pointer?this.options.touchSensitivityMultiplier:1):0;if((0,p.Wi)(this.view))return{x:i,y:i,pixelSize:i};if("2d"===this.view.type){const e=i*this.view.resolution;return{x:e,y:e,pixelSize:e}}return this._computeScreenSizeDistanceParameters3D(e,i,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,i,n){const{coordinateHelper:s,elevationInfo:r}=n,o=i.state.camera.computeScreenPixelSizeAt((0,z.$r)(e,s,r,i,B)),a=o*i.renderCoordsHelper.unitInMeters/i.mapCoordsHelper.unitInMeters,l=t*a;return{x:l/this._computeScreenMagnitudeOfMapOffset(e,a,0,i,n),y:l/this._computeScreenMagnitudeOfMapOffset(e,0,a,i,n),pixelSize:o}}_computeScreenMagnitudeOfMapOffset(e,t,i,n,s){let{coordinateHelper:r,elevationInfo:o}=s;const a=r.clone(e);a[0]+=t,a[1]+=i;const l=(0,z.a7)(e,r,o,n),c=(0,z.a7)(a,r,o,n),p=c.x-l.x,h=c.y-l.y;return Math.sqrt(p*p+h*h)}get types(){return V.r.EDGE|V.r.VERTEX}_candidateIsExcluded(e,t,i){if((0,p.Wi)(i))return!1;const n=this._getCandidateObjectId(t);if((0,p.Wi)(n))return!1;const s=e.layerSource.layer;return"graphics"===s.type?i.uid===n:i.sourceLayer===s&&!(!i.attributes||!("objectIdField"in s))&&i.attributes[s.objectIdField]===n}_getCandidateObjectId(e){return e instanceof F.a?e.objectId:null}_createSourceInfo(e){const t=this._createFeatureSnappingSourceType(e);if((0,p.Wi)(t))return null;if("loading"in t)return this.updatingHandles.addPromise(t.loading.then((()=>{this.destroyed||this.notifyChange("snappingSources")}))),null;const i=(0,p.pC)(this.view)?this.view.allLayerViews.find((t=>t.layer===e.layer)):null;return new W(t.source,i)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e)}return null}_createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source.type){case"feature-layer":{const t=this._getSourceModule("featureService");return(0,p.pC)(t.module)?{source:new t.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}case"memory":case"csv":case"geojson":case"wfs":{if("mesh"===e.layer.geometryType)return null;const t=this._getSourceModule("featureCollection");return(0,p.pC)(t.module)?{source:new t.module.FeatureCollectionSnappingSource({layerSource:e})}:{loading:t.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const t=this._getSourceModule("graphics");return(0,p.pC)(t.module)?{source:new t.module.GraphicsSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_getSourceModule(e){const t=this.sourceModules[e];if((0,p.Wi)(t.loader)){const i=this._loadSourceModule(e).then((e=>{t.module=e}));return t.loader=i,{module:t.module,loader:i}}return{module:t.module,loader:t.loader}}_loadSourceModule(e){switch(e){case"featureService":return this.updatingHandles.addPromise(Promise.all([i.e(5652),i.e(4134)]).then(i.bind(i,84134)));case"featureCollection":return this.updatingHandles.addPromise(i.e(2137).then(i.bind(i,26823)));case"graphics":return this.updatingHandles.addPromise(Promise.all([i.e(6901),i.e(8928),i.e(3518)]).then(i.bind(i,33518)))}return null}};(0,n._)([(0,u.Cb)({constructOnly:!0})],q.prototype,"spatialReference",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],q.prototype,"view",void 0),(0,n._)([(0,u.Cb)()],q.prototype,"options",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],q.prototype,"updating",null),(0,n._)([(0,u.Cb)({readOnly:!0})],q.prototype,"snappingSources",null),q=(0,n._)([(0,g.j)("esri.views.interactive.snapping.FeatureSnappingEngine")],q);class W{constructor(e,t){this.snappingSource=e,this.layerView=t,this.handles=new l.Z;const i=this.snappingSource.layerSource.layer;if("refresh"in i){const t=i;this.handles.add(t.on("refresh",(()=>e.refresh())))}this.handles.add([(0,d.YP)((()=>e.updating),(t=>e.layerSource.updating=t),d.tX),(0,d.YP)((()=>e.availability),(t=>e.layerSource.availability=t),d.tX)])}destroy(){this.snappingSource.destroy(),this.handles.destroy()}}const B=(0,N.c)();var Y=i(85015),X=i(6394),J=i(76014);class K{constructor(e,t){this.view=e,this.options=t,this.squaredShortLineThreshold=J.c.shortLineThreshold*J.c.shortLineThreshold}snap(e,t){return(0,p.pC)(t.vertexHandle)?"vertex"!==t.vertexHandle.type?[]:this.snapExistingVertex(e,t):this.snapNewVertex(e,t)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold(e.leftVertex.pos,e.rightVertex.pos,t)}exceedsShortLineThreshold(e,t,i){let{elevationInfo:n,editGeometryOperations:s}=i;const r=s.data.coordinateHelper;return 0===this.squaredShortLineThreshold||(0,k.tp)((0,z.a7)(t,r,n,this.view),(0,z.a7)(e,r,n,this.view))>this.squaredShortLineThreshold}squaredProximityTreshold(e){return"touch"===e?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold}get squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}}class $ extends D.j{constructor(e){let{coordinateHelper:t,lineStart:i,lineEnd:n,targetPoint:s,elevationInfo:r}=e;super(t,s,new H.ku(t,i,n),r),this.referenceLineHint=new L.w(k.ze.REFERENCE_EXTENSION,i,n,r)}get hints(){return[this.referenceLineHint,new L.w(k.ze.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.elevationInfo)]}_lineEndClosestToTarget(){const e=this.constraint.start,t=this.constraint.end;return Math.sign((0,M.h)((0,M.g)(ee,t,e),(0,M.g)(Q,this.targetPoint,e)))>0?t:e}}const Q=(0,X.a)(),ee=(0,X.a)();var te=i(94163);class ie extends K{snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=i.edges.length,s=[];if(n<1)return s;const r=t.coordinateHelper,o=(0,z.a7)(e,r,t.elevationInfo,this.view),a=i.edges[n-1];let l=a;do{this.edgeExceedsShortLineThreshold(l,t)&&this._processCandidateProposal(l.leftVertex.pos,l.rightVertex.pos,e,o,t,s),l=l.leftVertex.leftEdge}while(l&&l!==a);return s}snapExistingVertex(e,t){const i=[],n=(0,p.Wg)(t.vertexHandle),s=n.component;if(s.edges.length<2)return i;const r=t.coordinateHelper,o=(0,z.a7)(e,r,t.elevationInfo,this.view),a=n.leftEdge,l=n.rightEdge;a&&l&&this.edgeExceedsShortLineThreshold(a,t)&&this.edgeExceedsShortLineThreshold(l,t)&&this._processCandidateProposal(a.leftVertex.pos,l.rightVertex.pos,e,o,t,i);const c=s.edges[0];let h=c;do{h!==n.leftEdge&&h!==n.rightEdge&&this.edgeExceedsShortLineThreshold(h,t)&&this._processCandidateProposal(h.leftVertex.pos,h.rightVertex.pos,e,o,t,i),h=h.rightVertex.rightEdge}while(h&&h!==c);return i}_processCandidateProposal(e,t,i,n,s,r){const o=(0,te.k0)((0,X.a)(),i,e,t),{coordinateHelper:a,elevationInfo:l,pointer:c}=s,p=a.fromXYZ(o,a.getZ(i,0));(0,k.tp)(n,(0,z.a7)(p,a,l,this.view))<this.squaredProximityTreshold(c)&&r.push(new $({coordinateHelper:a,lineStart:e,lineEnd:t,targetPoint:p,elevationInfo:l}))}}var ne=i(5916);class se extends D.j{constructor(e){let{coordinateHelper:t,referenceLine:i,lineStart:n,targetPoint:s,elevationInfo:r}=e;const o=t.clone(n);(0,M.g)(o,(0,M.b)(o,o,i.rightVertex.pos),i.leftVertex.pos),super(t,s,new H.ku(t,n,o),r),this._referenceLines=[{edge:i,fadeLeft:!0,fadeRight:!0}]}get hints(){const e=this.elevationInfo;return[new L.w(k.ze.TARGET,this.constraint.start,this.targetPoint,e),new ne.L(this.constraint.start,this.targetPoint,e),...this._referenceLines.map((t=>new L.w(k.ze.REFERENCE,t.edge.leftVertex.pos,t.edge.rightVertex.pos,e,t.fadeLeft,t.fadeRight)))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach((i=>{e.rightVertex.rightEdge===i.edge&&(i.fadeLeft=!1,t.fadeRight=!1),e.leftVertex.leftEdge===i.edge&&(i.fadeRight=!1,t.fadeLeft=!1)})),this._referenceLines.push(t)}}class re extends K{constructor(){super(...arguments),this._tmpProjection=(0,X.a)()}snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=i.edges.length,s=i.vertices.length,r=[];if(n<2)return r;const o=(0,z.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),a=i.vertices[s-1],l=i.vertices[0],c=i.edges[n-1];let p=c;do{this.edgeExceedsShortLineThreshold(p,t)&&(this._checkEdgeForParalleLines(p,a.pos,e,o,t,r),this._checkEdgeForParalleLines(p,l.pos,e,o,t,r)),p=p.leftVertex.leftEdge}while(p&&p!==c);return r}snapExistingVertex(e,t){const i=[],n=(0,p.Wg)(t.vertexHandle),s=n.component;if(s.edges.length<3)return i;const r=(0,z.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),o=n.leftEdge,a=n.rightEdge,l=s.vertices[0],c=s.vertices.length,h=s.vertices[c-1],d=s.edges[0];let u=d;do{u!==o&&u!==a&&this.edgeExceedsShortLineThreshold(u,t)&&(o&&this._checkEdgeForParalleLines(u,o.leftVertex.pos,e,r,t,i),a&&this._checkEdgeForParalleLines(u,a.rightVertex.pos,e,r,t,i),n===l?this._checkEdgeForParalleLines(u,h.pos,e,r,t,i):n===h&&this._checkEdgeForParalleLines(u,l.pos,e,r,t,i)),u=u.rightVertex.rightEdge}while(u&&u!==d);return i}_checkEdgeForParalleLines(e,t,i,n,s,r){const o=e.leftVertex.pos,a=e.rightVertex.pos;if((0,te.k0)(this._tmpProjection,t,o,a),(0,M.s)(this._tmpProjection,t)<J.c.parallelLineThreshold)return;(0,te.k0)(this._tmpProjection,i,o,a,t);const{coordinateHelper:l,elevationInfo:c,pointer:p}=s,h=l.fromXYZ(this._tmpProjection,l.getZ(i,0));if((0,k.tp)(n,(0,z.a7)(h,l,c,this.view))<this.squaredProximityTreshold(p)){if(this._parallelToPreviousCandidate(e,r))return;r.push(new se({coordinateHelper:l,referenceLine:e,lineStart:t,targetPoint:h,elevationInfo:c}))}}_parallelToPreviousCandidate(e,t){const i=e.leftVertex.pos,n=e.rightVertex.pos;for(const s of t)if((0,te.k0)(this._tmpProjection,n,s.constraint.start,s.constraint.end,i),(0,M.s)(this._tmpProjection,n)<J.c.parallelLineThreshold)return s.addReferenceLine(e),!0;return!1}}class oe extends K{constructor(){super(...arguments),this._tmp=(0,X.a)()}snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=i.vertices.length,s=[];if(n<2)return s;const r=(0,z.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),o=i.vertices[n-1];this._checkForSnappingCandidate(s,o.leftEdge,o.pos,e,o.leftEdge.leftVertex.pos,o.pos,t,e,r);const a=i.vertices[0];return this._checkForSnappingCandidate(s,a.rightEdge,a.pos,e,a.rightEdge.rightVertex.pos,a.pos,t,e,r),s}snapExistingVertex(e,t){const i=[],n=(0,p.Wg)(t.vertexHandle),s=n.component,r=s.vertices.length;if(r<3)return i;const o=(0,z.a7)(e,t.coordinateHelper,t.elevationInfo,this.view),a=n.leftEdge,l=n.rightEdge,c=s.vertices[0],h=s.vertices[r-1];if(!a)return this._checkForSnappingCandidate(i,c.rightEdge.rightVertex.rightEdge,c.rightEdge.rightVertex.pos,e,c.rightEdge.rightVertex.rightEdge.rightVertex.pos,c.rightEdge.rightVertex.pos,t,e,o),i;if(!l)return this._checkForSnappingCandidate(i,h.leftEdge.leftVertex.leftEdge,h.leftEdge.leftVertex.pos,e,h.leftEdge.leftVertex.leftEdge.leftVertex.pos,h.leftEdge.leftVertex.pos,t,e,o),i;if(a&&a.leftVertex.leftEdge){const n=a.leftVertex.leftEdge;this._checkForSnappingCandidate(i,n,a.leftVertex.pos,e,n.leftVertex.pos,a.leftVertex.pos,t,e,o)}if(l&&l.rightVertex.rightEdge){const n=l.rightVertex.rightEdge;this._checkForSnappingCandidate(i,n,l.rightVertex.pos,e,n.rightVertex.pos,l.rightVertex.pos,t,e,o)}return i}_checkForSnappingCandidate(e,t,i,n,s,r,o,a,l){if(!this.edgeExceedsShortLineThreshold(t,o))return;(0,M.g)(this._tmp,t.rightVertex.pos,t.leftVertex.pos);const c=(0,X.f)(this._tmp[1],-this._tmp[0]),p=(0,M.h)(c,(0,M.g)(this._tmp,n,i))/(0,M.u)(c),{coordinateHelper:h,elevationInfo:d,pointer:u}=o,g=h.fromXYZ((0,M.v)((0,X.a)(),r,c,p),h.getZ(a,0));(0,k.tp)(l,(0,z.a7)(g,h,d,this.view))<this.squaredProximityTreshold(u)&&e.push(new j({coordinateHelper:h,targetPoint:g,constraint:new H.yG(h,r,(0,M.v)(h.createVector(),r,c,Math.sign(p))),previousVertex:s,otherVertex:r,otherVertexType:x.CENTER,elevationInfo:d}))}}class ae extends D.j{constructor(e){let{coordinateHelper:t,targetPoint:i,point1:n,point2:s,elevationInfo:r}=e;super(t,i,new H.UL(t,(0,M.l)(le,n,s,.5),.5*(0,M.j)(n,s)),r),this.p1=n,this.p2=s}get hints(){const e=this.elevationInfo;return[new L.w(k.ze.REFERENCE,this.targetPoint,this.p1,e),new L.w(k.ze.REFERENCE,this.targetPoint,this.p2,e),new Z.y(this.p1,this.targetPoint,this.p2,e)]}}const le=(0,X.a)();class ce extends K{snapNewVertex(e,t){const i=t.editGeometryOperations.data.components[0],n=[],s=i.vertices.length;if("polygon"!==t.editGeometryOperations.data.type||s<2)return n;const r=i.vertices[0],o=i.vertices[s-1];return this._processCandidateProposal(r.pos,o.pos,e,t,n),n}snapExistingVertex(e,t){const i=[],n=(0,p.Wg)(t.vertexHandle),s=n.component;return s.edges.length<2?i:"polyline"!==t.editGeometryOperations.data.type||0!==n.index&&n.index!==s.vertices.length-1?(this._processCandidateProposal(n.leftEdge.leftVertex.pos,n.rightEdge.rightVertex.pos,e,t,i),i):i}_processCandidateProposal(e,t,i,n,s){if(!this.exceedsShortLineThreshold(e,t,n))return;const r=(0,M.l)((0,X.a)(),e,t,.5),o=.5*(0,M.j)(e,t),a=(0,te.xO)((0,X.a)(),i,r,o),{coordinateHelper:l,elevationInfo:c,pointer:p}=n,h=l.fromXYZ(a,l.getZ(i,0)),d=(0,z.a7)(i,l,c,this.view);(0,k.tp)(d,(0,z.a7)(h,l,c,this.view))<this.squaredProximityTreshold(p)&&s.push(new ae({coordinateHelper:l,targetPoint:h,point1:e,point2:t,elevationInfo:c}))}}let pe=class extends Y.Z{constructor(e){super(e),this.updating=!1,this._snappers=new r.Z}initialize(){this._snappers.push(new re(this.view,this.options),new ie(this.view,this.options),new oe(this.view,this.options),new ce(this.view,this.options))}set options(e){this._set("options",e);for(const t of this._snappers)t.options=e}async fetchCandidates(e,t){if(!this.options.effectiveSelfEnabled)return[];const i=[];for(const n of this._snappers.items)i.push(...n.snap(e,t));return(0,k.lQ)(e,i),i}};function he(e,t){return[new pe({view:e,options:t}),new q({view:e,options:t,spatialReference:e.spatialReference})]}(0,n._)([(0,u.Cb)({readOnly:!0})],pe.prototype,"updating",void 0),(0,n._)([(0,u.Cb)({constructOnly:!0})],pe.prototype,"view",void 0),(0,n._)([(0,u.Cb)()],pe.prototype,"options",null),pe=(0,n._)([(0,g.j)("esri.views.interactive.snapping.SelfSnappingEngine")],pe);var de=i(98173),ue=i(90609);class ge extends D.j{constructor(e,t,i,n,s){super(e,t,new H.Bq(e,t,i.constraint,n.constraint),s),this.first=i,this.second=n}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new ue.w(this.targetPoint,this.elevationInfo)]}}let ye=class extends(a.Z.EventedMixin(R.r)){constructor(e){super(e),this.options=new de.Z,this.snappingEnginesFactory=he,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[]}initialize(){this.handles.add([(0,d.YP)((()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:i,distance:n}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:i,distance:n}}),(()=>{this.doneSnapping(),this.emit("changed")}),d.Z_),(0,d.YP)((()=>this.options),(e=>{for(const t of this._engines)t.options=e}),d.Z_),(0,d.YP)((()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory})),(e=>{let{viewReady:t,snappingEnginesFactory:i}=e;return this._recreateEngines(t,i)}),d.tX)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some((e=>e.updating))}_recreateEngines(e,t){if(this._destroyEngines(),!e)return;const{view:i,options:n}=this;this._engines=t(i,n)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,i=e*t;return i*i}async snap(e,t,i){const n=t.coordinateHelper.pointToVector(e),s=await this._fetchCandidates(n,t,i);return{get valid(){return!(0,h.Hc)(i)},apply:()=>{const{snappedPoint:e,hints:i}=this._processCandidates(n,s,t);return this._removeVisualization(),(0,p.pC)(t.visualizer)&&this.handles.add(t.visualizer.draw(i,{coordinateHelper:t.coordinateHelper,elevationInfo:t.elevationInfo,view:this.view}),me),e}}}update(e,t){this._removeVisualization();let i=e;const n=[];if((0,p.pC)(this._currentMainCandidate)){const s=t.coordinateHelper,r=s.pointToVector(e),o=this._currentMainCandidate.constraint.closestTo(r);if((0,k.tp)((0,z.a7)(r,s,t.elevationInfo,this.view),(0,z.a7)(o,s,t.elevationInfo,this.view))<this._squaredPointProximityThreshold(t.pointer)){i=s.vectorToDehydratedPoint(o),this._currentMainCandidate.targetPoint=o,n.push(...this._currentMainCandidate.hints);for(const e of this._currentOtherActiveCandidates)e.targetPoint=o,n.push(...e.hints)}else this._currentMainCandidate=null,this._currentOtherActiveCandidates=[]}return(0,p.pC)(t.visualizer)&&this.handles.add(t.visualizer.draw(n,{coordinateHelper:t.coordinateHelper,elevationInfo:t.elevationInfo,view:this.view}),me),i}doneSnapping(){this._removeVisualization(),this._currentMainCandidate=null,this._currentOtherActiveCandidates=[]}_removeVisualization(){this.handles.remove(me)}async _fetchCandidates(e,t,i){return(await Promise.all(this._engines.map((n=>n.fetchCandidates(e,t,i))))).flat()}_processCandidates(e,t,i){if(t.length<1)return this.doneSnapping(),{snappedPoint:i.coordinateHelper.vectorToDehydratedPoint(e),hints:[]};(0,k.lQ)(e,t);const n=this._currentMainCandidate;if((0,p.pC)(n)){const s=this._findOldConstraintInNewCandidates(n,t);if(s>=0){if(!(t[s]instanceof ge))return this._intersectWithOtherCandidates(s,t,e,i);if((0,M.s)(e,n.targetPoint)<this._squaredPointProximityThreshold(i.pointer))return this._updateSnappingCandidate(n,t,i)}}return this._intersectWithOtherCandidates(0,t,e,i)}_findOldConstraintInNewCandidates(e,t){return e instanceof ge?this._findOldCandidateIndex(t,e.first)>=0&&this._findOldCandidateIndex(t,e.second)>=0?0:-1:this._findOldCandidateIndex(t,e)}_intersectWithOtherCandidates(e,t,i,n){const s=t[e],r=[],o=n.coordinateHelper;for(let a=0;a<t.length;++a){if(a===e)continue;const l=t[a];for(const e of s.constraint.intersect(l.constraint)){const t=o.fromXYZ(e.intersection,s.targetPoint[2]);r.push([new ge(o,t,s,l,l.elevationInfo),(0,k.tp)((0,z.a7)(i,n.coordinateHelper,n.elevationInfo,this.view),(0,z.a7)(t,n.coordinateHelper,n.elevationInfo,this.view))])}}return r.length>0&&(r.sort(((e,t)=>e[1]-t[1])),r[0][1]<this._squaredPointProximityThreshold(n.pointer))?this._updateSnappingCandidate(r[0][0],t,n):this._updateSnappingCandidate(s,t,n)}_updateSnappingCandidate(e,t,i){this.doneSnapping(),this._currentMainCandidate=e;const n=this._currentMainCandidate.targetPoint,s=[];s.push(...e.hints);for(const r of t){if(e instanceof ge){if(r.constraint.objectEqual(e.first.constraint)||r.constraint.objectEqual(e.second.constraint))continue}else if(r.constraint.objectEqual(e.constraint))continue;r.constraint.check(n)&&(r.targetPoint=n,this._currentOtherActiveCandidates.push(r),s.push(...r.hints))}return{snappedPoint:i.coordinateHelper.vectorToDehydratedPoint(n),hints:s}}_squaredPointProximityThreshold(e){return"touch"===e?this.squaredTouchProximityThreshold:this.squaredMouseProximityTreshold}_findOldCandidateIndex(e,t){let i=-1;for(let n=0;n<e.length;++n)if(t.constraint.objectEqual(e[n].constraint)){i=n;break}return i}get test(){return{visualizationsActive:this.handles.has(me),engines:this._engines}}};(0,n._)([(0,u.Cb)({constructOnly:!0})],ye.prototype,"view",void 0),(0,n._)([(0,u.Cb)()],ye.prototype,"options",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],ye.prototype,"updating",null),(0,n._)([(0,u.Cb)()],ye.prototype,"snappingEnginesFactory",void 0),(0,n._)([(0,u.Cb)()],ye.prototype,"_engines",void 0),(0,n._)([(0,u.Cb)()],ye.prototype,"squaredMouseProximityTreshold",null),(0,n._)([(0,u.Cb)()],ye.prototype,"squaredTouchProximityThreshold",null),ye=(0,n._)([(0,g.j)("esri.views.interactive.snapping.SnappingManager")],ye);const me="visualization-handle";function fe(e){return(0,p.pC)(e)&&"graphic"===e.type}var ve=i(72612),_e=i(41644);let be=class extends a.Z.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:(0,_e.Bg)(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent.reset()}refreshComponent(){const e=this.activeComponent;e&&("box"!==e.type&&"reshape"!==e.type&&"graphic-mover"!==e.type||e.refresh())}set undo(e){this._set("undo",(()=>{this.canUndo()&&e()}))}set redo(e){this._set("redo",(()=>{this.canRedo()&&e()}))}};(0,n._)([(0,u.Cb)()],be.prototype,"activeComponent",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"cancelled",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"history",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"tool",null),(0,n._)([(0,u.Cb)()],be.prototype,"type",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"canUndo",null),(0,n._)([(0,u.Cb)()],be.prototype,"canRedo",null),(0,n._)([(0,u.Cb)()],be.prototype,"onEnd",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"undo",null),(0,n._)([(0,u.Cb)()],be.prototype,"redo",null),(0,n._)([(0,u.Cb)()],be.prototype,"toggleTool",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"addToSelection",void 0),(0,n._)([(0,u.Cb)()],be.prototype,"removeFromSelection",void 0),be=(0,n._)([(0,g.j)("esri.widgets.Sketch.support.OperationHandle")],be);let we=class extends be{};(0,n._)([(0,u.Cb)()],we.prototype,"activeComponent",void 0),we=(0,n._)([(0,g.j)("esri.widgets.Sketch.support.CreateOperationHandle")],we);let Ee=class extends be{constructor(e){super(e)}};(0,n._)([(0,u.Cb)()],Ee.prototype,"activeComponent",void 0),Ee=(0,n._)([(0,g.j)("esri.widgets.Sketch.support.UpdateOperationHandle")],Ee);var Se=i(16072),Te=i(61459),xe=i(16851);const Ce="esri.widgets.Sketch.SketchViewModel",Oe=c.Z.getLogger(Ce),Pe={defaultZ:0},Ie={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};let Ge=class extends a.Z.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._handles=new l.Z,this._internalGraphicsLayer=new _.Z({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandles=new l.Z,this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new I.Z,this.layer=null,this.pointSymbol=new Se.Z({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new Te.Z({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new xe.Z({color:[130,130,130,1],width:2}),this._snappingManager=null,this.tooltipOptions=new G.Z,this.updateGraphics=new r.Z,this.updateOnGraphicClick=!0,this.updatePointSymbol=new Se.Z({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}}),this.updatePolygonSymbol=new Te.Z({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}}),this.updatePolylineSymbol=new xe.Z({color:[12,207,255],width:2}),this.vertexSymbol=new Se.Z({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalAutoOpenEnabled=null,this.defaultCreateOptions=Pe,this.defaultUpdateOptions=Ie,this.snappingOptions=new de.Z}initialize(){this._handles.add([(0,d.on)((()=>this.view?.map?.layers),"change",(e=>{e.removed.includes(this.layer)&&this.cancel()})),(0,d.on)((()=>this.layer?.graphics),"change",(e=>{if((0,p.pC)(this._operationHandle))for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())})),(0,d.YP)((()=>this.layer?.elevationInfo??null),(e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)}),d.tX),(0,d.YP)((()=>this.view),(e=>{(0,p.SC)(this._snappingManager),e&&(this._snappingManager=new ye({view:e,options:this.snappingOptions}),"2d"===e.type?Promise.all([i.e(9058),i.e(5652),i.e(5710),i.e(1129),i.e(8431),i.e(1283)]).then(i.bind(i,51283)):"3d"===e.type&&(Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(5957),i.e(1129),i.e(5269),i.e(8431),i.e(4567),i.e(2110),i.e(1883),i.e(1859),i.e(3567)]).then(i.bind(i,73567)),Promise.all([i.e(1378),i.e(2029),i.e(5652),i.e(5158),i.e(5957),i.e(5269),i.e(4567),i.e(1883),i.e(493),i.e(1859),i.e(6099),i.e(7648),i.e(5022)]).then(i.bind(i,35022))))}),d.tX),(0,d.YP)((()=>this.view?.spatialReference),((e,t)=>{e&&t&&!e.equals(t)&&this.cancel()}))])}destroy(){this.cancel(),this._handles=(0,p.SC)(this._handles),this._viewHandles=(0,p.SC)(this._viewHandles),this._removeDefaultLayer(),this._snappingManager=(0,p.SC)(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){return"3d"===this.view.type?"move":"transform"}get updating(){return this._numUpdating>0}get activeTool(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}get activeComponent(){return this._operationHandle?this._operationHandle.activeComponent:null}get createGraphic(){return!(0,p.pC)(this.activeComponent)||"draw-3d"!==this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):(0,p.Wg)(this.activeComponent.graphic)}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...Pe,...e})}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...Ie,...e,reshapeOptions:{...Ie.reshapeOptions,...e?.reshapeOptions}})}set snappingOptions(e){(0,p.pC)(this._snappingManager)&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){const e=!(!this.view?.ready||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:e,map:i}=t;e&&(t.cursor=null),i&&i.remove(this._internalGraphicsLayer),this._viewHandles.removeAll(),this.cancel()}const i="view-ready";this._handles.remove(i),e&&this._handles.add((0,d.gx)((()=>e.ready),(t=>{this._viewHandles.removeAll(),t&&this._viewHandles.add(this._generateViewHandles(e))}),d.tX),i),this._set("view",e)}cancel(){this._moduleLoaderAbortController=(0,p.IM)(this._moduleLoaderAbortController),this._viewReadyAbortController=(0,p.IM)(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if("active"===e&&t.length){const{activeTool:e,layer:i}=this,n=t.toArray();i.removeMany(n),this.cancel(),this._emitDeleteEvent({graphics:n,tool:e})}}async create(e,t){if(this.cancel(),await this._waitViewReady(),"disabled"===this.state)throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),(0,h.zE)();if((0,p.pC)(this.view.activeTool)&&(this.view.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");(0,C.p)(this.view,this._internalGraphicsLayer);const i=await this._setupCreateOperation(e,t);if((0,p.Wi)(i)||this.destroyed)return void this.view.map.remove(this._internalGraphicsLayer);i.on("complete",(()=>{if(i===this._operationHandle){const t=this.createGraphic,n=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),i.cancelled||null==t||this.layer.add(t),this.emit("create",{graphic:t,state:n?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}})),this._operationHandle=i,this.view.ready&&(0,b.t)(this.view)&&this.view.focus()}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:i,view:n,state:s}=this;if("disabled"===s)throw n||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),i||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),(0,h.zE)();(0,p.pC)(this.view.activeTool)&&(this.view.activeTool=null);const r=Array.isArray(e)?e:[e];if(null==e||!r||!r.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(r.some((e=>e.layer!==i?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):!!(0,p.Wi)(e.geometry)&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0))))return;const o=await this._setupUpdateOperation(r,t);this.destroyed||(0,p.Wi)(o)||He(o)||((0,C.p)(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(o,t),this.emit("update",{graphics:r,state:"start",aborted:!1,tool:o.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const t of e)(0,p.pC)(t.geometry)&&"mesh"!==t.geometry.type&&!(0,v.fS)(t.geometry.spatialReference,this.view.spatialReference)&&((0,y.Up)(t.geometry.spatialReference,this.view.spatialReference)||(0,y.kR)()||await(0,y.zD)(),t.geometry=(0,y.iV)(t.geometry,this.view.spatialReference));this._endAsyncOperation()}undo(){this.canUndo()&&this._operationHandle.undo()}redo(){this.canRedo()&&this._operationHandle.redo()}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const t=this.view;if("2d"===t.type){const t=[];this.view.map.allLayers.forEach((e=>{"vector-tile"!==e.type&&"imagery"!==e.type||t.push(e)}));return function(e){return e.find(fe)??null}((await this.view.hitTest(e,{exclude:t})).results)}const i=[this.view.map.ground];t.map.allLayers.forEach((e=>{"integrated-mesh"===e.type&&i.push(e)}));const n=await t.hitTest(e,{exclude:i});if(n.results.length>0){const e=n.results[0];if((0,p.pC)(e)&&"graphic"===e.type&&e.graphic&&(!n.ground.mapPoint||t.map.ground.opacity<1||n.ground.distance-(0,p.Pt)(e.distance,0)>-Math.min(3*n.ground.distance,"global"===t.viewingMode?(0,m.Iu)(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return e}return null}_generateViewHandles(e){return[e.on("immediate-click",(async t=>{const i="active"===this.state&&"create"===this._operationHandle.type;if("disabled"===this.state||i||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const n=await t.async((()=>this._getFirstHit((0,ve.vT)(t))));let s=null;if((0,p.pC)(n)){const i=n.graphic;this.updateGraphics.includes(i)||i.layer===this.layer?(t.stopPropagation(),s=i):"2d"!==e.type||this._isComponentGraphic(i)||"active"!==this.state||this.cancel()}else"active"===this.state&&this.cancel();(0,p.pC)(s)&&!this.updateGraphics.includes(s)&&await this.update([s],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()}),O.f.WIDGET)]}async _setupCreateOperation(e,t){const i={hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...t},n=await this._setupDrawGraphicTool(e,this.view,i);return(0,p.Wi)(n)?null:(this.view.tools.add(n),this.view.activeTool=n,this._setupCreateOperationHandle(n))}async _setupDrawGraphicTool(e,t,i){if("multipoint"===e&&"3d"===t.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;const n="rectangle"!==e,s="rectangle"!==e;this.snappingOptions.enabledToggled=!1;const r={view:t,mode:"rectangle"===e||"circle"===e?"hybrid":"click",...i,snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:s,centered:n};return"2d"===this.view.type?this._makeDrawGraphicTool2D(r):this._makeDrawGraphicTool3D(r)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(Promise.all([i.e(9058),i.e(5652),i.e(5710),i.e(1129),i.e(8431),i.e(1283)]).then(i.bind(i,51283)));return He(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Re(e.geometryType)?this.activeFillSymbol:null})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(5957),i.e(1129),i.e(5269),i.e(8431),i.e(4567),i.e(2110),i.e(1883),i.e(1859),i.e(3567)]).then(i.bind(i,73567)));if(He(t)||this.destroyed)return null;const{elevationInfo:n}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:n,snapToScene:!(0,p.pC)(n)||"absolute-height"===n.mode,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(e){let t=null;const i=e.forceUniformSize,n=e.centered,s=[this.view.on("key-down",(t=>{if(t.key===P.j.pan)t.stopPropagation(),t.repeat||(e.enabled=!1);else if(t.key===P.j.complete)t.stopPropagation(),e.completeCreateOperation();else if(t.key!==P.j.vertexAdd||t.repeat)t.key===P.j.undo?(t.stopPropagation(),r.undo()):t.key===P.j.redo?(t.stopPropagation(),r.redo()):t.key!==P.j.snappingToggle||"rectangle"===e.geometryType||"circle"===e.geometryType||t.repeat?t.key!==P.j.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType||t.repeat?t.key===P.j.center&&(t.repeat||(e.centered=!n,t.stopPropagation())):(e.forceUniformSize=!i,t.stopPropagation()):(this.snappingOptions.enabledToggled=!0,t.stopPropagation());else{const i=e.drawOperation.geometryType;"polyline"!==i&&"polygon"!==i&&"multipoint"!==i||(t.stopPropagation(),e.drawOperation.commitStagedVertex())}}),O.f.WIDGET),this.view.on("key-up",(t=>{t.key===P.j.pan?e.enabled=!0:t.key===P.j.snappingToggle&&"rectangle"!==e.geometryType&&"circle"!==e.geometryType?(this.snappingOptions.enabledToggled=!1,t.stopPropagation()):t.key!==P.j.constraint||"rectangle"!==e.geometryType&&"circle"!==e.geometryType?t.key===P.j.center&&(e.centered=n,t.stopPropagation()):(e.forceUniformSize=i,t.stopPropagation())}),O.f.WIDGET),e.on("vertex-add",(i=>{switch(t=(0,p.Wi)(t)?"start":"active",i.operation){case"apply":this.emit("create",{graphic:(0,p.Wg)(e.graphic),state:t,tool:this.activeTool,toolEventInfo:i,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[(0,p.Wg)(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[(0,p.Wg)(e.graphic)],tool:e.geometryType})}})),e.on("cursor-update",(t=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:(0,p.Wg)(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:t.vertices[0].coordinates,type:"cursor-update"},type:"create"})})),e.on("vertex-remove",(t=>{switch(t.operation){case"apply":this.emit("create",{graphic:(0,p.Wg)(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:t,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[(0,p.Wg)(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[(0,p.Wg)(e.graphic)],tool:e.geometryType})}})),e.on("complete",(e=>{this._set("createGraphic",(0,p.Wg)(e.graphic)),t="complete",e.aborted?r&&r.cancel():r&&r.complete()})),(0,d.YP)((()=>this._getGraphicSymbolFromTool(e.geometryType)),(t=>{e.graphicSymbol=t}))],r=new be({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{s.forEach((e=>e.remove())),s.length=0,this.view.tools?.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return r}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;default:return null}}async _setupUpdateOperation(e,t){const{layer:i,view:n}=this,s={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t?.reshapeOptions}};let r=s.tool;for(const o of e)i.remove(o),i.add(o);if("3d"===n.type){if(0===e.length)return null;switch(r){case"move":return this._setupMove3DOperation(e,s,n,r);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const t=(0,S.P)(e[0]);return t===w.e.SUPPORTED?this._setupReshape3DOperation(e[0],s,n):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${(0,w.Z)(t)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,s,n)}}switch(r){case"move":return this._setupMove2DOperation(e,s,n);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const t=(0,S.P)(e[0]);return t===w.e.SUPPORTED?this._setupTransformOrReshape2DOperation(e,r,s,n):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${(0,w.Z)(t)}).`),null)}case"transform":if(1===e.length){const t=(0,p.U2)(e[0].geometry,"type");"point"!==t&&"multipoint"!==t||(r="reshape")}return this._setupTransformOrReshape2DOperation(e,r,s,n)}}async _setupMove3DOperation(e,t,n,s){let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];for(const i of e){const e=(0,E.P)(i);if(e!==w.e.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${(0,w.Z)(e)}).`),null}const o=await this._requireModule(Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(5957),i.e(1129),i.e(5269),i.e(8431),i.e(4567),i.e(2110),i.e(1883),i.e(1859),i.e(3567)]).then(i.bind(i,73567)));if(He(o))return o;const a=new o.module.GraphicMoveTool({view:n,enableZ:t.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(a),a.graphics.addMany(e),r||this.updateGraphics.addMany(e);const l=[],c=new Ee({activeComponent:a,tool:s,type:"update",onEnd:()=>{l.forEach((e=>e.remove())),l.length=0,this.view.tools?.remove(a),a.destroyed||a.destroy()},undo:()=>{Me(c,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},redo:()=>{Ae(c,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:e=>{this.updateGraphics.push(e),a.graphics.push(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);c.history.undo.forEach((e=>e.updates.splice(t,1))),c.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0!==this.updateGraphics.length?a.graphics.remove(e):c.complete()},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;if("transform"!==s)return;const e=this.updateGraphics.getItemAt(0);if((0,S.P)(e)!==w.e.SUPPORTED)return;const i=await this._setupReshape3DOperation(e,t,n,!0);He(i)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(i,t))}});return l.push(...this._getHandlesForComponent(c,t),this.view.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(c,e,t)),O.f.WIDGET),n.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(c,e),e.key===P.j.snappingToggle&&(this.snappingOptions.enabledToggled=!0,e.stopPropagation())}),O.f.WIDGET),n.on("key-up",(e=>{e.key===P.j.snappingToggle&&(this.snappingOptions.enabledToggled=!1,e.stopPropagation())}),O.f.WIDGET)),c}_setupGraphicTransform3DOperation(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(1===e.length&&function(e){if("graphics"!==e.layer?.type)return w.e.GRAPHICS_LAYER_MISSING;if((0,p.Wi)(e.geometry))return w.e.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return w.e.SUPPORTED;default:return w.e.GEOMETRY_TYPE_UNSUPPORTED}const t=(0,p.pC)(e.symbol)&&"point-3d"===e.symbol.type&&e.symbol.symbolLayers;return t&&t.length>0&&t.some((e=>"object"===e.type))?"on-the-ground"!==(0,T.vu)(e)&&(0,T.Lt)(e)?w.e.ELEVATION_MODE_UNSUPPORTED:w.e.SUPPORTED:w.e.SYMBOL_TYPE_UNSUPPORTED}(e[0])===w.e.SUPPORTED){const s=e[0],r=s.geometry;if((0,p.pC)(r)&&("point"===r.type||"mesh"===r.type))return this._setupPointTransform3DOperation(s,t,i);if((0,p.pC)(r)&&("polygon"===r.type||"polyline"===r.type))return this._setupPolyTransform3DOperation(s,t,i,n)}return this._setupMove3DOperation(e,t,i,"transform",n)}async _setupPointTransform3DOperation(e,t,n){const s="transform",{enableRotation:r,enableScaling:o,enableZ:a}=t,l=await this._requireModule(Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(5957),i.e(1129),i.e(5269),i.e(8431),i.e(4567),i.e(2110),i.e(1883),i.e(1859),i.e(3567)]).then(i.bind(i,73567)));if(He(l))return l;const c=new l.module.GraphicTransformTool({graphic:e,view:n,enableRotation:r,enableScaling:o,enableZ:a,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(c),this.updateGraphics.add(e);const p=[],h=new Ee({activeComponent:c,tool:s,type:"update",onEnd:()=>{p.forEach((e=>e.remove())),p.length=0,this.view.tools?.remove(c),c.destroyed||c.destroy()},undo:()=>{Me(h,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},redo:()=>{Ae(h,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"});const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);He(i)||(h.onEnd(),h.destroy(),this._setUpdateOperationHandle(i,t))},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),h.complete()},toggleTool:()=>{}});return p.push(...this._getHandlesForComponent(h,t),this.view.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(h,e,t)),O.f.WIDGET),n.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(h,e),e.key===P.j.snappingToggle&&(this.snappingOptions.enabledToggled=!0,e.stopPropagation())}),O.f.WIDGET),n.on("key-up",(e=>{e.key===P.j.snappingToggle&&(this.snappingOptions.enabledToggled=!1,e.stopPropagation())}),O.f.WIDGET)),h}async _setupPolyTransform3DOperation(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r="transform",{enableRotation:o,enableScaling:a,enableZ:l,preserveAspectRatio:c}=t,p=await this._requireModule(Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(5957),i.e(1129),i.e(5269),i.e(8431),i.e(4567),i.e(2110),i.e(1883),i.e(1859),i.e(3567)]).then(i.bind(i,73567)));if(He(p))return p;const h=new p.module.ExtentTransformTool({graphic:e,view:n,enableRotation:o,enableScaling:a,enableZ:l,preserveAspectRatio:c,tooltipOptions:this.tooltipOptions});this.view.tools.add(h),s||this.updateGraphics.add(e);const d=[],u=new Ee({activeComponent:h,tool:r,type:"update",onEnd:()=>{d.forEach((e=>e.remove())),d.length=0,this.view.tools?.remove(h),h.destroyed||h.destroy()},canUndo:()=>h.canUndo,undo:()=>{h.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},canRedo:()=>h.canRedo,redo:()=>{h.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"});const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);He(i)||(u.onEnd(),u.destroy(),this._setUpdateOperationHandle(i,t))},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),u.complete()},toggleTool:async()=>{if(1!==this.updateGraphics.length||!1===t.toggleToolOnClick)return;const e=this.updateGraphics.getItemAt(0);if((0,S.P)(e)!==w.e.SUPPORTED)return;const i=await this._setupReshape3DOperation(e,t,n,!0);He(i)||(u.onEnd(),u.destroy(),this._setUpdateOperationHandle(i,t))}});return d.push(...this._getHandlesForComponent(u,t),this.view.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(u,e,t)),O.f.WIDGET),this.view.on("key-down",(e=>this._getCommonUpdateOperationKeyDownHandlers(u,e)),O.f.WIDGET),this.view.on("key-down",(e=>{e.key!==P.j.constraint||e.repeat||(h.preserveAspectRatio=!h.preserveAspectRatio,e.stopPropagation())}),O.f.WIDGET),this.view.on("key-up",(e=>{e.key===P.j.constraint&&(h.preserveAspectRatio=!h.preserveAspectRatio,e.stopPropagation())}),O.f.WIDGET)),u}async _setupMove2DOperation(e,t,i){const n="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=await this._getGraphicMover(e,t,i);if(He(s))return s;const r=new Ee({activeComponent:s,tool:n,type:"update",onEnd:()=>{this._displayDefaultCursor(),l.forEach((e=>e.remove())),a.forEach((e=>e.remove())),l=[],a=[],s.destroy(),this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const e=this.updateGraphics.toArray();Me(r,e),r.refreshComponent(),this._emitUndoEvent({graphics:e,tool:n})},redo:()=>{const e=this.updateGraphics.toArray();Ae(r,e),r.refreshComponent(),this._emitRedoEvent({graphics:e,tool:n})},addToSelection:async e=>{await this._updateSpatialReference(e),this.updateGraphics.push(e),s.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:e=>{const t=this.updateGraphics.indexOf(e);r.history.undo.forEach((e=>e.updates.splice(t,1))),r.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const i=this.updateGraphics.toArray();this.emit("update",{graphics:i,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),0!==this.updateGraphics.length?s.graphics=i:r.complete()}});let o=!1,a=[i.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(r,e,t)),O.f.WIDGET),i.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(r,e),e.key!==P.j.constraint||e.repeat||(o=!0,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)}),O.f.WIDGET),i.on("key-up",(e=>{e.key===P.j.constraint&&o&&(o=!1,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)}),O.f.WIDGET)],l=this._getHandlesForComponent(r,t);return r}async _setupReshape3DOperation(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r="reshape",o=await this._requireModule(Promise.all([i.e(1378),i.e(2029),i.e(9058),i.e(5652),i.e(5158),i.e(5710),i.e(5957),i.e(1129),i.e(5269),i.e(8431),i.e(4567),i.e(2110),i.e(1883),i.e(1859),i.e(3567)]).then(i.bind(i,73567)));if(He(o))return o;this.snappingOptions.enabledToggled=!1;const a=new o.module.GraphicReshapeTool({view:n,graphic:e,enableZVertex:t.enableZ&&"move"===t.reshapeOptions.vertexOperation,enableZShape:t.enableZ&&"move"===t.reshapeOptions.shapeOperation,enableMoveGraphic:"move"===t.reshapeOptions.shapeOperation||"move-xy"===t.reshapeOptions.shapeOperation,enableMidpoints:"split"===t.reshapeOptions.edgeOperation,enableEdgeOffset:"offset"===t.reshapeOptions.edgeOperation,snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});n.tools.add(a),s||this.updateGraphics.add(e);const l=[],c=new Ee({activeComponent:a,tool:r,type:"update",onEnd:()=>{l.forEach((e=>e.remove())),l.length=0,this.view.tools?.remove(a),a.destroyed||a.destroy()},canUndo:()=>a.canUndo,undo:()=>{a.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},canRedo:()=>a.canRedo,redo:()=>{a.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async e=>{this.updateGraphics.add(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"});const i=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);He(i)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(i,t))},removeFromSelection:e=>{this.updateGraphics.remove(e),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"}),c.complete()},toggleTool:async()=>{if(!1===t.toggleToolOnClick)return;const e=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,n,!0);He(e)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(e,t))}});return l.push(...this._getHandlesForComponent(c,t),n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(c,e,t)),O.f.WIDGET),n.on("key-down",(e=>{this._getCommonUpdateOperationKeyDownHandlers(c,e),e.key===P.j.snappingToggle&&(this.snappingOptions.enabledToggled=!0,e.stopPropagation())}),O.f.WIDGET),n.on("key-up",(e=>{e.key===P.j.snappingToggle&&(this.snappingOptions.enabledToggled=!1,e.stopPropagation())}),O.f.WIDGET)),c}async _setupTransformOrReshape2DOperation(e,t,i,n){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s="transform"===t?await this._getBox(e,i,n):await this._getReshape(e,i,n);if(He(s))return s;const r=new Ee({activeComponent:s,type:"update",onEnd:()=>{a.forEach((e=>e.remove())),o.forEach((e=>e.remove())),a=[],o=[],r.activeComponent&&!r.activeComponent.destroyed&&r.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{Me(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},redo:()=>{Ae(r,this.updateGraphics.toArray()),r.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r.tool})},addToSelection:async e=>{let t=r.activeComponent;if("reshape"===t.type){const t=[...this.updateGraphics,e];this.updateGraphics.removeAll();const s=await this._setupMove2DOperation(t,i,n);if(He(s))return;r.onEnd(),r.destroy(),this._setUpdateOperationHandle(s,i)}else this.updateGraphics.add(e),t.graphics=this.updateGraphics.toArray(),t.refresh(),r.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[e],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async e=>{const t=this.updateGraphics.indexOf(e);r.history.undo.forEach((e=>e.updates.splice(t,1))),r.history.redo.forEach((e=>e.updates.splice(t,1))),this.updateGraphics.remove(e);const i=this.updateGraphics.toArray();if(0===i.length)r.complete();else{const e=i[0].geometry;1!==i.length||!(0,p.pC)(e)||"point"!==e.type&&"multipoint"!==e.type?r.activeComponent.graphics=i:r.toggleTool()}this.emit("update",{graphics:i,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[e],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const e=this.updateGraphics.getItemAt(0),t=e.geometry;if((0,p.pC)(t)&&("reshape"===r.tool&&("point"===t.type||"multipoint"===t.type)||"transform"===r.tool&&"extent"===t.type))return;let s=null;"transform"===r.tool?s=await this._getReshape([e],i,n):"reshape"===r.tool&&(s=await this._getBox([e],i,n)),He(s)||(r.activeComponent.destroy(),r.activeComponent=s,r.activeComponent&&(a.forEach((e=>e.remove())),a=this._getHandlesForComponent(r,i)))}});let o=[n.on("immediate-click",(e=>this._getCommonUpdateOperationClickHandlers(r,e,i)),O.f.WIDGET),n.on("key-down",(e=>{if(this._getCommonUpdateOperationKeyDownHandlers(r,e),e.key!==P.j.snappingToggle||e.repeat||(this.snappingOptions.enabledToggled=!0,e.stopPropagation()),e.key===P.j.constraint&&!e.repeat&&r){const e=r.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),O.f.WIDGET),n.on("key-up",(e=>{if(e.key===P.j.snappingToggle&&"reshape"===r?.activeComponent?.type&&(this.snappingOptions.enabledToggled=!1,e.stopPropagation()),e.key===P.j.constraint&&r){const e=r.activeComponent;e&&"box"===e.type&&(e.preserveAspectRatio=!e.preserveAspectRatio)}}),O.f.WIDGET)],a=this._getHandlesForComponent(r,i);return r}async _getGraphicMover(e,t,n){const{enableMoveAllGraphics:s}=t,r=await this._requireModule(i.e(3503).then(i.bind(i,53503)));return He(r)?r:new r.module.default({enableMoveAllGraphics:s,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:e,view:n,callbacks:{onGraphicMoveStart:e=>{let{dx:t,dy:i,graphic:n}=e;this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:i,mover:n,type:"move-start"},type:"update"})},onGraphicMove:e=>{let{dx:t,dy:i,graphic:n}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:i,mover:n,type:"move"},type:"update"})},onGraphicMoveStop:e=>{let{dx:t,dy:i,graphic:n}=e;this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:i,mover:n,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,n){const{enableRotation:s,enableScaling:r,preserveAspectRatio:o}=t,a=await this._requireModule(Promise.all([i.e(3503),i.e(6306)]).then(i.bind(i,96306)));return He(a)?a:new a.module.default({graphics:e,enableRotation:s,enableScaling:r,preserveAspectRatio:o,layer:this._internalGraphicsLayer,view:n,callbacks:{onMoveStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMove:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onMoveStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScale:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onScaleStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotate:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onRotateStop:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"})}})}async _getReshape(e,t,n){const s="split"===t.reshapeOptions?.edgeOperation,r="move"===t.reshapeOptions?.shapeOperation,o=await this._requireModule(Promise.all([i.e(5652),i.e(1129),i.e(3503),i.e(3362)]).then(i.bind(i,83362)));return He(o)?o:new o.module.default({enableMidpoints:s,enableMovement:r,graphic:e[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,view:n,callbacks:{onReshapeStart:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshape:e=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...e},type:"update"}),onReshapeStop:e=>{let{mover:t,type:i}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:t,type:i},type:"update"})},onMoveStart:e=>{let{dx:t,dy:i,mover:n,type:s}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:i,mover:n,type:s},type:"update"})},onMove:e=>{let{dx:t,dy:i,mover:n,type:s}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:i,mover:n,type:s},type:"update"})},onMoveStop:e=>{let{dx:t,dy:i,mover:n,type:s}=e;return this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:t,dy:i,mover:n,type:s},type:"update"})},onVertexAdd:e=>{let{added:t,type:i,vertices:n}=e;const s=t.map((e=>(0,f.nA)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:s,vertices:n,type:i},type:"update"})},onVertexRemove:e=>{let{removed:t,type:i,vertices:n}=e;const s=t.map((e=>(0,f.nA)(e.geometry)));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:s,vertices:n,type:i},type:"update"})}}})}_getHandlesForComponent(e,t){const i=e.activeComponent;switch(i.type){case"graphic-mover":return[i.on("graphic-click",(t=>{let{graphic:i,viewEvent:n}=t;n.native?.shiftKey&&(n.stopPropagation(),e.removeFromSelection(i))})),i.on("graphic-move-start",(t=>e.addToHistory(Ve(t.allGraphics))))];case"box":return[i.on("graphic-click",(i=>this._onTransformOrReshape2DGraphicClick(e,t,i))),i.on("move-start",(t=>e.addToHistory(Ve(t.graphics)))),i.on("rotate-start",(t=>e.addToHistory(Ve(t.graphics)))),i.on("scale-start",(t=>e.addToHistory(Ve(t.graphics))))];case"reshape":return[i.on("graphic-click",(i=>this._onTransformOrReshape2DGraphicClick(e,t,i))),i.on("move-start",(t=>e.addToHistory(Ve([t.mover])))),i.on("reshape-start",(t=>e.addToHistory(Ve([t.graphic])))),i.on("vertex-add",(t=>e.addToHistory(Ve([t.oldGraphic])))),i.on("vertex-remove",(t=>e.addToHistory(Ve([t.oldGraphic]))))];case"move-3d":return[i.on("graphic-move-start",(t=>{e.addToHistory(Ve(t.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:t.allGraphics.length>0?t.allGraphics[0]:null,type:"move-start"},type:"update"})})),i.on("graphic-move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:e.dx,dy:e.dy,mover:e.allGraphics.length>0?e.allGraphics[0]:null,type:"move"},type:"update"})})),i.on("graphic-move-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:e.allGraphics.length>0?e.allGraphics[0]:null,type:"move-stop"},type:"update"})})),i.on("immediate-click",(i=>{i.shiftKey?this._toggleSelection([i.graphic],e,t):e.toggleTool()}))];case"transform-3d":return[i.on("record-undo",(t=>{let{record:i}=t;e.addToHistory({updates:[i]})})),i.on("graphic-translate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-start"},type:"update"})})),i.on("graphic-translate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move-stop"},type:"update"})})),i.on("graphic-rotate-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate-start"},type:"update"})})),i.on("graphic-rotate-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate-stop"},type:"update"})})),i.on("graphic-scale-start",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-start"},type:"update"})})),i.on("graphic-scale-stop",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale-stop"},type:"update"})})),i.on("graphic-translate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,dx:e.dxScreen,dy:e.dyScreen,type:"move"},type:"update"})})),i.on("graphic-rotate",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,angle:e.angle,type:"rotate"},type:"update"})})),i.on("graphic-scale",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:e.graphic,xScale:e.xScale,yScale:e.yScale,type:"scale"},type:"update"})})),i.on("immediate-click",(i=>{i.shiftKey?this._toggleSelection([i.graphic],e,t):e.toggleTool()}))];case"reshape-3d":return[i.on("reshape",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),i.on("move",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),i.on("vertex-add",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),i.on("vertex-remove",(e=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:e,type:"update"})})),i.on("immediate-click",(i=>{i.shiftKey?this._toggleSelection([i.graphic],e,t):e.toggleTool()}))];default:return}}_onTransformOrReshape2DGraphicClick(e,t,i){const{graphic:n,viewEvent:s}=i;return s.native?.shiftKey&&n.layer===this.layer?(s.stopPropagation(),e.removeFromSelection(n)):t.toggleToolOnClick?(s.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const i=this.view.map;this._disablePopup(t);e.on("complete",(()=>{if(e===this._operationHandle){const n=this.updateGraphics.toArray(),s=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),i&&i.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:n,state:"complete",aborted:e.cancelled,tool:s,toolEventInfo:null,type:"update"})}}))}async _getCommonUpdateOperationClickHandlers(e,t,i){const n=(0,ve.vT)(t),s=await t.async((()=>this._getFirstHit(n)));(0,p.Wi)(s)?e.complete():t.native.shiftKey&&this._toggleSelection([s.graphic],e,i)||this.updateGraphics.includes(s.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,i){const n=!!i.multipleSelectionEnabled;return e.some((e=>null!=e&&!(!n||e.layer!==this.layer)&&(this.updateGraphics.includes(e)?t.removeFromSelection(e):t.addToSelection(e),!0)))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const i=t.key;i===P.j.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):i===P.j.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):i===P.j.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&P.j.delete.includes(i)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||"update"!==this._operationHandle.type)return;const t=this.activeComponent,i=this.updateGraphics.toArray();(0,p.Wi)(t)||"reshape-3d"===t.type||("reshape"!==t.type||1===i.length&&"point"===(0,p.U2)(i[0].geometry,"type"))&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=(0,p.SC)(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||(0,p.Wi)(t))&&(e.attributes&&e.attributes.esriSketchTool||"draw-2d"===t.type&&t.graphic===e||("box"===t.type||"reshape"===t.type)&&t.isUIGraphic(e))}_displayPointerCursor(){this.view&&this.view.container&&"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(e,t,i){Oe.error(new o.Z(e,t,i))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const i=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:i}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){return{operationHandle:this._operationHandle,defaultUpdateOptions:Ie}}wait(){return(0,d.N1)((()=>!this.updating))}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){return"3d"!==this.view?.type||this.updateOnGraphicClick||(0,p.pC)(e)&&e.toggleToolOnClick}_disablePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view.popup;t&&(0,p.Wi)(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=t.autoOpenEnabled,t.autoOpenEnabled=!1)}_restorePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view.popup;t&&(0,p.pC)(this._originalAutoOpenEnabled)&&(t.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)}async _waitViewReady(){const e=this.view;e&&((0,p.IM)(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await(0,h.Hl)((0,d.N1)((()=>e?.ready)),this._viewReadyAbortController.signal))}};function Re(e){return"polygon"===e||"rectangle"===e||"circle"===e}function Me(e,t){Ne("undo",e.history.undo,e.history.redo,t)}function Ae(e,t){Ne("redo",e.history.redo,e.history.undo,t)}function Ne(e,t,i,n){const s=t.pop().updates,r=[];n.forEach(((t,i)=>{const n=s[i];null!=n&&("geometry"in n&&(0,p.pC)(n.geometry)&&(r.push({geometry:t.geometry}),t.geometry=n.geometry),"symbol"in n&&(0,p.pC)(n.symbol)&&(r.push({symbol:t.symbol}),t.symbol=n.symbol),"undo"in n&&(r.push(n),n[e](t)))})),i.push({updates:r})}function Ve(e){return{updates:e.map((e=>({geometry:e.geometry})))}}function He(e){return"requireError"in e&&"aborted"===e.requireError}(0,n._)([(0,u.Cb)()],Ge.prototype,"updating",null),(0,n._)([(0,u.Cb)()],Ge.prototype,"_operationHandle",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],Ge.prototype,"activeTool",null),(0,n._)([(0,u.Cb)()],Ge.prototype,"activeFillSymbol",void 0),(0,n._)([(0,u.Cb)()],Ge.prototype,"activeLineSymbol",void 0),(0,n._)([(0,u.Cb)()],Ge.prototype,"activeVertexSymbol",void 0),(0,n._)([(0,u.Cb)()],Ge.prototype,"allowDeleteKey",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],Ge.prototype,"createGraphic",null),(0,n._)([(0,u.Cb)()],Ge.prototype,"defaultCreateOptions",null),(0,n._)([(0,u.Cb)()],Ge.prototype,"defaultUpdateOptions",null),(0,n._)([(0,u.Cb)({type:I.Z,nonNullable:!0})],Ge.prototype,"labelOptions",void 0),(0,n._)([(0,u.Cb)()],Ge.prototype,"layer",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"pointSymbol",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"polygonSymbol",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"polylineSymbol",void 0),(0,n._)([(0,u.Cb)({type:de.Z,nonNullable:!0})],Ge.prototype,"snappingOptions",null),(0,n._)([(0,u.Cb)()],Ge.prototype,"_snappingManager",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],Ge.prototype,"state",null),(0,n._)([(0,u.Cb)({type:G.Z,nonNullable:!0})],Ge.prototype,"tooltipOptions",void 0),(0,n._)([(0,u.Cb)({readOnly:!0})],Ge.prototype,"updateGraphics",void 0),(0,n._)([(0,u.Cb)()],Ge.prototype,"updateOnGraphicClick",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"updatePointSymbol",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"updatePolygonSymbol",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"updatePolylineSymbol",void 0),(0,n._)([(0,u.Cb)({types:s.LB})],Ge.prototype,"vertexSymbol",void 0),(0,n._)([(0,u.Cb)({value:null})],Ge.prototype,"view",null),Ge=(0,n._)([(0,g.j)(Ce)],Ge);const ke=Ge},99505:(e,t,i)=>{i.d(t,{_:()=>o});var n=i(27366),s=i(49861),r=(i(63780),i(93169),i(25243),i(69912));const o=e=>{let t=class extends e{constructor(){super(...arguments),this.goToOverride=null,this.view=null}callGoTo(e){const{view:t}=this;return this.goToOverride?this.goToOverride(t,e):t.goTo(e.target,e.options)}};return(0,n._)([(0,s.Cb)()],t.prototype,"goToOverride",void 0),(0,n._)([(0,s.Cb)()],t.prototype,"view",void 0),t=(0,n._)([(0,r.j)("esri.widgets.support.GoTo")],t),t}},96919:(e,t,i)=>{i.d(t,{MJ:()=>c,X6:()=>a});var n=i(16889),s=i(80975),r=i(67005);const o="esri-widget__heading";function a(e,t){const i=l(e.level),n=`h${i}`;return delete e.level,(0,r.u)(n,{...e,class:(0,s.Sh)(o,e.class),role:"heading","aria-level":String(i)},t)}function l(e){return(0,n.uZ)(Math.ceil(e),1,6)}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return l(e+t)}},78088:(e,t,i)=>{i.d(t,{h:()=>s});var n=i(80975);function s(){return function(e,t){if(!e[t])throw new TypeError(`Cannot auto bind undefined function '${t}'`);return{value:o(e[t])}}}function r(e){const{type:t}=e;return e instanceof KeyboardEvent||"keyup"===t||"keydown"===t||"keypress"===t}function o(e){return function(t){for(var i=arguments.length,s=new Array(i>1?i-1:0),o=1;o<i;o++)s[o-1]=arguments[o];r(t)?(0,n.pf)(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call(this,t,...s)}}}}]);
//# sourceMappingURL=7496.a9dfe78b.chunk.js.map