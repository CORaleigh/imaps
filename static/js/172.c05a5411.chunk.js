(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[172,242],{1126:function(e,t,l){},1357:function(e,t,l){"use strict";l.r(t),l.d(t,"Layers",(function(){return p}));var i=l(1),n=l(1125),r=l(103),a=l(333);const o=e=>{const t=e.item;if("group"!=t.layer.type&&void 0!=t.layer.type){const e=document.createElement("calcite-slider");e.setAttribute("min","0"),e.setAttribute("max","100"),e.setAttribute("step","1"),e.setAttribute("snap",""),e.setAttribute("min-label","0%"),e.setAttribute("max-label","100%"),e.setAttribute("label-handles",""),e.setAttribute("value",Math.round(100*(null===t||void 0===t?void 0:t.layer.opacity)).toString()),e.setAttribute("data",t.layer.id),e.addEventListener("calciteSliderUpdate",(e=>{var l;t.layer.opacity=Math.round(parseInt(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.getAttribute("value")))/100}),{passive:!0}),t.panel={content:[e,"legend"],open:t.layer.visible},t.layer.watch("visible",(e=>{t.panel.open=e,e&&(t.layer.parent&&"group"===t.layer.parent.type&&(t.layer.parent.visible=!0),t.layer.parent.parent&&"group"===t.layer.parent.parent.type&&(t.layer.parent.parent.visible=!0))}))}c(t)},s=[{expression:"First(Split($feature['SITE_ADDRESS'], ' '))",title:"Address"},{expression:"$feature['PIN_NUM']",title:"PIN"},{expression:"$feature['REID']",title:"REID"},{expression:'When(IsEmpty($feature["SALE_DATE"]),null, Concatenate(Month($feature["SALE_DATE"])+1, \'/\',Day($feature["SALE_DATE"]), \'/\',Year($feature["SALE_DATE"])))',title:"Sale Date"},{expression:"Text($feature.TOTSALPRICE,'$#,###')",title:"Sale Price"}],c=e=>{if("Property"===e.layer.title&&"group"!=e.layer.type&&0===e.actionsSections.length){console.log(e.layer.title);const t=new r.a;t.addMany(s.map((e=>new a.a({active:!1,title:e.title,visible:!0})))),e.actionsSections.push(t),e.actionsOpen=!0,setTimeout((()=>{const e=document.createElement("h4");e.textContent="Labels",e.setAttribute("style","padding: 0.5em;margin: 0;");const t=document.querySelector(".esri-layer-list__item-actions");(null===t||void 0===t?void 0:t.parentElement)&&t.prepend(e)}),500)}},u=(e,t)=>{e||(e=""),t.operationalItems.forEach((t=>{if("group"===t.layer.type){let y=!1;var l,i,n,r;if(t.layer.layers.forEach((t=>{t.title.toLowerCase().includes(e.toLowerCase())?(t.listMode="show",y=!0):t.listMode="hide","group"===t.type&&t.layers.forEach((l=>{l.title.toLowerCase().includes(e.toLowerCase())?(t.listMode="show",l.listMode="show",y=!0):l.listMode="hide"}))})),e.length)if(y){var a,o,s,c;t.open=!0,null===(a=document.querySelector(`#layerListDiv_${t.uid}__title`))||void 0===a||null===(o=a.parentElement)||void 0===o||null===(s=o.parentElement)||void 0===s||null===(c=s.parentElement)||void 0===c||c.removeAttribute("hidden")}else{var u,d,p,v;t.open=!1,null===(u=document.querySelector(`#layerListDiv_${t.uid}__title`))||void 0===u||null===(d=u.parentElement)||void 0===d||null===(p=d.parentElement)||void 0===p||null===(v=p.parentElement)||void 0===v||v.setAttribute("hidden","")}else t.open=!1,null===(l=document.querySelector(`#layerListDiv_${t.uid}__title`))||void 0===l||null===(i=l.parentElement)||void 0===i||null===(n=i.parentElement)||void 0===n||null===(r=n.parentElement)||void 0===r||r.removeAttribute("hidden")}}))};l(1126);var d=l(0);const p=e=>{const t=Object(i.useRef)(null),l=Object(i.useRef)(null),r=Object(i.useRef)();return Object(i.useEffect)((()=>{console.log(e.active)}),[e.active]),Object(i.useEffect)((()=>{var i,a;console.log("test");const c=new n.a({container:t.current,view:e.view,listItemCreatedFunction:o,visibleElements:{statusIndicators:!0}});return r.current=c,c.on("trigger-action",(e=>{"Property"===e.item.layer.title&&(e=>{if("Property"===e.item.layer.title){e.item.layer.labelsVisible||(e.item.layer.labelsVisible=!0);const t=e.item.actionsSections.getItemAt(0).filter((e=>e.value)).map((e=>e.title)),l=s.filter((e=>t.includes(e.title))).map((e=>e.expression));console.log(l);const i=l.join("+ TextFormatting.NewLine+");e.item.layer.labelingInfo=[],e.item.layer.labelingInfo=[{symbol:{type:"text",color:"black",haloColor:"white",haloSize:1,font:{family:"AvenirNext LT Pro Regular",style:"normal",weight:"bold"}},labelExpressionInfo:{expression:i},maxScale:0,minScale:5e3}]}})(e)})),null===(i=l.current)||void 0===i||i.addEventListener("calciteInputInput",(e=>{u(e.target.value,c)})),null===(a=l.current)||void 0===a||a.addEventListener("focusout",(e=>{u(e.target.value,c)})),()=>{var e;null===(e=l.current)||void 0===e||e.removeEventListener("calciteInputInput",(e=>{u(e.target.value,c)})),c&&c.destroy()}}),[e.view]),Object(d.jsxs)("div",{className:"panel",children:[Object(d.jsxs)("div",{className:"row sticky",children:[Object(d.jsx)("calcite-input",{ref:l,clearable:!0,placeholder:"Filter by layer name",scale:"m",id:"layerSearch"}),Object(d.jsx)("calcite-action",{icon:"viewHide",scale:"m",onClick:()=>{(e=>{null===e||void 0===e||e.operationalItems.forEach((e=>{e.visible="Property"===e.title}))})(r.current)}})]}),Object(d.jsx)("div",{ref:t})]})};t.default=p},527:function(e,t){function l(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}l.keys=function(){return[]},l.resolve=l,e.exports=l,l.id=527}}]);
//# sourceMappingURL=172.c05a5411.chunk.js.map