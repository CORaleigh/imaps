{"version":3,"sources":["../node_modules/@arcgis/core/views/2d/layers/StreamLayerView2D.js"],"names":["p","e","o","t","i","r","geometry","toJSON","where","l","arguments","_enabledDataReceived","errorString","connectionStatus","this","handles","add","layer","watch","_update","s","_proxy","enableEvent","remove","closed","hasEventListener","timeInfo","endField","startField","queryLatestObservations","_cleanUpQuery","then","n","fromJSON","features","forEach","sourceLayer","setProperty","set","propertyName","value","JSON","stringify","purgeOptions","definitionExpression","geometryDefinition","a","objectIdField","fields","map","geometryType","spatialReference","type","source","parsedUrl","serviceFilter","enableDataReceived","maxReconnectionAttempts","maxReconnectionInterval","updateInterval","c","prototype","readOnly","d"],"mappings":"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","file":"static/js/224.4be9a406.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import{isNone as t,isSome as r}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../core/Error.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import n from\"../../../tasks/support/FeatureSet.js\";import{toJSONGeometryType as a}from\"./support/util.js\";import c from\"./FeatureLayerView2D.js\";function p(e,o){if(t(e)&&t(o))return null;const i={};return r(o)&&(i.geometry=o.toJSON()),r(e)&&(i.where=e),i}let l=class extends c{constructor(){super(...arguments),this._enabledDataReceived=!1,this.errorString=null,this.connectionStatus=\"disconnected\"}initialize(){this.handles.add([this.layer.watch(\"purgeOptions\",(()=>this._update()))])}destroy(){this.connectionStatus=\"disconnected\"}get connectionError(){if(this.errorString)return new s(\"stream-controller\",this.errorString)}on(e,t){\"data-received\"===e&&(this._enabledDataReceived=!0,this._proxy.enableEvent(\"data-received\",!0));const r=super.on(e,t),o=this;return{remove(){r.remove(),\"data-received\"===e&&(o._proxy.closed||o.hasEventListener(\"data-received\")||o._proxy.enableEvent(\"data-received\",!1))}}}queryLatestObservations(e,t){if(!(this.layer.timeInfo.endField||this.layer.timeInfo.startField))throw new s(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),t).then((e=>{const t=n.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(p(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),o=a(e.geometryType),i=e.timeInfo&&e.timeInfo.toJSON()||null,s=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",fields:r,geometryType:o,objectIdField:t,timeInfo:i,source:this.layer.parsedUrl,serviceFilter:p(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enableDataReceived:this._enabledDataReceived,spatialReference:s,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval}}};e([o()],l.prototype,\"errorString\",void 0),e([o({readOnly:!0})],l.prototype,\"connectionError\",null),e([o()],l.prototype,\"connectionStatus\",void 0),l=e([i(\"esri.views.2d.layers.StreamLayerView2D\")],l);var d=l;export default d;\n"],"sourceRoot":""}