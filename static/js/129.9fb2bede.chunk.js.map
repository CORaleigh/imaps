{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js","../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js"],"names":["b","e","a","t","l","data","Promise","r","FileReader","readAsDataURL","onload","result","onerror","F","Set","R","arguments","type","s","signal","this","addResolvingPromise","_fetchService","resolve","layer","capabilities","query","supportsFormatPBF","parsedUrl","dynamicDataSource","gdbVersion","o","spatialReference","i","fieldsIndex","u","f","url","path","format","sourceSpatialReference","load","attributes","objectIdField","_getLayerRequestOptions","_getFormDataForAttachment","c","body","_createFeatureEditResult","addAttachmentResult","_createAttachmentErrorResult","attachmentId","updateAttachmentResult","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","globalIdUsed","p","deleteAttachments","addAttachments","_serializeAttachment","push","updateAttachments","n","length","adds","updates","deletes","method","JSON","stringify","join","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","attachments","d","_createEditsResult","attachmentIds","deleteAttachmentResults","then","returnUpdates","layerId","id","extent","fullExtent","timeExtent","fromJSON","y","start","end","get","objectIds","all","parentObjectId","attachmentInfos","m","queryTask","executeAttachmentQuery","execute","customParameters","executeJSON","executeForIds","executeForCount","executeForExtent","executeRelationshipQuery","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","renderer","defaultSymbol","g","geometry","toJSON","feature","attachment","globalId","name","contentType","uploadId","parentGlobalId","globalIdField","mediaType","File","_canUseGlobalIds","_getGlobalIdsFromFeatureIdentifier","_getObjectIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","description","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","source","responseType","h","prototype","constructOnly","readOnly","q","symbol","indexOf","Function"],"mappings":"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","file":"static/js/129.9fb2bede.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import d from\"../../../geometry/Extent.js\";import c from\"../../../request.js\";import h from\"../../../core/Loadable.js\";import y from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as p}from\"../../../rest/query/operations/zscale.js\";import{processAttachmentQueryResult as m}from\"../../../rest/query/operations/queryAttachments.js\";import f from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as g}from\"./support/clientSideDefaults.js\";async function b(e){if(\"string\"==typeof e){const t=l(e);return t||{data:e}}return new Promise(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}const F=new Set([\"Feature Layer\",\"Table\"]);let R=class extends h{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Promise.resolve(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new f({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await c(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(i){throw this._createAttachmentErrorResult(r,i)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await c(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(u){throw this._createAttachmentErrorResult(a,u)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures,null==t?void 0:t.globalIdUsed);p(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const c of e.addAttachments)o.push(await this._serializeAttachment(c));for(const c of e.updateAttachments)i.push(await this._serializeAttachment(c));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?null!=t&&t.globalIdUsed?JSON.stringify(s):s.join(\",\"):null,gdbVersion:(null==t?void 0:t.gdbVersion)||this.layer.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await c(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await c(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(s){throw this._createAttachmentErrorResult(r,s)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await c(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&d.fromJSON(l),timeExtent:n&&y.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(c(t,s))}return Promise.all(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>m(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await c(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!F.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=g(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await b(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e,t){const r=e[0];return r?this._canUseGlobalIds(t,e)?this._getGlobalIdsFromFeatureIdentifier(e):\"objectId\"in r?this._getObjectIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_canUseGlobalIds(e,t){return e&&\"globalId\"in t[0]}_getObjectIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_getGlobalIdsFromFeatureIdentifier(e){return e.map((e=>e.globalId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const a in t){const e=t[a];null!=e&&(r.set?r.set(a,e):r.append(a,e))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],R.prototype,\"type\",void 0),e([i({constructOnly:!0})],R.prototype,\"layer\",void 0),e([i({readOnly:!0})],R.prototype,\"queryTask\",null),R=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],R);var q=R;export default q;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(n){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n"],"sourceRoot":""}