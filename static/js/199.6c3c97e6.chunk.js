/*! For license information please see 199.6c3c97e6.chunk.js.LICENSE.txt */
(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[199],{1119:function(e,t,l){},1354:function(e,t,l){"use strict";l.r(t),l.d(t,"Shell",(function(){return E}));var i=l(1),c=l(7),n=l.n(c);l(1119);const o=e=>{var t,l;(null===(t=e.target)||void 0===t?void 0:t.parentElement).collapsed=null===(l=e.target)||void 0===l?void 0:l.dismissed},a=(e,t,l)=>{t.isActive?t.isActive=!1:(((e,t)=>{innerWidth<1e3?e.forEach((e=>{e.isActive=!1})):t?e.forEach((e=>{e.isActive=e.isActive&&!e.isTool})):e.forEach((e=>{e.isActive=e.isActive&&e.isTool}))})(l,t.isTool),t.isActive=!0);const i=e.target.closest("calcite-shell-panel");return t.isActive?null===i||void 0===i||i.removeAttribute("collapsed"):null===i||void 0===i||i.setAttribute("collapsed",""),l},r=(e,t,l,i)=>{document.querySelectorAll("calcite-action[active]").forEach((l=>{const i=e.find((e=>e.title===l.getAttribute("text")));var c,n,o;window.innerWidth>=1e3&&(null===i||void 0===i?void 0:i.isActive)&&t<1e3&&(i.isTool&&(null===(c=document.querySelector("calcite-shell-panel[slot=contextual-panel]"))||void 0===c||c.setAttribute("collapsed",""),i.isActive=!1));window.innerWidth<1e3&&(null===i||void 0===i?void 0:i.isActive)&&t>=1e3&&(i.isTool?(null===(n=document.querySelector("calcite-shell-panel[slot=primary-panel]"))||void 0===n||n.removeAttribute("collapsed"),i.isActive=!1):null===(o=document.querySelector("calcite-shell-panel[slot=contextual-panel]"))||void 0===o||o.removeAttribute("collapsed"));document.querySelectorAll("calcite-action-bar").forEach((e=>{e&&(e.expandDisabled=window.innerWidth<=500)}))})),console.log(t,window.innerWidth),l(window.innerWidth),i([...e])},s=e=>{const t=e.find((e=>e.isActive));t&&(window.innerWidth<1e3||!t.isTool)&&(t.isActive=!1);const l=e.find((e=>"Property Search"===e.title));l&&(l.isActive=!0);const i=document.getElementById(null===l||void 0===l?void 0:l.container);if(i){(null===i||void 0===i?void 0:i.closest(".action-panel")).hidden=!1;const e=null===i||void 0===i?void 0:i.closest("calcite-shell-panel");null===e||void 0===e||e.removeAttribute("collapsed")}return i};var d=l(3),u=l(2),v=l(8),p=l(0);const h=Object(i.lazy)((()=>Promise.all([l.e(1),l.e(2),l.e(3),l.e(5),l.e(60)]).then(l.bind(null,1331)))),b=Object(i.lazy)((()=>l.e(196).then(l.bind(null,1146)))),m=Object(i.lazy)((()=>l.e(200).then(l.bind(null,1147)))),j=Object(i.lazy)((()=>l.e(119).then(l.bind(null,1355)))),x=Object(i.lazy)((()=>Promise.all([l.e(1),l.e(2),l.e(3),l.e(5),l.e(63)]).then(l.bind(null,1356)))),y=Object(i.lazy)((()=>Promise.all([l.e(15),l.e(86),l.e(172)]).then(l.bind(null,1357)))),w=Object(i.lazy)((()=>Promise.all([l.e(6),l.e(9),l.e(12),l.e(15),l.e(72)]).then(l.bind(null,1326)))),O=Object(i.lazy)((()=>Promise.all([l.e(2),l.e(3),l.e(5),l.e(15),l.e(69)]).then(l.bind(null,1148)))),f=Object(i.lazy)((()=>Promise.all([l.e(1),l.e(2),l.e(3),l.e(5),l.e(62)]).then(l.bind(null,1358)))),S=Object(i.lazy)((()=>Promise.all([l.e(2),l.e(3),l.e(6),l.e(15),l.e(73)]).then(l.bind(null,1333)))),g=Object(i.lazy)((()=>Promise.all([l.e(1),l.e(2),l.e(3),l.e(5),l.e(61)]).then(l.bind(null,1329)))),A=Object(i.lazy)((()=>Promise.all([l.e(12),l.e(15),l.e(26),l.e(32),l.e(77)]).then(l.bind(null,1344)))),k=Object(i.lazy)((()=>Promise.all([l.e(1),l.e(2),l.e(3),l.e(6),l.e(71)]).then(l.bind(null,1335)))),E=()=>{const[e,t]=Object(i.useState)(),[l,c]=Object(i.useState)([]),[E,q]=Object(i.useState)(),[P,L]=Object(i.useState)(window.innerWidth),T=Object(i.useRef)(),[M,W]=Object(i.useState)(!1),[C,$]=Object(i.useState)([]),[z,_]=Object(i.useState)(),{theme:R,setTheme:F}=Object(i.useContext)(d.a),[I,N]=Object(i.useState)(!0),B=Object(i.useRef)(),G=Object(i.useRef)(),U=Object(i.useRef)(),D=Object(i.useRef)(),K=Object(i.useRef)(),V=Object(i.useRef)(),[J,H]=Object(i.useState)(),{actions:Q,setActions:X}=Object(i.useContext)(v.a),Y=e=>{_({...z,attributes:null===e||void 0===e?void 0:e.attributes,geometry:null===e||void 0===e?void 0:e.geometry});const t=Q.find((e=>"Property Select"===e.title));if(t&&T.current){const l=document.getElementById(null===t||void 0===t?void 0:t.container);l&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(f,{view:T.current,selectedFeature:e,geometrySet:oe,toolActivated:ce,clear:ae})}),l)}const l=Q.find((e=>"Print"===e.title));if(l){const t=document.getElementById(null===l||void 0===l?void 0:l.container);n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(k,{view:T.current,exportUrl:"https://indoors.raleighnc.gov/arcgis/rest/services/ExportWebMap/GPServer/Export%20Web%20Map",templateUrl:"https://indoors.raleighnc.gov/arcgis/rest/services/ExportWebMap/GPServer/Get%20Layout%20Templates%20Info/execute",selectedFeature:e})}),t)}},Z=e=>{$([...C,...e]),e.length>1&&_({...z,attributes:null});const t=s(Q);n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(j,{propertiesSelected:Z,featureSelected:Y,selectedProperties:e})}),t),console.log("setActions"),X([...Q])},ee=()=>{var e,t,l,i;null===(e=G.current)||void 0===e||e.cancel(),null===(t=U.current)||void 0===t||null===(l=t.viewModel.activeViewModel)||void 0===l||l.clear(),D.current&&(D.current.viewModel.mode="live"),null===(i=B.current)||void 0===i||i.cancel(),H("sketch")},te=()=>{var e,t,l;null===(e=document.querySelector(".map-tool.active"))||void 0===e||e.classList.remove("active"),(null===(t=T.current)||void 0===t?void 0:t.popup)&&(T.current.popup.autoOpenEnabled=!1),null===(l=V.current)||void 0===l||l.remove()},le=e=>{var t,l,i;B.current=e,null===(t=G.current)||void 0===t||t.cancel(),null===(l=U.current)||void 0===l||null===(i=l.viewModel.activeViewModel)||void 0===i||i.clear(),D.current&&(D.current.viewModel.mode="live"),H("sketch"),te()},ie=(e,t)=>{var l,i;U.current=e,D.current=t,null===(l=B.current)||void 0===l||l.cancel(),null===(i=G.current)||void 0===i||i.cancel(),H("measure"),te()},ce=e=>{var t,l,i;G.current=e,null===(t=B.current)||void 0===t||t.cancel(),null===(l=U.current)||void 0===l||null===(i=l.viewModel.activeViewModel)||void 0===i||i.clear(),D.current&&(D.current.viewModel.mode="live"),H("select"),te()},ne=e=>{var t,l;let i;return i=e?Q.find((e=>e.isActive&&e.isTool)):Q.find((e=>e.isActive)),(null===(t=i)||void 0===t||null===(l=t.tips)||void 0===l?void 0:l.length)>0?Object(p.jsx)("calcite-action",{id:"tipAction"+(e?"_tool":""),text:"Action",label:"Action",slot:"header-actions-end",icon:"lightbulb",appearance:"solid",scale:"m","calcite-hydrated":"",onClick:()=>{c([...i.tips]),q(i.title)}}):""},oe=e=>{const t=s(Q);n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(j,{geometry:e,propertiesSelected:Z,selectedProperties:C,featureSelected:Y,selectedFeature:z})}),t)},ae=()=>{const e=s(Q);n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(j,{geometry:void 0,propertiesSelected:Z,selectedProperties:C,featureSelected:Y,selectedFeature:z})}),e)},re=e=>{if(e){var t,l,c;const o=document.getElementById(e.container);null===(t=document.querySelector("calcite-shell-panel[slot=contextual-panel]"))||void 0===t||null===(l=t.shadowRoot)||void 0===l||null===(c=l.querySelector(".content"))||void 0===c||c.setAttribute("style","max-width: 350px; width: calc(var(--calcite-panel-width-multiplier) * 100vw) !important;"),K.current&&(K.current.icon="left-edge"),(null===o||void 0===o?void 0:o.hasChildNodes())||("Property Search"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(j,{view:T.current,propertiesSelected:Z,featureSelected:Y,selectedProperties:C})}),o),"Location Search"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(x,{view:T.current})}),o),"Layers"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(y,{view:T.current})}),o),"Basemaps"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(w,{view:T.current,default:u.b.default.id,imagery:u.b.imagery.id})}),o),"Legend"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(O,{view:T.current})}),o),"Property Select"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(f,{view:T.current,geometrySet:oe,selectedFeature:z,toolActivated:ce,activeTool:J,clear:ae})}),o),"Measure"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(S,{view:T.current,measurementActivated:ie,activeTool:J})}),o),"Sketch"===e.title&&n.a.render(Object(p.jsxs)(i.Suspense,{fallback:"",children:[Object(p.jsx)(g,{view:T.current,toolActivated:le,activeTool:J})," "]}),o),"Bookmarks"===e.title&&n.a.render(Object(p.jsxs)(i.Suspense,{fallback:"",children:[Object(p.jsx)(A,{view:T.current})," "]}),o),"Print"===e.title&&n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(k,{view:T.current,exportUrl:"https://indoors.raleighnc.gov/arcgis/rest/services/ExportWebMap/GPServer/Export%20Web%20Map",templateUrl:"https://indoors.raleighnc.gov/arcgis/rest/services/ExportWebMap/GPServer/Get%20Layout%20Templates%20Info/execute"})}),o))}};return Object(i.useEffect)((()=>{const e=window.localStorage.getItem("imaps_theme"),l=new URL(document.URL).searchParams.get("id");t(l||u.c),((e,t)=>{e?("dark"===e&&t("dark"),"light"===e&&t("light")):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?(e="dark",t("dark")):(e="light",t("light")),document.body.classList.remove("light"===e?"dark":"light"),document.body.classList.add("light"===e?"light":"dark");const l=Array.from(document.head.querySelectorAll("link")).find((t=>t.href.includes(`${e}/main.css`)));var i;l&&document.head.appendChild(l),void 0!=window.matchMedia&&void 0!=window.matchMedia("(prefers-color-scheme: dark)").addEventListener&&(null===(i=window.matchMedia("(prefers-color-scheme: dark)"))||void 0===i||i.addEventListener("change",(e=>{const l=e.matches?"dark":"light";t(l),window.localStorage.setItem("imaps_theme",l),document.body.classList.remove("light"===l?"dark":"light"),document.body.classList.add("light"===l?"light":"dark");const i=Array.from(document.head.querySelectorAll("link")).find((e=>e.href.includes(`${l}/main.css`)));i&&document.head.appendChild(i)})))})(e,F)}),[]),Object(i.useEffect)((()=>{let e;return document.querySelectorAll("calcite-panel").forEach((e=>{null===e||void 0===e||e.addEventListener("calcitePanelDismissedChange",o)})),window.addEventListener("resize",(()=>{clearTimeout(e),e=setTimeout((()=>{(window.innerWidth<1e3&&P>=1e3||window.innerWidth>=1e3&&P<1e3)&&r(Q,P,L,X)}),250),document.querySelectorAll("calcite-shell-panel").forEach((e=>{var t,l;let i="350px";K.current&&(K.current.icon="left-edge");const c=e.querySelector("calcite-action-bar");window.innerWidth<=500&&(i=`calc(90vw - ${null===c||void 0===c?void 0:c.clientWidth}px)`),null===e||void 0===e||null===(t=e.shadowRoot)||void 0===t||null===(l=t.querySelector(".content"))||void 0===l||l.setAttribute("style",`max-width: ${i}; width: calc(var(--calcite-panel-width-multiplier) * 100vw) !important;`)}))})),document.querySelectorAll("calcite-shell-panel").forEach((e=>{const t=new MutationObserver((l=>{if(l.length){var i,c;let l="350px";window.innerWidth<=500&&(l="calc(90vw - 50px)"),null===e||void 0===e||null===(i=e.shadowRoot)||void 0===i||null===(c=i.querySelector(".content"))||void 0===c||c.setAttribute("style",`max-width: ${l}; width: calc(var(--calcite-panel-width-multiplier) * 100vw) !important;`),document.querySelectorAll("calcite-action-bar").forEach((e=>{e&&(e.expandDisabled=window.innerWidth<=500)})),t.disconnect()}else t.disconnect()}));t.observe(null===e||void 0===e?void 0:e.shadowRoot,{childList:!0})})),()=>{window.removeEventListener("resize",(()=>{r(Q,P,L,X)})),document.querySelectorAll("calcite-panel").forEach((e=>{null===e||void 0===e||e.removeEventListener("calcitePanelDismissedChange",o)}))}}),[Q]),Object(p.jsxs)("div",{children:[I&&Object(p.jsx)("calcite-progress",{class:`shell calcite-theme-${R}`,type:"indeterminate",value:"0.5"}),Object(p.jsxs)("calcite-shell",{class:`shell calcite-theme-${R}`,children:[P>=1e3?Object(p.jsxs)("calcite-shell-panel",{slot:"primary-panel",position:"start","width-scale":"l",collapsed:!0,children:[Object(p.jsx)("calcite-action-bar",{slot:"action-bar",expanded:!1,children:Q.map((e=>{if(e.isTool)return Object(p.jsxs)("div",{children:[Object(p.jsx)("calcite-tooltip",{placement:"trailing",label:e.title,"reference-element":`${e.container}_action`,children:e.title}),Object(p.jsx)("calcite-tooltip-manager",{children:Object(p.jsx)("calcite-action",{text:e.title,name:e.container,icon:e.icon,id:`${e.container}_action`,disabled:M?null:"",onClick:async t=>{console.log("setActions"),X([...a(t,e,Q)]),requestAnimationFrame((()=>{re(e)}))},active:!0===e.isActive?"":null})})]},`${e.container}_action_primary`)}))}),Q.map((e=>{if(e.isTool&&e.isActive)return Object(p.jsxs)("div",{className:"panel-header",children:[Object(p.jsx)("div",{className:"panel-title",children:e.title}),Object(p.jsxs)("div",{className:"header-actions",children:[ne(!0),Object(p.jsxs)("calcite-tooltip-manager",{children:[Object(p.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"closeAction",placement:"bottom-end",children:"Close panel"}),Object(p.jsx)("calcite-action",{id:"closeAction","aria-label":"Close",appearance:"solid",scale:"m","calcite-hydrated":"",icon:"x",onClick:()=>{var t,l;null===(t=document)||void 0===t||null===(l=t.querySelector("calcite-shell-panel[slot=primary-panel]"))||void 0===l||l.setAttribute("collapsed",""),e.isActive=!1,console.log("setActions"),X([...Q])}})]})]})]},`${e.icon}_header_primary`)})),Q.map((e=>{if(e.isTool)return Object(p.jsx)("div",{id:e.container,className:"action-panel",hidden:!e.isActive},`${e.container}_primary`)}))]}):"",Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(h,{id:e,initialized:async e=>{if(setTimeout((()=>{e.watch("updating",(e=>{"default"===T.current.cursor&&N(e)}))})),!M){T.current=e,W(!0);const t=document.getElementById("propertySearch");e.map&&((e=>{requestAnimationFrame((()=>{var t,l;null===(t=document.querySelector(".identify-widget"))||void 0===t||t.addEventListener("click",(()=>{var t,l,i;ee(),e.popup.autoOpenEnabled=!0,null===(t=document.querySelector(".map-tool.active"))||void 0===t||t.classList.remove("active"),null===(l=document.querySelector(".identify-widget"))||void 0===l||l.classList.add("active"),null===(i=V.current)||void 0===i||i.remove()})),null===(l=document.querySelector(".streetview-widget"))||void 0===l||l.addEventListener("click",(()=>{var t,l,i;ee(),e.popup.autoOpenEnabled=!1,null===(t=document.querySelector(".map-tool.active"))||void 0===t||t.classList.remove("active"),null===(l=document.querySelector(".streetview-widget"))||void 0===l||l.classList.add("active"),null===(i=V.current)||void 0===i||i.remove(),V.current=e.on("click",(e=>{var t,l;null===(t=document.querySelector(".map-tool.active"))||void 0===t||t.classList.remove("active"),null===(l=document.querySelector(".streetview-widget"))||void 0===l||l.classList.add("active");const i=e.mapPoint.latitude+","+e.mapPoint.longitude;window.open("https://maps.google.com?layer=c&cbll="+i+"&cbp=0,0,0,0,0","streetview")}))}))}))})(e),n.a.render(Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(j,{view:e,propertiesSelected:Z,featureSelected:Y,selectedProperties:C,toolActivated:ce})}),t))}},geometryChanged:oe,selectedProperties:C,selectedFeature:z,mapError:()=>{N(!1)},identifyClicked:()=>{ee()}})}),Object(p.jsxs)("calcite-shell-panel",{slot:"contextual-panel",position:"end","width-scale":"l",children:[Object(p.jsx)("calcite-action-bar",{slot:"action-bar",expanded:!1,children:Q.map((e=>{if(!e.isTool||P<1e3)return Object(p.jsxs)("div",{children:[Object(p.jsx)("calcite-tooltip",{placement:"leading",label:e.title,"reference-element":`${e.container}_action`,children:e.title}),Object(p.jsx)("calcite-tooltip-manager",{children:Object(p.jsx)("calcite-action",{text:e.title,name:e.container,icon:e.icon,id:`${e.container}_action`,disabled:M?null:"",onClick:async t=>{console.log("setActions"),X([...a(t,e,Q)]),requestAnimationFrame((()=>{re(e)}))},active:!0===e.isActive?"":null})})]},`${e.container}_action_contextual`)}))}),Q.map((e=>{if((!e.isTool||P<1e3)&&e.isActive)return Object(p.jsxs)("div",{className:"panel-header",children:[Object(p.jsx)("div",{className:"panel-title",children:e.title}),Object(p.jsxs)("div",{className:"header-actions",children:["Property Search"===e.title&&P>500&&Object(p.jsx)("calcite-action",{ref:K,"aria-label":"Maximize",appearance:"solid",scale:"m","calcite-hydrated":"",icon:"left-edge",onClick:e=>{(e=>{var t,l;let i=0;const c=document.querySelector("calcite-shell-panel[slot=primary-panel]");if(c){(null===c||void 0===c?void 0:c.collapsed)||(i+=c.clientWidth);const e=c.querySelector("calcite-action-bar");e&&(i+=null===e||void 0===e?void 0:e.clientWidth)}const n=document.querySelector("calcite-shell-panel[slot=contextual-panel]").querySelector("calcite-action-bar");n&&(i+=null===n||void 0===n?void 0:n.clientWidth);let o=`calc(90vw - ${i}px)`;const a=e.closest("calcite-shell-panel");"right-edge"===e.icon?(e.icon="left-edge",o="350px",null===a||void 0===a||a.removeAttribute("maximized")):(e.icon="right-edge",null===a||void 0===a||a.setAttribute("maximized","")),null===a||void 0===a||null===(t=a.shadowRoot)||void 0===t||null===(l=t.querySelector(".content"))||void 0===l||l.setAttribute("style",`max-width: ${o}; width: calc(var(--calcite-panel-width-multiplier) * 100vw) !important;`);const r=null===a||void 0===a?void 0:a.querySelector("calcite-tab-nav");null===a||void 0===a||a.querySelectorAll("calcite-tab").forEach((e=>{null===e||void 0===e||e.setAttribute("style",`max-width: ${o}`)})),null===r||void 0===r||r.setAttribute("style",`max-width: ${o}`);const s=document.querySelector("calcite-tab-title[active]"),d=document.querySelector("calcite-tab-title:not([active])");s&&setTimeout((()=>{const e=new KeyboardEvent("keydown",{altKey:!1,bubbles:!0,cancelable:!0,charCode:0,code:"Enter",composed:!0,ctrlKey:!1,detail:0,isComposing:!1,key:"Enter",keyCode:13,location:0,metaKey:!1,repeat:!1,shiftKey:!1});null===d||void 0===d||d.dispatchEvent(e),null===s||void 0===s||s.dispatchEvent(e)}),250)})(e.target)}}),ne(!1),Object(p.jsxs)("calcite-tooltip-manager",{children:[Object(p.jsx)("calcite-tooltip",{label:"Tooltip label","reference-element":"closeAction",placement:"bottom-end",children:"Close panel"}),Object(p.jsx)("calcite-action",{id:"closeAction","aria-label":"Close",appearance:"solid",scale:"m","calcite-hydrated":"",icon:"x",onClick:()=>{var t,l;null===(t=document)||void 0===t||null===(l=t.querySelector("calcite-shell-panel[slot=contextual-panel]"))||void 0===l||l.setAttribute("collapsed",""),e.isActive=!1,console.log("setActions"),X([...Q])}})]})]})]},`${e.icon}_header_contextual`)})),Q.map((e=>{if(!e.isTool||P<1e3)return Object(p.jsx)("div",{className:"action-panel",id:e.container,hidden:!e.isActive},`${e.container}_contextual`)}))]}),Object(p.jsx)("div",{slot:"header",children:Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(b,{})})})]}),Object(p.jsx)(i.Suspense,{fallback:"",children:Object(p.jsx)(m,{tips:l,title:E,closed:!0,tipsDismissed:()=>{c([]),q("")}})})]})};t.default=E}}]);
//# sourceMappingURL=199.6c3c97e6.chunk.js.map