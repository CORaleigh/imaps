"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[4994,4397],{84397:(e,t,i)=>{i.d(t,{a:()=>o,c:()=>a,g:()=>r});var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}},14921:(e,t,i)=>{i.d(t,{Ed:()=>o,UI:()=>s,mt:()=>l,q6:()=>n});var a=i(92026),r=i(66978);function o(e,t,i){return(0,r.as)(e.map(((e,a)=>t.apply(i,[e,a]))))}async function s(e,t,i){return(await(0,r.as)(e.map(((e,a)=>t.apply(i,[e,a]))))).map((e=>e.value))}async function n(e){if((0,a.Wi)(e))return{ok:!1,error:new Error("no promise provided")};try{return{ok:!0,value:await e}}catch(t){return{ok:!1,error:t}}}async function l(e){try{return{ok:!0,value:await e}}catch(t){return(0,r.r9)(t),{ok:!1,error:t}}}},41644:(e,t,i)=>{i.d(t,{Bg:()=>a,sM:()=>r});i(93169);function a(e){}function r(e){return()=>e}},93501:(e,t,i)=>{i.d(t,{k:()=>s});var a=i(92026),r=i(68860),o=i(92975);function s(e,t,i){if((0,a.Wi)(t)||(0,a.Wi)(i)||i.vcsWkid||(0,o.fS)(t,i))return null;const s=(0,r._R)(t)/(0,r._R)(i);if(1===s)return null;switch(e){case"point":case"esriGeometryPoint":return e=>function(e,t){e&&null!=e.z&&(e.z*=t)}(e,s);case"polyline":case"esriGeometryPolyline":return e=>function(e,t){if(e)for(const i of e.paths)for(const e of i)e.length>2&&(e[2]*=t)}(e,s);case"polygon":case"esriGeometryPolygon":return e=>function(e,t){if(e)for(const i of e.rings)for(const e of i)e.length>2&&(e[2]*=t)}(e,s);case"multipoint":case"esriGeometryMultipoint":return e=>function(e,t){if(e)for(const i of e.points)i.length>2&&(i[2]*=t)}(e,s);case"extent":case"esriGeometryExtent":return e=>function(e,t){e&&null!=e.zmin&&null!=e.zmax&&(e.zmin*=t,e.zmax*=t)}(e,s);default:return null}}},22528:(e,t,i)=>{i.d(t,{Z:()=>h});var a,r=i(27366),o=i(84652),s=i(49861),n=(i(25243),i(27135)),l=i(69912),d=i(46784);i(63780),i(93169);let u=a=class extends d.wq{constructor(e){super(e),this.name=null,this.code=null}clone(){return new a({name:this.name,code:this.code})}};(0,r._)([(0,s.Cb)({type:String,json:{write:!0}})],u.prototype,"name",void 0),(0,r._)([(0,s.Cb)({type:[String,Number],json:{write:!0}})],u.prototype,"code",void 0),u=a=(0,r._)([(0,l.j)("esri.layers.support.CodedValue")],u);var c,m=i(64538);let p=c=class extends m.Z{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const i=String(e);this.codedValues.some((e=>(String(e.code)===i&&(t=e.name),!!t)))}return t}clone(){return new c({codedValues:(0,o.d9)(this.codedValues),name:this.name})}};(0,r._)([(0,s.Cb)({type:[u],json:{write:!0}})],p.prototype,"codedValues",void 0),(0,r._)([(0,n.J)({codedValue:"coded-value"})],p.prototype,"type",void 0),p=c=(0,r._)([(0,l.j)("esri.layers.support.CodedValueDomain")],p);const h=p},64538:(e,t,i)=>{i.d(t,{Z:()=>c});var a=i(27366),r=i(43404),o=i(46784),s=i(49861),n=(i(63780),i(93169),i(25243),i(27135)),l=i(69912);const d=new r.X({inherited:"inherited",codedValue:"coded-value",range:"range"});let u=class extends o.wq{constructor(e){super(e),this.name=null,this.type=null}};(0,a._)([(0,s.Cb)({type:String,json:{write:!0}})],u.prototype,"name",void 0),(0,a._)([(0,n.J)(d)],u.prototype,"type",void 0),u=(0,a._)([(0,l.j)("esri.layers.support.Domain")],u);const c=u},83040:(e,t,i)=>{i.d(t,{Z:()=>b});var a,r=i(27366),o=i(43404),s=i(46784),n=i(49861),l=(i(63780),i(93169),i(25243)),d=i(27135),u=i(38511),c=i(69912),m=i(67755),p=i(85249);const h=new o.X({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let k=a=class extends s.wq{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(e,t){let i,{description:a}=t;try{i=JSON.parse(a)}catch(r){}return i?i.value:null}readValueType(e,t){let i,{description:a}=t;try{i=JSON.parse(a)}catch(r){}return i?h.fromJSON(i.fieldValueType):null}clone(){return new a({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],k.prototype,"alias",void 0),(0,r._)([(0,n.Cb)({type:[String,Number],json:{write:{allowNull:!0}}})],k.prototype,"defaultValue",void 0),(0,r._)([(0,n.Cb)()],k.prototype,"description",void 0),(0,r._)([(0,u.r)("description")],k.prototype,"readDescription",null),(0,r._)([(0,n.Cb)({types:m.V5,json:{read:{reader:m.im},write:!0}})],k.prototype,"domain",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],k.prototype,"editable",void 0),(0,r._)([(0,n.Cb)({type:l.z8,json:{write:!0}})],k.prototype,"length",void 0),(0,r._)([(0,n.Cb)({type:String,json:{write:!0}})],k.prototype,"name",void 0),(0,r._)([(0,n.Cb)({type:Boolean,json:{write:!0}})],k.prototype,"nullable",void 0),(0,r._)([(0,d.J)(p.v)],k.prototype,"type",void 0),(0,r._)([(0,n.Cb)()],k.prototype,"valueType",void 0),(0,r._)([(0,u.r)("valueType",["description"])],k.prototype,"readValueType",null),k=a=(0,r._)([(0,c.j)("esri.layers.support.Field")],k);const b=k},56754:(e,t,i)=>{i.d(t,{Z:()=>d});var a,r=i(27366),o=(i(32718),i(25243),i(63780),i(93169),i(75366),i(27135)),s=i(69912),n=i(64538);let l=a=class extends n.Z{constructor(e){super(e),this.type="inherited"}clone(){return new a}};(0,r._)([(0,o.J)({inherited:"inherited"})],l.prototype,"type",void 0),l=a=(0,r._)([(0,s.j)("esri.layers.support.InheritedDomain")],l);const d=l},30539:(e,t,i)=>{i.d(t,{Z:()=>u});var a,r=i(27366),o=i(49861),s=(i(63780),i(93169),i(25243),i(27135)),n=i(69912),l=i(64538);let d=a=class extends l.Z{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new a({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,r._)([(0,o.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,i){t[i]=[this.minValue||0,e]}}}})],d.prototype,"maxValue",void 0),(0,r._)([(0,o.Cb)({type:Number,json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range&&t.range[0]},write:{target:"range",writer(e,t,i){t[i]=[e,this.maxValue||0]}}}})],d.prototype,"minValue",void 0),(0,r._)([(0,s.J)({range:"range"})],d.prototype,"type",void 0),d=a=(0,r._)([(0,n.j)("esri.layers.support.RangeDomain")],d);const u=d},67755:(e,t,i)=>{i.d(t,{V5:()=>n,im:()=>l});i(93169);var a=i(22528),r=i(64538),o=i(56754),s=i(30539);const n={key:"type",base:r.Z,typeMap:{range:s.Z,"coded-value":a.Z,inherited:o.Z}};function l(e){if(!e||!e.type)return null;switch(e.type){case"range":return s.Z.fromJSON(e);case"codedValue":return a.Z.fromJSON(e);case"inherited":return o.Z.fromJSON(e)}return null}},85249:(e,t,i)=>{i.d(t,{v:()=>a});const a=new(i(43404).X)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})},80724:(e,t,i)=>{var a,r;function o(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function s(e){return null!=e&&!isNaN(e)&&isFinite(e)}function n(e){return e.valueExpression?a.Expression:e.field&&"string"==typeof e.field?a.Field:a.Unknown}function l(e,t){const i=t||n(e),o=e.valueUnit||"unknown";return i===a.Unknown?r.Constant:e.stops?r.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?r.ClampedLinear:"unknown"===o?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?r.Proportional:r.Additive:r.Identity:r.RealWorldSize}i.d(t,{PS:()=>n,QW:()=>l,RY:()=>a,hL:()=>r,iY:()=>o,qh:()=>s}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(a||(a={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(r||(r={}))},56011:(e,t,i)=>{i.r(t),i.d(t,{getAllSizes:()=>S,getColor:()=>h,getOpacity:()=>k,getRotationAngle:()=>b,getSize:()=>f,getSizeForValue:()=>y,getSizeFromNumberOrVariable:()=>_,getSizeRangeAtScale:()=>g,getVisualVariableValues:()=>w,viewScaleRE:()=>p});var a=i(51995),r=i(52639),o=i(41644),s=i(32718),n=i(92026),l=i(49229),d=i(80724);const u=s.Z.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),c=new r.Z,m=Math.PI,p=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function h(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"color"===e.type)):e;if(!r)return;if("esri.renderers.visualVariables.ColorVariable"!==r.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const o="number"==typeof t,s=o?null:t,l=s&&s.attributes;let d=o?t:null;const c=r.field,{ipData:m,hasExpression:p}=r.cache;let h=r.cache.compiledFunc;if(!c&&!p){const e=r.stops;return e&&e[0]&&e[0].color}if("number"!=typeof d)if(p){if((0,n.Wi)(i)||(0,n.Wi)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,a=t.getViewInfo(e),o=t.createExecContext(s,a);if(!h){const e=t.createSyntaxTree(r.valueExpression);h=t.createFunction(e),r.cache.compiledFunc=h}d=t.executeFunction(h,o)}else l&&(d=l[c]);const k=r.normalizationField,b=l?parseFloat(l[k]):void 0;if(null!=d&&(!k||o||!isNaN(b)&&0!==b)){isNaN(b)||o||(d/=b);const e=B(d,m);if(e){const t=e[0],o=e[1],s=t===o?r.stops[t].color:a.Z.blendColors(r.stops[t].color,r.stops[o].color,e[2],(0,n.pC)(i)?i.color:void 0);return new a.Z(s)}}}function k(e,t,i){const a="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"opacity"===e.type)):e;if(!a)return;if("esri.renderers.visualVariables.OpacityVariable"!==a.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r="number"==typeof t,o=r?null:t,s=o&&o.attributes;let l=r?t:null;const d=a.field,{ipData:c,hasExpression:m}=a.cache;let p=a.cache.compiledFunc;if(!d&&!m){const e=a.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof l)if(m){if((0,n.Wi)(i)||(0,n.Wi)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),s=t.createExecContext(o,r);if(!p){const e=t.createSyntaxTree(a.valueExpression);p=t.createFunction(e),a.cache.compiledFunc=p}l=t.executeFunction(p,s)}else s&&(l=s[d]);const h=a.normalizationField,k=s?parseFloat(s[h]):void 0;if(null!=l&&(!h||r||!isNaN(k)&&0!==k)){isNaN(k)||r||(l/=k);const e=B(l,c);if(e){const t=e[0],i=e[1];if(t===i)return a.stops[t].opacity;{const r=a.stops[t].opacity;return r+(a.stops[i].opacity-r)*e[2]}}}}function b(e,t,i){const a="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"rotation"===e.type)):e;if(!a)return;if("esri.renderers.visualVariables.RotationVariable"!==a.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=a.axis||"heading",o="heading"===r&&"arithmetic"===a.rotationType?90:0,s="heading"===r&&"arithmetic"===a.rotationType?-1:1,l="number"==typeof t?null:t,d=l&&l.attributes,c=a.field,{hasExpression:m}=a.cache;let p=a.cache.compiledFunc,h=0;if(!c&&!m)return h;if(m){if((0,n.Wi)(i)||(0,n.Wi)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),o=t.createExecContext(l,r);if(!p){const e=t.createSyntaxTree(a.valueExpression);p=t.createFunction(e),a.cache.compiledFunc=p}h=t.executeFunction(p,o)}else d&&(h=d[c]||0);return h="number"!=typeof h||isNaN(h)?null:o+s*h,h}function f(e,t,i){const a="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"size"===e.type)):e;if(!a)return;if("esri.renderers.visualVariables.SizeVariable"!==a.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=y(function(e,t,i){const a="number"==typeof t,r=a?null:t,o=r&&r.attributes;let s=a?t:null;const{isScaleDriven:l}=e.cache;let c=e.cache.compiledFunc;if(l){const t=(0,n.pC)(i)?i.scale:void 0,a=(0,n.pC)(i)?i.view:void 0;s=null==t||"3d"===a?function(e){let t=null,i=null;const a=e.stops;return a?(t=a[0].value,i=a[a.length-1].value):(t=e.minDataValue||0,i=e.maxDataValue||0),(t+i)/2}(e):t}else if(!a)switch(e.inputValueType){case d.RY.Expression:{if((0,n.Wi)(i)||(0,n.Wi)(i.arcade))return void u.error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},a=i.arcade.arcadeUtils,o=a.getViewInfo(t),l=a.createExecContext(r,o);if(!c){const t=a.createSyntaxTree(e.valueExpression);c=a.createFunction(t),e.cache.compiledFunc=c}s=a.executeFunction(c,l);break}case d.RY.Field:o&&(s=o[e.field]);break;case d.RY.Unknown:s=null}if(!(0,d.qh)(s))return null;if(a||!e.normalizationField)return s;const m=o?parseFloat(o[e.normalizationField]):null;return(0,d.qh)(m)&&0!==m?s/m:null}(a,t,i),a,t,i,a.cache.ipData);return null==r||isNaN(r)?0:r}function _(e,t,i){return null==e?null:(0,d.iY)(e)?f(e,t,i):(0,d.qh)(e)?e:null}function v(e,t,i){return(0,d.qh)(i)&&e>i?i:(0,d.qh)(t)&&e<t?t:e}function y(e,t,i,a,r){switch(t.transformationType){case d.hL.Additive:return function(e,t,i,a){return e+(_(t.minSize,i,a)||t.minDataValue)}(e,t,i,a);case d.hL.Constant:return function(e,t,i){const a=e.stops;let r=a&&a.length&&a[0].size;return null==r&&(r=e.minSize),_(r,t,i)}(t,i,a);case d.hL.ClampedLinear:return function(e,t,i,a){const r=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),o=_(t.minSize,i,a),s=_(t.maxSize,i,a),l=(0,n.pC)(a)?a.shape:void 0;if(e<=t.minDataValue)return o;if(e>=t.maxDataValue)return s;if("area"===t.scaleBy&&l){const e="circle"===l,t=e?m*(o/2)**2:o*o,i=t+r*((e?m*(s/2)**2:s*s)-t);return e?2*Math.sqrt(i/m):Math.sqrt(i)}return o+r*(s-o)}(e,t,i,a);case d.hL.Proportional:return function(e,t,i,a){const r=(0,n.pC)(a)?a.shape:void 0,o=e/t.minDataValue,s=_(t.minSize,i,a),l=_(t.maxSize,i,a);let d=null;return d="circle"===r?2*Math.sqrt(o*(s/2)**2):"square"===r||"diamond"===r||"image"===r?Math.sqrt(o*s**2):o*s,v(d,s,l)}(e,t,i,a);case d.hL.Stops:return function(e,t,i,a,r){const[o,s,n]=B(e,r);if(o===s)return _(t.stops[o].size,i,a);{const e=_(t.stops[o].size,i,a);return e+(_(t.stops[s].size,i,a)-e)*n}}(e,t,i,a,r);case d.hL.RealWorldSize:return function(e,t,i,a){const r=((0,n.pC)(a)&&a.resolution?a.resolution:1)*l.a[t.valueUnit],o=_(t.minSize,i,a),s=_(t.maxSize,i,a),{valueRepresentation:d}=t;let u=null;return u="area"===d?2*Math.sqrt(e/m)/r:"radius"===d||"distance"===d?2*e/r:e/r,v(u,o,s)}(e,t,i,a);case d.hL.Identity:return e;case d.hL.Unknown:return null}}function g(e,t,i){const{isScaleDriven:a}=e.cache;if(!(a&&"3d"===i||t))return null;const r={scale:t,view:i};let o=_(e.minSize,c,r),s=_(e.maxSize,c,r);if(null!=o||null!=s){if(o>s){const e=s;s=o,o=e}return{minSize:o,maxSize:s}}}function w(e,t,i){if(!e.visualVariables)return;const a=[],r=[],o=[],s=[],n=[];for(const l of e.visualVariables)switch(l.type){case"color":r.push(l);break;case"opacity":o.push(l);break;case"rotation":n.push(l);break;case"size":s.push(l)}return r.forEach((e=>{const r=h(e,t,i);a.push({variable:e,value:r})})),o.forEach((e=>{const r=k(e,t,i);a.push({variable:e,value:r})})),n.forEach((e=>{const r=b(e,t,i);a.push({variable:e,value:r})})),s.forEach((e=>{const r=f(e,t,i);a.push({variable:e,value:r})})),a.filter((e=>null!=e.value))}function B(e,t){if(!t)return;let i=0,a=t.length-1;return t.some(((t,r)=>e<t?(a=r,!0):(i=r,!1))),[i,a,(e-t[i])/(t[a]-t[i])]}function S(e,t,i){const a=["proportional","proportional","proportional"];for(const r of e){const e=r.useSymbolValue?"symbol-value":f(r,t,i);switch(r.axis){case"width":a[0]=e;break;case"depth":a[1]=e;break;case"height":a[2]=e;break;case"width-and-depth":a[0]=e,a[1]=e;break;case"all":case void 0:case null:a[0]=e,a[1]=e,a[2]=e;break;default:(0,o.Bg)(r.axis)}}return a}},23037:(e,t,i)=>{i.d(t,{Bf:()=>p,Bj:()=>b,Df:()=>m,Us:()=>v,aL:()=>_,se:()=>h,tR:()=>k,zb:()=>f});var a=i(29479),r=i(42265),o=i(40281),s=i(32718),n=i(92026),l=i(35995),d=i(25243),u=i(68954);const c=s.Z.getLogger("esri.support.basemapUtils");function m(){return{}}function p(e){for(const t in e){const i=e[t];!1===i?.destroyed&&i.destroy(),delete e[t]}}function h(e,t){let i;if("string"==typeof e){if(!(e in u.s)){const t=Object.entries(u.s).filter((e=>{let[t,i]=e;return r.Z.apiKey&&!i.classic||!r.Z.apiKey&&i.classic&&!i.deprecated})).map((e=>{let[t]=e;return`"${t}"`})).join(", ");return c.warn(`Unable to find basemap definition for: ${e}. Try one of these: ${t}`),null}t&&(i=t[e]),i||(i=a.default.fromId(e),t&&(t[e]=i))}else i=(0,d.se)(a.default,e);return i?.destroyed&&(c.warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function k(e){let t=null;const i=w(e),a=!i.baseLayers.length;for(const r in u.s){const e=C(i,x(u.s[r]),{mustMatchReferences:a});if("equal"===e){t=r;break}"base-layers-equal"===e&&(t=r)}return t}function b(e,t){return e===t||"equal"===C(w(e),w(t),{mustMatchReferences:!0})}function f(e){return!!e?.baseLayers.concat(e.referenceLayers).some(_)}function _(e){if(g(e.url))return!0;if("vector-tile"===e.type)for(const t in e.sourceNameToSource)if(g(e.sourceNameToSource[t]?.sourceUrl))return!0;return!1}function v(e,t){if((0,n.Wi)(t)||(0,n.Wi)(e))return{spatialReference:null,updating:!1};if("not-loaded"===t.loadStatus)return t.load(),{spatialReference:null,updating:!0};if(t.spatialReference)return{spatialReference:t.spatialReference,updating:!1};if(0===t.baseLayers.length)return{spatialReference:null,updating:!1};const i=t.baseLayers.getItemAt(0);switch(i.loadStatus){case"not-loaded":i.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const a=(("supportedSpatialReferences"in i?i.supportedSpatialReferences:null)||["tileInfo"in i?i.tileInfo?.spatialReference:i.spatialReference]).filter(Boolean);return e.spatialReference?{spatialReference:a.find((t=>e.spatialReference.equals(t)))??a[0]??null,updating:!1}:{spatialReference:a[0],updating:!1}}const y=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function g(e){if(!e)return!1;const t=new l.R9((0,l.hF)(e));return y.test(t.authority)}function w(e){return e?!e.loaded&&e.resourceInfo?x(e.resourceInfo.data):{baseLayers:B(e.baseLayers),referenceLayers:B(e.referenceLayers)}:null}function B(e){return(o.Z.isCollection(e)?e.toArray():e).map(S)}function S(e){return{type:e.type,url:T("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible,sublayers:"map-image"!==e.type&&"wms"!==e.type||!(0,n.pC)(e.sublayers)?void 0:e.sublayers?.map((e=>({id:e.id,visible:e.visible}))),activeLayerId:"wmts"===e.type?e.activeLayer?.id:void 0}}function x(e){return e?{baseLayers:E(e.baseMapLayers.filter((e=>!e.isReference))),referenceLayers:E(e.baseMapLayers.filter((e=>e.isReference)))}:null}function E(e){return e.map((e=>function(e){let t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;default:t="unknown"}return{type:t,url:T(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility,sublayers:void 0,activeLayerId:void 0}}(e)))}function C(e,t,i){return null!=e!=(null!=t)?"not-equal":e?I(e.baseLayers,t.baseLayers)?I(e.referenceLayers,t.referenceLayers)?"equal":i.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function I(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!V(e[i],t[i]))return!1;return!0}function V(e,t){if(e.type!==t.type||e.url!==t.url||e.minScale!==t.minScale||e.maxScale!==t.maxScale||e.visible!==t.visible||e.opacity!==t.opacity)return!1;if((0,n.pC)(e.activeLayerId)||(0,n.pC)(t.activeLayerId))return e.activeLayerId===t.activeLayerId;if((0,n.pC)(e.sublayers)||(0,n.pC)(t.sublayers)){if((0,n.Wi)(e.sublayers)||(0,n.Wi)(t.sublayers)||e.sublayers.length!==t.sublayers.length)return!1;for(let i=0;i<e.sublayers.length;i++){const a=e.sublayers.at(i),r=t.sublayers.at(i);if(a.id!==r.id||a.visible!==r.visible)return!1}}return!0}function T(e){return e?(0,l.Fv)(e).replace(/^\s*https?:/i,"").toLowerCase():""}},83558:(e,t,i)=>{i.d(t,{Z:()=>He});var a=i(27366),r=i(98928),o=i(100),s=i(92026),n=i(94172),l=i(8025),d=(i(63780),i(93169),i(89125)),u=i(49861),c=i(69912),m=i(76969),p=i(26838),h=i(69407),k=i(85015);i(25243);let b=class extends k.Z{constructor(e){super(e)}get editedBookmark(){const{bookmark:e}=this;return e?this._get("editedBookmark")||e.clone():null}get state(){return this._get("state")}set state(e){this.validationState=void 0,this.loading=void 0,this._set("state",e)}};(0,a._)([(0,u.Cb)()],b.prototype,"bookmark",void 0),(0,a._)([(0,u.Cb)({readOnly:!0})],b.prototype,"editedBookmark",null),(0,a._)([(0,u.Cb)()],b.prototype,"state",null),(0,a._)([(0,u.Cb)()],b.prototype,"validationState",void 0),(0,a._)([(0,u.Cb)()],b.prototype,"loading",void 0),b=(0,a._)([(0,c.j)("esri.widgets.Bookmarks.UserState")],b);const f=b;var _=i(13894),v=i(40281),y=i(10064),g=i(91505),w=i(32718),B=i(2284),S=i(99505);const x="esri.widgets.Bookmarks.BookmarksViewModel",E=w.Z.getLogger(x),C=v.Z.ofType(B.Z),I={width:128,height:128,format:"png"},V={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0,captureTimeExtent:!0},T={time:!0};let U=class extends((0,S._)(g.Z.EventedAccessor)){constructor(e){super(e),this.abilities={...T},this.activeBookmark=null}destroy(){this.view=null,this._set("activeBookmark",null)}castAbilities(e){return{...T,...e}}set bookmarks(e){void 0!==e?this._override("bookmarks",e):this._clearOverride("bookmarks")}get bookmarks(){return this.get("view.map.bookmarks")||new C}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...V,...e})}get defaultCreateOptions(){return V}set defaultEditOptions(e){this._set("defaultEditOptions",{...V,...e})}get defaultEditOptions(){return V}get state(){const e=this.get("view");return e&&!e.ready?"loading":"ready"}get view(){return this._get("view")}set view(e){e&&"2d"!==e.type&&E.error(new y.Z("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e)}async createBookmark(e){const{view:t,defaultCreateOptions:i,abilities:a}=this;if(!t){const e=new y.Z("create-bookmark:invalid-view","Cannot create a bookmark without a view.");throw E.error(e),e}const{takeScreenshot:r,screenshotSettings:o,captureViewpoint:n,captureRotation:l,captureScale:d,captureTimeExtent:u}={...i,...e},c=r?await this._createThumbnail(o):void 0,m=a.time&&u&&(0,s.pC)(t.timeExtent)?t.timeExtent.clone():void 0;return new B.Z({...c&&{thumbnail:c},...u&&{timeExtent:m},...n&&{viewpoint:this._createViewpoint({view:t,captureScale:d,captureRotation:l})}})}async editBookmark(e,t){const{view:i,defaultEditOptions:a}=this;if(!i){const e=new y.Z("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");throw E.error(e),e}const{takeScreenshot:r,screenshotSettings:o,captureViewpoint:n,captureRotation:l,captureScale:d,captureTimeExtent:u}={...a,...t},c=r?await this._createThumbnail(o):void 0;return c&&(e.thumbnail=c),n&&(e.viewpoint=this._createViewpoint({view:i,captureScale:d,captureRotation:l})),u&&(0,s.pC)(i.timeExtent)&&(e.timeExtent=i.timeExtent.clone()),this.emit("bookmark-edit",{bookmark:e}),e}goTo(e){const{abilities:t,view:i}=this;if(!i){const e=new y.Z("go-to:invalid-view","Cannot go to a bookmark without a view");return E.error(e),Promise.reject(e)}const a=e?.viewpoint;if(!a){const t=new y.Z("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:e});return E.error(t),Promise.reject(t)}this._set("activeBookmark",e);const r={target:a},o=this.callGoTo(r),s=e?.timeExtent;return t.time&&s&&(i.timeExtent=s),this.emit("bookmark-select",{bookmark:e}),o.catch((()=>{})).then((()=>this._set("activeBookmark",null))),o}async _createThumbnail(e){const t=await this.view.takeScreenshot({...I,...e});return new p.A({url:t.dataUrl})}_createViewpoint(e){let{view:t,captureRotation:i,captureScale:a}=e;const r=t.viewpoint?.clone();return new _.Z({targetGeometry:t.extent?.clone(),rotation:i&&r?.rotation||0,scale:a&&r?.scale||0})}};(0,a._)([(0,u.Cb)()],U.prototype,"abilities",void 0),(0,a._)([(0,d.p)("abilities")],U.prototype,"castAbilities",null),(0,a._)([(0,u.Cb)({readOnly:!0})],U.prototype,"activeBookmark",void 0),(0,a._)([(0,u.Cb)({type:C})],U.prototype,"bookmarks",null),(0,a._)([(0,u.Cb)()],U.prototype,"defaultCreateOptions",null),(0,a._)([(0,u.Cb)()],U.prototype,"defaultEditOptions",null),(0,a._)([(0,u.Cb)({readOnly:!0})],U.prototype,"state",null),(0,a._)([(0,u.Cb)({value:null})],U.prototype,"view",null),U=(0,a._)([(0,c.j)(x)],U);const A=U;var R=i(70098),N=i(61524),M=i(96919),F=i(80975),L=i(80532),z=i(93531),O=i(67005),Z=i(70281);const q="data-bookmark-uid",D="esri-bookmarks esri-widget--panel",j="esri-bookmarks__loader-container",P="esri-bookmarks__loader",W="esri-bookmarks__list",H="esri-bookmarks__list--sortable",J="esri-bookmarks__bookmark",G="esri-bookmarks__bookmark-button",Y="esri-bookmarks__bookmark-image-container",$="esri-bookmarks__bookmark-edit-button-container",X="esri-bookmarks__bookmark-edit-button",K="esri-bookmarks_bookmark-drag-handle",Q="esri-bookmarks_bookmark-drag-handle-icon",ee="esri-bookmarks__bookmark-icon",te="esri-bookmarks__image",ie="esri-bookmarks__bookmark-label",ae="esri-bookmarks__bookmark-name",re="esri-bookmarks__bookmark-time-extent",oe="esri-bookmarks__bookmark--active",se="esri-widget__content--empty",ne="esri-bookmarks__no-bookmarks-heading",le="esri-widget__no-bookmark-icon",de="esri-bookmarks__no-bookmarks-description",ue="esri-bookmarks__adding-bookmark",ce="esri-bookmarks__add-bookmark",me="esri-bookmarks__add-bookmark-button",pe="esri-bookmarks__add-bookmark-icon",he="esri-bookmarks__authoring-card",ke="esri-bookmarks__authoring-container",be="esri-bookmarks__authoring-form",fe="esri-bookmarks__authoring-label",_e="esri-bookmarks__authoring-actions",ve="esri-bookmarks__authoring-input--invalid",ye="esri-bookmarks__authoring-delete-button",ge="esri-bookmarks__authoring-cancel-button",we="esri-bookmarks__time-extent-container",Be="esri-bookmarks__time-extent",Se="esri-bookmarks__time-extent-group",xe="esri-bookmarks__time-extent-date",Ee="esri-bookmarks__time-extent-time",Ce="esri-widget",Ie="esri-widget--disabled",Ve="esri-button",Te="esri-button--tertiary",Ue="esri-input",Ae="esri-icon-handle-vertical",Re="esri-icon-plus",Ne="esri-icon-edit",Me="esri-icon-handle-horizontal",Fe="esri-icon-refresh",Le="esri-icon-link",ze="esri-icon-erase",Oe="esri-icon-bookmark",Ze="esri-widget__heading",qe="esri-icon-loading-indicator",De="esri-rotating",je={addBookmark:!0,thumbnail:!0,time:!0},Pe=/^https:\/\/.*/i;let We=class extends h.Z{constructor(e,t){super(e,t),this._handles=new o.Z,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._editIncludeTimeExtent=null,this._userState=null,this.defaultCreateOptions=null,this.defaultEditOptions=null,this.bookmarks=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.goToOverride=null,this.iconClass=Oe,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.view=null,this.viewModel=new A,this.visibleElements={...je}}initialize(){this.own([(0,n.YP)((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),n.nn),(0,n.YP)((()=>this.editingEnabled),(()=>this._toggleSorting()),n.nn)])}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy()}loadDependencies(){return Promise.all([i.e(1507).then(i.bind(i,51507)),Promise.all([i.e(895),i.e(8695)]).then(i.bind(i,68695))])}get _editMenuItems(){const{messages:e,_userState:t}=this,i=t?.editedBookmark?.thumbnail?.url;return[new N.Z({label:e?.menu.refreshThumbnail,iconClass:Fe,clickFunction:()=>this._refreshThumbnail()}),new N.Z({label:Pe.test(i)?e?.menu.editImageUrl:e?.menu.useImageUrl,iconClass:Le,clickFunction:()=>this._startUseImageUrl()}),i?new N.Z({label:e?.menu.removeThumbnail,iconClass:ze,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:e,messages:t,disabled:i}=this,a=this._get("_editMenu");a&&a.destroy();const r=new R.Z({disabled:i,iconClass:Me,label:t?.menu.label});return r.items=e,r}castVisibleElements(e){return{...je,...e}}endAddBookmark(){this._userState=null}goTo(e){return this.viewModel.goTo(e)}render(){const{state:e}=this.viewModel,t="loading"===e?this.renderLoading():this.renderBookmarks();return(0,O.u)("div",{class:this.classes(D,Ce,{[Ie]:this.disabled})},t)}startAddBookmark(){this._userState=new f({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}renderLoading(){return(0,O.u)("div",{class:j,key:"loader",tabIndex:this.disabled?-1:null},(0,O.u)("div",{class:P}))}renderNoBookmarksContainer(){const{messages:e,disabled:t}=this;return(0,O.u)("div",{class:se,key:"no-bookmarks",tabIndex:t?-1:null},(0,O.u)("span",{"aria-hidden":"true",class:this.classes(le,Oe)}),(0,O.u)(M.X6,{level:this.headingLevel,class:this.classes(Ze,ne)},e?.noBookmarksHeading),(0,O.u)("p",{class:de},e?.noBookmarksDescription))}renderAddBookmarkLoading(){return(0,O.u)("div",{key:"adding-bookmark",class:ue},(0,O.u)("span",{"aria-hidden":"true",class:this.classes(qe,De)}),this.messages?.addingBookmark)}renderBookmarkItems(e){if(!e)return null;const{_userState:t,editingEnabled:i}=this;return e.map((e=>i&&e&&t&&("edit"===t.state||"edit-thumbnail"===t.state)&&t.bookmark===e?"edit-thumbnail"===t.state?this.renderEditingBookmarkUrl(t.editedBookmark):this.renderEditingBookmark(t.editedBookmark):this.renderBookmark(e))).toArray()}renderBookmarksContainer(e){const{_userState:t,editingEnabled:i,disabled:a}=this,r="add"===t?.state,o=i&&!r?this.renderAddBookmarkButton():null,s=i?r&&t.loading?this.renderAddBookmarkLoading():"add"===t?.state?this.renderAddingBookmark():null:null;return[(0,O.u)("ul",{key:"bookmark-list","aria-label":this.messages?.widgetLabel,class:this.classes(W,{[H]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this,tabIndex:a?-1:null},this.renderBookmarkItems(e)),o,s]}renderAddBookmarkButton(){return this.visibleElements.addBookmark?(0,O.u)("div",{key:"add-bookmark-item",class:ce},(0,O.u)("button",{class:this.classes(Ve,Te,me),disabled:this.disabled,onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},(0,O.u)("span",{"aria-hidden":"true",class:this.classes(pe,Re)}),this.messages?.addBookmark)):null}renderBookmarks(){const{bookmarks:e}=this.viewModel,t=e&&e.filter(Boolean),i=t&&t.length,a=i||this.editingEnabled?this.renderBookmarksContainer(t):null;return[i?null:this.renderNoBookmarksContainer(),a]}renderEditContainer(e){const{messagesCommon:t,disabled:i}=this;return(0,O.u)("div",{class:$,key:"edit-container"},(0,O.u)("button",{disabled:i,title:t?.edit,"aria-label":t?.edit,"data-bookmark":e,onclick:this._showEditBookmarkForm,bind:this,class:X,type:"button"},(0,O.u)("span",{"aria-hidden":"true",class:Ne})))}renderDragHandle(e){const{messagesCommon:t,disabled:i}=this,a={[q]:e.uid};return(0,O.u)("div",{role:"button",tabIndex:i?-1:0,key:"drag-handle",bind:this,class:K,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===e.uid?"true":"false","aria-label":t?.dragHandleLabel,title:t?.dragHandleTitle,...a},(0,O.u)("span",{"aria-hidden":"true",class:this.classes(Q,Ae)}))}renderBookmarkImageIcon(){return(0,O.u)("span",{"aria-hidden":"true",class:this.classes(ee,Oe)})}renderBookmarkImage(e){const{visibleElements:t}=this,{thumbnail:i}=e,a=i&&i.url||"";return t.thumbnail&&a?(0,O.u)("img",{src:a,alt:"",class:te}):null}renderBookmarkTimeSwitch(e){const{messages:t,disabled:i}=this,{timeExtent:a}=e,{view:r}=this.viewModel;return r.timeExtent||a?(0,O.u)("calcite-label",{layout:"inline-space-between","disable-spacing":"true"},t.includeTimeExtent,(0,O.u)("calcite-switch",{scale:"s",disabled:i,checked:!!a,onCalciteSwitchChange:e=>this._editIncludeTimeExtent=!!e.detail.switched})):null}renderBookmarkTimeExtent(e){const{visibleElements:t}=this,{timeExtent:i}=e;return i?(0,O.u)("span",{class:Be},[(0,s.pC)(i.start)&&(0,O.u)("span",{key:"start-date-group",class:Se},(0,O.u)("span",{key:"start-date",class:xe},this._formatDate(i.start)),t.time&&(0,O.u)("span",{key:"start-time",class:Ee},this._formatTime(i.start))),(0,s.pC)(i.end)&&((0,s.Wi)(i.start)||i.start.getTime()!==i.end.getTime())&&(0,O.u)("span",{key:"end-date-group",class:Se},(0,O.u)("span",{key:"end-date",class:xe},this._formatDate(i.end)),t.time&&(0,O.u)("span",{key:"end-time",class:Ee},this._formatTime(i.end)))]):null}renderBookmarkButton(e){const{messagesCommon:t,disabled:i}=this,{name:a,timeExtent:r}=e,{abilities:o}=this.viewModel,s=a||t?.untitled,n=(0,O.u)("div",{class:Y},this.renderBookmarkImage(e)||this.renderBookmarkImageIcon()),l=o.time&&r?(0,O.u)("span",{key:"time-extent",class:re},this.renderBookmarkTimeExtent(e)):null;return(0,O.u)("button",{disabled:i,key:"bookmark-button",class:G,bind:this,"data-bookmark":e,onclick:this._goToBookmark,type:"button"},n,(0,O.u)("div",{class:ie},(0,O.u)("span",{key:"bookmark-title",class:ae},s),l))}renderBookmark(e){const{activeBookmark:t}=this.viewModel,i={[oe]:t===e},a=this.editingEnabled?this.renderEditContainer(e):null,r={[q]:e.uid},o=this.editingEnabled?this.renderDragHandle(e):null;return(0,O.u)("li",{key:e,class:this.classes(J,i),...r},o,this.renderBookmarkButton(e),a)}renderEditingBookmarkName(e){const{messages:t,_userState:i,disabled:a}=this,r="name-required"===i.validationState;return(0,O.u)("label",{class:fe},t?.title,r?(0,O.u)("strong",null,t?.invalidTitle):null,(0,O.u)("input",{required:!0,disabled:a,bind:this,class:this.classes(Ue,r?ve:null),type:"text",value:e.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":e,"data-node-ref":"_editInputNode",placeholder:t?.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:e,disabled:t}=this;return(0,O.u)("div",{class:_e},(0,O.u)("input",{type:"button",disabled:t,value:e?.back,class:this.classes(Ve,Te),onclick:this._closeUrlEditBookmarkForm,bind:this}),(0,O.u)("input",{class:Ve,disabled:t,type:"submit",value:e?.add}))}renderEditingBookmarkActions(){const{messagesCommon:e,disabled:t}=this,{bookmark:i}=this._userState;return(0,O.u)("div",{class:_e},(0,O.u)("input",{type:"button",disabled:t,value:e?.delete,class:this.classes(Ve,Te,ye),"data-bookmark":i,onclick:this._deleteBookmark,bind:this}),(0,O.u)("input",{disabled:t,type:"button",value:e?.cancel,class:this.classes(Ve,Te),onclick:this._closeEditBookmarkForm,bind:this}),(0,O.u)("input",{class:Ve,disabled:t,type:"submit",value:e?.save}))}renderEditingBookmarkUrlInput(e){const{messages:t,_userState:i,disabled:a}=this,r=e.thumbnail?.url,o=Pe.test(r)?r:null,s="absolute-url-required"===i.validationState;return(0,O.u)("label",{class:fe},s?(0,O.u)("strong",null,t?.invalidImageUrl):null,(0,O.u)("input",{required:!0,disabled:a,bind:this,class:this.classes(Ue,s?ve:null),type:"text",value:o,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":e,"data-node-ref":"_urlEditInputNode",title:t?.imageUrlTooltip,placeholder:t&&`https://<${t.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(e){const t={[q]:e.uid};return(0,O.u)("li",{key:"edit-bookmark-url-form",class:he,...t},(0,O.u)("form",{class:be,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(e),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(e){const t={[q]:e.uid},{abilities:i}=this.viewModel,a=i.time?(0,O.u)("div",{key:"edit-bookmark-time-container",class:we},this.renderBookmarkTimeSwitch(e),this._editIncludeTimeExtent&&this.renderBookmarkTimeExtent(e)):null;return(0,O.u)("li",{key:"edit-bookmark-form",class:he,...t},(0,O.u)("form",{class:be,disabled:this.disabled,onsubmit:this._editBookmarkSubmit,bind:this},(0,O.u)("div",{class:ke},(0,O.u)("div",{class:Y},this.renderBookmarkImage(e),this._editMenu.render()),this.renderEditingBookmarkName(e)),a,this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:e,messages:t,disabled:i}=this,a="name-required"===e.validationState;return(0,O.u)("label",{class:fe},t?.title,a?(0,O.u)("strong",null,t?.invalidTitle):null,(0,O.u)("input",{required:!0,disabled:i,bind:this,class:this.classes(Ue,a?ve:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:t?.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:e,disabled:t}=this;return(0,O.u)("div",{class:this.classes(_e)},(0,O.u)("input",{type:"button",disabled:t,value:e?.cancel,class:this.classes(Ve,Te,ge),onclick:this._endAddBookmark.bind(this),bind:this}),(0,O.u)("input",{class:Ve,disabled:t,type:"submit",value:e?.add}))}renderAddingBookmark(){return(0,O.u)("div",{key:"add-bookmark-form",class:he},(0,O.u)("form",{class:be,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_formatDate(e){return e?(0,m.p6)(e,(0,m.Ze)("short-date")):null}_formatTime(e){return e?(0,m.p6)(e,(0,m.Ze)("long-time")):null}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(e){const{_sortableSavedItems:t}=this,i=(0,r.kK)(e);if(!["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"].includes(i))return;const{_sortable:a,_selectedSortUid:o}=this,s=a.toArray(),n=e.target.getAttribute(q),l=s.indexOf(n);if((0,F.pf)(i)){const e=o&&o===n;return this._selectedSortUid=e?null:n,this._sortableSavedItems=e?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===i)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===i&&t)return e.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(t,a,n),void this.scheduleRender();if(-1===l||!o)return;const d="ArrowUp"===i?l-1:l+1;d>=s.length||d<=-1||(function(e,t,i){e.splice(i,0,e.splice(t,1)[0])}(s,l,d),this._updateSortItems(s,a,n))}_updateSortItems(e,t,i){t.sort(e),this._sortBookmarks(t),this._focusSortUid=i,this._selectedSortUid=i}_focusDragHandle(e){const{_focusSortUid:t}=this;e&&t&&e.getAttribute(q)===t&&(e.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:e,_sortableNode:t,editingEnabled:i,disabled:a}=this;if(t)if(e)e.option("disabled",a||!i);else{const e=Z.ZP.create(t,{dataIdAttr:q,handle:`.${K}`,group:"bookmarks",disabled:a||!i,onSort:()=>this._sortBookmarks(e)});this._sortable=e}}_sortNodeCreated(e){this._sortableNode=e,this._toggleSorting()}_sortBookmarks(e){const{bookmarks:t}=this.viewModel;if(!t)return;const i=e.toArray();t.sort(((e,t)=>{const a=i.indexOf(e.uid),r=i.indexOf(t.uid);return a>r?1:a<r?-1:0}))}_destroySortable(){const{_sortable:e}=this;e&&e.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const e="bookmarks-init",{_handles:t}=this;t.remove(e),t.add((0,n.on)((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),e)}_bookmarksChanged(){const e="bookmarks-change",{bookmarks:t}=this.viewModel,{_handles:i}=this;i.remove(e);const a=t.map((e=>(0,n.YP)((()=>[e?.name,e?.thumbnail?.url]),(()=>this.scheduleRender()))));i.add(a,e),this.scheduleRender()}_showEditBookmarkForm(e){const t=e.currentTarget["data-bookmark"];this._editIncludeTimeExtent=!!t.timeExtent,this._focusEditInputBox=!0,this._userState=new f({bookmark:t,state:"edit"}),this.viewModel.goTo(t),this.scheduleRender()}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit"}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(e){e.preventDefault();const{_addInputNode:t,_userState:i}=this,a=t&&t.value.trim();a?(i.loading=!0,this.viewModel.createBookmark().then((e=>{e.name=a,this.viewModel.bookmarks.add(e),this._endAddBookmark()}))):i.validationState="name-required"}async _editBookmarkAndClose(e,t){const{viewModel:i}=this;await i.editBookmark(e,{...i.defaultEditOptions,...t}),this._closeEditBookmarkForm()}_editBookmarkSubmit(e){e.preventDefault();const{_editInputNode:t,_userState:i,_editIncludeTimeExtent:a}=this,r=t&&t.value.trim();r?(i.bookmark.name=r,i.bookmark.thumbnail=i.editedBookmark.thumbnail,a||(i.bookmark.timeExtent=null),this._editBookmarkAndClose(i.bookmark,{takeScreenshot:!1,captureTimeExtent:a})):i.validationState="name-required"}_storeAddBookmarkButton(e){this._addBookmarkButtonNode=e,this._focusAddBookmark()}_storeEditInput(e){this._editInputNode=e,this._focusEditInput()}_storeAddInput(e){this._addInputNode=e,this._focusAddInput()}_storeUrlEditInput(e){this._urlEditInputNode=e,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(e){const t=e.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(t)}_goToBookmark(e){const t=e.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(t)}async _refreshThumbnail(){const{_userState:e,_editMenu:t,viewModel:i}=this;e.validationState=void 0,await i.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_removeThumbnail(){const{_userState:e,_editMenu:t}=this;e.editedBookmark.thumbnail=null,e.validationState=void 0,t.open=!1,this._focusEditInputBox=!0,this.scheduleRender()}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(e){e.preventDefault();const{_urlEditInputNode:t,_userState:i}=this,a=t.value;Pe.test(a)?(a&&(i.editedBookmark.thumbnail=new p.A({url:a})),this._closeUrlEditBookmarkForm()):i.validationState="absolute-url-required"}};(0,a._)([(0,u.Cb)()],We.prototype,"_editIncludeTimeExtent",void 0),(0,a._)([(0,u.Cb)({type:f})],We.prototype,"_userState",void 0),(0,a._)([(0,u.Cb)({readOnly:!0})],We.prototype,"_editMenuItems",null),(0,a._)([(0,u.Cb)({readOnly:!0})],We.prototype,"_editMenu",null),(0,a._)([(0,l.B)("viewModel.defaultCreateOptions")],We.prototype,"defaultCreateOptions",void 0),(0,a._)([(0,l.B)("viewModel.defaultEditOptions")],We.prototype,"defaultEditOptions",void 0),(0,a._)([(0,l.B)("viewModel.bookmarks")],We.prototype,"bookmarks",void 0),(0,a._)([(0,u.Cb)()],We.prototype,"disabled",void 0),(0,a._)([(0,u.Cb)()],We.prototype,"editingEnabled",void 0),(0,a._)([(0,u.Cb)()],We.prototype,"headingLevel",void 0),(0,a._)([(0,l.B)("viewModel.goToOverride")],We.prototype,"goToOverride",void 0),(0,a._)([(0,u.Cb)()],We.prototype,"iconClass",void 0),(0,a._)([(0,u.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],We.prototype,"label",void 0),(0,a._)([(0,u.Cb)(),(0,L.H)("esri/widgets/Bookmarks/t9n/Bookmarks")],We.prototype,"messages",void 0),(0,a._)([(0,u.Cb)(),(0,L.H)("esri/t9n/common")],We.prototype,"messagesCommon",void 0),(0,a._)([(0,u.Cb)(),(0,L.H)("esri/core/t9n/Units")],We.prototype,"messagesUnits",void 0),(0,a._)([(0,u.Cb)()],We.prototype,"uiStrings",void 0),(0,a._)([(0,l.B)("viewModel.view")],We.prototype,"view",void 0),(0,a._)([(0,u.Cb)({type:A}),(0,z.s)(["select-bookmark","bookmark-edit","bookmark-select"])],We.prototype,"viewModel",void 0),(0,a._)([(0,u.Cb)()],We.prototype,"visibleElements",void 0),(0,a._)([(0,d.p)("visibleElements")],We.prototype,"castVisibleElements",null),(0,a._)([(0,u.Cb)()],We.prototype,"endAddBookmark",null),(0,a._)([(0,u.Cb)()],We.prototype,"startAddBookmark",null),We=(0,a._)([(0,c.j)("esri.widgets.Bookmarks")],We);const He=We},96919:(e,t,i)=>{i.d(t,{MJ:()=>d,X6:()=>n});var a=i(16889),r=i(80975),o=i(67005);const s="esri-widget__heading";function n(e,t){const i=l(e.level),a=`h${i}`;return delete e.level,(0,o.u)(a,{...e,class:(0,r.Sh)(s,e.class),role:"heading","aria-level":String(i)},t)}function l(e){return(0,a.uZ)(Math.ceil(e),1,6)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return l(e+t)}}}]);
//# sourceMappingURL=4994.05dc5b83.chunk.js.map