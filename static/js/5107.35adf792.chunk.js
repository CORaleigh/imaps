"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[5107],{35107:(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});var i=s(27366),n=s(92026),r=s(66978),a=s(68860),l=s(49861),o=(s(25243),s(63780),s(69912)),u=s(69407),h=s(100),c=s(94172),d=s(79803),m=s(77671),p=(s(59486),s(52639)),_=(s(59166),s(51508),s(70148)),v=s(5163),y=s(2170),b=s(15559),w=s(93655),g=s(50951),f=s(9843),C=s(74229),M=s(2346),L=s(45900),D=s(41201),S=s(36257),T=s(585),k=s(75021),O=s(58009),I=s(73268),U=s(16072),$=s(29909),Z=s(78952);const x=1e5;let A=class extends L.m{constructor(e){super(e),this._drawActive=!1,this._measurementLayer=new w.Z({internal:!0,listMode:"hide",visible:!1}),this._manipulatorLayer=new w.Z({internal:!0,listMode:"hide",visible:!1}),this._vertices=[],this.geodesicDistanceThreshold=1e5,this.measurement=null,this.measurementLabel=null}initialize(){(0,D.ME)("esri/core/t9n/Units").then((e=>{this.messages=e})),this.addHandles((0,S.qe)((async()=>{this.messages=await(0,D.ME)("esri/core/t9n/Units")})));const e=this.view;this._draw=new f.Z({view:e}),e.map.addMany([this._measurementLayer,this._manipulatorLayer]),e.focus(),this.addHandles((0,c.YP)((()=>[this.unit,this.geodesicDistanceThreshold,this.messages]),(()=>{this._updatePolylines()}),c.nn))}destroy(){const{map:e}=this.view;this._draw.view=null,this._draw=(0,n.SC)(this._draw),e.removeMany([this._measurementLayer,this._manipulatorLayer]),this._measurementLayer.removeAll(),this._manipulatorLayer.removeAll(),this._set("measurement",null),this._set("measurementLabel",null),this._measurementLayer=(0,n.SC)(this._measurementLayer),this._manipulatorLayer=(0,n.SC)(this._manipulatorLayer),this._resetVertices()}get cursor(){return this._drawActive?"crosshair":null}set editable(e){this._set("editable",e),e||this._draw.reset()}onActivate(){this._drawActive||0!==this._vertices.length||this._startSketch()}onShow(){this._measurementLayer.visible=!0,this._manipulatorLayer.visible=!0}onHide(){this._measurementLayer.visible=!1,this._manipulatorLayer.visible=!1}reset(){this._resetVertices(),this._measurementLayer.removeAll(),this._set("measurement",null),this._set("measurementLabel",null),this._draw.reset(),this._drawActive=!1,this._updateSketch([])}_resetVertices(){for(const{handle:e}of this._vertices)e.remove();this._vertices=[]}_startSketch(){this._drawActive=!0;const e=this._draw.create("polyline",{mode:"click"});e.on(["vertex-add","vertex-update","vertex-remove","cursor-update","undo","redo"],(e=>this._updateSketch(e.vertices))),e.on("draw-complete",(()=>{this._stopSketch()}))}_stopSketch(){this.manipulators.forEach((e=>{let{manipulator:t}=e;t.interactive=!0})),this._drawActive=!1,this.finishToolCreation()}_updateSketch(e){const{spatialReference:t}=this.view;for(;this._vertices.length>e.length;){const{handle:e,manipulator:t}=this._vertices.pop();e.remove(),this.manipulators.remove(t)}for(let n=this._vertices.length;n<e.length;n++){const[s,i]=e[n],r=R(new T.Z({x:s,y:i,spatialReference:t}),this.view,this._manipulatorLayer);this.manipulators.add(r);const a=(0,C.Xd)(r,((e,t)=>{t.next((0,C.Cf)(this.view)).next((0,C.a9)(e.graphic,g.JY.Local)).next((()=>{const t=e.graphic.geometry;this._vertices[n].coord=[t.x,t.y],this._updatePolylines()}))}));this._vertices.push({manipulator:r,coord:[s,i],handle:a})}const s=this._vertices.length-1,i=this._vertices[s],[r,a]=e[s];i.coord[0]===r&&i.coord[1]===a||(i.coord=[r,a],i.manipulator.graphic.geometry=new T.Z({x:r,y:a,spatialReference:t}));const l=this._drawActive?this._vertices[s].manipulator:null;this.manipulators.forEach((e=>{let{manipulator:t}=e;t.interactive=(0,n.Wi)(l)||t!==l})),this._updatePolylines()}_updatePolylines(){if(this._vertices.length<2)return void this._measurementLayer.removeAll();const e=this._vertices.map((e=>{let{coord:t}=e;return t})),{measurement:t,drawing:s,original:i}=function(e,t,s){const i=new $.Z({paths:[e],spatialReference:t});let n,r;if(t.isGeographic)if((0,b.Gb)(t))n=(0,b.Jf)([i],"meters")[0],r=(0,b.j2)(i,x);else{const e=(0,d.iV)(i,Z.Z.WGS84),s=(0,b.j2)(e,x);n=(0,b.Jf)([e],"meters")[0],r=(0,d.iV)(s,t)}else if(t.isWebMercator)n=(0,y.geodesicLength)(i,"meters"),r=(0,y.geodesicDensify)(i,x,"meters");else{const e=(0,y.planarLength)(i,"meters");if(e>=s){const e=(0,d.iV)(i,Z.Z.WGS84),s=(0,b.j2)(e,x);n=(0,b.Jf)([e],"meters")[0],r=(0,d.iV)(s,t)}else n=e,r=i}return{measurement:{geometry:r,length:n},original:i,drawing:r}}(e,this.view.spatialReference,this.geodesicDistanceThreshold);this._set("measurement",t);const n=function(e,t,s){if(!t||!e)return null;switch(s){case"metric":return(0,v.Rd)(e,t.length,"meters");case"imperial":return(0,v.Ud)(e,t.length,"meters");default:return(0,v.VG)(e,(0,a.En)(t.length,"meters",s),s)}}(this.messages,t,this.unit);let r,l;this._set("measurementLabel",n);const{graphics:o}=this._measurementLayer;2===o.length?(r=o.at(0),l=o.at(1)):(r=new p.Z({symbol:new k.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[14,12],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",width:3.5,color:(0,_.RN)().toArray()},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:5,color:(0,_.e9)().toArray()}]}}})}),l=new p.Z({symbol:new O.Z({color:(0,_.uu)(),haloColor:(0,_.hU)(.5),haloSize:2,font:new I.Z({size:14,family:"sans-serif"})})}),o.removeAll(),o.addMany([r,l])),r.geometry=s,l.geometry=i.extent.center,l.symbol.text=n}};function R(e,t,s){const i=(0,_.e9)(.5),n={type:"simple-line",width:0},r=new U.Z({style:"circle",color:i,size:8,outline:n}),a=new U.Z({style:"circle",color:i,size:12,outline:n}),l=new p.Z({geometry:e,symbol:r});return new M.L({view:t,layer:s,graphic:l,focusedSymbol:a})}(0,i._)([(0,l.Cb)()],A.prototype,"_drawActive",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],A.prototype,"cursor",null),(0,i._)([(0,l.Cb)({value:!0})],A.prototype,"editable",null),(0,i._)([(0,l.Cb)({type:Number})],A.prototype,"geodesicDistanceThreshold",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],A.prototype,"measurement",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],A.prototype,"measurementLabel",void 0),(0,i._)([(0,l.Cb)()],A.prototype,"messages",void 0),(0,i._)([(0,l.Cb)()],A.prototype,"unit",void 0),(0,i._)([(0,l.Cb)({constructOnly:!0})],A.prototype,"view",void 0),A=(0,i._)([(0,o.j)("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DTool")],A);var V=s(32845);let E=class extends V.V{constructor(e){super(e),this.supportedViewType="2d",this.unsupportedErrorMessage="DistanceMeasurement2DViewModel is only supported in 2D views.",this._handles=new h.Z,this.geodesicDistanceThreshold=1e5}initialize(){this._handles.add([(0,c.YP)((()=>(0,n.Wg)(this.view)?.spatialReference),(()=>this.clear())),(0,c.YP)((()=>this.unit),(e=>{(0,n.pC)(this.tool)&&(this.tool.unit=e)}),c.nn),(0,c.YP)((()=>this.geodesicDistanceThreshold),(e=>{(0,n.pC)(this.tool)&&(this.tool.geodesicDistanceThreshold=e)}),c.nn)])}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}get measurement(){return(0,n.pC)(this.tool)?this.tool.measurement:null}get measurementLabel(){return(0,n.pC)(this.tool)?this.tool.measurementLabel:null}get state(){return this.disabled||(0,n.Wi)(this.view)||(e=this.view?.spatialReference,null==e)?"disabled":(0,n.pC)(this.tool)&&this.measurement?this.tool.active?"measuring":"measured":"ready";var e}get unit(){return this._validateUnit(this.defaultUnit)}set unit(e){this._overrideIfSome("unit",this._validateUnit(e))}get unitOptions(){return a.oD}set unitOptions(e){this._overrideIfSome("unitOptions",this._validateUnits(e))}async start(){const e=this.view;(0,n.pC)(e)&&(await(0,c.N1)((()=>e.ready)),function(e){if(!e)return!1;const{isGeographic:t,isWebMercator:s,isWGS84:i}=e;return t&&!i&&!(0,b.Gb)(e)||!t&&!s}(e.spatialReference)&&await(0,d.zD)()),this.createTool({interactive:!0})}clear(){this.removeTool()}constructTool(){return new A({view:(0,n.Wg)(this.view),visible:this.visible,geodesicDistanceThreshold:this.geodesicDistanceThreshold,unit:this.unit})}_validateUnit(e){return this.unitOptions.includes(e)?e:this.unitOptions.includes(this.defaultUnit)?this.defaultUnit:this.unitOptions[0]}_validateUnits(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((e=>a.oD.includes(e)));return 0===e.length?a.oD.slice():e}};(0,i._)([(0,l.Cb)(m.Y)],E.prototype,"defaultUnit",void 0),(0,i._)([(0,l.Cb)({type:Number})],E.prototype,"geodesicDistanceThreshold",void 0),(0,i._)([(0,l.Cb)({readOnly:!0})],E.prototype,"measurement",null),(0,i._)([(0,l.Cb)({readOnly:!0})],E.prototype,"measurementLabel",null),(0,i._)([(0,l.Cb)({readOnly:!0})],E.prototype,"state",null),(0,i._)([(0,l.Cb)({type:String})],E.prototype,"unit",null),(0,i._)([(0,l.Cb)({type:[String]})],E.prototype,"unitOptions",null),E=(0,i._)([(0,o.j)("esri.widgets.DistanceMeasurement2D.DistanceMeasurement2DViewModel")],E);const W=E;var G=s(78088),P=s(80532),j=s(67005);s(80975);const z="esri-distance-measurement-2d",Y=`${z}__measurement`,B=`${z}__units`,H={buttonDisabled:"esri-button--disabled",widgetIcon:"esri-icon-measure-line",base:`${z} esri-widget esri-widget--panel`,container:`${z}__container`,hint:`${z}__hint`,hintText:`${z}__hint-text`,panelError:`${z}__panel--error`,measurement:Y,measurementItem:`${Y}-item`,measurementItemDisabled:`${Y}-item--disabled`,measurementItemTitle:`${Y}-item-title`,measurementItemValue:`${Y}-item-value`,settings:`${z}__settings`,units:B,unitsLabel:`${B}-label`,unitsSelect:`${B}-select esri-select`,unitsSelectWrapper:`${B}-select-wrapper`,actionSection:`${z}__actions`,newMeasurementButton:`${z}__clear-button esri-button esri-button--primary`};let N=class extends u.Z{constructor(e,t){super(e,t),this.iconClass=H.widgetIcon,this.messages=null,this.messagesUnits=null,this.viewModel=new W}get active(){return this.viewModel.active}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get unit(){return this.viewModel.unit}set unit(e){this.viewModel.unit=e}get unitOptions(){return this.viewModel.unitOptions}set unitOptions(e){this.viewModel.unitOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}render(){const{id:e,messages:t,messagesUnits:s,viewModel:i,visible:r}=this,{active:l,supported:o,measurementLabel:u,state:h,unit:c,unitOptions:d}=i,m="disabled"===h,p="measuring"===h||"measured"===h,_=l&&"ready"===h?(0,j.u)("section",{key:"hint",class:H.hint},(0,j.u)("p",{class:H.hintText},t.hint)):null,v=o?null:(0,j.u)("section",{key:"unsupported",class:H.panelError},(0,j.u)("p",null,t.unsupported)),y=p?(0,j.u)("section",{key:"measurement",class:H.measurement},((e,t,s)=>(0,n.pC)(t)?(0,j.u)("div",{key:`${s}-enabled`,class:H.measurementItem},(0,j.u)("span",{class:H.measurementItemTitle},e),(0,j.u)("span",{"aria-live":"polite",class:H.measurementItemValue},t)):(0,j.u)("div",{key:`${s}-disabled`,class:this.classes(H.measurementItem,H.measurementItemDisabled),"aria-disabled":"true"},(0,j.u)("span",{class:H.measurementItemTitle},e)))(t.distance,u,"distance")):null,b=`${e}-units`,w=p?(0,j.u)("section",{key:"units",class:H.units},(0,j.u)("label",{class:H.unitsLabel,for:b},t.unit),(0,j.u)("div",{class:H.unitsSelectWrapper},(0,j.u)("select",{class:H.unitsSelect,id:b,onchange:this._changeUnit,bind:this,value:c},d.map((e=>(0,j.u)("option",{key:e,value:e},(0,a.ZO)(e)?s.systems[e]:s.units[e]?.pluralCapitalized)))))):null,g=p?(0,j.u)("div",{key:"settings",class:H.settings},w):null,f=!o||l&&!p?null:(0,j.u)("div",{class:H.actionSection},(0,j.u)("button",{"aria-label":t.newMeasurement,bind:this,class:this.classes(H.newMeasurementButton,m&&H.buttonDisabled),disabled:m,onclick:this._newMeasurement,title:t.newMeasurement,type:"button"},t.newMeasurement)),C=r?(0,j.u)("div",{class:H.container},v,_,g,y,f):null;return(0,j.u)("div",{"aria-label":t.widgetLabel,class:H.base,role:"region"},C)}_newMeasurement(){(0,r.R8)(this.viewModel.start())}_changeUnit(e){const t=e.target,s=t.options[t.selectedIndex];s&&(this.viewModel.unit=s.value)}};(0,i._)([(0,l.Cb)({readOnly:!0})],N.prototype,"active",null),(0,i._)([(0,l.Cb)()],N.prototype,"iconClass",void 0),(0,i._)([(0,l.Cb)()],N.prototype,"label",null),(0,i._)([(0,l.Cb)()],N.prototype,"uiStrings",void 0),(0,i._)([(0,l.Cb)(),(0,P.H)("esri/widgets/DistanceMeasurement2D/t9n/DistanceMeasurement2D")],N.prototype,"messages",void 0),(0,i._)([(0,l.Cb)(),(0,P.H)("esri/core/t9n/Units")],N.prototype,"messagesUnits",void 0),(0,i._)([(0,l.Cb)()],N.prototype,"unit",null),(0,i._)([(0,l.Cb)()],N.prototype,"unitOptions",null),(0,i._)([(0,l.Cb)()],N.prototype,"view",null),(0,i._)([(0,l.Cb)({type:W})],N.prototype,"viewModel",void 0),(0,i._)([(0,l.Cb)({type:Boolean})],N.prototype,"visible",null),(0,i._)([(0,G.h)()],N.prototype,"_newMeasurement",null),(0,i._)([(0,G.h)()],N.prototype,"_changeUnit",null),N=(0,i._)([(0,o.j)("esri.widgets.DistanceMeasurement2D")],N);const J=N}}]);
//# sourceMappingURL=5107.35adf792.chunk.js.map