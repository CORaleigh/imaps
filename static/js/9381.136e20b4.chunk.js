"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[9381],{89381:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Z});var s=r(85580),o=r(72791),i=r(64326),a=r(91946),n=r(83777),c=r(20804),l=r(44443),u=r(83589),d=(r(76200),r(23084),r(55465),r(27366)),p=(r(59486),r(46784)),h=r(49861),g=r(25243),m=(r(63780),r(69912)),v=r(78952);let y=class extends p.wq{constructor(e){super(e),this.addresses=null,this.categories=null,this.countryCode=null,this.locationType=null,this.outSpatialReference=null}};(0,d._)([(0,h.Cb)({type:[Object],json:{read:{reader:e=>e&&e.records?e.records.map((e=>e.attributes)):null},write:{writer:(e,t)=>{const r=[];Array.isArray(e)&&e.forEach((e=>{r.push({attributes:e})})),t.addresses={records:r}}}}})],y.prototype,"addresses",void 0),(0,d._)([(0,h.Cb)({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],y.prototype,"categories",void 0),(0,d._)([(0,h.Cb)({type:String,json:{read:{source:"sourceCountry"},write:{target:"sourceCountry"}}})],y.prototype,"countryCode",void 0),(0,d._)([(0,h.Cb)({type:String,json:{write:!0}})],y.prototype,"locationType",void 0),(0,d._)([(0,h.Cb)({type:v.Z,json:{read:{source:"outSR"},write:{target:"outSR"}}})],y.prototype,"outSpatialReference",void 0),y=(0,d._)([(0,m.j)("esri.rest.support.AddressesToLocationsParameters")],y),y.from=(0,g.se)(y);r(88736),r(1360);var f=r(52639),w=r(61459),b=r(51995),S=r(26997);const C=()=>new Promise((e=>{const t=new i.default({portalItem:{id:"edb2153e06c2477995f95b27e5c24661"},title:"Intersection",layerId:0});t.load().then((()=>{const r=new c.Z({name:"Intersection",placeholder:"Enter first street name",layer:t,autoNavigate:!1,resultGraphicEnabled:!1});e(r)}))})),T=()=>new Promise((e=>{e(new l.Z({name:"Street Address",placeholder:"Enter an address",url:"https://maps.raleighnc.gov/arcgis/rest/services/Locators/Locator/GeocodeServer",autoNavigate:!0,resultSymbol:new a.Z({url:"assets/pin.svg",height:36,width:36})}))}));const j=(e,t)=>{"point"===t.type?e.graphics.add(new f.Z({geometry:t,attributes:{type:"location"},symbol:new a.Z({url:"assets/pin.svg",height:36,width:36})})):e.graphics.add(new f.Z({geometry:t,attributes:{type:"location"},symbol:new w.Z({color:new b.Z([0,255,255,.25]),outline:{color:new b.Z([0,255,255,1]),width:2}})}))},A=e=>{e.graphics.removeMany(e.graphics.filter((e=>"location"===e.getAttribute("type"))))};const x={title:"Location Search Tips",tips:[{title:"Search By Place",text:"Search for places of interest such as schools and parks by typing the name of the school or park you are looking for."}]},R=e=>{const t=(0,o.useRef)(null),r=(0,o.useRef)(null),s=(0,o.useRef)(!1),i=(0,o.useRef)(),a=(0,o.useRef)(),[c,l]=(0,o.useState)(!1),[u,d]=(0,o.useState)([]),[p,h]=(0,o.useState)(""),[g,m]=(0,o.useState)(!1);(0,o.useEffect)((()=>{var o,c;!s.current&&t.current&&(s.current=!0,(o=e.view,c=t.current,new Promise(((e,t)=>{const r=[];T().then((t=>{r.push(t),C().then((t=>{r.push(t);const s=new n.Z({view:o,maxSuggestions:30,searchAllEnabled:!0,popupEnabled:!1,container:c,goToOverride:(e,t)=>{e.goTo({target:t.target.target,zoom:17},{duration:1e3,easing:"ease"})}});s.sources.addMany(r),e(s),s.allSources.on("after-add",(e=>{if(e.item.layer){const t=e.item;t.name=e.item.layer.title,t.placeholder=e.item.layer.title}e.item.name.includes("World Geocoding")&&s.allSources.remove(e.item)}))}))}))}))).then((t=>{i.current=t,function(e,t,r,s,o,i){e.on("search-complete",(t=>{if(i.graphic=null,o(t.searchTerm),r("Intersection"===t.results[0].source.name),"Intersection"===t.results[0].source.name)t.results[0].source.layer.queryFeatures({geometry:t.results[0].results[0].feature.geometry,returnGeometry:!1,outFields:["CARTONAME"],orderByFields:["CARTONAME"]}).then((e=>{s(e.features.map((e=>e.getAttribute("CARTONAME"))))}));else{A(e.view);const r=[];t.results[0].results.forEach((t=>{j(e.view,t.feature.geometry),r.push(t.feature),i.graphic=t.feature}))}}))}(t,e.view,l,d,h,a.current)})),a.current=function(e,t){return new S.Z({view:e,container:t})}(e.view,r.current))})),(0,o.useEffect)((()=>{m(e.isActive)}),[e.isActive]);const v=(0,o.useCallback)((t=>{e.panelDismissed()}),[]),y=(0,o.useCallback)((t=>{e.showTips(x)}),[]);return{searchDiv:t,featureDiv:r,search:i,isIntersection:c,intersections:u,searchTerm:p,isActive:g,panelDismissed:v,tipsClicked:y}};var k=r(80184);function E(e){const{searchDiv:t,featureDiv:r,search:o,isIntersection:i,intersections:a,searchTerm:n,isActive:c,panelDismissed:l,tipsClicked:d}=R(e);return(0,k.jsxs)(s.N$,{id:"location-panel",heading:"Location Search",hidden:!c,closed:!c||void 0,closable:!0,onCalcitePanelClose:l,children:[(0,k.jsx)(s.G1,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:d}),(0,k.jsx)(s.$A,{label:"Show Tip",referenceElement:"tip",closeOnClick:!0,children:"Show Tip"}),(0,k.jsxs)("div",{id:"location-search",children:[(0,k.jsx)("div",{ref:t}),i&&(0,k.jsx)("div",{id:"intersection-search",children:(0,k.jsxs)(s.ZK,{children:["Intersections",(0,k.jsx)(s.Y,{label:"",selectionMode:"single",scale:"l",children:a.map(((e,t)=>(0,k.jsx)(s.tp,{textLabel:e,value:e,onCalciteComboboxItemChange:t=>{var r;t.target.selected&&function(e,t,r){const s=`${e} & ${t}`;(0,u.h)("https://maps.raleighnc.gov/arcgis/rest/services/Locators/Locator/GeocodeServer",{address:{outSpatialReference:r.spatialReference,SingleLine:s}}).then((e=>{e.length&&(A(r),j(r,e[0].location),r.goTo({target:e[0].location,zoom:17},{duration:1e3,easing:"ease"}))}))}(e,n,null===o||void 0===o||null===(r=o.current)||void 0===r?void 0:r.view)}},t)))})]})}),(0,k.jsx)("div",{id:"location-feature",ref:r})]})]})}const Z=o.memo(E)}}]);
//# sourceMappingURL=9381.136e20b4.chunk.js.map