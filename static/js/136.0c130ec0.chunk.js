(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[136],{1069:function(e,t,i){},1070:function(e,t,i){},1084:function(e,t,i){"use strict";i.r(t),i.d(t,"PropertyPanel",(function(){return d}));var l=i(12),n=i(141);const s=e=>{const t=e.map((e=>e.getAttribute("PIN_NUM"))),i=new URLSearchParams;if(t){i.set("pins",t.toString());const e={pins:t.toString()};history.state?history.state.pins!=e.pins&&history.pushState({pins:t.toString()},"",`${location.pathname}?${i.toString()}`):history.pushState({pins:t.toString()},"",`${location.pathname}?${i.toString()}`)}};i(1069);var c=i(25);const a=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(13),i.e(27),i.e(69)]).then(i.bind(null,1285)))),o=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(61)]).then(i.bind(null,1286)))),r=Object(l.lazy)((()=>Promise.all([i.e(13),i.e(41),i.e(171)]).then(i.bind(null,1265)))),d=e=>{const t=Object(l.useRef)({pins:""}),[i,d]=Object(l.useState)(!1),[u,b]=Object(l.useState)(),[j,p]=Object(l.useState)(),[h,v]=Object(l.useState)("OBJECTID IS NULL"),[f,O]=Object(l.useState)("OBJECTID IS NULL"),[m,y]=Object(l.useState)(),[S,x]=Object(l.useState)("list"),[g,P]=Object(l.useState)();let w=[];const[A,E]=Object(l.useState)(),[k,I]=Object(l.useState)(!1),N=e=>{document.querySelector(`calcite-tab-title:${"list"===e?"first":"last"}-child`).dispatchEvent(new MouseEvent("click")),x(e)};return Object(l.useEffect)((()=>{if(!i){(e=>{y(e.map.allTables.find((e=>e.title.includes("Condo")&&"feature"===e.type))),P(e.map.allTables.find((e=>e.title.includes("Address")&&"feature"===e.type))),E(e.map.allLayers.find((e=>e.title.includes("Property")&&"feature"===e.type))),d(!0),b(e)})(e.view),document.querySelectorAll("calcite-tab-nav").forEach((e=>{e.addEventListener("calciteTabChange",(e=>{x(0===e.detail.tab?"list":"info")}))})),window.addEventListener("popstate",(e=>{var i,l,n,s;(null===(i=e.state)||void 0===i?void 0:i.pins)===(null===(l=t.current)||void 0===l?void 0:l.pins)?history.back():(null===(n=e.state)||void 0===n?void 0:n.pins)&&O(`PIN_NUM in ('${decodeURIComponent(null===(s=history.state)||void 0===s?void 0:s.pins.split(",").join("','"))}')`);t.current=e.state}));const i=new URL(document.URL).searchParams.get("pins");i&&O(`PIN_NUM in ('${decodeURIComponent(i.split(",").join("','"))}')`)}return()=>{console.log("cleanup")}}),[]),Object(l.useEffect)((()=>{((e,t,i)=>n.c((l=>{null===t||void 0===t||t.queryFeatures({geometry:i,outFields:["OBJECTID","REID","PIN_NUM"],returnGeometry:!0,outSpatialReference:null===e||void 0===e?void 0:e.spatialReference}).then((i=>{null===e||void 0===e||e.goTo(i.features);const s=i.features.map((e=>e.getObjectId()));t.queryRelatedFeatures({relationshipId:0,objectIds:s,outFields:["*"]}).then((e=>{const t=[],c=[];s.forEach((i=>{var l;null===(l=e[i])||void 0===l||l.features.forEach((e=>{t.push(e.getAttribute("OBJECTID")),c.push(e)}))})),t.length?l({where:`OBJECTID in (${t.toString()})`,features:c,properties:i.features}):Object(n.r)()}))}))})))(u,A,e.geometry).then((t=>{if(I(!0),v(t.where),e.propertiesSelected(t.properties),1===t.features.length){var i;const e=t.features[0];e.layer=m,e.popupTemplate=null===m||void 0===m?void 0:m.popupTemplate;const l=t.features[0];l.geometry=null===(i=t.properties.find((e=>e.getAttribute("PIN_NUM")===l.getAttribute("PIN_NUM"))))||void 0===i?void 0:i.geometry,p(l),s([l]),N("info")}else N("list")}))}),[e.geometry,e.propertiesSelected]),Object(c.jsxs)("div",{className:"panel",children:[i&&Object(c.jsx)(l.Suspense,{fallback:"",children:Object(c.jsx)(a,{view:u,condosTable:m,addressTable:g,propertyLayer:A,where:f,searchComplete:t=>{t.feature?(p(t.features[0]),s([t.features[0]]),N("info")):N("list");const i=null===t||void 0===t?void 0:t.features.map((e=>e.getAttribute("OBJECTID")));v(`OBJECTID in (${i.toString()})`),w=t.properties,w.forEach((e=>{e.setAttribute("selected",0)})),e.propertiesSelected(w)}})}),Object(c.jsxs)("calcite-tabs",{position:"below",layout:"center",children:[Object(c.jsxs)("calcite-tab-nav",{slot:"tab-nav",children:[Object(c.jsx)("calcite-tab-title",{active:"list"===S,children:"List"}),Object(c.jsx)("calcite-tab-title",{active:"info"===S,children:"Info"})]}),Object(c.jsx)("calcite-tab",{active:"list"===S?"":null,children:i&&Object(c.jsx)(l.Suspense,{fallback:"",children:Object(c.jsx)(r,{view:u,layer:m,filter:h,loading:k,featureSelected:t=>{if(t){w.forEach((e=>{e.getAttribute("PIN_NUM")!=(null===t||void 0===t?void 0:t.getAttribute("PIN_NUM"))&&e.setAttribute("selected",0)}));const i=w.find((e=>e.getAttribute("PIN_NUM")===(null===t||void 0===t?void 0:t.getAttribute("PIN_NUM"))));null===i||void 0===i||i.setAttribute("selected",1),t.geometry=null===i||void 0===i?void 0:i.geometry,null===u||void 0===u||u.goTo(t.geometry),p(t),s([t]),N("info"),e.propertiesSelected(w)}}})})}),Object(c.jsx)("calcite-tab",{active:"info"===S?"":null,children:i&&Object(c.jsx)(l.Suspense,{fallback:"",children:Object(c.jsx)(o,{view:u,feature:j})})})]})]})};t.default=d},1284:function(e,t,i){"use strict";i.r(t),i.d(t,"Shell",(function(){return v}));var l=i(12),n=i(1084);i(1070);const s=e=>{var t,i;(null===(t=e.target)||void 0===t?void 0:t.parentElement).collapsed=null===(i=e.target)||void 0===i?void 0:i.dismissed},c=(e,t,i)=>{var l,n;((e,t)=>{innerWidth<1e3?e.forEach((e=>{e.isActive=!1})):t?e.forEach((e=>{e.isActive=e.isActive&&!e.isTool})):e.forEach((e=>{e.isActive=e.isActive&&e.isTool}))})(i,t.isTool),t.isActive=!0;const s=null===(l=e.target)||void 0===l||null===(n=l.parentElement)||void 0===n?void 0:n.parentElement,c=null===s||void 0===s?void 0:s.querySelector("calcite-panel");return t.isActive?(null===s||void 0===s||s.removeAttribute("collapsed"),null===c||void 0===c||c.removeAttribute("dismissed")):(null===s||void 0===s||s.setAttribute("collapsed",""),null===c||void 0===c||c.setAttribute("dismissed","")),i};var a=i(54),o=i.n(a),r=i(53),d=i(38),u=i(55),b=i(25);const j=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(55)]).then(i.bind(null,1253)))),p=Object(l.lazy)((()=>i.e(170).then(i.bind(null,1089)))),h=Object(l.lazy)((()=>i.e(172).then(i.bind(null,1090)))),v=e=>{var t,a;const[v,f]=Object(l.useState)([]),[O,m]=Object(l.useState)(),[y,S]=Object(l.useState)(window.innerWidth),[x,g]=Object(l.useState)(null),[P,w]=Object(l.useState)(!1),[A,E]=Object(l.useState)([]),{theme:k,setTheme:I}=Object(l.useContext)(r.a),{actions:N,setActions:T}=Object(l.useContext)(u.a),L=e=>{E([...e]);const t=N.find((e=>e.isActive));t&&(t.isActive=!1);const i=N.find((e=>"Property Search"===e.title));i&&(i.isActive=!0),T([...N])},C=()=>{S(window.innerWidth)},z=e=>{if(e){const t=document.getElementById(e.container);if(!(null===t||void 0===t?void 0:t.hasChildNodes())){if("Property Search"===e.title){const e=Object(l.lazy)((()=>Promise.resolve().then(i.bind(null,1084))));o.a.render(Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(e,{view:x,propertiesSelected:L})}),t)}if("Location Search"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(59)]).then(i.bind(null,1091))));o.a.render(Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(e,{view:x})}),t)}if("Layers"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(63)]).then(i.bind(null,1264))));o.a.render(Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(e,{view:x})}),t)}if("Basemaps"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(60)]).then(i.bind(null,1258))));o.a.render(Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(e,{view:x})}),t)}if("Legend"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(13),i.e(68)]).then(i.bind(null,1092))));o.a.render(Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(e,{view:x})}),t)}if("Property Select"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(53)]).then(i.bind(null,1093))));o.a.render(Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(e,{view:x,geometrySet:e=>{const t=document.getElementById("propertySearch");o.a.render(Object(b.jsx)(n.PropertyPanel,{geometry:e,propertiesSelected:L}),t)}})}),t)}if("Measure"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(10),i.e(13),i.e(88)]).then(i.bind(null,1262))));o.a.render(Object(b.jsxs)(l.Suspense,{fallback:"",children:[Object(b.jsx)(e,{view:x})," "]}),t)}if("Sketch"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(4),i.e(54)]).then(i.bind(null,1277))));o.a.render(Object(b.jsxs)(l.Suspense,{fallback:"",children:[Object(b.jsx)(e,{view:x})," "]}),t)}if("Bookmarks"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(13),i.e(27),i.e(41),i.e(81),i.e(267)]).then(i.bind(null,1094))));o.a.render(Object(b.jsxs)(l.Suspense,{fallback:"",children:[Object(b.jsx)(e,{view:x})," "]}),t)}if("Print"===e.title){const e=Object(l.lazy)((()=>Promise.all([i.e(1),i.e(2),i.e(4),i.e(13),i.e(74)]).then(i.bind(null,1269))));o.a.render(Object(b.jsxs)(l.Suspense,{fallback:"",children:[Object(b.jsx)(e,{view:x})," "]}),t)}}}},U=()=>{I("dark"),document.body.classList.remove("light"),document.body.classList.add("dark"),i(1071)},M=()=>{I("light"),i(1072),document.body.classList.remove("dark"),document.body.classList.add("light")};return Object(l.useEffect)((()=>{document.querySelectorAll("calcite-panel").forEach((e=>{null===e||void 0===e||e.addEventListener("calcitePanelDismissedChange",s)}));return(e=>{e?("dark"===e&&U(),"light"===e&&M()):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?U():M()})(window.localStorage.getItem("imaps_theme")),window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C),document.querySelectorAll("calcite-panel").forEach((e=>{null===e||void 0===e||e.removeEventListener("calcitePanelDismissedChange",s)}))}}),[e.actions]),Object(b.jsxs)("div",{children:[Object(b.jsxs)("calcite-shell",{theme:k,className:"shell",children:[y>=1e3?Object(b.jsxs)("calcite-shell-panel",{slot:"primary-panel",position:"start","width-scale":"l",collapsed:!0,children:[Object(b.jsx)("calcite-action-bar",{slot:"action-bar",children:N.map((t=>{if(t.isTool)return Object(b.jsx)("calcite-action",{name:t.container,text:t.title,icon:t.icon,onClick:i=>{T([...c(i,t,e.actions)]),z(t)},active:!0===t.isActive?"":null},t.icon)}))}),Object(b.jsxs)("calcite-panel",{dismissible:!0,dismissed:!0,children:[Object(b.jsx)("div",{slot:"header-content",children:null===(t=N.find((e=>e.isActive&&e.isTool)))||void 0===t?void 0:t.title}),Object(b.jsx)("div",{slot:"header-trailing-content",children:Object(b.jsx)("calcite-action",{label:"Performs another custom action",text:"Perform Another Action!","text-enabled":!0,icon:"blog"})}),N.map((e=>{if(e.isTool)return Object(b.jsx)("div",{id:e.container,hidden:!e.isActive},e.container)}))]})]}):"",Object(b.jsxs)("calcite-shell-panel",{slot:"contextual-panel",position:"end","width-scale":"l",children:[Object(b.jsx)("calcite-action-bar",{slot:"action-bar",children:N.map((t=>{if(!t.isTool||y<1e3)return Object(b.jsx)("calcite-action",{text:t.title,name:t.container,icon:t.icon,onClick:async i=>{T([...c(i,t,e.actions)]),z(t)},active:!0===t.isActive?"":null},t.icon)}))}),Object(b.jsxs)("calcite-panel",{dismissible:!0,children:[Object(b.jsx)("div",{slot:"header-content",children:null===(a=N.find((e=>e.isActive)))||void 0===a?void 0:a.title}),(()=>{var e;const t=N.find((e=>e.isActive));return(null===t||void 0===t||null===(e=t.tips)||void 0===e?void 0:e.length)?Object(b.jsx)("calcite-action",{text:"Action",label:"Action",slot:"header-actions-end",icon:"lightbulb",appearance:"solid",scale:"m","calcite-hydrated":"",onClick:()=>{f([...v,...t.tips]),m(t.title)}}):""})(),N.map((e=>{if(!e.isTool||y<1e3)return Object(b.jsx)("div",{id:e.container,hidden:!e.isActive},e.container)}))]})]}),Object(b.jsx)("div",{slot:"shell-header",children:Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(p,{links:d.b})})}),Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(j,{id:"95092428774c4b1fb6a3b6f5fed9fbc4",zoom:"10",initialized:async e=>{if(!P){g(e),w(!0);const t=document.getElementById("propertySearch");e.map&&o.a.render(Object(b.jsx)(n.PropertyPanel,{view:e,propertiesSelected:L}),t)}},geometryChanged:e=>{const t=document.getElementById("propertySearch");o.a.render(Object(b.jsx)(n.PropertyPanel,{geometry:e,propertiesSelected:L}),t)},selectedProperties:A})})]}),Object(b.jsx)(l.Suspense,{fallback:"",children:Object(b.jsx)(h,{tips:v,title:O,closed:!0,tipsDismissed:()=>{f([]),m("")}})})]})};t.default=v}}]);
//# sourceMappingURL=136.0c130ec0.chunk.js.map