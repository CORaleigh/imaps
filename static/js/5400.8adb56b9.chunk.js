"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[5400],{95400:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var i=n(85580),r=n(72791),s=n(10064),a=n(15075),l=n(585),d=n(78952);function c(){return(0,a.i)()}function o(){return(0,a.l)()}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=[[e.x,e.y]],r=[],s=v(e.spatialReference);let l=0;switch(t){case"dd":l=a.P.geogToDd(s,1,i,n,r);break;case"ddm":l=a.P.geogToDdm(s,1,i,n,r);break;case"dms":l=a.P.geogToDms(s,1,i,n,r);break;default:return console.warn(`invalid format: ${t}`),null}return l?r[0]:null}function v(e){let t=null;if(e||(e=d.Z.WGS84),e.wkid){if(t=a.e.geogcs(e.wkid),!t)throw new s.Z("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!e.wkt)throw new s.Z("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(t=a.e.fromString(a.f.PE_TYPE_GEOGCS,e.wkt),!t)throw new s.Z("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return t}function f(e){let t=-1;switch(e){case"automatic":t=a.b.PE_MGRS_STYLE_AUTO;break;case"new-180-in-zone-01":t=a.b.PE_MGRS_STYLE_NEW|a.b.PE_MGRS_180_ZONE_1_PLUS;break;case"new-180-in-zone-60":t=a.b.PE_MGRS_STYLE_NEW;break;case"old-180-in-zone-01":t=a.b.PE_MGRS_STYLE_OLD|a.b.PE_MGRS_180_ZONE_1_PLUS;break;case"old-180-in-zone-60":t=a.b.PE_MGRS_STYLE_OLD}return t}function g(e){let t=-1;switch(e){case"latitude-band-indicators":t=a.d.PE_UTM_OPTS_NONE;break;case"north-south-indicators":t=a.d.PE_UTM_OPTS_NS}return t}var m=n(79803),h=n(91946),w=n(93655);let p,S;const b=new h.Z({url:"assets/pin.svg",height:36,width:36}),k=new w.Z({id:"coordinate-widget"}),x=e=>{const t=(0,r.useRef)(!1),n=(0,r.useRef)(null),i=(0,r.useRef)(null),s=(0,r.useRef)(null),h=(0,r.useRef)(null),[w,x]=(0,r.useState)(!1),[_,E]=(0,r.useState)(!1),R=(0,r.useRef)(null),T=(0,r.useRef)(null),[C,M]=(0,r.useState)("dd"),A=(0,r.useRef)("dd"),y=(0,r.useCallback)((e=>{x((e=>!e))}),[]),G=(0,r.useCallback)((e=>{E((e=>!e))}),[]),P=(0,r.useCallback)((t=>{var n,i,r;(t.target.active=!t.target.active,t.target.active)?(null===(n=p)||void 0===n||n.remove(),N(e.view,e.clickActivated)):(null===(i=S)||void 0===i||i.remove(),e.view.popup.autoOpenEnabled=!0,null===(r=document.querySelector(".identify-widget"))||void 0===r||r.classList.add("active"),O())}),[]),j=(0,r.useCallback)((e=>{console.log(e.target.value),M(e.target.value),A.current=e.target.value}),[A]),$=(0,r.useCallback)((async t=>{c()||await o();let r=new l.Z,u=!0;if("dd"===A.current&&(isFinite(i.current.value)&&Math.abs(i.current.value)<=90?i.current.setAttribute("status","valid"):(u=!1,i.current.setAttribute("status","invalid")),isFinite(n.current.value)&&Math.abs(n.current.value)<=180?n.current.setAttribute("status","valid"):(u=!1,n.current.setAttribute("status","invalid")),r=new l.Z({x:n.current.value,y:i.current.value,spatialReference:{wkid:4326}})),"dms"===A.current){const e=L(!0,i.current.value);i.current.setAttribute("status",e);const t=L(!1,n.current.value);n.current.setAttribute("status",t),u="valid"===e&&"valid"===t,r=function(e,t){const n=[];e=(e=(e=e.replace(/[\u00B0\u00BA]/g,"^")).replace(/\u2032/g,"'")).replace(/\u2033/g,'"');const i=v(t);return a.P.dmsToGeog(i,1,[e],n)?new l.Z(n[0][0],n[0][1],t||d.Z.WGS84):null}(`${i.current.value} ${n.current.value}`)}var h;("spft"===A.current&&(r=new l.Z({x:n.current.value,y:i.current.value,spatialReference:{wkid:4326}}),r=m.iV(r,e.view.spatialReference)),"usng"===A.current&&(r=function(e,t){const n=[];!t&&/\(.+27/.test(e)&&(t=d.Z.GCS_NAD_1927);const i=v(t);return a.c.usngToGeog(i,1,[e],n)?new l.Z(n[0][0],n[0][1],t||d.Z.WGS84):null}(s.current.value,e.view.spatialReference)),"mgrs"===A.current&&(r=function(e,t,n){const i=[],r=f(n);if(-1===r)return console.warn(`invalid conversionMode: ${n}`),null;const s=v(t);return a.b.mgrsToGeogExtended(s,1,[e],r,i)?new l.Z(i[0][0],i[0][1],t||d.Z.WGS84):null}(s.current.value,e.view.spatialReference,"automatic")),"utm"===A.current&&(r=function(e,t,n){const i=[],r=g(n);if(-1===r)return console.warn(`invalid conversionMode: ${n}`),null;const s=v(t);return a.d.utmToGeog(s,1,[e],r,i)?new l.Z(i[0][0],i[0][1],t||d.Z.WGS84):null}(s.current.value,e.view.spatialReference,"latitude-band-indicators")),e.view.constraints.geometry.contains(r))||(null===(h=T.current)||void 0===h||h.setAttribute("open",!0),setTimeout((()=>{var e;null===(e=T.current)||void 0===e||e.removeAttribute("open")}),3e3));u&&(e.view.map.findLayerById("coordinate-widget")||e.view.map.add(k),k.removeAll(),k.add({geometry:r,attributes:null,symbol:b}),e.view.goTo(r))}),[]),L=(e,t)=>(e?/^((90[\xb0|\s]\s*)(0{1,2}['|\s]\s*)(0{1,2}([.|,]0{1,20})?["|\s]\s*)|(([1-8]\d|\d)[\xb0|\s]\s*)(([0-5]\d|\d)['|\s]\s*)(([0-5]\d|\d)([.|,]\d{1,20})?["|\s]\s*))$/gm:/^[-]((180[\xb0|\s]\s*)(0{1,2}['|\s]\s*)(0{1,2}([.|,]0{1,20})?["|\s]\s*)|((1[0-7]\d|\d\d|\d)[\xb0|\s]\s*)(([0-5]\d|\d)['|\s]\s*)(([0-5]\d|\d)([.|,]\d{1,20})?["|\s]\s*))/gm).test(`${t} `)?"valid":"invalid",Z=t=>{let n;n="point"===t.type?t:e.view.toMap({x:t.x,y:t.y});const i=new l.Z({x:n.longitude,y:n.latitude,spatialReference:{wkid:4326}});if("dd"===A.current){let e=u(i,"dd",7).replaceAll("078.","78.").split(" ");e[0].includes("S")&&(e[0]=`-${e[0].replace("S","")}`),e[0].includes("N")&&(e[0]=`${e[0].replace("N","")}`),e[1].includes("W")&&(e[1]=`-${e[1].replace("W","")}`),e[1].includes("E")&&(e[1]=`${e[1].replace("N","")}`),h.current.innerHTML=e.join(" ")}else if("dms"===A.current){const e=u(i,"dms",7).split(" "),t=`${e[0]}\xb0 ${e[1]}' ${e[2].replace("N",'"')} -${e[3].substring(1)}\xb0 ${e[4]}' ${e[5].replace("W",'"')}`;h.current.innerHTML=t}else if("usng"===A.current)h.current.innerHTML=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=[[e.x,e.y]],r=[],s=v(e.spatialReference);return a.c.geogToUsng(s,1,i,t,!1,n,r)?r[0]:null}(i,5,!0);else if("mgrs"===A.current)h.current.innerHTML=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=[[e.x,e.y]],s=[],l=v(e.spatialReference);let d=f(t);return-1===d?(console.warn(`invalid conversionMode: ${t}`),null):(i&&(d|=a.b.PE_MGRS_ADD_SPACES),a.b.geogToMgrsExtended(l,1,r,n,!1,d,s)?s[0]:null)}(i,"automatic",5,!0);else if("utm"===A.current)h.current.innerHTML=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=[[e.x,e.y]],r=[],s=v(e.spatialReference);let l=g(t);return-1===l?(console.warn(`invalid conversionMode: ${t}`),null):(n&&(l|=a.d.PE_UTM_OPTS_ADD_SPACES),a.d.geogToUtm(s,1,i,l,r)?r[0]:null)}(i,"latitude-band-indicators",!0);else if("spft"===A.current){const e=m.iV(n,{wkid:2264});h.current.innerHTML=`${e.x.toString()} E, ${e.y.toString()} N`}},N=(t,n)=>{var i;n(t),e.view.popup.autoOpenEnabled=!1,null===(i=document.querySelector(".identify-widget"))||void 0===i||i.classList.remove("active"),S=e.view.on("click",(e=>{Z(e)}))},O=async()=>{c()||await o(),Z(e.view.extent.center),p=e.view.on("pointer-move",(e=>{Z(e)}))};return(0,r.useEffect)((()=>{if(!t.current&&e.view)return t.current=!0,e.expand&&(e.expand.hasHandles()||e.expand.watch("expanded",(t=>{var n,i;t?R.current.getAttribute("active")?O():N(e.view,e.clickActivated):(null===(n=p)||void 0===n||n.remove(),null===(i=S)||void 0===i||i.remove())}))),O(),()=>{}}),[]),{loaded:t,settingsClicked:y,showSettings:w,formats:[{value:"dd",label:"Decimal Degrees"},{value:"dms",label:"Degrees Minutes Seconds"},{value:"spft",label:"Stateplane Feet"},{value:"usng",label:"US National Grid"},{value:"mgrs",label:"MGRS"},{value:"utm",label:"UTM"}],formatChanged:j,searchClicked:G,showSearch:_,selectedFormat:C,searchCoordinates:$,x:n,y:i,other:s,modeClicked:P,coordinateRef:h,modeActionRef:R,noticeRef:T}};var _=n(80184);function E(e){var t,n;const{loaded:r,settingsClicked:s,showSettings:a,formats:l,formatChanged:d,searchClicked:c,showSearch:o,selectedFormat:u,searchCoordinates:v,x:f,y:g,other:m,modeClicked:h,coordinateRef:w,modeActionRef:p,noticeRef:S}=x(e);return(0,_.jsxs)("div",{id:"coordinatesWidget",children:[(0,_.jsx)(i.JA,{scale:"s",ref:S,kind:"danger",closable:!0,children:(0,_.jsx)("div",{slot:"message",children:"Location outside of county"})}),(0,_.jsx)("div",{hidden:!a||void 0,children:(0,_.jsx)(i.ko,{scale:"s",label:"Coordinate Systems",onCalciteSelectChange:d,children:l.map((e=>(0,_.jsx)(i.GB,{value:e.value,children:e.label},e.value)))})}),(0,_.jsxs)("div",{hidden:!o||void 0,children:[(0,_.jsxs)(i.ZK,{scale:"s",children:["dd"===u?"Latitude":"spft"===u?"Northing":"dms"===u?"Latitude":"",(0,_.jsx)(i.e,{scale:"s",ref:g,hidden:!["dd","spft","dms"].includes(u)||void 0,id:"ycoord",placeholder:"dd"===u?"35.7582196":"spft"===u?"731166.165":"dms"===u?"35\xb0 45' 29.7116777\"":""}),(0,_.jsx)(i.Bi,{hidden:"invalid"!==(null===(t=g.current)||void 0===t?void 0:t.getAttribute("status"))||void 0,status:"invalid",children:"Value is not valid"})]}),(0,_.jsxs)(i.ZK,{scale:"s",children:["dd"===u?"Longitude":"spft"===u?"Easting":"dms"===u?"Longitude":"",(0,_.jsx)(i.e,{scale:"s",ref:f,hidden:!["dd","spft","dms"].includes(u)||void 0,id:"xcoord",placeholder:"dd"===u?"-78.8079653":"spft"===u?"2056872.973":"dms"===u?"-78\xb0 48' 31.524\"":""}),(0,_.jsx)(i.Bi,{hidden:"invalid"!==(null===(n=f.current)||void 0===n?void 0:n.getAttribute("status"))||void 0,status:"invalid",children:"Value is not valid"})]}),(0,_.jsx)(i.e,{scale:"s",ref:m,hidden:!!["dd","spft","dms"].includes(u)||void 0,id:"othercoord",placeholder:"usng"===u?"17S PV 98178 59368":"mrgs"===u?"17S PV 98136 59346":"utm"===u?"17S 698184 3959363":""}),(0,_.jsx)(i.ln,{onClick:v,width:"full",scale:"s",children:"Search"})]}),(0,_.jsxs)("div",{className:"coordinates-row",children:[(0,_.jsx)("div",{ref:w,className:"coordinates-text"}),(0,_.jsx)(i.G1,{id:"coordinateSearch",text:"",icon:"search",active:!!o||void 0,onClick:c}),(0,_.jsx)(i.$A,{closeOnClick:!0,label:"Search Coordinates",referenceElement:"coordinateSearch",children:"Search Coordinates"}),(0,_.jsx)(i.G1,{id:"coordinateUnits",text:"",icon:"gear",onClick:s,active:!!a||void 0}),(0,_.jsx)(i.$A,{closeOnClick:!0,label:"Set Units",referenceElement:"coordinateUnits",children:"Set Units"}),(0,_.jsx)(i.G1,{id:"coordinateMode",ref:p,text:"",icon:"pin",onClick:h}),(0,_.jsx)(i.$A,{closeOnClick:!0,label:"Set Mode",referenceElement:"coordinateMode",children:"Set Mode"})]})]})}const R=r.memo(E)}}]);
//# sourceMappingURL=5400.8adb56b9.chunk.js.map