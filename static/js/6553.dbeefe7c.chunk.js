"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[6553],{16553:(e,n,r)=>{r.r(n),r.d(n,{createLabelFunction:()=>x,formatField:()=>g});var t=r(10064),a=r(32718),s=r(76969),l=r(6291),u=r(37270),i=r(93253),o=r(819);const c=a.Z.getLogger("esri.layers.support.labelFormatUtils"),p={type:"simple",evaluate:()=>null},f={getAttribute:(e,n)=>e.field(n)};async function x(e,n,a){if(!e||!e.symbol)return p;const s=e.where,l=(0,i.hV)(e),u=s?await r.e(8562).then(r.bind(r,48562)):null;let x;if("arcade"===l.type){const e=await(0,o.WW)(l.expression,a,n);x={type:"arcade",evaluate(n){try{const r=e.evaluate({$feature:"attributes"in n?e.repurposeFeature(n):n});if(null!=r)return r.toString()}catch(a){c.error(new t.Z("arcade-expression-error","Encountered an error when evaluating label expression for feature",{feature:n,expression:l}))}return null},needsHydrationToEvaluate:()=>null==(0,i.el)(l.expression)}}else x={type:"simple",evaluate:e=>l.expression.replace(/{[^}]*}/g,(r=>{const t=r.slice(1,-1),a=n.get(t);if(!a)return r;let s=null;return"attributes"in e?e&&e.attributes&&(s=e.attributes[a.name]):s=e.field(a.name),null==s?"":g(s,a)}))};if(s){let e;try{e=u.WhereClause.create(s,n)}catch(d){return c.error(new t.Z("bad-where-clause","Encountered an error when evaluating where clause, ignoring",{where:s,error:d})),p}const r=x.evaluate;x.evaluate=n=>{const a="attributes"in n?void 0:f;try{if(e.testFeature(n,a))return r(n)}catch(d){c.error(new t.Z("bad-where-clause","Encountered an error when evaluating where clause for feature",{where:s,feature:n,error:d}))}return null}}return x}function g(e,n){if(null==e)return"";const r=n.domain;if(r)if("codedValue"===r.type||"coded-value"===r.type){const n=e;for(const e of r.codedValues)if(e.code===n)return e.name}else if("range"===r.type){const n=+e,t="range"in r?r.range[0]:r.minValue,a="range"in r?r.range[1]:r.maxValue;if(t<=n&&n<=a)return r.name}let t=e;return"date"===n.type||"esriFieldTypeDate"===n.type?t=(0,s.p6)(t,(0,s.Ze)("short-date")):(0,u.H7)(n)&&(t=(0,l.uf)(+t)),t||""}},93253:(e,n,r)=>{r.d(n,{UO:()=>g,YI:()=>x,dI:()=>d,el:()=>m,hV:()=>f,z7:()=>p});var t=r(643);const a="__begin__",s="__end__",l=new RegExp(a,"ig"),u=new RegExp(s,"ig"),i=new RegExp("^"+a,"i"),o=new RegExp(s+"$","i"),c='"';function p(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function f(e){const n={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(n.expression=e.labelExpressionInfo.value,n.type="conventional"):e.labelExpressionInfo.expression&&(n.expression=e.labelExpressionInfo.expression,n.type="arcade"):null!=e.labelExpression&&(n.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),n.type="conventional"),n}function x(e){const n=f(e);if(!n)return null;switch(n.type){case"conventional":return d(n.expression);case"arcade":return n.expression}return null}function g(e){const n=f(e);if(!n)return null;switch(n.type){case"conventional":return function(e){const n=e.match(w);return n&&n[1].trim()||null}(n.expression);case"arcade":return m(n.expression)}return null}function d(e){let n;return e?(n=(0,t.gx)(e,(e=>a+'$feature["'+e+'"]'+s)),n=i.test(n)?n.replace(i,""):c+n,n=o.test(n)?n.replace(o,""):n+c,n=n.replace(l,'" + ').replace(u,' + "')):n='""',n}const w=/^\s*\{([^}]+)\}\s*$/i;const h=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,y=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function m(e){if(!e)return null;let n=h.exec(e)||b.exec(e);return n?n[1]||n[3]:(n=y.exec(e),n?n[2]:null)}}}]);
//# sourceMappingURL=6553.dbeefe7c.chunk.js.map