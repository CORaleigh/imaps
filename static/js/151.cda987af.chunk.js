(this.webpackJsonpimaps=this.webpackJsonpimaps||[]).push([[151],{160:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=r(76),s=r(77);let a=0;const o=t=>{let e=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+a++})}};return e=Object(i.a)([Object(s.a)("esri.core.Identifiable")],e),e};let n=class extends(o(class{})){};n=Object(i.a)([Object(s.a)("esri.core.Identifiable")],n)},217:function(t,e,r){"use strict";r.d(e,"a",(function(){return v}));var i=r(76),s=r(121),a=r(95),o=r(156),n=r(83),l=r(75),c=r(80),u=r(84),p=r(92),d=r(78),b=(r(74),r(79),r(87)),h=r(77),O=r(86),y=r(174),j=r(221),g=r(282);const f=l.a.getLogger("esri.layers.mixins.PortalLayer"),v=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0}destroy(){var t;null==(t=this.portalItem)||t.destroy(),this.portalItem=null}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}readPortalItem(t,e,r){if(e.itemId)return new j.default({id:e.itemId,portal:r&&r.portal})}writePortalItem(t,e){t&&t.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem&&this.portalItem.id)try{const i=await r.e(158).then(r.bind(null,333));return Object(u.v)(e),await i.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},e)}catch(i){throw Object(u.m)(i)||f.warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${i}`),i}}async finishLoadEditablePortalLayer(t){this._set("userHasEditingPrivileges",await this.fetchUserHasEditingPrivileges(t).catch((t=>(Object(u.u)(t),!0))))}async fetchUserHasEditingPrivileges(t){const e=this.url?null==s.b?void 0:s.b.findCredential(this.url):null;if(!e)return!0;const r=m.credential===e?m.user:await this.fetchEditingUser(t);return m.credential=e,m.user=r,Object(c.j)(r)||null==r.privileges||r.privileges.includes("features:user:edit")}async fetchEditingUser(t){var e,r;const i=null==(e=this.portalItem)||null==(r=e.portal)?void 0:r.user;if(i)return i;const n=s.b.findServerInfo(this.url);if(null==n||!n.owningSystemUrl)return null;const l=`${n.owningSystemUrl}/sharing/rest`,u=y.a.getDefault();if(u&&u.loaded&&Object(p.D)(u.restUrl)===Object(p.D)(l))return u.user;const d=`${l}/community/self`,b=Object(c.k)(t)?t.signal:null,h=await Object(o.c)(Object(a.default)(d,{authMode:"no-prompt",query:{f:"json"},signal:b}));return h.ok?g.default.fromJSON(h.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const r=e&&e.portal,i=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||y.a.getDefault());return r&&i&&!Object(p.r)(i.restUrl,r.restUrl)?(e.messages&&e.messages.push(new n.a("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return Object(i.a)([Object(d.b)({type:j.default})],e.prototype,"portalItem",null),Object(i.a)([Object(b.a)("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),Object(i.a)([Object(O.a)("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),Object(i.a)([Object(d.b)()],e.prototype,"resourceReferences",void 0),Object(i.a)([Object(d.b)({readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),e=Object(i.a)([Object(h.a)("esri.layers.mixins.PortalLayer")],e),e},m={credential:null,user:null}},224:function(t,e,r){"use strict";var i=r(76),s=r(140),a=(r(91),r(95)),o=r(83),n=r(119),l=r(160),c=r(172),u=r(75),p=r(84),d=r(92),b=r(78),h=(r(74),r(79),r(77)),O=r(94),y=r(88);let j=0;const g=u.a.getLogger("esri.layers.Layer");let f=class extends(n.a.EventedMixin(Object(l.a)(c.a))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new O.a(-180,-90,180,90,y.a.WGS84),this.id=Date.now().toString(16)+"-layer-"+j++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=y.a.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const e="string"==typeof t?{url:t}:t,i=await r.e(163).then(r.bind(null,707));try{return await i.fromUrl(e)}catch(s){throw g.error("#fromArcGISServerUrl({ url: '"+e.url+"'})","Failed to create layer from arcgis server url",s),s}}static async fromPortalItem(t){const e="portalItem"in t?t:{portalItem:t},i=await r.e(138).then(r.bind(null,629));try{return await i.fromItem(e)}catch(a){const t=e&&e.portalItem,r=t&&t.id||"unset",i=t&&t.portal&&t.portal.url||s.a.portalUrl;throw g.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+i+"', id: '"+r+"')",a),a}}initialize(){this.when().catch((t=>{var e,r;Object(p.m)(t)||u.a.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${null!=(e=this.title)?e:"no title"}', id: '${null!=(r=this.id)?r:"no id"}')`,{error:t})}))}destroy(){if(this.parent){const t=this,e=this.parent;"layers"in e&&e.layers.includes(t)?e.layers.remove(t):"tables"in e&&e.tables.includes(t)?e.tables.remove(t):"baseLayers"in e&&e.baseLayers.includes(t)?e.baseLayers.remove(t):"baseLayers"in e&&e.referenceLayers.includes(t)&&e.referenceLayers.remove(t)}}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){const t=this.url;return t?Object(d.K)(t):null}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await Object(a.default)(t,{query:{f:"json"},responseType:"json"})).data;throw new o.a("layer:no-attribution-data","Layer does not have attribution data")}};Object(i.a)([Object(b.b)({type:String})],f.prototype,"attributionDataUrl",void 0),Object(i.a)([Object(b.b)({type:O.a})],f.prototype,"fullExtent",void 0),Object(i.a)([Object(b.b)({readOnly:!0})],f.prototype,"hasAttributionData",null),Object(i.a)([Object(b.b)({type:String})],f.prototype,"id",void 0),Object(i.a)([Object(b.b)({type:Boolean,nonNullable:!0})],f.prototype,"legendEnabled",void 0),Object(i.a)([Object(b.b)({type:["show","hide","hide-children"]})],f.prototype,"listMode",void 0),Object(i.a)([Object(b.b)({type:Number,range:{min:0,max:1},nonNullable:!0})],f.prototype,"opacity",void 0),Object(i.a)([Object(b.b)()],f.prototype,"parent",void 0),Object(i.a)([Object(b.b)({readOnly:!0})],f.prototype,"parsedUrl",null),Object(i.a)([Object(b.b)({type:Boolean})],f.prototype,"popupEnabled",void 0),Object(i.a)([Object(b.b)({type:Boolean})],f.prototype,"attributionVisible",void 0),Object(i.a)([Object(b.b)({type:y.a})],f.prototype,"spatialReference",void 0),Object(i.a)([Object(b.b)({type:String})],f.prototype,"title",void 0),Object(i.a)([Object(b.b)({type:String,readOnly:!0,json:{read:!1}})],f.prototype,"type",void 0),Object(i.a)([Object(b.b)()],f.prototype,"url",void 0),Object(i.a)([Object(b.b)({type:Boolean,nonNullable:!0})],f.prototype,"visible",void 0),f=Object(i.a)([Object(h.a)("esri.layers.Layer")],f);var v=f;e.a=v},257:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"b",(function(){return v}));var i=r(76),s=r(89),a=r(80),o=r(82),n=r(238);class l{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(n.a),this._values=new Map}clone(t){const e=new l,r=this._originStores[0];r&&r.forEach(((t,r)=>{e.set(r,Object(o.a)(t),0)}));for(let i=2;i<n.a;i++){const r=this._originStores[i];r&&r.forEach(((r,s)=>{t&&t.has(s)||e.set(s,Object(o.a)(r),i)}))}return e}get(t,e){const r=void 0===e?this._values:this._originStores[e];return r?r.get(t):void 0}keys(t){const e=null==t?this._values:this._originStores[t];return e?[...e.keys()]:[]}set(t,e,r=6){let i=this._originStores[r];if(i||(i=new Map,this._originStores[r]=i),i.set(t,e),!this._values.has(t)||Object(a.d)(this._propertyOriginMap.get(t))<=r){const i=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,r),i!==e}return!1}delete(t,e=6){const r=this._originStores[e];if(!r)return;const i=r.get(t);if(r.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===e){this._values.delete(t);for(let r=e-1;r>=0;r--){const e=this._originStores[r];if(e&&e.has(t)){this._values.set(t,e.get(t)),this._propertyOriginMap.set(t,r);break}}}return i}has(t,e){const r=void 0===e?this._values:this._originStores[e];return!!r&&r.has(t)}revert(t,e){for(;e>0&&!this.has(t,e);)--e;const r=this._originStores[e],i=r&&r.get(t),s=this._values.get(t);return this._values.set(t,i),this._propertyOriginMap.set(t,e),s!==i}originOf(t){return this._propertyOriginMap.get(t)||0}forEach(t){this._values.forEach(t)}}var c=l,u=r(339),p=r(130),d=r(77);const b=t=>{let e=class extends t{constructor(...t){super(...t);const e=Object(a.d)(Object(p.a)(this)),r=e.metadatas,i=e.store,s=new c;e.store=s,i.keys().forEach((t=>{s.set(t,i.get(t),0)})),Object.keys(r).forEach((t=>{e.internalGet(t)&&s.set(t,e.internalGet(t),0)}))}read(t,e){Object(u.a)(this,t,e)}getAtOrigin(t,e){const r=h(this),i=Object(n.d)(e);if("string"==typeof t)return r.get(t,i);const s={};return t.forEach((t=>{s[t]=r.get(t,i)})),s}originOf(t){return Object(n.b)(this.originIdOf(t))}originIdOf(t){return h(this).originOf(t)}revert(t,e){const r=h(this),i=Object(n.d)(e),s=Object(p.a)(this);let a;a="string"==typeof t?"*"===t?r.keys(i):[t]:t,a.forEach((t=>{s.invalidate(t),r.revert(t,i),s.commit(t)}))}};return e=Object(i.a)([Object(d.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function h(t){return Object(p.a)(t).store}let O=class extends(b(s.a)){};O=Object(i.a)([Object(d.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],O);var y=r(346);const j=t=>{let e=class extends t{constructor(...t){super(...t)}clear(t,e="user"){return g(this).delete(t,Object(n.d)(e))}write(t={},e){return Object(y.b)(this,t=t||{},e),t}setAtOrigin(t,e,r){Object(p.a)(this).setAtOrigin(t,e,Object(n.d)(r))}removeOrigin(t){const e=g(this),r=Object(n.d)(t),i=e.keys(r);for(const s of i)e.originOf(s)===r&&e.set(s,e.get(s,r),6)}updateOrigin(t,e){const r=g(this),i=Object(n.d)(e),s=this.get(t);for(let a=i+1;a<n.a;++a)r.delete(t,a);r.set(t,s,i)}toJSON(t){return this.write({},t)}};return e=Object(i.a)([Object(d.a)("esri.core.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function g(t){return Object(p.a)(t).store}const f=t=>{let e=class extends(j(b(t))){constructor(...t){super(...t)}};return e=Object(i.a)([Object(d.a)("esri.core.MultiOriginJSONSupport")],e),e};let v=class extends(f(s.a)){};v=Object(i.a)([Object(d.a)("esri.core.MultiOriginJSONSupport")],v)},908:function(t,e,r){"use strict";r.r(e);var i=r(76),s=r(83),a=r(257),o=r(216),n=r(78),l=(r(74),r(79),r(75),r(77)),c=r(224),u=r(217);let p=class extends(Object(u.a)(Object(a.a)(c.a))){constructor(t){super(t),this.resourceInfo=null,this.type="unsupported"}initialize(){this.addResolvingPromise(new Promise(((t,e)=>{Object(o.b)((()=>{const t=this.resourceInfo&&(this.resourceInfo.layerType||this.resourceInfo.type);let r="Unsupported layer type";t&&(r+=" "+t),e(new s.a("layer:unsupported-layer-type",r,{layerType:t}))}))})))}read(t,e){const r={resourceInfo:t};null!=t.id&&(r.id=t.id),null!=t.title&&(r.title=t.title),super.read(r,e)}write(t){return Object.assign(t||{},this.resourceInfo,{id:this.id})}};Object(i.a)([Object(n.b)({readOnly:!0})],p.prototype,"resourceInfo",void 0),Object(i.a)([Object(n.b)({type:["show","hide"]})],p.prototype,"listMode",void 0),Object(i.a)([Object(n.b)({json:{read:!1},readOnly:!0,value:"unsupported"})],p.prototype,"type",void 0),p=Object(i.a)([Object(l.a)("esri.layers.UnsupportedLayer")],p);var d=p;e.default=d}}]);
//# sourceMappingURL=151.cda987af.chunk.js.map