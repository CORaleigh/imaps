"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[7310],{80573:(e,t,i)=>{i.d(t,{Z:()=>_});var s=i(27366),n=i(85015),r=i(11582),a=i(79056),o=i(46784),l=i(92026),c=i(49861),u=(i(63780),i(93169),i(25243),i(69912));let h=0,d=class extends((0,o.eC)((0,r.J)((0,a.IG)(n.Z)))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${h++}`,this.title=null}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if((0,l.pC)(t))switch(t.type){case"line-of-sight":t.removeAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this)}this._set("parent",e)}get isEditable(){return this.requiredPropertiesForEditing.every(l.pC)}};(0,s._)([(0,c.Cb)({type:String,constructOnly:!0,clonable:!1})],d.prototype,"id",void 0),(0,s._)([(0,c.Cb)({type:String})],d.prototype,"title",void 0),(0,s._)([(0,c.Cb)({constructOnly:!0})],d.prototype,"type",void 0),(0,s._)([(0,c.Cb)({clonable:!1,value:null})],d.prototype,"parent",null),(0,s._)([(0,c.Cb)({readOnly:!0})],d.prototype,"extent",void 0),(0,s._)([(0,c.Cb)({readOnly:!0})],d.prototype,"isEditable",null),(0,s._)([(0,c.Cb)({readOnly:!0})],d.prototype,"requiredPropertiesForEditing",void 0),(0,s._)([(0,c.Cb)({readOnly:!0})],d.prototype,"nonEditableMessage",void 0),d=(0,s._)([(0,u.j)("esri.analysis.Analysis")],d);const _=d},58971:(e,t,i)=>{i.d(t,{G6:()=>E,Ie:()=>C,J9:()=>w,RF:()=>v,U1:()=>P,vY:()=>l,ym:()=>m});var s=i(92026),n=i(77981);const r=(e,t,i)=>[t,i],a=(e,t,i)=>[t,i,e[2]],o=(e,t,i)=>[t,i,e[2],e[3]];function l(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,s.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function c(e,t){let{scale:i,translate:s}=e;return Math.round((t-s[0])/i[0])}function u(e,t){let{scale:i,translate:s}=e;return Math.round((s[1]-t)/i[1])}function h(e,t,i){const s=[];let n,r,a,o;for(let l=0;l<i.length;l++){const h=i[l];l>0?(a=c(e,h[0]),o=u(e,h[1]),a===n&&o===r||(s.push(t(h,a-n,o-r)),n=a,r=o)):(n=c(e,h[0]),r=u(e,h[1]),s.push(t(h,n,r)))}return s.length>0?s:null}function d(e,t){let{scale:i,translate:s}=e;return t*i[0]+s[0]}function _(e,t){let{scale:i,translate:s}=e;return s[1]-t*i[1]}function p(e,t,i){const s=new Array(i.length);if(!i.length)return s;const[n,r]=e.scale;let a=d(e,i[0][0]),o=_(e,i[0][1]);s[0]=t(i[0],a,o);for(let l=1;l<i.length;l++){const e=i[l];a+=e[0]*n,o-=e[1]*r,s[l]=t(e,a,o)}return s}function y(e,t,i){const s=new Array(i.length);for(let n=0;n<i.length;n++)s[n]=p(e,t,i[n]);return s}function b(e,t,i,s,n){return t.points=function(e,t,i,s){return h(e,i?s?o:a:s?a:r,t)}(e,i.points,s,n),t}function v(e,t,i,s,n){return t.x=c(e,i.x),t.y=u(e,i.y),t!==i&&(s&&(t.z=i.z),n&&(t.m=i.m)),t}function g(e,t,i,s,n){const l=function(e,t,i,s){const n=[],l=i?s?o:a:s?a:r;for(let r=0;r<t.length;r++){const i=h(e,l,t[r]);i&&i.length>=3&&n.push(i)}return n.length?n:null}(e,i.rings,s,n);return l?(t.rings=l,t):null}function f(e,t,i,s,n){const l=function(e,t,i,s){const n=[],l=i?s?o:a:s?a:r;for(let r=0;r<t.length;r++){const i=h(e,l,t[r]);i&&i.length>=2&&n.push(i)}return n.length?n:null}(e,i.paths,s,n);return l?(t.paths=l,t):null}function m(e,t){return e&&t?(0,n.wp)(t)?v(e,{},t,!1,!1):(0,n.l9)(t)?f(e,{},t,!1,!1):(0,n.oU)(t)?g(e,{},t,!1,!1):(0,n.aW)(t)?b(e,{},t,!1,!1):(0,n.YX)(t)?function(e,t,i,s,n){return t.xmin=c(e,i.xmin),t.ymin=u(e,i.ymin),t.xmax=c(e,i.xmax),t.ymax=u(e,i.ymax),t!==i&&(s&&(t.zmin=i.zmin,t.zmax=i.zmax),n&&(t.mmin=i.mmin,t.mmax=i.mmax)),t}(e,{},t,!1,!1):null:null}function w(e,t,i,n,l){return(0,s.pC)(i)&&(t.points=function(e,t,i,s){return p(e,i?s?o:a:s?a:r,t)}(e,i.points,n,l)),t}function P(e,t,i,n,r){return(0,s.Wi)(i)||(t.x=d(e,i.x),t.y=_(e,i.y),t!==i&&(n&&(t.z=i.z),r&&(t.m=i.m))),t}function C(e,t,i,n,l){return(0,s.pC)(i)&&(t.rings=function(e,t,i,s){return y(e,i?s?o:a:s?a:r,t)}(e,i.rings,n,l)),t}function E(e,t,i,n,l){return(0,s.pC)(i)&&(t.paths=function(e,t,i,s){return y(e,i?s?o:a:s?a:r,t)}(e,i.paths,n,l)),t}},74509:(e,t,i)=>{i.d(t,{Lt:()=>c,Ou:()=>h,RL:()=>l,VW:()=>a,Zz:()=>r,vQ:()=>d,vu:()=>o,zx:()=>_});var s=i(92026),n=i(88152);function r(e,t){return(0,s.Wi)(t)||!t.mode?e?"absolute-height":"on-the-ground":t.mode}function a(e,t){return r(!!(0,s.pC)(e)&&e.hasZ,t)}function o(e){const t=u(e);return a(e.geometry,t)}function l(e){const t=u(e),i=a(e.geometry,t);return{mode:i,offset:(0,s.pC)(t)&&"on-the-ground"!==i?(0,s.Pt)(t.offset,0)*(0,n.Z7)((0,s.Pt)(t.unit,"meters")):0}}function c(e){if("on-the-ground"===o(e))return!1;const t=u(e),i=(0,s.pC)(t)&&t.featureExpressionInfo?t.featureExpressionInfo.expression:null;return!(!i||"0"===i)}function u(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function h(e,t,i){if((0,s.Wi)(i)||!i.mode)return;const n=e.hasZ?e.z:0,r=(0,s.pC)(i.offset)?i.offset:0;switch(i.mode){case"absolute-height":return n-r;case"on-the-ground":return 0;case"relative-to-ground":return n-((0,s.Pt)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"ground"),0)+r);case"relative-to-scene":return n-((0,s.Pt)(t.elevationProvider.getElevation(e.x,e.y,e.z,e.spatialReference,"scene"),0)+r)}}function d(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return p(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,i,s)}function _(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return p(e,t[0],t[1],t.length>2?t[2]:0,i,s,n)}function p(e,t,i,n,r,a){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if((0,s.Wi)(a))return;const l=(0,s.pC)(o)?o.mode:"absolute-height";if("on-the-ground"===l)return 0;const{absoluteZ:c}=y(t,i,n,r,e,a);return b(c,t,i,n,r,e,o,l)}function y(e,t,i,n,r,a){const o=(0,s.pC)(a.offset)?a.offset:0;switch(a.mode){case"absolute-height":return{absoluteZ:i+o,elevation:0};case"on-the-ground":{const i=(0,s.Pt)(r.elevationProvider.getElevation(e,t,0,n,"ground"),0);return{absoluteZ:i,elevation:i}}case"relative-to-ground":{const a=(0,s.Pt)(r.elevationProvider.getElevation(e,t,i,n,"ground"),0);return{absoluteZ:i+a+o,elevation:a}}case"relative-to-scene":{const a=(0,s.Pt)(r.elevationProvider.getElevation(e,t,i,n,"scene"),0);return{absoluteZ:i+a+o,elevation:a}}}}function b(e,t,i,n,r,a,o,l){const c=(0,s.pC)(o)&&(0,s.pC)(o.offset)?o.offset:0;switch(l){case"absolute-height":return e-c;case"relative-to-ground":return e-((0,s.Pt)(a.elevationProvider.getElevation(t,i,n,r,"ground"),0)+c);case"relative-to-scene":return e-((0,s.Pt)(a.elevationProvider.getElevation(t,i,n,r,"scene"),0)+c)}}},48681:(e,t,i)=>{i.d(t,{y1:()=>a});i(11186);var s=i(71353),n=(i(2170),i(80885)),r=(i(79803),i(78952));i(15559),i(80064);function a(e){return"mouse"!==e.pointerType||0===e.button}const o=(0,s.c)(),l=(0,s.c)(),c=(0,s.c)();new n.Z({rings:[[o,l,c]],spatialReference:r.Z.WGS84}),(0,s.c)()},92382:(e,t,i)=>{i.d(t,{G:()=>n,e:()=>s});class s{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.screenPoint=e,this.result=t}}class n{constructor(e,t){this.scenePoint=e,this.mapPoint=t}}},86509:(e,t,i)=>{i.d(t,{f:()=>l});var s=i(27366),n=i(94172),r=i(49861),a=(i(63780),i(93169),i(25243),i(69912)),o=i(45900);let l=class extends o.m{constructor(e){super(e)}initialize(){this.own((0,n.YP)((()=>this.analysisViewData.visible),(e=>this.visible=e),n.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};(0,s._)([(0,r.Cb)({constructOnly:!0})],l.prototype,"analysis",void 0),(0,s._)([(0,r.Cb)()],l.prototype,"analysisViewData",void 0),l=(0,s._)([(0,a.j)("esri.views.interactive.AnalysisToolBase")],l)},44070:(e,t,i)=>{i.d(t,{f:()=>h});var s=i(63780),n=i(32718),r=i(92026),a=i(18722),o=i(37825),l=i(49800),c=i(8548);const u=n.Z.getLogger("esri.views.webgl.BufferObject");class h{constructor(e,t,i,s){this._context=e,this.bufferType=t,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(c._g.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,o.zu)(this._context.gl),s&&this.setData(s)}static createIndex(e,t,i){return new h(e,c.w0.ELEMENT_ARRAY_BUFFER,t,i)}static createVertex(e,t,i){return new h(e,c.w0.ARRAY_BUFFER,t,i)}static createUniform(e,t,i){if(e.type!==l.zO.WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new h(e,c.w0.UNIFORM_BUFFER,t,i)}static createPixelPack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.l1.STREAM_READ,i=arguments.length>2?arguments[2]:void 0;if(e.type!==l.zO.WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");const s=new h(e,c.w0.PIXEL_PACK_BUFFER,t);return i&&s.setSize(i),s}static createPixelUnpack(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.l1.STREAM_DRAW,i=arguments.length>2?arguments[2]:void 0;if(e.type!==l.zO.WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new h(e,c.w0.PIXEL_UNPACK_BUFFER,t,i)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get byteSize(){return this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER?this._indexType===c.g.UNSIGNED_INT?4*this._size:2*this._size:this._size}get _isVAOAware(){return this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER||this.bufferType===c.w0.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(c._g.BufferObject,this),this._context=null):this._glName&&u.warn("Leaked WebGL buffer object")}setSize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e<=0&&u.error("Buffer size needs to be positive!"),this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER&&(0,r.pC)(t))switch(this._indexType=t,t){case c.g.UNSIGNED_SHORT:e*=2;break;case c.g.UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER&&((0,a.Uc)(e)&&(t/=2,this._indexType=c.g.UNSIGNED_SHORT),(0,a.ZY)(e)&&(t/=4,this._indexType=c.g.UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._size=e;const i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const s=this._context.gl;(0,r.pC)(t)?s.bufferData(this.bufferType,t,this.usage):s.bufferData(this.bufferType,e,this.usage),(0,o.zu)(s),this._isVAOAware&&this._context.bindVAO(i)}setSubData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength;if(!e)return;(t<0||t>=this._size)&&u.error("offset is out of range!");let n=t,r=i,l=s,h=e.byteLength;this.bufferType===c.w0.ELEMENT_ARRAY_BUFFER&&((0,a.Uc)(e)?(h/=2,n*=2,r*=2,l*=2):(0,a.ZY)(e)&&(h/=4,n*=4,r*=4,l*=4)),void 0===s&&(s=h-1),i>=s&&u.error("end must be bigger than start!"),t+i-s>this._size&&u.error("An attempt to write beyond the end of the buffer!");const d=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const _=this._context.gl,p=ArrayBuffer.isView(e)?e.buffer:e,y=0===r&&l===e.byteLength?p:p.slice(r,l);_.bufferSubData(this.bufferType,n,y),(0,o.zu)(_),this._isVAOAware&&this._context.bindVAO(d)}setSubDataFromView(e,t,i,s){if(!e)return;(t<0||t>=this._size)&&u.error("offset is out of range!"),i>=s&&u.error("end must be bigger than start!"),t+i-s>this._size&&u.error("An attempt to write beyond the end of the buffer!");const n=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const r=this._context.gl;if(this._context.type===l.zO.WEBGL2)r.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,i,s-i);else{const n=0===i&&s===e.length?e:e.subarray(i,s);r.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,n)}(0,o.zu)(r),this._isVAOAware&&this._context.bindVAO(n)}getSubData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(this._context.type!==l.zO.WEBGL2)return void u.error("Get buffer subdata is supported in WebGL2 only!");if(i<0||n<0)return void u.error("Problem getting subdata: offset and length were less than zero!");const r=function(e){return(0,s.zG)(e)}(e)?e.BYTES_PER_ELEMENT:1;if(r*((i??0)+(n??0))>e.byteLength)return void u.error("Problem getting subdata: offset and length exceeded destination size!");t+r*(n??0)>this.byteSize&&u.warn("Potential problem getting subdata: requested data exceeds buffer size!");const a=this._context.gl;this._context.bindBuffer(this,c.w0.COPY_READ_BUFFER),a.getBufferSubData(c.w0.COPY_READ_BUFFER,t,e,i,n),this._context.unbindBuffer(c.w0.COPY_READ_BUFFER)}async getSubDataAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this._context.type===l.zO.WEBGL2?(await this._context.clientWaitAsync(),this.getSubData(e,t,i,s)):u.error("Get buffer subdata is supported in WebGL2 only!")}}},3384:(e,t,i)=>{i.d(t,{HH:()=>r,RG:()=>c,UF:()=>l,XP:()=>o,_V:()=>a,un:()=>u});i(93169);var s=i(92026),n=i(8548);function r(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"A numeric argument is out of range";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(e,t){return e.vertexBuffers[t].size/function(e){return e[0].stride}(e.layout[t])}function o(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;const r=e.gl,a=e.capabilities.instancing;e.bindBuffer(i);for(const o of s){const e=t.get(o.name);void 0===e&&console.error(`There is no location for vertex attribute '${o.name}' defined.`);const i=n*o.stride;if(o.count<=4)r.vertexAttribPointer(e,o.count,o.type,o.normalized,o.stride,o.offset+i),r.enableVertexAttribArray(e),o.divisor>0&&a&&a.vertexAttribDivisor(e,o.divisor);else if(9===o.count)for(let t=0;t<3;t++)r.vertexAttribPointer(e+t,3,o.type,o.normalized,o.stride,o.offset+12*t+i),r.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else if(16===o.count)for(let t=0;t<4;t++)r.vertexAttribPointer(e+t,4,o.type,o.normalized,o.stride,o.offset+16*t+i),r.enableVertexAttribArray(e+t),o.divisor>0&&a&&a.vertexAttribDivisor(e+t,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count)}}function l(e,t,i,s){const r=e.gl,a=e.capabilities.instancing;e.bindBuffer(i);for(const n of s){const e=t.get(n.name);if(n.count<=4)r.disableVertexAttribArray(e),n.divisor&&n.divisor>0&&a&&a.vertexAttribDivisor(e,0);else if(9===n.count)for(let t=0;t<3;t++)r.disableVertexAttribArray(e+t),n.divisor&&n.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else if(16===n.count)for(let t=0;t<4;t++)r.disableVertexAttribArray(e+t),n.divisor&&n.divisor>0&&a&&a.vertexAttribDivisor(e+t,0);else console.error("Unsupported vertex attribute element count: "+n.count)}e.unbindBuffer(n.w0.ARRAY_BUFFER)}function c(e){switch(e){case n.VI.ALPHA:case n.VI.LUMINANCE:case n.VI.RED:case n.VI.RED_INTEGER:case n.lP.R8:case n.lP.R8I:case n.lP.R8UI:case n.lP.R8_SNORM:case n.Tg.STENCIL_INDEX8:return 1;case n.VI.LUMINANCE_ALPHA:case n.VI.RG:case n.VI.RG_INTEGER:case n.lP.RGBA4:case n.lP.R16F:case n.lP.R16I:case n.lP.R16UI:case n.lP.RG8:case n.lP.RG8I:case n.lP.RG8UI:case n.lP.RG8_SNORM:case n.lP.RGB565:case n.lP.RGB5_A1:case n.Tg.DEPTH_COMPONENT16:return 2;case n.VI.DEPTH_COMPONENT:case n.VI.RGB:case n.VI.RGB_INTEGER:case n.lP.RGB8:case n.lP.RGB8I:case n.lP.RGB8UI:case n.lP.RGB8_SNORM:case n.lP.SRGB8:case n.Tg.DEPTH_COMPONENT24:return 3;case n.VI.DEPTH_STENCIL:case n.VI.RGBA:case n.VI.RGBA_INTEGER:case n.lP.RGBA8:case n.lP.R32F:case n.lP.R11F_G11F_B10F:case n.lP.RG16F:case n.lP.R32I:case n.lP.R32UI:case n.lP.RG16I:case n.lP.RG16UI:case n.lP.RGBA8I:case n.lP.RGBA8UI:case n.lP.RGBA8_SNORM:case n.lP.SRGB8_ALPHA8:case n.lP.RGB9_E5:case n.lP.RGB10_A2UI:case n.lP.RGB10_A2:case n.Tg.DEPTH_STENCIL:case n.Tg.DEPTH_COMPONENT32F:case n.Tg.DEPTH24_STENCIL8:return 4;case n.Tg.DEPTH32F_STENCIL8:return 5;case n.lP.RGB16F:case n.lP.RGB16I:case n.lP.RGB16UI:return 6;case n.lP.RG32F:case n.lP.RG32I:case n.lP.RG32UI:case n.lP.RGBA16F:case n.lP.RGBA16I:case n.lP.RGBA16UI:return 8;case n.lP.RGB32F:case n.lP.RGB32I:case n.lP.RGB32UI:return 12;case n.lP.RGBA32F:case n.lP.RGBA32I:case n.lP.RGBA32UI:return 16;case n.q_.COMPRESSED_RGB_S3TC_DXT1_EXT:case n.q_.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case n.q_.COMPRESSED_RGBA_S3TC_DXT3_EXT:case n.q_.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case n.q_.COMPRESSED_R11_EAC:case n.q_.COMPRESSED_SIGNED_R11_EAC:case n.q_.COMPRESSED_RGB8_ETC2:case n.q_.COMPRESSED_SRGB8_ETC2:case n.q_.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case n.q_.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case n.q_.COMPRESSED_RG11_EAC:case n.q_.COMPRESSED_SIGNED_RG11_EAC:case n.q_.COMPRESSED_RGBA8_ETC2_EAC:case n.q_.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}function u(e){if((0,s.Wi)(e))return 0;if("descriptor"in e)return e.glName?u(e.descriptor):0;const t=e.internalFormat||"pixelFormat"in e&&e.pixelFormat;if(!t)return 0;const i="hasMipmap"in e&&e.hasMipmap?1.3:1,n=e.width*e.height;return c(t)*n*i}},45412:(e,t,i)=>{i.d(t,{U:()=>l});var s=i(32718),n=i(92026),r=i(8548),a=i(3384);const o=s.Z.getLogger("esri.views.webgl.VertexArrayObject");class l{constructor(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this._context=e,this._locations=t,this._layout=i,this._buffers=s,this._indexBuffer=n,this._glName=null,this._initialized=!1,e.instanceCounter.increment(r._g.VertexArrayObject,this)}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get size(){return Object.keys(this._buffers).reduce(((e,t)=>e+this._buffers[t].size),(0,n.pC)(this._indexBuffer)?this._indexBuffer.size:0)}get layout(){return this._layout}get locations(){return this._locations}dispose(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._context){if(this._glName){const e=this._context?.capabilities?.vao;e?(e.deleteVertexArray(this._glName),this._glName=null):o.warn("Leaked WebGL VAO")}if(this._context.getBoundVAO()===this&&this._context.bindVAO(null),e){for(const e in this._buffers)this._buffers[e].dispose(),delete this._buffers[e];this._indexBuffer=(0,n.O3)(this._indexBuffer)}this._context.instanceCounter.decrement(r._g.VertexArrayObject,this),this._context=null}else(this._glName||e&&Object.getOwnPropertyNames(this._buffers).length>0)&&o.warn("Leaked WebGL VAO")}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:i}=this;e||o.error("Vertex buffer dictionary is empty!");const s=this._context.gl;for(const n in e){const i=e[n];i||o.error("Vertex buffer is uninitialized!");const s=t[n];s||o.error("Vertex element descriptor is empty!"),(0,a.XP)(this._context,this._locations,i,s)}(0,n.pC)(i)&&(this._context.capabilities.vao?s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:e,_layout:t}=this;e||o.error("Vertex buffer dictionary is empty!");for(const i in e){const s=e[i];s||o.error("Vertex buffer is uninitialized!");const n=t[i];(0,a.UF)(this._context,this._locations,s,n)}(0,n.pC)(this._indexBuffer)&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}},47899:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Q});var s=i(27366),n=i(66978),r=i(68860),a=i(8025),o=(i(63780),i(93169),i(25243),i(49861)),l=i(69912),c=i(69407),u=i(80573),h=i(92026),d=i(53866),_=i(7882);let p=class extends u.Z{constructor(e){super(e),this.type="direct-line-measurement",this.startPoint=null,this.endPoint=null,this.unit=null,this.nonEditableMessage="Assign start and end points to the analysis to allow editing."}get extent(){if((0,h.Wi)(this.startPoint))return null;const e=d.Z.fromPoint(this.startPoint);return(0,h.pC)(this.endPoint)&&e.union(d.Z.fromPoint(this.endPoint)),e}get requiredPropertiesForEditing(){return[this.startPoint,this.endPoint]}clear(){this.startPoint=null,this.endPoint=null}};(0,s._)([(0,o.Cb)({type:["direct-line-measurement"]})],p.prototype,"type",void 0),(0,s._)([(0,o.Cb)({type:_.Z})],p.prototype,"startPoint",void 0),(0,s._)([(0,o.Cb)({type:_.Z})],p.prototype,"endPoint",void 0),(0,s._)([(0,o.Cb)()],p.prototype,"extent",null),(0,s._)([(0,o.Cb)({type:r.oD,value:null})],p.prototype,"unit",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],p.prototype,"requiredPropertiesForEditing",null),(0,s._)([(0,o.Cb)({readOnly:!0})],p.prototype,"nonEditableMessage",void 0),p=(0,s._)([(0,l.j)("esri.analysis.DirectLineMeasurementAnalysis")],p);const y=p;var b,v,g,f=i(77671),m=(i(59486),i(100)),w=i(94172),P=i(17842),C=i(71353),E=i(37818),A=i(48681),R=i(51328),x=i(85015),T=i(85981);!function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(b||(b={})),function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(v||(v={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(g||(g={}));var D=i(83639),V=i(62389);const O={laserLineGlowColor:[1,.5,0],laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:[1,1,1],laserLineInnerWidth:.75,laserLineGlobalAlpha:.75,handleColor:[1,.5,0],handleOpacity:.5,handleRadius:5};var M;!function(e){e.Manipulators="manipulators",e.AnalysisViewDestroyed="analysis-view-destroyed",e.AnalysisView="analysis-view"}(M||(M={}));let S=class extends x.Z{constructor(e){super(e),this.params=O,this.analysisViewData=null,this.cursorPoint=null,this._visible=!1,this._laserLine=null,this.laserLineEnabled=!0,this._handles=new m.Z,this._lastDraggedHandle=null}initialize(){this._laserLine=new V.W({view:this.view,attached:!0}),this._updateVisibility(this._visible),this._connectToAnalysisView()}destroy(){this._handles=(0,h.SC)(this._handles),this._laserLine=(0,h.SC)(this._laserLine)}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){const e=this._laserLine.testData,t=this.analysisViewData.testData;return{labels:t?.labels,stripeLength:t?.stripeLength,laserLineRenderer:{heightManifoldEnabled:!!(0,h.pC)(e)&&e.heightManifoldEnabled,heightManifoldTarget:(0,h.pC)(e)?e.heightManifoldTarget:null,pointDistanceEnabled:!!(0,h.pC)(e)&&e.pointDistanceEnabled,pointDistanceOrigin:(0,h.pC)(e)?e.pointDistanceOrigin:null,pointDistanceTarget:(0,h.pC)(e)?e.pointDistanceTarget:null,lineVerticalPlaneEnabled:!!(0,h.pC)(e)&&e.lineVerticalPlaneEnabled}}}get _cursorPosition(){const e=(0,C.c)();return(0,h.yw)(this.cursorPoint,(t=>this.view.renderCoordsHelper.toRenderCoords(t,e))),e}get _startPosition(){const e=(0,C.c)();return(0,h.yw)(this.analysis.startPoint,(t=>this.view.renderCoordsHelper.toRenderCoords(t,e))),e}get _endPosition(){const e=(0,C.c)();return(0,h.yw)(this.analysis.endPoint,(t=>this.view.renderCoordsHelper.toRenderCoords(t,e))),e}get _laserLineParams(){const e=this._focusPosition,{active:t,lineState:i}=this.toolState,s=this.analysisViewData,n=this.laserLineEnabled&&!!e&&"measured"!==i&&t;if(!n||!this.visible||(0,h.Wi)(s)||s.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};const r=s.actualVisualizedMeasurement,a="local"!==this.view.viewingMode&&n&&!!this.analysis.startPoint&&"geodesic"===r,o=n&&s.viewMode===v.Triangle;return{heightManifoldTarget:"euclidean"===r?e:null,pointDistanceLine:a?this._pointDistanceLine:null,lineVerticalPlaneSegment:o?(0,T.zk)(this._startPosition,this._endPosition):null}}get _focusPosition(){const{lineState:e}=this.toolState,t=this.analysisViewData,i=(0,h.pC)(t)&&!t.destroyed&&t.measurementMode===b.Euclidean&&t.viewMode===v.Direct;switch(e){case"drawing":return i?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case"editing":return i?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return(0,h.pC)(this.cursorPoint)?this._cursorPosition:null}}get _pointDistanceLine(){return{origin:"drawing"===this.toolState.lineState||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition,target:this._focusPosition}}createManipulators(){const e=()=>{const e=(0,D.aD)(this.view,this.params.handleColor,this.params.handleOpacity);return e.available=!1,e.radius=this.params.handleRadius,e},t=e(),i=e();(0,h.pC)(this.analysis.startPoint)&&(t.location=this.analysis.startPoint,t.available=!0),(0,h.pC)(this.analysis.endPoint)&&(i.location=this.analysis.endPoint,i.available=!0);const s=()=>{let e=this._lastDraggedHandle;t.grabbing&&!i.grabbing&&(e="start"),i.grabbing&&!t.grabbing&&(e="end"),t.grabbing||i.grabbing||(e=null),this._lastDraggedHandle=e},n=t.events.on("grab-changed",s),r=i.events.on("grab-changed",s);return this._handles.add([n,r],M.Manipulators),{start:t,end:i}}show(){this.destroyed||this._visible||this._updateVisibility(!0)}hide(){!this.destroyed&&this._visible&&this._updateVisibility(!1)}_connectToAnalysisView(){this._handles.remove(M.AnalysisView),this._handles.add([(0,w.YP)((()=>(0,h.yw)(this.analysisViewData,(e=>e.destroyed))),(e=>{e&&this._handles.remove(M.AnalysisView)}),w.nn),(0,w.YP)((()=>["measured"===this.toolState.lineState,this.analysisViewData]),(e=>{let[t,i]=e;(0,h.pC)(i)&&!i.destroyed&&(i.allowVisualElementsOrientationChange=!t)}),w.nn),(0,w.YP)((()=>this._laserLineParams),(e=>{const t=this._laserLine;t.heightManifoldTarget=e.heightManifoldTarget,t.pointDistanceLine=e.pointDistanceLine,t.lineVerticalPlaneSegment=e.lineVerticalPlaneSegment}),w.nn)],M.AnalysisView)}_updateVisibility(e){this.constructed&&(this._visible=e,e?this._laserLine.style={innerColor:this.params.laserLineInnerColor,innerWidth:this.params.laserLineInnerWidth,glowColor:this.params.laserLineGlowColor,glowWidth:this.params.laserLineGlowWidth,glowFalloff:this.params.laserLineGlowFalloff,globalAlpha:this.params.laserLineGlobalAlpha}:this.view.cursor=null,this._laserLine.visible=e)}};(0,s._)([(0,o.Cb)()],S.prototype,"view",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"params",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0})],S.prototype,"analysis",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0})],S.prototype,"analysisViewData",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"cursorPoint",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"toolState",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"visible",null),(0,s._)([(0,o.Cb)()],S.prototype,"testData",null),(0,s._)([(0,o.Cb)()],S.prototype,"_visible",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"_laserLine",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"laserLineEnabled",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"_cursorPosition",null),(0,s._)([(0,o.Cb)()],S.prototype,"_startPosition",null),(0,s._)([(0,o.Cb)()],S.prototype,"_endPosition",null),(0,s._)([(0,o.Cb)()],S.prototype,"_lastDraggedHandle",void 0),(0,s._)([(0,o.Cb)()],S.prototype,"_laserLineParams",null),(0,s._)([(0,o.Cb)()],S.prototype,"_focusPosition",null),(0,s._)([(0,o.Cb)()],S.prototype,"_pointDistanceLine",null),S=(0,s._)([(0,l.j)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],S);var L=i(92382),I=i(77648),B=i(81268),G=i(54463),U=i(86509),N=i(74229),F=i(72612);let z=class extends U.f{constructor(e){super(e),this._handles=new m.Z,this._cachedPickRequest=null,this._isAnyPointerDown=!1,this.lineState="initial",this.analysisViewData=null,this.startPointSurfaceLocation=null,this.endPointSurfaceLocation=null,this.startManipulator=null,this.endManipulator=null}initialize(){const{view:e,analysis:t,analysisViewData:i,cursorPoint:s,visible:n}=this;this.measurementView=new S({toolState:this,view:e,analysis:t,analysisViewData:i,cursorPoint:s,visible:n}),this._intersector=(0,B.Z8)(this.view.state.viewingMode),this._intersector.options.store=G.eC.MIN;const{start:r,end:a}=this.measurementView.createManipulators(),o=(e,t,i)=>(0,N.Xd)(e,((e,s,n)=>{const r=(0,R.J4)(e);s.next(r).next((0,R.gv)(this.view)).next((e=>"start"!==e.action?e:null)).next((s=>{const n=(0,E.WG)(s.mapEnd,new _.Z);this.analysis[t]=n,e.location=n,this[i]=this._surfaceLocation(n,s.surfaceType)})),n.next(r).next((0,N.di)(this.analysis,[t])).next((0,N.di)(this,[i])).next((()=>{e.location=(0,h.Wg)(this.analysis[t])}))})),l=e=>e.events.on("grab-changed",(()=>{const e=r.grabbing||a.grabbing;this.lineState=e?"editing":"measured"}));this._handles.add([o(r,"startPoint","startPointSurfaceLocation"),o(a,"endPoint","endPointSurfaceLocation"),l(r),l(a)]),this.manipulators.add(r),this.manipulators.add(a),this.startManipulator=r,this.endManipulator=a,this._handles.add((0,w.YP)((()=>this.state),(e=>{"measured"===e&&this.finishToolCreation()}),w.tX))}destroy(){this.measurementView=(0,h.SC)(this.measurementView),this._handles=(0,h.SC)(this._handles)}get state(){return(0,h.Wi)(this.analysis.startPoint)&&(0,h.Wi)(this.analysis.endPoint)?"ready":this.validMeasurement&&"editing"!==this.lineState&&"drawing"!==this.lineState?"measured":"measuring"}get cursor(){return"ready"===this.state||"drawing"===this.lineState?"crosshair":null}set cursorPoint(e){this._set("cursorPoint",e),this.measurementView.cursorPoint=e}get validMeasurement(){return(0,h.pC)(this.analysis.startPoint)&&(0,h.pC)(this.analysis.endPoint)}onShow(){this.measurementView.show(),this._updateManipulatorAvailability()}onHide(){this.measurementView.hide()}onInputEvent(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"pointer-down":this._handlePointerDown();break;case"pointer-up":this._handlePointerUp()}this._updateManipulatorAvailability()}_handlePointerMove(e){this._clearCachedPickRequest();const t=(0,F.vT)(e);"mouse"===e.pointerType&&(this._hoverAt(t),"drawing"===this.lineState&&(this.endManipulator.events.emit("drag",{action:"update",start:t,screenPoint:t}),e.stopPropagation()))}_handlePointerDown(){this._isAnyPointerDown=!0}_handlePointerUp(){this._isAnyPointerDown=!1}_handleImmediateClick(e){if(this._clearCachedPickRequest(),!(0,A.y1)(e))return;const t=(0,F.vT)(e),i=e.pointerType;let s=!1;if(this.active)switch(this.lineState){case"initial":this.startManipulator.events.emit("drag",{action:"start",pointerType:i,start:t,screenPoint:t}),this.startManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),(0,h.pC)(this.analysis.startPoint)&&(this.startManipulator.interactive=!1,this.endManipulator.interactive=!1,this.lineState="drawing",this.endManipulator.events.emit("drag",{action:"start",pointerType:i,start:t,screenPoint:t}),s=!0);break;case"drawing":this.endManipulator.events.emit("drag",{action:"update",start:t,screenPoint:t}),(0,h.pC)(this.analysis.endPoint)&&(this.endManipulator.events.emit("drag",{action:"end",start:t,screenPoint:t}),this.startManipulator.interactive=!0,this.endManipulator.interactive=!0,this.lineState="measured",s=!0)}s&&e.stopPropagation(),"mouse"===e.pointerType&&this._hoverAt(t)}_hoverAt(e){const t=this._isAnyPointerDown&&"drawing"!==this.lineState&&"editing"!==this.lineState;if(((0,h.Wi)(this.analysis.startPoint)||(0,h.Wi)(this.analysis.endPoint))&&this.active&&!t){const t=this._pick(e);(0,h.pC)(t)&&(this.cursorPoint=t)}else this.cursorPoint=null}_pick(e){if((0,h.pC)(this._cachedPickRequest)&&(0,h.pC)(this._cachedPickRequest.result)){const t=this._cachedPickRequest.screenPoint;if(t.x===e.x&&t.y===e.y)return this._cachedPickRequest.result.mapPoint}else this._cachedPickRequest=new L.e(e);const t=(0,P.md)(e);this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(t,this._intersector);const i=this._intersector.results.min,s=W;if(!i.getIntersectionPoint(s))return null;const n=this.view.renderCoordsHelper.fromRenderCoords(s,this.view.spatialReference);return this._cachedPickRequest.result=new L.G(s,n),n}_clearCachedPickRequest(){this._cachedPickRequest=null}_surfaceLocation(e,t){return t===R.cx.GROUND?"on-the-surface":e.z>=this._getElevation(e)?"above-the-surface":"below-the-surface"}_updateManipulatorAvailability(){this.startManipulator.available=(0,h.pC)(this.analysis.startPoint),this.endManipulator.available=(0,h.pC)(this.analysis.endPoint)}_getElevation(e){return this.view.basemapTerrain.ready?(0,h.Pt)((0,I.KO)(this.view.elevationProvider,e),0):0}};(0,s._)([(0,o.Cb)({readOnly:!0})],z.prototype,"state",null),(0,s._)([(0,o.Cb)()],z.prototype,"lineState",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],z.prototype,"cursor",null),(0,s._)([(0,o.Cb)()],z.prototype,"cursorPoint",null),(0,s._)([(0,o.Cb)({constructOnly:!0})],z.prototype,"analysis",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0})],z.prototype,"analysisViewData",void 0),(0,s._)([(0,o.Cb)()],z.prototype,"measurementView",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0})],z.prototype,"view",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],z.prototype,"validMeasurement",null),(0,s._)([(0,o.Cb)({value:null})],z.prototype,"startPointSurfaceLocation",void 0),(0,s._)([(0,o.Cb)({value:null})],z.prototype,"endPointSurfaceLocation",void 0),z=(0,s._)([(0,l.j)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],z);const W=(0,C.c)(),k=z;var H=i(40085);let Z=class extends H.O{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="DirectLineMeasurement3DViewModel is only supported in 3D views.",this._userUnit=null,this._userUnitOptions=null}get state(){return this.disabled||!this.ready?"disabled":(0,h.Wi)(this.tool)?"ready":this.tool.state}get measurement(){if((0,h.Wi)(this.tool))return null;const e={mode:"euclidean",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:null,state:"unavailable"},verticalDistance:{text:null,state:"unavailable"}},{analysisViewData:t}=this.tool;if((0,h.Wi)(t))return e;const i=t.actualVisualizedMeasurement,s=(0,h.pC)(t.result)?"available":"unavailable";switch(i){case"euclidean":return{mode:"euclidean",directDistance:{text:t.directLabelText,state:s},horizontalDistance:{text:t.horizontalLabelText,state:s},verticalDistance:{text:t.verticalLabelText,state:s}};case"geodesic":return{mode:"geodesic",directDistance:{text:null,state:"unavailable"},horizontalDistance:{text:t.horizontalLabelText,state:s},verticalDistance:{text:t.verticalLabelText,state:s}};default:return e}}set unitOptions(e){this._userUnitOptions=e,this._set("unitOptions",this._filteredOrAllUnits(this._userUnitOptions))}get unitOptions(){return this._filteredOrAllUnits(this._userUnitOptions)}set unit(e){this._userUnit=e?this._findSelectableUnit(e,this._userUnit):null,this.analysis.unit=e}get unit(){return this._userUnit?(this._userUnit=this._findSelectableUnit(this._userUnit,this.defaultUnit),this._userUnit):this._findSelectableUnit(this.defaultUnit)}constructAnalysis(){return new y}constructTool(){return new k({view:(0,h.Wg)(this.view),analysis:this.analysis,analysisViewData:(0,h.Wg)(this.analysisView),visible:this.visible})}_findSelectableUnit(e,t){const i=this.unitOptions;return i.includes(e)?e:t?this._findSelectableUnit(t):i[0]}_filteredOrAllUnits(e){if(!e)return r.oD.slice();const t=e.filter((e=>r.oD.includes(e)));return 0===t.length?r.oD.slice():t}};(0,s._)([(0,o.Cb)({type:y})],Z.prototype,"analysis",void 0),(0,s._)([(0,o.Cb)({readOnly:!0})],Z.prototype,"state",null),(0,s._)([(0,o.Cb)({readOnly:!0})],Z.prototype,"measurement",null),(0,s._)([(0,o.Cb)()],Z.prototype,"unitOptions",null),(0,s._)([(0,o.Cb)()],Z.prototype,"unit",null),(0,s._)([(0,o.Cb)(f.Y)],Z.prototype,"defaultUnit",void 0),(0,s._)([(0,o.Cb)()],Z.prototype,"_userUnit",void 0),(0,s._)([(0,o.Cb)()],Z.prototype,"_userUnitOptions",void 0),Z=(0,s._)([(0,l.j)("esri.widgets.DirectLineMeasurement3D.DirectLineMeasurement3DViewModel")],Z);const Y=Z;var q=i(78088),$=i(80532),j=i(67005);i(80975);const X="esri-direct-line-measurement-3d",J={buttonDisabled:"esri-button--disabled",base:`${X} esri-widget esri-widget--panel`,container:`${X}__container`,hint:`${X}__hint`,hintText:`${X}__hint-text`,panelError:`${X}__panel--error`,measurement:`${X}__measurement`,measurementItem:`${X}__measurement-item`,measurementItemDisabled:`${X}__measurement-item--disabled`,measurementItemTitle:`${X}__measurement-item-title`,measurementItemValue:`${X}__measurement-item-value`,settings:`${X}__settings`,units:`${X}__units`,unitsLabel:`${X}__units-label`,unitsSelect:`${X}__units-select esri-select`,unitsSelectWrapper:`${X}__units-select-wrapper`,actionSection:`${X}__actions`,newMeasurementButton:`${X}__clear-button esri-button esri-button--primary`,widgetIcon:"esri-icon-measure-line"};let K=class extends c.Z{constructor(e,t){super(e,t),this.view=null,this.visible=null,this.iconClass=J.widgetIcon,this.label=void 0,this.messages=null,this.messagesUnits=null,this.viewModel=new Y,this.unitOptions=null,this.unit=null}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}render(){const{supported:e,active:t,state:i,measurement:s,unit:n}=this.viewModel,a="disabled"===i,o="ready"===i,l="measuring"===i||"measured"===i,{messages:c,messagesUnits:u}=this,h=t&&o?(0,j.u)("section",{key:"esri-direct-line-measurement-3d__hint",class:J.hint},(0,j.u)("p",{class:J.hintText},c.hint)):null,d=e?null:(0,j.u)("section",{key:"esri-direct-line-measurement-3d__unsupported",class:J.panelError},(0,j.u)("p",null,c.unsupported)),_=(e,t,i)=>{switch(t.state){case"available":return(0,j.u)("div",{key:`${i}-enabled`,class:J.measurementItem},(0,j.u)("span",{class:J.measurementItemTitle},e),(0,j.u)("span",{class:J.measurementItemValue},t.text));case"unavailable":return(0,j.u)("div",{key:`${i}-disabled`,class:this.classes(J.measurementItem,J.measurementItemDisabled)},(0,j.u)("span",{class:J.measurementItemTitle},e))}},p=l?(0,j.u)("section",{key:"esri-direct-line-measurement-3d__measurement",class:J.measurement},_(c.direct,s.directDistance,"direct"),_(c.horizontal,s.horizontalDistance,"horizontal"),_(c.vertical,s.verticalDistance,"vertical")):null,y=`${this.id}__units`,b=(0,j.u)("label",{class:J.unitsLabel,for:y},c.unit),v=(0,j.u)("div",{class:J.unitsSelectWrapper},(0,j.u)("select",{class:J.unitsSelect,id:y,onchange:this._changeUnit,bind:this,value:n},this.viewModel.unitOptions.map((e=>(0,j.u)("option",{key:e,value:e},(0,r.ZO)(e)?u.systems[e]:u.units[e]?.pluralCapitalized))))),g=(0,j.u)("section",{key:"esri-direct-line-measurement-3d__units",class:J.units},b,v),f=l?(0,j.u)("div",{key:"settings",class:J.settings},g):null,m=!e||t&&!l?null:(0,j.u)("div",{class:J.actionSection},(0,j.u)("button",{disabled:a,class:this.classes(J.newMeasurementButton,a&&J.buttonDisabled),bind:this,onclick:this._newMeasurement,type:"button"},c.newMeasurement)),w=this.visible?(0,j.u)("div",{class:J.container},d,h,f,p,m):null;return(0,j.u)("div",{key:this,class:J.base,role:"presentation"},w)}_newMeasurement(){(0,n.R8)(this.viewModel.start())}_changeUnit(e){const t=e.target,i=t.options[t.selectedIndex];i&&(this.unit=i.value)}};(0,s._)([(0,a.B)("viewModel.view")],K.prototype,"view",void 0),(0,s._)([(0,a.B)("viewModel.visible")],K.prototype,"visible",void 0),(0,s._)([(0,a.B)("viewModel.active")],K.prototype,"active",void 0),(0,s._)([(0,o.Cb)({constructOnly:!0,nonNullable:!0})],K.prototype,"analysis",null),(0,s._)([(0,o.Cb)()],K.prototype,"iconClass",void 0),(0,s._)([(0,o.Cb)({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],K.prototype,"label",void 0),(0,s._)([(0,o.Cb)(),(0,$.H)("esri/widgets/DirectLineMeasurement3D/t9n/DirectLineMeasurement3D")],K.prototype,"messages",void 0),(0,s._)([(0,o.Cb)(),(0,$.H)("esri/core/t9n/Units")],K.prototype,"messagesUnits",void 0),(0,s._)([(0,o.Cb)()],K.prototype,"uiStrings",void 0),(0,s._)([(0,o.Cb)({type:Y})],K.prototype,"viewModel",void 0),(0,s._)([(0,a.B)("viewModel.unitOptions")],K.prototype,"unitOptions",void 0),(0,s._)([(0,a.B)("viewModel.unit")],K.prototype,"unit",void 0),(0,s._)([(0,q.h)()],K.prototype,"_newMeasurement",null),(0,s._)([(0,q.h)()],K.prototype,"_changeUnit",null),K=(0,s._)([(0,l.j)("esri.widgets.DirectLineMeasurement3D")],K);const Q=K},40085:(e,t,i)=>{i.d(t,{O:()=>d});var s,n=i(27366),r=i(100),a=i(92026),o=i(66978),l=i(94172),c=i(49861),u=(i(63780),i(93169),i(25243),i(69912)),h=i(32845);!function(e){e[e.PENDING=0]="PENDING",e[e.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",e[e.RUNNING=2]="RUNNING"}(s||(s={}));let d=class extends h.V{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.analysisView=null,this._reconnectViewTask=null,this._analysisBaseHandles=new r.Z,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=e?.analysis;(0,a.pC)(t)?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0))}normalizeCtorArgs(e){const{analysis:t,...i}=e;return i}initialize(){this._analysisBaseHandles.add([(0,l.YP)((()=>(0,a.yw)(this.analysis,(e=>{let{parent:t}=e;return t}))),(e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()}),l.Z_),(0,l.YP)((()=>({view:this.view,ready:(0,a.pC)(this.view)&&this.view.ready,supported:this.supported})),((e,t)=>{let{view:i}=e,{view:s}=t;i!==s&&(this._startUserOperation=(0,a.IM)(this._startUserOperation),this._disconnectFromView(s)),this._scheduleViewReconnect()}),l.tX),(0,l.YP)((()=>this.analysis.isEditable),((e,t)=>{(0,a.Wi)(this.analysisView)||(e&&!t&&(0,a.Wi)(this.tool)?this.createTool():!e&&t&&(0,a.pC)(this.tool)&&!this.tool.active&&this.removeTool())}))])}destroy(){this._analysisBaseHandles=(0,a.SC)(this._analysisBaseHandles),this._reconnectViewTask=(0,a.IM)(this._reconnectViewTask),this._startUserOperation=(0,a.IM)(this._startUserOperation),(0,a.pC)(this.analysisView)&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),(0,a.pC)(this.analysis)&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,a.IM)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return(0,a.pC)(this.analysisView)&&!this.connectingToView}get connectingToView(){return(0,a.pC)(this._reconnectViewTask)}get isAnalysisOwner(){return this._get("isAnalysisOwner")}set visible(e){this._set("visible",e),(0,a.pC)(this.analysisView)&&(this.analysisView.visible=e)}async start(){this.clear();const e={task:null,abort:null,state:s.PENDING},t=(0,o.vr)((async t=>{e.state=s.WAIT_FOR_VIEW_READY,await(0,l.N1)((()=>this.ready),t),e.state=s.RUNNING,this.createTool({interactive:!0})}));return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}clear(){this._startUserOperation=(0,a.IM)(this._startUserOperation),this.removeTool(),this.analysis.clear()}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,a.IM)(this._reconnectViewTask);const e=(0,o.vr)((async t=>{try{await this._reconnectView(t)}catch(i){if((0,o.k_)(t),!(0,o.D_)(i))return void this.logger.warn("Failed to use analysis in view model",i);throw i}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=(0,a.pC)(t)&&t.ready&&this.supported,s=this.analysis;if(this._startUserOperation=_(this._startUserOperation),this._disconnectFromView(t),i&&!(0,a.Wi)(t)&&!(0,a.Wi)(s)){if(this.isAnalysisOwner){if((0,a.pC)(s.parent))return void this.logError("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(s)}this.analysisView=await t.whenAnalysisView(s),(0,o.Hc)(e)?this._startUserOperation=_(this._startUserOperation):(this.analysisView.visible=this.visible,this.onConnectToAnalysisView(this.analysisView),this.createTool())}}_disconnectFromView(e){this.removeTool(),(0,a.pC)(e)&&this.isAnalysisOwner&&(this._parentChangeFromReconnect=!0,e.analyses.remove(this.analysis),this.analysis.clear()),this.analysisView=null,this.onDisconnectFromAnalysisView()}_setExternalAnalysis(e){if((0,a.pC)(this.analysisView)&&!this.isAnalysisOwner&&(this.analysisView.visible=!0),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1,!e.isEditable){const t=e.nonEditableMessage;this.logger.warn(`The assigned ${e.type} analysis object will not be editable in the view. ${t}`)}}get testInfo(){return{analysisView:this.analysisView}}};function _(e){return(0,a.pC)(e)&&e.state>=s.RUNNING?(e.abort(),null):e}(0,n._)([(0,c.Cb)({nonNullable:!0})],d.prototype,"analysis",null),(0,n._)([(0,c.Cb)()],d.prototype,"analysisView",void 0),(0,n._)([(0,c.Cb)()],d.prototype,"ready",null),(0,n._)([(0,c.Cb)()],d.prototype,"connectingToView",null),(0,n._)([(0,c.Cb)({readOnly:!0})],d.prototype,"isAnalysisOwner",null),(0,n._)([(0,c.Cb)({type:Boolean,value:!0})],d.prototype,"visible",null),(0,n._)([(0,c.Cb)()],d.prototype,"_reconnectViewTask",void 0),d=(0,n._)([(0,u.j)("esri.widgets.support.InteractiveAnalysisViewModel")],d)},32845:(e,t,i)=>{i.d(t,{V:()=>h});var s=i(27366),n=i(85015),r=i(100),a=i(32718),o=i(92026),l=i(94172),c=i(49861),u=(i(63780),i(93169),i(25243),i(69912));let h=class extends n.Z{constructor(e){super(e),this.tool=null,this._baseHandles=new r.Z,this._loggedUnsupportedErrorOnce=!1,this.logger=a.Z.getLogger(this.declaredClass),e&&null!=e.visible&&(this.visible=e.visible)}initialize(){this._baseHandles.add((0,l.YP)((()=>({ready:(0,o.pC)(this.view)&&this.view.ready,supported:this.supported})),(e=>{let{ready:t,supported:i}=e;!t||i||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)}),l.tX))}destroy(){this.removeTool(),this.view=null,this._baseHandles=(0,o.SC)(this._baseHandles)}get supported(){return(0,o.Wi)(this.view)||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const t="tools";this._baseHandles.remove(t),(0,o.Wi)(e)||this._baseHandles.add(e.tools.on("after-remove",(e=>{e.item===this.tool&&this._set("tool",null)})),t)}set visible(e){this._set("visible",e),(0,o.pC)(this.tool)&&(this.tool.visible=e)}get active(){return(0,o.pC)(this.tool)&&this.tool.active}get disabled(){return(0,o.Wi)(this.view)||!this.view.ready||!this.supported}createTool(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{interactive:!1};if(this.removeTool(),(0,o.Wi)(this.view)||!this.view.ready||!this.supported)return;const t=this.constructTool();t.created?(this._set("tool",t),this.view.tools.add(t)):e.interactive?(this._set("tool",t),this.view.addAndActivateTool(t),(0,l.gx)((()=>t.created),(()=>{t.active&&(0,o.pC)(this.view)&&(this.view.activeTool=null)}),{initial:!0,once:!0})):t.destroy()}removeTool(){const e=this.tool;if((0,o.Wi)(e))return;const t=(0,o.yw)(this.view,(e=>e.tools));(0,o.pC)(t)?t.remove(e):e.destroy(),this._set("tool",null)}logError(){this.logger.error(...arguments)}};(0,s._)([(0,c.Cb)({constructOnly:!0})],h.prototype,"tool",void 0),(0,s._)([(0,c.Cb)()],h.prototype,"supported",null),(0,s._)([(0,c.Cb)({value:null})],h.prototype,"view",null),(0,s._)([(0,c.Cb)({type:Boolean,value:!0})],h.prototype,"visible",null),(0,s._)([(0,c.Cb)()],h.prototype,"active",null),(0,s._)([(0,c.Cb)()],h.prototype,"disabled",null),h=(0,s._)([(0,u.j)("esri.widgets.support.InteractiveToolViewModel")],h)}}]);
//# sourceMappingURL=7310.1919eee6.chunk.js.map