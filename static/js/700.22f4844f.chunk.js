"use strict";(globalThis.webpackChunkimaps=globalThis.webpackChunkimaps||[]).push([[700],{82218:(e,t,i)=>{i.d(t,{a:()=>y,c:()=>v,g:()=>C,h:()=>G,u:()=>S});i(93169);var n=i(32718),o=i(16889),r=i(21530),a=i(14226),s=i(81949),l=i(11186),c=i(71353),h=i(14320),p=i(85981),d=i(55652),u=i(40885),g=i(40927),_=i(11185);const m=n.Z.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");const f=class{constructor(){this.plane=(0,d.Ue)(),this.origin=(0,c.c)(),this.basis1=(0,c.c)(),this.basis2=(0,c.c)()}};function y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B;return{plane:(0,d.Ue)(e.plane),origin:(0,c.a)(e.origin),basis1:(0,c.a)(e.basis1),basis2:(0,c.a)(e.basis2)}}function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y();return b(e.origin,e.basis1,e.basis2,t)}function b(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y();return(0,l.c)(n.origin,e),(0,l.c)(n.basis1,t),(0,l.c)(n.basis2,i),S(n),I(n,"fromValues()"),n}function S(e){(0,d.my)(e.basis2,e.basis1,e.origin,e.plane)}function P(e,t,i){e!==i&&v(e,i);const n=(0,l.g)(_.WM.get(),x(e),t);return(0,l.a)(i.origin,i.origin,n),i.plane[3]-=t,i}function C(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y();const i=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return(0,l.s)(t.origin,e[0]+i,e[1]+n,0),(0,l.s)(t.basis1,i,0,0),(0,l.s)(t.basis2,0,n,0),(0,d.al)(0,0,1,0,t.plane),t}function T(e,t,i){return!!(0,d.BR)(e.plane,t,i)&&O(e,i)}function M(e,t,i){const n=U.get();D(e,t,n,U.get());let r=Number.POSITIVE_INFINITY;for(const a of H){const s=W(e,a,N.get()),c=_.WM.get();if((0,d.rx)(n,s,c)){const e=(0,l.r)(_.WM.get(),t.origin,c),n=Math.abs((0,o.ZF)((0,l.e)(t.direction,e)));n<r&&(r=n,(0,l.c)(i,c))}}return r===Number.POSITIVE_INFINITY?w(e,t,i):i}function w(e,t,i){if(T(e,t,i))return i;const n=U.get(),o=U.get();D(e,t,n,o);let r=Number.POSITIVE_INFINITY;for(const a of H){const s=W(e,a,N.get()),c=_.WM.get();if((0,d.dZ)(n,s,c)){const e=(0,u.Jk)(t,c);if(!(0,d.Ac)(o,c))continue;e<r&&(r=e,(0,l.c)(i,c))}}return k(e,t.origin)<r&&R(e,t.origin,i),i}function R(e,t,i){const n=(0,d.nF)(e.plane,t,_.WM.get()),o=(0,p.ct)(L(e,e.basis1),n,-1,1,_.WM.get()),r=(0,p.ct)(L(e,e.basis2),n,-1,1,_.WM.get());return(0,l.b)(i,(0,l.a)(_.WM.get(),o,r),e.origin),i}function E(e,t,i){const{origin:n,basis1:o,basis2:r}=e,a=(0,l.b)(_.WM.get(),t,n),s=(0,g.SR)(o,a),c=(0,g.SR)(r,a),h=(0,g.SR)(x(e),a);return(0,l.s)(i,s,c,h)}function k(e,t){const i=E(e,t,_.WM.get()),{basis1:n,basis2:o}=e,r=(0,l.l)(n),a=(0,l.l)(o),s=Math.max(Math.abs(i[0])-r,0),c=Math.max(Math.abs(i[1])-a,0),h=i[2];return s*s+c*c+h*h}function G(e,t){return Math.sqrt(k(e,t))}function A(e,t){const i=-e.plane[3];return(0,g.SR)(x(e),t)-i}function x(e){return(0,d.mJ)(e.plane)}function O(e,t){const i=(0,l.b)(_.WM.get(),t,e.origin),n=(0,l.p)(e.basis1),o=(0,l.p)(e.basis2),r=(0,l.e)(e.basis1,i),a=(0,l.e)(e.basis2,i);return-r-n<0&&r-n<0&&-a-o<0&&a-o<0}function L(e,t){const i=N.get();return(0,l.c)(i.origin,e.origin),(0,l.c)(i.vector,t),i}function W(e,t,i){const{basis1:n,basis2:o,origin:r}=e,a=(0,l.g)(_.WM.get(),n,t.origin[0]),s=(0,l.g)(_.WM.get(),o,t.origin[1]);(0,l.a)(i.origin,a,s),(0,l.a)(i.origin,i.origin,r);const c=(0,l.g)(_.WM.get(),n,t.direction[0]),h=(0,l.g)(_.WM.get(),o,t.direction[1]);return(0,l.g)(i.vector,(0,l.a)(c,c,h),2),i}function I(e,t){Math.abs((0,l.e)(e.basis1,e.basis2)/((0,l.l)(e.basis1)*(0,l.l)(e.basis2)))>1e-6&&m.warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,l.e)(e.basis1,x(e)))>1e-6&&m.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,l.e)(x(e),e.origin)-e.plane[3])>1e-6&&m.warn(t,"Plane offset is not consistent with plane origin")}function D(e,t,i,n){const o=x(e);(0,d.my)(o,t.direction,t.origin,i),(0,d.my)((0,d.mJ)(i),o,t.origin,n)}const B={plane:(0,d.Ue)(),origin:(0,c.f)(0,0,0),basis1:(0,c.f)(1,0,0),basis2:(0,c.f)(0,1,0)},U=new r.x(d.Ue),N=new r.x(p.Ue),Z=(0,c.c)(),V=new r.x((()=>y())),H=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],F=(0,s.c)(),z=(0,s.c)();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:f,UP:B,altitudeAt:A,axisAt:function(e,t,i,n){return function(e,t,i){switch(t){case h.R.X:(0,l.c)(i,e.basis1),(0,l.n)(i,i);break;case h.R.Y:(0,l.c)(i,e.basis2),(0,l.n)(i,i);break;case h.R.Z:(0,l.c)(i,x(e))}return i}(e,i,n)},closestPoint:w,closestPointOnSilhouette:M,copy:v,copyWithoutVerify:function(e,t){(0,l.c)(t.origin,e.origin),(0,l.c)(t.basis1,e.basis1),(0,l.c)(t.basis2,e.basis2),(0,d.JG)(t.plane,e.plane)},create:y,distance:G,distance2:k,distanceToSilhouette:function(e,t){let i=Number.NEGATIVE_INFINITY;for(const n of H){const o=W(e,n,N.get()),r=(0,p.Jk)(o,t);r>i&&(i=r)}return Math.sqrt(i)},elevate:P,equals:function(e,t){return(0,l.k)(e.basis1,t.basis1)&&(0,l.k)(e.basis2,t.basis2)&&(0,l.k)(e.origin,t.origin)},extrusionContainsPoint:function(e,t){return(0,d.Ac)(e.plane,t)&&O(e,t)},fromAABoundingRect:C,fromValues:b,intersectRay:T,intersectRayClosestSilhouette:function(e,t,i){if(T(e,t,i))return i;const n=M(e,t,_.WM.get());return(0,l.a)(i,t.origin,(0,l.g)(_.WM.get(),t.direction,(0,l.i)(t.origin,n)/(0,l.l)(t.direction))),i},normal:x,projectPoint:R,projectPointLocal:E,rotate:function(e,t,i,n){return e!==n&&v(e,n),(0,a.d)(z,t,i),(0,l.m)(n.basis1,e.basis1,z),(0,l.m)(n.basis2,e.basis2,z),S(n),n},setAltitudeAt:function(e,t,i,n){const o=A(e,t),r=(0,l.g)(Z,x(e),i-o);return(0,l.a)(n,t,r),n},setExtent:function(e,t,i){return C(t,i),P(i,A(e,e.origin),i),i},transform:function(e,t,i){return e!==i&&v(e,i),(0,a.a)(F,t),(0,a.t)(F,F),(0,l.m)(i.basis1,e.basis1,F),(0,l.m)(i.basis2,e.basis2,F),(0,l.m)((0,d.mJ)(i.plane),(0,d.mJ)(e.plane),F),(0,l.m)(i.origin,e.origin,t),(0,d.T5)(i.plane,i.plane,i.origin),i},updateUnboundedPlane:S,wrap:function(e,t,i){const n=V.get();return n.origin=e,n.basis1=t,n.basis2=i,n.plane=(0,d.re)(0,0,0,0),S(n),n}},Symbol.toStringTag,{value:"Module"}))},70148:(e,t,i)=>{i.d(t,{RN:()=>c,e9:()=>l,hU:()=>p,uu:()=>h});var n=i(51995),o=i(42265),r=i(28357);function a(e,t){const i=e.a*t;return(0,r.EX)(e)>225?new n.Z([0,0,0,i]):new n.Z([255,255,255,i])}function s(e,t){const i=new n.Z(e);return i.a*=t,i}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return s(o.Z.analysisTheme.accentColor,e)}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a(l(),e)}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return s(o.Z.analysisTheme.textColor,e)}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a(h(),e)}},85981:(e,t,i)=>{i.d(t,{AR:()=>f,Gr:()=>m,JG:()=>c,Jk:()=>d,KU:()=>g,Ue:()=>l,al:()=>h,ct:()=>_,nF:()=>u,zk:()=>p});var n=i(16889),o=i(21530),r=i(11186),a=i(71353),s=i(11185);function l(e){return e?{origin:(0,a.a)(e.origin),vector:(0,a.a)(e.vector)}:{origin:(0,a.c)(),vector:(0,a.c)()}}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l();return h(e.origin,e.vector,t)}function h(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,r.c)(i.origin,e),(0,r.c)(i.vector,t),i}function p(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l();return(0,r.c)(i.origin,e),(0,r.b)(i.vector,t,e),i}function d(e,t){const i=(0,r.b)(s.WM.get(),t,e.origin),o=(0,r.e)(e.vector,i),a=(0,r.e)(e.vector,e.vector),l=(0,n.uZ)(o/a,0,1),c=(0,r.b)(s.WM.get(),(0,r.g)(s.WM.get(),e.vector,l),i);return(0,r.e)(c,c)}function u(e,t,i){return _(e,t,0,1,i)}function g(e,t,i){return(0,r.a)(i,e.origin,(0,r.g)(i,e.vector,t))}function _(e,t,i,o,a){const{vector:l,origin:c}=e,h=(0,r.b)(s.WM.get(),t,c),p=(0,r.e)(l,h)/(0,r.p)(l);return(0,r.g)(a,l,(0,n.uZ)(p,i,o)),(0,r.a)(a,a,e.origin)}function m(e,t){if(y(e,function(e,t){const i=b.get();return i.origin=e,i.vector=t,i}(t.origin,t.direction),!1,v)){const{tA:t,pB:i,distance2:n}=v;if(t>=0&&t<=1)return n;if(t<0)return(0,r.d)(e.origin,i);if(t>1)return(0,r.d)((0,r.a)(s.WM.get(),e.origin,e.vector),i)}return null}function f(e,t,i){return!!y(e,t,!0,v)&&((0,r.c)(i,v.pA),!0)}function y(e,t,i,o){const a=1e-6,l=e.origin,c=(0,r.a)(s.WM.get(),l,e.vector),h=t.origin,p=(0,r.a)(s.WM.get(),h,t.vector),d=s.WM.get(),u=s.WM.get();if(d[0]=l[0]-h[0],d[1]=l[1]-h[1],d[2]=l[2]-h[2],u[0]=p[0]-h[0],u[1]=p[1]-h[1],u[2]=p[2]-h[2],Math.abs(u[0])<a&&Math.abs(u[1])<a&&Math.abs(u[2])<a)return!1;const g=s.WM.get();if(g[0]=c[0]-l[0],g[1]=c[1]-l[1],g[2]=c[2]-l[2],Math.abs(g[0])<a&&Math.abs(g[1])<a&&Math.abs(g[2])<a)return!1;const _=d[0]*u[0]+d[1]*u[1]+d[2]*u[2],m=u[0]*g[0]+u[1]*g[1]+u[2]*g[2],f=d[0]*g[0]+d[1]*g[1]+d[2]*g[2],y=u[0]*u[0]+u[1]*u[1]+u[2]*u[2],v=(g[0]*g[0]+g[1]*g[1]+g[2]*g[2])*y-m*m;if(Math.abs(v)<a)return!1;let b=(_*m-f*y)/v,S=(_+m*b)/y;i&&(b=(0,n.uZ)(b,0,1),S=(0,n.uZ)(S,0,1));const P=s.WM.get(),C=s.WM.get();return P[0]=l[0]+b*g[0],P[1]=l[1]+b*g[1],P[2]=l[2]+b*g[2],C[0]=h[0]+S*u[0],C[1]=h[1]+S*u[1],C[2]=h[2]+S*u[2],o.tA=b,o.tB=S,o.pA=P,o.pB=C,o.distance2=(0,r.d)(P,C),!0}const v={tA:0,tB:0,pA:(0,a.c)(),pB:(0,a.c)(),distance2:0},b=new o.x((()=>l()))},74702:(e,t,i)=>{i.d(t,{bE:()=>c,wu:()=>l});var n=i(21530),o=i(11186),r=i(71353),a=i(85981);i(11185);function s(e){return e?{p0:(0,r.a)(e.p0),p1:(0,r.a)(e.p1),p2:(0,r.a)(e.p2)}:{p0:(0,r.c)(),p1:(0,r.c)(),p2:(0,r.c)()}}function l(e,t,i){const n=t[0]-e[0],o=t[1]-e[1],r=i[0]-e[0],a=i[1]-e[1];return.5*Math.abs(n*a-o*r)}function c(e,t,i){return(0,o.b)(h,t,e),(0,o.b)(p,i,e),(0,o.l)((0,o.f)(h,h,p))/2}new n.x(a.Ue),new n.x((()=>s()));const h=(0,r.c)(),p=(0,r.c)()},48202:(e,t,i)=>{var n,o,r,a,s,l,c,h,p,d,u,g,_,m,f,y,v,b,S,P,C,T,M,w,R,E,k,G,A,x,O,L,W,I,D,B,U,N,Z,V,H,F,z,Y,j,J,X,q,Q,K,$,ee,te,ie,ne,oe,re,ae,se,le,ce;i.d(t,{$y:()=>T,AH:()=>o,CS:()=>X,DD:()=>h,Dd:()=>A,Em:()=>C,JS:()=>j,Ky:()=>p,Lh:()=>q,Qb:()=>re,RL:()=>n,RS:()=>se,TF:()=>P,Tx:()=>s,UR:()=>v,UX:()=>oe,bj:()=>J,eZ:()=>c,id:()=>R,kP:()=>B,of:()=>u,r4:()=>V,sj:()=>U,v2:()=>r,zQ:()=>G,zV:()=>y}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(n||(n={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(o||(o={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(r||(r={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(a||(a={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(s||(s={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(c||(c={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(h||(h={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(p||(p={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(d||(d={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(u||(u={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(g||(g={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(_||(_={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(m||(m={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(f||(f={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(y||(y={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(v||(v={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(b||(b={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(S||(S={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(P||(P={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(C||(C={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(T||(T={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(M||(M={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(w||(w={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(R||(R={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(E||(E={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(k||(k={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(G||(G={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(A||(A={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(x||(x={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(O||(O={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(L||(L={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(W||(W={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(I||(I={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(D||(D={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(B||(B={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(U||(U={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(N||(N={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(Z||(Z={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(V||(V={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(H||(H={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(F||(F={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(z||(z={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(Y||(Y={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(j||(j={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(J||(J={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(X||(X={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(q||(q={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(Q||(Q={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(K||(K={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}($||($={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(ee||(ee={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(te||(te={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(ie||(ie={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(ne||(ne={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(oe||(oe={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(re||(re={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(ae||(ae={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(se||(se={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(le||(le={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(ce||(ce={}))},85577:(e,t,i)=>{i.d(t,{r:()=>y});i(59486);var n=i(52639),o=(i(51508),i(42537)),r=i(17842),a=i(88396),s=i(6394),l=i(71353),c=i(48202),h=i(70040),p=i(76014),d=i(38561),u=i(16072),g=i(16851),_=i(75021),m=i(585),f=i(29909);class y extends d.a{constructor(e){super(),this._graphicsLayer=e}visualizeIntersectionPoint(e,t){return this._visualizeSnappingIndicator(new m.Z({x:e.intersectionPoint[0],y:e.intersectionPoint[1],spatialReference:t.spatialReference}),S)}visualizePoint(e,t){return this._visualizeSnappingIndicator(new m.Z({x:e.point[0],y:e.point[1],spatialReference:t.spatialReference}),P)}visualizeLine(e,t){return this._visualizeSnappingIndicator(new f.Z({paths:[[e.lineStart,e.lineEnd]],spatialReference:t.spatialReference}),C)}visualizeParallelSign(e,t){return this._visualizeSnappingIndicator(new f.Z({paths:[[e.lineStart,e.lineEnd]],spatialReference:t.spatialReference}),T)}visualizeRightAngleQuad(e,t){return this._visualizeSnappingIndicator(new f.Z({paths:[[e.previousVertex,e.centerVertex,e.nextVertex]],spatialReference:t.spatialReference}),E(e))}_visualizeSnappingIndicator(e,t){const i=new n.Z({geometry:e,symbol:t});return this._graphicsLayer.add(i),(0,o.kB)((()=>{this._graphicsLayer.remove(i)}))}}const v=h.O.main.toArray(),b=[...h.O.main.toRgb(),100],S=new u.Z({outline:new g.Z({width:1.5,color:v}),size:15,color:[0,0,0,0]}),P=new u.Z({outline:{width:.5,color:[0,0,0,1]},size:10,color:v}),C=new _.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:c.kP.Butt,joinStyle:c.r4.Round,miterLimit:10,width:(0,r.Wz)(p.c.lineHintWidthTarget),color:v}]}}}),T=new _.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:v}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:v}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),M=e=>new _.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:(0,r.Wz)(p.c.rightAngleHintSize),rotation:e,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:(0,r.Wz)(p.c.rightAngleHintOutlineSize),color:v},{type:"CIMSolidFill",enable:!0,color:b}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),w=M(45),R=M(225),E=(()=>{const e=(0,s.a)(),t=(0,s.a)(),i=(0,l.c)();return n=>((0,a.a)(e,n.centerVertex,n.previousVertex),(0,a.a)(t,n.nextVertex,n.previousVertex),(0,a.g)(i,e,t),i[2]<0?w:R)})()},10461:(e,t,i)=>{i.r(t),i.d(t,{ControlPointsTransformTool:()=>J,DrawGraphicTool2D:()=>b,MediaTransformToolsWrapper:()=>xe,TransformTool:()=>Ee});var n=i(27366),o=(i(59486),i(52639)),r=i(42537),a=i(92026),s=i(49861),l=(i(25243),i(63780),i(69912)),c=i(85577),h=(i(51508),i(75021)),p=i(16072);const d=new h.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}}),u=new p.Z({style:"circle",size:6,color:[127,127,127,1],outline:{color:[50,50,50],width:1}}),g=new p.Z({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});var _=i(15820),m=i(66038),f=i(46640),y=i(585),v=i(77577);let b=class extends _.T{constructor(e){super(e),this._visualElementGraphics={outline:null,regularVertices:null,activeVertex:null},this.activeFillSymbol=null,this.type="draw-2d",this._visualElementSymbols={outline:(0,a.Pt)(e.activeLineSymbol,d),regularVertices:(0,a.Pt)(e.regularVerticesSymbol,u),activeVertex:(0,a.Pt)(e.activeVertexSymbol,g),fill:(0,a.Wg)(e.activeFillSymbol)}}normalizeCtorArgs(e){const t={...e};return delete t.activeFillSymbol,delete t.activeVertexSymbol,delete t.regularVerticesSymbol,delete t.activeLineSymbol,t}initializeGraphic(e){return(0,a.pC)(this._visualElementSymbols.fill)&&(e.symbol=this._visualElementSymbols.fill),null}makeDrawOperation(){const{defaultZ:e,hasZ:t,view:i}=this;return new m.w({view:i,manipulators:this.manipulators,geometryType:(0,_.I)(this.geometryType),drawingMode:this.mode,hasZ:t,defaultZ:e,snapToSceneEnabled:this.snapToScene,drawSurface:new f.hP(i,t,e),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new c.r(this.internalGraphicsLayer),tooltipOptions:this.tooltipOptions})}onActiveVertexChanged(e){if("point"===this.geometryType)return null;const[t,i]=e,n=new y.Z({x:t,y:i,spatialReference:this.view.spatialReference});return(0,a.pC)(this._visualElementGraphics.activeVertex)?(this._visualElementGraphics.activeVertex.geometry=n,null):(this._visualElementGraphics.activeVertex=new o.Z({geometry:n,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(S),(0,r.kB)((()=>{(0,a.pC)(this._visualElementGraphics.activeVertex)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.activeVertex),this._visualElementGraphics.activeVertex=(0,a.SC)(this._visualElementGraphics.activeVertex))})))}onOutlineChanged(e){const t=e.clone();if("polyline"===t.type){const e=t.paths[t.paths.length-1];e.splice(0,e.length-2)}return(0,a.pC)(this._visualElementGraphics.outline)?(this._visualElementGraphics.outline.geometry=t,null):(this._visualElementGraphics.outline=new o.Z({geometry:t,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.outline),this.internalGraphicsLayer.graphics.sort(S),(0,r.kB)((()=>{(0,a.pC)(this._visualElementGraphics.outline)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.outline),this._visualElementGraphics.outline=(0,a.SC)(this._visualElementGraphics.outline))})))}onRegularVerticesChanged(e){const t=new v.Z({points:e,spatialReference:this.view.spatialReference});return(0,a.pC)(this._visualElementGraphics.regularVertices)?(this._visualElementGraphics.regularVertices.geometry=t,null):(this._visualElementGraphics.regularVertices=new o.Z({geometry:t,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(S),(0,r.kB)((()=>{(0,a.pC)(this._visualElementGraphics.regularVertices)&&(this.internalGraphicsLayer.remove(this._visualElementGraphics.regularVertices),this._visualElementGraphics.regularVertices=(0,a.SC)(this._visualElementGraphics.regularVertices))})))}};function S(e,t){return(e.attributes?.displayOrder??-1/0)-(t.attributes?.displayOrder??-1/0)}(0,n._)([(0,s.Cb)()],b.prototype,"activeFillSymbol",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],b.prototype,"type",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0,nonNullable:!0})],b.prototype,"view",void 0),b=(0,n._)([(0,l.j)("esri.views.2d.interactive.draw.DrawGraphicTool2D")],b);var P,C=i(51995),T=i(70148),M=i(94172),w=i(79803),R=i(92975),E=i(93655),k=i(49729),G=i(50951);class A{get hovering(){return this.someManipulator((e=>e.hovering))}get grabbing(){return this.someManipulator((e=>e.grabbing))}get dragging(){return this.someManipulator((e=>e.dragging))}hasManipulator(e){return this.someManipulator((t=>t===e))}someManipulator(e){let t=!1;return this.forEachManipulator((i=>{!t&&e(i)&&(t=!0)})),t}}!function(e){e[e.TRANSLATE_XY=0]="TRANSLATE_XY",e[e.SCALE=1]="SCALE",e[e.ROTATE=2]="ROTATE"}(P||(P={}));var x=i(74229),O=i(2346),L=i(153),W=i(90297);class I extends A{constructor(e){super(),this._view=e.view,this._tool=e.tool,this._graphic=e.graphic,this._manipulator=this._createManipulator(),this.forEachManipulator((e=>this._tool.manipulators.add(e)))}destroy(){this.forEachManipulator((e=>{this._tool.manipulators.remove(e),e.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphic=null}forEachManipulator(e){e(this._manipulator,P.TRANSLATE_XY)}createDragPipeline(e,t){let i=null,n=null,o=0,r=0,s=0;const{offsetX:l,offsetY:c,size:h}=(0,W.i)((0,a.Wg)(this._graphic.symbol));return(0,x.Xd)(this._manipulator,((a,p)=>{p.next((t=>{if("start"===t.action){const t=e();i=t.editGeometryOperations,n=t.constraints}return t})).next((0,x.Cf)(this._view)).next((e=>{const{x:a,y:p,z:d}=e.mapEnd;if(n&&(a+l<n.xmin||p+c-h<n.ymin||a+l>n.xmax||p+c-h>n.ymax))return e;"start"===e.action&&(o=e.mapStart.x,r=e.mapStart.y,s=e.mapStart.z);const u=a-o,g=p-r,_=d-s;o=a,r=p,s=d;const m=[];for(const t of i.data.components)m.push(...t.vertices);const f="start"===e.action?L.O.NEW_STEP:L.O.ACCUMULATE_STEPS,y=i.moveVertices(m,u,g,_,f);return t(e,y),e}))}))}_createManipulator(){const e=this._view,t=this._graphic;return new O.L({view:e,graphic:t,selectable:!0,cursor:"move"})}}var D=i(67750),B=i(45900),U=i(87268);const N="ArrowUp",Z="ArrowDown",V="ArrowLeft",H="ArrowRight",F="t",z="Shift",Y=D.CK,j=new C.Z("#009AF2");let J=class extends B.m{constructor(e){super(e),this._isOpacityToggled=!1,this._isModifierActive=!1,this._factor=1,this._initialControlPoints=null,this._graphicsLayer=new E.Z({internal:!0,listMode:"hide",visible:!1,effect:"drop-shadow(0px, 0px, 3px)"}),this._undoStack=[],this._redoStack=[],this._sharedUndoStack=[],this._sharedRedoStack=[],this._highlightHandle=null,this.activeHandle=0}initialize(){this._initialize()}destroy(){const{map:e}=this.view;this._controlPointManipulations.forEach((e=>e.destroy())),this._controlPointEditGeometryOperations.forEach((e=>e.destroy())),e.removeMany([this._graphicsLayer]),this._graphicsLayer.removeAll(),this._graphicsLayer=(0,a.SC)(this._graphicsLayer),this._georeference=null,this._controlPointGraphics=null,this._controlPointManipulations=null,this._graphicsLayer=null,this._controlPointEditGeometryOperations=null,this._undoStack=null,this._redoStack=null,this._initialControlPoints=null,this._sharedUndoStack=null,this._sharedRedoStack=null}get _hasValidSpatialReference(){return(0,R.JY)(this.view.spatialReference)}onActivate(){this.visible=!0}onDeactivate(){this.visible=!1}onShow(){this._graphicsLayer.visible=!0}onHide(){this._graphicsLayer.visible=!1}canUndo(){const e=this._undoStack[this._undoStack.length-1];return null!=e&&this._controlPointEditGeometryOperations[e].canUndo}canRedo(){const e=this._redoStack[this._redoStack.length-1];return null!=e&&this._controlPointEditGeometryOperations[e].canRedo}undo(){if(this._undoStack.length>0){const e=this._undoStack.pop();this._controlPointEditGeometryOperations[e].undo(),this.updateGraphics(),this._redoStack.push(e)}}redo(){if(this._redoStack.length>0){const e=this._redoStack.pop();this._controlPointEditGeometryOperations[e].redo(),this.updateGraphics(),this._undoStack.push(e)}}refresh(){const{mediaElement:e}=this;if((0,a.Wi)(e.georeference))return;const t=e.georeference;"control-points"!==t.type||(0,a.Wi)(t.coords)||(this._georeference=t,(0,a.Wg)(this._georeference.controlPoints).forEach(((e,t)=>{let{mapPoint:i}=e;const n=this._controlPointEditGeometryOperations[t],o=n.data.components[0].vertices[0];n.setVertexPosition(o,n.data.coordinateHelper.pointToVector(i))})),this.updateGraphics())}reset(){this._georeference.controlPoints=this._initialControlPoints,this.refresh(),this._sharedUndoStack.length=0,this._sharedRedoStack.length=0}updateGraphics(){const e=this._georeference,t=(0,a.Wg)(e.controlPoints),i=(0,a.Wg)(t[0].mapPoint).spatialReference,n=this._hasValidSpatialReference;this._georeference.controlPoints=this._controlPointEditGeometryOperations.map(((o,r)=>{const s=o.data.geometry;return this._controlPointGraphics[r].geometry=s,{mapPoint:(0,w.iV)(s,i),sourcePoint:n?(0,a.Wg)(t[r]).sourcePoint:e.toSource(s)}}))}updateActiveHandle(e){if(this.activeHandle===e)return;const t=(0,a.Wg)(this._controlPointGraphics[this.activeHandle].symbol).clone();(0,k.ZB)(t,(0,T.e9)()),this._controlPointGraphics[this.activeHandle].symbol=t;const i=(0,a.Wg)(this._controlPointGraphics[e].symbol).clone();(0,k.ZB)(i,j),this._controlPointGraphics[e].symbol=i,this.activeHandle=e,this.view.surface===document.activeElement&&this.highlightActiveHandle()}async highlightActiveHandle(){this.removeHighlightActiveHandle();const e=await this.view.whenLayerView(this._graphicsLayer);this._highlightHandle=e.highlight(this._controlPointGraphics[this.activeHandle])}removeHighlightActiveHandle(){this._highlightHandle&&this._highlightHandle.remove()}setSharedUndoStack(e){this._sharedUndoStack=e}setSharedRedoStack(e){this._sharedRedoStack=e}async _initialize(){const{view:e,mediaElement:t}=this;if((0,a.Wi)(t.georeference))return;const i=t.georeference;"control-points"!==i.type||(0,a.Wi)(i.coords)||(this._georeference=i,this._initialControlPoints=(0,a.Wg)(this._georeference.controlPoints),e.map.addMany([this._graphicsLayer]),e.focus(),this.visible=!1,this.finishToolCreation(),await this._loadProjectionEngine(),this._controlPointEditGeometryOperations=(0,a.Wg)(this._georeference.controlPoints).map((t=>{let{mapPoint:i}=t;return U.c.fromGeometry((0,w.iV)(i,e.spatialReference),G.JY.Local)})),this._controlPointGraphics=this._controlPointEditGeometryOperations.map(((e,t)=>new o.Z({symbol:new h.Z({data:{type:"CIMSymbolReference",symbol:{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,colorLocked:!0,anchorPoint:{x:0,y:-15.75},anchorPointUnits:"Absolute",dominantSizeAxis3D:"Y",size:9,billboardMode3D:"FaceNearPlane",frame:{xmin:0,ymin:0,xmax:84.3,ymax:84.3},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[83.2,32.5],[84.3,40.7],[83.8,48.9],[81.7,56.9],[78.1,64.3],[73,70.9],[66.9,76.4],[59.7,80.5],[51.9,83.2],[43.7,84.3],[35.4,83.8],[27.4,81.7],[20,78],[13.4,73],[7.9,66.8],[3.8,59.7],[1.1,51.9],[0,43.7],[.5,35.4],[2.6,27.4],[6.3,20],[11.3,13.4],[17.5,7.9],[24.7,3.8],[32.5,1.1],[39.8,.1],[47.1,.3],[54.3,1.8],[61.1,4.5],[67.4,8.4],[72.9,13.3],[77.4,19.1],[80.9,25.5],[83.2,32.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:[255,255,255,255]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,clippingPath:{type:"CIMClippingPath",clippingType:"Intersect",path:{rings:[[[0,0],[84.3,0],[84.3,84.3],[0,84.3],[0,0]]]}},rotation:0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-11.25},anchorPointUnits:"Absolute",dominantSizeAxis3D:"Y",size:22.5,billboardMode3D:"FaceNearPlane",frame:{xmin:0,ymin:0,xmax:197.7,ymax:294.7},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[98.9,0],[119.4,23.2],[139.4,49.3],[156.8,75.2],[171.2,100.8],[182.4,125.3],[190.6,148.8],[195.7,171.4],[197.7,192.9],[197.7,195.8],[197.7,200.3],[197.6,202.5],[197.5,204.8],[197.3,207.1],[197,209.4],[196.7,211.7],[196.4,214.1],[196,216.4],[195.5,218.7],[195,221.1],[194.4,223.4],[193.7,225.8],[193,228.1],[192.2,230.5],[191.4,232.8],[190.5,235.1],[189.5,237.5],[188.5,239.7],[187.4,242],[186.2,244.3],[185,246.5],[183.7,248.7],[182.4,250.9],[181,253.1],[179.5,255.2],[178,257.3],[176.4,259.4],[174.7,261.4],[173.1,263.3],[171.3,265.3],[169.5,267.2],[167.7,269],[165.8,270.8],[163.9,272.5],[161.9,274.2],[159.9,275.8],[157.8,277.4],[155.7,278.9],[153.6,280.4],[151.4,281.7],[149.2,283.1],[147,284.4],[144.8,285.6],[142.5,286.7],[140.3,287.8],[138,288.8],[135.7,289.8],[133.4,290.7],[131,291.5],[128.7,292.3],[126.4,293],[124,293.6],[121.7,294.2],[119.4,294.7],[117,295.2],[114.7,295.6],[112.4,296],[110.1,296.3],[107.8,296.5],[105.5,296.7],[103.3,296.8],[101.1,296.9],[98.8,296.9],[83.1,295.7],[67.8,292],[53.3,285.9],[39.9,277.5],[28.1,267.2],[18,255.1],[10,241.5],[4.2,226.9],[.9,211.5],[0,195.8],[.1,192.9],[2.1,171.4],[7.2,148.8],[15.4,125.3],[26.6,100.8],[41,75.2],[58.4,49.3],[78.4,23.2],[98.9,0]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:t===this.activeHandle?j.toArray():(0,T.e9)().toArray()}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,clippingPath:{type:"CIMClippingPath",clippingType:"Intersect",path:{rings:[[[0,0],[197.7,0],[197.7,294.7],[0,294.7],[0,0]]]}},rotation:0}],haloSize:1,scaleX:1,angleAlignment:"Display",angle:0}}}),geometry:e.data.geometry}))),this._graphicsLayer.graphics.addMany([...this._controlPointGraphics]),this._controlPointManipulations=this._controlPointGraphics.map((t=>new I({tool:this,view:e,graphic:t}))),this.addHandles([...this._controlPointManipulations.map(((e,t)=>e.createDragPipeline(this._getInfo.bind(this,t),((e,i)=>{"start"===e.action&&(this._undoStack.push(t),this._redoStack=[],this._sharedUndoStack.push({tool:this,operation:i}),this._sharedRedoStack.length=0),this.updateGraphics()})))),(0,M.YP)((()=>this.view.scale),(()=>this.active?this.updateGraphics():null))]),this._controlPointManipulations.forEach(((e,t)=>{e.forEachManipulator((e=>{this.addHandles([e.events.on(["click","grab-changed"],(e=>this.updateActiveHandle(t)))])}))})),this.addHandles([e.on("key-down",(i=>{e.activeTool===this&&(i.key!==z||i.repeat||(this._isModifierActive=!0,i.stopPropagation()),i.key!==F||i.repeat||(t.opacity*=this._isOpacityToggled?2:.5,this._isOpacityToggled=!this._isOpacityToggled,i.stopPropagation()),i.key!==Y||i.repeat||(this._factor=10,i.stopPropagation()),this._isModifierActive&&(i.key===N&&(this._move(0,this._factor),i.stopPropagation()),i.key===Z&&(this._move(0,-this._factor),i.stopPropagation()),i.key===V&&(this._move(-this._factor,0),i.stopPropagation()),i.key===H&&(this._move(this._factor,0),i.stopPropagation())))})),e.on("key-up",(t=>{e.activeTool===this&&(t.key===z&&(this._isModifierActive=!1,t.stopPropagation()),t.key===Y&&(this._factor=1,t.stopPropagation()))}))]))}async _loadProjectionEngine(){const e=(0,a.Wg)((0,a.Wg)(this._georeference.controlPoints)[0].mapPoint);return(0,w.iQ)(e.spatialReference,this.view.spatialReference)}_getInfo(e){return{editGeometryOperations:this._controlPointEditGeometryOperations[e],constraints:this._hasValidSpatialReference?null:{xmin:0,ymin:0,xmax:this._georeference.width,ymax:this._georeference.height}}}_move(e,t){const i=this._controlPointEditGeometryOperations[this.activeHandle],n=[];for(const r of i.data.components)n.push(...r.vertices);const o=i.moveVertices(n,e*this.view.resolution,t*this.view.resolution,0,L.O.NEW_STEP);this._sharedUndoStack.push({tool:this,operation:o}),this._sharedRedoStack.length=0,this.updateGraphics()}};(0,n._)([(0,s.Cb)()],J.prototype,"_hasValidSpatialReference",null),(0,n._)([(0,s.Cb)()],J.prototype,"activeHandle",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0,nonNullable:!0})],J.prototype,"mediaElement",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0})],J.prototype,"view",void 0),J=(0,n._)([(0,l.j)("esri.views.2d.interactive.editingTools.ControlPointsTransformTool")],J);var X=i(68860),q=i(88396),Q=i(6394),K=i(11186),$=i(71353),ee=i(82218),te=i(100),ie=i(16889);function ne(e,t){"start"===e.action?t.cursor="grabbing":t.cursor="grab"}class oe{constructor(){this._lastDragEvent=null,this.next=new x.hM,this._enabled=!1}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&(0,a.pC)(this._lastDragEvent)){const t={...this._lastDragEvent,action:"update"};e&&this._adjustScaleFactors(t),this.next.execute(t)}this._enabled=e}createDragEventPipelineStep(){return this._lastDragEvent=null,e=>(this._lastDragEvent="end"!==e.action?{...e}:null,this._enabled&&this._adjustScaleFactors(e),e)}_adjustScaleFactors(e){const t=0!==e.direction[0]&&0!==e.direction[1]?Math.max(Math.abs(e.factor1),Math.abs(e.factor2)):0===e.direction[0]?Math.abs(e.factor2):Math.abs(e.factor1);e.factor1=e.factor1<0?-t:t,e.factor2=e.factor2<0?-t:t}}class re{constructor(){this._lastDragEvent=null,this.next=new x.hM,this._enabled=!1}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&(0,a.pC)(this._lastDragEvent)){const t={...this._lastDragEvent,action:"update"};e&&this._adjustRotateAngle(t),this.next.execute(t)}this._enabled=e}createDragEventPipelineStep(){return this._lastDragEvent=null,e=>(this._lastDragEvent="end"!==e.action?{...e}:null,this._enabled&&this._adjustRotateAngle(e),e)}_adjustRotateAngle(e){const t=(0,ie.BV)(e.rotateAngle);e.rotateAngle=(0,ie.Vl)(5*Math.round(t/5))}}var ae=i(20008),se=i(34778),le=i(92583);class ce extends A{constructor(e){super(),this._handles=new te.Z,this._originCache=(0,$.c)(),this._view=e.view,this._tool=e.tool,this._graphic=e.graphic,this._snapRotation=e.snapRotation,this._manipulator=this._createManipulator(),this._handles.add([this._manipulator.events.on("grab-changed",(e=>ne(e,this._manipulator)))]),this.forEachManipulator((e=>this._tool.manipulators.add(e)))}destroy(){this._handles.destroy(),this.forEachManipulator((e=>{this._tool.manipulators.remove(e),e.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._snapRotation=null,this._graphic=null,this._handles=null,this._originCache=null}forEachManipulator(e){e(this._manipulator,P.ROTATE)}createDragPipeline(e,t){let i=null,n=null;return(0,x.Xd)(this._manipulator,((o,r)=>{r.next((t=>{if("start"===t.action){o.cursor="grabbing";const t=e();i=t.plane,n=t.editGeometryOperations}return t})).next((0,x.Cf)(this._view)).next((e=>({...e,rotateAngle:(0,ae.cM)(e.mapStart,e.mapEnd,{x:i.origin[0],y:i.origin[1]},!0)}))).next(this._snapRotation.createDragEventPipelineStep(),this._snapRotation.next).next((e=>{const o=(0,K.c)(this._originCache,i.origin),r=[];for(const t of n.data.components)r.push(...t.vertices);const a="start"===e.action?L.O.NEW_STEP:L.O.ACCUMULATE_STEPS,s=n.rotateVertices(r,o,e.rotateAngle,a,se.w.REPLACE);return(0,le.nn)(s,i),t(e,s),e})).next((e=>("end"===e.action&&(o.cursor="grab"),e)))}))}_createManipulator(){const e=this._view,t=this._graphic;return new O.L({view:e,graphic:t,selectable:!0,cursor:"grab"})}}const he=1e-6;function pe(e){const t=(0,K.l)(e.basis1),i=(0,K.l)(e.basis2);return.3*Math.min(t,i)}class de extends A{constructor(e){super(),this._handles=new te.Z,this._planeStart=(0,ee.a)(),this._displayPlaneStart=(0,ee.a)(),this._originCache=(0,$.c)(),this._axisCache=(0,Q.a)(),this._renderStartCache=(0,$.c)(),this._renderEndCache=(0,$.c)(),this._resizeOriginCache=(0,$.c)(),this._view=e.view,this._tool=e.tool,this._graphic=e.graphic,this._direction=e.direction,this._preserveAspectRatio=e.preserveAspectRatio,this._manipulator=this._createManipulator(),this._handles.add([this._manipulator.events.on("grab-changed",(e=>ne(e,this._manipulator)))]),this.forEachManipulator((e=>this._tool.manipulators.add(e)))}destroy(){this._handles.destroy(),this.forEachManipulator((e=>{this._tool.manipulators.remove(e),e.destroy()})),this._tool=null,this._view=null,this._graphic=null,this._manipulator=null,this._direction=null,this._handles=null,this._planeStart=null,this._displayPlaneStart=null,this._originCache=null,this._axisCache=null,this._renderStartCache=null,this._renderEndCache=null,this._resizeOriginCache=null,this._preserveAspectRatio=null}forEachManipulator(e){e(this._manipulator,P.SCALE)}createDragPipeline(e,t){let i=null,n=null,o=null,r=0,a=null,s=null;const l=this._planeStart,c=this._displayPlaneStart,h=this._direction;return(0,x.Xd)(this._manipulator,((p,d)=>{d.next((t=>{if("start"===t.action){p.cursor="grabbing";const t=e();i=t.plane,n=t.displayPlane,o=t.editGeometryOperations,r=10*this._view.resolution,(0,ee.c)(i,l),(0,ee.c)(n,c);const s=(0,R.C5)(o.data.spatialReference);a=s?s.valid[1]-s.valid[0]-30*this._view.resolution:null}return t})).next((0,x.Cf)(this._view)).next((e=>{const t=(0,K.c)(this._renderStartCache,[e.mapStart.x,e.mapStart.y,0]),i=(0,K.c)(this._renderEndCache,[e.mapEnd.x,e.mapEnd.y,0]),o=(0,K.c)(this._resizeOriginCache,c.origin);(0,K.z)(o,o,c.basis1,-h[0]),(0,K.z)(o,o,c.basis2,-h[1]),(0,K.b)(i,i,o),(0,K.b)(t,t,o);const a=0!==h[0]&&0!==h[1],s=pe(c),l=pe(n)/s,p=(e,n)=>{if(0===e)return 1;let o=(0,K.l)(n),s=.5*e*(0,K.e)(n,i)/o;const c=s<0?-1:1;a&&(s+=(o-.5*e*(0,K.e)(n,t)/o)*c*l);const h=o<1.5*r?1:he;return o=Math.max(o-r,he),c>0&&(s-=10*this._view.resolution),c*Math.max(c*(s/o),h)},d=p(h[0],c.basis1),u=p(h[1],c.basis2);return{...e,direction:h,factor1:d,factor2:u}})).next(this._preserveAspectRatio.createDragEventPipelineStep(),this._preserveAspectRatio.next).next((e=>{const n=(0,K.c)(this._originCache,l.origin);(0,K.z)(n,n,l.basis1,-h[0]),(0,K.z)(n,n,l.basis2,-h[1]);const r=(0,q.s)(this._axisCache,l.basis1[0],l.basis1[1]);(0,q.f)(r,r);const c=[];for(const t of o.data.components)c.push(...t.vertices);const p="start"===e.action?L.O.NEW_STEP:L.O.ACCUMULATE_STEPS,d=o.scaleVertices(c,n,r,e.factor1,e.factor2,p,se.w.REPLACE);return a&&a<o.data.geometry.extent.width&&s?o.updateVertices(c,s):((0,ee.c)(l,i),(0,le.nn)(d,i),s=d.operation,t(e,d)),e})).next((e=>("end"===e.action&&(p.cursor="grab"),e)))}))}_createManipulator(){return new O.L({view:this._view,graphic:this._graphic,selectable:!0,cursor:"grab"})}}var ue=i(84954),ge=i(74923),_e=i(72612),me=i(80885),fe=i(61459);const ye="ArrowUp",ve="ArrowDown",be="ArrowLeft",Se="ArrowRight",Pe="+",Ce="-",Te="t",Me="Shift",we=D.CK,Re=[[1,1],[1,-1],[-1,-1],[-1,1],[1,0],[0,-1],[-1,0],[0,1]];let Ee=class extends B.m{constructor(e){super(e),this._initialControlPoints=null,this._initialGeometry=null,this._graphic=null,this._planeCache=(0,ee.a)(),this._displayPlaneCache=(0,ee.a)(),this._mainAxisCache=(0,Q.a)(),this._rotationHandleCache=(0,$.c)(),this._cornerA=(0,$.c)(),this._cornerB=(0,$.c)(),this._cornerC=(0,$.c)(),this._cornerD=(0,$.c)(),this._avgAB=(0,$.c)(),this._avgBC=(0,$.c)(),this._avgCD=(0,$.c)(),this._avgDA=(0,$.c)(),this._preserveAspectRatio=new oe,this._snapRotation=new re,this._graphicsLayer=new E.Z({internal:!0,listMode:"hide",visible:!1}),this._sharedUndoStack=[],this._sharedRedoStack=[],this._isOpacityToggled=!1,this._isModifierActive=!1,this._factor=1,this.preserveAspectRatio=null,this.snapRotation=null}initialize(){this._initialize()}destroy(){const{map:e}=this.view;this._dragManipulation.destroy(),this._rotateManipulation.destroy(),this._scaleManipulations.forEach((e=>e.destroy())),this._editGeometryOperations.destroy(),e.removeMany([this._graphicsLayer]),this._graphicsLayer.removeAll(),this._graphicsLayer=(0,a.SC)(this._graphicsLayer),this._initialControlPoints=null,this._initialGeometry=null,this._graphic=null,this._preserveAspectRatio=null,this._snapRotation=null,this._planeCache=null,this._displayPlaneCache=null,this._rotationHandleCache=null,this._mainAxisCache=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._avgAB=null,this._avgBC=null,this._avgCD=null,this._avgDA=null,this._sharedUndoStack=null,this._sharedRedoStack=null}get _plane(){const e=this._graphic.geometry;if(!(0,a.pC)(e))return null;const t=this._editGeometryOperations.data,i=t.components[0].edges[0],n=(0,q.a)(this._mainAxisCache,i.leftVertex.pos,i.rightVertex.pos);(0,q.f)(n,n);let o=80*this.view.resolution;const r=this.view.spatialReference;return(0,R.fS)(r,e.spatialReference)&&(o*=(0,X.c9)(r)/(0,X.c9)(e.spatialReference)),(0,le.lv)(n,t,o,this._planeCache)}get _displayPlane(){const e=this._plane;if(!e)return null;const t=this._displayPlaneCache;(0,ee.c)(e,t);const i=10*this.view.resolution;return(0,K.g)(t.basis1,t.basis1,1+i/(0,K.l)(t.basis1)),(0,K.g)(t.basis2,t.basis2,1+i/(0,K.l)(t.basis2)),t}get _backgroundGraphicGeometry(){const e=this._displayPlane;if(!e)return null;const t=this.view.spatialReference;return this._updateDisplayPlaneConrers(e),new me.Z({spatialReference:t,rings:[[this._cornerA,this._cornerB,this._cornerC,this._cornerD,this._cornerA]]})}get _rotateGraphicGeometry(){const e=this._plane;if(!e)return null;const t=this._rotationHandleCache;return(0,K.n)(t,e.basis1),(0,K.g)(t,t,30*this.view.resolution),(0,K.a)(t,t,e.origin),(0,K.a)(t,t,e.basis1),new y.Z({x:t[0],y:t[1],spatialReference:this.view.spatialReference})}get _scaleGraphicGeometries(){const e=this._displayPlane;if(!e)return[];const t=this.view.spatialReference;this._updateDisplayPlaneConrers(e);const{_cornerA:i,_cornerB:n,_cornerC:o,_cornerD:r}=this,a=(0,K.h)(this._avgAB,i,n,.5),s=(0,K.h)(this._avgBC,n,o,.5),l=(0,K.h)(this._avgCD,o,r,.5),c=(0,K.h)(this._avgDA,r,i,.5);return[new y.Z({x:i[0],y:i[1],spatialReference:t}),new y.Z({x:n[0],y:n[1],spatialReference:t}),new y.Z({x:o[0],y:o[1],spatialReference:t}),new y.Z({x:r[0],y:r[1],spatialReference:t}),new y.Z({x:a[0],y:a[1],spatialReference:t}),new y.Z({x:s[0],y:s[1],spatialReference:t}),new y.Z({x:l[0],y:l[1],spatialReference:t}),new y.Z({x:c[0],y:c[1],spatialReference:t})]}onActivate(){this.visible=!0}onDeactivate(){this.visible=!1}onShow(){this._graphicsLayer.visible=!0}onHide(){this._graphicsLayer.visible=!1}canUndo(){return this._editGeometryOperations.canUndo}canRedo(){return this._editGeometryOperations.canRedo}undo(){this._editGeometryOperations.undo(),this.updateGraphics()}redo(){this._editGeometryOperations.redo(),this.updateGraphics()}refresh(){const{view:e,target:t}=this,i="georeference"in t?(0,a.Wg)((0,a.Wg)(t.georeference).coords):t.geometry,n=this._editGeometryOperations,o=n.data.components[0].vertices,r=ue.XE.fromGeometry((0,w.iV)(i,e.spatialReference),G.JY.Local).components[0].vertices;o.forEach(((e,t)=>{n.setVertexPosition(e,r[t].pos)})),this.updateGraphics()}reset(){const{target:e}=this;if("georeference"in e){const t=(0,a.Wg)(e.georeference);"control-points"===t.type&&(t.controlPoints=this._initialControlPoints)}else e.geometry=this._initialGeometry;this.refresh(),this._sharedUndoStack.length=0,this._sharedRedoStack.length=0}updateGraphics(){const e=this._editGeometryOperations.data.geometry;"georeference"in this.target&&((0,a.Wg)(this.target.georeference).coords=e),this._graphic.geometry=e,this._backgroundGraphic.geometry=this._backgroundGraphicGeometry,this._rotateGraphic.geometry=this._rotateGraphicGeometry,this._scaleGraphicGeometries.forEach(((e,t)=>{this._scaleGraphics[t].geometry=e}))}setSharedUndoStack(e){this._sharedUndoStack=e}setSharedRedoStack(e){this._sharedRedoStack=e}async _initialize(){const{view:e,target:t}=this;if("georeference"in t){const e=(0,a.Wg)(t.georeference);this._graphic=new o.Z({geometry:(0,a.Wg)(e.coords)}),this._initialControlPoints="control-points"===e.type?e.controlPoints:null}else this._graphic=t,this._initialGeometry=(0,a.Wg)(t.geometry);e.map.addMany([this._graphicsLayer]),e.focus(),this.visible=!1,this.finishToolCreation(),await this._loadProjectionEngine(),this._editGeometryOperations=U.c.fromGeometry((0,w.iV)(this._graphic.geometry,e.spatialReference),G.JY.Local),this._backgroundGraphic=new o.Z({symbol:new fe.Z({color:"transparent",outline:{type:"simple-line",color:(0,T.e9)(),width:2}}),geometry:this._backgroundGraphicGeometry}),this._rotateGraphic=new o.Z({symbol:new p.Z({color:(0,T.RN)(),outline:{type:"simple-line",color:(0,T.e9)(),width:1}}),geometry:this._rotateGraphicGeometry}),this._scaleGraphics=this._scaleGraphicGeometries.map((e=>new o.Z({symbol:new p.Z({size:6,style:"square",color:(0,T.RN)(),outline:{type:"simple-line",color:(0,T.e9)(),width:1}}),geometry:e}))),this._graphicsLayer.graphics.addMany([this._backgroundGraphic,this._rotateGraphic,...this._scaleGraphics]),this._dragManipulation=new I({tool:this,view:e,graphic:this._graphic}),this._rotateManipulation=new ce({tool:this,view:e,graphic:this._rotateGraphic,snapRotation:this._snapRotation}),this._scaleManipulations=this._scaleGraphics.map(((t,i)=>new de({tool:this,view:e,graphic:t,direction:Re[i],preserveAspectRatio:this._preserveAspectRatio}))),this.addHandles([this._dragManipulation.createDragPipeline(this._getInfo.bind(this),this._updateGraphics.bind(this)),this._rotateManipulation.createDragPipeline(this._getInfo.bind(this),this._updateGraphics.bind(this)),...this._scaleManipulations.map((e=>e.createDragPipeline(this._getInfo.bind(this),this._updateGraphics.bind(this)))),(0,M.YP)((()=>this.view.scale),(()=>this.active?this.updateGraphics():null)),e.on("click",(async i=>{if(null!=e.activeTool&&e.activeTool!==this)return;const n=(0,_e.vT)(i),o=[];e.map.allLayers.forEach((e=>{"vector-tile"!==e.type&&"imagery"!==e.type||o.push(e)}));const r=await this.view.hitTest(n,{exclude:o}),s=r.results;if(0===s.length)e.activeTool=null;else{const i=(0,ge.qm)(r.results),n="georeference"in t,o=s.map((e=>"media"===e.type?e.element:null)).filter(Boolean),l=[...this._graphicsLayer.graphics,n?null:t].filter(Boolean);n&&o.includes(t)||(0,a.pC)(i)&&l.includes(i.graphic)?null==e.activeTool&&(e.activeTool=this):e.activeTool=null}}))]);const i=e=>{this.addHandles(e.events.on("grab-changed",(e=>{"georeference"in t&&("start"===e.action?t.opacity*=.5:"end"===e.action&&(t.opacity*=2))})))};this._dragManipulation.forEachManipulator(i),this._rotateManipulation.forEachManipulator(i),this._scaleManipulations.forEach((e=>e.forEachManipulator(i))),this.addHandles([e.on("key-down",(i=>{e.activeTool===this&&(i.key!==Me||i.repeat||(null==this.preserveAspectRatio&&(this._preserveAspectRatio.enabled=!this._preserveAspectRatio.enabled),null==this.snapRotation&&(this._snapRotation.enabled=!this._snapRotation.enabled),this._isModifierActive=!0,i.stopPropagation()),i.key!==Te||i.repeat||("georeference"in t&&(t.opacity*=this._isOpacityToggled?2:.5,this._isOpacityToggled=!this._isOpacityToggled),i.stopPropagation()),i.key!==we||i.repeat||(this._factor=10,i.stopPropagation()),this._isModifierActive&&(i.key===Pe&&(this._scale(this._factor),i.stopPropagation()),i.key===Ce&&(this._scale(-this._factor),i.stopPropagation()),i.key===ye&&(this._move(0,this._factor),i.stopPropagation()),i.key===ve&&(this._move(0,-this._factor),i.stopPropagation()),i.key===be&&(this._move(-this._factor,0),i.stopPropagation()),i.key===Se&&(this._move(this._factor,0),i.stopPropagation())))})),e.on("key-up",(t=>{e.activeTool===this&&(t.key===Me&&(null==this.preserveAspectRatio&&(this._preserveAspectRatio.enabled=!this._preserveAspectRatio.enabled),null==this.snapRotation&&(this._snapRotation.enabled=!this._snapRotation.enabled),this._isModifierActive=!1,t.stopPropagation()),t.key===we&&(this._factor=1,t.stopPropagation()))}))])}async _loadProjectionEngine(){const e=(0,a.Wg)(this._graphic.geometry);return(0,w.iQ)(e.spatialReference,this.view.spatialReference)}_updateDisplayPlaneConrers(e){const{basis1:t,basis2:i,origin:n}=e,o=this._cornerA;(0,K.a)(o,n,t),(0,K.a)(o,o,i);const r=this._cornerB;(0,K.a)(r,n,t),(0,K.b)(r,r,i);const a=this._cornerC;(0,K.b)(a,n,t),(0,K.b)(a,a,i);const s=this._cornerD;(0,K.b)(s,n,t),(0,K.a)(s,s,i)}_getInfo(){return{editGeometryOperations:this._editGeometryOperations,plane:this._plane,displayPlane:this._displayPlane}}_updateGraphics(e,t){"start"===e.action&&(this._sharedUndoStack.push({tool:this,operation:t}),this._sharedRedoStack.length=0),this.updateGraphics()}_scale(e){const t=this._editGeometryOperations,i=[];for(const a of t.data.components)i.push(...a.vertices);const n=t.data.geometry.extent?.width,o=(n+e*this.view.resolution)/n,r=t.scaleVertices(i,this._plane.origin,Q.U,o,o,L.O.NEW_STEP,se.w.REPLACE);this._sharedUndoStack.push({tool:this,operation:r}),this._sharedRedoStack.length=0,this.updateGraphics()}_move(e,t){const i=this._editGeometryOperations,n=[];for(const r of i.data.components)n.push(...r.vertices);const o=i.moveVertices(n,e*this.view.resolution,t*this.view.resolution,0,L.O.NEW_STEP);this._sharedUndoStack.push({tool:this,operation:o}),this._sharedRedoStack.length=0,this.updateGraphics()}};(0,n._)([(0,s.Cb)()],Ee.prototype,"_plane",null),(0,n._)([(0,s.Cb)()],Ee.prototype,"_backgroundGraphicGeometry",null),(0,n._)([(0,s.Cb)()],Ee.prototype,"_rotateGraphicGeometry",null),(0,n._)([(0,s.Cb)()],Ee.prototype,"_scaleGraphicGeometries",null),(0,n._)([(0,s.Cb)()],Ee.prototype,"preserveAspectRatio",void 0),(0,n._)([(0,s.Cb)()],Ee.prototype,"snapRotation",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0,nonNullable:!0})],Ee.prototype,"target",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0})],Ee.prototype,"view",void 0),Ee=(0,n._)([(0,l.j)("esri.views.2d.interactive.editingTools.TransformTool")],Ee);var ke=i(85015);const Ge="r",Ae="z";let xe=class extends ke.Z{constructor(e){super(e),this._transformTool=null,this._controlPointsTransformTool=null,this._advancedModeTransformTool=null,this._activeTool=null,this._sharedUndoStack=[],this._sharedRedoStack=[],this._originalOpacity=null,this.activeHandle=0}initialize(){const{view:e,mediaElement:t,preserveAspectRatio:i,snapRotation:n,advancedMode:o}=this;this._originalOpacity=t.opacity,this._transformTool=new Ee({target:t,view:e,preserveAspectRatio:i,snapRotation:n}),this._controlPointsTransformTool=new J({mediaElement:t,view:e}),this._advancedModeTransformTool=new J({mediaElement:o.mediaElement,view:o.view}),this._transformTool.setSharedUndoStack(this._sharedUndoStack),this._transformTool.setSharedRedoStack(this._sharedRedoStack),this._controlPointsTransformTool.setSharedUndoStack(this._sharedUndoStack),this._controlPointsTransformTool.setSharedRedoStack(this._sharedRedoStack),this._advancedModeTransformTool.setSharedUndoStack(this._sharedUndoStack),this._advancedModeTransformTool.setSharedRedoStack(this._sharedRedoStack);const r=(0,a.Wg)(t.georeference),s=(0,a.Wg)(o.mediaElement.georeference);o.view.tools.addMany([this._advancedModeTransformTool]),"controlPoints"in s&&"controlPoints"in r&&this.addHandles([o.view.on("key-down",(e=>{e.key===Ae&&this.canUndo()&&(this.undo(),e.stopPropagation()),e.key===Ge&&this.canRedo()&&(this.redo(),e.stopPropagation())})),o.view.on("focus",(async e=>{this._controlPointsTransformTool.removeHighlightActiveHandle(),this._advancedModeTransformTool.highlightActiveHandle()})),(0,M.YP)((()=>s.controlPoints),(e=>{r.controlPoints=(0,a.Wg)(e).map(((e,t)=>{let{sourcePoint:i}=e;return{sourcePoint:i,mapPoint:(0,a.Wg)(r.controlPoints)[t].mapPoint}})),this._activeTool?.refresh()})),(0,M.YP)((()=>this._controlPointsTransformTool.activeHandle),(e=>{this._advancedModeTransformTool.updateActiveHandle(e),this.activeHandle=e})),(0,M.YP)((()=>this._advancedModeTransformTool.activeHandle),(e=>{this._controlPointsTransformTool.updateActiveHandle(e),this.activeHandle=e}))]),this.addHandles([e.on("key-down",(e=>{e.key===Ae&&this.canUndo()&&(this.undo(),e.stopPropagation()),e.key===Ge&&this.canRedo()&&(this.redo(),e.stopPropagation())})),e.on("focus",(async e=>{this._advancedModeTransformTool.removeHighlightActiveHandle(),this._controlPointsTransformTool.highlightActiveHandle()}))]),e.tools.addMany([this._transformTool,this._controlPointsTransformTool]),e.activeTool=this._transformTool,this._activeTool=this._transformTool,e.focus()}destroy(){this._transformTool?.destroy(),this._controlPointsTransformTool?.destroy(),this._transformTool=null,this._controlPointsTransformTool=null,this._advancedModeTransformTool=null,this._activeTool=null,this._sharedUndoStack=null,this._sharedRedoStack=null}canUndo(){return this._sharedUndoStack.length>0}canRedo(){return this._sharedRedoStack.length>0}undo(){if(this._sharedUndoStack.length>0){const{tool:e,operation:t}=this._sharedUndoStack.pop();e!==this._activeTool&&e.refresh(),t.undo(),e.updateGraphics(),this._sharedRedoStack.push({tool:e,operation:t}),this._activeTool!==e&&this._activeTool?.refresh()}}redo(){if(this._sharedRedoStack.length>0){const{tool:e,operation:t}=this._sharedRedoStack.pop();e!==this._activeTool&&e.refresh(),t.apply(),e.updateGraphics(),this._sharedUndoStack.push({tool:e,operation:t}),this._activeTool!==e&&this._activeTool?.refresh()}}refresh(){this._activeTool.refresh()}reset(){this._activeTool.reset(),this._advancedModeTransformTool.reset()}async enableAdvancedMode(){this.view.activeTool=this._controlPointsTransformTool,this._activeTool=this._controlPointsTransformTool,this._activeTool.refresh(),await this.advancedMode.view.when(),this.advancedMode.view.activeTool=this._advancedModeTransformTool,this._originalOpacity=this._controlPointsTransformTool.mediaElement.opacity,this._controlPointsTransformTool.mediaElement.opacity=.25*this._originalOpacity}disableAdvancedMode(){this.view.activeTool=this._transformTool,this._activeTool=this._transformTool,this._activeTool.refresh(),this.advancedMode.view.activeTool=null,this._controlPointsTransformTool.mediaElement.opacity=this._originalOpacity}};(0,n._)([(0,s.Cb)()],xe.prototype,"activeHandle",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0})],xe.prototype,"advancedMode",void 0),(0,n._)([(0,s.Cb)()],xe.prototype,"preserveAspectRatio",void 0),(0,n._)([(0,s.Cb)()],xe.prototype,"snapRotation",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0,nonNullable:!0})],xe.prototype,"mediaElement",void 0),(0,n._)([(0,s.Cb)({constructOnly:!0})],xe.prototype,"view",void 0),xe=(0,n._)([(0,l.j)("esri.views.2d.interactive.editingTools.MediaTransformToolsWrapper")],xe)},70040:(e,t,i)=>{i.d(t,{O:()=>o,X:()=>p});var n=i(51995);const o={main:new n.Z([255,127,0]),selected:new n.Z([255,255,255]),outline:new n.Z([0,0,0,.5]),selectedOutline:new n.Z([255,255,255]),hoverOutline:new n.Z([255,255,255]),secondary:new n.Z([255,255,255]),secondaryOutline:new n.Z([100,100,100]),transparent:new n.Z([0,0,0,0])};function r(e,t){if(t)for(const i in t)e[i]=t[i]}class a{constructor(e){this.size=8,this.hoverSize=10,this.color=o.main,this.hoverColor=o.main,this.outlineColor=o.outline,this.hoverOutlineColor=o.hoverOutline,r(this,e)}}class s{constructor(e){this.color=o.secondary,this.hoverColor=o.main,r(this,e)}}class l{constructor(e){this.color=o.transparent,this.hoverColor=o.transparent,this.outlineColor=o.main,this.hoverOutlineColor=o.main,this.stagedColor=o.transparent,this.stagedOutlineColor=o.secondary,r(this,e)}}class c{constructor(e){this.vertex=new a,this.midpoint=new a({color:o.secondary,outlineColor:o.secondaryOutline,size:6}),this.selected=new a({color:o.selected,hoverColor:o.selected,hoverOutlineColor:o.hoverOutline}),r(this,e)}}class h{constructor(e){this.center=new a({color:o.secondaryOutline}),this.fill=new l,this.line=new s,this.vertex=new a({color:o.selected,outlineColor:o.main,hoverColor:o.selected,hoverOutlineColor:o.secondaryOutline}),r(this,e)}}const p=new class{constructor(e){this.reshapeGraphics=new c,this.transformGraphics=new h,r(this,e)}}},28357:(e,t,i)=>{i.d(t,{EX:()=>r});var n=i(51995);function o(e){let{r:t,g:i,b:o,a:r}=e;return r<1&&(t=Math.round(r*t+255*(1-r)),i=Math.round(r*i+255*(1-r)),o=Math.round(r*o+255*(1-r))),new n.Z({r:t,g:i,b:o})}function r(e){const{r:t,g:i,b:n}=o(e);return.2126*t+.7152*i+.0722*n}}}]);
//# sourceMappingURL=700.22f4844f.chunk.js.map