import{r as u,C as p,k as g,X as y,ht as x,hu as d,hv as b,a0 as v}from"./index-7753bab1.js";import{geodesicBuffer as E}from"./geometryEngine-05918b10.js";import"./geometryEngineBase-e1a33b0a.js";import"./hydrated-169f90fe.js";const S=e=>{const t=u.useRef(null);return u.useEffect(()=>{e.feature&&new p({container:t.current,graphic:e.feature})},[e.feature]),g.jsx("div",{ref:t})},j=async e=>{const t=new y({portalItem:{id:"95092428774c4b1fb6a3b6f5fed9fbc4"}});return await t.load(),t.allLayers.filter(r=>e.includes(r.title)).toArray()},h=(e,t,n,r,a)=>{e==null||e.forEach(o=>{o.type==="feature"&&a.push(o.queryFeatures({geometry:E(t.geometry,-5,9002),outFields:["*"],returnGeometry:!0}))});const i=[];if(a.length)return Promise.all(a).then(o=>{o.forEach(s=>{s.features.length&&s.features.forEach(f=>{i.push(f)})}),r(!1),n(i)})},A=(e,t,n,r,a,i)=>{requestAnimationFrame(async()=>{if(e.target.hasAttribute("expanded")){i(!0),a([]);const o=e.target.getAttribute("item-title"),s=t.find(c=>c.group.title===o),f=[];if(s){let c=n==null?void 0:n.map.allLayers.filter(l=>s.group.layers.includes(l.title));if(c.length!==s.group.layers.length){const l=await j(s.group.layers);h(l,r,a,i,f)}else h(c.toArray(),r,a,i,f)}}})},k=e=>{const[t,n]=u.useState(),[r,a]=u.useState(),[i,o]=u.useState([]),[s,f]=u.useState(!1);return u.useEffect(()=>{e.view&&n(e.view),e.graphic&&a(e.graphic)},[]),g.jsxs(x,{selectionMode:"single",children:[d.map(c=>g.jsxs(b,{"item-title":c.group.title,heading:c.group.title,onClick:l=>{t&&r&&A(l,d,t,r,o,f)},children:[i.map((l,m)=>g.jsx(S,{feature:l},m)),i.length===0&&g.jsx("div",{children:"No information available."})]},c.group.title)),g.jsx(v,{loading:!0,hidden:s?void 0:!0})]})};export{k as Services,k as default};
