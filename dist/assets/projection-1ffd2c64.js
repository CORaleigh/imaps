import{aR as Y,cJ as R,ec as _,eS as g,f3 as M,jT as O,ao as $,cg as j,l3 as x,al as W,am as b,aB as h,as as d,eN as S,l4 as B}from"./index-7753bab1.js";import{e as U}from"./mat3f64-221ce671.js";import{e as k}from"./mat4f64-65d35099.js";import{c as E}from"./spatialReferenceEllipsoidUtils-17d3ccdb.js";import{i as c,T as m}from"./BufferView-7ae97da4.js";import{t as w,r as V,o as v}from"./vec33-5f4522b8.js";const A=Y.getLogger("esri.geometry.support.meshUtils.normalProjection");function I(r,e,t,a,o){return F(a)?(l(i.TO_PCPF,c.fromTypedArray(r),m.fromTypedArray(e),m.fromTypedArray(t),a,c.fromTypedArray(o)),o):(A.error("Cannot convert spatial reference to PCPF"),o)}function K(r,e,t,a,o){return F(a)?(l(i.FROM_PCPF,c.fromTypedArray(r),m.fromTypedArray(e),m.fromTypedArray(t),a,c.fromTypedArray(o)),o):(A.error("Cannot convert to spatial reference from PCPF"),o)}function Q(r,e,t){return R(r,e,0,t,E(e),0,r.length/3),t}function X(r,e,t){return R(r,E(t),0,e,t,0,r.length/3),e}function rr(r,e,t){if(d(r))return e;const a=m.fromTypedArray(r),o=m.fromTypedArray(e);return w(o,a,t),e}function er(r,e,t){if(d(r))return e;S(n,t);const a=c.fromTypedArray(r),o=c.fromTypedArray(e);return V(o,a,n),B(n)||v(o,o),e}function or(r,e,t){if(d(r))return e;S(n,t);const a=c.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),o=c.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT);if(V(o,a,n),B(n)||v(o,o),r!==e)for(let f=3;f<r.length;f+=4)e[f]=r[f];return e}function tr(r,e,t,a,o){if(!F(a))return A.error("Cannot convert spatial reference to PCPF"),o;l(i.TO_PCPF,c.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),m.fromTypedArray(e),m.fromTypedArray(t),a,c.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT));for(let f=3;f<r.length;f+=4)o[f]=r[f];return o}function ar(r,e,t,a,o){if(!F(a))return A.error("Cannot convert to spatial reference from PCPF"),o;l(i.FROM_PCPF,c.fromTypedArray(r,16),m.fromTypedArray(e),m.fromTypedArray(t),a,c.fromTypedArray(o,16));for(let f=3;f<r.length;f+=4)o[f]=r[f];return o}function l(r,e,t,a,o,f){if(!e)return;const C=t.count,T=E(o);if(L(o))for(let y=0;y<C;y++)a.getVec(y,P),e.getVec(y,s),_(T,P,p,T),g(n,p),r===i.FROM_PCPF&&M(n,n),O(s,s,n),f.setVec(y,s);else for(let y=0;y<C;y++){a.getVec(y,P),e.getVec(y,s),_(T,P,p,T),g(n,p);const N=$(t.get(y,1));let u=Math.cos(N);r===i.TO_PCPF&&(u=1/u),n[0]*=u,n[1]*=u,n[2]*=u,n[3]*=u,n[4]*=u,n[5]*=u,r===i.FROM_PCPF&&M(n,n),O(s,s,n),j(s,s),f.setVec(y,s)}return f}function F(r){return L(r)||z(r)}function L(r){return r.isWGS84||x(r)||W(r)||b(r)}function z(r){return r.isWebMercator}var i;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(i||(i={}));const P=h(),s=h(),p=k(),n=U();export{ar as L,Q as M,rr as O,X as R,or as V,K as h,I as j,tr as k,er as v};
