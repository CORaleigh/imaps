import{e as s,y as r,b8 as x,b9 as C,a as U,K as W,M as A,W as j,x as M,z as E,ba as I,_ as m,r as d,R as k,k as n,m as D,o as h,b6 as O,p as g}from"./index-7753bab1.js";import{i as R}from"./getDefaultUnitForView-f5dc3e90.js";const P={title:"Measure Tips",tips:[{title:"Coordinate Search",text:"The coordinate search has been moved to the lower left corner of the map"}]},V={readOnly:!0,get(){return R(this.view)}};let c=class extends W{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){this._overrideIfSome("areaUnit",e)}get linearUnit(){return this.defaultUnit}set linearUnit(e){this._overrideIfSome("linearUnit",e)}get state(){const{activeViewModel:e}=this;return e?e.state:"disabled"}};s([r({type:["area","distance","direct-line"]})],c.prototype,"activeTool",void 0),s([r()],c.prototype,"activeViewModel",void 0),s([r({type:x})],c.prototype,"areaUnit",null),s([r(V)],c.prototype,"defaultUnit",void 0),s([r({type:C})],c.prototype,"linearUnit",null),s([r({readOnly:!0})],c.prototype,"state",null),s([r()],c.prototype,"view",void 0),c=s([U("esri.widgets.Measurement.MeasurementViewModel")],c);const T=c,y={base:"esri-measurement",widgetIcon:"esri-icon-measure"};function $(e){return(e==null?void 0:e.declaredClass)==="esri.widgets.AreaMeasurement2D"||(e==null?void 0:e.declaredClass)==="esri.widgets.AreaMeasurement3D"}let l=class extends j{constructor(e,i){super(e,i),this._widgets=new Map,this.activeWidget=null,this.iconClass=y.widgetIcon,this.messages=null,this.viewModel=new T}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then(e=>{this._set("activeWidget",e)}),this.addHandles([M(()=>[this.view,this.activeTool],async()=>{this._set("activeWidget",await this._getActiveWidget())}),M(()=>this.activeWidget,(e,i)=>{this.viewModel.set("activeViewModel",e?e.viewModel:null),i&&(i.visible=!1)}),M(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])}destroy(){this._destroyWidgets()}get activeTool(){return this.viewModel.activeTool}set activeTool(e){this.viewModel.activeTool=e}get areaUnit(){return this.viewModel.areaUnit}set areaUnit(e){this.viewModel.areaUnit=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get linearUnit(){return this.viewModel.linearUnit}set linearUnit(e){this.viewModel.linearUnit=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const{activeWidget:e}=this,i=e&&!e.destroyed?e.render():null;return E("div",{class:y.base},i)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){const{activeViewModel:e}=this.viewModel;e&&I(e.start())}async _createWidget(e){const{areaUnit:i,linearUnit:t,view:a}=this;switch(e){case"area":{const{type:o}=a;switch(o){case"2d":return new(await m(()=>import("./AreaMeasurement2D-1861f68e.js"),["assets/AreaMeasurement2D-1861f68e.js","assets/index-7753bab1.js","assets/index-0be7f32f.css","assets/analysisThemeUtils-2970f8b4.js","assets/colorUtils-a691c496.js","assets/geometryEngine-05918b10.js","assets/geometryEngineBase-e1a33b0a.js","assets/hydrated-169f90fe.js","assets/Draw-18a95994.js","assets/SnappingVisualizer2D-697b94a5.js","assets/enums-55085e26.js","assets/settings-a2318659.js","assets/SnappingContext-ff99808f.js","assets/PointSnappingHint-9fd6408b.js","assets/plane-32e6467c.js","assets/sphere-89c2d6c4.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/SnappingOperation-081fd463.js","assets/drawSurfaces-472ff34b.js","assets/quat-1a9efe59.js","assets/SnappingDragPipelineStep-4df9c5ad.js","assets/hydratedFeatures-e18f5d50.js","assets/drawUtils-394a2d10.js","assets/GraphicManipulator-253b3b2d.js","assets/drapedUtils-1e8dccc4.js","assets/InteractiveToolViewModel-ad3072e2.js","assets/getDefaultUnitForView-f5dc3e90.js"])).default({view:a,unit:i,uiStrings:this._createUIStringsForWidget(e)});case"3d":return new(await m(()=>import("./AreaMeasurement3D-82a67c65.js"),["assets/AreaMeasurement3D-82a67c65.js","assets/index-7753bab1.js","assets/index-0be7f32f.css","assets/Analysis-f75447fa.js","assets/InteractiveAnalysisViewModel-e0ffbe4d.js","assets/geometryEngineBase-e1a33b0a.js","assets/SnappingDragPipelineStep-4df9c5ad.js","assets/hydratedFeatures-e18f5d50.js","assets/drawUtils-394a2d10.js","assets/SnappingContext-ff99808f.js","assets/PointSnappingHint-9fd6408b.js","assets/plane-32e6467c.js","assets/sphere-89c2d6c4.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/InteractiveToolViewModel-ad3072e2.js","assets/dragEventPipeline3D-7a453208.js","assets/vec4f32-0d1b2306.js","assets/Octree-d70a1310.js","assets/Util-d77dfa33.js","assets/lineSegment-94ce77e4.js","assets/NativeLineMaterial-0aac9ae8.js","assets/interfaces-736d93d7.js","assets/basicInterfaces-04e01328.js","assets/enums-64ab819c.js","assets/VertexArrayObject-6236f727.js","assets/Texture-280a81f5.js","assets/VertexColor.glsl-a24a5fe4.js","assets/requestImageUtils-dc72d397.js","assets/OrderIndependentTransparency-92d1201d.js","assets/triangle-86ddbd84.js","assets/Indices-4fd742c7.js","assets/VertexAttribute-15d1866a.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/quat-1a9efe59.js","assets/vec3f32-ad1dc57f.js","assets/BufferView-7ae97da4.js","assets/VertexElementDescriptor-2925c6af.js","assets/NestedMap-1b5db22e.js","assets/InterleavedLayout-f57c96d2.js","assets/types-e1c0a5bf.js","assets/boundedPlane-2b6cf7c1.js","assets/glUtil-7a9be557.js","assets/DoubleArray-0068ae83.js","assets/floatRGBA-bba05acf.js","assets/analysisThemeUtils-2970f8b4.js","assets/colorUtils-a691c496.js","assets/SnappingOperation-081fd463.js","assets/getDefaultUnitForView-f5dc3e90.js"])).default({view:a,unit:i,uiStrings:this._createUIStringsForWidget(e)});default:return null}}case"distance":{const{type:o}=a;return o==="2d"?new(await m(()=>import("./DistanceMeasurement2D-dd8c93e4.js"),["assets/DistanceMeasurement2D-dd8c93e4.js","assets/index-7753bab1.js","assets/index-0be7f32f.css","assets/analysisThemeUtils-2970f8b4.js","assets/colorUtils-a691c496.js","assets/geometryEngine-05918b10.js","assets/geometryEngineBase-e1a33b0a.js","assets/hydrated-169f90fe.js","assets/Draw-18a95994.js","assets/SnappingVisualizer2D-697b94a5.js","assets/enums-55085e26.js","assets/settings-a2318659.js","assets/SnappingContext-ff99808f.js","assets/PointSnappingHint-9fd6408b.js","assets/plane-32e6467c.js","assets/sphere-89c2d6c4.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/SnappingOperation-081fd463.js","assets/drawSurfaces-472ff34b.js","assets/quat-1a9efe59.js","assets/SnappingDragPipelineStep-4df9c5ad.js","assets/hydratedFeatures-e18f5d50.js","assets/drawUtils-394a2d10.js","assets/GraphicManipulator-253b3b2d.js","assets/drapedUtils-1e8dccc4.js","assets/InteractiveToolViewModel-ad3072e2.js","assets/getDefaultUnitForView-f5dc3e90.js"])).default({view:a,unit:t,uiStrings:this._createUIStringsForWidget(e)}):null}case"direct-line":{const{type:o}=a;return o==="3d"?new(await m(()=>import("./DirectLineMeasurement3D-92fa1aff.js"),["assets/DirectLineMeasurement3D-92fa1aff.js","assets/index-7753bab1.js","assets/index-0be7f32f.css","assets/Analysis-f75447fa.js","assets/InteractiveAnalysisViewModel-e0ffbe4d.js","assets/geometryEngineBase-e1a33b0a.js","assets/SnappingDragPipelineStep-4df9c5ad.js","assets/hydratedFeatures-e18f5d50.js","assets/drawUtils-394a2d10.js","assets/SnappingContext-ff99808f.js","assets/PointSnappingHint-9fd6408b.js","assets/plane-32e6467c.js","assets/sphere-89c2d6c4.js","assets/mat3f64-221ce671.js","assets/mat4f64-65d35099.js","assets/quatf64-3363c48e.js","assets/InteractiveToolViewModel-ad3072e2.js","assets/dragEventPipeline3D-7a453208.js","assets/vec4f32-0d1b2306.js","assets/Octree-d70a1310.js","assets/Util-d77dfa33.js","assets/lineSegment-94ce77e4.js","assets/NativeLineMaterial-0aac9ae8.js","assets/interfaces-736d93d7.js","assets/basicInterfaces-04e01328.js","assets/enums-64ab819c.js","assets/VertexArrayObject-6236f727.js","assets/Texture-280a81f5.js","assets/VertexColor.glsl-a24a5fe4.js","assets/requestImageUtils-dc72d397.js","assets/OrderIndependentTransparency-92d1201d.js","assets/triangle-86ddbd84.js","assets/Indices-4fd742c7.js","assets/VertexAttribute-15d1866a.js","assets/doublePrecisionUtils-e3c3d0d8.js","assets/quat-1a9efe59.js","assets/vec3f32-ad1dc57f.js","assets/BufferView-7ae97da4.js","assets/VertexElementDescriptor-2925c6af.js","assets/NestedMap-1b5db22e.js","assets/InterleavedLayout-f57c96d2.js","assets/types-e1c0a5bf.js","assets/boundedPlane-2b6cf7c1.js","assets/glUtil-7a9be557.js","assets/DoubleArray-0068ae83.js","assets/floatRGBA-bba05acf.js","assets/analysisThemeUtils-2970f8b4.js","assets/colorUtils-a691c496.js","assets/getDefaultUnitForView-f5dc3e90.js"])).default({view:a,unit:t,uiStrings:this._createUIStringsForWidget(e)}):null}default:return null}}_destroyWidgets(){this._widgets.forEach(e=>e.destroy()),this._widgets.clear()}async _getActiveWidget(){const{activeTool:e,view:i}=this;if(!i||!e)return null;let t=null;if(this._widgets.has(e))t=this._widgets.get(e),t.visible=!0;else{if(t=await this._createWidget(e),!t)return null;await t.viewModel.start(),this._widgets.set(e,t)}return t}_createUIStringsForWidget(e){if(!this.uiStrings)return null;const i=e+"-"+this.view.type;return this.uiStrings[i]}_updateSubWidgetProperties(){this._widgets.forEach((e,i)=>{const{areaUnit:t,linearUnit:a}=this;e.unit=$(e)?t:a,e.uiStrings=this._createUIStringsForWidget(i)})}};s([r()],l.prototype,"activeTool",null),s([r({readOnly:!0})],l.prototype,"activeWidget",void 0),s([r()],l.prototype,"areaUnit",null),s([r()],l.prototype,"iconClass",void 0),s([r()],l.prototype,"label",null),s([r()],l.prototype,"linearUnit",null),s([r(),A("esri/widgets/Measurement/t9n/Measurement")],l.prototype,"messages",void 0),s([r()],l.prototype,"uiStrings",void 0),s([r()],l.prototype,"view",null),s([r({type:T})],l.prototype,"viewModel",void 0),l=s([U("esri.widgets.Measurement")],l);const F=l,L=(e,i)=>new F({view:i,container:e,areaUnit:"imperial",linearUnit:"imperial"}),z=e=>{const i=d.useRef(),t=d.useRef(!1),[a,o]=d.useState(""),[v,_]=d.useState(!1),u=d.useRef();d.useEffect(()=>{if(!t.current){t.current=!0;const p=L(i.current,e.view);u.current=p,p.watch("activeTool",f=>{f&&o(f||"")})}return()=>{}},[]),d.useEffect(()=>{_(e.isActive),e.isActive||(u.current.activeTool=null),v&&u.current&&(u.current.activeTool=a)},[e.isActive]);const w=d.useCallback(p=>{e.toolDismissed(),u.current.activeTool=null},[]),S=d.useCallback(p=>{e.showTips(P)},[]);return{measureRef:i,measurement:u,selectedTool:a,setSelectedTool:o,isActive:v,toolDismissed:w,tipsClicked:S}},b=e=>{const{measureRef:i,measurement:t,selectedTool:a,setSelectedTool:o,isActive:v,toolDismissed:_,tipsClicked:u}=z(e);return n.jsxs(D,{id:"measure-panel",heading:"Measure","data-panel":"measure",hidden:!v,closed:v?void 0:!0,closable:!0,onCalcitePanelClose:_,children:[n.jsx(h,{id:"tip",icon:"lightbulb",text:"Tips",slot:"header-actions-end",onClick:u}),n.jsx(h,{id:"collapseTool",icon:"chevron-up",text:"",slot:"header-actions-end",onClick:O}),n.jsx(g,{label:"Show Tip",referenceElement:"tip",closeOnClick:!0,children:"Show Tip"}),n.jsx(g,{label:"Collapse",referenceElement:"collapseTool",closeOnClick:!0,children:"Collapse"}),n.jsxs("div",{id:"measure-tools",children:[n.jsxs("div",{className:"measure-container",children:[n.jsx(g,{closeOnClick:!0,label:"Distance",referenceElement:"measureDistance",children:"Distance"}),n.jsx(h,{id:"measureDistance",icon:"measure-line",text:"Distance",active:a==="distance"?!0:void 0,onClick:()=>{o("distance");debugger;t.current&&(t.current.activeTool="distance")}}),n.jsx(g,{closeOnClick:!0,label:"Area",referenceElement:"measureArea",children:"Area"}),n.jsx(h,{id:"measureArea",icon:"measure-area",text:"Area",active:a==="area"?!0:void 0,onClick:()=>{o("area"),t.current&&(t.current.activeTool="area")}}),n.jsx(g,{closeOnClick:!0,label:"Clear",referenceElement:"clearMeasure",children:"Clear"}),n.jsx(h,{id:"clearMeasure",icon:"trash",text:"Clear",onClick:()=>{var w;t.current&&((w=t.current)==null||w.clear(),o(""))}})]}),n.jsx("div",{ref:i}),n.jsx("section",{hidden:a!==""?!0:void 0,className:"measurement-hint",children:n.jsx("p",{children:"Select line or distance measurement tool"})})]})]})},N=k.memo(b),q=Object.freeze(Object.defineProperty({__proto__:null,Measure:b,default:N},Symbol.toStringTag,{value:"Module"}));export{q as M,V as e};
