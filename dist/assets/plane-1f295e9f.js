import{cF as M,d3 as C,cg as m,I as k,aG as L,aD as h,aF as O,aE as s,d8 as B,aB as _,jk as p}from"./index-84d82762.js";import{c as I,r as w,e as x}from"./sphere-52f8f52c.js";function Z(n){const r=n[0]*n[0]+n[4]*n[4]+n[8]*n[8],u=n[1]*n[1]+n[5]*n[5]+n[9]*n[9],t=n[2]*n[2]+n[6]*n[6]+n[10]*n[10];return Math.sqrt(Math.max(r,u,t))}function R(n,r){const u=Math.sqrt(r[0]*r[0]+r[4]*r[4]+r[8]*r[8]),t=Math.sqrt(r[1]*r[1]+r[5]*r[5]+r[9]*r[9]),c=Math.sqrt(r[2]*r[2]+r[6]*r[6]+r[10]*r[10]);return M(n,u,t,c),n}function z(n,r,u){Math.abs(n[0])>Math.abs(n[1])?M(r,0,1,0):M(r,1,0,0),C(u,n,r),m(r,r),C(r,u,n),m(u,u)}function v(n=$){return[n[0],n[1],n[2],n[3]]}function S(n=$[0],r=$[1],u=$[2],t=$[3]){return y(n,r,u,t,w.get())}function D(n,r){return y(r[0],r[1],r[2],r[3],n)}function y(n,r,u,t,c=v()){return c[0]=n,c[1]=r,c[2]=u,c[3]=t,c}function G(n,r,u){const t=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],c=Math.abs(t-1)>1e-5&&t>1e-12?1/Math.sqrt(t):1;return u[0]=r[0]*c,u[1]=r[1]*c,u[2]=r[2]*c,u[3]=-(u[0]*n[0]+u[1]*n[1]+u[2]*n[2]),u}function H(n,r,u,t=v()){const c=u[0]-r[0],a=u[1]-r[1],e=u[2]-r[2],o=n[0]-r[0],i=n[1]-r[1],A=n[2]-r[2],E=a*A-e*i,l=e*o-c*A,P=c*i-a*o,X=E*E+l*l+P*P,d=Math.abs(X-1)>1e-5&&X>1e-12?1/Math.sqrt(X):1;return t[0]=E*d,t[1]=l*d,t[2]=P*d,t[3]=-(t[0]*n[0]+t[1]*n[1]+t[2]*n[2]),t}function J(n,r,u,t,c){const a=n.length/3;if(a<3)return!1;M(F,n[3*u],n[3*u+1],n[3*u+2]);let e=t,o=!1;for(;e<a-1&&!o;){const i=3*e;M(g,n[i],n[i+1],n[i+2]),e++,o=!p(F,g)}if(!o)return!1;for(e=Math.max(e,c),o=!1;e<a&&!o;){const i=3*e;M(N,n[i],n[i+1],n[i+2]),e++,h(T,F,g),m(T,T),h(b,g,N),m(b,b),o=!p(F,N)&&!p(g,N)&&Math.abs(s(T,b))<K}return o?(H(F,g,N,r),!0):(u!==0||t!==1||c!==2)&&J(n,r,0,1,2)}const K=.99619469809,F=_(),g=_(),N=_(),T=_(),b=_();function n1(n,r,u){return r!==n&&D(n,r),n[3]=-s(n,u),n}function r1(n,r){return r[0]=-n[0],r[1]=-n[1],r[2]=-n[2],r[3]=-n[3],r}function u1(n,r,u,t){return C(N,r,n),G(u,N,t)}function t1(n,r,u,t){return q(n,r,h(I.get(),u,r),U,t)}function c1(n,r,u){return!!k(r)&&q(n,r.origin,r.direction,V,u)}function e1(n,r,u){return q(n,r.origin,r.vector,f.NONE,u)}function o1(n,r,u){return q(n,r.origin,r.vector,f.CLAMP,u)}function a1(n,r){return j(n,r)>=0}function i1(n,r){const u=s(n,r.ray.direction),t=-j(n,r.ray.origin);if(u>-1e-6&&u<1e-6)return t>0;const c=t/u;return u>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function f1(n,r,u){const t=L(I.get(),n,-n[3]),c=Q(n,h(I.get(),r,t),I.get());return O(u,c,t),u}function I1(n,r,u,t){const c=n,a=I.get(),e=I.get();z(c,a,e);const o=h(I.get(),u,r),i=x(a,o),A=x(e,o),E=x(c,o);return M(t,i,A,E)}function Q(n,r,u){const t=L(I.get(),n,s(n,r));return h(u,r,t),u}function j(n,r){return s(n,r)+n[3]}function q(n,r,u,t,c){const a=s(n,u);if(a===0)return!1;let e=-(s(n,r)+n[3])/a;return t&f.CLAMP&&(e=B(e,0,1)),!(!(t&f.INFINITE_MIN)&&e<0||!(t&f.INFINITE_MAX)&&e>1)&&(O(c,r,L(c,u,e)),!0)}function N1(n){return n}const $=[0,0,1,0];var f;(function(n){n[n.NONE=0]="NONE",n[n.CLAMP=1]="CLAMP",n[n.INFINITE_MIN=4]="INFINITE_MIN",n[n.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const U=f.INFINITE_MIN|f.INFINITE_MAX,V=f.INFINITE_MAX;export{D as A,a1 as B,S as E,y as F,i1 as H,f1 as J,I1 as K,n1 as L,u1 as O,r1 as P,e1 as U,j as V,N1 as Y,G as _,R as a,J as b,H as j,Z as l,v as p,t1 as q,o1 as w,c1 as x};
